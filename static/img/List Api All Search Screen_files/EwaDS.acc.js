(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[26],{1322:function(u,E,b){function a(){c.a.ti(".ewr-selection-draghandle,.ewr-selection-draghandle-grab{position:absolute;cursor:move;background-color:#fff;opacity:.01;z-index:15;pointer-events:auto}.ewr-selection-draghandle-grab{cursor:grab}.ewr-selection-draghandle-top-ie,.ewr-selection-draghandle-top-ie-enhanced{top:-2px;left:-2px;right:-2px;height:5px}.ewr-selection-draghandle-top-ie-enhanced{border-top:1.25px solid transparent}.ewr-selection-draghandle-top,.ewr-selection-draghandle-top-enhanced{top:-2px;left:-2px;right:-2px;height:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-top-enhanced{border-top:1.25px solid transparent}.ewr-selection-draghandle-bottom-ie,.ewr-selection-draghandle-bottom-ie-enhanced{right:0;left:-2px;bottom:-2px;height:5px}.ewr-selection-draghandle-bottom-ie-enhanced{border-top:1.25px solid transparent}.ewr-selection-draghandle-bottom,.ewr-selection-draghandle-bottom-enhanced{right:0;left:-2px;bottom:-2px;height:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-bottom-enhanced{border-top:1.25px solid transparent}.ewr-selection-draghandle-left-ie,.ewr-selection-draghandle-left-ie-enhanced{top:0;left:-2px;bottom:0;width:5px}.ewr-selection-draghandle-left-ie-enhanced{border-top:1.5px solid transparent}.ewr-selection-draghandle-left,.ewr-selection-draghandle-left-enhanced{top:0;left:-2px;bottom:0;width:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-left-enhanced{border-left:1.5px solid transparent}.ewr-selection-draghandle-right-ie,.ewr-selection-draghandle-right-ie-enhanced{top:0;right:-2px;bottom:0;width:5px}.ewr-selection-draghandle-right-ie-enhanced{border-right:1.5px solid transparent}.ewr-selection-draghandle-right,.ewr-selection-draghandle-right-enhanced{top:0;right:-2px;bottom:0;width:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-right-enhanced{border-right:1.5px solid transparent}.ewr-selection-dragtooltip{position:absolute;background-color:#fff;z-index:UndefinedLessParam;border:1px solid #6e7b8a;height:18px;font-size:12px;padding-left:2px;padding-right:2px}.ewr-selection-dragtooltip-updated{position:absolute;background-color:#fff;z-index:UndefinedLessParam;border:1px solid #6e7b8a;height:fit-content;width:max-content;font-size:10px;padding-left:2px;padding-right:2px}.ewr_selection_rearrangeleft{border-left:3px solid #217346;position:absolute;height:10px;width:0;left:-2px;top:-4px}.ewr_selection_rearrangeright{border-right:3px solid #217346;position:absolute;height:10px;width:0;right:-5px;top:-4px}.ewr_selection_rearrangetop{border-top:3px solid #217346;position:absolute;width:10px;height:0;top:-2px;left:-4px}.ewr_selection_rearrangebottom{border-bottom:3px solid #217346;position:absolute;width:10px;height:0;bottom:-5px;left:-4px}.ewr-cell-selection-highlight-all.selecting .ewr-selection-draghandle{cursor:unset}.ewr-selection-resizemarqueehandle{position:absolute;width:5px;height:5px;background-color:#217346;border:solid 1px #fff;z-index:16;pointer-events:auto}.ewr-selection-resizemarqueehandle-topleft,.ewr-selection-resizemarqueehandle-topright{top:-4px}.ewr-selection-resizemarqueehandle-bottomleft,.ewr-selection-resizemarqueehandle-bottomright{bottom:-4px}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomright{cursor:nwse-resize}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomright{cursor:nesw-resize}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topright{cursor:nesw-resize}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topright{cursor:nwse-resize}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topright,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomright{left:-4px}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topright,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomright{right:-4px}.ewr-marquee-thick{z-index:calc(10 + 1) !important;border-width:3px !important}.ewr-grdcontarea-ltr .ewr-marquee-thick{margin:-3px 0 0 -3px !important}.ewr-grdcontarea-rtl .ewr-marquee-thick{margin:-3px -3px 0 0 !important}.ewr-resizemarqueehandle-thick{height:6px !important;width:6px !important}")}
b.d(E,"a",function(){return a});var c=b(559)},1323:function(u,E,b){function a(){c.a.ti('.ewa-stb-uir{background-color:#f5f5f5;height:32px}.grid-visual-refresh .ewa-stb-ltr,.grid-visual-refresh .ewa-stb-rtl{background-color:#f5f5f5}.ewa-stb-drag{cursor:pointer}.ewa-stb-navarea{position:relative;flex-shrink:0;top:0;border:0;height:27px;width:auto;padding:0;margin:0;overflow:hidden}.ewa-stb-uir .ewa-stb-navarea-dimensions{height:32px}.ewa-stb-ltr .ewa-stb-navarea{left:0}.ewa-stb-rtl .ewa-stb-navarea{right:0}a.ewa-stb-navbutton.cui-disabled:focus{outline:auto 1px}.ewa-stb-navareaextra a.ewa-stb-navbutton:focus-visible{outline-offset:-1px}.ewa-stb-navbutton{border:0;padding:0;margin:0;width:27px;height:27px}.ewa-stb-uir .ewa-stb-navbutton{width:24px;height:24px;margin:4px;border-radius:2px}.ewa-stb-uir .ewa-stb-navbutton:hover{background-color:#e1dfdd}.ewa-stb-uir .ewa-stb-navbutton:active{background-color:#bebbb8}.ewa-stb-ltr .ewa-stb-navbutton{float:left}.ewa-stb-rtl .ewa-stb-navbutton{float:right}.ewa-stb-navbutton .clip16x16{display:inline-block;margin:5px 6px 6px 5px}.ewa-stb-uir .ewa-stb-navbutton .clip12x12{display:inline-block;margin:6px}.ewa-stb-uir .cui-disabled svg{fill-opacity:.3}.ewa-stb-navbutton.cui-disabled .cui-img-container{opacity:.3}.ewa-stb-navareaextra{position:relative;flex-shrink:0;top:0;border:0;height:27px;width:auto;padding:0;margin:0;overflow:hidden}.ewa-stb-contentarea{position:relative;flex:0 1 auto;min-width:0%;top:0;left:0;right:0;border:0;height:27px;padding:0;margin:0;white-space:nowrap}.ewa-stb-uir .ewa-stb-contentarea{height:32px}.ewa-stb-uir .ewa-stb-left-scrollable.ewa-stb-contentarea::before{content:"";position:absolute;top:0;left:0;pointer-events:none;background-image:linear-gradient(90deg,#dcdcdc,transparent 1%);width:100%;height:32px;z-index:1}.ewa-stb-uir .ewa-stb-right-scrollable.ewa-stb-contentarea::after{content:"";position:absolute;top:0;left:0;pointer-events:none;background-image:linear-gradient(-90deg,#dcdcdc,transparent 1%);width:100%;height:32px;z-index:1}.ewa-stb-tabarea{position:relative;top:0;height:27px;left:0;right:0}.ewa-stb-uir .ewa-stb-tabarea{height:32px}.ewa-stb-sheettabmoveindicator{position:absolute;top:-4px}.ewa-stb-tabs{display:block;height:27px;list-style:none;left:0;right:0;margin:0;padding:0;overflow-x:scroll;overflow-y:hidden;white-space:nowrap}.ewa-stb-uir .ewa-stb-tabs{height:32px}.ewa-stb-tabs-smooth{scroll-behavior:smooth}@media(prefers-reduced-motion:reduce){.ewa-stb-tabs{scroll-behavior:auto}}.ewa-stb-tabs .tab-active,.ewa-stb-tabs .tab-inactive{background-color:#f6f6f6;background-image:none;border:0 solid #ababab;border-left-width:1px;padding:0;height:22px;margin:2px 0 3px 0;display:inline-block;overflow:hidden;transform:translateX(0);transition:transform .2s}.ewa-stb-tabs .tab-active{border-bottom-width:2px;border-bottom-color:#217346;border-bottom-style:solid;margin:2px 0 3px 0;height:20px;background-color:#f6f6f6;transform:translateX(0);transition:transform .2s}.ewa-stb-uir .tab-active,.ewa-stb-uir .tab-inactive{background-color:#f5f5f5;border:0;margin:0;height:32px}.ewa-stb-uir .tab-hover{background-color:#e1dfdd}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active{background-color:Highlight;forced-color-adjust:none}}.ewa-stb-tabs .tab-active.ewa-stb-tabs-ghost,.ewa-stb-uir .ewa-stb-tabs-ghost{position:fixed;z-index:1000;border-right-width:1px;transition:none}.ewa-stb-tabs .tab-anchor-text{text-decoration:none;white-space:nowrap;height:22px;display:block}.tab-anchor-text:focus-visible{outline-offset:-1px}.ewa-stb-uir .tab-anchor-text{height:32px}.ewa-stb-tabs .dark{color:#444;white-space:pre;height:18px}.ewa-stb-tabs .light{color:#fff;white-space:pre;height:18px}.ewa-stb-tabs .tab-active-text{color:#217346;height:14px}.ewa-stb-uir .tab-active-text{color:#444;line-height:16px;padding-bottom:5px}.ewa-stb-uir .tab-active .tab-content-container::before{content:"";position:absolute;display:inline-block;top:0;bottom:0;left:0;right:0;color:rgba(0,0,0,0);border-bottom:3px solid #217346;padding-bottom:5px;width:calc(100% - 18px);margin:auto;transition:width 400ms cubic-bezier(.17,.17,0,1) 0s}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active .tab-content-container::before{border-bottom-color:HighlightText}.ewa-stb-uir .tab-active svg>path.OfficeIconColors_HighContrast{fill:HighlightText}}.ewa-stb-uir .tab-active.tab-hover .tab-content-container:hover::before{width:calc(100%)}.ewa-stb-tabs .tab-text,.ewa-stb-tabs .tab-content-container{white-space:pre;font-size:10pt;display:inline-block;text-align:center;margin-bottom:0}.ewa-stb-tabs .tab-content-container{padding:0 18px 0 18px;margin:0 2px 0 2px}.ewa-stb-uir .tab-content-container{padding:3px 6px 3px 6px;border-radius:2px;margin:2px 3px 2px 3px;font-size:14px}.ewa-stb-tabs .cui-img-container{top:1px}.ewa-stb-tabs .tab-content-container .clip12x12,.ewa-stb-tabs .tab-content-container .clip16x16,.ewa-stb-tabs .tab-content-container .clip24x16{display:inline-block}.ewa-stb-nsv-inactive{opacity:.7}.ewa-stb-nsv-inactive-svg{fill-opacity:.7}.ewa-stb-nsv-active{opacity:1}.ewa-stb-nsv-active-svg{fill-opacity:1}.ewa_nsv_margin{margin-left:4px !important;height:14px}.ewa-stb-rtl .ewa_nsv_margin{margin-left:0 !important;margin-right:4px !important}@media screen and (-ms-high-contrast:active){.ewa-stb-tabs .tab-active-text{color:ButtonText}}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active-text{color:HighlightText}}.ewa-stb-disable-scrollbar *::-webkit-scrollbar{display:none}.ewa-stb-disable-scrollbar *{scrollbar-width:none}.leave-size-fixed-on-tab-hover-old::after{display:block;content:attr(sheet-title);font-weight:bold;overflow:hidden;visibility:hidden}.leave-size-fixed-on-tab-hover::after{display:block;content:attr(sheet-title);font-weight:bold;overflow:hidden;visibility:hidden;height:0}.ewa-stb-locked-sheet{margin-right:4px !important;height:13px !important;width:12px !important}.ewa-stb-locked-sheet-svg{margin-right:4px !important;height:15px !important;width:12px !important}.ewa-stb-tabs .ewa-stb-locked-sheet-svg-16px{margin-right:4px}.ewa-stb-rtl .ewa-stb-locked-sheet{margin-right:0 !important;margin-left:4px !important}.ewa-stb-dropdown-menu-button{position:relative;display:inline-block;padding:0;margin:0;border:0}.ewa-active-sheet-menu-item{background-color:#e1dfdd}.ewr-presentMode-on .ewa-stb-uir,.ewr-presentMode-on .ewa-stb-tabs .tab-active,.ewr-presentMode-on .ewa-stb-tabs .tab-inactive,.ewr-presentMode-on .ewa-stb-uir .tab-active,.ewr-presentMode-on .ewa-stb-uir .tab-inactive,.ewr-presentMode-on.grid-visual-refresh .ewa-stb-ltr,.ewr-presentMode-on.grid-visual-refresh .ewa-stb-rtl{background-color:#3b3a39}.ewr-presentMode-on .ewa-stb-uir .tab-hover,.ewr-presentMode-on .ewa-stb-uir .ewa-stb-navbutton:hover{background-color:#484644}.ewr-presentMode-on .ewa-stb-tabs .tab-active :focus,.ewr-presentMode-on .ewa-stb-tabs .tab-inactive :focus,.ewr-presentMode-on .ewa-stb-uir .ewa-stb-navbutton.cui-disabled:focus{background-color:#3b3a39 !important;border:1px solid #e5e5e5 !important}.ewr-presentMode-on .ewa-stb-tabs .tab-active,.ewr-presentMode-on .ewa-stb-tabs .tab-active-text{border-bottom-color:#37a660}.ewr-presentMode-on .ewa-stb-uir .tab-active .tab-content-container::before{border-bottom:3px solid #37a660}.ewr-presentMode-on .ewa-stb-tabs .light{color:#e1dfdd}.ewr-presentMode-on .ewa-stb-uir .tab-active-text{color:#f3f2f1}.ewa-active-sheet-menu-item-present-mode{background-color:#605e5c}.ewr-presentMode-transition .ewa-stb-uir,.ewr-presentMode-transition .ewa-stb-tabs .tab-active,.ewr-presentMode-transition .ewa-stb-tabs .tab-inactive,.ewr-presentMode-transition .ewa-stb-uir .tab-active,.ewr-presentMode-transition .ewa-stb-uir .tab-inactive,.ewr-presentMode-transition.grid-visual-refresh .ewa-stb-ltr,.ewr-presentMode-transition.grid-visual-refresh .ewa-stb-rtl{transition:background-color .4s linear}.ewr-presentMode-transition .ewa-stb-tabs .light,.ewr-presentMode-transition .ewa-stb-uir .tab-active-text{transition:color .4s linear}')}
b.d(E,"a",function(){return a});var c=b(559)},1324:function(u,E,b){function a(){c.a.ti(".ewa-svg-icon{height:100%;width:100%}")}b.d(E,"a",function(){return a});var c=b(559)},1325:function(u,E,b){function a(f,v){this.ID=f;this.type=v}function c(f,v){this.value=f;this.contextId=v}function d(f,v,r,y,m,w,B,A){this.type=f;this.startTime=null==r||void 0==r.value?new c(r,null):r;this.endTime=null==y||void 0==y.value?new c(y,null):y;null!=m&&void 0!=m.value||new c(m,null);null!=w&&void 0!=w.value||new c(w,
null);this.operationType=A}function e(f){this.ID=f}function k(){this.Ce=[];this.Bnb=[];this.zVc=0;this.duration=this.startTime=null;this.q7b={};this.dvd=this.Gvd=this.YWc=-1}function l(f){var v;return(null!=document.body.style.msTransform?v=f.style.msTransform:null!=document.body.style.webkitTransform?v=f.style.webkitTransform:null!=document.body.style.mozTransform?v=f.style.u_j:null!=document.body.style.oTransform?v=f.style.C_j:null!=document.body.style.transform&&(v=f.style.transform),v)?(v=v.replace("rotate(",
""),v=v.replace("deg)",""),parseFloat(v)):0}b.d(E,"a",function(){return l});new a(0,0,0,0,0,0);new a(1,1,0,0,0,0);new a(2,2,0,0,0,0);new a(3,3,0,0,0,1);new a(4,3,1,0,1,1);new a(5,3,0,0,.42,1);new a(6,3,.83,0,1,1);new a(7,3,0,0,.58,1);new a(8,3,.42,0,.58,1);new a(9,3,.1,.25,.75,.9);new a(10,3,.1,.9,.2,1);new a(11,3,.1,.9,.2,1);new a(12,3,.9,.1,.2,1);new a(13,3,.4,0,0,1);new a(14,3,.13,.21,.1,.7);new a(15,3,.02,.33,.38,.77);new a(16,3,.57,.17,.95,.75);new a(17,3,0,.19,.07,.72);new a(18,3,0,0,.95,.37);
new a(19,3,.66,0,.34,1);new a(20,3,.8,0,.2,1);new a(21,3,.8,0,.2,1);d.prototype={type:0,startTime:new c(0,null),endTime:new c(0,null),h0j:new c(0,null),IZj:new c(0,null),operationType:0};new e(0,[new d(5,0,0,0,null,1,1,0)]);new e(1,[new d(5,2,0,0,null,0,2,0),new d(5,2,0,50,null,1,1,0)]);new e(2,[new d(1,3,0,167,null,0,1,1),new d(2,3,0,167,null,0,1,1)]);new e(3,[new d(3,3,0,167,null,0,1,1),new d(4,3,0,167,null,0,1,1)]);new e(4,[new d(5,2,0,0,null,0,2,0),new d(5,2,0,167,null,1,1,0)]);new e(5,[new d(5,
2,0,167,null,0,1,0)]);new e(6,[new d(1,3,0,100,null,0,1,1),new d(2,3,0,100,null,0,1,1)]);new e(7,[new d(3,3,0,100,null,0,1,1),new d(4,3,0,100,null,0,1,1)]);new e(8,[new d(5,2,0,100,null,1,1,0)]);new e(9,[new d(5,2,0,0,null,0,2,0),new d(5,2,0,100,null,1,1,0)]);new e(10,[new d(5,2,0,100,null,0,1,0)]);new e(11,[new d(1,3,0,267,null,0,1,1),new d(2,3,0,267,null,0,1,1)]);new e(12,[new d(3,3,0,267,null,0,1,1),new d(4,3,0,267,null,0,1,1)]);new e(13,[new d(5,2,0,267,null,1,1,0)]);new e(14,[new d(5,2,0,0,null,
0,2,0),new d(5,2,0,267,null,1,1,0)]);new e(15,[new d(5,2,0,267,null,0,1,0)]);new e(16,[new d(6,3,0,267,null,0,1,1),new d(7,3,0,267,null,0,1,1)]);new e(17,[new d(1,3,0,750,null,0,1,1),new d(2,3,0,750,null,0,1,1)]);new e(18,[new d(3,3,0,750,null,0,1,1),new d(4,3,0,750,null,0,1,1)]);new e(19,[new d(5,2,0,750,null,1,1,0)]);new e(20,[new d(5,2,0,0,null,0,2,0),new d(5,2,0,750,null,1,1,0)]);new e(21,[new d(6,3,0,1E3,null,0,1,1),new d(7,3,0,1E3,null,0,1,1)]);new e(22,[new d(1,3,0,367,null,0,1,1),new d(2,
3,0,367,null,0,1,1)]);new e(23,[new d(3,3,0,367,null,0,1,1),new d(4,3,0,367,null,0,1,1)]);new e(24,[new d(5,2,0,367,null,1,1,0)]);new e(25,[new d(5,2,0,0,null,0,2,0),new d(5,2,0,367,null,1,1,0)]);new e(26,[new d(5,2,0,367,null,0,1,0)]);new e(27,[new d(5,2,0,0,null,1,1,0),new d(5,2,0,50,null,0,1,0)]);new e(28,[new d(1,3,0,433,null,0,1,1),new d(2,3,0,433,null,0,1,1)]);new e(29,[new d(5,2,0,0,null,0,2,0),new d(5,2,0,50,null,1,1,0),new d(2,3,0,0,null,40,1,1),new d(2,3,0,100,null,0,1,1)]);new e(30,[new d(2,
0,0,0,null,32,1,1),new d(2,0,0,100,null,32,1,1),new d(2,3,101,350,null,0,1,1),new d(3,0,0,0,null,0,2,1),new d(3,0,0,100,null,0,2,1),new d(3,3,101,350,null,0,1,1),new d(5,0,0,0,null,0,2,0),new d(5,0,0,100,null,1,1,0)]);new e(31,[new d(2,3,0,267,null,32,1,1),new d(3,3,0,267,null,0,2,1),new d(5,2,0,0,null,1,0,0),new d(5,2,0,267,null,0,2,0)]);new e(32,[new d(5,2,0,0,null,0,2,0),new d(5,2,0,100,null,0,2,0),new d(5,2,101,267,null,1,1,0)]);new e(33,[new d(1,10,0,300,null,0,1,1),new d(2,10,0,300,null,0,1,
1)]);new e(34,[new d(3,10,0,300,null,0,1,1),new d(4,10,0,300,null,0,1,1)]);new e(35,[new d(1,8,0,750,null,0,1,1),new d(2,8,0,750,null,0,1,1)]);new e(36,[new d(5,2,0,0,null,0,2,0),new d(5,2,0,200,null,0,2,0),new d(5,3,201,500,null,1,1,0)]);new e(37,[new d(1,2,0,0,null,0,2,1),new d(2,2,0,0,null,0,2,1),new d(1,2,0,200,null,0,2,1),new d(2,2,0,200,null,0,2,1),new d(1,3,201,267,null,0,1,1),new d(2,3,201,267,null,0,1,1)]);new e(38,[new d(1,3,0,267,null,0,1,1),new d(2,3,0,267,null,0,1,1)]);new e(39,[new d(5,
2,0,0,null,0,2,0),new d(5,2,0,267,null,1,1,0)]);new e(40,[new d(5,2,0,267,null,0,1,0)]);window.location.search.indexOf("AnimationLogging=1");window.requestAnimationFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(f){window.setTimeout(f,16)}}();k.prototype={Ce:null,XIg:5,Bnb:null,zVc:0,startTime:null,duration:null,q7b:null,YWc:-1,Gvd:-1,dvd:-1};k.prototype.Start=
function(){this.startTime=new Date;this.q7b={}};k.prototype.GetRecentAnimationStats=function(){var f,v=[],r=0;for(f=n.zVc;f<n.XIg;f++)null!=n.Bnb[f]&&(v[r]=n.Bnb[f],r++);for(f=0;f<n.zVc;f++)null!=n.Bnb[f]&&(v[r]=n.Bnb[f],r++);return v};k.prototype.GetAnimationSqmStats=function(){var f=[];return f[0]=0>n.YWc?0:n.YWc,f[1]=0>n.Gvd?0:n.Gvd,f[2]=0>n.dvd?0:n.dvd,f};var n=new k},1326:function(u,E,b){function a(v){var r=f.call(this)||this;r.$S=[];r.ef=function(z,x){var D,I=x.Zc.block;z=!1;if(I.sk&&I.state&
1&&(D=r.view.Cf(x.Zc.block.ie.BlockCachePosition.PaneType).cG(x.Zc.hash))){I=r.uFd(I.ke);if(D=D.jf)for(var F=r.$S.length-1;0<=F;F--)D.contains(r.$S[F].bottomRight)&&(Array.removeAt(r.$S,F),z=!0);if(I)for(D=0,F=I.length;D<F;D++)r.rangeList.push(e.a.pQ(I[D])),z=!0;z&&(x=(n.EwaSettings.isChangeGateEnabled("OfficeVSO:6336710_ApplyHeaderSnappingOnVerticalFreezePane")?r.view.Moc(x.Zc.block.ie.BlockCachePosition.PaneType):r.view.U2).cG(x.Zc.hash),r.raiseEvent(a.vFd,new l.a(x)))}};r.Dm=function(){r.zHb()};
r.mo=function(){r.$S=[]};r.die=v;var y=v.Ea;y.Ds(r.ef);y.Cga(r.ef);y.XYb(r.ef);y.uG(r.Dm);v.$.va.iJ(r.mo);v.$.vb.iJ(r.mo);y=bk(v.en);for(var m=y.next();!m.done;m=y.next()){m=bk(m.value);for(var w=m.next();!w.done;w=m.next()){w=bk(w.value);for(var B=w.next();!B.done;B=w.next()){B=B.value;var A=v.Ea.ll(B.hashCode);r.ef(r,new d.a(new c.a(A,B.hashCode),null))}}}return r}b.d(E,"a",function(){return a});u=b(0);E=b(38);var c=b(226),d=b(376),e=b(189),k=b(45),l=b(705),n=b(1),f=E.a;Rk(a,f);a.prototype.dispose=
function(){this.view&&(this.view.Ea.Dq(this.ef),this.view.Ea.YH(this.Dm),this.view.Ea.Nab(this.ef),this.view.Ea.RHb(this.ef),this.view.$.va.DK(this.mo),this.view.$.vb.DK(this.mo));this.$S=this.die=null;f.prototype.dispose.call(this)};a.prototype.PYb=function(v){v=this.uFd(v);var r=n.EwaSettings.isChangeGateEnabled("OfficeVSO:6336710_ApplyHeaderSnappingOnVerticalFreezePane")?this.view.YG:this.view.Ug;if(v&&0<v.length&&r)for(var y=0,m=v.length;y<m;y++)r.contains(this.$S[y])||this.$S.push(e.a.pQ(v[y]))};
a.prototype.zHb=function(){var v=n.EwaSettings.isChangeGateEnabled("OfficeVSO:6336710_ApplyHeaderSnappingOnVerticalFreezePane")?this.view.YG:this.view.Ug;if(this.$S.length&&v)for(var r=this.$S.length-1;0<=r;r--)v.contains(this.$S[r])||Array.removeAt(this.$S,r)};a.prototype.k0e=function(v){return this.G_e(v)};a.prototype.G_e=function(v){v=k.I(v,this.$S,!0);return 0<v.length?v[0]:null};Mf.Object.defineProperties(a.prototype,{rangeList:{configurable:!0,enumerable:!0,get:function(){return this.$S}},view:{configurable:!0,
enumerable:!0,get:function(){return this.die}}});a.vFd="lrc";Object(u.a)(a,"LoadedRangeCollection",E.a,[])},1327:function(u,E,b){function a(){c.a.ti(".ewa-ttrd-buttonarea{position:absolute;z-index:31}.ewr-table-resize-fillhandle-broader{position:absolute;width:6px;height:3px;bottom:0;background-color:#003960;z-index:17;pointer-events:auto}.ewr-table-resize-fillhandle-higher{position:absolute;width:3px;height:6px;bottom:0;background-color:#003960;z-index:17;pointer-events:auto}.ewr-grdcontarea-ltr .ewr-table-resize-fillhandle-higher{right:-6px}.ewr-grdcontarea-rtl .ewr-table-resize-fillhandle-higher{left:-6px}.ewr-grdcontarea-ltr .ewr-table-resize-handle{cursor:nwse-resize;right:6px;bottom:0}.ewr-grdcontarea-rtl .ewr-table-resize-handle{cursor:nesw-resize;left:6px;bottom:0}.ewr-grdcontarea-ltr .ewr-table-resize-handle .ewr-table-resize-default-cursor{cursor:default}.ewr-grdcontarea-rtl .ewr-table-resize-handle .ewr-table-resize-default-cursor{cursor:default}.ewr-cell-selection-highlight-all.Selecting .ewr-table-resize-handle{cursor:nesw-resize}@media screen and (-ms-high-contrast:active),(forced-colors:active){.ewr-table-resize-fillhandle-higher{forced-color-adjust:none;position:absolute;width:3px;height:6px;bottom:0;background-color:#fff;z-index:17;pointer-events:auto}.ewr-table-resize-fillhandle-broader{forced-color-adjust:none;position:absolute;width:6px;height:3px;bottom:0;background-color:#fff;z-index:17;pointer-events:auto}}@media screen and (-ms-high-contrast:black-on-white),(forced-colors:active) and (prefers-color-scheme:light){.ewr-table-resize-fillhandle-higher{background-color:#000}.ewr-table-resize-fillhandle-broader{background-color:#000}}")}
b.d(E,"a",function(){return a});var c=b(559)},1340:function(u,E,b){function a(){fa.a.Fa(c.ka);fa.a.Fa(ka.ka)}function c(fb){var ac=tb.call(this)||this;ac.$=fb;ac.Eb();return ac}function d(fb,ac){var Ac=Va.call(this)||this;Ac.hob=function(Rc,Fc){Rc=Fc.w4;var wb=Ac.gridView;Fc=Fc.j6h;var uc=Fc.mf,Pb=Fc.a$;Xa.a.rh&&Pb.push(new A(uc,wb));switch(Rc){case 24:Fc.a$.push(new w(uc,Fc));break;case 0:Fc.a$.push(new z(uc,wb));Xa.a.Wo||(vb.EwaSettings.isChangeGateEnabled("OfficeVSO:6170982_UseDragSelectionClickBehaviorTableRange")?
(Pb.push(new D(uc,Ac.gridView.$,Fc.paneType,Ac.tableManager,Ac.Wn)),vb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ManualDragDropInPivotTables",!1)&&Array.add(Pb,new x(uc,Ac.gridView.$,Fc.paneType,Ac.tableManager,Ac.Wn))):Pb.push(new F(uc,Ac.gridView.$,Fc.paneType,Ac.tableManager,Ac.Wn)));Pb.push(new e(Fc,uc,wb,Fc.paneType));break;case 3:Pb.push(new H(uc));Xa.a.Wo||(Pb.push(new O(uc,Ac.gridView.$,Fc.paneType,Ac.hF,Ac.Wn,Fc)),Pb.push(new v(uc,Ac.gridView,Ac.hF,Ac.Wn,Fc)),Pb.push(new f(uc,
Ac.gridView,Ac.hF,Ac.Wn,Fc)));break;case 4:case 5:Pb.push(new n(uc));break;case 30:Pb.push(new l(uc));break;case 16:Pb.push(new k(uc));Pb.push(new m(Fc,uc,wb,Fc.paneType));break;case 11:case 12:Pb.push(new y(uc,11===Rc));break;case 17:Pb.push(new H(uc));break;case 19:Pb.push(new H(uc)),Pb.push(new K(Fc,uc,wb,Fc.paneType))}Fc.o0b=!0};Ac.$=fb;Ac.gridView=Ob.g(fb);Ac.tableManager=ac;Ac.hF=new B(Ac.gridView);Ac.Wn=new Q(Ac.gridView);Ac.gridView.qb&&(Ac.gridView.qb.FEg(Ac.hob),Ac.gridView.qb.update(!1));
fb.da.Ga(64,Ac);return Ac}function e(fb,ac,Ac,Rc){return N.call(this,fb,ac,Ac,Rc)||this}function k(fb){var ac=C.call(this,fb)||this;k.jrb(fb,V.a.gvh+" "+kb.a.eua);k.jrb(fb,V.a.fvh+" "+kb.a.eua);k.jrb(fb,V.a.cvh+" "+kb.a.eua);k.jrb(fb,V.a.evh+" "+kb.a.eua);k.jrb(fb,kb.a.dvh);return ac}function l(fb){var ac=C.call(this,fb)||this;appChrome.renderSpinner(fb);return ac}function n(fb){var ac=C.call(this,fb)||this;n.Uqb(fb,V.a.Guh+" "+kb.a.eua);n.Uqb(fb,V.a.Fuh+" "+kb.a.eua);n.Uqb(fb,V.a.Cuh+" "+kb.a.eua);
n.Uqb(fb,V.a.Euh+" "+kb.a.eua);n.Uqb(fb,kb.a.Duh);return ac}function f(fb,ac,Ac,Rc,Fc){var wb=r.call(this,fb,ac,Ac,Rc,Fc)||this;wb.sEb=function(){var uc=3===Ha.a.Cb;wb.yrd&&!uc?wb.Wn.GKb(wb.bba,wb.IK,!1):!wb.yrd&&uc&&wb.Wn.GKb(wb.bba,wb.IK,!0);wb.yrd=uc};wb.aQi=function(uc,Pb){Pb.Ixb===wb.bba.w$&&wb.Wn.GKb(wb.bba,wb.IK,!Pb.start&&wb.qQd())};Ha.a.Eme(wb.sEb);wb.yrd=3===Ha.a.Cb;wb.Wn.hFg(wb.aQi);return wb}function v(fb,ac,Ac,Rc,Fc){return r.call(this,fb,ac,Ac,Rc,Fc)||this}function r(fb,ac,Ac,Rc,Fc){var wb=
C.call(this,fb)||this;wb.PK=null;wb.Ya=null;wb.h3=0;wb.sourceRange=null;wb.gb=null;wb.kSa=!1;wb.onPointerDown=function(uc){uc=Wa.a(wb.$).Rd(uc);if(wb.T0f(uc)&&!wb.kSa){wb.Clf();wb.Ya=wb.Wn.Ibd();wb.PK=wb.Wn.W0e(uc);if(!wb.Ya||!wb.PK||!wb.PK.range)return ba.ULS.shipAssertTag(537159361,0,!!wb.Ya,"ResizeMarqueeBehaviorBase.OnPointerDown: cellContentEditor is null"),ba.ULS.shipAssertTag(537159360,0,!!wb.PK,"ResizeMarqueeBehaviorBase.OnPointerDown: selectedHighlightState is null"),ba.ULS.shipAssertTag(537159331,
0,!!wb.PK.range,"ResizeMarqueeBehaviorBase.OnPointerDown: selectedHighlightState.Range is null"),!1;wb.gb=wb.PK.range.clone();wb.sourceRange=wb.gb.clone();wb.h3=wb.dYe(uc);if(4===wb.h3)return ba.ULS.shipAssertTag(537159330,0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: currentFixedCorner is not valid"),!1;var Pb=wb.NZe(uc,!0);if(!Pb)return ba.ULS.shipAssertTag(537159329,0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: mouseSelection is null. Not expect when clicking on handler."),!1;if(!wb.eDe(Pb))return ba.ULS.shipAssertTag(537159328,
0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: currentFixedCorner is not valid"),!1;wb.gridView.gLa=!0;wb.Ya.bE(!1);wb.hF.yIe(uc.zb);wb.Wn.RJf(!0,wb.bba.w$);wb.Ya.textBox.removeSelection();wb.Ya.kZb(wb.C4e);wb.hNf();wb.kSa=!0;ec.b(wb.$,!0)}return!0};wb.ai=function(uc){uc=Wa.a(wb.$).Rd(uc);uc=wb.NZe(uc,!1);if(!uc)return!0;uc=wb.eDe(uc);if(!uc)return ba.ULS.shipAssertTag(537159327,0,!1,"ResizeMarqueeBehaviorBase.OnPointerMove: newMarqueeRange is null"),wb.A9b(!0),!1;if(wb.gb.equals(uc))return!0;wb.gb=
uc;uc=wb.uy();uc||(ba.ULS.shipAssertTag(537159326,0,!1,"ResizeMarqueeBehaviorBase.OnPointerMove: UpdateHighlightOnMove failed"),wb.A9b(!0));return uc};wb.Bf=function(uc){Wa.a(wb.$).Rd(uc);uc=wb.XK();ba.ULS.shipAssertTag(537159325,0,uc,"ResizeMarqueeBehaviorBase.OnPointerUp: SetSelectedRange failed");wb.A9b(!uc);return uc};wb.C4e=function(){wb.A9b(!0)};wb.gridView=ac;wb.$=ac.$;wb.IK=[];wb.ha=wb.gridView.ha;wb.hF=Ac;wb.Wn=Rc;wb.bba=Fc;wb.coloredReferencesManager=wb.$.da.za(281);ba.ULS.shipAssertTag(537159362,
0,!!wb.coloredReferencesManager,"ResizeMarqueeBehaviorBase Ctor: coloredReferencesManager is null. We already have marquee highlights so it shouldn't happen.");ac=bk(wb.mSf());for(Ac=ac.next();!Ac.done;Ac=ac.next())Ac=wb.Wn.rCe(fb,Ac.value,wb.Gne(),wb.onPointerDown),wb.IK.push(Ac);fb=bk(wb.IK);for(ac=fb.next();!ac.done;ac=fb.next())ac=ac.value,oa.a.instance.ra(ra.a.aW,ac,wb.hF.N7e),oa.a.instance.ra(ra.a.fy,ac,wb.hF.O7e);wb.CYa(Fc);return wb}function y(fb,ac){var Ac=C.call(this,fb)||this;var Rc=document.createElement("div"),
Fc=document.createElement("div");Rc.className=ac?J.ivh:J.kvh;Fc.className=ac?J.jvh:J.hvh;fb.appendChild(Rc);fb.appendChild(Fc);return Ac}function m(fb,ac,Ac,Rc){return N.call(this,fb,ac,Ac,Rc)||this}function w(fb,ac){var Ac=C.call(this,fb)||this;Ac.Ezf=function(){if(!Ac.Qu)return ba.ULS.shipAssertTag(537159364,0,!1,"RangeCatchUpActivityHighlightBehavior.OnPointerEnter: highlightController is null"),!1;Ac.Qu.hKf(Ac.oH,!1);Ac.Qu.oKe(Ac.oH,!1);if(3===Ac.Qu.model.state)return!0;Ac.Qu.J7e(!0);return!0};
Ac.sca=function(){if(!Ac.Qu)return!1;Ac.Qu.I2i();Ac.Qu.gKd(Ac.oH,!1);if(3===Ac.Qu.model.state)return!0;Ac.Qu.J7e(!1);return!0};Ac.onPointerDown=function(Rc){return Ac.Qu?2===Rc.lb&&Rc.Hn===Sys.UI.MouseButton.leftButton?!0:!1:!1};Ac.wEb=function(){if(!Ac.Qu)return!1;Ac.Qu.gKd(Ac.oH,!0);Ac.Qu.hKf(Ac.oH,!0);Ac.Qu.oKe(Ac.oH,!0);Ac.Qu.IJb(!0);return!0};Ac.onDoubleClick=function(Rc){if(Rc.Ca)return Rc.Ca.stopPropagation(),!0;ba.ULS.sendTraceTag(537159363,0,50,"CatchUpActivityHighlightBehavior::OnDoubleClick Double click event handled on Pill.");
return!0};Ac.Qu=Object(Ic.a)(kc.a,ac.metadata);Ac.TJ=document.createElement("div");Ac.TJ.id=String.format("{0}-{1}",fb.id,Ka.a.awe);Ac.TJ.className=Rb.a.QUg;Ac.oH=document.createElement("div");Ac.oH.id=String.format("{0}-{1}",fb.id,Ka.a.DZc);Ac.oH.className=Rb.a.DZc;Ac.TJ.appendChild(Ac.oH);fb.appendChild(Ac.TJ);ba.ULS.sendTraceTag(537159365,0,50,"RangeCatchUpActivityHighlightBehavior::RangeCatchUpActivityHighlightBehavior: An activity indicator has been created.");oa.a.instance.ra(ra.a.aW,Ac.TJ,
Ac.Ezf);oa.a.instance.ra(ra.a.fy,Ac.TJ,Ac.sca);oa.a.instance.ra(ra.a.pointerDown,Ac.TJ,Ac.onPointerDown);Vb.a.instance.ra(ra.a.click,Ac.TJ,Ac.wEb);Vb.a.instance.ra(ra.a.$j,Ac.TJ,Ac.onDoubleClick);return Ac}function B(fb){var ac=this;this.N7e=function(Ac){ac.WAc(Ac.zb,1);return!0};this.O7e=function(Ac){ac.WAc(Ac.zb,-1);return!0};this.ug=function(){ac.Lnd=!1};this.ep=function(){ac.Lnd=!0};this.gridView=fb;this.T4a=0;this.Lnd=this.ngc=!1;this.u5=Number.NaN;this.gridView.ha.s2(this.ep);this.gridView.ha.gY(this.ug);
this.gridView.ha.AZb(this.ug)}function A(fb,ac){var Ac=C.call(this,fb)||this;Ac.VQi=function(Rc){var Fc=ob.HelperMethods.En(Rc),wb=Ac.tva.eZd(Rc.clientPoint);if(!wb)return!1;var uc=wb.Fe,Pb=Ac.tva.Ea.fvb(uc.hashCode).Mua(wb.xI);if(!Pb)return!1;Rc=uc.lj.domElement;wb=ob.HelperMethods.Zke(ob.HelperMethods.Avb(uc.domElement,Rc),wb.xI);uc=0;Pb=Ac.tva.Ub(Pb.getRange());for(var sc=0,nb=A.kwe.length;sc<nb;++sc){var pc=A.kwe[sc];if(128!==pc&&64!==pc||!Ac.tva.$.isEditMode){var Dc=Pb.UJa(pc);if(Dc&&Dc.o5a&&
"none"!==Dc.o5a.style.display){Dc=Dc.o5a;var oc=ob.HelperMethods.Avb(Dc,Rc);Dc=new Sys.UI.Bounds(oc.x,oc.y,Dc.offsetWidth,Dc.offsetHeight);if(ta.a.SM(Dc,wb)){uc=pc;break}}}}return 0!==uc?(Pb.invoke(uc,Fc),!0):!1};Ac.Yog=ac;La.a.instance.ra(ra.a.click,fb,Ac.VQi);return Ac}function z(fb,ac){var Ac=H.call(this,fb)||this;Ac.ug=function(){Ac.domElement.classList.remove(J.selecting);Zb.c(Ac.gridView.$,!0,"FillHandleClickBehavior:OnSelectionEnded")};Ac.ep=function(){Ac.domElement.classList.add(J.selecting)};
Ac.onPointerDown=function(Rc){2===Rc.lb&&Rc.Hn===Sys.UI.MouseButton.leftButton&&(Ac.gridView.ha.selectionType=4,Ac.gridView.ha.sourceRange=Ac.gridView.ha.sa.Vc,Zb.c(Ac.gridView.$,!1,"FillHandleClickBehavior:OnSelectionStarted"));return!1};Ac.oca=function(){Ac.gridView.$.Fd(1983983164,2,30,null);return!0};Ac.Yc=function(){xa.DOMElementExtensions.setVisible(Ac.qaa,Ac.gridView.$.isEditMode)};Ac.s6=function(){xa.DOMElementExtensions.setVisible(Ac.qaa,!1)};Ac.r6=function(){xa.DOMElementExtensions.setVisible(Ac.qaa,
!0)};Ac.Rwf=function(){xa.DOMElementExtensions.setVisible(Ac.qaa,!1)};Ac.Qwf=function(){xa.DOMElementExtensions.setVisible(Ac.qaa,!0)};Ac.ZDb=function(Rc,Fc){xa.DOMElementExtensions.setVisible(Ac.qaa,!Fc.rje)};Ac.gridView=ac;ac=document.createElement("div");ac.className=kb.a.avh;Ac.qaa=ac;Ac.Yc(null,null);fb.appendChild(ac);oa.a.instance.ra(ra.a.pointerDown,Ac.qaa,Ac.onPointerDown);La.a.instance.ra(ra.a.$j,Ac.qaa,Ac.oca);Ac.gridView.ha.s2(Ac.ep);Ac.gridView.ha.gY(Ac.ug);Ac.gridView.$.Tk(Ac.Yc);Ac.gridView.$.ob.IZb(Ac.s6);
Ac.gridView.$.ob.HZb(Ac.r6);Ac.gridView.Xle(Ac.ZDb);Ac.gridView.$b.Ak(Ac.Rwf);Ac.gridView.$b.tm(Ac.Qwf);return Ac}function x(fb,ac,Ac,Rc,Fc){var wb=I.call(this,fb,ac,Ac,Fc)||this;wb.uOa=function(){wb.Jp&&wb.p$(!0);5==wb.Rh&&wb.HA(!0)};wb.vN=function(uc){Wa.a(wb.$).Rd(uc);wb.Jp=!1;wb.qb.eh(wb.yh);wb.ha.sourceRange=wb.sourceRange.clone();wb.J0i();wb.p$(!0);return!0};wb.tN=function(uc){uc=Wa.a(wb.$).Rd(uc);var Pb=uc.clientPoint;wb.tw=uc;var sc=wb.ha.Kn(Pb,uc.zb,5,void 0,void 0,!0);if(sc){if(!wb.Vod(sc))return wb.w1h(uc),
!0;wb.ucg(sc,wb.isRow,Pb);if(wb.isRow||wb.Te)wb.gb=wb.E2(sc);wb.ha.sourceRange=wb.gb;wb.qb.Ti(wb.gb,wb.yh);wb.qb.qn(wb.yh);wb.qb.eh(wb.ZA());wb.ry()}return!0};wb.Lyf=function(uc){uc.Errors&&0<uc.Errors.length?(ba.ULS.sendTraceTag(521410185,0,10,"DragSelectionClickBehaviorPivotTableRange.onMoveLineItemsSuccess: Errors: [{0}]",Kb.a.Ec(uc.Errors)),wb.gb.left=wb.sourceRange.left,wb.gb.right=wb.sourceRange.right,wb.gb.top=wb.sourceRange.top,wb.gb.bottom=wb.sourceRange.bottom):wb.isRow?wb.sourceRange.top<=
wb.gb.top&&wb.sourceRange.bottom>=wb.gb.top-1?(wb.gb.top=wb.sourceRange.top,wb.gb.bottom=wb.sourceRange.bottom):(wb.sourceRange.top>wb.gb.top||(wb.gb.top-=wb.sourceRange.height),wb.gb.bottom=wb.gb.top+wb.sourceRange.height-1):wb.sourceRange.left<=wb.gb.left&&wb.sourceRange.right>=wb.gb.left-1?(wb.gb.left=wb.sourceRange.left,wb.gb.right=wb.sourceRange.right):(wb.sourceRange.left>wb.gb.left||(wb.gb.left-=wb.sourceRange.width),wb.gb.right=wb.gb.left+wb.sourceRange.width-1);wb.XK();wb.Rh=-1};wb.Kyf=function(uc){uc=
Db.a.Mf(uc.data);ba.ULS.sendTraceTag(521410184,0,10,"DragSelectionClickBehaviorPivotTableRange.onMoveLineItemsFail: Errors: [{0}]",Kb.a.Ec(uc))};wb.tableManager=Rc;wb.ha.AZb(wb.uOa);return wb}function D(fb,ac,Ac,Rc,Fc){var wb=I.call(this,fb,ac,Ac,Fc)||this;wb.Jz=null;wb.wq=!1;wb.vq=!1;wb.EAb=0;wb.lM=null;wb.dO=null;wb.zn=0;wb.dia=ha.a.instance.ga(2234);wb.ssb=ha.a.instance.ga(2235);wb.yna=ha.a.instance.ga(2236);wb.bLb=ha.a.instance.ga(2237);wb.$sd=vb.EwaSettings.isChangeGateEnabled("OfficeVSO:6287205_LogDragDropActivity");
wb.onKeyDown=function(uc){if(wb.Ih){if(wb.hka(uc)||uc.Ca.keyCode===Cb.a.rea)return wb.$La||(ab.KeyInputManager.instance.ra(ra.a.Gd,wb.domElement.ownerDocument.body,wb.onKeyUp),wb.$La=!0),!wb.Vt&&wb.hka(uc)&&(Ob.g(wb.$).hg.vo(D.Iqb),wb.Vt=!0),wb.Wt||uc.Ca.keyCode!==Cb.a.rea||(Ob.g(wb.$).hg.vo(U.s1a),wb.Wt=!0,2===wb.zn?(wb.HA(!1),wb.jE=0,wb.yh=wb.vq?[11]:[12],wb.wq=wb.vq,wb.HPa(),wb.wI()):3===wb.zn?(wb.R2(!1),wb.jE=wb.isRow?1:2,wb.NN(),wb.uy()):1===wb.zn&&(wb.p$(!1),wb.NN(),wb.uy())),!0}else if(!wb.Vt&&
(uc.Ca.keyCode===Cb.a.Z7||Xa.a.isMac&&uc.Ca.keyCode===Cb.a.Aoa))return ab.KeyInputManager.instance.ra(ra.a.Gd,wb.domElement.ownerDocument.body,wb.onKeyUp),Ob.g(wb.$).hg.vo(D.Iqb),wb.Vt=!0;return!1};wb.onKeyUp=function(uc){if(wb.Ih){if(wb.hka(uc)||uc.Ca.keyCode===Cb.a.rea)return wb.EAb=wb.hka(uc)?0:1,wb.Jp&&Ob.g(wb.$).hg.vo(U.s1a),uc.Ca.keyCode===Cb.a.rea&&(2===wb.zn?(wb.R2(!1),wb.jE=0,wb.NN(!0),wb.uy(!0)):3===wb.zn?(wb.HA(!1),wb.jE=wb.isRow?1:2,wb.yh=wb.isRow?[11]:[12],wb.HPa(!0),wb.wI(!0)):1===wb.zn&&
(wb.HA(!1),wb.yh=wb.vq?[11]:[12],wb.uza(!0),wb.wI(!0))),wb.roa(wb.EAb),!0}else if(uc.Ca.keyCode===Cb.a.Z7||Xa.a.isMac&&uc.Ca.keyCode===Cb.a.Aoa)return wb.roa(),wb.Jp&&Ob.g(wb.$).hg.vo(U.g6c),!0;return!1};wb.vN=function(uc){uc=Wa.a(wb.$).Rd(uc);5===wb.Rh?wb.nAd(uc):(wb.Jp=!1,wb.qb.eh(wb.yh),!wb.$.hq([wb.gb],!1)||wb.bGd()||wb.szb()||(wb.ha.sourceRange=wb.sourceRange.clone(),wb.Ih?wb.BEd():wb.ptb(),wb.Rx()?wb.gb.top>wb.sourceRange.top&&(uc=wb.gb.height,wb.gb.top-=uc,wb.gb.bottom-=uc):wb.gb.left>wb.sourceRange.left&&
(uc=wb.gb.width,wb.gb.left-=uc,wb.gb.right-=uc),wb.XK()),wb.$sd&&wb.Zsd());wb.Ht(wb.tN,wb.vN);wb.tableRange=null;wb.Rh=-1;wb.Ih&&(wb.Jz=null,wb.zn=0);return!0};wb.m6=function(){wb.Jp=!1;wb.zn=0;wb.qb.eh(wb.yh);if(!wb.$.hq([wb.gb],!1))return wb.Ht(wb.l6,wb.m6),wb.Rh=-1,!0;if(!(wb.ha.sa.Vc.equals(wb.gb)||wb.bka(wb.gb)||wb.bka(wb.sourceRange)||wb.szb())){wb.XK();wb.ha.sourceRange=wb.sourceRange.clone();var uc=wb.ha.sourceRange,Pb=wb.ha.sa.Vc,sc={};wb.$.Fd(-694765314,2,30,(sc[Ka.a.Jta]=wb.Vt,sc[Ka.a.$6b]=
!0,sc[Ka.a.a7b]=wb.wq,sc[Ka.a.x3]=uc,sc[Ka.a.w3]=Pb,sc[Ka.a.qsb]=wb.Wt,sc));wb.Vt||(wb.gb.top>wb.sourceRange.top&&(wb.isRow||wb.gb.left===wb.sourceRange.left&&wb.wq)?(uc=wb.gb.height,wb.gb.top-=uc,wb.gb.bottom-=uc):wb.gb.left>wb.sourceRange.left&&(wb.Te||wb.gb.top===wb.sourceRange.top&&!wb.wq)&&(uc=wb.gb.width,wb.gb.left-=uc,wb.gb.right-=uc),wb.XK())}wb.Ht(wb.l6,wb.m6);wb.tableRange=null;wb.Jz=null;wb.Rh=-1;wb.wq=!1;wb.$sd&&wb.Zsd();return!0};wb.tN=function(uc){var Pb=vb.EwaSettings.isChangeGateEnabled("OfficeVSO:5719921_FixDragAndDropCTTableRowOnZoom");
Pb&&(uc=Wa.a(wb.$).Rd(uc));var sc=uc.clientPoint;Pb||(uc=Wa.a(wb.$).Rd(uc));wb.Ih&&(wb.tw=uc);if(uc=wb.ha.Kn(sc,uc.zb,5,void 0,void 0,!0)){if(wb.tableRange.contains(uc.topLeft)){if(wb.ucg(uc,wb.Rx(),sc),wb.gb=wb.E2(uc),wb.ha.sourceRange=wb.gb,wb.qb.Ti(wb.gb,wb.yh),wb.qb.qn(wb.yh),wb.qb.eh(wb.ZA()),6!==wb.Rh){for(sc=1;4>=sc;sc++)uc=wb.Eh[sc.toString()],uc.parentNode.removeChild(uc),wb.qb.cw(wb.Rx()?11:12,sc).mf.appendChild(uc);wb.Rh=6}}else if(wb.gb=wb.rha(uc),wb.Ih)wb.mwb(!1);else if(wb.qb.Ti(wb.gb,
wb.ZA()),wb.qb.qn(wb.ZA()),wb.qb.eh(wb.yh),5!==wb.Rh){for(sc=1;4>=sc;sc++)uc=wb.Eh[sc.toString()],uc.parentNode.removeChild(uc),wb.qb.cw(wb.Iaa(),sc).mf.appendChild(uc);wb.Rh=5}wb.ry()}return!0};wb.l6=function(uc){var Pb=vb.EwaSettings.isChangeGateEnabled("OfficeVSO:5719921_FixDragAndDropCTTableRowOnZoom");Pb&&(uc=Wa.a(wb.$).Rd(uc));var sc=uc.clientPoint;Pb||(uc=Wa.a(wb.$).Rd(uc));wb.tw=uc;if(Pb=wb.ha.Kn(sc,uc.zb,5,void 0,void 0,!0)){if(wb.Cwb(Pb))return wb.gb=wb.rha(Pb),wb.lwb(!1),!0;var nb=Ob.g(wb.$),
pc=nb.fg(Pb),Dc=nb.Cf(wb.paneType);sc=Qa.a.hs(Dc.view.Fh,wb.domElement.parentNode,sc,nb.rtl);Dc=!1;var oc=2;wb.wq=!1;if(wb.isRow||wb.Te){wb.isRow&&sc.y-pc.topLeft.y>pc.height/2?(Dc=!0,oc=1):wb.Te&&sc.x-pc.topLeft.x>pc.width/2&&(Dc=!0);if(Dc){uc=nb.Xj("DragSelectionClickBehaviorCellRangeAndTable.OnPointerMoveDragInsert",nb.YG,oc);try{uc.Tr(Pb),uc.$$mn(),Pb=uc.$$cu().range}finally{uc&&uc.dispose()}}wb.gb=wb.rha(Pb)}else{sc.x-pc.topLeft.x===pc.width?(wb.wq=!1,Dc=!0):sc.y-pc.topLeft.y>pc.height/2&&(Dc=
!0,wb.wq=!0,oc=1);wb.Jz&&(wb.wq=wb.vq);if(Dc){nb=nb.Xj("DragSelectionClickBehaviorCellRangeAndTable.OnPointerMoveDragInsert",nb.YG,oc);try{nb.Tr(Pb),nb.$$mn(),Pb=nb.$$cu().range}finally{nb&&nb.dispose()}}wb.qb.eh(wb.yh);wb.yh=wb.wq?[11]:[12];for(nb=1;4>=nb;nb++)(pc=wb.Eh[nb.toString()])&&pc.parentNode.removeChild(pc),wb.Eh[nb.toString()]=null;wb.Gz(uc.clientPoint,uc.zb,wb.wq?11:12,!0);wb.gb=wb.E2(Pb)}wb.ha.sourceRange=wb.gb;wb.qb.Ti(wb.gb,wb.yh);wb.qb.qn(wb.yh);wb.qb.eh(wb.ZA());if(6!==wb.Rh){for(uc=
1;4>=uc;uc++)Pb=wb.Eh[uc.toString()],Pb.parentNode.removeChild(Pb),wb.qb.cw(wb.isRow||wb.wq?11:12,uc).mf.appendChild(Pb);wb.Rh=6}wb.ry()}return!0};wb.uOa=function(){wb.Ih?wb.Jp&&5<=wb.Rh&&(wb.tableRange?wb.Wt?wb.HA(!0):wb.p$(!0):wb.Wt?wb.isRow||wb.Te?wb.HA(!0):wb.R2(!0):wb.isRow||wb.Te?wb.R2(!0):wb.HA(!0)):wb.Jp&&5<=wb.Rh&&(wb.tableRange?(wb.qb.eh(wb.yh),wb.Ht(wb.tN,wb.vN)):(wb.qb.eh(wb.ZA()),wb.Ht(wb.ai,wb.Bf)))};wb.tableManager=Rc;wb.tableRange=null;wb.Wt=!1;wb.Vt=!1;wb.$La=!1;wb.ha.AZb(wb.uOa);
return wb}function I(fb,ac,Ac,Rc){var Fc=U.call(this,fb,ac,Ac,Rc)||this;Fc.yh=null;Fc.isRow=!1;Fc.Te=!1;Fc.ug=function(){Fc.domElement.classList.remove(J.selecting)};Fc.ep=function(){Fc.domElement.classList.add(J.selecting)};Fc.Rc=function(){if(Fc.$.isEditMode){var wb=Fc.Lwc();Fc.svc(wb)}};Fc.Eh={};Fc.Jp=!1;Fc.ha.s2(Fc.ep);Fc.ha.gY(Fc.ug);Fc.ha.UD(Fc.Rc);return Fc}function F(fb,ac,Ac,Rc,Fc){var wb=U.call(this,fb,ac,Ac,Fc)||this;wb.dia=ha.a.instance.ga(2234);wb.ssb=ha.a.instance.ga(2235);wb.yna=ha.a.instance.ga(2236);
wb.bLb=ha.a.instance.ga(2237);wb.yh=null;wb.Jz=null;wb.wq=!1;wb.isRow=!1;wb.Te=!1;wb.vq=!1;wb.lM=null;wb.dO=null;wb.EAb=0;wb.zn=0;wb.onKeyDown=function(uc){if(wb.Ih){if(wb.hka(uc)||uc.Ca.keyCode===Cb.a.rea)return wb.$La||(ab.KeyInputManager.instance.ra(ra.a.Gd,wb.domElement.ownerDocument.body,wb.onKeyUp),wb.$La=!0),!wb.Vt&&wb.hka(uc)&&(Ob.g(wb.$).hg.vo(F.Iqb),wb.Vt=!0),wb.Wt||uc.Ca.keyCode!==Cb.a.rea||(Ob.g(wb.$).hg.vo(U.s1a),wb.Wt=!0,2===wb.zn?(wb.HA(!1),wb.jE=0,wb.yh=wb.vq?[11]:[12],wb.wq=wb.vq,
wb.HPa(),wb.wI()):3===wb.zn?(wb.R2(!1),wb.jE=wb.isRow?1:2,wb.NN(),wb.uy()):1===wb.zn&&(wb.p$(!1),wb.NN(),wb.uy())),!0}else if(!wb.Vt&&(uc.Ca.keyCode===Cb.a.Z7||Xa.a.isMac&&uc.Ca.keyCode===Cb.a.Aoa))return ab.KeyInputManager.instance.ra(ra.a.Gd,wb.domElement.ownerDocument.body,wb.onKeyUp),Ob.g(wb.$).hg.vo(F.Iqb),wb.Vt=!0;return!1};wb.onKeyUp=function(uc){if(wb.Ih){if(wb.hka(uc)||uc.Ca.keyCode===Cb.a.rea)return wb.EAb=wb.hka(uc)?0:1,wb.Jp&&Ob.g(wb.$).hg.vo(U.s1a),uc.Ca.keyCode===Cb.a.rea&&(2===wb.zn?
(wb.R2(!1),wb.jE=0,wb.NN(!0),wb.uy(!0)):3===wb.zn?(wb.HA(!1),wb.jE=wb.isRow?1:2,wb.yh=wb.isRow?[11]:[12],wb.HPa(!0),wb.wI(!0)):1===wb.zn&&(wb.HA(!1),wb.yh=wb.vq?[11]:[12],wb.uza(!0),wb.wI(!0))),wb.roa(wb.EAb),!0}else if(uc.Ca.keyCode===Cb.a.Z7||Xa.a.isMac&&uc.Ca.keyCode===Cb.a.Aoa)return wb.roa(),wb.Jp&&Ob.g(wb.$).hg.vo(U.g6c),!0;return!1};wb.vN=function(uc){uc=Wa.a(wb.$).Rd(uc);5===wb.Rh?wb.nAd(uc):(wb.Jp=!1,wb.qb.eh(wb.yh),!wb.$.hq([wb.gb],!1)||wb.bGd()||wb.szb()||(wb.ha.sourceRange=wb.sourceRange.clone(),
wb.Ih?wb.BEd():wb.ptb(),wb.Rx()?wb.gb.top>wb.sourceRange.top&&(uc=wb.gb.height,wb.gb.top-=uc,wb.gb.bottom-=uc):wb.gb.left>wb.sourceRange.left&&(uc=wb.gb.width,wb.gb.left-=uc,wb.gb.right-=uc),wb.XK()));wb.Ht(wb.tN,wb.vN);wb.tableRange=null;wb.Rh=-1;wb.Ih&&(wb.Jz=null,wb.zn=0);return!0};wb.m6=function(){wb.Jp=!1;wb.zn=0;wb.qb.eh(wb.yh);if(!wb.$.hq([wb.gb],!1))return wb.Ht(wb.l6,wb.m6),wb.Rh=-1,!0;if(!(wb.ha.sa.Vc.equals(wb.gb)||wb.bka(wb.gb)||wb.bka(wb.sourceRange)||wb.szb())){wb.XK();wb.ha.sourceRange=
wb.sourceRange.clone();var uc=wb.ha.sourceRange,Pb=wb.ha.sa.Vc,sc={};wb.$.Fd(-694765314,2,30,(sc[Ka.a.Jta]=wb.Vt,sc[Ka.a.$6b]=!0,sc[Ka.a.a7b]=wb.wq,sc[Ka.a.x3]=uc,sc[Ka.a.w3]=Pb,sc[Ka.a.qsb]=wb.Wt,sc));wb.Vt||(wb.gb.top>wb.sourceRange.top&&(wb.isRow||wb.gb.left===wb.sourceRange.left&&wb.wq)?(uc=wb.gb.height,wb.gb.top-=uc,wb.gb.bottom-=uc):wb.gb.left>wb.sourceRange.left&&(wb.Te||wb.gb.top===wb.sourceRange.top&&!wb.wq)&&(uc=wb.gb.width,wb.gb.left-=uc,wb.gb.right-=uc),wb.XK())}wb.Ht(wb.l6,wb.m6);wb.tableRange=
null;wb.Jz=null;wb.Rh=-1;wb.wq=!1;return!0};wb.tN=function(uc){var Pb=vb.EwaSettings.isChangeGateEnabled("OfficeVSO:5719921_FixDragAndDropCTTableRowOnZoom");Pb&&(uc=Wa.a(wb.$).Rd(uc));var sc=uc.clientPoint;Pb||(uc=Wa.a(wb.$).Rd(uc));wb.Ih&&(wb.tw=uc);if(uc=wb.ha.Kn(sc,uc.zb,5,void 0,void 0,!0)){if(wb.tableRange.contains(uc.topLeft)){Pb=Ob.g(wb.$);var nb=Pb.fg(uc),pc=Pb.Cf(wb.paneType);sc=Qa.a.hs(pc.view.Fh,wb.domElement.parentNode,sc,Pb.rtl);pc=!1;var Dc=2;wb.Rx()&&sc.y-nb.topLeft.y>nb.height/2?(pc=
!0,Dc=1):!wb.Rx()&&sc.x-nb.topLeft.x>nb.width/2&&(pc=!0);if(pc){Pb=Pb.Xj("DragSelectionClickBehavior.OnPointerMoveRearrange",Pb.YG,Dc);try{Pb.Tr(uc),Pb.$$mn(),uc=Pb.$$cu().range}finally{Pb&&Pb.dispose()}}wb.gb=wb.E2(uc);wb.ha.sourceRange=wb.gb;wb.qb.Ti(wb.gb,wb.yh);wb.qb.qn(wb.yh);wb.qb.eh(wb.ZA());if(6!==wb.Rh){for(uc=1;4>=uc;uc++)Pb=wb.Eh[uc.toString()],Pb.parentNode.removeChild(Pb),wb.qb.cw(wb.Rx()?11:12,uc).mf.appendChild(Pb);wb.Rh=6}}else if(wb.gb=wb.rha(uc),wb.Ih)wb.mwb(!1);else if(wb.qb.Ti(wb.gb,
wb.ZA()),wb.qb.qn(wb.ZA()),wb.qb.eh(wb.yh),5!==wb.Rh){for(uc=1;4>=uc;uc++)Pb=wb.Eh[uc.toString()],Pb.parentNode.removeChild(Pb),wb.qb.cw(wb.Iaa(),uc).mf.appendChild(Pb);wb.Rh=5}wb.ry()}return!0};wb.l6=function(uc){var Pb=vb.EwaSettings.isChangeGateEnabled("OfficeVSO:5719921_FixDragAndDropCTTableRowOnZoom");Pb&&(uc=Wa.a(wb.$).Rd(uc));var sc=uc.clientPoint;Pb||(uc=Wa.a(wb.$).Rd(uc));wb.tw=uc;if(Pb=wb.ha.Kn(sc,uc.zb,5,void 0,void 0,!0)){if(wb.Cwb(Pb))return wb.gb=wb.rha(Pb),wb.lwb(!1),!0;var nb=Ob.g(wb.$),
pc=nb.fg(Pb),Dc=nb.Cf(wb.paneType);sc=Qa.a.hs(Dc.view.Fh,wb.domElement.parentNode,sc,nb.rtl);Dc=!1;var oc=2;wb.wq=!1;if(wb.isRow||wb.Te){wb.isRow&&sc.y-pc.topLeft.y>pc.height/2?(Dc=!0,oc=1):wb.Te&&sc.x-pc.topLeft.x>pc.width/2&&(Dc=!0);if(Dc){uc=nb.Xj("DragSelectionClickBehavior.OnPointerMoveDragInsert",nb.YG,oc);try{uc.Tr(Pb),uc.$$mn(),Pb=uc.$$cu().range}finally{uc&&uc.dispose()}}wb.gb=wb.rha(Pb)}else{sc.x-pc.topLeft.x===pc.width?(wb.wq=!1,Dc=!0):sc.y-pc.topLeft.y>pc.height/2&&(Dc=!0,wb.wq=!0,oc=
1);wb.Jz&&(wb.wq=wb.vq);if(Dc){nb=nb.Xj("DragSelectionClickBehavior.OnPointerMoveDragInsert",nb.YG,oc);try{nb.Tr(Pb),nb.$$mn(),Pb=nb.$$cu().range}finally{nb&&nb.dispose()}}wb.qb.eh(wb.yh);wb.yh=wb.wq?[11]:[12];for(nb=1;4>=nb;nb++)(pc=wb.Eh[nb.toString()])&&pc.parentNode.removeChild(pc),wb.Eh[nb.toString()]=null;wb.Gz(uc.clientPoint,uc.zb,wb.wq?11:12,!0);wb.gb=wb.E2(Pb)}wb.ha.sourceRange=wb.gb;wb.qb.Ti(wb.gb,wb.yh);wb.qb.qn(wb.yh);wb.qb.eh(wb.ZA());if(6!==wb.Rh){for(uc=1;4>=uc;uc++)Pb=wb.Eh[uc.toString()],
Pb.parentNode.removeChild(Pb),wb.qb.cw(wb.isRow||wb.wq?11:12,uc).mf.appendChild(Pb);wb.Rh=6}wb.ry()}return!0};wb.ug=function(){wb.domElement.classList.remove(J.selecting)};wb.ep=function(){wb.domElement.classList.add(J.selecting)};wb.Rc=function(){if(wb.$.isEditMode){var uc=wb.Lwc();wb.svc(uc)}};wb.uOa=function(){wb.Ih?wb.Jp&&5<=wb.Rh&&(wb.tableRange?wb.Wt?wb.HA(!0):wb.p$(!0):wb.Wt?wb.isRow||wb.Te?wb.HA(!0):wb.R2(!0):wb.isRow||wb.Te?wb.R2(!0):wb.HA(!0)):wb.Jp&&5<=wb.Rh&&(wb.tableRange?(wb.qb.eh(wb.yh),
wb.Ht(wb.tN,wb.vN)):(wb.qb.eh(wb.ZA()),wb.Ht(wb.ai,wb.Bf)))};wb.tableManager=Rc;wb.tableRange=null;wb.Eh={};wb.Jp=!1;wb.Vt=!1;wb.Wt=!1;wb.$La=!1;wb.ha.s2(wb.ep);wb.ha.gY(wb.ug);wb.ha.AZb(wb.uOa);wb.ha.UD(wb.Rc);return wb}function G(fb,ac){this.destinationRange=this.sourceRange=null;this.sourceRange=fb;this.destinationRange=ac}function T(fb,ac,Ac,Rc,Fc,wb,uc,Pb){Pb=fb.Na(41,void 0===Pb?null:Pb);Pb.sourceRange=ac;Pb.destinationRange=Ac;return ub.g(fb,"RearrangeRowColumn",Pb,Rc,Fc,wb,uc,0)}function O(fb,
ac,Ac,Rc,Fc,wb){var uc=U.call(this,fb,ac,Ac,Fc)||this;uc.PK=null;uc.Ya=null;uc.B4e=function(){uc.ttb(!0)};uc.gridView=Ob.g(uc.$);uc.hF=Rc;uc.coloredReferencesManager=uc.$.da.za(281);ba.ULS.shipAssertTag(537159391,0,!!uc.coloredReferencesManager,"DragMarqueeClickBehavior Ctor: coloredReferencesManager is null. We already have marquee highlights so it shouldn't happen.");fb=bk(uc.Gr);for(ac=fb.next();!ac.done;ac=fb.next())ac=ac.value,oa.a.instance.ra(ra.a.aW,ac,uc.hF.N7e),oa.a.instance.ra(ra.a.fy,ac,
uc.hF.O7e);uc.CYa(wb);return uc}function U(fb,ac,Ac,Rc){var Fc=H.call(this,fb)||this;Fc.kSa=!1;Fc.oje=null;Fc.nje=null;Fc.tra=0;Fc.Ih=vb.EwaSettings.getBooleanFeatureGate(yb.a.Z6b,!1);Fc.ggi=vb.EwaSettings.getBooleanFeatureGate(yb.a.ohh,!1);Fc.jE=0;Fc.Ndc=0;Fc.gCc=0;Fc.pma=null;Fc.sourceRange=null;Fc.gb=null;Fc.tw=null;Fc.Bf=function(wb){wb=Wa.a(Fc.$).Rd(wb);return Fc.nAd(wb)};Fc.onPointerDown=function(wb){wb=Wa.a(Fc.$).Rd(wb);if(2===wb.lb&&wb.Hn===Sys.UI.MouseButton.leftButton&&!Fc.kSa){var uc=Fc.Mbc(wb);
if(!uc)return ba.ULS.shipAssertTag(537159379,0,!1,"DragSelectionClickBehaviorBase.OnPointerDown: GetSelectedRange failed"),!1;Fc.gb=uc.clone();Fc.sourceRange=Fc.gb.clone();Fc.pma=Fc.gb;if(uc=Fc.BRh(wb))Fc.Rh=5,Fc.gCc=uc.top-Fc.sourceRange.top,Fc.Ndc=uc.left-Fc.sourceRange.left,Ob.g(Fc.$).hg.vo(Fc.Ih?U.s1a:U.g6c),Fc.Cnc(wb),Fc.kSa=!0,ec.b(Fc.$,!0)}return!1};Fc.ai=function(wb){wb=Wa.a(Fc.$).Rd(wb);if(Fc.Ih&&Fc.Enc(wb))return!0;if(wb=Fc.ha.Kn(wb.clientPoint,wb.zb,5,void 0,void 0,!0)){wb=Fc.rha(wb);if(Fc.gb.equals(wb))return!0;
Fc.gb=wb;if(!Fc.uy())return ba.ULS.shipAssertTag(537159378,0,!1,"DragSelectionClickBehaviorBase.OnPointerMove: UpdateHighlightOnMove failed"),Fc.ttb(!0),!1}return!0};Fc.Yc=function(wb,uc){uc.VM||Fc.svc(Fc.$.isEditMode)};Fc.Gr=[];Fc.$=ac;Fc.ha=Ob.g(Fc.$).ha;Fc.paneType=Ac;Fc.Wn=Rc;ac=vb.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");ac=bk(Fc.ggi?ac?[J.Wuh,J.Juh,J.Ouh,J.Suh]:[J.Yuh,J.Luh,J.Quh,J.Uuh]:ac?[J.Vuh,J.Iuh,J.Nuh,J.Ruh]:[J.Xuh,J.Kuh,J.Puh,J.Tuh]);for(Ac=ac.next();!Ac.done;Ac=
ac.next())Ac=Fc.Wn.rCe(fb,Ac.value,Fc.Ih?[J.Muh]:[J.Huh],Fc.onPointerDown),Fc.Gr.push(Ac);Fc.$.Tk(Fc.Yc);Fc.svc(Fc.$.isEditMode);return Fc}function J(){}function H(fb){var ac=C.call(this,fb)||this;var Ac=document.createElement("div");Ac.className=kb.a.bvh;fb.appendChild(Ac);return ac}function K(fb,ac,Ac,Rc){return N.call(this,fb,ac,Ac,Rc)||this}function N(fb,ac,Ac,Rc){var Fc=C.call(this,ac)||this;Fc.Mnb=!1;Fc.$Vc=!1;Fc.oqd=!1;Fc.jpb=null;Fc.kqd=!1;Fc.uba=!1;Fc.qw=function(){Fc.Mnb&&Fc.kqd?Fc.Ena():
Fc.t4()};Fc.Wwf=function(uc){3===uc.lb&&(Fc.kqd=!0,Fc.Ena());return!1};Fc.Xwf=function(uc){if(3===uc.lb){if(!uc.zb||Fc.Kgi(uc))return!1;Fc.kqd=!1;Fc.t4()}return!1};Fc.ug=function(){Fc.uba&&Fc.ZWd();Fc.Ena();Fc.oqd=!1};Fc.ep=function(){Fc.t4();Fc.oqd=!0};Fc.tya=function(uc,Pb){Pb.w4===Fc.w4&&(Pb.visible?Fc.oqd||Fc.Ena():Fc.t4())};Fc.PCf=function(){Fc.Ywf(Fc.wO.domElement,!1)};Fc.stf=function(){Fc.Ywf(Fc.XL.domElement,!0)};Fc.Rmc=function(uc,Pb){Fc.ha.iza(Pb)};Fc.Smc=function(uc,Pb){Fc.ha.iza(Ia.b(Pb))};
Fc.sEb=function(){3===Ha.a.Cb?Fc.Ena():Fc.t4();Fc.uba&&1===Ha.a.Cb&&Fc.ZWd()};Fc.QCf=function(){Fc.Tnj()};Fc.VIe=function(){Fc.t4()};Fc.ap=function(){Fc.ha.Oa.Yb&&Fc.t4()};Fc.gtf=function(){Fc.t4()};Fc.Pwf=function(uc,Pb){Fc.ZWd();3===Pb.lb?Fc.Ena():Fc.t4()};Fc.Fqc=function(){Fc.Mnb&&(Fc.t4(),Fc.Ena())};var wb=Ac.$;Fc.Mq=Ac;Fc.ha=Ac.ha;Fc.bba=fb;Fc.rlj=ac;Fc.paneType=Rc;fb=Fc.domElement.currentStyle;ac="#000000";fb&&(ac=fb.borderTopColor);Fc.wO=new M(Fc.D$c(),ac,wb);Fc.XL=new M(Fc.D$c(),ac,wb);Fc.cef=
wb.ea.isNamedObjectViewMode&&1===wb.workbookContext.NovMode;Fc.wO.ume(Fc.PCf);Fc.wO.tme(Fc.Rmc);Fc.wO.vme(Fc.Smc);Fc.XL.ume(Fc.stf);Fc.XL.tme(Fc.Rmc);Fc.XL.vme(Fc.Smc);fb=bk(Fc.gridView.en);for(ac=fb.next();!ac.done;ac=fb.next())ac=ac.value,db.a.instance.ra(ra.a.rf,ac.domElement,Fc.Xwf),db.a.instance.ra(ra.a.pe,ac.domElement,Fc.Wwf);Ac.view.Es(Fc.qw);Ac.Wb.Ak(Fc.VIe);Ac.qb.fnb(Fc.tya);Ac.fUc(Fc.gtf);wb.sA(Fc.Fqc);Ac.yu(Fc.Fqc);Fc.ha.gY(Fc.ug);Fc.ha.s2(Fc.ep);Ac.QD(Fc.ap);Fc.ha.$Yb(Fc.Pwf);Ha.a.Eme(Fc.sEb);
ua.TaskExtensions.Aa(va.GetServiceTaskFactory.Ra(wb.da,376,377,0),function(uc){uc.result.IGg(Fc.QCf)},wb.la,3);return Fc}function M(fb,ac,Ac){var Rc=qb.call(this,document.createElement("div"))||this;Rc.e5b=null;Rc.TOb=!1;Rc.onPointerDown=function(Fc){Fc=Wa.a(Rc.$)?Wa.a(Rc.$).Rd(Fc):Fc;Rc.TOb=!1;if(3===(Ha.a.Cb=Fc.lb)){var wb=Fc.Ca.rawEvent,uc=wb.srcElement||wb.target;xa.DOMElementExtensions.nf(Rc.domElement,uc)&&xa.DOMElementExtensions.nf(wb.currentTarget,uc)&&(Rc.TOb=!0,Rc.e5b=Fc.clientPoint)}return!1};
Rc.Bf=function(Fc){Fc=Wa.a(Rc.$)?Wa.a(Rc.$).Rd(Fc):Fc;Rc.raiseEvent("GrPointerUp",Fc);return Rc.TOb=!1};Rc.ai=function(Fc){Fc=Wa.a(Rc.$)?Wa.a(Rc.$).Rd(Fc):Fc;3===Fc.lb&&Rc.TOb&&Rc.y4h(Fc.clientPoint)&&(Rc.raiseEvent("GrDrag"),Rc.TOb=!1);return!1};Rc.$c=function(Fc){Wa.a(Rc.$)&&Wa.a(Rc.$).Rd(Fc);return!0};Rc.$=Ac;Ac=!vb.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");Rc.domElement.classList.add(Ac?kb.a.xPe:kb.a.wPe);Rc.domElement.classList.add(kb.a.z8b);fb.appendChild(Rc.domElement);
xa.DOMElementExtensions.setVisible(Rc.domElement,!1);Rc.wKa=document.createElement("div");Rc.wKa.classList.add(kb.a.y8b);Rc.wKa.style.borderColor=ac;Rc.domElement.appendChild(Rc.wKa);oa.a.instance.ra(ra.a.pointerDown,Rc.domElement,Rc.onPointerDown);oa.a.instance.ra(ra.a.Df,Rc.domElement,Rc.Bf);db.a.instance.ra(ra.a.pe,Rc.domElement,Rc.Bf);oa.a.instance.ra(ra.a.Rj,Rc.domElement,Rc.ai);db.a.instance.ra(ra.a.lg,Rc.domElement,Rc.ai);La.a.instance.ra(ra.a.click,Rc.domElement,Rc.$c);return Rc}function C(fb,
ac){return sa.call(this,fb,void 0===ac?null:ac)||this}function Q(fb){var ac=na.call(this)||this;ac.Vnf=[3];ac.gridView=fb;ac.FWd=qa.a.S4(ac.gridView.$);return ac}function P(fb,ac){var Ac=da.call(this)||this;Ac.start=fb;Ac.Ixb=ac;return Ac}function ka(fb){var ac=ja.call(this)||this;ac.$=fb;ac.Eb();return ac}function R(fb){var ac=X.call(this)||this;fb.da.Ga(376,ac);return ac}var fa=b(10),ca=b(0),ea=b(232),wa=b(38),X=wa.a;Rk(R,X);R.prototype.IGg=function(fb){this.addHandler("TAF",fb)};R.prototype.qcj=
function(fb){this.removeHandler("TAF",fb)};R.prototype.O2i=function(){this.raiseEvent("TAF")};Object(ca.a)(R,"GridHighlightBehaviorEventManager",wa.a,[635,3]);var ja=ea.a;Rk(ka,ja);ka.prototype.create=function(){this.pb(this.$.da.za(376)||new R(this.$))};ka.ka=function(fb){fb.da.Ga(377,new ka(fb))};Object(ca.a)(ka,"GridHighlightBehaviorEventManagerFactory",ea.a,[]);var va=b(51),ua=b(37),Xa=b(27),aa=b(79),ba=b(14),oa=b(245),ra=b(13),db=b(161),Ka=b(5),Ga=b(114),xa=b(12),da=Sys.EventArgs;Rk(P,da);Object(ca.a)(P,
"MarqueeResizeStartedOrEndedEventArgs",Sys.EventArgs,[]);var qa=b(36),na=wa.a;Rk(Q,na);Q.prototype.hFg=function(fb){this.addHandler("mrek",fb)};Q.prototype.Aw=function(fb,ac,Ac){for(var Rc=bk(this.gridView.en),Fc=Rc.next();!Fc.done;Fc=Rc.next())oa.a.instance.ra(ra.a.Rj,Fc.value.domElement,fb);oa.a.instance.ra(ra.a.Df,document.documentElement,ac);this.gridView.$b.x7b(!0);Ac&&oa.a.instance.ra(ra.a.fy,this.gridView.yj,ac)};Q.prototype.VWd=function(fb,ac,Ac){for(var Rc=bk(this.gridView.en),Fc=Rc.next();!Fc.done;Fc=
Rc.next())oa.a.instance.Ba(ra.a.Rj,Fc.value.domElement,fb);oa.a.instance.Ba(ra.a.Df,document.documentElement,ac);this.gridView.$b.x7b(!1);Ac&&oa.a.instance.Ba(ra.a.fy,this.gridView.yj,ac)};Q.prototype.E7i=function(fb,ac){for(var Ac=bk(this.gridView.en),Rc=Ac.next();!Rc.done;Rc=Ac.next())db.a.instance.ra(ra.a.lg,Rc.value.domElement,fb);db.a.instance.ra(ra.a.pe,document.documentElement,ac)};Q.prototype.AOj=function(fb,ac){for(var Ac=bk(this.gridView.en),Rc=Ac.next();!Rc.done;Rc=Ac.next())db.a.instance.Ba(ra.a.lg,
Rc.value.domElement,fb);db.a.instance.Ba(ra.a.pe,document.documentElement,ac)};Q.prototype.rCe=function(fb,ac,Ac,Rc){var Fc=document.createElement("div");Fc.className=ac;ac=bk(Ac);for(Ac=ac.next();!Ac.done;Ac=ac.next())Fc.classList.add(Ac.value);fb.appendChild(Fc);oa.a.instance.ra(ra.a.pointerDown,Fc,Rc);return Fc};Q.prototype.W0e=function(fb){fb=fb.zb.parentNode;if(!fb)return ba.ULS.shipAssertTag(537159394,0,!1,"BehaviorHelperMethods.GetSelectedMarqueeHighlightState: selectedHighlightElement is null."),
null;fb=parseInt(fb.getAttribute(Ka.a.Ixb),10);return isNaN(fb)?(ba.ULS.shipAssertTag(537159393,0,!1,"BehaviorHelperMethods.GetSelectedMarqueeHighlightState: indexInMarqueeCollection is not a valid number."),null):this.gridView.qb.cw(3,1,fb)};Q.prototype.GKb=function(fb,ac,Ac){fb=(void 0===Ac?!0:Ac)&&!!this.coloredReferencesManager&&this.coloredReferencesManager.Tii(fb);ac=bk(ac);for(Ac=ac.next();!Ac.done;Ac=ac.next())xa.DOMElementExtensions.setVisible(Ac.value,fb)};Q.prototype.Ibd=function(){return this.gridView.pj?
Ga.a(this.gridView.$):this.gridView.Wb};Q.prototype.HLf=function(){var fb=this.Ibd();fb&&this.coloredReferencesManager?this.FWd?fb.$F(null):this.coloredReferencesManager.$F(fb,null):(ba.ULS.sendTraceTag(537159392,0,10,"BehaviorHelperMethods.RecalculateColoredReferences: Can't UpdateColoredReferences, will hide all marquee as a last fallback."),this.gridView.qb.eh(this.Vnf),this.gridView.qb.Ti(null,this.Vnf))};Q.prototype.RJf=function(fb,ac){this.raiseEvent("mrek",new P(fb,ac))};Mf.Object.defineProperties(Q.prototype,
{coloredReferencesManager:{configurable:!0,enumerable:!0,get:function(){var fb=this.gridView.$.da.za(281);fb||ba.ULS.sendTraceTag(537159395,0,50,"BehaviorHelperMethods.ColoredReferencesManager: coloredReferencesManager is null. (This is not always an error, for example when called from SetMarqueeHandlesVisibility while moving between view and edit modes).");return fb}}});Object(ca.a)(Q,"BehaviorHelperMethods",wa.a,[]);var ia=b(89),ta=b(39),za=b(94),sa=za.a;Rk(C,sa);C.prototype.CYa=function(){};Object(ca.a)(C,
"HighlightFlyweightBehavior",za.a,[]);var V=b(19),Ia=b(495),Ha=b(76),ob=b(11),ib=b(117),La=b(233),zb=b(43),Fb=b(244),Yb=b(8),kb=b(71),vb=b(1),Wa=b(33),qb=Fb.a;Rk(M,qb);M.prototype.ume=function(fb){this.addHandler("GrDrag",fb)};M.prototype.qPf=function(fb){this.removeHandler("GrDrag",fb)};M.prototype.tme=function(fb){this.addHandler("GrContxt",fb)};M.prototype.pPf=function(fb){this.removeHandler("GrContxt",fb)};M.prototype.vme=function(fb){this.addHandler("GrPointerUp",fb)};M.prototype.rPf=function(fb){this.removeHandler("GrPointerUp",
fb)};M.prototype.dispose=function(){zb.a.Bma(this.domElement);qb.prototype.dispose.call(this)};M.prototype.Bcg=function(fb){this.domElement.parentNode.removeChild(this.domElement);fb.appendChild(this.domElement)};M.prototype.oXf=function(){this.domElement.classList.remove(kb.a.z8b);this.wKa.classList.remove(kb.a.y8b);this.wKa.classList.add(kb.a.yPe)};M.prototype.Uag=function(){this.wKa.classList.remove(kb.a.yPe);this.wKa.classList.add(kb.a.y8b);this.domElement.classList.add(kb.a.z8b)};M.prototype.y4h=
function(fb){return!!this.e5b&&(3<Math.abs(fb.x-this.e5b.x)||3<Math.abs(fb.y-this.e5b.y))};M.Iub=function(fb){return vb.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")?(fb=Wa.a(fb.$)?Wa.a(fb.$).zoom:Yb.a.x_,Math.round(9/Math.max(fb,1))):9};M.Pud=0;Object(ca.a)(M,"TouchGrippie",Fb.a,[]);Rk(N,C);N.prototype.dispose=function(){ia.a.oc([this.wO,this.XL]);this.wO.qPf(this.PCf);this.wO.pPf(this.Rmc);this.wO.rPf(this.Smc);this.XL.qPf(this.stf);this.XL.pPf(this.Rmc);this.XL.rPf(this.Smc);
for(var fb=bk(this.gridView.en),ac=fb.next();!ac.done;ac=fb.next())ac=ac.value,db.a.instance.Ba(ra.a.rf,ac.domElement,this.Xwf),db.a.instance.Ba(ra.a.pe,ac.domElement,this.Wwf);this.gridView.view.Fq(this.qw);this.gridView.Wb.vk(this.VIe);this.gridView.qb.hIb(this.tya);this.gridView.$Hd(this.gtf);this.gridView.$.gD(this.Fqc);this.gridView.jy(this.Fqc);this.ha.rW(this.ug);this.ha.S6(this.ep);this.gridView.yF(this.ap);this.ha.Yrc(this.Pwf);Ha.a.zPf(this.sEb);this.uba&&ba.ULS.sendTraceTag(537159314,0,
15,"SelectionTouchGrippiesBehaviorBase.Dispose during autofill mode");(fb=this.gridView.$.da.za(376))&&fb.qcj(this.QCf);C.prototype.dispose.call(this)};N.prototype.FRa=function(){if(!this.bba.range||!this.bba.range.equals(this.Tbb))return!1;var fb=!this.gridView.cMa();return this.gridView.isEditing&&fb&&(this.Tbb.isRow||this.Tbb.Te)?!1:this.uba?!0:3===Ha.a.Cb};N.prototype.t4=function(){this.Mnb&&(this.wO.set_visible(!1),this.XL.set_visible(!1),this.Mnb=!1)};N.prototype.Ena=function(){if(this.FRa()){this.YRj();
var fb=xa.DOMElementExtensions.getBoundingClientRect(this.jpb);fb||ba.ULS.shipAssertTag(537159313,0,!1,"grippiesParentBounds is null. IsNamedObjectViewMode: {0}, isNov15: {1}, areGrippiesAttachedToNovFocusPane: {2}GridView.ContainerElement: {3}, Freezepanes: {4}",this.gridView.$.ea.isNamedObjectViewMode,this.cef,this.$Vc,this.gridView.yj,this.gridView.eb.Ji);var ac=xa.DOMElementExtensions.getBoundingClientRect(this.rlj),Ac=new Sys.UI.Bounds(ac.x-fb.x,ac.y-fb.y,ac.width,ac.height),Rc=this.Tbb,Fc=Rc.topLeft,
wb=Rc.bottomRight,uc=Rc.isRow||Rc.Te;if(Rc.Te){var Pb=this.Zzh();Rc=Ac.x-2*M.Iub(this.gridView);var sc=Pb;var nb=Ac.x+ac.width}else Rc.isRow?(Rc=nb=this.Yzh(),sc=Ac.y-2*M.Iub(this.gridView),Pb=Ac.y+ac.height):(sc=Ac.y,Pb=Ac.y+ac.height,this.gridView.rtl?(Rc=Ac.x+ac.width,nb=Ac.x):(Rc=Ac.x,nb=Ac.x+ac.width));ac=M.Pud+(uc?0:M.Iub(this.gridView));this.wO.style.left=ob.HelperMethods.jc(Rc-ac);this.wO.style.top=ob.HelperMethods.jc(sc-ac);this.XL.style.left=ob.HelperMethods.jc(nb-ac);this.XL.style.top=
ob.HelperMethods.jc(Pb-ac);this.wO.set_visible(this.Bcf(sc,Rc,Fc,uc,fb));this.XL.set_visible(this.Bcf(Pb,nb,wb,uc,fb));this.Mnb=!0}};N.prototype.Bcf=function(fb,ac,Ac,Rc,Fc){var wb=xa.DOMElementExtensions.getBoundingClientRect(this.gridView.Cf(this.paneType).domElement);Fc=new Sys.UI.Bounds(wb.x-Fc.x-3,wb.y-Fc.y-3,wb.width+6,wb.height+6);return(this.gridView.eb.dj(Ac)===this.paneType||Rc)&&ta.a.SM(Fc,new Sys.UI.Point(ac,fb))};N.prototype.YRj=function(){if(this.cef!==this.$Vc){this.jpb=null;var fb=
this.D$c();this.wO.Bcg(fb);this.XL.Bcg(fb)}};N.prototype.Zzh=function(){return(this.gridView.view.visibleArea.height+this.gridView.eb.height+M.Pud-M.Iub(this.gridView))/2};N.prototype.Yzh=function(){return(this.gridView.view.visibleArea.width+this.gridView.eb.width+M.Pud-M.Iub(this.gridView))/2};N.prototype.$Af=function(){this.Ena()};N.prototype.Kgi=function(fb){return xa.DOMElementExtensions.Jbb(fb.zb,V.a.Lo)&&(this.Khi(fb)||this.Lhi(fb))};N.prototype.Lhi=function(fb){if(this.gridView.rtl)fb=fb.clientPoint.x;
else{var ac=xa.DOMElementExtensions.getBoundingClientRect(fb.zb);fb=fb.clientPoint.x-(ac.x+ac.width-ib.a.ev)}return 0<fb&&fb<=ib.a.ev};N.prototype.Khi=function(fb){var ac=xa.DOMElementExtensions.getBoundingClientRect(fb.zb);fb=fb.clientPoint.y-(ac.y+ac.height-ib.a.ev);return 0<fb&&fb<=ib.a.ev};N.prototype.Ywf=function(fb,ac){this.uba&&ba.ULS.sendTraceTag(537159312,0,50,"SelectionTouchGrippiesBehaviorBase: Performing Touch Autofill");this.ha.qZc(fb,ac,this.uba);this.t4()};N.prototype.Tnj=function(){this.uba||
(ba.ULS.sendTraceTag(537159311,0,50,"SelectionTouchGrippiesBehaviorBase.SetAutoFillMode"),this.uba=!0,this.wO.oXf(),this.XL.oXf(),this.gridView.ha.sourceRange=this.gridView.ha.sa.Vc,this.Ena())};N.prototype.ZWd=function(){this.uba&&(ba.ULS.sendTraceTag(537159310,0,50,"SelectionTouchGrippiesBehaviorBase.UnsetAutoFillMode"),this.uba=!1,this.wO.Uag(),this.XL.Uag())};N.prototype.D$c=function(){this.jpb||(this.$Vc=!1,this.jpb=this.gridView.yj);return this.jpb};Mf.Object.defineProperties(N.prototype,{gridView:{configurable:!0,
enumerable:!0,get:function(){return this.Mq}}});Object(ca.a)(N,"SelectionTouchGrippiesBehaviorBase",C,[]);Rk(K,N);K.prototype.FRa=function(){var fb=this.gridView.ui||this.gridView.isEditing;return!this.gridView.ha.sa.sg&&!fb&&N.prototype.FRa.call(this)};Mf.Object.defineProperties(K.prototype,{w4:{configurable:!0,enumerable:!0,get:function(){return 19}},Tbb:{configurable:!0,enumerable:!0,get:function(){return this.gridView.ha.sa.activeRange}}});Object(ca.a)(K,"DiscontinuousSelectionTouchGrippiesBehavior",
N,[]);var yb=b(327);Rk(H,C);Object(ca.a)(H,"SelectionBorderBehavior",C,[]);J.Huh="ewr-selection-draghandle";J.Muh="ewr-selection-draghandle-grab";J.Xuh="ewr-selection-draghandle-top-ie";J.Yuh="ewr-selection-draghandle-top-ie-enhanced";J.Vuh="ewr-selection-draghandle-top";J.Wuh="ewr-selection-draghandle-top-enhanced";J.Kuh="ewr-selection-draghandle-bottom-ie";J.Luh="ewr-selection-draghandle-bottom-ie-enhanced";J.Iuh="ewr-selection-draghandle-bottom";J.Juh="ewr-selection-draghandle-bottom-enhanced";
J.Puh="ewr-selection-draghandle-left-ie";J.Quh="ewr-selection-draghandle-left-ie-enhanced";J.Nuh="ewr-selection-draghandle-left";J.Ouh="ewr-selection-draghandle-left-enhanced";J.Tuh="ewr-selection-draghandle-right-ie";J.Uuh="ewr-selection-draghandle-right-ie-enhanced";J.Ruh="ewr-selection-draghandle-right";J.Suh="ewr-selection-draghandle-right-enhanced";J.FPe="ewr-selection-dragtooltip";J.GPe="ewr-selection-dragtooltip-updated";J.ivh="ewr_selection_rearrangeleft";J.jvh="ewr_selection_rearrangeright";
J.kvh="ewr_selection_rearrangetop";J.hvh="ewr_selection_rearrangebottom";J.selecting="selecting";J.lvh="ewr-selection-resizemarqueehandle";J.ovh="ewr-selection-resizemarqueehandle-topleft";J.pvh="ewr-selection-resizemarqueehandle-topright";J.mvh="ewr-selection-resizemarqueehandle-bottomleft";J.nvh="ewr-selection-resizemarqueehandle-bottomright";J.xuh="ewr-marquee-thick";J.Buh="ewr-resizemarqueehandle-thick";Object(ca.a)(J,"CssClassNames",null,[]);var ec=b(257),Ob=b(21);Rk(U,H);U.prototype.dispose=
function(){var fb=this;this.Gr.forEach(function(ac){oa.a.instance.Ba(ra.a.pointerDown,ac,fb.onPointerDown)});Array.clear(this.Gr);this.pma=this.sourceRange=this.gb=null;ba.ULS.sendTraceTag(537159381,0,50,"DragSelectionClickBehaviorBase.Dispose: ActiveRegistrationCount = {0}, EwaControl is null : {1}",this.tra,!this.$);this.$&&(this.$.rl(this.Yc),1===this.tra&&(ba.ULS.sendTraceTag(537159380,0,15,"DragSelectionClickBehaviorBase.Dispose: Some handlers are still registered"),this.Ht(this.nje,this.oje,
!1)));H.prototype.dispose.call(this)};U.prototype.nAd=function(fb){if(5!==this.Rh)return!1;(fb=this.rya(fb))||this.ttb(!1);ec.b(this.$,!1);return fb};U.prototype.Aw=function(fb,ac){ba.ULS.shipAssertTag(537159377,0,!this.tra,"DragSelectionClickBehaviorBase.RegisterHandlersForMouse: More than one active registration is not expected");this.tra+=1;this.nje=fb;this.oje=ac;this.Wn.Aw(fb,ac,this.Xzc())};U.prototype.rha=function(fb){if(!fb||!this.gb)return ba.ULS.shipAssertTag(537159376,0,!!fb,"DragSelectionClickBehaviorBase.CalculateDragRange: mouseSelectionRange is null"),
ba.ULS.shipAssertTag(537159375,0,!!this.gb,"DragSelectionClickBehaviorBase.CalculateDragRange: CurrentRange is null"),null;var ac=this.gb.clone();1!==this.jE&&(ac.left=Math.max(fb.left-this.Ndc,1),ac.right=ac.left+this.sourceRange.width-1);2!==this.jE&&(ac.top=Math.max(fb.top-this.gCc,1),ac.bottom=ac.top+this.sourceRange.height-1);return this.DYa(ac)};U.prototype.Ht=function(fb,ac,Ac,Rc){Ac=void 0===Ac?!0:Ac;Rc=void 0===Rc?!0:Rc;ba.ULS.shipAssertTag(537159374,0,1===this.tra,"DragSelectionClickBehaviorBase.CleanUp: Expected exactly one active registration");
--this.tra;this.Ih||Ob.g(this.$).hg.vo(Ka.a.m4);this.Wn.VWd(fb,ac,this.Xzc());Ac&&this.Lpb(Rc);this.jE=0;this.kSa=!1};U.prototype.DYa=function(fb){var ac=Ob.g(this.$),Ac=fb;if(ac.eb.p4){if(!ac.Ub(fb.topLeft)){ac=ac.Xj("DragSelectionClickBehaviorBase.AdjustHiddenRowColumns",ac.YG,this.pma.top!==fb.top?1:2);try{ac.Wk=this.pma.top<fb.top||this.pma.left<fb.left,ac.Tr(fb.topLeft),Ac=ac.$$cu().range}finally{ac&&ac.dispose()}}Ac.right=Ac.left+fb.width-1;Ac.bottom=Ac.top+fb.height-1}return this.pma=Ac};U.prototype.svc=
function(fb){this.Gr.forEach(function(ac){xa.DOMElementExtensions.setVisible(ac,fb)})};U.prototype.BRh=function(fb){var ac=fb.zb;fb=fb.clientPoint;if(!ac||!fb)return ba.ULS.shipAssertTag(537159373,0,!!ac,"DragSelectionClickBehaviorBase.GetMouseSelectionRange: source is null"),ba.ULS.shipAssertTag(537159372,0,!!fb,"DragSelectionClickBehaviorBase.GetMouseSelectionRange: point is null"),null;fb.y+=ac===this.Gr[U.qIa]?2:ac===this.Gr[U.k6c]?-2:0;fb.x+=ac===this.Gr[U.l6c]?2:ac===this.Gr[U.pIa]?-2:0;return this.ha.Kn(fb,
ac,5,void 0,void 0,!0)};Mf.Object.defineProperties(U.prototype,{qb:{configurable:!0,enumerable:!0,get:function(){return Ob.g(this.$).qb}},Rh:{configurable:!0,enumerable:!0,get:function(){return this.ha.selectionType},set:function(fb){this.ha.selectionType=fb}}});U.g6c="move";U.s1a="grabbing";U.qIa=0;U.k6c=1;U.l6c=2;U.pIa=3;Object(ca.a)(U,"DragSelectionClickBehaviorBase",H,[]);Rk(O,U);O.prototype.CYa=function(fb){this.Wn.GKb(fb,this.Gr);this.hF.Jza()};O.prototype.Cnc=function(fb){ba.ULS.sendTraceTag(537159390,
0,50,"DragMarqueeClickBehavior.OnPointerDownInternal: Starting drag marquee operation.");this.gridView.gLa=!0;this.Ya.bE(!1);this.Rh=5;this.hF.yIe(fb.zb);this.Ya.textBox.removeSelection();this.Ya.kZb(this.B4e);this.Aw(this.ai,this.Bf);this.jE=this.sourceRange.isRow?1:this.sourceRange.Te?2:0};O.prototype.rya=function(){var fb=this.XK();this.Rh=-1;this.Ht(this.ai,this.Bf);return fb};O.prototype.Lpb=function(){this.gridView.gLa=!1;this.hF.zIe(this.Gr[0]);this.Ya.textBox.setCaretPositionToEnd();this.Ya.jsc(this.B4e);
this.Wn.HLf()};O.prototype.ttb=function(fb){ba.ULS.sendTraceTag(537159389,0,10,"DragMarqueeClickBehavior.FailureFallback: Operation failed, will try to recalculate colored references as a fallback in CleanUp.");fb&&this.Ht(this.ai,this.Bf)};O.prototype.Mbc=function(fb){this.Ya=this.Wn.Ibd();this.PK=this.Wn.W0e(fb);return this.Ya&&this.PK&&this.PK.range?this.PK.range:(ba.ULS.shipAssertTag(537159388,0,!!this.Ya,"DragMarqueeClickBehavior.GetSelectedRange: cellContentEditor is null"),ba.ULS.shipAssertTag(537159387,
0,!!this.PK,"DragMarqueeClickBehavior.GetSelectedRange: selectedHighlightState is null"),ba.ULS.shipAssertTag(537159386,0,!!this.PK.range,"DragMarqueeClickBehavior.GetSelectedRange: selectedHighlightState.Range is null"),null)};O.prototype.XK=function(){return this.PK?this.coloredReferencesManager.Fpf(this.Ya,this.PK,this.gb):(ba.ULS.shipAssertTag(537159385,0,!1,"DragMarqueeClickBehavior.SetSelectedRange called when selectedHighlightState is null. It shouldn't be null while dragging a marquee highlight."),
!1)};O.prototype.uy=function(){return this.XK()};O.prototype.Xzc=function(){return!0};O.prototype.Enc=function(){return!1};Object(ca.a)(O,"DragMarqueeClickBehavior",U,[]);var Cb=b(86),ab=b(109),ya=b(178),ma=b(440),ha=b(15),Z=b(234),Na=b(24),eb=b(974),cb=b(45),Ua=b(564),pa=b(177),Qa=b(918),Db=b(121),Kb=b(31),Ab=b(294),ub=b(62);Object(ca.a)(G,"MacroRecorderTableRowColumnRearrangedPayload",null,[438]);var Mb=b(42);Rk(F,U);F.prototype.dispose=function(){this.ha&&(this.ha.S6(this.ep),this.ha.rW(this.ug),
this.ha.FId(this.uOa),this.ha.ZH(this.Rc));if(this.Eh)for(var fb=1;4>=fb;fb++)xa.DOMElementExtensions.ff(this.Eh[fb.toString()]);this.Eh=this.yh=null;this.Vt&&this.roa();this.Ih&&this.Wt&&this.roa(1);U.prototype.dispose.call(this)};F.prototype.Cnc=function(fb){this.Ih&&(this.tw=fb,this.Jz=null,this.vq=this.isRow=this.Te=this.wq=!1,ab.KeyInputManager.instance.ra(ra.a.Lb,this.domElement.ownerDocument.body,this.onKeyDown));this.Jp=!0;this.tableRange=this.KYc(this.tableManager.Vm(this.sourceRange.topLeft));
Ob.g(this.$);this.tableRange&&!this.tableRange.equals(this.sourceRange)?this.Ih?(this.Jz=this.tableRange,this.zn=1,this.yh=(this.vq=this.tableRange.left===this.sourceRange.left&&this.tableRange.right===this.sourceRange.right)?[11]:[12],this.Rh=6,this.Aw(this.tN,this.vN),this.lM=this.dia,this.dO=this.yna,this.Gz(fb.clientPoint,fb.zb,this.vq?11:12,!0,!0),this.wI(!0)):(this.yh=(this.isRow=this.tableRange.left===this.sourceRange.left&&this.tableRange.right===this.sourceRange.right)?[11]:[12],this.Rh=
6,this.Aw(this.tN,this.vN),this.Gz(fb.clientPoint,fb.zb,this.isRow?11:12,!0)):(this.tableRange=null,this.Ih?(this.isRow=this.sourceRange.isRow,this.Te=this.sourceRange.Te,this.isRow||this.Te?(this.zn=3,this.jE=this.isRow?1:2,this.Rh=6,this.yh=this.isRow?[11]:[12],this.Aw(this.l6,this.m6),this.lM=this.dia,this.dO=this.yna,this.Gz(fb.clientPoint,fb.zb,this.isRow?11:12,!0,!0),this.wI(!0)):(this.zn=2,this.jE=0,this.Aw(this.ai,this.Bf),this.lM=this.ssb,this.dO=this.bLb,this.Gz(fb.clientPoint,fb.zb,this.Iaa(),
!1,!0),this.uy(!0))):(this.Aw(this.ai,this.Bf),ab.KeyInputManager.instance.ra(ra.a.Lb,this.domElement.ownerDocument.body,this.onKeyDown),this.jE=this.sourceRange.isRow?1:this.sourceRange.Te?2:0,this.Gz(fb.clientPoint,fb.zb,this.Iaa(),!1),this.uy()))};F.prototype.rya=function(){this.Jp=!1;this.Ih&&(this.zn=0);this.qb.eh(this.ZA());if(!this.$.hq([this.gb],!1))return this.Ht(this.ai,this.Bf),this.Rh=-1,!0;if(this.ha.sa.Vc.equals(this.gb)||this.bka(this.gb)||this.bka(this.sourceRange))this.Rh=-1;else{this.XK();
this.ha.sourceRange=this.sourceRange.clone();var fb=this.ha.sourceRange,ac=this.ha.sa.Vc;if(this.Ih){var Ac={};this.$.Fd(-694765314,2,30,(Ac[Ka.a.Jta]=this.Vt,Ac[Ka.a.x3]=fb,Ac[Ka.a.w3]=ac,Ac[Ka.a.qsb]=this.Wt,Ac))}else Ac={},this.$.Fd(-694765314,2,30,(Ac[Ka.a.Jta]=this.Vt,Ac[Ka.a.x3]=fb,Ac[Ka.a.w3]=ac,Ac))}!this.Ih&&this.tableRange||this.Ht(this.ai,this.Bf);return!0};F.prototype.Lpb=function(fb){fb&&(ab.KeyInputManager.instance.Ba(ra.a.Lb,this.domElement.ownerDocument.body,this.onKeyDown),this.Ih&&
Ob.g(this.$).hg.vo(Ka.a.m4),this.Jp=!1);for(fb=1;4>=fb;fb++){var ac=this.Eh[fb.toString()];ac&&ac.parentNode.removeChild(ac);this.Eh[fb.toString()]=null}this.yh=null};F.prototype.Enc=function(fb){var ac=this.ha.Kn(fb.clientPoint,fb.zb,5,void 0,void 0,!0);this.tw=fb;return this.Cwb(ac)?(this.gb=this.E2(ac),this.lwb(!0),!0):this.Ohd(ac)?(this.gb=this.rha(ac),this.mwb(!0),!0):!1};F.prototype.Cwb=function(fb){return!!this.Jz&&1!==this.zn&&!!fb&&this.Jz.contains(fb.topLeft)};F.prototype.Ohd=function(fb){return!!this.Jz&&
1===this.zn&&!!fb&&!this.Jz.contains(fb.topLeft)};F.prototype.lwb=function(fb){this.tableRange=this.Jz;this.zn=1;var ac=!this.Wt;fb?(this.HA(!1),this.yh=this.vq?[11]:[12],this.uza(ac),this.wI(ac)):(this.R2(!1),this.NN(ac),this.uy(ac))};F.prototype.mwb=function(fb){this.tableRange=null;this.zn=2;var ac=!this.Wt;fb?(this.HA(!1),this.yh=this.vq?[11]:[12],this.wq=this.vq,this.HPa(ac),this.wI(ac)):(this.p$(!1),this.NN(ac),this.uy(ac))};F.prototype.Mbc=function(){return this.ha.sa.Vc};F.prototype.XK=function(){this.ha.updateSelection(this.gb,
this.gb.topLeft,0);return!0};F.prototype.uy=function(fb){fb=void 0===fb?!1:fb;this.qb.Ti(this.gb,this.ZA());this.qb.qn(this.ZA());this.ry(fb);return!0};F.prototype.wI=function(fb){fb=void 0===fb?!1:fb;this.qb.Ti(this.gb,this.yh);this.qb.qn(this.yh);this.ry(fb)};F.prototype.ttb=function(){ba.ULS.sendTraceTag(537159384,0,15,"DragSelectionClickBehavior.FailureFallback: this function was not implemented for dragging selection")};F.prototype.Xzc=function(){return!1};F.prototype.Lwc=function(){if(!Ob.g(this.$).ha.sa.sg)return!1;
var fb=Ob.g(this.$).getRangeInformation(this.ha.sa.Vc);fb=bk(fb);for(var ac=fb.next();!ac.done;ac=fb.next())if(Object(ma.a)(Z.PivotTableRange,ac.value))return!1;return!0};F.prototype.KYc=function(fb){if(fb&&fb.contains(this.sourceRange)&&!fb.equals(this.sourceRange)){if(fb.Zaa&&this.sourceRange.bottom===this.sourceRange.top&&this.sourceRange.top===fb.top){var ac=new Na.Range(this.sourceRange.top,this.sourceRange.left,fb.bottom,this.sourceRange.right,!1,!1);if(!ac.equals(fb))return this.sourceRange=
ac,this.ha.updateSelection(this.sourceRange,this.sourceRange.topLeft,0),fb}this.Ih?this.vq=fb.left===this.sourceRange.left&&fb.right===this.sourceRange.right:this.isRow=fb.left===this.sourceRange.left&&fb.right===this.sourceRange.right;if(fb.top===this.sourceRange.top&&fb.bottom===this.sourceRange.bottom||this.Rx())return fb}return null};F.prototype.E2=function(fb){var ac=fb.clone();this.Rx()?ac.left=Math.max(fb.left-this.Ndc,1):ac.top=Math.max(fb.top-this.gCc,1);ac.right=ac.left+this.sourceRange.width-
1;ac.bottom=ac.top+this.sourceRange.height-1;return this.DYa(ac)};F.prototype.szb=function(){var fb=this.gb.topLeft.xd(this.sourceRange);return fb||this.Ih&&!this.tableRange?fb:this.Rx()?this.gb.top===this.sourceRange.bottom+1:this.gb.left===this.sourceRange.right+1};F.prototype.bGd=function(){if(this.Rx()&&this.gb.left!==this.tableRange.left||!this.Rx()&&this.gb.top!==this.tableRange.top){var fb=Kb.a.Xc(1,1,0,910,0,2065438552,"RearrangeInvalidDest");Mb.a(this.$).nr([fb]);return!0}return!1};F.prototype.BEd=
function(){var fb=this,ac=this.$.Fb.sc("UserAction","RearrangeRowColumnClientSide"),Ac={},Rc=(Ac.CopyPasteTargetType=1,Ac.OperationId=ya.a.create().toString(),Ac.Stopwatch=ac,Ac.DragDropIsShiftKeyDown=this.Wt,Ac.EncounteredDeploymentErrors=!1,Ac),Fc=this.Vt?2:1,wb=this.$.da.za(254);(new Promise(function(uc,Pb){fb.ptb(function(sc){sc.Errors&&0<sc.Errors.length?Pb(new eb.a(22,sc.Errors)):uc(!0)},function(sc){sc=Db.a.Mf(sc.data);Pb(new eb.a(22,sc))})})).then(function(){ba.ULS.sendTraceTag(537159383,
0,50,'DragSelectionClickBehavior.RearrangeRowColumn: success. copyPasteTargetType="{0}"',1);wb&&wb.mlf(Rc,Fc,fb.sourceRange,fb.gb);return Promise.resolve(!0)},function(uc){ba.ULS.sendTraceTag(537159382,0,10,'DragSelectionClickBehavior.RearrangeRowColumn: {0}, copyPasteTargetType="{1}"',uc?copyPasteInfra.getStringifiedError(uc):"null",1);return wb?wb.fAf(uc,Rc,Fc,fb.sourceRange,fb.gb):Promise.reject(uc)})};F.prototype.ptb=function(fb,ac){function Ac(){return new G(uc,wb)}function Rc(Pb,sc,nb){return T(Fc.$.oa.xa,
uc,wb,fb?Ab.b(Pb,fb):Pb,ac?Ab.a(sc,ac):sc,nb,null)}var Fc=this;fb=void 0===fb?null:fb;ac=void 0===ac?null:ac;var wb={};this.Rx()?(wb.FirstRow=this.gb.top-1,wb.FirstColumn=0,wb.DeltaColumn=0,wb.DeltaRow=this.gb.bottom-this.gb.top+1):(wb.FirstRow=0,wb.FirstColumn=this.gb.left-1,wb.DeltaColumn=this.gb.right-this.gb.left+1,wb.DeltaRow=0);wb.LastRow=Yb.a.Tx;wb.LastColumn=Yb.a.Wu;wb.SheetName=this.$.va.pa?this.$.va.pa.name:this.$.vb.getItemByName(this.$.vb.pa.name).sheetName;var uc=cb.v(this.sourceRange,
this.$);vb.EwaSettings.Zb()?this.$.userOperationManager.Sb(new pa.a(514,0,Rc,64,Ac),null):this.$.userOperationManager.Sb(new Ua.a(514,0,Rc,void 0,Ac),null)};F.prototype.bka=function(fb){fb=Ob.g(this.$).getRangeInformation(fb);for(var ac=0,Ac=fb.length;ac<Ac;++ac)if(Object(ma.a)(Z.PivotTableRange,fb[ac]))return fb=Kb.a.Xc(1,0,0,898,0,2105176604,"InsDelCellsPivotTable"),Mb.a(this.$).nr([fb]),!0;return!1};F.prototype.Gz=function(fb,ac,Ac,Rc,Fc){Fc=void 0===Fc?!1:Fc;var wb=xa.DOMElementExtensions.getBoundingClientRect(ac),
uc=ac===this.Gr[U.qIa]||ac===this.Gr[U.k6c];if(this.Ih){var Pb=ac===this.Gr[U.l6c]||ac===this.Gr[U.pIa];this.isRow&&Pb||this.Te&&uc?Pb="100px":(uc=this.isRow||uc,Pb=(uc?Fc?F.oVd:F.uVd:Fc?F.nVd:F.rVd)+"px");ac=uc?ac===this.Gr[U.qIa]?"top":"bottom":ac===this.Gr[U.pIa]?"right":"left";fb=100*(uc?fb.x-wb.x:fb.y-wb.y)/(uc?wb.width:wb.height);for(wb=1;4>=wb;wb++){Rc=document.createElement("div");var sc=document.createElement("div"),nb=document.createElement("div");Rc.appendChild(sc);Rc.appendChild(nb);Fc&&
(sc=document.createElement("div"),Rc.appendChild(sc),nb.style.fontWeight="bold");Rc.className=J.GPe;this.Eh[wb.toString()]=Rc;this.qb.cw(Ac,wb).mf.appendChild(Rc);Rc=this.Eh[wb.toString()];Rc.style[ac]=Pb;Rc.style[uc?"left":"top"]=fb+"%"}}else for(Fc=(uc?-F.tVd:-F.qVd)+"px",Pb=uc?ac===this.Gr[U.qIa]?"top":"bottom":ac===this.Gr[U.pIa]||Rc?"right":"left",ac=100*(uc?Rc?0:fb.x-wb.x:fb.y-wb.y)/(uc?wb.width:wb.height),fb=1;4>=fb;fb++)wb=document.createElement("div"),wb.className=J.FPe,this.Eh[fb.toString()]=
wb,this.qb.cw(Ac,fb).mf.appendChild(wb),wb=this.Eh[fb.toString()],wb.style[Pb]=Fc,wb.style[uc?"left":"top"]=ac+"%"};F.prototype.ry=function(fb){fb=void 0===fb?!1:fb;var ac=this.gb.toString();if(this.Ih)for(var Ac=1;4>=Ac;Ac++)this.Eh[Ac.toString()].childNodes[0].innerText=ac,this.Eh[Ac.toString()].childNodes[1].innerText=this.lM,fb&&(this.Eh[Ac.toString()].childNodes[2].innerText=this.dO);else for(fb=1;4>=fb;fb++)this.Eh[fb.toString()].innerText=ac};F.prototype.roa=function(fb){fb=void 0===fb?0:fb;
0===fb?this.Vt=!1:1===fb&&(this.Wt=!1);this.Ih&&(this.Vt||this.Wt)||(ab.KeyInputManager.instance.Ba(ra.a.Gd,this.domElement.ownerDocument.body,this.onKeyUp),this.$La=!1)};F.prototype.HA=function(fb){this.qb.eh(this.ZA());this.Ht(this.ai,this.Bf,void 0,fb)};F.prototype.R2=function(fb){this.qb.eh(this.yh);this.Ht(this.l6,this.m6,void 0,fb)};F.prototype.p$=function(fb){this.qb.eh(this.yh);this.Ht(this.tN,this.vN,void 0,fb)};F.prototype.NN=function(fb){fb=void 0===fb?!1:fb;this.Rh=5;this.Aw(this.ai,this.Bf);
this.lM=this.ssb;this.dO=this.bLb;this.Gz(this.tw.clientPoint,this.tw.zb,this.Iaa(),!1,fb)};F.prototype.HPa=function(fb){fb=void 0===fb?!1:fb;this.Rh=6;this.Aw(this.l6,this.m6);this.lM=this.dia;this.dO=this.yna;this.Gz(this.tw.clientPoint,this.tw.zb,this.isRow||this.vq?11:12,!0,fb)};F.prototype.uza=function(fb){fb=void 0===fb?!1:fb;this.Rh=6;this.Aw(this.tN,this.vN);this.lM=this.dia;this.dO=this.yna;this.Gz(this.tw.clientPoint,this.tw.zb,this.Rx()?11:12,!0,fb)};F.prototype.hka=function(fb){return fb.Ca.keyCode===
Cb.a.Z7||Xa.a.isMac&&fb.Ca.keyCode===Cb.a.Aoa};F.prototype.Rx=function(){return!this.Ih&&this.isRow||this.Ih&&this.vq};F.prototype.Iaa=function(){return this.Ih?47:6};F.prototype.ZA=function(){return this.Ih?F.i6c:F.m6c};F.qVd=50;F.tVd=25;F.rVd=-85;F.uVd=-40;F.nVd=-120;F.oVd=-50;F.Iqb="copy";F.m6c=[6];F.i6c=[47];Object(ca.a)(F,"DragSelectionClickBehavior",U,[]);var Aa=b(83);Rk(I,U);I.prototype.dispose=function(){this.ha&&(this.ha.S6(this.ep),this.ha.rW(this.ug),this.ha.FId(this.uOa),this.ha.ZH(this.Rc));
if(this.Eh)for(var fb=1;4>=fb;fb++)xa.DOMElementExtensions.ff(this.Eh[fb.toString()]);this.Eh=this.yh=null;U.prototype.dispose.call(this)};I.prototype.Lpb=function(fb){fb&&(this.Ih&&Ob.g(this.$).hg.vo(Ka.a.m4),this.Jp=!1);for(fb=1;4>=fb;fb++){var ac=this.Eh[fb.toString()];ac&&ac.parentNode.removeChild(ac);this.Eh[fb.toString()]=null}this.yh=null};I.prototype.Mbc=function(){return this.ha.sa.Vc};I.prototype.XK=function(){this.ha.updateSelection(this.gb,this.gb.topLeft,0);return!0};I.prototype.uy=function(fb){fb=
void 0===fb?!1:fb;this.qb.Ti(this.gb,this.ZA());this.qb.qn(this.ZA());this.ry(fb);return!0};I.prototype.wI=function(fb){fb=void 0===fb?!1:fb;this.qb.Ti(this.gb,this.yh);this.qb.qn(this.yh);this.ry(fb)};I.prototype.ttb=function(){ba.ULS.sendTraceTag(523638490,0,15,"DragSelectionClickBehaviorTemporary.FailureFallback: this function was not implemented for dragging selection")};I.prototype.Xzc=function(){return!1};I.prototype.Gz=function(fb,ac,Ac,Rc,Fc){Fc=void 0===Fc?!1:Fc;var wb=xa.DOMElementExtensions.getBoundingClientRect(ac),
uc=ac===this.Gr[U.qIa]||ac===this.Gr[U.k6c];if(this.Ih){var Pb=ac===this.Gr[U.l6c]||ac===this.Gr[U.pIa];this.isRow&&Pb||this.Te&&uc?Pb="100px":(uc=this.isRow||uc,Pb=(uc?Fc?I.oVd:I.uVd:Fc?I.nVd:I.rVd)+"px");ac=uc?ac===this.Gr[U.qIa]?"top":"bottom":ac===this.Gr[U.pIa]?"right":"left";fb=100*(uc?fb.x-wb.x:fb.y-wb.y)/(uc?wb.width:wb.height);for(wb=1;4>=wb;wb++){Rc=document.createElement("div");var sc=document.createElement("div"),nb=document.createElement("div");Rc.appendChild(sc);Rc.appendChild(nb);Fc&&
(sc=document.createElement("div"),Rc.appendChild(sc),nb.style.fontWeight="bold");Rc.className=J.GPe;this.Eh[wb.toString()]=Rc;this.qb.cw(Ac,wb).mf.appendChild(Rc);Rc=this.Eh[wb.toString()];Rc.style[ac]=Pb;Rc.style[uc?"left":"top"]=fb+"%"}}else for(Fc=(uc?-I.tVd:-I.qVd)+"px",Pb=uc?ac===this.Gr[U.qIa]?"top":"bottom":ac===this.Gr[U.pIa]||Rc?"right":"left",ac=100*(uc?Rc?0:fb.x-wb.x:fb.y-wb.y)/(uc?wb.width:wb.height),fb=1;4>=fb;fb++)wb=document.createElement("div"),wb.className=J.FPe,this.Eh[fb.toString()]=
wb,this.qb.cw(Ac,fb).mf.appendChild(wb),wb=this.Eh[fb.toString()],wb.style[Pb]=Fc,wb.style[uc?"left":"top"]=ac+"%"};I.prototype.ucg=function(fb,ac,Ac){var Rc=Ob.g(this.$),Fc=Rc.fg(fb),wb=Rc.Cf(this.paneType);Ac=Qa.a.hs(wb.view.Fh,this.domElement.parentNode,Ac,Rc.rtl);wb=!1;var uc=2;ac&&Ac.y-Fc.topLeft.y>Fc.height/2?(wb=!0,uc=1):!ac&&Ac.x-Fc.topLeft.x>Fc.width/2&&(wb=!0);if(wb){ac=Rc.Xj("DragSelectionClickBehaviorTemporary.updateMouseSelectionRange",Rc.YG,uc);try{ac.Tr(fb),ac.$$mn(),ac.$$cu()}finally{ac&&
ac.dispose()}}};I.prototype.p$=function(fb){this.qb.eh(this.yh);this.Ht(this.tN,this.vN,void 0,fb)};I.prototype.HA=function(fb){this.qb.eh(this.ZA());this.Ht(this.ai,this.Bf,void 0,fb)};I.prototype.Iaa=function(){return this.Ih?47:6};I.prototype.ZA=function(){return this.Ih?I.i6c:I.m6c};I.qVd=50;I.tVd=25;I.rVd=-85;I.uVd=-40;I.nVd=-120;I.oVd=-50;I.m6c=[6];I.i6c=[47];Object(ca.a)(I,"DragSelectionClickBehaviorTemporary",U,[]);Rk(D,I);D.prototype.dispose=function(){this.Vt&&this.roa();this.Ih&&this.Wt&&
this.roa(1);I.prototype.dispose.call(this)};D.prototype.Cnc=function(fb){this.Ih&&(this.tw=fb,this.Jz=null,this.vq=this.isRow=this.Te=this.wq=!1,ab.KeyInputManager.instance.ra(ra.a.Lb,this.domElement.ownerDocument.body,this.onKeyDown));this.Jp=!0;this.tableRange=this.KYc(this.tableManager.Vm(this.sourceRange.topLeft));Ob.g(this.$);this.tableRange&&!this.tableRange.equals(this.sourceRange)?this.Ih?(this.Jz=this.tableRange,this.zn=1,this.yh=(this.vq=this.tableRange.left===this.sourceRange.left&&this.tableRange.right===
this.sourceRange.right)?[11]:[12],this.Rh=6,this.Aw(this.tN,this.vN),this.lM=this.dia,this.dO=this.yna,this.Gz(fb.clientPoint,fb.zb,this.vq?11:12,!0,!0),this.wI(!0)):(this.yh=(this.isRow=this.tableRange.left===this.sourceRange.left&&this.tableRange.right===this.sourceRange.right)?[11]:[12],this.Rh=6,this.Aw(this.tN,this.vN),this.Gz(fb.clientPoint,fb.zb,this.isRow?11:12,!0)):(this.tableRange=null,this.Ih?(this.isRow=this.sourceRange.isRow,this.Te=this.sourceRange.Te,this.isRow||this.Te?(this.zn=3,
this.jE=this.isRow?1:2,this.Rh=6,this.yh=this.isRow?[11]:[12],this.Aw(this.l6,this.m6),this.lM=this.dia,this.dO=this.yna,this.Gz(fb.clientPoint,fb.zb,this.isRow?11:12,!0,!0),this.wI(!0)):(this.zn=2,this.jE=0,this.Aw(this.ai,this.Bf),this.lM=this.ssb,this.dO=this.bLb,this.Gz(fb.clientPoint,fb.zb,this.Iaa(),!1,!0),this.uy(!0))):(this.Aw(this.ai,this.Bf),ab.KeyInputManager.instance.ra(ra.a.Lb,this.domElement.ownerDocument.body,this.onKeyDown),this.jE=this.sourceRange.isRow?1:this.sourceRange.Te?2:0,
this.Gz(fb.clientPoint,fb.zb,this.Iaa(),!1),this.uy()))};D.prototype.rya=function(){this.Jp=!1;this.Ih&&(this.zn=0);this.qb.eh(this.ZA());if(!this.$.hq([this.gb],!1))return this.Ht(this.ai,this.Bf),this.Rh=-1,!0;if(this.ha.sa.Vc.equals(this.gb)||this.bka(this.gb)||this.bka(this.sourceRange))this.Rh=-1;else{this.XK();this.ha.sourceRange=this.sourceRange.clone();var fb=this.ha.sourceRange,ac=this.ha.sa.Vc;if(this.Ih){var Ac={};this.$.Fd(-694765314,2,30,(Ac[Ka.a.Jta]=this.Vt,Ac[Ka.a.x3]=fb,Ac[Ka.a.w3]=
ac,Ac[Ka.a.qsb]=this.Wt,Ac))}else Ac={},this.$.Fd(-694765314,2,30,(Ac[Ka.a.Jta]=this.Vt,Ac[Ka.a.x3]=fb,Ac[Ka.a.w3]=ac,Ac))}!this.Ih&&this.tableRange||this.Ht(this.ai,this.Bf);this.$sd&&this.Zsd();return!0};D.prototype.Lpb=function(fb){fb&&ab.KeyInputManager.instance.Ba(ra.a.Lb,this.domElement.ownerDocument.body,this.onKeyDown);I.prototype.Lpb.call(this,fb)};D.prototype.Enc=function(fb){var ac=this.ha.Kn(fb.clientPoint,fb.zb,5,void 0,void 0,!0);this.tw=fb;return this.Cwb(ac)?(this.gb=this.E2(ac),this.lwb(!0),
!0):this.Ohd(ac)?(this.gb=this.rha(ac),this.mwb(!0),!0):!1};D.prototype.ry=function(fb){fb=void 0===fb?!1:fb;var ac=this.gb.toString();if(this.Ih)for(var Ac=1;4>=Ac;Ac++)this.Eh[Ac.toString()].childNodes[0].innerText=ac,this.Eh[Ac.toString()].childNodes[1].innerText=this.lM,fb&&(this.Eh[Ac.toString()].childNodes[2].innerText=this.dO);else for(fb=1;4>=fb;fb++)this.Eh[fb.toString()].innerText=ac};D.prototype.Cwb=function(fb){return!!this.Jz&&1!==this.zn&&!!fb&&this.Jz.contains(fb.topLeft)};D.prototype.Ohd=
function(fb){return!!this.Jz&&1===this.zn&&!!fb&&!this.Jz.contains(fb.topLeft)};D.prototype.lwb=function(fb){this.tableRange=this.Jz;this.zn=1;var ac=!this.Wt;fb?(this.HA(!1),this.yh=this.vq?[11]:[12],this.uza(ac),this.wI(ac)):(this.R2(!1),this.NN(ac),this.uy(ac))};D.prototype.mwb=function(fb){this.tableRange=null;this.zn=2;var ac=!this.Wt;fb?(this.HA(!1),this.yh=this.vq?[11]:[12],this.wq=this.vq,this.HPa(ac),this.wI(ac)):(this.p$(!1),this.NN(ac),this.uy(ac))};D.prototype.Lwc=function(){if(!Ob.g(this.$).ha.sa.sg)return!1;
var fb=Ob.g(this.$).getRangeInformation(this.ha.sa.Vc);fb=bk(fb);for(var ac=fb.next();!ac.done;ac=fb.next())if(Object(ma.a)(Z.PivotTableRange,ac.value))return!1;return!0};D.prototype.KYc=function(fb){if(fb&&fb.contains(this.sourceRange)&&!fb.equals(this.sourceRange)){if(fb.Zaa&&this.sourceRange.bottom===this.sourceRange.top&&this.sourceRange.top===fb.top){var ac=new Na.Range(this.sourceRange.top,this.sourceRange.left,fb.bottom,this.sourceRange.right,!1,!1);if(!ac.equals(fb))return this.sourceRange=
ac,this.ha.updateSelection(this.sourceRange,this.sourceRange.topLeft,0),fb}this.Ih?this.vq=fb.left===this.sourceRange.left&&fb.right===this.sourceRange.right:this.isRow=fb.left===this.sourceRange.left&&fb.right===this.sourceRange.right;if(fb.top===this.sourceRange.top&&fb.bottom===this.sourceRange.bottom||this.Rx())return fb}return null};D.prototype.E2=function(fb){var ac=fb.clone();this.Rx()?ac.left=Math.max(fb.left-this.Ndc,1):ac.top=Math.max(fb.top-this.gCc,1);ac.right=ac.left+this.sourceRange.width-
1;ac.bottom=ac.top+this.sourceRange.height-1;return this.DYa(ac)};D.prototype.szb=function(){var fb=this.gb.topLeft.xd(this.sourceRange);return fb||this.Ih&&!this.tableRange?fb:this.Rx()?this.gb.top===this.sourceRange.bottom+1:this.gb.left===this.sourceRange.right+1};D.prototype.bGd=function(){if(this.Rx()&&this.gb.left!==this.tableRange.left||!this.Rx()&&this.gb.top!==this.tableRange.top){var fb=Kb.a.Xc(1,1,0,910,0,2065438552,"RearrangeInvalidDest");Mb.a(this.$).nr([fb]);return!0}return!1};D.prototype.BEd=
function(){var fb=this,ac=this.$.Fb.sc("UserAction","RearrangeRowColumnClientSide"),Ac={},Rc=(Ac.CopyPasteTargetType=1,Ac.OperationId=ya.a.create().toString(),Ac.Stopwatch=ac,Ac.DragDropIsShiftKeyDown=this.Wt,Ac.EncounteredDeploymentErrors=!1,Ac),Fc=this.Vt?2:1,wb=this.$.da.za(254);(new Promise(function(uc,Pb){fb.ptb(function(sc){sc.Errors&&0<sc.Errors.length?Pb(new eb.a(22,sc.Errors)):uc(!0)},function(sc){sc=Db.a.Mf(sc.data);Pb(new eb.a(22,sc))})})).then(function(){ba.ULS.sendTraceTag(520747156,
0,50,'DragSelectionClickBehaviorCellRangeAndTable.RearrangeRowColumn: success. copyPasteTargetType="{0}"',1);wb&&wb.mlf(Rc,Fc,fb.sourceRange,fb.gb);return Promise.resolve(!0)},function(uc){ba.ULS.sendTraceTag(520747155,0,10,'DragSelectionClickBehaviorCellRangeAndTable.RearrangeRowColumn: {0}, copyPasteTargetType="{1}"',uc?copyPasteInfra.getStringifiedError(uc):"null",1);return wb?wb.fAf(uc,Rc,Fc,fb.sourceRange,fb.gb):Promise.reject(uc)})};D.prototype.ptb=function(fb,ac){function Ac(){return new G(uc,
wb)}function Rc(Pb,sc,nb){return T(Fc.$.oa.xa,uc,wb,fb?Ab.b(Pb,fb):Pb,ac?Ab.a(sc,ac):sc,nb,null)}var Fc=this;fb=void 0===fb?null:fb;ac=void 0===ac?null:ac;var wb={};this.Rx()?(wb.FirstRow=this.gb.top-1,wb.FirstColumn=0,wb.DeltaColumn=0,wb.DeltaRow=this.gb.bottom-this.gb.top+1):(wb.FirstRow=0,wb.FirstColumn=this.gb.left-1,wb.DeltaColumn=this.gb.right-this.gb.left+1,wb.DeltaRow=0);wb.LastRow=Yb.a.Tx;wb.LastColumn=Yb.a.Wu;wb.SheetName=this.$.va.pa?this.$.va.pa.name:this.$.vb.getItemByName(this.$.vb.pa.name).sheetName;
var uc=cb.v(this.sourceRange,this.$);vb.EwaSettings.Zb()?this.$.userOperationManager.Sb(new pa.a(514,0,Rc,64,Ac),null):this.$.userOperationManager.Sb(new Ua.a(514,0,Rc,void 0,Ac),null)};D.prototype.bka=function(fb){fb=Ob.g(this.$).getRangeInformation(fb);for(var ac=0,Ac=fb.length;ac<Ac;++ac)if(Object(ma.a)(Z.PivotTableRange,fb[ac]))return fb=Kb.a.Xc(1,0,0,898,0,2105176604,"InsDelCellsPivotTable"),Mb.a(this.$).nr([fb]),!0;return!1};D.prototype.roa=function(fb){fb=void 0===fb?0:fb;0===fb?this.Vt=!1:
1===fb&&(this.Wt=!1);this.Ih&&(this.Vt||this.Wt)||(ab.KeyInputManager.instance.Ba(ra.a.Gd,this.domElement.ownerDocument.body,this.onKeyUp),this.$La=!1)};D.prototype.NN=function(fb){fb=void 0===fb?!1:fb;this.Rh=5;this.Aw(this.ai,this.Bf);this.lM=this.ssb;this.dO=this.bLb;this.Gz(this.tw.clientPoint,this.tw.zb,this.Iaa(),!1,fb)};D.prototype.HPa=function(fb){fb=void 0===fb?!1:fb;this.Rh=6;this.Aw(this.l6,this.m6);this.lM=this.dia;this.dO=this.yna;this.Gz(this.tw.clientPoint,this.tw.zb,this.isRow||this.vq?
11:12,!0,fb)};D.prototype.uza=function(fb){fb=void 0===fb?!1:fb;this.Rh=6;this.Aw(this.tN,this.vN);this.lM=this.dia;this.dO=this.yna;this.Gz(this.tw.clientPoint,this.tw.zb,this.Rx()?11:12,!0,fb)};D.prototype.hka=function(fb){return fb.Ca.keyCode===Cb.a.Z7||Xa.a.isMac&&fb.Ca.keyCode===Cb.a.Aoa};D.prototype.Rx=function(){return!this.Ih&&this.isRow||this.Ih&&this.vq};D.prototype.R2=function(fb){this.qb.eh(this.yh);this.Ht(this.l6,this.m6,void 0,fb)};D.prototype.Zsd=function(){var fb=Aa.a.instance.Tb("Common.ISystemInitiatedFeedback");
fb&&fb.execute(function(ac){ac.logActivity("DragDrop",null)})};D.Iqb="copy";Object(ca.a)(D,"DragSelectionClickBehaviorCellRangeAndTable",I,[]);var Za=b(330);Rk(x,I);x.prototype.Cnc=function(fb){this.tw=fb;this.isRow=this.Te=!1;this.Jp=!0;this.rc=this.tableManager.hva(this.sourceRange);Ob.g(this.$);Ob.g(this.$).hg.vo(U.s1a);this.Vod(this.gb)?(this.isRow=this.rli(),this.Te=this.ofi(),this.isRow||this.Te?(this.Sgc=!1,this.uza(fb),this.gb=this.E2(this.gb),this.wI()):(this.Sgc=!0,this.NN(fb),this.uy())):
(this.Sgc=!0,this.NN(fb),this.uy())};x.prototype.rya=function(){return 5==this.Rh?(this.HA(!0),this.Sgc=!1,this.Pyj(),this.Rh=-1,!0):!1};x.prototype.Enc=function(fb){var ac=this.ha.Kn(fb.clientPoint,fb.zb,5,void 0,void 0,!0);this.tw=fb;return this.Sgc?!1:this.Vod(ac)?(this.x1h(fb),!0):!1};x.prototype.ry=function(){var fb=new Na.Range(this.gb.top,this.gb.left,this.gb.bottom,this.gb.right,!1,!0);6==this.Rh&&(this.isRow?(--fb.top,fb.bottom=fb.top+this.gb.height-1):(--fb.left,fb.right=fb.left+this.gb.width-
1));for(var ac=1;4>=ac;ac++)this.Eh[ac.toString()].childNodes[0].innerText=fb.toString()};x.prototype.Lwc=function(){if(!Ob.g(this.$).ha.sa.sg)return!1;var fb=Ob.g(this.$).getRangeInformation(this.ha.sa.Vc);fb=bk(fb);for(var ac=fb.next();!ac.done;ac=fb.next())if(Object(ma.a)(Z.PivotTableRange,ac.value))return!0;return!1};x.prototype.E2=function(fb){fb=fb.clone();this.isRow?(fb.left=this.sourceRange.left,fb.right=this.rc.right,fb.bottom=fb.top+this.sourceRange.height-1):this.Te&&(fb.top=this.sourceRange.top,
fb.bottom=this.rc.HW.bottom,fb.right=fb.left+this.sourceRange.width-1);return this.DYa(fb)};x.prototype.J0i=function(){var fb={},ac=cb.v(this.sourceRange,this.$);Ob.g(this.$).getRangeInformation(this.gb);if(this.isRow){ac.FirstColumn=fb.FirstColumn=this.gb.left-1;ac.LastColumn=fb.LastColumn=this.gb.right-1;if(this.sourceRange.top<=this.gb.top&&this.sourceRange.bottom>=this.gb.top-1)return;this.sourceRange.top>this.gb.top?fb.LastRow=fb.FirstRow=this.gb.top-1:(fb.FirstRow=this.gb.top-this.sourceRange.height-
1,fb.LastRow=fb.FirstRow+this.sourceRange.height-1)}else{fb.FirstRow=this.gb.top;fb.LastRow=this.gb.bottom-1;if(this.sourceRange.left<=this.gb.left&&this.sourceRange.right>=this.gb.left-1)return;fb.LastColumn=this.sourceRange.left>this.gb.left?fb.FirstColumn=this.gb.left-1:fb.FirstColumn=this.gb.left-this.sourceRange.width-1}var Ac={};Ac.SheetName=this.$.va.pa?this.$.va.pa.name:this.$.vb.getItemByName(this.$.vb.pa.name).sheetName;Ac.Ranges=Array(2);Ac.Ranges[0]=ac;Ac.Ranges[1]=fb;this.Dwh(Ac)};x.prototype.Dwh=
function(fb){function ac(Rc,Fc,wb){var uc=Ac.$.oa.xa;Rc=Ac.Lyf?Ab.b(Rc,Ac.Lyf):Rc;Fc=Ac.Kyf?Ab.a(Fc,Ac.Kyf):Fc;var Pb=uc.Na(1,null);Pb.moveRange=fb;return ub.g(uc,"MoveLineItems",Pb,Rc,Fc,wb,null,0)}var Ac=this;vb.EwaSettings.Zb()?this.$.userOperationManager.Sb(new pa.a(265,0,ac,64),null):this.$.userOperationManager.Sb(new Ua.a(265,0,ac,void 0),null)};x.prototype.Vod=function(fb){return fb.left>=this.rc.HW.left&&fb.right<=this.rc.fM.right&&fb.top>=this.rc.fM.top&&fb.bottom<=this.rc.HW.bottom};x.prototype.rli=
function(){return this.rc.HW.top<=this.gb.top&&this.rc.HW.left<=this.gb.left&&this.rc.HW.right>=this.gb.left};x.prototype.ofi=function(){return this.rc.fM.top==this.gb.top&&this.rc.fM.left<=this.gb.left&&this.rc.fM.right>=this.gb.right};x.prototype.uza=function(fb){this.Rh=6;this.yh=this.isRow?[11]:[12];this.Aw(this.tN,this.vN);this.Gz(fb.clientPoint,fb.zb,this.isRow?11:12,!0,!1)};x.prototype.NN=function(fb){this.Rh=5;this.Aw(this.ai,this.Bf);this.Gz(fb.clientPoint,fb.zb,this.Iaa(),!1,!1)};x.prototype.x1h=
function(fb){this.HA(!0);this.uza(fb);this.gb=this.E2(this.gb);this.wI()};x.prototype.w1h=function(fb){this.p$(!0);this.NN(fb);this.uy()};x.prototype.Pyj=function(){var fb=Kb.a.Xc(1,0,900,899,0,2069074184,"PivotTableInvalidMove");fb.HelpTopicId=Za.a.wCj;fb.HelpDescription=ha.a.instance.ga(905);Mb.a(this.$).nr([fb])};Object(ca.a)(x,"DragSelectionClickBehaviorPivotTableRange",I,[]);var Zb=b(390);Rk(z,H);z.prototype.dispose=function(){oa.a.instance.Ba(ra.a.pointerDown,this.qaa,this.onPointerDown);La.a.instance.Ba(ra.a.$j,
this.qaa,this.oca);this.gridView.$&&(this.gridView.ha.S6(this.ep),this.gridView.ha.rW(this.ug),this.gridView.$.rl(this.Yc),this.gridView.$.ob.zsc(this.s6),this.gridView.$.ob.ysc(this.r6),this.gridView.YOf(this.ZDb),this.gridView.$b.vk(this.Rwf),this.gridView.$b.Nl(this.Qwf));H.prototype.dispose.call(this)};Object(ca.a)(z,"FillHandleClickBehavior",H,[]);Rk(A,C);Mf.Object.defineProperties(A.prototype,{tva:{configurable:!0,enumerable:!0,get:function(){return this.Yog}}});A.kwe=[1,2,32,256,128,64];Object(ca.a)(A,
"IPadSelectionClickThroughBehavior",C,[]);var jb=b(22);B.prototype.dispose=function(){this.gridView.ha.S6(this.ep);this.gridView.ha.rW(this.ug);this.gridView.ha.FId(this.ug)};B.prototype.Jza=function(){this.T4a=0;this.ngc=!1;this.u5=Number.NaN};B.prototype.yIe=function(fb){this.ngc=!0;this.WAc(fb,1)};B.prototype.zIe=function(fb){this.ngc=!1;this.WAc(fb,-1)};B.prototype.WAc=function(fb,ac){if(fb)if(fb.parentNode)if(this.Lnd)isNaN(this.u5)||(this.jBc(this.u5,!1),this.u5=Number.NaN);else if(fb=parseInt(fb.parentNode.getAttribute(Ka.a.Ixb),
10),isNaN(fb))ba.ULS.shipAssertTag(537159366,0,!1,"MarqueeHoveringManager.UpdateMarqueeStyle: indexInMarqueeCollection is not a valid number.");else{if(!isNaN(this.u5)&&fb!==this.u5){if(this.ngc)return;this.jBc(this.u5,!1)}if(isNaN(this.u5)||fb!==this.u5)this.u5=fb,this.T4a=0;!this.T4a&&0<ac&&this.jBc(fb,!0);this.T4a=Math.max(this.T4a+ac,0);!this.T4a&&0>ac&&(this.jBc(fb,!1),this.u5=Number.NaN)}else ba.ULS.shipAssertTag(537159367,0,!!fb.parentNode,"MarqueeHoveringManager.UpdateMarqueeStyle: handle.ParentNode is null.");
else ba.ULS.shipAssertTag(537159368,0,!!fb,"MarqueeHoveringManager.UpdateMarqueeStyle: handle is null.")};B.prototype.jBc=function(fb,ac){for(var Ac=1;4>=Ac;Ac++){var Rc=this.gridView.qb.cw(3,Ac,fb).mf;xa.DOMElementExtensions.toggleCssClass(Rc,J.xuh,ac);for(Rc=Rc.firstChild;Rc;Rc=Rc.nextSibling)jb.a.contains(Rc.className,"resizemarqueehandle",!0)&&xa.DOMElementExtensions.toggleCssClass(Rc,J.Buh,ac)}};Object(ca.a)(B,"MarqueeHoveringManager",null,[]);var Vb=b(195),Ic=b(85),Rb=b(1031),kc=b(1439);Rk(w,
C);w.prototype.dispose=function(){oa.a.instance.Ba(ra.a.aW,this.TJ,this.Ezf);oa.a.instance.Ba(ra.a.fy,this.TJ,this.sca);oa.a.instance.Ba(ra.a.pointerDown,this.TJ,this.onPointerDown);Vb.a.instance.Ba(ra.a.click,this.TJ,this.wEb);Vb.a.instance.Ba(ra.a.$j,this.TJ,this.onDoubleClick);xa.DOMElementExtensions.ff(this.oH);this.oH=null;xa.DOMElementExtensions.ff(this.TJ);this.Qu=this.TJ=null;C.prototype.dispose.call(this)};w.prototype.CYa=function(fb){this.Qu=Object(Ic.a)(kc.a,fb.metadata)};Object(ca.a)(w,
"RangeCatchUpActivityHighlightBehavior",C,[]);Rk(m,N);m.prototype.FRa=function(){return(this.gridView.inRangePicker||this.gridView.ui)&&N.prototype.FRa.call(this)};Mf.Object.defineProperties(m.prototype,{w4:{configurable:!0,enumerable:!0,get:function(){return 16}},Tbb:{configurable:!0,enumerable:!0,get:function(){return this.gridView.ha.rangePicker.Lbd(!1)}}});Object(ca.a)(m,"RangePickerTouchGrippiesBehavior",N,[]);Rk(y,C);Object(ca.a)(y,"RearrangeHighlightBehavior",C,[]);var xb;(function(fb){fb[fb.topLeft=
0]="topLeft";fb[fb.topRight=1]="topRight";fb[fb.bottomLeft=2]="bottomLeft";fb[fb.bottomRight=3]="bottomRight";fb[fb.error=4]="error"})(xb||(xb={}));Object(ca.b)("Corner",xb);Rk(r,C);r.prototype.dispose=function(){var fb=this;this.IK.forEach(function(ac){oa.a.instance.Ba(ra.a.pointerDown,ac,fb.onPointerDown)});Array.clear(this.IK);C.prototype.dispose.call(this)};r.prototype.CYa=function(fb){this.bba=fb;this.Pne(fb);this.Wn.GKb(fb,this.IK,this.qQd());this.hF.Jza()};r.prototype.NZe=function(fb,ac){var Ac=
fb.zb;fb=fb.clientPoint;if(!Ac||!fb)return ba.ULS.shipAssertTag(537159324,0,!!Ac,"ResizeMarqueeBehaviorBase.GetMouseSelectionRange: source is null"),ba.ULS.shipAssertTag(537159323,0,!!fb,"ResizeMarqueeBehaviorBase.GetMouseSelectionRange: point is null"),null;ac&&(fb=this.Gpf(fb));ac=this.ha.Kn(fb,Ac,0,!0,!1,!0);ac||(fb=this.Gpf(fb),ac=this.ha.Kn(fb,Ac,0,!0,!1,!0));return ac};r.prototype.Gpf=function(fb){fb.y+=0===this.h3||1===this.h3?2:-2;fb.x+=0===this.h3||2===this.h3?2:-2;return fb};r.prototype.eDe=
function(fb){if(!fb||!this.sourceRange)return ba.ULS.shipAssertTag(537159322,0,!!fb,"ResizeMarqueeBehaviorBase.CreateNewRange: newCorner is null"),ba.ULS.shipAssertTag(537159321,0,!!this.sourceRange,"ResizeMarqueeBehaviorBase.CreateNewRange: sourceRange is null"),null;if(0===this.h3)return new Na.Range(fb.top,fb.left,this.sourceRange.bottom,this.sourceRange.right,!0,!1);if(1===this.h3)return new Na.Range(fb.top,this.sourceRange.left,this.sourceRange.bottom,fb.right,!0,!1);if(2===this.h3)return new Na.Range(this.sourceRange.top,
fb.left,fb.bottom,this.sourceRange.right,!0,!1);if(3===this.h3)return new Na.Range(this.sourceRange.top,this.sourceRange.left,fb.bottom,fb.right,!0,!1);ba.ULS.shipAssertTag(537159320,0,!1,"ResizeMarqueeBehaviorBase.CreateNewRange: currentFixedCorner is not valid: {0}",xb[this.h3]);return null};r.prototype.XK=function(){return this.coloredReferencesManager.Fpf(this.Ya,this.PK,this.gb)};r.prototype.uy=function(){return this.XK()};r.prototype.A9b=function(fb){fb&&ba.ULS.sendTraceTag(537159319,0,10,"ResizeMarqueeBehaviorBase.FinishOrAbortOperation: Aborting operation, will try to recalculate colored references as a fallback.");
this.hF.zIe(this.IK[0]);this.Wn.RJf(!1,this.bba.w$);this.Ya.textBox.setCaretPositionToEnd();this.Ya.jsc(this.C4e);this.Oag();this.kSa=this.gridView.gLa=!1;ec.b(this.$,!1);this.Wn.HLf()};Object(ca.a)(r,"ResizeMarqueeBehaviorBase",C,[]);Rk(v,r);v.prototype.mSf=function(){return[J.ovh,J.pvh,J.mvh,J.nvh]};v.prototype.Gne=function(){return[J.lvh]};v.prototype.dYe=function(fb){fb=fb.zb;if(fb===this.IK[0])return 0;if(fb===this.IK[1])return 1;if(fb===this.IK[2])return 2;if(fb===this.IK[3])return 3;ba.ULS.shipAssertTag(537159318,
0,!1,"ResizeMarqueeMouseBehavior.GetFixedCorner: source doesn't match any resize handle.");return 4};v.prototype.hNf=function(){this.Wn.Aw(this.ai,this.Bf,!0)};v.prototype.Oag=function(){this.Wn.VWd(this.ai,this.Bf,!0)};v.prototype.T0f=function(fb){return 2===(Ha.a.Cb=fb.lb)&&fb.Hn===Sys.UI.MouseButton.leftButton};v.prototype.qQd=function(){return!0};v.prototype.Clf=function(){ba.ULS.sendTraceTag(537159317,0,50,"ResizeMarqueeMouseBehavior.LogStartOperation: Starting resize marquee operation with mouse.")};
v.prototype.Pne=function(fb){for(var ac=bk(this.IK),Ac=ac.next();!Ac.done;Ac=ac.next())Ac.value.style.backgroundColor=fb.mf.style.borderColor};Object(ca.a)(v,"ResizeMarqueeMouseBehavior",r,[]);Rk(f,r);f.prototype.dispose=function(){Ha.a.zPf(this.sEb);r.prototype.dispose.call(this)};f.prototype.mSf=function(){return[kb.a.quh,kb.a.puh]};f.prototype.Gne=function(){var fb=!vb.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");return[fb?kb.a.xPe:kb.a.wPe,kb.a.z8b,fb?kb.a.ouh:kb.a.y8b]};
f.prototype.dYe=function(fb){fb=fb.zb;if(fb===this.IK[0])return 0;if(fb===this.IK[1])return 3;ba.ULS.shipAssertTag(537159316,0,!1,"ResizeMarqueeTouchBehavior.GetFixedCorner: source doesn't match any resize handle.");return 4};f.prototype.hNf=function(){Xa.a.Uu?this.Wn.Aw(this.ai,this.Bf,!1):this.Wn.E7i(this.ai,this.Bf)};f.prototype.Oag=function(){Xa.a.Uu?this.Wn.VWd(this.ai,this.Bf,!1):this.Wn.AOj(this.ai,this.Bf)};f.prototype.T0f=function(fb){return 3===(Ha.a.Cb=fb.lb)};f.prototype.qQd=function(){return 3===
Ha.a.Cb};f.prototype.Clf=function(){ba.ULS.sendTraceTag(537159315,0,50,"ResizeMarqueeTouchBehavior.LogStartOperation: Starting resize marquee operation with touch.")};f.prototype.Pne=function(){};Object(ca.a)(f,"ResizeMarqueeTouchBehavior",r,[]);Rk(n,C);n.Uqb=function(fb,ac){var Ac=document.createElement("div");Ac.className=ac;fb.appendChild(Ac)};Object(ca.a)(n,"SelectionCutCopyBehavior",C,[]);Rk(l,C);Object(ca.a)(l,"SelectionPasteBehavior",C,[]);Rk(k,C);k.jrb=function(fb,ac){var Ac=document.createElement("div");
Ac.className=ac;fb.appendChild(Ac)};Object(ca.a)(k,"SelectionRangePickerBehavior",C,[]);Rk(e,N);e.prototype.FRa=function(){var fb=this.gridView.ui||this.gridView.isEditing;return this.gridView.ha.sa.sg&&!fb&&N.prototype.FRa.call(this)};Mf.Object.defineProperties(e.prototype,{w4:{configurable:!0,enumerable:!0,get:function(){return 0}},Tbb:{configurable:!0,enumerable:!0,get:function(){return this.gridView.ha.sa.Vc}}});Object(ca.a)(e,"SelectionTouchGrippiesBehavior",N,[]);var Va=aa.a;Rk(d,Va);d.prototype.dispose=
function(){this.gridView.qb.Gaj(this.hob);this.hF&&(this.hF.dispose(),this.hF=null);Va.prototype.dispose.call(this)};Object(ca.a)(d,"GridHighlightsBehaviorManager",aa.a,[]);var tb=ea.a;Rk(c,tb);c.prototype.create=function(){var fb=this;ua.TaskExtensions.Aa(va.GetServiceTaskFactory.create(this.$.da,134,this.la,this.hb),function(ac){fb.pb(fb.$.da.za(64)||new d(fb.$,ac.result))},this.la,3)};c.ka=function(fb){fb.da.Ga(149,new c(fb))};Object(ca.a)(c,"GridHighlightsBehaviorManagerFactory",ea.a,[]);b.d(E,
"a",function(){return a})},1347:function(u,E,b){function a(){G.a.Fa(function(xb){c.ka(xb);I.ka(xb)})}function c(xb){var Va=kc.call(this)||this;Va.$=xb;Va.Eb();return Va}function d(xb,Va,tb){tb=void 0===tb?null:tb;var fb=Rb.call(this,Va)||this;fb.sheetTabActivatePreviousHidden=oa.a.instance.ga(725);fb.sheetTabActivateNextHidden=oa.a.instance.ga(727);fb.svgIconProvider=null;fb.lh=[];fb.oK=Array(6);fb.xwd=Array(6);fb.Pk=null;fb.CPd=null;fb.jwc=null;fb.Jcb=null;fb.hwc=null;fb.rH=null;fb.Yxb=null;fb.wRa=
null;fb.isRtl=!1;fb.Hu=0;fb.dK=0;fb.Hsc=!1;fb.V6b=!1;fb.Zma=0;fb.tpc=0;fb.c7b=null;fb.X$=null;fb.z3=null;fb.mM=null;fb.AC=0;fb.scc=0;fb.DMb=null;fb.LAb=-1;fb.OY=null;fb.Aoc=0;fb.$xc=-1;fb.tma=0;fb.yta=new D;fb.FKc=!1;fb.t_=null;fb.ufe=null;fb.DPd=null;fb.EPd=null;fb.Isc=null;fb.N8d=!1;fb.ikd=null;fb.Pvd=!1;fb.tfe=null;fb.TC=function(ac,Ac){fb.LBf(Ac.item)};fb.xya=function(ac,Ac){ac=fb.$.va.pa.index;for(var Rc=0,Fc=fb.lh.length;Rc<Fc;Rc++){var wb=fb.xQ(Rc);if(wb.name===Ac.oldName){wb.name=Ac.newName;
fb.Y_();Rc===ac&&fb.k0(6);break}}};fb.QBf=function(ac,Ac){(ac=fb.q2a(Ac.item))&&ac.Zeb()};fb.RBf=function(ac,Ac){Ac.visible?(fb.nRa(!1),fb.NBf(Ac.item)):fb.LBf(Ac.item)};fb.lN=function(ac){fb.aF?(fb.OY=ac,fb.YNb()):(fb.OY&&(fb.tpc+=fb.OY.clientPoint.x-ac.clientPoint.x),fb.OY=ac,Math.abs(fb.tpc)>=fb.uhh&&fb.YNb());return!0};fb.xN=function(ac){ac.Ca.preventDefault();return!1};fb.FVf=function(ac){fb.BVf(ac,!0)};fb.EVf=function(ac){fb.BVf(ac,!1)};fb.d6=function(ac){if(fb.aF&&(fb.iz||fb.Tff(ac)))if(fb.V6b=
fb.Obf(ac),fb.iz){var Ac;ac=(Ac=fb.xQ(fb.AC+1))?Ac.sheet:null;fb.reorderSheets(ac,fb.AC+1===fb.APd,!0)}else ac=fb.Pvd?null:fb.ikd,fb.reorderSheets(ac,fb.Pvd,!0);fb.eQ();return!0};fb.uh=function(ac,Ac){Ac.sF&&fb.dYd(Ac.sF);fb.rvc(!1);fb.Y_();Ac.pa&&(fb.dYd(Ac.pa),fb.k0(6),fb.ea.Zla())};fb.ysf=function(ac,Ac){fb.ABc(Ac.item)};fb.zsf=function(ac,Ac){fb.ABc(Ac.item)};fb.Asf=function(ac,Ac){fb.ABc(Ac.item)};fb.mOa=function(ac,Ac){fb.ABc(Ac.item)};fb.dya=function(){fb.P_c()};fb.Yc=function(){fb.isVisible=
!fb.ea.isNamedObjectViewMode;fb.P_c();fb.z3c();ka.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",!1)&&(Ic.d(fb.$)||Ic.e(fb.$))&&(Vb.PageLoadTrackingInfo.instance.wW(C.a.rAa,["sheetTabBar"]),Vb.PageLoadTrackingInfo.instance.vW(C.a.rAa,["sheetTabBar"]));fb.h3c();fb.Y_();fb.nRa(!0);fb.k0(6)};fb.Oi=function(){fb.isVisible&&(fb.Y_(),fb.k0(6))};fb.Qf=function(){Object(aa.a)(A,fb.rH)===qa.k(fb.$.mg)&&fb.h3c();for(var ac=bk(fb.lh),Ac=ac.next();!Ac.done;Ac=ac.next())Ac.value.Jnj(!qa.k(fb.$.mg))};
fb.PBf=function(ac,Ac){fb.Wcj(Ac.item,Ac.isUserOperation)};fb.REb=function(ac,Ac){fb.NBf(Ac.item)};fb.onKeyDown=function(ac){switch(ac.keyCode){case 9:var Ac=fb.domElement.querySelectorAll(Ia.DOMElementExtensions.er),Rc=Ia.DOMElementExtensions.Cl(Ac);Ac=Ia.DOMElementExtensions.az(Ac);Ia.DOMElementExtensions.kna(ac,Rc,Ac);break;case 39:case 37:Ia.DOMElementExtensions.BYf(ac,fb.domElement.querySelectorAll(Ia.DOMElementExtensions.er),39===ac.keyCode?!fb.isRtl:fb.isRtl)}R.ULS.sendTraceTag(537153691,0,
50,"SheetTabBarControl.OnKeyDown: Press on {0}",ac.keyCode)};fb.onScroll=function(){fb.Pk.scrollLeft!==fb.Zma&&fb.jIj()};fb.i6=function(ac){if(ac.ctrlKey||ac.W2)return!1;fb.Pk.scrollLeft+=Math.floor(30*ac.SBa);if(fb.iz&&fb.aF){var Ac=fb.uYe("OnMouseWheel");Ac&&fb.OTd(0<ac.SBa,Ac.x+Ac.width/2)}return!0};fb.oF=function(ac,Ac){if(fb.yta)fb.R4e("PartialInteractivity",Ac.JL?3:0);else{fb.eQ(!1);fb.dOd(Ac.JL);ac=bk(fb.lse);for(var Rc=ac.next();!Rc.done;Rc=ac.next())(Rc=Rc.value)&&Rc.dX(Ac.JL);ac=bk(fb.lh);
for(Rc=ac.next();!Rc.done;Rc=ac.next())(Rc=Rc.value)&&Rc.dX(Ac.JL)}};fb.ZDb=function(ac,Ac){ac=0;Ac.rje&&(ac=2|(Ac.Iuj?1:0));fb.R4e("ComponentRangePicker",ac)};fb.$=xb;fb.ea=fb.$.ea;fb.iz=P.a.Mdf();fb.k7b=fb.iz&&!ka.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2");fb.em=ka.EwaSettings.ma(502);fb.hw=P.a.mpd();fb.Rff=fb.em&&!(ka.EwaSettings.isChangeGateEnabled("OfficeVSO:6179307_hideSheetDropDownMenuForMobileMeetings")&&fb.$.IC);fb.iz&&(fb.N8d=fb.em&&
!fa.a.Uu);fb.QBi=fb.$.ya.SheetTabNavigateButtonLongKeyPressPeriodMS;fb.PBi=fb.$.ya.SheetTabNavigateButtonIntervalPeriodMS;fb.uhh=fb.$.ya.SheetTabDragStartPixelThreshold;fb.ZOa=-1;fb.YOa=-1;fb.H1c=!1;fb.hw&&(fb.svgIconProvider=tb);fb.ZB=new sa.a(fb.domElement,3);fb.em&&fb.domElement.classList.add(x.yrh);fb.t7g();fb.V4g();fb.u7g();fb.w8g();fb.rvc(!0);fb.Yc(null,null);xb=fb.$.va;xb.If(fb.uh);xb.iUc(fb.dya);xb.fY(fb.TC);xb.Ega(fb.REb);xb.yFa(fb.xya);xb.Bme(fb.PBf);xb.qYa(fb.RBf);xb.REg(fb.QBf);xb.sUc(fb.ysf);
xb.yme(fb.zsf);xb.zme(fb.Asf);xb.Ame(fb.mOa);fb.$.Tk(fb.Yc);fb.$.sA(fb.Oi);da.a(fb.$).Lh(fb);fb.$.da.Ga(32,fb);ka.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport")&&fb.$.ea.zu(fb.Qf);fb.iwc=fb.je.Sd(fb.domElement);fb.iwc.ka("keydown",fb.onKeyDown);Wa.a(fb.$).Kp()&&fb.oF(null,new vb.a(!0));Wa.a(fb.$).Rf.G9(fb.oF);Fb.g(fb.$).Xle(fb.ZDb);ka.EwaSettings.isChangeGateEnabled("OfficeVSO:4227145_InEditingDisableInsertSheetButton")&&fb.iwc.ka("mousedown",function(ac){ac.preventDefault()});
ca.a.instance.ra(ea.a.MC,fb.domElement,fb.i6);fb.BPd=fb.je.Sd(fb.Pk);fb.BPd.ka("scroll",fb.onScroll);fb.jIj=ob.a(function(){fb.Y_()},200,fb.$.la,za.a.Nuj,!0);fb.$.DC(C.a.tBj);fb.Rff&&(fb.tfe=new m(fb.$,fb.wRa.domElement));ka.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",!1)&&Vb.PageLoadTrackingInfo.instance.U6(C.a.rAa,["sheetTabBar"]);return fb}function e(xb,Va,tb){Va=z.call(this,document.createElement("a"),Va)||this;Va.mha=ka.EwaSettings.ma(502)?xa.a.w8c:xa.a.vsh;tb.nb(Va.domElement,
oa.a.instance.ga(716),0,Va.mha,oa.a.instance.ga(716),Ob.a.Y0c,!0);xb.appendChild(Va.domElement);Va.Ac.ka("contextmenu",function(fb){Ha.g(fb)});return Va}function k(xb,Va,tb,fb,ac,Ac,Rc){var Fc=z.call(this,document.createElement("li"),xb)||this;Fc.n0f=0;Fc.o0f=0;Fc.x0c=0;Fc.y0c=0;Fc.N3c=.5;Fc.vPd=!1;Fc.LU=!1;Fc.sO=null;Fc.WCb=null;Fc.kE=null;Fc.HGc=null;Fc.color=null;Fc.tdf=!1;Fc.dhc=!1;Fc.j5b="#BEBBB8";Fc.fEc=null;Fc.onKeyDown=function(wb){return 13!==wb.Ca.keyCode||Fc.disabled?!1:(Fc.activateSheet(1),
!0)};Fc.sz=function(wb){return 32!==wb.Ca.charCode||Fc.disabled?!1:(Fc.activateSheet(1),!0)};Fc.rN=function(){Fc.disabled||(Fc.YR.wRi(Fc),Fc.YR.aF||Fc.qna(!0,void 0,"OnMouseOver"))};Fc.qN=function(){Fc.disabled||Fc.qna(!1,void 0,"OnMouseOut")};Fc.oya=function(){Fc.YR.aF||(Fc.LDj(),Fc.sheet.p7||Fb.g(Fc.$).DIb(Fc.sheet.sheetName));return!1};Fc.h6=function(){Fc.dKe(!1);return!1};Fc.$c=function(wb){if(Fc.disabled)return!0;var uc=Fb.g(Fc.$);Fc.sheet.active||3!==wb.lb?Fc.em?Fc.activateSheet(wb.lb):P.a.aqd()&&
uc.focus():(!P.a.zMa(Fc.$)&&!Fc.oAb||uc.isEditing||uc.ui||uc.bsb(),Fc.activateSheet(wb.lb));return 3!==wb.lb};Fc.onPointerDown=function(wb){if(Fc.disabled)return!0;Fc.dKe(!0);Fb.g(Fc.$).inRangePicker&&R.ULS.sendTraceTag(35985038,0,15,"SheetTabButton:OnPointerDown() - Tried clicking different sheet while in range picker (e.g editing a formula).");var uc=3===wb.lb;if(2===wb.lb||uc&&Fc.Owa)Fc.em?(Fc.qna(!0,!uc,"OnPointerDown"),uc=K.Task.delay(uc?Fc.o0f:Fc.n0f).Io(function(){return!0})):uc=Fc.activateSheet(wb.lb),
Fc.Mzb&&(Fc.dhc=!0,Fc.YR.Isc=J.TaskExtensions.Aa(uc,function(){Fc.dhc&&Fc.YR.yRi(Fc,wb)},Fc.la,11));return!1};Fc.Bf=function(wb){if(Fc.disabled||!Fc.Mzb&&ka.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport"))return!0;var uc=Fc.YR.aF&&!P.a.Mdf();Fc.dhc=!1;Fc.em&&Fc.qna(2===wb.lb,void 0,"OnPointerUp");Fc.YR.Isc&&(J.TaskExtensions.Aa(Fc.YR.Isc,function(){Fc.YR.xRi(Fc)},Fc.la,11),Fc.YR.Isc=null);return uc};Fc.xN=function(){Fc.dhc=!1;Fc.vPd||Fc.qna(!1,void 0,"OnTouchMove");
return!1};Fc.Zxe=new l(Fc,xb);Fc.em=Ac;Fc.hw=Rc;Fc.oAb=P.a.oAb(xb);Fc.umd=ka.EwaSettings.isChangeGateEnabled("OfficeVSO:3843903_DelayLoadSheetViewIcon")&&!Fc.hw;Fc.em?(Fc.n0f=xb.ya.SheetDragReorderDelayInMilliseconds,Fc.o0f=xb.ya.SheetDragReorderDelayInMillisecondsForTouch,Fc.x0c=18,Fc.y0c=20):(Fc.x0c=19,Fc.y0c=22);Fc.$=xb;Fc.oWb=fb;Fc.YR=ac;Fc.Mzb=ac.toe();Fc.K9g();Fc.I3g();Fc.mjd=xb.Fb.Kg("UserAction",Fc.name);Fc.Dnd=!1;Ia.DOMElementExtensions.gu(Fc.domElement,C.a.Gs,null,null);Fc.domElement.appendChild(Fc.anchor);
Fc.anchor.appendChild(Fc.kE);Fc.vna=new Na.a;xb=new v(Fc.sheet,Fc.em,Fc.hw);Fc.vna.add(new n(Fc.$,xb));Fc.$.ea.YKb&&(xb=new r(Fc.sheet,Fc.em,Fc.hw),Fc.vna.add(new n(Fc.$,xb)));Fc.umd||(xb=new f(Fc.sheet,Fc.YR.ewc,function(){return Fc.color?k.CQd(Fc.color):!1},Fc.hw),Fc.WCb=new n(Fc.$,xb),Fc.vna.add(Fc.WCb));Fc.Owa=Fc.YR.Owa;Fc.Zeb();Fc.x8i();Fc.mte=new sa.a(Fc.domElement,1);Va.insertBefore(Fc.domElement,tb);kb.a(Fc.$)&&Fc.Xcg(!0);return Fc}function l(xb,Va){var tb=Za.call(this,xb.domElement)||this;
tb.onKeyDown=function(fb){121===fb.keyCode&&fb.shiftKey&&!tb.xna.disabled&&(tb.showContextMenu(new Sys.UI.Point(0,0),1,tb.xna.anchor),Ha.g(fb))};tb.oca=function(fb){if(!tb.$.isEditMode||tb.xna.disabled)return!0;tb.rename(!1,fb.lb);return!0};tb.Il=function(fb){return tb.xna.disabled?!0:tb.showContextMenu(fb.clientPoint,fb.lb,fb.zb)};tb.yfe=xb;tb.$=Va;qb.a.instance.ra(ea.a.$j,xb.domElement,tb.oca);ub.a.instance.ra(xb.domElement,tb.Il);tb.Ac.ka("keydown",tb.onKeyDown);return tb}function n(xb,Va){var tb=
this;this.lqa=this.p1=this.PAa=this.ol=null;this.Fef=!1;this.EQc=this.Vna=this.zsa=this.wha=this.ysa=null;this.rN=function(){tb.dataSource.UM()&&J.TaskExtensions.Aa(tb.GBb,function(){dialogControls.renderToolTip(tb.dataSource.gs(),"SheetIconTooltip",tb.dataSource.lVd(),tb.oI,10,!1,!1,1)},tb.$.la,3)};this.qN=function(){tb.dataSource.UM()&&tb.clearToolTip()};this.$=xb;this.dataSource=Va;this.hw=P.a.mpd()}function f(xb,Va,tb,fb){this.sheet=xb;this.altText=oa.a.instance.ga(1883);this.dKj=Va;this.N1f=
tb;this.hw=fb}function v(xb,Va,tb){this.em=Va;this.hw=tb;this.sheet=xb;this.altText=oa.a.instance.ga(1963)}function r(xb,Va,tb){this.em=Va;this.hw=tb;this.sheet=xb;this.altText=oa.a.instance.ga(1964)}function y(xb,Va,tb){var fb=z.call(this,document.createElement("a"),xb,!0)||this;fb.tg=function(){fb.dX(!1);fb.$.ea.mn(fb.tg)};fb.$c=function(ac){fb.b9f(ac.lb);return!0};fb.onKeyDown=function(ac){return 13===ac.Ca.keyCode||32===ac.Ca.keyCode?(fb.b9f(ac.lb),!0):!1};fb.isa=Va.nb(fb.domElement,oa.a.instance.ga(516),
0,xa.a.erh,oa.a.instance.ga(516),Ob.a.U0h,fb.disabled);fb.domElement.classList.add(x.hrh);tb.appendChild(fb.domElement);fb.$.ea.il(fb.tg);fb.m7i();return fb}function m(xb,Va){var tb=ab.call(this,document.createElement("div"))||this;tb.lR=function(){R.ULS.sendTraceTag(537153794,0,50,"SheetDropdownMenu.OnSheetsChanges");tb.uQf(!1,"OnSheetsChanged")};tb.QIi=function(){tb.Pi()};tb.PIi=function(){tb.Tj()};tb.$=xb;tb.fHj=Va;tb.LU=!1;tb.kNb=0;return tb}function w(xb,Va){this.sheetName=null;this.newSheetIndex=
0;this.sheetName=xb;this.newSheetIndex=Va}function B(xb,Va,tb){var fb=z.call(this,document.createElement("a"),Va)||this;fb.$c=function(ac){fb.$.Fd(-684145703,ac.lb,0,null);return!0};fb.xEb=function(ac){ib.HelperMethods.bVd(fb.due,fb.mha,fb.mha+C.a.Udc,("mouseover"===ac.type||"focus"===ac.type)&&!Fb.g(fb.$).inRangePicker)};fb.$=Va;fb.mha=ka.EwaSettings.ma(502)?xa.a.w8c:xa.a.XNe;fb.due=tb.nb(fb.domElement,oa.a.instance.ga(514),0,fb.mha,oa.a.instance.ga(515),Ob.a.Y0c);xb.appendChild(fb.domElement);fb.Ac.ka("contextmenu",
function(ac){Ha.g(ac)});fb.Ac.ka("mouseover",fb.xEb);fb.Ac.ka("mouseout",fb.xEb);qb.a.instance.ra(ea.a.click,fb.domElement,fb.$c);fb.GMa=ua.KeyInputManager.instance.Xr(fb.domElement,fb.$c,yb.a.Oh,yb.a.X0);return fb}function A(xb,Va,tb,fb){fb=void 0===fb?!1:fb;var ac=z.call(this,document.createElement("a"),Va,fb)||this;ac.$c=function(Ac){ac.disabled||ac.$.Fd(-1935155518,Ac.lb,30,null);return!0};ac.xEb=function(Ac){Ac="mouseover"===Ac.type||"focus"===Ac.type;var Rc=kb.a(ac.$)?ac.G$a:ac.isa;ib.HelperMethods.bVd(Rc,
ac.mha,ac.mha+C.a.Udc,Ac&&!Fb.g(ac.$).inRangePicker)};ac.Dh=function(){ac.dX(!0)};ac.Af=function(){ac.dX(!1)};ac.mha=ka.EwaSettings.ma(502)?xa.a.w8c:xa.a.XNe;ac.isa=tb.nb(ac.domElement,oa.a.instance.ga(512),0,ac.mha,oa.a.instance.ga(513),Ob.a.Y0c,fb);xb.appendChild(ac.domElement);ac.Ac.ka("contextmenu",function(Ac){Ha.g(Ac)});ka.EwaSettings.ma(502)||(ac.Ac.ka("mouseover",ac.xEb),ac.Ac.ka("mouseout",ac.xEb));qb.a.instance.ra(ea.a.click,ac.domElement,ac.$c);ac.GMa=ua.KeyInputManager.instance.Xr(ac.domElement,
ac.$c,yb.a.Oh,yb.a.X0);ka.EwaSettings.isChangeGateEnabled("OfficeVSO:4227145_InEditingDisableInsertSheetButton")&&(Fb.g(ac.$).$b.Ak(ac.Dh),Fb.g(ac.$).$b.tm(ac.Af));return ac}function z(xb,Va,tb){tb=void 0===tb?!1:tb;xb=ec.call(this,xb)||this;xb.isa=null;xb.G$a=null;xb.$=Va;xb.zX=tb;return xb}function x(){}function D(){this.eHe=new ra.a(!0);this.VGc=0}function I(xb){return N.call(this,xb)||this}function F(xb){this.Ihh=xb}var G=b(10),T=b(0),O=b(905),U=b(51),J=b(37),H=b(186),K=b(58);F.prototype.Lc=function(){return!1};
F.prototype.executeCommand=function(xb,Va){xb=Va.command;Va=null;switch(xb){case 1243860697:this.Ihh.OJj();break;default:Va=H.a(xb)}return Va||K.Task.Ua(!0)};F.prototype.zc=function(xb,Va){return 1243860697===Va.command};F.prototype.Qc=function(){return!1};Object(T.a)(F,"SheetDropdownMenuCommandHandler",null,[429]);var N=O.a;Rk(I,N);I.prototype.Ad=function(){var xb=this;this.$.bB(function(Va){Va.pec().then(function(){J.TaskExtensions.Aa(U.GetServiceTaskFactory.Ra(xb.$.da,32,33,xb.hb),function(tb){xb.jd([new F(tb.result.Guj)])},
xb.$.la)})})};I.ka=function(xb){O.a.Qd(392,new I(xb))};Object(T.a)(I,"SheetDropdownMenuCommandHandlerFactory",O.a,[]);var M=b(232),C=b(5),Q=b(78),P=b(36),ka=b(1),R=b(14),fa=b(27),ca=b(195),ea=b(13),wa=b(89),X=b(43),ja=b(245),va=b(161),ua=b(109),Xa=b(39),aa=b(440),ba=b(85),oa=b(15),ra=b(34);D.prototype.WJg=function(xb,Va){this.eHe.add(xb,Va);this.mS()};D.prototype.mS=function(){var xb=this;this.VGc=0;ra.a.forEach(this.eHe.Zt,function(Va){xb.VGc=xb.D5c|Va.value})};Mf.Object.defineProperties(D.prototype,
{D5c:{configurable:!0,enumerable:!0,get:function(){return this.VGc}},navigationButtonsDisabled:{configurable:!0,enumerable:!0,get:function(){return!!(this.D5c&1)}},operationButtonsDisabled:{configurable:!0,enumerable:!0,get:function(){return!!(this.D5c&2)}}});Object(T.a)(D,"SheetTabBarDisabledStateManager",null,[]);var db=b(244),Ka=b(30);x.yrh="ewa-stb-uir";x.aNe="ewa-stb-drag";x.irh="ewa-stb-navarea";x.jrh="ewa-stb-navarea-dimensions";x.lrh="ewa-stb-navbutton";x.jU="cui-disabled";x.krh="ewa-stb-navareaextra";
x.Uha="cui-img-container";x.frh="ewa-stb-contentarea";x.bNe="ewa-stb-left-scrollable";x.nNe="ewa-stb-right-scrollable";x.wrh="ewa-stb-tabarea";x.vrh="ewa-stb-sheettabmoveindicator";x.pNe="ewa-stb-tabs";x.yGj="tab-active";x.GGj="tab-inactive";x.FGj="tab-hover";x.xrh="ewa-stb-tabs-ghost";x.AGj="tab-anchor-text";x.dark="dark";x.light="light";x.zGj="tab-active-text";x.DGj="tab-content-container";x.IGj="tab-text";x.orh="ewa-stb-nsv-inactive";x.prh="ewa-stb-nsv-inactive-svg";x.mrh="ewa-stb-nsv-active";
x.nrh="ewa-stb-nsv-active-svg";x.Vph="ewa_nsv_margin";x.grh="ewa-stb-disable-scrollbar";x.fri="leave-size-fixed-on-tab-hover-old";x.eri="leave-size-fixed-on-tab-hover";x.fNe="ewa-stb-locked-sheet";x.gNe="ewa-stb-locked-sheet-svg";x.hNe="ewa-stb-locked-sheet-svg-16px";x.hrh="ewa-stb-dropdown-menu-button";x.Slh="ewa-active-sheet-menu-item";Object(T.a)(x,"CssClassNames",null,[]);var Ga=b(618),xa=b(19),da=b(272),qa=b(103),na=b(564),ia=b(177),ta=b(253),za=b(44),sa=b(297),V=b(53),Ia=b(12),Ha=b(69),ob=b(329),
ib=b(11),La=b(101),zb=b(358),Fb=b(21),Yb=b(196),kb=b(390),vb=b(386),Wa=b(42),qb=b(233),yb=b(86),ec=db.a;Rk(z,ec);z.prototype.dispose=function(){this.G$a=this.isa=this.$=null;ec.prototype.dispose.call(this)};z.prototype.dX=function(xb){this.zX=xb;this.domElement.setAttribute(C.a.Rra,xb.toString());Ia.DOMElementExtensions.toggleCssClass(this.domElement,Ga.a.jU,xb)};Mf.Object.defineProperties(z.prototype,{disabled:{configurable:!0,enumerable:!0,get:function(){return this.zX}}});Object(T.a)(z,"SheetBarButton",
db.a,[]);var Ob=b(921);Rk(A,z);A.prototype.dispose=function(){qb.a.instance.Ba(ea.a.click,this.domElement,this.$c);ua.KeyInputManager.instance.pv(this.domElement,this.GMa);ka.EwaSettings.isChangeGateEnabled("OfficeVSO:4227145_InEditingDisableInsertSheetButton")&&Fb.g(this.$)&&Fb.g(this.$).$b&&(Fb.g(this.$).$b.vk(this.Dh),Fb.g(this.$).$b.Nl(this.Af));z.prototype.dispose.call(this)};A.prototype.dX=function(xb){var Va=A.R0f(this.$);z.prototype.dX.call(this,xb||Va)};A.R0f=function(xb){return!xb.isEditMode||
!xb.va.count};Object(T.a)(A,"InsertSheetButton",z,[]);Rk(B,z);B.prototype.dispose=function(){qb.a.instance.Ba(ea.a.click,this.domElement,this.$c);ua.KeyInputManager.instance.pv(this.domElement,this.GMa);this.due=null;z.prototype.dispose.call(this)};Object(T.a)(B,"InsertTemplateButton",z,[]);w.prototype.getSheetName=function(){return this.sheetName};Object(T.a)(w,"MacroRecorderSheetReorderedPayload",null,[438]);var Cb=b(91),ab=db.a;Rk(m,ab);m.prototype.dispose=function(){this.Tj();ab.prototype.dispose.call(this)};
m.prototype.OJj=function(){this.uQf(!0,"TogglerSheetDropdownMenu")};m.prototype.uQf=function(xb,Va){R.ULS.sendTraceTag(537153795,0,50,"SheetDropdownMenu.RenderSheetMenuInternal: render start. caller: {0}, toggle: {1}, toggleStateId: {2}",Va,xb,this.kNb);xb&&(this.kNb+=1);var tb=this.$.Fb.sc("UserAction",String.format("SheetDropdownMenu.RenderSheetMenuInternal: caller: {0}, toggle: {1}, toggleStateId: {2}, sheetCount: {3}",Va,xb,this.kNb,this.$.va.count));xb=this.z9g();appChrome.renderSheetDropdownMenu(this.domElement,
this.fHj,xb,this.kNb,this.QIi,this.PIi,function(){tb.stop()},kb.a(this.$))};m.prototype.z9g=function(){for(var xb=this.$.va,Va=[],tb=0;tb<xb.count;tb++){var fb=Object(ba.a)(La.a,xb.getItem(tb));0===fb.qy&&(fb=this.y9g(fb),Va.push(fb))}return Va};m.prototype.y9g=function(xb){var Va={};Va.key=xb.name;Va.text=xb.name;Va.onClick=this.A9g(xb);xb.active&&(Va.className=kb.a(this.$)?"ewa-active-sheet-menu-item-present-mode":x.Slh);return Va};m.prototype.A9g=function(xb){var Va=this;return function(){var tb=
new Cb.a(-1876836819,0,Va.$.Jc,30,null),fb={};Va.$.Ka.Kb(tb,(fb[C.a.xPd]=xb.name,fb))}};m.prototype.Pi=function(){if(!this.LU){var xb=this.$.va;xb.If(this.lR);xb.iUc(this.lR);xb.fY(this.lR);xb.Ega(this.lR);xb.yFa(this.lR);xb.Bme(this.lR);xb.qYa(this.lR);this.LU=!0}};m.prototype.Tj=function(){if(this.LU){var xb=this.$.va;xb.vg(this.lR);xb.bId(this.lR);xb.R6(this.lR);xb.Ima(this.lR);xb.TPa(this.lR);xb.xPf(this.lR);xb.ZHb(this.lR);this.LU=!1}};Object(T.a)(m,"SheetDropdownMenu",db.a,[725,3]);var ya=b(366);
Rk(y,z);y.prototype.dispose=function(){this.wOj();z.prototype.dispose.call(this)};y.prototype.dX=function(xb){z.prototype.dX.call(this,xb||!this.$.ea.kwa)};y.prototype.b9f=function(xb){this.disabled||(R.ULS.sendTraceTag(537153793,0,50,"SheetDropdownMenuAnchor.ToggleMenu: inputMethod: {0}",ya.a[xb]),this.$.Ka.Kb(new Cb.a(1243860697,xb,this.$.Jc,30,null)))};y.prototype.m7i=function(){qb.a.instance.ra(ea.a.click,this.domElement,this.$c);ua.KeyInputManager.instance.ra(ea.a.Lb,this.domElement,this.onKeyDown)};
y.prototype.wOj=function(){qb.a.instance.Ba(ea.a.click,this.domElement,this.$c);ua.KeyInputManager.instance.Ba(ea.a.Lb,this.domElement,this.onKeyDown)};Object(T.a)(y,"SheetDropdownMenuAnchor",z,[]);var ma=b(62),ha=b(204),Z=b(130),Na=b(202),eb=b(133),cb=b(59),Ua=b(217),pa=b(203),Qa=b(173),Db=b(134);r.prototype.UM=function(){return this.sheet.active};r.prototype.Fnd=function(){return this.sheet.isLockPausedInSession};r.prototype.ysa=function(){return this.em?xa.a.eNe:this.UM()?xa.a.dNe:xa.a.cNe};r.prototype.Vna=
function(){return this.sheet.fj?Ob.a.OIf:ka.EwaSettings.isChangeGateEnabled("OfficeVSO:6104844_NewLockAndPauseSheetTabIcon")?Ob.a.iOj:Ob.a.hOj};r.prototype.KTd=function(){return ka.EwaSettings.isChangeGateEnabled("OfficeVSO:6104844_NewLockAndPauseSheetTabIcon")?16:13};r.prototype.MTd=function(){return ka.EwaSettings.isChangeGateEnabled("OfficeVSO:6104844_NewLockAndPauseSheetTabIcon")?16:12};r.prototype.wha=function(){return null};r.prototype.zsa=function(){return this.em?this.hw?ka.EwaSettings.isChangeGateEnabled("OfficeVSO:6104844_NewLockAndPauseSheetTabIcon")?
x.hNe:x.gNe:x.fNe:null};r.prototype.lVd=function(){return null};r.prototype.gs=function(){return null};r.prototype.Mjd=function(){return 0};r.prototype.IVc=function(){return!0};Object(T.a)(r,"LockPausedSheetIconDataSource",null,[695]);v.prototype.UM=function(){return this.sheet.active};v.prototype.Fnd=function(){return this.sheet.fj};v.prototype.ysa=function(){return this.em?xa.a.eNe:this.UM()?xa.a.dNe:xa.a.cNe};v.prototype.Vna=function(){return Ob.a.OIf};v.prototype.KTd=function(){return ka.EwaSettings.isChangeGateEnabled("OfficeVSO:6104844_NewLockAndPauseSheetTabIcon")?
16:13};v.prototype.MTd=function(){return ka.EwaSettings.isChangeGateEnabled("OfficeVSO:6104844_NewLockAndPauseSheetTabIcon")?16:12};v.prototype.wha=function(){return null};v.prototype.zsa=function(){return this.em?this.hw?ka.EwaSettings.isChangeGateEnabled("OfficeVSO:6104844_NewLockAndPauseSheetTabIcon")?x.hNe:x.gNe:x.fNe:null};v.prototype.lVd=function(){return null};v.prototype.gs=function(){return null};v.prototype.Mjd=function(){return 0};v.prototype.IVc=function(){return!0};Object(T.a)(v,"LockedSheetIconDataSource",
null,[695]);f.prototype.UM=function(){return this.sheet.active};f.prototype.Fnd=function(){return this.sheet.Md.Qx};f.prototype.wha=function(){return this.hw?this.UM()?x.nrh:x.prh:this.UM()?x.mrh:x.orh};f.prototype.ysa=function(){return!this.UM()&&this.N1f()?xa.a.dth:xa.a.cth};f.prototype.Vna=function(){return!this.UM()&&this.N1f()?Ob.a.Quj:Ob.a.Puj};f.prototype.KTd=function(){return 14};f.prototype.MTd=function(){return 16};f.prototype.zsa=function(){return x.Vph};f.prototype.lVd=function(){return this.sheet.Md.tmb};
f.prototype.gs=function(){return this.dKj};f.prototype.Mjd=function(){return 8};f.prototype.IVc=function(){return!1};Object(T.a)(f,"NamedSeetViewSheetIconDataSource",null,[695]);var Kb=b(162),Ab=b(129);n.prototype.hcg=function(){if(this.oI&&(this.ol||this.PAa)){if(this.hw){var xb=this.dataSource.Vna();this.Vna!==xb&&(this.PAa&&this.PAa.parentNode.removeChild(this.PAa),this.T9e(),this.Vna=xb)}else xb=this.dataSource.ysa(),this.ysa!==xb&&(this.iJd(this.ol,this.ysa,xb),this.ysa=xb);xb=this.dataSource.wha();
this.wha!==xb&&(this.hw?this.edj(this.PAa,this.wha,xb):this.iJd(this.ol,this.wha,xb),this.wha=xb);xb=this.dataSource.zsa();this.zsa!==xb&&(this.iJd(this.oI,this.zsa,xb),this.zsa=xb);this.dataSource.gs()&&!this.dataSource.UM()&&this.clearToolTip()}};n.prototype.nzj=function(xb,Va,tb){this.vai(xb,Va,tb);Ia.DOMElementExtensions.setVisible(this.oI,this.dataSource.Fnd())};n.prototype.clearToolTip=function(){var xb=this;J.TaskExtensions.Aa(this.GBb,function(){dialogControls.clearToolTip(xb.dataSource.gs())},
this.$.la,3)};n.prototype.vai=function(xb,Va,tb){this.oI&&this.Fef!==xb&&(this.oI.parentNode.removeChild(this.oI),this.zsa=this.wha=this.Vna=this.ysa=this.EQc=null,this.dataSource.gs()&&(this.Ac.detach("mouseover",!0),this.Ac.detach("mouseout",!0)));this.oI||(this.EQc=document.createElement("span"),Sys.UI.DomElement.addCssClass(this.oI,Ga.a.Uha),Sys.UI.DomElement.addCssClass(this.oI,xa.a.IA),ka.EwaSettings.ma(502)?xb===this.dataSource.IVc()?Va.appendChild(this.oI):Va.insertBefore(this.oI,tb):xb?Va.insertBefore(this.oI,
tb):Va.appendChild(this.oI),this.hw?this.T9e():(this.ol=document.createElement("img"),this.ol.tabIndex=-1,this.ol.alt=this.dataSource.altText,this.oI.appendChild(this.ol),this.ol.src=V.a.Se(this.dataSource.Mjd())),this.dataSource.gs()&&(this.Ac.ka("mouseover",this.rN,!0),this.Ac.ka("mouseout",this.qN,!0)),this.Fef=xb)};n.prototype.edj=function(xb,Va,tb){xb&&(Sys.UI.DomElement.removeCssClass(xb,Va),Sys.UI.DomElement.addCssClass(xb,tb))};n.prototype.iJd=function(xb,Va,tb){Va&&Sys.UI.DomElement.removeCssClass(xb,
Va);tb&&Sys.UI.DomElement.addCssClass(xb,tb)};n.prototype.dispose=function(){wa.a.Ia(this.p1)};n.prototype.T9e=function(){var xb=this.$.da.za(388);xb?(this.PAa=xb.nva(this.dataSource.Vna(),this.dataSource.KTd(),this.dataSource.MTd()))?this.oI.appendChild(this.PAa):R.ULS.shipAssertTag(537153763,0,!1,"Sheeticon.InsertCurrentSvgIcon: Svg with id {0} was not found.",this.dataSource.Vna()):R.ULS.shipAssertTag(537153792,0,!1,"Sheeticon.InsertCurrentSvgIcon: Unable to recieve SvgIconProvider service.")};
Mf.Object.defineProperties(n.prototype,{Ac:{configurable:!0,enumerable:!0,get:function(){return this.p1||(this.p1=Ab.a.instance.Sd(this.oI))}},GBb:{configurable:!0,enumerable:!0,get:function(){var xb=this;if(this.lqa)return this.lqa;var Va=new Kb.a;this.$.bB(function(tb){J.TaskExtensions.Aa(tb.Csd(),function(){Va.setResult(!0)},xb.$.la,3)});return this.lqa=Va.task}},oI:{configurable:!0,enumerable:!0,get:function(){return this.EQc}}});Object(T.a)(n,"SheetIcon",null,[3]);var ub=b(367),Mb=b(94),Aa=b(159),
Za=Mb.a;Rk(l,Za);l.prototype.dispose=function(){this.xna&&(qb.a.instance.Ba(ea.a.$j,this.xna.domElement,this.oca),ub.a.instance.Ba(this.xna.domElement,this.Il),this.yfe=null);this.$=null;Za.prototype.dispose.call(this)};l.prototype.showContextMenu=function(xb,Va,tb){this.xna.activate(Va,P.a.aqd());Va=new Cb.a(-1075099431,Va,this.$.Jc,30,null);var fb,ac={};return!Aa.a(fb=this.$.Ka.Kb(Va,(ac[C.a.r0f]=xb,ac[l.Huj]=this.xna.sheet,ac[C.a.s0f]=tb,ac)))&&(6!==fb.status||fb.result)};l.prototype.rename=function(xb,
Va){this.$.Fd(817296323,Va,xb?19:0,null)};Mf.Object.defineProperties(l.prototype,{xna:{configurable:!0,enumerable:!0,get:function(){return this.yfe}}});l.Huj="Sheet";Object(T.a)(l,"SheetOpsSheetClickHelper",Mb.a,[]);var Zb=b(41);Rk(k,z);k.prototype.iOh=function(){return Ia.DOMElementExtensions.canReceiveFocus(this.anchor)?this.anchor:null};k.prototype.dispose=function(){if(this.LU){ja.a.instance.Ba(ea.a.pointerDown,this.domElement,this.onPointerDown);ua.KeyInputManager.instance.Ba(ea.a.Lb,this.domElement,
this.onKeyDown);ua.KeyInputManager.instance.Ba(ea.a.Yo,this.domElement,this.sz);qb.a.instance.Ba(ea.a.click,this.domElement,this.$c);ja.a.instance.Ba(ea.a.aW,this.domElement,this.oya);ja.a.instance.Ba(ea.a.fy,this.domElement,this.h6);if(this.Mzb||ka.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport"))ja.a.instance.Ba(ea.a.Df,this.domElement,this.Bf),this.Owa&&(va.a.instance.Ba(ea.a.pe,this.domElement,this.Bf),va.a.instance.Ba(ea.a.lg,this.domElement,this.xN));this.LU=
!1;this.j5b="#BEBBB8"}wa.a.oc([this.Zxe,this.mte]);this.sO=this.kE=this.fEc=this.YR=this.mte=this.Zxe=null;if(this.vna){for(var xb=bk(this.vna),Va=xb.next();!Va.done;Va=xb.next())Va.value.dispose();this.vna=null}this.color=this.oWb=null;z.prototype.dispose.call(this)};k.prototype.dX=function(xb){xb&&this.qna(!1,!1);z.prototype.dX.call(this,xb)};k.prototype.jRd=function(xb){if(cb.a.qg.RQ){this.mHe();var Va=U.GetServiceTaskFactory.Ra(this.$.da,322,323,1);J.TaskExtensions.Aa(Va,function(tb){ha.UISurfaces.wQ().then(function(fb){var ac=
tb.result;ac.Oqj(fb);ac.show(xb);return null},function(fb){R.ULS.sendTraceTag(537153688,0,15,"SheetTabButton.ShowNamedSheetViewTeachingUI: Failed to GetNotificationsAPIAsync: {0}",fb);return null})},this.la,3)}};k.prototype.cle=function(){var xb=this;if(this.sheet.active&&this.$.Tq){var Va=this.$.Tq,tb=Fb.g(this.$),fb=tb.Pj;if(this.sheet.Md.Qx){if(!this.WCb){var ac=new f(this.sheet,this.YR.ewc,function(){return xb.color?k.CQd(xb.color):!1},this.hw);this.WCb=new n(this.$,ac);this.vna.add(this.WCb)}fb?
tb.Peb(1):Va.classList.add(xa.a.BPe);Va=k.ped(C.a.kqf);tb=k.ped(C.a.nwd);fb=k.ped(C.a.bqf);ac=this.sheet.Md.oQd;this.sheet.Md.oQd=!1;"true"===fb&&ac&&this.$.ea.rQd?(Z.a.Gw(C.a.bqf,"false",Z.a.HV),this.$.ea.rQd=!1,this.jRd(3)):"true"===Va&&"true"===tb&&"true"===fb?this.$.ea.sQd&&this.$.ea.sLb&&(this.sheet.Md.bK?(Va=1,Z.a.Gw(C.a.nwd,"false",Z.a.HV),this.$.ea.sLb=!1):Va=0,Z.a.Gw(C.a.kqf,"false",Z.a.HV),this.$.ea.sQd=!1,this.jRd(Va)):this.sheet.Md.bK&&"true"===tb&&"true"===fb&&this.$.ea.sLb&&(Z.a.Gw(C.a.nwd,
"false",Z.a.HV),this.$.ea.sLb=!1,this.jRd(2))}else this.mHe(),fb?tb.Peb(0):Va.classList.remove(xa.a.BPe)}};k.prototype.mHe=function(){if(ka.EwaSettings.isChangeGateEnabled("OfficeVSO:5782706_NSVTC")){var xb=this.$.da.za(322);xb&&xb.dismiss()}else this.$.Kpd&&(xb=U.GetServiceTaskFactory.Ra(this.$.da,322,323,0),J.TaskExtensions.Aa(xb,function(Va){Va.result.dismiss()},this.$.la,3))};k.prototype.Zeb=function(){this.name=this.sheet.name;this.domElement.className=this.sheet.active||this.m6a()?x.yGj:x.GGj;
ka.EwaSettings.isChangeGateEnabled("OfficeVSO:5262355_SheetTabFocusBugFix")?this.sO.parentNode.classList.add(x.eri):this.sO.parentNode.classList.add(x.fri);this.Ycg();this.umd&&this.cle();this.ozj();this.ddg();this.KAc();this.umd||this.cle()};k.prototype.uRi=function(){this.vPd=!0;this.qna(!0,!0,"OnSheetReorderStarted")};k.prototype.tRi=function(){this.vPd=!1;this.qna(!1,void 0,"OnSheetReorderEnded")};k.prototype.activate=function(xb,Va){xb=void 0===xb?0:xb;Va=void 0===Va?!1:Va;this.X1b()||(this.sheet.activate(),
Va&&Fb.g(this.$).focus(),Va={},xb=(Va.InputMethod=ya.a[xb],Va.AppMode=this.$.Jc,Va.Location="canvas",Va),Db.b(this.$).yd(eb.a.Duj,xb))};k.prototype.Xcg=function(xb){this.j5b=xb?"#797775":"#BEBBB8";this.N3c=xb?-.5:.5;this.HGc=xb?pa.a.Oo("#3B3A39"):pa.a.Oo("#F5F5F5");this.ddg()};k.prototype.Jnj=function(xb){this.Mzb=xb};k.prototype.Qyd=function(xb){xb.l1c();this.uwe(xb)};k.prototype.uwe=function(xb){xb.U_a();this.sheet.activate()};k.prototype.jzg=function(xb){xb=new Cb.a(-1876836819,xb,this.$.Jc,30,
null);var Va={};return this.$.Ka.Kb(xb,(Va[C.a.xPd]=this.sheet.name,Va))};k.prototype.Ycg=function(){this.sO.parentNode.setAttribute("sheet-title",this.sO.innerText)};k.prototype.KAc=function(){var xb=this.NHh();this.anchor.setAttribute(C.a.Bt,xb);this.anchor.setAttribute(C.a.Sga,this.sheet.active.toString())};k.prototype.NHh=function(){var xb=this.sheet.Md.Qx,Va=this.sheet.Md.tmb,tb=this.sheet.fj,fb=this.sheet.isLockPausedInSession;return xb&&tb?String.format(oa.a.instance.mb(20),this.name,Va):xb&&
fb?String.format(oa.a.instance.mb(22),this.name,Va):xb?String.format(oa.a.instance.mb(19),this.name,Va):tb?String.format(oa.a.instance.mb(18),this.name):fb?String.format(oa.a.instance.mb(21),this.name):this.name};k.prototype.activateSheet=function(xb){xb=void 0===xb?0:xb;if(P.a.aqd()){if(ka.EwaSettings.isChangeGateEnabled("OfficeVSO:4099273_PromptForCommentsOnSheetChange")&&this.X1b())return K.Task.Ua(!1);Qa.a.current.IW="ActivateSheet";this.sheet.activate();return K.Task.Ua(!0)}return this.jzg(xb)};
k.prototype.ddg=function(){var xb=this.sheet.tabColor;this.color=xb?pa.a.Oo(xb):this.kch;this.tdf=k.CQd(this.color);this.qna(!1,void 0,"UpdateTabColor")};k.prototype.qna=function(xb,Va,tb){Va=void 0===Va?!1:Va;tb=void 0===tb?null:tb;if(this.sheet){tb=this.sheet.active;var fb=this.m6a(),ac=!!this.sheet.tabColor,Ac=pa.a.VF(tb||fb?Ua.a.white:this.color);this.kE.style.background="";tb||fb?(ac?ka.EwaSettings.isChangeGateEnabled("OfficeVSO:5293663_SheetTabHighContrastBackgroundBug")&&this.$.QKa?this.Gsj():
this.em?this.Fsj():this.Esj():this.em||(this.kE.style.backgroundColor=Ac),this.kE.style.height=this.x0c.toString()+"px"):(this.kE.style.filter="",this.kE.style.backgroundColor=Ac,this.kE.style.height=this.y0c.toString()+"px");this.sO.className=tb?x.zGj:fb?x.dark:this.tdf?x.light:x.dark;Ac=bk(this.vna);for(var Rc=Ac.next();!Rc.done;Rc=Ac.next())Rc.value.hcg();this.em&&(xb&&!ac&&(this.kE.style.backgroundColor="#E1DFDD"),Ia.DOMElementExtensions.toggleCssClass(this.domElement,x.FGj,xb),Va?(ac||(this.kE.style.backgroundColor=
this.j5b),this.domElement.style.backgroundColor=this.j5b):(ac||(this.kE.style.backgroundColor=""),this.domElement.style.backgroundColor=""));this.sO.style.fontWeight=tb||fb||!this.em&&xb?this.em?"600":"bold":""}else R.ULS.sendTraceTag(537153687,0,15,"SheetTabButton.SetTabColors: can't change colors to a sheet tab without sheet, whihc means its not rendered. caller: {0}",tb)};k.prototype.Fsj=function(){var xb=this.kE.style,Va=pa.a.VF(k.QZc(this.color,this.N3c));xb.background=Va};k.prototype.Esj=function(){var xb=
this.kE.style,Va=pa.a.VF(k.QZc(this.color,1)),tb=pa.a.VF(k.QZc(this.color,this.N3c));xb.background=String.format("linear-gradient({1}, {2})",Va,tb)};k.prototype.Gsj=function(){this.kE.style.background="transparent"};k.prototype.I3g=function(){this.fEc=document.createElement("a");this.anchor.removeAttribute("Href");this.anchor.className=x.AGj;Ia.DOMElementExtensions.gu(this.anchor,C.a.Vnb,null,null);this.tabIndex=-1};k.prototype.K9g=function(){this.kE=document.createElement("span");this.kE.className=
x.DGj;this.sO=document.createElement("span");this.sO.className=x.IGj;this.sO.dir=this.sheet.rtlName?"rtl":"ltr";this.kE.appendChild(this.sO)};k.prototype.ozj=function(){for(var xb=this.$.cJ,Va=bk(this.vna),tb=Va.next();!tb.done;tb=Va.next())tb.value.nzj(xb,this.kE,this.sO)};k.prototype.m6a=function(){return Fb.g(this.$).m6a(this.sheet)};k.prototype.LDj=function(){this.mjd.start();this.Dnd=!0};k.prototype.dKe=function(xb){if(this.Dnd){this.mjd.stop();var Va={};xb=(Va["Sheet index"]=this.sheet.index,
Va["Active Sheet"]=this.sheet.active,Va["Hovering time"]=this.mjd.qc,Va["Has been clicked"]=xb,Va);R.ULS.sendTraceTag(537153686,0,50,Zb.c(xb));this.Dnd=!1}};k.prototype.x8i=function(){ja.a.instance.ra(ea.a.pointerDown,this.domElement,this.onPointerDown);ua.KeyInputManager.instance.ra(ea.a.Lb,this.domElement,this.onKeyDown);ua.KeyInputManager.instance.ra(ea.a.Yo,this.domElement,this.sz);this.Ac.ka("mouseover",this.rN);this.Ac.ka("mouseout",this.qN);ja.a.instance.ra(ea.a.aW,this.domElement,this.oya);
ja.a.instance.ra(ea.a.fy,this.domElement,this.h6);if(this.Mzb||ka.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport"))ja.a.instance.ra(ea.a.Df,this.domElement,this.Bf),this.Owa&&(va.a.instance.ra(ea.a.pe,this.domElement,this.Bf),va.a.instance.ra(ea.a.lg,this.domElement,this.xN));qb.a.instance.ra(ea.a.click,this.domElement,this.$c);this.LU=!0};k.prototype.X1b=function(){var xb=this.$.da.za(65);return xb&&xb.nba()?(xb.oJb(),this.uwe(xb),!0):!1};k.ped=function(xb){var Va=
Z.a.get(xb);Va||(Z.a.Gw(xb,"true",Z.a.HV),Va=Z.a.get(xb));return Va};k.QZc=function(xb,Va){if(1<Va||-1>Va)return xb;var tb=xb.r,fb=xb.g;xb=xb.b;0<Va?(tb=tb*(1-Va)+255*Va,fb=fb*(1-Va)+255*Va,xb=xb*(1-Va)+255*Va):(tb*=1+Va,fb*=1+Va,xb*=1+Va);return Ua.a.gub(Math.round(tb),Math.round(fb),Math.round(xb))};k.CQd=function(xb){return 128>=(222*xb.r+707*xb.g+71*xb.b)/1E3};Mf.Object.defineProperties(k.prototype,{kch:{configurable:!0,enumerable:!0,get:function(){return this.HGc||(this.HGc=pa.a.Oo("#F5F5F5"))}},
name:{configurable:!0,enumerable:!0,get:function(){return this.sO.innerText},set:function(xb){this.sO&&(this.sO.innerText=xb,this.KAc(),this.Ycg())}},sheet:{configurable:!0,enumerable:!0,get:function(){return this.oWb}},anchor:{configurable:!0,enumerable:!0,get:function(){return this.fEc}},tabIndex:{configurable:!0,enumerable:!0,get:function(){return this.anchor.tabIndex},set:function(xb){this.anchor.tabIndex=xb}}});Object(T.a)(k,"SheetTabButton",z,[]);Rk(e,z);Object(T.a)(e,"WorkbookProtectionButton",
z,[]);var jb=b(50),Vb=b(46),Ic=b(56),Rb=db.a;Rk(d,Rb);d.prototype.nb=function(xb,Va,tb,fb,ac,Ac,Rc){Rc=void 0===Rc?!1:Rc;xb.removeAttribute("Href");xb.setAttribute(C.a.Hd,C.a.Fs);xb.className=x.lrh;xb.title=Va;xb.tabIndex=0;this.hw&&Ac?tb=this.svgIconProvider.iba(Ac,12,12,xb,24,24):(Va=document.createElement("span"),Va.className=this.em?xa.a.sYg:xa.a.IA,Va.classList.add(Ga.a.Uha),Va.tabIndex=-1,xb.appendChild(Va),Ac=document.createElement("img"),Ac.src=V.a.Se(tb),Ac.className=fb,Ac.alt=ac,Ac.tabIndex=
-1,Va.appendChild(Ac),tb=Ac);Rc&&xb.classList.add(Ga.a.jU);return tb};d.prototype.dispose=function(){if(this.$){var xb=this.$.va;xb.vg(this.uh);xb.bId(this.dya);xb.R6(this.TC);xb.Ima(this.REb);xb.TPa(this.xya);xb.xPf(this.PBf);xb.ZHb(this.RBf);xb.Naj(this.QBf);xb.oId(this.ysf);xb.uPf(this.zsf);xb.vPf(this.Asf);xb.wPf(this.mOa);this.$.rl(this.Yc);this.$.gD(this.Oi);Wa.a(this.$)&&Wa.a(this.$).Rf.fda(this.oF);this.yta&&Fb.g(this.$).YOf(this.ZDb);ca.a.instance.Ba(ea.a.MC,this.domElement,this.i6)}wa.a.oc(this.xwd);
this.xwd=null;if(this.oK)for(xb=0;xb<this.oK.length;xb++){var Va=Ia.DOMElementExtensions.NJ(this.oK[xb],this.domElement,!1,"a");Va&&X.a.Bma(Va)}wa.a.Ia(this.ZB);wa.a.Ia(this.iwc);wa.a.Ia(this.BPd);this.BPd=this.iwc=this.Yxb=this.rH=this.ZB=null;this.$&&this.iz&&this.eQ(!1);this.X$=null;this.wNd(null,"Dispose");this.DMb=this.mM=this.c7b=null;this.P_c();this.Jcb=this.jwc=this.CPd=this.Pk=this.oK=this.$=this.ea=null;Rb.prototype.dispose.call(this)};d.prototype.Sf=function(xb,Va){if(!Va){R.ULS.shipAssertTag(537153760,
0,0<this.lh.length,"There is no sheet tab button.");if(!this.lh.length)return!1;xb=null;for(var tb=bk(this.lh),fb=tb.next();!fb.done&&!(xb=fb.value.iOh());fb=tb.next());if(!xb)return R.ULS.shipAssertTag(537153759,0,!1,"There is no focusable tab element."),!1;Ia.DOMElementExtensions.setFocus(xb)}return!Va};d.prototype.$g=function(xb){return Ia.DOMElementExtensions.nf(this.ic,xb)};d.prototype.ej=function(){};d.prototype.Aj=function(){};d.prototype.reorderSheets=function(xb,Va,tb){if(this.t_&&this.t_!==
xb){var fb=this.t_.index;this.Vcj(this.t_,xb,Va);xb=xb?xb.index-1:Va?this.$.va.count-1:0;fb!==xb&&(this.rvi(fb,xb,tb),this.pkh(this.t_.name,xb))}};d.prototype.c_h=function(xb){xb=this.Fia(xb);return-1!==xb&&this.Hu<=xb&&xb<=this.dK?this.lh[xb].domElement:null};d.prototype.ISj=function(xb){if(this.hw){for(var Va=0;Va<this.oK.length;Va++){var tb=this.oK[Va];if(tb&&this.svgIconProvider){var fb=tb.parentNode;this.AOf(tb);fb&&(this.oK[Va]=this.svgIconProvider.iba(xb?this.lHf[Va]:this.ywd[Va],12,12,fb,
24,24))}}for(Va=0;Va<this.lh.length;Va++)this.lh[Va].Xcg(xb);this.wRa&&this.wRa.isa&&this.Wcg(Ob.a.V0h,this.wRa,xb);this.rH&&this.rH.isa&&this.Wcg(Ob.a.C_g,this.rH,xb)}};d.prototype.Wcg=function(xb,Va,tb){Va.G$a||(Va.G$a=this.svgIconProvider.iba(xb,12,12,Va.isa.parentNode,24,24));Va.G$a&&(Ia.DOMElementExtensions.setVisible(Va.isa,!tb),Ia.DOMElementExtensions.setVisible(Va.G$a,tb))};d.prototype.yRi=function(xb,Va){var tb=Fb.g(this.$),fb=tb.inRangePicker,ac=ib.HelperMethods.En(Va);if(tb.isEditing&&
!fb){var Ac=tb.pj?"formulaBar_end_edit_sheet_changed":"cell_text_end_edit_sheet_changed",Rc=void 0;ka.EwaSettings.o6a&&(Rc=[Object(Yb.a)(tb.$b.textBox.YAa)]);Yb.b(this.$).TSa(ac.rawEvent,Ac,Rc);tb.endEdit(!0,"SheetTabBar.OnSheetTabMouseDown")}tb=this.Owa&&3===Va.lb;!(2===Va.lb&&ac.button===Sys.UI.MouseButton.leftButton||tb)||fb||this.aF||Wa.a(this.$).Kp()||(tb&&xb.uRi(),this.LAb=Va.clientPoint.x,this.OY=Va,this.vNg(xb))};d.prototype.wRi=function(xb){!this.iz&&this.aF&&this.sRd(xb.sheet,!1)};d.prototype.xRi=
function(xb){this.iz||(this.aF&&this.reorderSheets(xb.sheet,!1,!0),this.eQ());this.Y_()};d.prototype.toe=function(){return this.$.isEditMode&&!qa.k(this.$.mg)};d.prototype.Y_=function(){var xb=this,Va=ib.HelperMethods.dca(function(){xb.HQj();xb.em&&xb.fsj();xb.dOd()});R.ULS.sendTraceTag(537153757,0,50,"SheetTabBarControl.RearrangeContentAreaAndNavAreaExtra: duration = {0}",Va)};d.prototype.fsj=function(){var xb=this.dK===this.lh.length-1;Ia.DOMElementExtensions.toggleCssClass(this.Jcb,this.$.cJ?x.nNe:
x.bNe,!!this.Hu);Ia.DOMElementExtensions.toggleCssClass(this.Jcb,this.$.cJ?x.bNe:x.nNe,!xb)};d.prototype.dOd=function(xb){xb=void 0===xb?!1:xb;var Va=!this.Hu,tb=this.dK===this.lh.length-1;this.gZf(4,this.sheetTabActivatePreviousHidden,!Va);this.gZf(5,this.sheetTabActivateNextHidden,!tb);this.Fvc(0,Va||xb);this.Fvc(1,Va||xb);this.Fvc(2,tb||xb);this.Fvc(3,tb||xb)};d.prototype.gZf=function(xb,Va,tb){if(xb=this.oK[xb]){Ia.DOMElementExtensions.setVisible(xb,tb);var fb=this.XZe(xb);fb.title="img"===xb.nodeName?
xb.alt=0<this.lh.length&&tb?Va:"":xb.title=0<this.lh.length&&tb?Va:"";fb.tabIndex=tb?0:-1}};d.prototype.XZe=function(xb){return this.hw?xb.parentNode:xb.parentNode.parentNode};d.prototype.Fvc=function(xb,Va){if(xb=this.oK[xb])xb=this.XZe(xb),void 0!==xb&&null!==xb&&(!this.lh.length||Va?(xb.classList.add(Ga.a.jU),xb.setAttribute(C.a.Rra,"true")):(xb.classList.remove(Ga.a.jU),xb.setAttribute(C.a.Rra,"false")))};d.prototype.nRa=function(xb){var Va=this.$.cJ?this.lh.length-1:0,tb=this.m1e(this.$.cJ?0:
this.lh.length-1);tb&&(tb.borderRightWidth=xb?"1px":"0");this.Hu!==this.dK&&(tb=this.m1e(Va))&&(tb.borderRightWidth="0")};d.prototype.ple=function(xb,Va){this.lh||(this.lh=[]);-1===Va?Array.add(this.lh,xb):Array.insert(this.lh,Va,xb)};d.prototype.B4b=function(xb,Va){var tb=-1,fb=null;Va||(tb=this.dSh(xb.index),-1!==tb&&(fb=this.iKa(tb)));xb=new k(this.$,this.Pk,fb,xb,this,this.em,this.hw);this.ple(xb,tb);Ia.DOMElementExtensions.setVisible(xb.domElement,!0)};d.prototype.sRd=function(xb,Va){var tb=
this.q2a(xb);if(tb){this.ikd=xb;this.Pvd=Va;xb=tb.domElement;tb=this.isRtl?xb.offsetLeft+(this.Pk.scrollWidth-this.Pk.clientWidth-this.Pk.scrollLeft):xb.offsetLeft-this.Pk.scrollLeft;if(!this.isRtl&&Va||this.isRtl&&!Va)tb+=xb.offsetWidth;this.hwc.style.left=ib.HelperMethods.jc(tb-4);Ia.DOMElementExtensions.setVisible(this.hwc,!0)}};d.prototype.X6e=function(){Ia.DOMElementExtensions.setVisible(this.hwc,!1)};d.prototype.k0=function(xb){var Va=this,tb=ib.HelperMethods.dca(function(){switch(xb){case 0:Va.muc(0);
break;case 1:Va.muc(Va.Hu-1);break;case 2:Va.muc(Va.Hu+1);break;case 3:Va.scrollIntoView(Va.lh.length-1);break;case 4:Va.Hu&&1<=Va.lh.length&&(Va.bje(Va.Hu-1),Va.VLd());break;case 5:Va.dK!==Va.lh.length-1&&1<=Va.lh.length&&(Va.bje(Va.dK+1),Va.VLd());break;case 6:Va.VLd()}});this.k7b&&this.aF&&this.YNb();R.ULS.sendTraceTag(537153755,0,50,"SheetTabBarControl.ScrollSheetTabs: operation = {0}, duration = {1}",xb,tb)};d.prototype.bje=function(xb){(xb=this.xQ(xb))&&xb.activate()};d.prototype.xAh=function(xb){if(0===
xb.qy)for(var Va=this.$.va,tb=0,fb=0,ac=Va.count;fb<ac;fb++){var Ac=Object(ba.a)(La.a,Va.getItem(fb));if(Ac===xb)return tb;0===Ac.qy&&tb++}return-1};d.prototype.kAh=function(xb){var Va=this.$.va;xb=xb.index+1;for(var tb=Va.count;xb<tb;xb++){var fb=Object(ba.a)(La.a,Va.getItem(xb));if(0===fb.qy)return fb}return null};d.prototype.Fia=function(xb){for(var Va=0;Va<this.lh.length;Va++){var tb=this.xQ(Va);if(!tb)R.ULS.sendTraceTag(537153754,0,15,"SheetTabBarControl.FindMatchingSheetTabIndex: sheetTabButton[{0}] is null even though index is not out of bounds!",
Va);else if(tb.sheet===xb)return Va}return-1};d.prototype.q2a=function(xb){xb=this.Fia(xb);return this.xQ(xb)};d.prototype.rvi=function(xb,Va,tb){var fb={};fb.a=this.$.ya.UserSessionId;fb.b=tb;fb.c=this.V6b;fb.d=xb;fb.e=Va;fb.f=this.$.va.count;jb.b().Ce(2,fb,tb)};d.prototype.Vcj=function(xb,Va,tb){var fb=Object(ba.a)(zb.a,this.$.va);Va?(Va=Va.index,Va=xb.index<Va?Va-1:Va):Va=tb?fb.count-1:0;fb.reorderSheet(xb,Va,!0)};d.prototype.FYf=function(xb){Fb.g(this.$).hg.vo(xb)};d.prototype.vNg=function(xb){if(!this.Hsc){var Va=
this.domElement.ownerDocument.body;this.iz?(ja.a.instance.ra(ea.a.Rj,document.documentElement,this.lN),this.Owa&&(va.a.instance.ra(ea.a.lg,document.documentElement,this.lN),va.a.instance.ra(ea.a.lg,this.domElement,this.xN))):(ja.a.instance.ra(ea.a.Rj,Va,this.lN),va.a.instance.ra(ea.a.lg,Va,this.lN));ja.a.instance.ra(ea.a.Df,document.documentElement,this.d6);va.a.instance.ra(ea.a.pe,Va,this.d6);this.Hsc=!0}this.t_=xb.sheet;this.V6b=!1;this.iz?(this.mM=null,this.c7b=xb,this.X$=xb.domElement,this.wNd(Ia.DOMElementExtensions.getBoundingClientRect(this.X$),
"BeginSheetTabButtonDrag")):(R.ULS.sendTraceTag(537153752,0,50,"SheetTabBarControl.BeginSheetTabButtonDrag: Starting legacy sheet tab drag and drop."),this.domElement.classList.add(x.aNe),this.domElement.style.cursor="",this.FYf("pointer"))};d.prototype.eQ=function(xb){xb=void 0===xb?!0:xb;if(this.Hsc){this.FYf(C.a.m4);var Va=this.domElement.ownerDocument.body;this.iz?(ja.a.instance.Ba(ea.a.Rj,document.documentElement,this.lN),this.Owa&&(va.a.instance.Ba(ea.a.lg,document.documentElement,this.lN),
va.a.instance.Ba(ea.a.lg,this.domElement,this.xN))):(ja.a.instance.Ba(ea.a.Rj,Va,this.lN),va.a.instance.Ba(ea.a.lg,Va,this.lN));ja.a.instance.Ba(ea.a.Df,document.documentElement,this.d6);va.a.instance.Ba(ea.a.pe,Va,this.d6);this.FKc=this.Hsc=!1}this.tpc=0;this.V6b=!1;this.ikd=this.t_=null;this.iz?(this.X$&&(this.X$.style.visibility="visible",this.X$=null),this.c7b=null,this.wNd(null,"EndSheetTabButtonDrag"),this.mM&&(this.mM.parentNode&&this.mM.parentNode.removeChild(this.mM),this.mM=null),this.hfj(xb)):
(this.domElement.classList.remove(x.aNe),this.X6e())};d.prototype.hfj=function(xb){this.bTd(xb);this.AC=this.LAb=-1};d.prototype.pkh=function(xb,Va){function tb(Rc,Fc,wb){var uc=Ac.Na(9,null);uc.sheetName=xb;uc.newSheetIndex=Va;return ma.g(Ac,"ReorderSheets",uc,Rc,Fc,wb,null,0)}function fb(){return new w(xb,Va)}var ac=this.$.oa,Ac=ac?ac.xa:null;ka.EwaSettings.Zb()?this.$.userOperationManager.Sb(new ia.a(557,0,tb,64,fb),null):this.$.userOperationManager.Sb(new na.a(557,0,tb,void 0,fb),null)};d.prototype.xQ=
function(xb){return 0<=xb&&xb<this.lh.length?this.lh[xb]:null};d.prototype.l1e=function(xb){return(xb=this.xQ(xb))?xb.sheet:null};d.prototype.iKa=function(xb){return(xb=this.xQ(xb))?xb.domElement:null};d.prototype.m1e=function(xb){return(xb=this.iKa(xb))?xb.style:null};d.prototype.dSh=function(xb){var Va=this.$.va;xb+=1;for(var tb=-1,fb=this.lh?this.lh.length:0;xb<Va.count;){var ac=Object(ba.a)(La.a,Va.getItem(xb));if(0===ac.qy){for(tb=0;tb<fb&&this.l1e(tb)!==ac;tb++);break}xb++}return-1===tb||tb===
fb?-1:tb};d.prototype.LBf=function(xb){var Va=this.q2a(xb);Va&&(this.iz&&this.aF&&(R.ULS.sendTraceTag(537153751,0,50,"SheetTabBarControl.OnSheetDeletedOrHidden: A sheet has been deleted while re-order operation is midway."),ka.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&this.eQ()),this.Pk.removeChild(Va.domElement),Va=Array.indexOf(this.lh,Va),Array.removeAt(this.lh,Va),this.Y_(),(!this.isRtl&&Va===this.lh.length||this.isRtl&&!Va)&&this.nRa(!0),
this.k7b&&this.aF?xb===this.t_?(this.eQ(),this.k0(6)):this.YNb():this.k0(6))};d.prototype.NBf=function(xb){var Va=Object(ba.a)(La.a,xb);this.iz&&this.aF&&(R.ULS.sendTraceTag(537153750,0,50,"SheetTabBarControl.OnSheetInsertedOrUnhidden: A sheet has been added to the sheet tab bar while re-order operation is midway."),ka.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&this.eQ());if(0===Va.qy){this.nRa(!1);var tb=this.Fia(xb);-1===tb&&(R.ULS.sendTraceTag(537153749,
0,50,"SheetTabBarControl.OnSheetInsertedOrUnhidden: could not find matching sheet tab index. Creating sheet tab..."),this.B4b(Va,!1),tb=this.Fia(xb));this.$4e(tb,!0)}};d.prototype.Wcj=function(xb,Va){var tb=this.q2a(xb);tb&&(this.iz&&this.aF&&!Va&&(R.ULS.sendTraceTag(537153748,0,50,"SheetTabBarControl.ReorderSheetTab: A sheet has been re-ordered while re-order operation is midway."),ka.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&this.eQ()),
xb=this.uGj(xb,tb),!ka.EwaSettings.isChangeGateEnabled("OfficeVSO:4176044_CancelCallsToSetTabColorAfterReorder")&&this.iz&&xb&&Va&&xb.tRi())};d.prototype.uGj=function(xb,Va){var tb=Array.indexOf(this.lh,Va),fb=this.xAh(Object(ba.a)(La.a,xb));if(-1===fb||-1===tb)return null;tb!==fb||this.iz?(this.nRa(!1),fb=d.Scj(tb,fb,this.Hu,this.dK),this.Hu=fb.XAh,this.dK=fb.dqi,Va&&Va.domElement.parentNode===this.Pk&&(this.Pk.removeChild(Va.domElement),Array.removeAt(this.lh,tb)),Va=this.kAh(xb),tb=this.Fia(Va),
Va=new k(this.$,this.Pk,this.iKa(tb),Object(ba.a)(La.a,xb),this,this.em,this.hw),this.ple(Va,tb),tb=this.Fia(xb),this.$4e(tb,!1,!this.em)):Va=null;return Va};d.prototype.alh=function(){for(var xb=this.lh?this.lh.length:0,Va=this.Hu,tb=this.dK,fb=0;fb<xb;fb++){var ac=this.xQ(fb),Ac=fb>=Va;ac&&(ac.tabIndex=Ac&&fb<=tb?0:-1)}};d.prototype.sPj=function(){for(var xb=this.lh?this.lh.length:0,Va=0;Va<xb;Va++){var tb=this.xQ(Va);tb&&tb.Zeb()}};d.prototype.$4e=function(xb,Va,tb){tb=void 0===tb?!0:tb;Va&&xb<=
this.Hu&&this.Hu++;this.alh();this.nRa(!0);this.Y_();this.k7b&&this.aF?this.YNb():tb&&this.k0(6)};d.prototype.rvc=function(xb){var Va=this.$.cJ;if(xb||this.isRtl!==Va)this.isRtl=Va,this.domElement.classList.remove(this.isRtl?xa.a.iNe:xa.a.oNe),this.domElement.classList.add(this.isRtl?xa.a.oNe:xa.a.iNe),this.domElement.dir=this.isRtl?"rtl":"ltr",this.sPj();xb||this.nRa(!0);for(xb=0;xb<this.oK.length;xb++)0!==xb&&3!==xb&&(!this.em||4!==xb&&5!==xb)&&this.hZf(xb)};d.prototype.t7g=function(){var xb=this.CPd=
document.createElement("div");xb.className=x.irh;this.em&&xb.classList.add(x.jrh);this.domElement.appendChild(xb);this.v4b(xb,1,720,719);this.v4b(xb,2,722,721);this.Rff&&(this.wRa=new y(this.$,this,xb));this.em||this.v4b(xb,4,726,725)};d.prototype.u7g=function(){var xb=this.jwc=document.createElement("div");xb.className=x.krh;this.domElement.appendChild(xb);this.em||this.v4b(xb,5,728,727);this.h3c()};d.prototype.w8g=function(){var xb=document.getElementById(C.a.Euj),Va=document.getElementById(C.a.Fuj);
xb&&!Va&&R.ULS.sendTraceTag(537153746,0,50,"CreateProgressBarArea - progressBar div is not null, separator div is null. progressBarDiv parent ID: {0}. progressBar div has child: {1}. ProgressBarMessage div exists: {2}",xb.parentNode.id,!!xb.firstChild,!!document.getElementById(C.a.sPd));if(P.a.Xff(this.$)&&xb&&Va)this.domElement.appendChild(xb),this.DPd=xb.firstChild,this.EPd=document.getElementById(C.a.sPd),Va.style.visibility="visible";else{xb=document.createElement("div");Va=document.createElement("div");
xb.className=xa.a.trh;Va.className=xa.a.rrh;Va.style.display="none";var tb=document.createElement("div");tb.className=xa.a.urh;var fb=document.createElement("div");fb.className=xa.a.srh;var ac=document.createElement("div");ac.className=xa.a.qrh;Va.appendChild(tb);Va.appendChild(fb);Va.appendChild(ac);xb.appendChild(Va);this.domElement.appendChild(xb);this.DPd=Va;this.EPd=fb}};d.prototype.hZf=function(xb){var Va=this.oK[xb];if(Va)if(this.hw){var tb=Va.parentNode;this.AOf(Va);Va=kb.a(this.$)?this.lHf[xb]:
this.ywd[xb];this.oK[xb]=this.svgIconProvider.iba(Va,12,12,tb,24,24)}else Va.className=this.wwd[xb]};d.prototype.AOf=function(xb){(null===xb||void 0===xb?0:xb.parentNode)&&xb.parentNode.removeChild(xb)};d.prototype.V4g=function(){var xb=this.Jcb=document.createElement("div");xb.className=x.frh;this.domElement.appendChild(xb);this.B9g(xb)};d.prototype.B9g=function(xb){var Va=document.createElement("div");Va.className=x.wrh;Va.classList.add(x.grh);this.$.printingEnabled||Va.classList.add(Ka.a.vPe);
xb.appendChild(Va);this.Pk=document.createElement("ul");Ia.DOMElementExtensions.gu(this.Pk,C.a.nWc,null,null);this.Pk.className=Ka.a.pNe;Va.appendChild(this.Pk);this.m7g();this.ufe=document.createElement("div");this.ewc.id="SheetIconTooltipContainer";Va.appendChild(this.ewc)};d.prototype.m7g=function(){var xb=document.createElement("div"),Va="<div class='"+xa.a.wYg+"'>{0}</div>",tb=V.a.mcd(xa.a.ush,0,"55_16_N","");xb.innerHTML=String.format(Va,tb);xb.className=x.vrh;Ia.DOMElementExtensions.setVisible(xb,
!1);this.hwc=xb;this.Pk.appendChild(xb)};d.prototype.z3c=function(){for(var xb=this.$.va,Va=0,tb=xb.count;Va<tb;Va++){var fb=Object(ba.a)(La.a,xb.getItem(Va));0===fb.qy&&(this.B4b(fb,!0),fb.active&&fb.activate())}};d.prototype.P_c=function(){wa.a.oc(this.lh);this.lh=[];this.dK=this.Hu=0};d.prototype.v4b=function(xb,Va,tb,fb){function ac(wb){"mouseup"===wb.type&&Ac.iz&&Ac.aF||Ha.g(wb);Rc.classList.contains(Ga.a.jU)||(Fc?Ac.hOi(wb,Va):Ac.em||Ac.Uyf(wb,Va))}var Ac=this,Rc=document.createElement("a");
xb.appendChild(Rc);xb=this.ywd[Va];this.oK[Va]=this.nb(Rc,oa.a.instance.ga(fb),0,this.wwd[Va],oa.a.instance.ga(tb),xb);if(5===Va||4===Va)Ia.DOMElementExtensions.NJ(this.oK[Va],Rc,!1,"span").style.marginTop="10px";this.hZf(Va);tb=this.xwd[Va]=this.je.Sd(Rc);ja.a.instance.ra(ea.a.pointerDown,Rc,function(wb){return wb.ctrlKey&&Ac.gIi(Va)?!0:Ac.Syf(Va)});ja.a.instance.ra(ea.a.Df,Rc,function(){return Ac.Tyf()});va.a.instance.ra(ea.a.pe,Rc,function(){return Ac.Tyf()});ja.a.instance.ra(ea.a.pointerOut,Rc,
function(){return Ac.H_c()});ua.KeyInputManager.instance.ra(ea.a.Lb,Rc,function(wb){return 13!==wb.Ca.keyCode&&32!==wb.Ca.keyCode||Ac.H1c?!1:(Ac.H1c=!0,Ac.Syf(Va))});ua.KeyInputManager.instance.ra(ea.a.Gd,Rc,function(wb){return 13===wb.Ca.keyCode||32===wb.Ca.keyCode?(Ac.H1c=!1,Ac.H_c()):!1});var Fc=this.toe();tb.ka("mouseover",ac);tb.ka("mouseout",ac);tb.ka("focus",ac);tb.ka("blur",ac);Fc&&tb.ka("mouseup",ac)};d.prototype.Obf=function(xb){var Va=!1,tb=this.$.tf;tb&&(Va=Xa.a.SM(Ia.DOMElementExtensions.getBoundingClientRect(tb),
xb.clientPoint));return Va};d.prototype.Tff=function(xb){return Xa.a.SM(Ia.DOMElementExtensions.getBoundingClientRect(this.domElement),xb.clientPoint)||this.Obf(xb)};d.prototype.tAh=function(xb){var Va=null,tb=xb.clientPoint,fb=this.Hu;if(this.Tff(xb))for(fb=this.Hu;fb<=this.dK;fb++)if(Va=this.xQ(fb))if(xb=Ia.DOMElementExtensions.getBoundingClientRect(Va.domElement),!this.isRtl&&tb.x<xb.x+xb.width||this.isRtl&&tb.x>xb.x)break;return{returnValue:Va,eyj:fb>this.dK}};d.prototype.YNb=function(){if(this.iz){if(!this.mM){R.ULS.sendTraceTag(537153743,
0,50,"SheetTabBarControl.UpdateDragAndDropState: Starting modern sheet tab drag and drop.");this.mM=this.X$.cloneNode(!0);if(!this.$Tf(this.mM,this.X$,!0,"UpdateDragAndDropState"))return;this.X$.style.visibility="hidden";this.mM.classList.add(x.xrh);this.mM.style.borderRightWidth="";this.scc=this.OY.clientPoint.x-this.z3.width/2;this.mM.style.left=this.scc+"px";this.AC=this.Fia(this.t_);0>this.AC&&R.ULS.sendTraceTag(537153742,0,15,"SheetTabBarControl.UpdateDragAndDropState: ghostIndex < 0!")}this.k7b&&
(this.AC=this.Fia(this.t_));var xb=Ia.DOMElementExtensions.getBoundingClientRect(this.Pk),Va=xb.x;xb=xb.x+xb.width;var tb=this.OY.clientPoint.x-this.z3.width/2;tb=Math.min(tb,xb-this.z3.width);tb=Math.max(tb,Va);this.mM.style.transform="translateX("+Math.abs(tb-this.scc)*(this.scc<tb?1:-1)+"px)";var fb=this.OY.clientPoint.x>this.LAb,ac=this.OY.clientPoint.x;tb>=xb-this.z3.width?(ac=xb-this.z3.width/2,this.SLd()||this.tma||(R.ULS.sendTraceTag(537153741,0,50,"SheetTabBarControl.OnDocumentPointerMove: Starting modern sheet tab bar scroll with drag and drop to the right."),
this.Aoc=this.Pk.scrollLeft,this.tma=window.requestAnimationFrame(this.FVf))):tb<=Va?(ac=Va+this.z3.width/2,this.RLd()||this.tma||(R.ULS.sendTraceTag(537153740,0,50,"SheetTabBarControl.OnDocumentPointerMove: Starting modern sheet tab bar scroll with drag and drop to the left."),this.Aoc=this.Pk.scrollLeft,this.tma=window.requestAnimationFrame(this.EVf))):this.tma&&(R.ULS.sendTraceTag(537153739,0,50,"SheetTabBarControl.UpdateDragAndDropState: Ending scroll as dragged sheet left renderd edge of stb."),
this.bTd());this.OY.clientPoint.x!==this.LAb&&(this.OTd(fb,ac),this.LAb=this.OY.clientPoint.x)}else xb=this.tAh(this.OY),Va=xb.eyj,(xb=xb.returnValue)?this.sRd(xb.sheet,Va):this.X6e();this.FKc=!0};d.prototype.OTd=function(xb,Va){for(var tb=this,fb;function(){var ac=tb.vhh(Va,xb);fb=ac.w1b;return ac}().returnValue;)this.DMb=fb,this.RIg(xb)};d.prototype.RIg=function(xb){if(this.DMb){var Va=(xb?1:-1)*this.z3.width;if(xb&&!this.$.cJ||!xb&&this.$.cJ){var tb=this.X$;var fb=this.AC+1;var ac=!0}else tb=(fb=
this.xQ(this.AC+1))?fb.domElement:null,fb=this.AC-1,ac=!1;if(this.$Tf(this.DMb,tb,ac,"AnimateSheetSwap")){R.ULS.sendTraceTag(537153738,0,50,"SheetTabBarControl.AnimateSheetSwap: Sheet swap between ghost-index {0} and other sheet-index {1}. amount of sheets in the bar: {2} isMovingRight: {3}",this.AC,fb,this.APd,xb);0<=this.AC&&this.AC<this.lh.length&&0<=fb&&fb<this.lh.length?(xb=this.lh[fb],this.lh[fb]=this.lh[this.AC],this.lh[this.AC]=xb):(R.ULS.sendTraceTag(537153737,0,15,"SheetTabBarControl.AnimateSheetSwap: indices are out of range! length: {0}, ghostIndex: {1}, swappedSheetIndex: {2}",
this.lh.length,this.AC,fb),this.eQ());this.AC=fb;var Ac=this.DMb;Ac.style.transform="translateX("+Va+"px)";window.requestAnimationFrame(function(){Ac.style.transform="translateX(0px)"})}}};d.prototype.$Tf=function(xb,Va,tb,fb){function ac(Ac){return Ac?String.format("Node ID: {0} , Node class: {1}, Node name: {2},",Ac.id,Ac.className,Ac.nodeName):null}try{return this.Pk.insertBefore(xb,Va),!0}catch(Ac){return xb=this.q2a(this.t_),R.ULS.sendTraceTag(537153736,0,15,"SheetTabBarControl.SafeInsertSheetBefore: Reference node is not a descendant of the sheet tab bar. sheetTabButonState: [{0}], Caller: [{1}], Node to insert before [{2}], That node's parent: [{3}],SheetTabListElement: [{4}], isReferenceSheetTheDraggedSheet:[{5}], ghostIndex:[{6}], sheetTabButtons length:[{7}], Exception: [{8}]",
xb?xb!==this.c7b?"Changed":"NoChange":"Removed",fb,ac(Va),ac(Va.parentNode),ac(this.Pk),tb,this.AC,this.APd,Ac),this.eQ(),!1}};d.prototype.vhh=function(xb,Va){var tb=this.$.cJ===Va?this.xQ(this.AC-1):this.xQ(this.AC+1);if(!tb)return{returnValue:!1,w1b:null};tb=tb.domElement;var fb=Ia.DOMElementExtensions.getBoundingClientRect(tb);return this.z3?Va?{returnValue:xb+this.z3.width/2>=fb.x+.5*fb.width,w1b:tb}:{returnValue:xb-this.z3.width/2<=fb.x+.5*fb.width,w1b:tb}:(R.ULS.sendTraceTag(537153735,0,50,
"SheetTabBarControl.DraggedSheetCrossesSiblingSheet: Avoding JS crash and ending drag and drop due to client bounds of dragged sheet being null."),this.eQ(),{returnValue:!1,w1b:tb})};d.prototype.BVf=function(xb,Va){var tb=Va?this.FVf:this.EVf;if(-1===this.$xc)this.$xc=xb,this.tma=window.requestAnimationFrame(tb);else{xb=Math.floor((xb-this.$xc)/1E3*300);var fb=this.VIb>this.sBb?1:-1;this.scrollLeft(Math.abs(this.Pk.scrollLeft-(Va?this.Aoc+xb*fb:this.Aoc-xb*fb))*(Va?-1:1));if(xb=this.uYe("ScrollStep"))this.OTd(Va,
xb.x+xb.width/2),Va&&!this.SLd()||!Va&&!this.RLd()?this.tma=window.requestAnimationFrame(tb):(R.ULS.sendTraceTag(537153734,0,50,"SheetTabBarControl.ScrollStep: Ending scroll as dragged sheet reached first/last sheet."),this.bTd())}};d.prototype.SLd=function(){var xb=this.VIb>this.sBb;return xb&&this.Zma>=this.VIb||!xb&&this.Zma<=this.VIb};d.prototype.RLd=function(){var xb=this.VIb>this.sBb;return xb&&this.Zma<=this.sBb||!xb&&this.Zma>=this.sBb};d.prototype.bTd=function(xb){xb=void 0===xb?!0:xb;this.Pk&&
(this.Zma=this.Pk.scrollLeft);window.cancelAnimationFrame(this.tma);this.tma=0;this.$xc=-1;xb&&this.Y_()};d.prototype.wNd=function(xb,Va){xb||R.ULS.sendTraceTag(537153733,0,50,"SheetTabBarControl.SetDraggedSheetTabButtonRect: DraggedSheetTabButtonRect set to null by {0}",Va);this.z3=xb};d.prototype.gIi=function(xb){return 2===xb?(this.k0(3),!0):1===xb?(this.k0(0),!0):!1};d.prototype.Syf=function(xb){var Va=this;R.ULS.shipAssertTag(537153732,0,-1===this.ZOa&&-1===this.YOa,"SheetTabBarControl.OnNavigateButtonDown: PeriodicNavigateSetTimeoutID and PeriodicNavigateSetIntervalID should be -1 on button down!");
-1!==this.ZOa&&(window.clearTimeout(this.ZOa),this.ZOa=-1);-1!==this.YOa&&(window.clearInterval(this.YOa),this.YOa=-1);this.k0(xb);this.ZOa=window.setTimeout(function(){Va.aEj(xb)},this.QBi);return!0};d.prototype.aEj=function(xb){var Va=this;this.YOa=window.setInterval(function(){Va.k0(xb)},this.PBi)};d.prototype.Tyf=function(){this.H_c();return!this.iz||!this.aF};d.prototype.H_c=function(){window.clearTimeout(this.ZOa);window.clearInterval(this.YOa);this.YOa=this.ZOa=-1;return!0};d.prototype.Uyf=
function(xb,Va){var tb=this.wwd[Va];ib.HelperMethods.bVd(this.oK[Va],tb,tb+C.a.Udc,"mouseover"===xb.type||"focus"===xb.type)};d.prototype.hOi=function(xb,Va){var tb=this.lgc(Va),fb=5===Va;if("mouseup"===xb.type){if(fb||4===Va)tb||this.reorderSheets(null,fb,!1),this.eQ()}else!this.iz&&this.aF?(tb||this.sRd(this.l1e(fb?this.dK:this.Hu),fb),this.k0(fb?2:1)):this.em||this.Uyf(xb,Va)};d.prototype.lgc=function(xb){return!!Ia.DOMElementExtensions.hdd(this.oK[xb],"a").title};d.prototype.ABc=function(xb){this.dYd(xb);
this.Y_()};d.prototype.dYd=function(xb){(xb=this.q2a(xb))&&xb.Zeb()};d.prototype.VLd=function(){var xb=this.$.va;if(xb.pa&&(!Ic.e(this.$)||xb.count))if(xb=this.Fia(xb.pa),-1===xb)R.ULS.sendTraceTag(537153729,0,50,"SheetTabBarControl.ScrollToActiveIndex: shouldn't have an invisible, active sheet");else{var Va=this.iKa(xb);xb<this.Hu?this.muc(xb):xb>this.Hu&&!this.bqd(Va)&&this.scrollIntoView(xb)}};d.prototype.HQj=function(){this.Hu=0;this.dK=this.lh.length-1;for(var xb=!1,Va=0;Va<this.lh.length;Va++){var tb=
this.xQ(Va);if(!tb)break;var fb=this.bqd(tb.domElement);tb.tabIndex=fb?0:-1;if(!xb&&fb)this.Hu=Va,xb=!0;else if(xb&&!fb){this.dK=Va-1;break}}};d.prototype.muc=function(xb){this.$.va.count&&(this.lh.length||this.z3c(),this.sXf(this.iKa(Math.max(0,Math.min(xb,this.lh.length-1)))),this.Y_())};d.prototype.scrollIntoView=function(xb){R.ULS.shipAssertTag(537153697,0,xb>=this.Hu,"SheetTabBarControl.ScrollIntoView: sheetTabIndex must be greater than the first visisble sheet tab index!");if(this.$.va.count){this.lh.length||
this.z3c();var Va=this.iKa(Math.max(0,Math.min(xb,this.lh.length-1))),tb=this.iKa(this.Hu);if(!this.bqd(Va)){Va=Ia.DOMElementExtensions.getBoundingClientRect(Va);var fb=Ia.DOMElementExtensions.getBoundingClientRect(this.Jcb);Va=this.isRtl?fb.x-Va.x:Va.x+Va.width-(fb.x+fb.width);for(fb=0;tb&&fb<Va;){var ac=Ia.DOMElementExtensions.getBoundingClientRect(tb);fb+=ac.width;tb=tb.nextSibling}tb?this.sXf(tb):R.ULS.sendTraceTag(537153696,0,15,"SheetTabBarControl.ScrollIntoView: new firstVisible is null. firstVisibleSheetTabIndex = {0}, lastVisibleSheetTabIndex = {1}, scroll to index: {2}",
this.Hu,this.dK,xb)}this.Y_()}};d.prototype.sXf=function(xb){var Va=Ia.DOMElementExtensions.getBoundingClientRect(this.Pk);xb=Ia.DOMElementExtensions.getBoundingClientRect(xb);this.isRtl?this.scrollLeft(Math.floor(Va.x+Va.width-(xb.x+xb.width+.5))):this.scrollLeft(Math.ceil(Va.x-xb.x-.5))};d.prototype.scrollLeft=function(xb){(0>xb&&this.SLd()||0<xb&&this.RLd())&&R.ULS.sendTraceTag(537153695,0,50,"SheetTabBarControl.Scrollleft: attempt to scroll after the edge (overflow) in sheet tab bar.");var Va=
this.Pk.scrollLeft;if(this.isRtl){if(fa.a.cF||fa.a.Nf){this.Pk.scrollLeft=this.Zma=Va-xb;return}if(fa.a.xH){this.Pk.scrollLeft=this.Zma=Va+xb;return}R.ULS.sendTraceTag(537153694,0,15,"SheetTabBarControl.ScrollLeft: unknown browser")}this.Pk.scrollLeft=this.Zma=Va-xb};d.prototype.bqd=function(xb){xb=Ia.DOMElementExtensions.getBoundingClientRect(xb);var Va=Ia.DOMElementExtensions.getBoundingClientRect(this.Jcb);return xb&&Va?xb.x>=Va.x-1&&xb.x+xb.width<=Va.x+Va.width+1:(R.ULS.sendTraceTag(537153693,
0,15,"SheetTabBarControl.IsTabCompletelyVisible: sheetTabRect is null or contentAreaRect is null"),!1)};d.prototype.O7g=function(){var xb=this.jwc;if(A.R0f(this.$))this.em?(wa.a.Ia(this.rH),this.rH=new A(xb,this.$,this,!0)):(wa.a.Ia(this.rH),this.rH=null);else if(!this.rH||this.em)wa.a.Ia(this.rH),qa.k(this.$.mg)?this.rH=new e(xb,this.$,this):this.rH=new A(xb,this.$,this)};d.prototype.kDe=function(xb,Va){var tb=this.$.va;if(!this.$.isEditMode||!tb.count)wa.a.Ia(Va),Va=null;else if(!Va)if(tb=this.em?
this.CPd:this.jwc,qa.k(this.$.mg))Va=new e(tb,this.$,this);else switch(xb){case 0:Va=new A(tb,this.$,this);break;case 1:Va=new B(tb,this.$,this);break;default:R.ULS.sendTraceTag(537153692,0,10,"Unsupported SheetTabBarButtonType. Are you trying to create a new button? Make sure to update the SheetTabBarButtonType enum and add a case here to support creation of your new button.")}return Va};d.prototype.h3c=function(){ka.EwaSettings.ma(426)?(this.rH=this.kDe(0,this.rH),this.Yxb=this.kDe(1,this.Yxb)):
this.O7g()};d.prototype.uYe=function(xb){var Va=Ia.DOMElementExtensions.getBoundingClientRect(this.mM);Va||(R.ULS.sendTraceTag(537153689,0,50,"SheetTabBarControl.{0}: GetBoundingClientRect returned null for the dragged sheet.",xb),this.eQ());return Va};d.prototype.R4e=function(xb,Va){this.yta.WJg(xb,Va);this.eQ(!1);this.dOd(this.navigationButtonsDisabled);xb=bk(this.HGj);for(Va=xb.next();!Va.done;Va=xb.next())(Va=Va.value)&&Va.dX(this.navigationButtonsDisabled);xb=bk(this.lse);for(Va=xb.next();!Va.done;Va=
xb.next())(Va=Va.value)&&Va.dX(this.operationButtonsDisabled)};d.Scj=function(xb,Va,tb,fb){xb<tb?(Va>tb&&tb--,Va>fb&&fb--):xb>fb?(Va<tb&&tb++,Va<fb&&fb++):Va<tb&&tb++;return{XAh:tb,dqi:fb}};Mf.Object.defineProperties(d.prototype,{ic:{configurable:!0,enumerable:!0,get:function(){return this.domElement}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return this.isVisible}},Yd:{configurable:!0,enumerable:!0,get:function(){return ta.a.zPd}},aF:{configurable:!0,enumerable:!0,get:function(){return this.FKc}},
APd:{configurable:!0,enumerable:!0,get:function(){return this.lh.length}},ewc:{configurable:!0,enumerable:!0,get:function(){return this.ufe}},Owa:{configurable:!0,enumerable:!0,get:function(){return this.N8d}},navigationButtonsDisabled:{configurable:!0,enumerable:!0,get:function(){return!!this.yta&&this.yta.navigationButtonsDisabled}},operationButtonsDisabled:{configurable:!0,enumerable:!0,get:function(){return!!this.yta&&this.yta.operationButtonsDisabled}},wwd:{configurable:!0,enumerable:!0,get:function(){return this.em?
this.$.cJ?[xa.a.h8b,xa.a.kNe,xa.a.mNe,xa.a.g8b,xa.a.bua,xa.a.bua]:[xa.a.g8b,xa.a.mNe,xa.a.kNe,xa.a.h8b,xa.a.bua,xa.a.bua]:this.$.cJ?[xa.a.h8b,xa.a.jNe,xa.a.lNe,xa.a.g8b,xa.a.bua,xa.a.bua]:[xa.a.g8b,xa.a.lNe,xa.a.jNe,xa.a.h8b,xa.a.bua,xa.a.bua]}},ywd:{configurable:!0,enumerable:!0,get:function(){return this.$.cJ?[null,Ob.a.Jze,Ob.a.Hze]:[null,Ob.a.Hze,Ob.a.Jze]}},lHf:{configurable:!0,enumerable:!0,get:function(){return this.$.cJ?[null,Ob.a.Kze,Ob.a.Ize]:[null,Ob.a.Ize,Ob.a.Kze]}},sBb:{configurable:!0,
enumerable:!0,get:function(){if(this.isRtl){if(fa.a.cF)return 0;if(fa.a.Nf)return-1*(this.Pk.scrollWidth-this.Pk.clientWidth);if(fa.a.Uu)return this.Pk.scrollWidth-this.Pk.clientWidth;R.ULS.sendTraceTag(537153762,0,15,"SheetTabBarControl.ScrollLeftEdgeValue: unknown browser")}return 0}},VIb:{configurable:!0,enumerable:!0,get:function(){if(this.isRtl){if(fa.a.cF)return this.Pk.scrollWidth-this.Pk.clientWidth;if(fa.a.Nf||fa.a.Uu)return 0;R.ULS.sendTraceTag(537153761,0,15,"SheetTabBarControl.ScrollRightEdgeValue: unknown browser")}return this.Pk.scrollWidth-
this.Pk.clientWidth}},lse:{configurable:!0,enumerable:!0,get:function(){return this.yta?[this.rH,this.Yxb]:[this.rH,this.Yxb,this.wRa]}},HGj:{configurable:!0,enumerable:!0,get:function(){return this.lh.concat(this.wRa)}},Guj:{configurable:!0,enumerable:!0,get:function(){return this.tfe}}});Object(T.a)(d,"SheetTabBarControl",db.a,[634,3,448]);var kc=M.a;Rk(c,kc);c.prototype.create=function(){var xb=this,Va=this.$.yb;if(Q.a(this.$.ya,1))Vb.PageLoadTrackingInfo.instance.jda(C.a.rAa,["sheetTabBar"]);
else{var tb=document.getElementById(Va+C.a.C4c);tb?(ka.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",!1)&&Vb.PageLoadTrackingInfo.instance.fAa(C.a.rAa),P.a.mpd()?J.TaskExtensions.Aa(U.GetServiceTaskFactory.Ra(this.$.da,388,387,this.hb),function(fb){xb.pb(xb.$.da.za(32)||new d(xb.$,tb,fb.result))},this.$.la,3):this.pb(this.$.da.za(32)||new d(this.$,tb))):Vb.PageLoadTrackingInfo.instance.jda(C.a.rAa,["sheetTabBar"])}};c.ka=function(xb){xb.da.Ga(33,new c(xb))};Object(T.a)(c,
"SheetTabBarFactory",M.a,[]);b.d(E,"a",function(){return a})},1357:function(u,E,b){function a(){x.a.Fa(function(da){w.ka(da);D.EwaSettings.tb()?y.ka(da):m.ka(da);l.ka(da);c.ka(da)})}function c(da){var qa=xa.call(this)||this;qa.$=da;qa.Eb();return qa}function d(da,qa){var na=this;this.OV=function(){na.Bd||na.Woe()};this.Bd=!1;this.QY=qa.kU;this.ariaLiveNotifier=da;this.RZd=new k(da,qa);this.QY&&this.QY.JQ?this.Woe():this.Pi()}function e(da,qa,na){var ia=this;this.Nxf=function(){ia.RZd.kLf();ia.ariaLiveNotifier.setEnabled(!0)};
this.$=qa;this.ariaLiveNotifier=da;this.RZd=new k(da,qa);this.X9b=na.Ged(this.$);this.X9b.XEg(this.Nxf)}function k(da,qa){this.$=qa;this.ariaLiveNotifier=da}function l(da){var qa=Ga.call(this)||this;qa.$=da;qa.Eb();return qa}function n(da,qa,na,ia,ta){var za=this;this.gridReadoutNotifier=null;this.hab=!1;this.ksa=this.bob=null;this.Qca=function(){D.EwaSettings.isChangeGateEnabled("OfficeVSO:5963256_DoNotReadActiveItemIfDisposed")&&!za.$?F.ULS.sendTraceTag(526235470,0,15,"calling readActiveItemDescription after dispose, ignoring."):
K.g(za.$).isEditing||za.P_b.Hq()};this.kFi=function(){if(!K.g(za.$).ha.Oa.yod){var sa=za.IGh();za.readText(sa.returnValue,sa.activeCell)}};this.cp=function(){var sa=za.activeCell;za.readText("Editing",sa);D.EwaSettings.isChangeGateEnabled("OfficeVSO:5190952_removePhoneticErrorDialog2")||sa&&sa.fdc&&!K.g(za.$).y5e||za.P_b.cancel()};this.Rc=function(){D.EwaSettings.isChangeGateEnabled("OfficeVSO:6053639_DoNotHandleSelectionChangedIfDisposed")&&!za.$?F.ULS.sendTraceTag(525366409,0,15,"calling onSelectionChanged after dispose, ignoring."):
(za.Qca(),za.hab&&K.g(za.$).inRangePicker&&1===ra.a.Cb&&(null===za.bob?za.bob=Xa.a.instance.create(za.UFd,n.QSc,"readSelectedRanges"):za.bob.Hq()))};this.$=qa;this.ariaLiveNotifier=da;this.sparklineManager=ia;this.tableManager=na;this.cD=new f;this.T5a=m.T5a();this.hab=D.EwaSettings.isChangeGateEnabled("OfficeVSO:5888244_FixCellReadoutInRangePicking");this.T5a&&(D.EwaSettings.tb()?this.gridReadoutNotifier=ta:this.gridReadoutNotifier=qa.da.za(244),F.ULS.shipAssertTag(537153937,0,!!this.gridReadoutNotifier,
"SelectionReadoutHandler.ctor: gridReadoutNotifier shouldn't be null"),n.QSc=700);this.P_b=Xa.a.instance.create(this.kFi,n.QSc,aa.a.Glj,!1);this.Pi()}function f(){this.activeItemName=null;this.Cff=!1;this.tableName=null;this.L_a=0;this.Oyc=!1}function v(){}function r(da){switch(da){case 1:return 1437;case 2:return 1438;case 3:return 1439;case 4:return 1440;case 5:return 1441;case 6:return 1442;case 7:return 1443;case 8:return 1444;case 9:return 1445;case 10:return 1446;case 11:return 1447;case 12:return 1448;
case 13:return 1449;case 14:return 1450;case 15:return 1451;case 16:return 1452;case 17:return 1453;case 18:return 1454;case 19:return 1455;case 20:return 1456;case 21:return 1457;case 22:return 1460;case 23:return 1458;case 24:return 1459;case 25:return 1461;case 26:return 1462;case 27:return 1463;case 28:return 1464;default:return 1465}}function y(da){var qa=R.call(this)||this;qa.$=da;qa.Eb();return qa}function m(da,qa){this.X_=this.oW=this.IN=null;this.Oia=qa;this.O8g(da);this.ZZi();D.EwaSettings.tb()&&
da.da.Ga(244,this)}function w(da){var qa=M.call(this)||this;qa.$=da;qa.Eb();return qa}function B(da,qa,na){var ia=this;this.kuf=function(ta,za){ia.bLf(za.Ed.command)};this.$=da;this.Kea=document.createElement("div");this.Kea.setAttribute(T.a.pP,T.a.Wj);this.Kea.className=G.a.o8c;qa.insertBefore(this.Kea,na);this.Vfa=document.createElement("div");this.Vfa.setAttribute(T.a.pP,T.a.Wj);this.Vfa.className=G.a.o8c;qa.insertBefore(this.Vfa,this.Kea);this.Prg=J.a.instance.Xa(2);this.Zga=document.createElement("div");
this.Zga.setAttribute(T.a.Hd,T.a.Qra);this.Zga.setAttribute(T.a.Sra,T.a.Snb);this.Zga.className=G.a.o8c;qa.insertBefore(this.Zga,this.Vfa);this.register();this.$.da.Ga(211,this)}function A(da,qa){qa&&(da.append(qa),da.append(z.Ptd))}function z(da){this.Vtc=da||""}var x=b(10),D=b(1);u=b(0);var I=b(232),F=b(14),G=b(30),T=b(5),O=b(12),U=b(22),J=b(15),H=b(265),K=b(21),N=b(29);z.M2a=function(da){da=N.a.zg(da||"");return new z(da)};z.n$b=function(da){return z.M2a(J.a.instance.ga(da))};z.$ad=function(da){return new z(J.a.instance.Xa(da))};
z.BDh=function(da,qa){for(var na=[],ia=1;ia<arguments.length;++ia)na[ia-1]=arguments[ia];return z.ADh.apply(z,[J.a.instance.mb(da)].concat(ck(na)))};z.ADh=function(da,qa){for(var na=[],ia=1;ia<arguments.length;++ia)na[ia-1]=arguments[ia];ia=na.length;for(var ta=Array(ia),za=0;za<ia;za++)ta[za]=(na[za]||z.OJe).Vtc;return new z(String.format(da,ta))};Mf.Object.defineProperties(z,{OJe:{configurable:!0,enumerable:!0,get:function(){return z.I4d||(z.I4d=new z(""))}},Ptd:{configurable:!0,enumerable:!0,get:function(){return z.G$d||
(z.G$d=z.$ad(2).Vtc)}}});z.I4d=null;z.G$d=null;Object(u.a)(z,"SafeHtml",null,[662]);B.prototype.dispose=function(){this.$&&this.unregister();O.DOMElementExtensions.ff(this.Zga);O.DOMElementExtensions.ff(this.Kea);O.DOMElementExtensions.ff(this.Vfa);this.Vfa=this.Kea=this.Zga=this.$=null};B.prototype.setEnabled=function(da){this.eYf(this.Vfa,da)};B.prototype.cpj=function(){this.eYf(this.Kea,!0)};B.prototype.readText=function(da){this.ZGb(z.M2a(da),!0)};B.prototype.vPa=function(da){this.ZGb(z.M2a(da),
!1)};B.prototype.eLf=function(da,qa){if(1>qa||!da)F.ULS.shipAssertTag(537153954,0,!1,"Skiping listbox description readout");else{var na=new Sys.StringBuilder;da=String.format(J.a.instance.mb(34),qa,da);A(na,da);A(na,J.a.instance.ga(855));this.ZGb(z.M2a(na.toString()),!1)}};B.prototype.Z4i=function(da,qa,na){if(1>na||1>qa||qa>na||!da)F.ULS.shipAssertTag(537153952,0,!1,"Skipping listbox item readout");else{var ia=new Sys.StringBuilder;A(ia,da);ia.append(String.format(J.a.instance.mb(55),qa,na));this.ZGb(z.M2a(ia.toString()),
!1)}};B.prototype.bLf=function(da){da=this.yVh(da);this.ZGb(da,!1)};B.prototype.ZGb=function(da,qa){if(da=da?da.Vtc:null)qa=qa?this.Vfa:this.Kea,U.a.equals(qa.innerHTML,da,!1)&&(da+=z.Ptd),qa.innerHTML=da};B.prototype.mab=function(da,qa){this.Zga.getAttribute(T.a.Sra)!==qa&&this.Zga.setAttribute(T.a.Sra,qa);da=da?z.M2a(da).Vtc:"";this.Zga.innerHTML=da};B.prototype.$4i=function(da,qa,na,ia){var ta=!0;ta=void 0===ta?!1:ta;var za=J.a.instance.mb(54);F.ULS.shipAssertTag(537153949,0,!(void 0===da||null===
da));F.ULS.shipAssertTag(537153948,0,!(void 0===qa||null===qa));F.ULS.shipAssertTag(537153947,0,!(void 0===na||null===na));F.ULS.shipAssertTag(537153946,0,!(void 0===ia||null===ia));F.ULS.shipAssertTag(537153945,0,!(void 0===za||null===za));da=String.format(za,da||"",qa||"",na||"",ia||"");ta?this.mab(da,T.a.aZa):this.readText(da)};B.prototype.wPj=function(da){var qa=this.Vfa.style;da?(da=H.a.O0b(da.cell,qa),qa=da.AB,qa.top=qa.left=qa.bottom=qa.right=null,da.w2()):qa.cssText=""};B.prototype.yVh=function(da){switch(da){case -1985798686:return z.n$b(12);
case -911352779:return z.n$b(11);case 237279923:return z.n$b(13);case -1502853784:return z.$ad(81);case -111689794:return z.$ad(78);case -287251124:return this.kfd(1314,function(qa){return qa.bold});case -1925065947:return this.kfd(1315,function(qa){return qa.italic});case 1764140053:return this.kfd(1316,function(qa){return qa.underline})}return null};B.prototype.register=function(){F.ULS.shipAssertTag(537153944,0,!!this.$,"Can't register to ewaControl's events");this.$&&(F.ULS.shipAssertTag(537153943,
0,!!this.$.Ka,"Can't register to CommandHandlerManager's event"),this.$.Ka&&this.$.Ka.xFa(this.kuf))};B.prototype.unregister=function(){this.$&&this.$.Ka.Aza(this.kuf)};B.prototype.eYf=function(da,qa){var na=da===this.Kea;qa?(da.setAttribute(T.a.Sra,T.a.aZa),na&&da.setAttribute(T.a.Hd,T.a.Qra),da.setAttribute(T.a.pP,T.a.Vq),da.removeAttribute(T.a.pP),da.innerHTML+=" "):(da.removeAttribute(T.a.Sra),na&&da.removeAttribute(T.a.Hd),da.setAttribute(T.a.pP,T.a.Wj))};B.prototype.kfd=function(da,qa){var na=
this.activeCell;if(!na)return null;qa=qa(na)?7:8;return z.BDh(qa,z.n$b(da))};Mf.Object.defineProperties(B.prototype,{uxa:{configurable:!0,enumerable:!0,get:function(){return this.Prg}},isActive:{configurable:!0,enumerable:!0,get:function(){return!0}},activeCell:{configurable:!0,enumerable:!0,get:function(){return K.g(this.$).Ub(null)}}});Object(u.a)(B,"AriaLiveNotifier",null,[644,618,3]);var M=I.a;Rk(w,M);w.prototype.create=function(){this.pb(this.$.da.za(211)||new B(this.$,this.$.Ov,this.$.tf))};
w.ka=function(da){da.da.Ga(212,new w(da))};Object(u.a)(w,"AriaLiveNotifierFactory",I.a,[]);var C=b(27),Q=b(224),P=b(143),ka=b(66);m.prototype.readText=function(da){da=String.format(J.a.instance.mb(30),da);this.IN.setAttribute(T.a.Bt,da);this.oW.setAttribute(T.a.Bt,da);this.rGj()};m.prototype.dispose=function(){this.X_&&this.X_.parentNode&&this.X_.parentNode.removeChild(this.X_);this.oW=this.IN=this.X_=this.Oia=null};m.prototype.O8g=function(da){var qa=da.yb+"readoutElementWrapper",na=da.yb+"readoutElement1",
ia=da.yb+"readoutElement2";this.X_=document.getElementById(qa);this.X_||(this.X_=document.createElement(Q.a.div),this.X_.id=qa,this.IN=document.createElement(Q.a.label),this.IN.id=na,this.IN.setAttribute(P.a.contentEditable,ka.a.KOb),this.IN.setAttribute(T.a.Hd,T.a.bZa),this.oW=document.createElement(Q.a.label),this.oW.id=ia,this.oW.setAttribute(P.a.contentEditable,ka.a.KOb),this.oW.setAttribute(T.a.Hd,T.a.bZa),this.IN.style.width="0px",this.IN.style.height="0px",this.oW.style.width="0px",this.oW.style.height=
"0px",this.IN.tabIndex=-1,this.oW.tabIndex=-1,this.X_.appendChild(this.IN),this.X_.appendChild(this.oW),da=da.yb+T.a.A1c,qa=document.getElementById(da),F.ULS.shipAssertTag(537153942,3,!!qa,"FocusBasedReadout.CreateReadoutElementsIfNeeded: expected to find contentAreaDiv with id: {0}",da),qa&&qa.appendChild(this.X_))};m.prototype.ZZi=function(){this.Oia&&this.IN&&this.oW&&(this.Oia.setAttribute(T.a.z2,this.IN.id),this.Oia.setAttribute(T.a.kWc,String.format("{0} {1}",this.IN.id,this.oW.id)))};m.prototype.rGj=
function(){if(this.isActive){var da="";O.DOMElementExtensions.hasAttribute(this.Oia,T.a.z2)&&(da=this.Oia.getAttribute(T.a.z2).toString());this.Oia.setAttribute(T.a.z2,da===this.IN.id?this.oW.id:this.IN.id)}else F.ULS.shipAssertTag(537153941,0,!1,"FocusBasedReadout.SwitchVirtualFocus: called when is not active.")};m.T5a=function(){if(null==m.Utb)if(D.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ActiveDescendantGridReadout",!1)&&!C.a.nMa)m.Utb=!0,F.ULS.sendTraceTag(537153940,0,50,"FocusBasedReadout.IsFocusBasedCellReadoutActive: ActiveDescendantGridReadout Flight is enabled");
else if(m.Utb=!1,C.a.xH||C.a.Nf)m.Utb=!0,F.ULS.sendTraceTag(537153939,0,50,"FocusBasedReadout.IsFocusBasedCellReadoutActive: The FocusBasedCellReadout BRS is on");return m.Utb};m.ka=function(da){m.T5a()&&da.da.Ga(244,new m(da,K.g(da).$b.textBox.Me))};Mf.Object.defineProperties(m.prototype,{isActive:{configurable:!0,enumerable:!0,get:function(){return!!this.Oia&&document.activeElement===this.Oia}}});m.Utb=null;Object(u.a)(m,"FocusBasedReadout",null,[618,3]);var R=I.a;Rk(y,R);y.prototype.create=function(){var da=
this;m.T5a()?K.g(this.$).$b.textBox.WT(function(){var qa=da.$.da.za(244)||new m(da.$,K.g(da.$).$b.textBox.Me);da.pb(qa)}):this.pb(null)};y.ka=function(da){da.da.Ga(315,new y(da))};Object(u.a)(y,"FocusBasedReadoutFactory",I.a,[]);var fa=b(51),ca=b(37),ea=b(7),wa=b(89),X=b(85),ja=b(24),va=b(45),ua=b(248),Xa=b(47),aa=b(44),ba=b(122);v.$ed=function(da){return v.h0e(da.toString())};v.h0e=function(da){return v.xWg.test(da)?da.replace(v.P3i,"$1 ").replace(v.O3i,' "$1"').trim():da};v.odj=function(da){var qa=
da.lastIndexOf("!");return da.substring(0,-1<qa?qa+1:0)+v.h0e(da.substring(-1<qa?qa+1:0,da.length))};Mf.Object.defineProperties(v,{P3i:{configurable:!0,enumerable:!0,get:function(){return v.lde||(v.lde=RegExp("([A-Z]+)","g"))}},O3i:{configurable:!0,enumerable:!0,get:function(){return v.kde||(v.kde=RegExp("([A-Z])","g"))}},xWg:{configurable:!0,enumerable:!0,get:function(){return v.f2d||(v.f2d=RegExp("^\\$?[A-Z]+\\$?[0-9]+$|^\\$?[A-Z]+\\$?[0-9]+:\\$?[A-Z]+\\$?[0-9]+$|^\\$?[A-Z]+:\\$?[A-Z]+$|^\\$?[0-9]+:\\$?[0-9]+$"))}}});
v.lde=null;v.kde=null;v.f2d=null;Object(u.a)(v,"RangeAriaExtensions",null,[]);Object(u.a)(f,"SelectionReadoutState",null,[]);var oa=b(64),ra=b(76);n.prototype.dispose=function(){this.$&&this.Tj();wa.a.Ia(this.P_b);this.sparklineManager=this.$=this.P_b=null};n.prototype.hWe=function(da,qa,na){na=void 0===na?!0:na;if(!da)return"";var ia=this.$.da,ta=new Sys.StringBuilder;this.LJg(ta,da,qa);if(D.EwaSettings.isChangeGateEnabled("OfficeVSO:4124702_ColumnHeaderReadout")){var za=this.tableManager.hva(da.range);
(null===za||void 0===za?0:za.NQd)&&this.vpe(ta,za);za=this.tableManager.Vm(da.range);(null===za||void 0===za?0:za.Zaa)&&this.vpe(ta,za)}za=da.Yaa?this.QYe(da):da.text;A(ta,za);za=this.$.activeItemName;this.cD.activeItemName!==za&&(A(ta,za),this.cD.activeItemName=za);za=1===qa.length?va.K(qa).isSingle?"":J.a.instance.ga(851):String.format(J.a.instance.mb(31),qa.length);A(ta,za);za=bk(qa);for(var sa=za.next();!sa.done;sa=za.next())sa=sa.value,A(ta,v.$ed(sa)),1===qa.length&&n.qni(sa)&&(sa=K.g(this.$).Ea.Jr(sa.bottomRight),
void 0!==sa&&null!==sa&&sa.text&&(sa=sa.Yaa?this.PYe(sa,sa.text):sa.text,A(ta,sa)));za=da.cell;za=this.TSh(za.Uhj,za.CZg);A(ta,za);this.uJg(ta,da);na&&(da.s6a?A(ta,J.a.instance.ga(839)):da.Kwa&&A(ta,J.a.instance.ga(840)));if(da.hasAutoFilter||da.q4)this.MJg(ta,da.hasAutoFilter?da.cell.autoFilterType:da.cell.BXi),na&&A(ta,J.a.instance.ga(842));ua.c(this.$,da.range)&&A(ta,J.a.instance.ga(846));this.rJg(ta,da);na=(na=ia.za(14))?na.MHh():"";A(ta,na);da.ME&&(na=K.g(this.$).Ea.Jr(da.range),na=!!na&&na.N5e,
n.dvj(da)?n.sJg(ta,da):D.EwaSettings.isChangeGateEnabled("OfficeVSO:3286994_NarratorForFormulaErrors")&&na?A(ta,J.a.instance.ga(844)):A(ta,J.a.instance.ga(843)));da.Xaa&&(A(ta,J.a.instance.ga(845)),da.Bwb&&A(ta,String.format(J.a.instance.mb(16),da.$ah)),A(ta,da.iconName));da.hasRichValueIcon&&(za=this.$.da.za(271),na="",za&&da.cell.xjf&&(za=za.$P(da.cell.xjf))&&za.DomainId.Id!==n.IWj&&(na=za.Name),da.cell.Xdi?(A(ta,String.format(J.a.instance.mb(182),na)),A(ta,J.a.instance.ga(1787))):(A(ta,String.format(J.a.instance.mb(180),
na)),A(ta,J.a.instance.ga(1786))));this.o4h(da)&&A(ta,n.COh(da));(ia=ia.za(231))&&A(ta,ia.dZe(qa,!0));1===qa.length&&qa[0].isSingle&&n.cvj(da,qa[0],this.$)&&(qa=this.$.da.za(271))&&A(ta,qa.ZHh());da.nNb&&da.oNb&&A(ta,da.oNb);(qa=da.cell.jVg)&&A(ta,qa);da.Jwa&&da.TFb&&(da=da.ACd)&&(A(ta,J.a.instance.ga(1955)),A(ta,da));return ta.toString()};n.prototype.tue=function(da){this.ksa=this.cD;this.cD=Object(ea.a)(new f,{activeItemName:this.ksa.activeItemName,Oyc:da?this.ksa.Oyc:!1,tableName:da?this.ksa.tableName:
"",L_a:da?this.ksa.L_a:-1})};n.prototype.GSf=function(){this.ksa&&(this.cD=this.ksa,this.ksa=null)};n.prototype.TSh=function(da,qa){return 2===da||2===qa?J.a.instance.ga(872):1===da||1===qa?J.a.instance.ga(873):""};n.prototype.QYe=function(da){return this.PYe(da.cell,da.text)};n.prototype.LJg=function(da,qa,na){if(na&&1===na.length&&na[0].isSingle){na="";var ia=this.tableManager.hva(qa.range);if(ia){na=ia.pivotTableName;this.JVc(da,na);var ta=ia.Vfc?J.a.instance.ga(834):"";D.EwaSettings.isChangeGateEnabled("OfficeVSO:6154754_NarratorReadoutForPivotTableAltText")&&
(ta+=(ia.altText?ia.altText+" . ":"")+(ia.altTextSummary?ia.altTextSummary:""));this.xpe(da,!0,na,ta);A(da,this.tableManager.pli(ia,qa.range)?J.a.instance.ga(836):"");A(da,this.tableManager.nfi(ia,qa.range)?J.a.instance.ga(835):"")}else if(ia=this.tableManager.Vm(qa.range)){na=(ta=K.g(this.$).Ab.dk(qa.range))?ta.name:"";this.JVc(da,na);var za="";ta&&D.EwaSettings.isChangeGateEnabled("OfficeVSO:6680193_FlighRemovalTableAltText")&&(za=(ta.wSa?ta.wSa+" . ":"")+(ta.xSa?ta.xSa:""));this.xpe(da,!1,na,za);
A(da,this.tableManager.Dcf(ia,qa.range)?J.a.instance.ga(835):"")}else this.JVc(da,na),this.cD.tableName="",this.cD.L_a=-1}};n.prototype.JVc=function(da,qa){qa!==this.cD.tableName&&this.cD.tableName&&(da.append(J.a.instance.ga(this.cD.Oyc?833:832)),A(da," "+this.cD.tableName))};n.prototype.xpe=function(da,qa,na,ia){na!==this.cD.tableName&&(da.append(J.a.instance.ga(qa?831:830)),A(da," "+na),A(da,ia),this.cD.tableName=na,this.cD.Oyc=qa,this.cD.L_a=-1)};n.prototype.vpe=function(da,qa){var na=K.g(this.$).ha.sa.activeCell;
if(na.top!==qa.top&&na.left!==this.cD.L_a){da.append(J.a.instance.ga(835));qa=new ja.Range(qa.top,na.left,qa.top,na.left,!0,!0);A(da,v.$ed(qa));if(qa=K.g(this.$).Ub(qa))qa=qa.Yaa?this.QYe(qa):qa.text,A(da,qa);this.cD.L_a=na.left}};n.prototype.PYe=function(da,qa){var na=da.V4a;return da.Ewb?String.format(J.a.instance.mb(14),qa,na):String.format(J.a.instance.mb(13),qa,v.odj(na))};n.prototype.Pi=function(){F.ULS.shipAssertTag(537153930,0,!!this.$,"Can't register to ewaControl's events");if(this.$){var da=
K.g(this.$);F.ULS.shipAssertTag(537153929,0,!!da,"Can't register to grid's events");da&&(da.Wb.Ak(this.cp),da.Ea.hx(this.Qca),da.QD(this.Qca),this.hab&&da.Wb.tm(this.Af.bind(this)),da=da.ha,F.ULS.shipAssertTag(537153928,0,!!da,"Can't register to selectionManager's events"),da&&(da.vG(this.Rc),da.hJ(this.Qca),da.Oa.q2(this.Qca),this.hab&&(this.UFd=this.UFd.bind(this))))}};n.prototype.Tj=function(){if(this.$){var da=K.g(this.$);da&&(da.Wb.vk(this.cp),da.Ea.dv(this.Qca),da.yF(this.Qca),this.hab&&da.Wb.Nl(this.Af),
da=da.ha)&&(da.zF(this.Qca),da.PN(this.Qca),da.Oa.Hma(this.Qca))}};n.prototype.readText=function(da,qa){this.T5a&&this.gridReadoutNotifier&&this.gridReadoutNotifier.isActive?this.gridReadoutNotifier.readText(da):(D.EwaSettings.isChangeGateEnabled("OfficeVSO:5033038_Embed_Mode_Grid_Narrator_Fix")&&this.ariaLiveNotifier.setEnabled(!0),this.ariaLiveNotifier.readText(da),this.hab&&!qa||this.ariaLiveNotifier.wPj(qa))};n.prototype.Af=function(){this.bob&&this.bob.cancel()};n.prototype.UFd=function(){this.readText(this.jWh())};
n.prototype.jWh=function(){var da=this,qa="";K.g(this.$).ha.rangePicker.xK.forEach(function(na){qa+=da.aXh(na)});return qa+=" selected"};n.prototype.aXh=function(da){return" "+(da.sheetId!==oa.d(this.$.pa)?this.$.va.Afd(da.sheetId).name:"")+" "+da.range.topLeft+" "+(da.range.isSingle?"":da.range.bottomRight)};n.prototype.IGh=function(){var da=null;var qa=K.g(this.$).ha;if(1!==qa.Pe&&!qa.Oa.Yb)return F.ULS.sendTraceTag(537153927,0,15,"selectionManager.CommandSelectionMode={0} and selectionManager.SelectedFloatingObjectControl is null",
qa.Pe),{returnValue:"",activeCell:da};switch(qa.Pe){case 2:return{returnValue:this.JJh(qa),activeCell:da};case 64:var na=qa.Oa.Yb.floatingObject,ia="";if(qa=qa.Oa.Yb.ls||qa.Oa.Yb.Dd)ia=(ia=qa.firstChild)?O.DOMElementExtensions.getTextContent(ia):"";return{returnValue:String.format(J.a.instance.mb(53),n.C$b(na.altText,na.altTextDescription,na.name),ia,na.altTextDescription),activeCell:da};case 4:return{returnValue:n.EIg(qa.Oa.Yb.floatingObject),activeCell:da};case 512:return{returnValue:ba.a.EXe(qa.Oa.Yb.floatingObject.x6c),
activeCell:da};case 8:return na=(na=qa.Oa.Yb.floatingObject)?na.name:"",{returnValue:String.format(J.a.instance.mb(51),na),activeCell:da};case 1:return da=this.activeCell,{returnValue:this.hWe(da,qa.sa.selectedRanges),activeCell:da}}return{returnValue:"",activeCell:da}};n.prototype.JJh=function(da){var qa=new Sys.StringBuilder;qa.append(n.PVg(da));var na=this.$.da.za(231);na&&A(qa,na.dZe(da.Oa.Yb.floatingObject,!1));return qa.toString()};n.prototype.o4h=function(da){da=da.Iaf();var qa=!1;this.cD.Cff!==
da&&(this.cD.Cff=da,qa=!0);return qa};n.prototype.uJg=function(da,qa){if(qa.Owb)if(qa=this.sparklineManager.iXh(qa)){var na=J.a.instance,ia=na.ga;a:switch(qa.type){case 0:var ta=827;break a;case 1:ta=828;break a;default:ta=829}na=ia.call(na,ta);A(da,String.format(J.a.instance.mb(25),na));qa=String.format(J.a.instance.mb(24),v.$ed(qa.PCj));A(da,qa)}else F.ULS.sendTraceTag(537153925,0,15,"No sparkline range was found on a cell with sparkline."),A(da,String.format(J.a.instance.mb(25),""))};n.prototype.MJg=
function(da,qa){switch(qa){case 1:case 11:A(da,J.a.instance.ga(847));break;case 6:A(da,J.a.instance.ga(847));A(da,J.a.instance.ga(849));break;case 7:A(da,J.a.instance.ga(847));A(da,J.a.instance.ga(850));break;case 2:A(da,J.a.instance.ga(848));A(da,J.a.instance.ga(849));break;case 3:A(da,J.a.instance.ga(848));A(da,J.a.instance.ga(850));break;default:A(da,J.a.instance.ga(848))}};n.prototype.rJg=function(da,qa){var na,ia=this.$.da.za(65);qa=ia?ia.FJa(qa.range):null;var ta="",za=Object(X.a)(642,qa);if(qa)ta=
!qa.b6a&&za&&za.Rmi?String.format(J.a.instance.mb(29),za.hHj):String.format(J.a.instance.mb(23),qa.author);else if(null===(na=null===ia||void 0===ia?void 0:ia.Cm)||void 0===na?0:na.OE)ta=String.format(J.a.instance.mb(28),ia.Cm.fN.author);A(da,ta)};n.EIg=function(da){return String.format(J.a.instance.mb(52),n.C$b(da.altText,da.altTextDescription,da.name),da.altTextDescription)};n.COh=function(da){return J.a.instance.ga(da.Iaf()?837:838)};n.C$b=function(da,qa,na){return da||qa?da:na};n.PVg=function(da){var qa=
da.Oa.Yb;da=qa.floatingObject;var na=da.Oc,ia=na.ChartTitle,ta=da.altText,za=da.altTextDescription,sa=!!(na.Attributes&4);return(qa=qa.getSelectionDescription())?qa:na.DataRangeForDisplay?String.format(J.a.instance.mb(sa?49:47),n.C$b(ta,za,da.name),za,ia,J.a.instance.ga(r(na.ChartCategory)),na.DataRangeForDisplay):String.format(J.a.instance.mb(sa?50:48),n.C$b(ta,za,da.name),za,ia,J.a.instance.ga(r(na.ChartCategory)))};n.dvj=function(da){return D.EwaSettings.ma(103)&&(da.K5a||da.Tfc)};n.sJg=function(da,
qa){if(!qa.dSa)F.ULS.shipAssertTag(537153924,0,!1,"SelectionReadoutHandler.AppendAriaDynamicArrayFormulaDescription: This method should only be called with a valid dynamic array range.");else if(qa.K5a)qa=qa.dSa.topLeft.toString(),A(da,String.format(J.a.instance.mb(26),qa));else if(qa.Tfc){var na=qa.dSa.jS();qa=(na.LastColumn-na.FirstColumn+1).toString();na=(na.LastRow-na.FirstRow+1).toString();A(da,String.format(J.a.instance.mb(27),qa,na))}};n.cvj=function(da,qa,na){return da.ME||!D.EwaSettings.ma(139)?
!1:(da=na.da.za(271))?da.qfc(qa):!1};n.qni=function(da){return da.top===da.bottom&&da.left+1===da.right||da.top+1===da.bottom&&da.left===da.right};Mf.Object.defineProperties(n.prototype,{activeCell:{configurable:!0,enumerable:!0,get:function(){return K.g(this.$).Ub(null)}}});n.IWj=268435712;n.QSc=500;Object(u.a)(n,"SelectionReadoutHandler",null,[643,3]);var db=b(58),Ka=b(911),Ga=I.a;Rk(l,Ga);l.prototype.create=function(){var da=this,qa=this.$.da,na=fa.GetServiceTaskFactory.Ra(qa,211,212,this.hb),
ia=fa.GetServiceTaskFactory.Ra(qa,66,134,this.hb),ta=fa.GetServiceTaskFactory.Ra(qa,240,239,this.hb),za=db.Task.Ua(null);D.EwaSettings.tb()&&(za=fa.GetServiceTaskFactory.Ra(qa,244,315,this.hb));ca.TaskExtensions.Aa(ca.TaskExtensions.Vd([na,ia,ta,za],this.la),function(){var sa=Object(Ka.a)(da.$.da,226,function(){return new n(na.result,da.$,ia.result,ta.result,za.result)});da.pb(sa)},this.$.la,3)};l.ka=function(da){da.da.Ga(227,new l(da))};Object(u.a)(l,"SelectionReadoutHandlerFactory",I.a,[]);k.prototype.kLf=
function(){var da=this.OHh();this.ariaLiveNotifier.mab(da,T.a.Snb)};k.prototype.OHh=function(){var da=new Sys.StringBuilder;this.$.workbookContext&&A(da,this.$.workbookContext.WorkbookFileName);A(da,J.a.instance.ga(853));A(da,this.QHh());A(da,this.PHh());A(da,J.a.instance.ga(854));return da.toString()};k.prototype.QHh=function(){return this.$.isEditMode?J.a.instance.ga(858):J.a.instance.ga(859)};k.prototype.PHh=function(){var da=this.QVj(),qa=this.$.va.pa;da=1!==da?String.format(J.a.instance.mb(32),
da):J.a.instance.ga(852);da=new Sys.StringBuilder(da);qa&&qa.sheetName&&(da.append(z.Ptd),da.append(String.format(J.a.instance.mb(33),qa.sheetName)));return da.toString()};k.prototype.QVj=function(){for(var da=0,qa=bk(this.$.va.items),na=qa.next();!na.done;na=qa.next())na.value.visible&&da++;return da};Object(u.a)(k,"WorkbookReadout",null,[]);e.prototype.dispose=function(){this.X9b&&this.X9b.Taj(this.Nxf);this.X9b=this.ariaLiveNotifier=this.$=null};Object(u.a)(e,"EmbeddedWorkbookReadoutHandler",null,
[3]);d.prototype.dispose=function(){this.Tj();this.ariaLiveNotifier=this.QY=null;this.Bd=!0};d.prototype.Pi=function(){if(this.QY){this.QY.yu(this.OV);this.QY.Ea.hx(this.OV);this.QY.QD(this.OV);var da=Object(X.a)(443,this.QY);da&&(da.Wb.Ak(this.OV),da.ha.vG(this.OV),da.ha.hJ(this.OV),da.ha.Oa.q2(this.OV))}else F.ULS.sendTraceTag(537153923,0,15,"WorkbookReadoutHandler.RegisterEvents: Can't register to view events")};d.prototype.Tj=function(){if(this.QY){this.QY.Ea.dv(this.OV);this.QY.yF(this.OV);var da=
Object(X.a)(443,this.QY);da&&(da.Wb.vk(this.OV),da.ha.zF(this.OV),da.ha.PN(this.OV),da.ha.Oa.Hma(this.OV))}};d.prototype.Woe=function(){this.RZd.kLf();this.ariaLiveNotifier.setEnabled(!0);this.ariaLiveNotifier.cpj();this.dispose()};Object(u.a)(d,"WorkbookReadoutHandler",null,[3]);var xa=I.a;Rk(c,xa);c.prototype.create=function(){var da=this,qa=fa.GetServiceTaskFactory.Ra(this.$.da,211,212,this.hb);if(this.$.TM){var na=fa.GetServiceTaskFactory.Ra(this.$.da,12,477,this.hb);ca.TaskExtensions.Aa(ca.TaskExtensions.Vd([qa,
na],this.$.la),function(){var ia=Object(Ka.b)(da.$.da,228,function(){return new e(qa.result,da.$,na.result)});da.pb(ia)},this.$.la,3)}else ca.TaskExtensions.Aa(qa,function(ia){var ta=Object(Ka.b)(da.$.da,228,function(){return new d(ia.result,da.$)});da.pb(ta)},this.$.la,3)};c.ka=function(da){da.da.Ga(229,new c(da))};Object(u.a)(c,"WorkbookReadoutHandlerFactory",I.a,[]);b.d(E,"a",function(){return a})},1358:function(u,E,b){function a(){D.a.Fa(function(La){c.ka(La)})}function c(La){return ib.call(this,
La)||this}function d(La,zb,Fb,Yb){var kb=this;this.menuId=null;this.MQa=-1;this.vCf=function(){kb.Yca()};this.PSi=function(vb){if(!(kb.sa.tLa()||(!ja.EwaSettings.isChangeGateEnabled("OfficeVSO:4124510_JsCrashOnToggleTableStyleOptionSuccessful")||X.a(vb)||kb.LLa())&&X.a(vb)&&kb.LLa())){vb=kb.sa.activeCell;var Wa=kb.sa.activeRange,qb=kb.tableManager.pg.usedRange;2===kb.MQa&&R.g(kb.tableManager.pg)&&vb.bottom===qb.bottom&&(Wa=Wa.m5?new H.Range(Wa.top-1,Wa.left,Wa.bottom-1,Wa.right,!1,!0):new H.Range(Wa.top,
Wa.left,Wa.bottom-1,Wa.right,!1,!0),vb=Wa.contains(vb)?vb:H.Range.Tc(Wa.bottom,vb.left),aa.g(kb.$).ha.updateSelection(Wa,vb,0,3))}};this.gSi=function(vb){X.a(vb)?(T.ULS.sendTraceTag(594130062,0,50,"TableManager.OnTableRenameSuccessful-Rename table rename failed due invalid user input"),kb.$.hf()):T.ULS.sendTraceTag(594130061,0,50,"TableManager.OnTableRenameSuccessful-Rename table rename successful")};this.fSi=function(){T.ULS.sendTraceTag(594130060,0,15,"TableManager.OnTableRenameFailure-Rename table failed");
kb.$.hf()};this.hSi=function(vb,Wa){Wa&&kb.hL(Wa);X.b(vb,-569193796)&&(Ia.a(kb.$).fd.eJ(-569193796),kb.Tqi(vb.Errors[0]))};this.$=La;this.tableManager=zb;this.namedSheetViewPublic=Fb;this.frame=this.$.frame;this.ha=aa.g(this.$).ha;this.sa=this.ha.sa;this.Ox=ja.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");this.tableStyleManager=Yb;this.tableStyleManager.eGg(this.vCf)}function e(La){La=ta.call(this,La)||this;var zb=aa.g(La.$);zb=zb.Ab.dk(zb.ha.sa.activeCell);ua.a.fh(zb.wSa)?La.xBd=
"":La.xBd=zb.wSa;ua.a.fh(zb.xSa)?La.vBd="":La.vBd=zb.xSa;zb=La.BM(La.xBd,La.vBd);La.initializeAndShow(xa.a.instance.ga(745),La.MGj,zb);return La}function k(La){var zb=ia.call(this,La)||this;zb.WGj=function(Fb,Yb){1===Fb&&zb.HLj(C.D(zb.UEf(Yb[k.uKf])))};zb.mvb=function(Fb){Fb=zb.Wdd(Fb);return zb.rbd(Fb)};zb.gridView=aa.g(La);zb.sa=zb.gridView.ha.sa;zb.Boc=zb.gridView.Ab.dk(zb.sa.activeCell).usedRange;La=zb.BM(zb.Boc.toString());zb.initializeAndShow(xa.a.instance.ga(736),zb.WGj,La);return zb}function l(La,
zb){La=qa.call(this,La)||this;La.SAa=zb;return La}function n(La,zb){La=da.call(this,La,xa.a.instance.ga(735))||this;La.SAa=zb;return La}function f(La,zb,Fb){this.Rod=!1;this.sharedSheetRange=zb;this.$=La;this.Mh=this.$.Fb.Kg("UserAction","ConvertToRangeManager");this.tableName=Fb}function v(La){this.tableName=null;this.tableName=La}function r(La,zb,Fb){this.isPivotTable=!1;this.tableRange=null;this.optionType=0;this.tableRange=La;this.optionType=zb;this.isPivotTable=Fb}function y(La){this.originalRange=
null;this.originalRange=La}function m(La,zb){this.newName=this.oldName=null;this.oldName=La;this.newName=zb}function w(La,zb,Fb){this.description=this.title=this.tableRange=null;this.tableRange=La;this.title=zb;this.description=Fb}function B(La,zb,Fb,Yb){La=A.call(this,La,Fb)||this;La.hasHeaders=!1;La.isCreation=!1;La.hasHeaders=zb;La.isCreation=Yb;return La}function A(La,zb){this.tableRange=this.tableRanges=null;this.styleIndex=0;this.tableRanges=La;this.tableRange=C.l(La.Ranges[0],La.SheetName);
this.styleIndex=zb}function z(La){this.autoFilterOptions=null;this.autoFilterOptions=La}function x(La,zb){this.autoFilterOptions=null;this.sortType=0;this.autoFilterOptions=La;this.sortType=zb}var D=b(10);u=b(0);var I=b(905),F=b(51),G=b(37),T=b(14),O=b(4),U=b(30),J=b(5),H=b(24),K=b(76),N=b(54);x.prototype.TU=function(){return this.autoFilterOptions};Object(u.a)(x,"MacroRecorderRangeColumnSortedOrFilteredPayload",null,[438]);z.prototype.TU=function(){return this.autoFilterOptions};Object(u.a)(z,"MacroRecorderRangeItemFilteredPayload",
null,[438]);var M=b(1136),C=b(45),Q=b(388),P=b(177),ka=b(62),R=b(169),fa=b(248),ca=b(47),ea=b(44),wa=b(12),X=b(295),ja=b(1),va=b(186),ua=b(22),Xa=b(294),aa=b(21);Object(u.a)(A,"MacroRecorderTableStyleAppliedPayload",null,[438]);Rk(B,A);Object(u.a)(B,"MacroRecorderRangeFormatedAsTablePayload",A,[]);w.prototype.Vm=function(){return this.tableRange};w.prototype.getTitle=function(){return this.title};w.prototype.getDescription=function(){return this.description};Object(u.a)(w,"MacroRecorderTableAltTextEditedPayload",
null,[438]);Object(u.a)(m,"MacroRecorderTableRenamedPayload",null,[438]);Object(u.a)(y,"MacroRecorderTableResizedPayload",null,[438]);Object(u.a)(r,"MacroRecorderTableStyleOptionToggledPayload",null,[438]);var ba=b(31),oa=b(42);Object(u.a)(v,"MacroRecorderTableConvertedToRangePayload",null,[438]);var ra=b(955);f.prototype.r$a=function(){var La=this;this.Mh.start();var zb=this.$.oa.xa.Pb();return ra.h(this.$.oa.xa,this.sharedSheetRange,function(Fb){La.showDialog(Fb)},null,null,null,zb)};f.prototype.showDialog=
function(La){var zb=this;T.ULS.sendTraceTag(537151193,0,50,"ConvertToRangeManager.ShowDialog: Time taken to show Get IsRangeQueryTable is {0} milliseconds",this.Mh.qc);La&&!X.a(La)&&((this.Rod=La.Result)?(La=ba.a.Xc(3,2,0,741,0,-66108047,"ConvertToRange"),G.TaskExtensions.Aa(oa.a(this.$).hj(La),function(Fb){T.ULS.sendTraceTag(537151192,0,50,"ConvertToRangeManager.ShowDialog: Time taken for User Input is {0} milliseconds",zb.Mh.qc);0===Fb.result&&zb.O2g()},this.$.la,11)):this.P2g());this.Mh.stop();
T.ULS.sendTraceTag(537151191,0,50,"ConvertToRangeManager.ShowDialog: Total Time taken for complete operation is {0} milliseconds",this.Mh.qc)};f.prototype.wte=function(){var La={};La.IsQueryTable=this.Rod;La.Range=this.sharedSheetRange;return La};f.prototype.O2g=function(){var La=this,zb=this.$.oa.xa;T.ULS.sendTraceTag(537151190,0,50,"Convert To Range initiated for Query Table");this.U$e(194,function(Fb,Yb,kb){return ra.d(zb,La.wte(),Fb,Yb,kb,null)});T.ULS.sendTraceTag(537151189,0,50,"Convert To Range completed for Query Table")};
f.prototype.P2g=function(){var La=this,zb=this.$.oa.xa;T.ULS.sendTraceTag(537151188,0,50,"Convert To Range initiated for Normal Table");this.U$e(193,function(Fb,Yb,kb){return ra.c(zb,La.wte(),Fb,Yb,kb,null)},function(){return new v(La.tableName)});T.ULS.sendTraceTag(537151187,0,50,"Convert To Range completed for Normal Table")};f.prototype.U$e=function(La,zb,Fb){Fb=void 0===Fb?null:Fb;Q.a(this.$.userOperationManager,zb,function(Yb){return new P.a(La,0,Yb,void 0,Fb)},null)};Object(u.a)(f,"ConvertToRangeManager",
null,[]);var db=b(1329),Ka=b(1328),Ga=b(1462),xa=b(15),da=Ga.a;Rk(n,da);n.prototype.Zi=function(){var La=this,zb=C.s(this.kC.TableRange);return function(){return new B(zb,La.C4a.checked,La.SAa,!0)}};n.prototype.Jy=function(){var La=this,zb=C.s(this.kC.TableRange);return function(Fb,Yb,kb){return ra.g(La.$.oa.xa,zb,La.C4a.checked,!1,La.kC.HasTotalRow,La.SAa,Fb,Yb,kb,null)}};n.prototype.Xx=function(La,zb,Fb){da.prototype.Xx.call(this,La,zb,Fb)};Mf.Object.defineProperties(n.prototype,{nc:{configurable:!0,
enumerable:!0,get:function(){return"FormatAsTableDialog"}},sv:{configurable:!0,enumerable:!0,get:function(){return 215}}});Object(u.a)(n,"FormatAsTableDialogDeprecated",Ga.a,[]);Ga=b(1157);var qa=Ga.a;Rk(l,qa);l.prototype.Zi=function(){var La=this,zb=C.s(this.kC.TableRange);return function(){return new B(zb,La.hasHeaders,La.SAa,!0)}};l.prototype.Jy=function(){var La=this,zb=C.s(this.kC.TableRange),Fb=this.kC.HasTotalRow;return function(Yb,kb,vb){return ra.g(La.$.oa.xa,zb,La.hasHeaders,!1,Fb,La.SAa,
Yb,kb,vb,null)}};Mf.Object.defineProperties(l.prototype,{nc:{configurable:!0,enumerable:!0,get:function(){return"FormatAsTableDialog"}},sv:{configurable:!0,enumerable:!0,get:function(){return 215}},zl:{configurable:!0,enumerable:!0,get:function(){return xa.a.instance.ga(735)}}});Object(u.a)(l,"FormatAsTableReactDialog",Ga.a,[]);Ga=b(389);var na=b(98),ia=Ga.a;Rk(k,ia);k.prototype.UEf=function(La){La=La.startsWith("=")?La.substring(1,La.length):La;var zb=C.Z(La,this.$.va);La=zb.sheetName;var Fb=zb.range;
return zb.returnValue&&Fb?(Fb=C.v(Fb,this.$),Fb.SheetName=ua.a.equals(La,"",!0)?this.$.pa.name:La,Fb):null};k.prototype.BM=function(La){var zb={};return zb[k.z4]="ResizeTableDialog",zb[k.uKf]=La,zb.getInputErrorIfInvalid=this.mvb,zb};k.prototype.Wdd=function(La){La=this.UEf(La);if(!La)return 1;var zb=C.D(La);return ua.a.equals(La.SheetName,this.$.pa.sheetName,!0)&&this.Boc.top===zb.top&&this.Boc.xd(zb)?0:2};k.prototype.rbd=function(La){var zb="";switch(La){case 1:zb=xa.a.instance.ga(75);break;case 2:zb=
na.a.qh(xa.a.instance.ga(74))}return zb};k.prototype.HLj=function(La){var zb={};La=(zb.ResizeTableRange=La,zb.OriginalTableRange=this.Boc,zb);this.$.Fd(-1400250766,K.a.Cb,8,La)};Mf.Object.defineProperties(k.prototype,{nc:{configurable:!0,enumerable:!0,get:function(){return"ResizeTableDialog"}}});k.z4="id";k.uKf="range";Object(u.a)(k,"ResizeTableDialog",Ga.a,[]);var ta=Ga.a;Rk(e,ta);e.prototype.MGj=function(La,zb){if(1===La&&(La=zb[e.oJj],zb=zb[e.gdh],La!==this.xBd||zb!==this.vBd)){var Fb={};La=(Fb.Title=
La,Fb.Description=zb,Fb);this.$.Fd(868579142,K.a.Cb,8,La)}};e.prototype.BM=function(La,zb){var Fb={};return Fb.id="AltTextDialog",Fb.title=La,Fb.description=zb,Fb};Mf.Object.defineProperties(e.prototype,{nc:{configurable:!0,enumerable:!0,get:function(){return"TableAltTextDialog"}}});e.z4="id";e.oJj="title";e.gdh="description";Object(u.a)(e,"TableAltTextDialog",Ga.a,[]);var za=b(983),sa=b(984),V=b(112),Ia=b(67),Ha=b(58),ob=b(36);d.prototype.Lc=function(La,zb){switch(zb){case -544558380:return!(this.tableManager&&
this.sa.XJ()&&!this.LLa()&&R.d(this.tableManager.pg));case 1544516694:return!(this.tableManager&&(this.sa.XJ()?!this.LLa():this.sa.tLa()));case -697806646:case 323142015:return!this.sa.XJ();case 341449783:case 2128797448:return ja.EwaSettings.isChangeGateEnabled("OfficeVSO:6083078_HeaderAndTotalRowDisabledFix")?!(this.tableManager&&(this.sa.XJ()?!this.LLa():this.sa.tLa())):!(this.tableManager&&this.tableManager.cqd(this.sa.activeCell));case -123538519:return!(this.sa.XJ()&&this.tableStyleManager&&
this.tableStyleManager.Rhc());case 756677940:return!(ja.EwaSettings.ma(409)&&this.sdi());case 753331043:case 2105103744:case -585683120:return!(this.tableStyleManager&&this.tdi());case 844144422:return!this.sa.XJ();case -723113214:return!(ja.EwaSettings.isChangeGateEnabled("OfficeVSO:6680193_FlighRemovalTableAltText")&&this.sa.XJ())}return!1};d.prototype.executeCommand=function(La,zb,Fb){var Yb=this,kb;La=G.TaskExtensions.jk();var vb=this.$.oa.xa,Wa=null,qb=1,yb=zb.command,ec=this.$.oa.xa.Pb(),Ob=
null;switch(yb){case -2058042992:var Cb=N.a.Th(Fb[K.a.Uf]);d.pXf(this.$,Cb);Wa=function(jb,Vb,Ic){return ra.a(vb,Cb,null,null,!1,!1,!1,za.a.mva(V.a.Yra,sa.a.clearAutoFilter,jb),Vb,Ic,null)};qb=176;Ob=function(){return new z(Cb)};break;case 504133448:case -798968736:case 477776686:var ab=N.a.Th(Fb[K.a.Uf]),ya=Fb.TopCellAddress;d.pXf(this.$,ab);var ma=504133448===zb.command?1:-798968736===zb.command?2:3;if(ja.EwaSettings.isChangeGateEnabled("OfficeVSO:6516289_SheetProtectionSettings")&&ya){Fb=this.tableManager.Vm(ya);
if(!Fb&&ja.EwaSettings.isChangeGateEnabled("OfficeVSO:5767424_EnablePauseProtectionInViewMode")){var ha=this.$.va.pa;(null===(kb=C.D(ha.w0))||void 0===kb?0:kb.contains(ya))?Fb=C.D(ha.w0):T.ULS.sendTraceTag(527700033,0,15,"TableCommandHandler.executeCommand: unknown sort range; unable to check for protected ranges")}if(!this.$.isEditMode){if(!ja.EwaSettings.isChangeGateEnabled("OfficeVSO:5767424_EnablePauseProtectionInViewMode")||Fb&&!this.$.dWc([Fb],!0,1))break}else if(Fb&&!this.$.hq([Fb],!0,1))break}Wa=
function(jb,Vb,Ic){return ka.I(vb,ab,ma,Xa.b(jb,Yb.hSi),Vb,Ic,ya,ec)};qb=177;Ob=function(){return new x(ab,ma)};break;case 341449783:case 2128797448:this.MQa=341449783===yb?0:2;kb=this.toggleTableStyleOption(vb,ec);Wa=kb.PBa;qb=kb.operationName;Ob=kb.Zi;break;case -712419744:this.Ox?this.F$e(Fb[J.a.event]):this.F$e(null);break;case 1868184698:if(ja.EwaSettings.isChangeGateEnabled("OfficeVSO:6224451_CreateTableInEmptyCell")&&(Fb=this.h$f(null,ec),kb=Fb.wyb,Wa=Fb.PBa,Ob=Fb.Zi,kb)){qb=206;break}ja.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TablesReactDialog",
!1)?new Ka.a(this.$):(kb=new db.a(this.$),kb.initialize(),kb.gf());break;case 844144422:new k(this.$);break;case 1544516694:case -544558380:if(kb=Fb[K.a.Nc])this.MQa=this.cYh(kb),-1!==this.MQa&&(kb=this.toggleTableStyleOption(vb,ec),Wa=kb.PBa,qb=kb.operationName,Ob=kb.Zi);break;case 756677940:if(this.LLa()&&this.Gef()){T.ULS.sendTraceTag(537151177,0,15,"TableCommandHandler.RenameTable: current table object and previous selected table object both found to be null while executing rename command");break}var Z=
Fb.Text,Na=this.oQh();if(Na){Wa=function(jb,Vb,Ic){return ra.i(vb,Z,Na,Xa.b(jb,Yb.gSi),Xa.a(Vb,Yb.fSi),Ic,ec)};qb=217;var eb=null;this.tableManager.pg?eb=this.tableManager.pg.name:this.tableManager.cEd?eb=this.tableManager.cEd.name:T.ULS.sendTraceTag(537151176,0,15,"TableCommandHandler.RenameTable: current table object and previous selected table object both found to be null while fetching oldName during executing rename command");eb&&(Ob=function(){return new m(eb,Z)})}else return T.ULS.sendTraceTag(537151175,
0,10,"TableCommandHandler.RenameTable: Selected Table Range is null"),Ha.Task.Ua(!1);break;case 323142015:if(this.LLa())break;return(new f(this.$,this.Jbd(),this.tableManager.pg.name)).r$a();case -1400250766:qb=211;Wa=this.Wfj(Fb,vb,ec);var cb=C.m(Fb.OriginalTableRange,this.$.va.pa);Ob=function(){return new y(cb)};break;case 1872288872:this.tableManager.A2i();break;case -123538519:var Ua=this.bYh(Fb);kb=ua.a.contains(Fb[K.a.Nc],J.a.oGb,!0)||ua.a.contains(Fb[J.a.OF],"TableStyleIcon",!0)?"Preview Gallery":
"Pop-out Gallery";T.ULS.sendTraceTag(51181323,0,50,"TableStyleManager.ApplyTableStyleWebInvocation - Apply Table Style Invoked from {0} with style index {1}",kb,Ua.toString());var pa=this.$0e();pa&&(Wa=function(jb,Vb,Ic){return ra.b(vb,pa,Ua,jb,Vb,Ic,null,ec)},Ob=function(){return new A(pa,Ua)},qb=212);break;case 753331043:kb=Fb[K.a.Nc];if(!kb)break;var Qa=Number.parseInvariant(kb);if(this.sa.XJ()){T.ULS.sendTraceTag(51181321,0,50,"TableCommandHandler.FormatAsTable invoked on existing table with style index: {0}",
Qa);var Db=this.$0e();Db&&(Wa=function(jb,Vb,Ic){return ra.g(vb,Db,!1,!1,!1,Qa,jb,Vb,Ic,null,ec)},Ob=function(){return new B(Db,!1,Qa,!1)},qb=215);break}if(ja.EwaSettings.isChangeGateEnabled("OfficeVSO:6224451_CreateTableInEmptyCell")&&(ha=this.h$f(Qa,ec),Fb=ha.wyb,Wa=ha.PBa,Ob=ha.Zi,Fb)){qb=215;break}T.ULS.sendTraceTag(51181322,0,50,"TableCommandHandler.FormatAsTable invoked on newly created table with style index: {0}",Qa);ja.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TablesReactDialog",
!1)?new l(this.$,Number.parseInvariant(kb)):(kb=new n(this.$,Number.parseInvariant(kb)),kb.initialize(),kb.gf());break;case 71074531:var Kb=Fb.HasHeader,Ab=Fb.TableRange;Wa=function(jb,Vb,Ic){return ra.e(vb,Ab,Kb,!1,!1,jb,Vb,Ic,null)};Ob=function(){return new M.a(Kb,Ab)};qb=206;break;case -723113214:new e(this.$);break;case 868579142:T.ULS.sendTraceTag(526463700,0,50,"AltText on table changed.");qb=1022;var ub=Fb.Title,Mb=Fb.Description,Aa=this.Jbd();Wa=function(jb,Vb,Ic){return ra.f(vb,ub,Mb,Aa,
jb,Vb,Ic,null)};if(this.tableManager.pg){ha=ua.a.fh(this.tableManager.pg.wSa)?"":this.tableManager.pg.wSa;var Za=ua.a.fh(this.tableManager.pg.xSa)?"":this.tableManager.pg.xSa}Ob=ub==ha?function(){return new w(Aa,void 0,Mb)}:Mb==Za?function(){return new w(Aa,ub,void 0)}:function(){return new w(Aa,ub,Mb)};break;default:return va.a(yb)}if(Wa){var Zb=function(jb){return new P.a(qb,0,jb,void 0,Ob)};La=!this.namedSheetViewPublic||-2058042992!==yb&&504133448!==yb&&-798968736!==yb&&477776686!==yb?Q.a(this.$.userOperationManager,
Wa,Zb,zb):this.namedSheetViewPublic.BAa().continueWith(function(jb){jb.result&&Q.a(Yb.$.userOperationManager,Wa,Zb,zb)})}return La};d.prototype.toggleTableStyleOption=function(La,zb){var Fb=this,Yb=this.sa.tLa();T.ULS.sendTraceTag(41996800,0,50,"TableCommandHandler: The selected {0} style option {1} was toggled.",Yb?"PivotTable":"table",this.MQa);var kb=this.Jbd();return{PBa:function(vb,Wa,qb){return ra.k(La,kb,Fb.MQa,Xa.b(vb,Fb.PSi),Wa,qb,null,zb)},operationName:196,Zi:function(){return new r(kb,
Fb.MQa,Yb)}}};d.prototype.Wfj=function(La,zb,Fb){function Yb(yb){yb.Errors&&vb.tableManager.l7f(Wa)}function kb(){vb.tableManager.l7f(Wa)}var vb=this,Wa=La.OriginalTableRange,qb=C.m(La.ResizeTableRange,this.$.va.pa);return function(yb,ec,Ob){return ra.j(zb,qb,Xa.b(yb,Yb),Xa.a(ec,kb),Ob,null,Fb)}};d.prototype.bYh=function(La){var zb=-1;La[K.a.Nc]&&(zb=La[K.a.Nc],zb=ua.a.contains(zb,J.a.oGb,!0)?this.tableStyleManager.lvb(zb):Number.parseInvariant(La[K.a.Nc]));return zb};d.prototype.zc=function(La,zb){La=
!1;switch(zb.command){case -2058042992:case 504133448:case -798968736:case 477776686:case 341449783:case 2128797448:case -712419744:case 1868184698:case 1872288872:case 323142015:case 1544516694:case -544558380:case -1400250766:case -123538519:case 753331043:case 844144422:case 71074531:La=!0;break;case 756677940:La=ja.EwaSettings.ma(409);break;case -723113214:case 868579142:La=ja.EwaSettings.isChangeGateEnabled("OfficeVSO:6680193_FlighRemovalTableAltText")}return La};d.prototype.Qc=function(La,zb,
Fb){La=!1;switch(zb){case "PopulateTableMoreStylesMenu":this.menuId=Fb.MenuId;this.tableStyleManager.Rhc()||this.tableStyleManager.kKa("formatAsTableMenu");La=this.tableStyleManager.pGf(zb,Fb);break;case "PopulateTableAccessibleStylesMenu":this.menuId=Fb.MenuId,this.tableStyleManager.Rhc()||this.tableStyleManager.kKa("accessibilityTab"),La=this.tableStyleManager.pGf(zb,Fb)}return La};d.prototype.dispose=function(){this.tableStyleManager.Obj(this.vCf)};d.prototype.Yca=function(){(ua.a.contains(this.menuId,
"Format",!0)||ua.a.contains(this.menuId,"Accessible",!0))&&this.menuId&&this.frame.Lw(this.menuId)};d.prototype.Jbd=function(){return C.v(this.sa.activeCell,this.$)};d.prototype.oQh=function(){var La=this.tableManager.rrd;return La?C.v(La,this.$):null};d.prototype.F$e=function(La){if(this.tableManager){var zb=aa.g(this.$),Fb=this.sa.activeCell,Yb=this.tableManager.Vm(Fb),kb=null;if(!Yb||Yb.Kna)for(zb=bk(zb.U2),Yb=zb.next();!Yb.done;Yb=zb.next()){Yb=bk(Yb.value);for(var vb=Yb.next();!vb.done;vb=Yb.next()){vb=
vb.value;var Wa=vb.Fn;Fb.left>=Wa[0]&&Fb.left<=Wa[Wa.length-1]&&(kb=(vb=vb.Kr(Fb).NJ())?wa.DOMElementExtensions.zj(vb,U.a.eoe):null)}}else{var qb=zb.Ub(H.Range.Tc(Yb.top,Fb.left));if(this.Ox){ca.a.instance.create(function(){qb.invoke(8,La)},0,ea.a.e7f,!0,!0);return}kb=qb.UJa(56).o5a}kb&&ca.a.instance.create(function(){wa.DOMElementExtensions.Sec(kb,null)},0,ea.a.e7f,!0,!0)}};d.prototype.cYh=function(La){La=Number.parseInvariant(La);return-1<La&&8>=La?La:-1};d.prototype.LLa=function(){return!this.tableManager.pg};
d.prototype.Gef=function(){return this.tableManager.cEd?!1:(T.ULS.sendTraceTag(537151173,0,15,"TableCommandHandler.IsPreviousSelectedTableObjectNull PreviousSelectedTableObject is null"),!0)};d.prototype.tdi=function(){var La=this.sa.XJ(),zb=this.sa.sg&&!aa.g(this.$).Ab.f5(this.sa.Vc);return La||zb};d.prototype.sdi=function(){return this.sa.XJ()||!this.Gef()};d.prototype.eYh=function(La){var zb=[];La=bk(La);for(var Fb=La.next();!Fb.done;Fb=La.next())if(Fb=fa.b(this.$,Fb.value),null===Fb||void 0===
Fb?0:Fb.length){Fb=bk(Fb);for(var Yb=Fb.next();!Yb.done;Yb=Fb.next())Yb=Yb.value,Yb.usedRange&&!Array.contains(zb,Yb.usedRange)&&zb.push(Yb.usedRange)}return zb};d.prototype.$0e=function(){var La=this.sa.selectedRanges,zb=[];if(ja.EwaSettings.isChangeGateEnabled("OfficeVSO:3987000_ApplyTableStylesOnMultipleTablesInSingleRange"))zb=this.eYh(La);else{La=bk(La);for(var Fb=La.next();!Fb.done;Fb=La.next())Fb=Fb.value,aa.g(this.$).Ab.f5(Fb)&&zb.push(Fb)}return zb&&zb.length?C.r(zb,this.$):null};d.prototype.hL=
function(La){ob.a.Bba(this.$)&&G.TaskExtensions.Aa(F.GetServiceTaskFactory.Ra(this.$.da,430,431,1),function(zb){zb.result.eea(La);T.ULS.sendTraceTag(537151172,306,50,"TableCommandHandler:TriggerPivotTableHandRaise Trigger hand raise from sort.")},this.$.la,3)};d.prototype.Tqi=function(La){var zb=this;G.TaskExtensions.Aa(F.GetServiceTaskFactory.Ra(this.$.da,446,447,0),function(Fb){Fb.result.J9g(zb.$,La)},this.$.la,3)};d.pXf=function(La,zb){zb.SheetName=La.pa.name;zb.NamedObjectView=La.ea.isNamedObjectViewMode};
d.prototype.h$f=function(La,zb){var Fb=this;if(!this.sa.sg||1!=this.sa.Vc.EG)return{wyb:!1,PBa:Wa,Zi:qb};var Yb=C.v(this.sa.Vc,this.$);Yb.LastColumn=Yb.FirstColumn+3-1;Yb.LastRow=Yb.FirstRow+4-1;var kb=C.D(Yb),vb=aa.g(this.$);if(!kb.isValidRange||!vb.Ab.Lwa(kb))return{wyb:!1,PBa:Wa,Zi:qb};O.AFrameworkApplication.l_("XLS-CreateTableInEmptyCell-Treatment;XLS-CreateTableInEmptyCell-Control");if(!ja.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CreateTableInEmptyCell",!1))return{wyb:!1,PBa:Wa,
Zi:qb};if(null==La){var Wa=function(ec,Ob,Cb){return ra.e(Fb.$.oa.xa,Yb,!1,!1,!1,ec,Ob,Cb,zb)};var qb=function(){return new M.a(!1,Yb)}}else{var yb=C.s(Yb);Wa=function(ec,Ob,Cb){return ra.g(Fb.$.oa.xa,yb,!1,!1,!1,La,ec,Ob,Cb,zb)};qb=function(){return new B(yb,!1,La,!0)}}return{wyb:!0,PBa:Wa,Zi:qb}};Object(u.a)(d,"TableCommandHandler",null,[429]);var ib=I.a;Rk(c,ib);c.prototype.dispose=function(){ib.prototype.dispose.call(this)};c.prototype.Ad=function(){var La=this,zb=F.GetServiceTaskFactory.create(this.$.da,
134,this.la,this.hb),Fb=F.GetServiceTaskFactory.create(this.$.da,330,this.la,this.hb),Yb=F.GetServiceTaskFactory.Ra(this.$.da,309,310,this.hb);G.TaskExtensions.Aa(Ha.Task.oL(zb,Yb,Fb),function(){La.jd([new d(La.$,zb.result,Yb.result,Fb.result)],[2128797448,341449783,1544516694,-544558380,-123538519,753331043,756677940])},this.$.la,3)};c.ka=function(La){I.a.Qd(86,new c(La))};Object(u.a)(c,"TableCommandHandlerFactory",I.a,[]);b.d(E,"a",function(){return a})},1360:function(u,E,b){function a(){Type.registerNamespace("Common.App.NewAndOpen.Core");
va.a.instance.Qi(new c)}function c(){this.Slb=this.ude=this.fb=null;this.nm=!1}function d(ua,Xa,aa,ba,oa,ra,db){this.agb={};this.G1=ua;this.Hrg=Xa;this.Nqa=new k(D.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruReadRetryIntervalMs",5E3),D.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxReadRetry",3),this.rw.rlc);this.qra=new k(D.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruWriteRetryIntervalMs",15E3),D.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxWriteRetry",
3),this.rw.rlc);this.$tg=aa;this.xie=ba;this.ryg={};this.XS=new l;this.Aog=oa;this.nUb="";this.xv=ra;this.L4d=db;this.aug=D.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.WordOnline.recentLinksCount",25);return this}function e(){this.mruItemId=this.app=this.documentExt=this.documentName=this.folderName=this.documentUrl=null}function k(ua,Xa,aa){this.task=null;this.vec=ua;this.Vyi=Xa;this.taskManager=aa;this.retryCount=this.ayb=0;this.kOc=this.UAb=null}function l(){this._state=0;this.xae=
this.zae=this.yae=null;this.state=this.jhe=0;this.MJc=!1;return this}function n(ua,Xa,aa,ba,oa){this.Jpg=6E4;this.C8e="inactive";this.fje="active";this.US=!0;this.ae=ua;this.Eog=Xa;this.rIc=aa;this.eXb=ba;this.$a=new P.a;oa&&this.NDj();this.q9d=this.nZe()}function f(ua,Xa){this.agb={};this.G1=ua;this.Ukb=new v(Xa,this.HCb.rlc,"GetMoreInfo");this.Ao=new y;return this}function v(ua,Xa,aa){this.eWb=this.Di=null;this.dPc=0;this.hvg=ua;this.ae=Xa;this.N3d=aa}function r(ua,Xa,aa,ba,oa,ra,db,Ka){this.La=
ua;this.Og=Xa;this.ckg=aa;this.d1=ba;this.ae=oa;this.rIc=ra;this.cpg=db;this.SWb=Ka}function y(){this._state=0;this.QQc=this.skb=null;this.state=0;this.MJc=this.r7d=!1;return this}function m(){this._state=0}function w(){this.agb={}}u=b(0);var B=b(84),A=b(615),z=b(14);w.prototype.azg=function(ua){this.agb[ua.id.toString()]=ua};w.prototype.pDi=function(ua){var Xa=this.agb,aa;for(aa in Xa)Xa[aa].notify(ua,!1);this.agb={}};w.prototype.O1i=function(ua,Xa){Xa&&this.azg(Xa);return this.BAf(ua,Xa)};w.prototype.V6c=
function(ua){this.pDi(ua)};w.prototype.JJe=function(ua,Xa){ua.notify(Xa,!0)};Object(u.a)(w,"AEventEmitter",null,[665]);var x;(function(ua){ua[ua.notStarted=0]="notStarted";ua[ua.waiting=1]="waiting";ua[ua.shouldRetry=2]="shouldRetry";ua[ua.complete=3]="complete"})(x||(x={}));Object(u.b)("EventResultState",x);Mf.Object.defineProperties(m.prototype,{state:{configurable:!0,enumerable:!0,get:function(){return this._state},set:function(ua){var Xa={};z.ULS.sendTraceTag(5849616,202,50,"Changing event result state. {0}",
(Xa.OldState=x[this._state],Xa.NewState=x[ua],Xa),"ResultType",this.C0e());this._state=ua}}});Object(u.a)(m,"AEventResult",null,[727]);Rk(y,m);y.prototype.C0e=function(){return"GetMoreInfo Result"};Mf.Object.defineProperties(y.prototype,{pR:{configurable:!0,enumerable:!0,get:function(){return this.skb}},Rna:{configurable:!0,enumerable:!0,get:function(){return this.QQc}},Obi:{configurable:!0,enumerable:!0,get:function(){return this.r7d}}});Object(u.a)(y,"GetMoreInfoResult",m,[728,727]);var D=b(4),
I=b(81),F=b(39),G=b(897),T=b(391),O=b(170),U=b(740),J=b(640),H=b(107),K=b(25);r.prototype.a7i=function(){this.E8a.Mb(K.a.openUrlInNewTab,H.a.frame,Object(B.a)(this,this.openUrlInNewTab,"openUrlInNewTab"));this.E8a.Mb(K.a.EOa,H.a.frame,Object(B.a)(this,this.EOa,"openDocumentUrl"));D.AFrameworkApplication.ZP?this.blf():this.E8a.He(K.a.U6b,H.a.frame,Object(B.a)(this,this.U6b,"documentLoaded"),96)};r.prototype.openUrlInNewTab=function(ua,Xa,aa,ba,oa){oa&&oa.MenuItemId&&(ua={},z.ULS.sendTraceTag(5849678,
202,50,"Opening new tab {0}",(ua.Id=oa.SourceControlId,ua.AppType=J.a[this.gca],ua)),F.a.Ze(oa.MenuItemId.toString(),"_blank",void 0,"NewAndOpenCommonHelpers:OpenUrlInNewTab"));return 32};r.prototype.EOa=function(ua,Xa,aa,ba,oa){if(oa&&oa.MenuItemId){var ra=D.AFrameworkApplication.fa.qa("WacInTabOpenMRUIsEnabledForUiHost"),db=D.AFrameworkApplication.fa.qa("UiHostSupportsDocRebootFeatures");z.ULS.sendTraceTag(592237459,202,50,"[InTabOpenMRUIsEnabledForUiEmbed: {0}][UiEmbedSupportsDocReboot: {1}]",
ra,db);if(ra&&db){ua={};z.ULS.sendTraceTag(592237458,202,50,"Opening new tab {0}",(ua.Id=oa.SourceControlId,ua.AppType=J.a[this.gca],ua));oa=oa.MenuItemId.toString();var Ka={};Ka[T.a.zPa]="1";Ka[T.a.documentUrl]=oa;Ka[T.a.reason]=U.a.open;z.ULS.sendTraceTag(592237460,202,50,"Send PostMessage to the Ui host to reboot a document");D.AFrameworkApplication.$U().execute(function(Ga){Ga.uj(O.a.Eta,Ka)})}else this.openUrlInNewTab(ua,Xa,aa,ba,oa)}return 32};r.prototype.U6b=function(){this.blf();return 32};
r.prototype.Xba=function(ua,Xa,aa){aa=void 0===aa?"":aa;if(Xa&&Xa.XE){var ba=G.a[Xa.status];Xa=Xa.XE.getTime();var oa=this.aw()-Xa,ra={};z.ULS.sendTraceTag(5849679,202,50,"Making request to the WAC server {0}",(ra.Caller=ua,ra.RequestStatus=ba,ra.ElapsedMs=oa,ra.StartTime=Xa,ra.Notes=aa,ra))}else aa={},z.ULS.sendTraceTag(5849680,202,50,"Attempted to make a request to the WAC server with null request item {0}",(aa.Caller=ua,aa))};r.prototype.blf=function(){var ua=D.AFrameworkApplication.fa.qa("QPGVCI"),
Xa=I.a.$A(document.URL,"wdNewAndOpenCt",ua);if(Xa){Xa=parseInt(Xa);var aa=I.a.$A(document.URL,"wdPreviousSession",ua);ua=I.a.$A(document.URL,"wdPreviousCorrelation",ua);var ba=D.AFrameworkApplication.fa.qa("NAOPLP");if(D.AFrameworkApplication.ZP){var oa=D.AFrameworkApplication.ZP.getTime();if(!Xa||Xa>oa)ba={},z.ULS.sendTraceTag(5849682,202,15,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Invalid timestamp {0}",(ba.ClickTimestamp=Xa,ba.DocumentLoadedTime=oa,ba.SessionId=aa,ba.Correlation=ua,ba));
else{var ra={};z.ULS.sendTraceTag(5849683,202,ba?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Click-to-load perf {0}",(ra.ClickToLoadTime=oa-Xa,ra.ClickTimestamp=Xa,ra.SessionId=aa,ra.Correlation=ua,ra))}}else oa={},z.ULS.sendTraceTag(5849681,202,ba?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Not logging because document loaded time has not been set {0}",(oa.ClickTimestamp=Xa,oa.SessionId=aa,oa.Correlation=ua,oa))}};r.vM=function(){return new r(new A.a(function(){return D.AFrameworkApplication.ub}),
new A.a(function(){return D.AFrameworkApplication.qd}),new A.a(function(){return D.AFrameworkApplication.ta}),new A.a(function(){return D.AFrameworkApplication.ta.Qa.Cj}),new A.a(function(){return D.AFrameworkApplication.yi}),function(){return(new Date).getTime()},new A.a(function(){return D.AFrameworkApplication.ta.Qa.IV}),new A.a(function(){return D.AFrameworkApplication.supportsGetMoreInfoForPersonalStorage}))};Mf.Object.defineProperties(r.prototype,{E8a:{configurable:!0,enumerable:!0,get:function(){return this.La.value}},
bDb:{configurable:!0,enumerable:!0,get:function(){return this.Og.value}},xqf:{configurable:!0,enumerable:!0,get:function(){return this.ckg.value}},gca:{configurable:!0,enumerable:!0,get:function(){return this.d1.value}},rlc:{configurable:!0,enumerable:!0,get:function(){return this.ae.value}},aw:{configurable:!0,enumerable:!0,get:function(){return this.rIc}},IV:{configurable:!0,enumerable:!0,get:function(){return this.cpg.value}},supportsGetMoreInfoForPersonalStorage:{configurable:!0,enumerable:!0,
get:function(){return this.SWb.value}}});Mf.Object.defineProperties(r,{instance:{configurable:!0,enumerable:!0,get:function(){return r.Ma||(r.Ma=r.vM())}}});r.Ma=null;Object(u.a)(r,"NewAndOpenCommonHelpers",null,[664]);var N=b(108);v.prototype.RHg=function(){this.dPc=this.Abb+1};v.prototype.kKd=function(ua){this.Di&&(this.ae.Dp(this.Di),this.Di=null);ua&&(this.dPc=0)};v.prototype.VDj=function(ua){var Xa=this.eJj;0<=Xa?(this.RHg(),this.kKd(!1),this.Di=new N.a(4,1,Xa,ua,107),this.ae.Dg(this.Di)):(this.kKd(!0),
ua={},z.ULS.sendTraceTag(5849676,202,50,"Retries exhausted {0}",(ua.Action=this.N3d,ua)))};Mf.Object.defineProperties(v.prototype,{Abb:{configurable:!0,enumerable:!0,get:function(){return this.dPc}},eJj:{configurable:!0,enumerable:!0,get:function(){return this.Abb>=this.UWf.length?-1:this.UWf[this.Abb]}},UWf:{configurable:!0,enumerable:!0,get:function(){if(!this.eWb){var ua=(this.hvg.value||"0").split(",");this.eWb=[];for(var Xa=0;Xa<ua.length;Xa++){var aa=parseInt(ua[Xa]);isNaN(aa)?(aa={},z.ULS.sendTraceTag(5849677,
202,15,"Retry interval list contains non-number element {0}",(aa.Action=this.N3d,aa.Entry=ua[Xa],aa))):Array.add(this.eWb,aa)}}return this.eWb}}});Object(u.a)(v,"RetryHelper",null,[]);var M=b(41),C=b(29);Rk(f,w);f.prototype.rxi=function(){this.Hud("Document opened")};f.prototype.c7g=function(ua){var Xa=this;return function(){Xa.Hud(ua,!0)}};f.prototype.BAf=function(ua,Xa){Xa=void 0===Xa?null:Xa;var aa={};z.ULS.sendTraceTag(5849617,202,50,"Attempting to get GetMoreInfo properties {0}",(aa.Trigger=
ua,aa));3===this.Ao.state?(Xa&&this.JJe(Xa,this.Ao),Xa={},z.ULS.sendTraceTag(5849619,202,50,"GetMoreInfo already populated. {0}",(Xa.Trigger=ua,Xa))):this.Hud(ua);return this.Ao};f.prototype.Hud=function(ua,Xa){this.Ukb.kKd(!(void 0===Xa?0:Xa));1===this.Ao.state?(Xa={},z.ULS.sendTraceTag(5849620,202,50,"Not starting new request, because one is already in progress {0}",(Xa.Trigger=ua,Xa.RetryIndex=this.Ukb.Abb,Xa))):(Xa={},z.ULS.sendTraceTag(5849621,202,50,"Making GetMoreInfo request {0}",(Xa.Trigger=
ua,Xa.RetryIndex=this.Ukb.Abb,Xa)),this.Ao.state=1,Xa=String.format("{0}GetMoreInfoHandler.ashx?{1}",this.HCb.IV,D.AFrameworkApplication.Yi),this.HCb.bDb.A9(Xa,1,null,null,[f.vce,f.qge],!1,5,this.i6g(),this.h6g(ua),null))};f.prototype.i6g=function(){var ua=this;return function(Xa){var aa=!1,ba=!1,oa=!1;if(D.AFrameworkApplication.fa.qa("GetMoreInfoDataFromResponseBody"))if(Xa.data.Td){var ra=M.d(Xa.data.Td);var db=ra.Lt;ra.returnValue?db?(oa=!0,ua.Ao.QQc=db.StorageServiceDisplayName,ua.Ao.skb=f.$gf(db.PersonalFileStorageUrl)?
db.PersonalFileStorageUrl:"",""===ua.Ao.pR&&"SharePointOnlineConsumer"===D.AFrameworkApplication.fa.Wa("FileSource")&&(ua.Ao.skb=I.a.$ca(D.AFrameworkApplication.breadcrumbFolderUrl)),aa=""===ua.Ao.pR&&""!==ua.Ao.Rna):z.ULS.sendTraceTag(25298113,202,15,"Response body could not be casted into a GetMoreInfoResponseData type. Will fallback to reading the data from the headers"):z.ULS.sendTraceTag(25298112,202,15,"Failed to deserialize GetMoreInfo response body. Will fallback to reading the data from the headers")}else z.ULS.sendTraceTag(25298083,
202,15,"Could not find GetMoreInfo data on the response body. Will fallback to reading the data from the headers");oa||((db=Xa.data.responseHeaders)?(ua.Ao.QQc=(db[f.qge]||"").toString(),aa=(db[f.vce]||"").toString(),ua.Ao.skb=f.$gf(aa)?aa:"",""===ua.Ao.pR&&"SharePointOnlineConsumer"===D.AFrameworkApplication.fa.Wa("FileSource")?(ua.Ao.skb=I.a.$ca(D.AFrameworkApplication.breadcrumbFolderUrl),aa=""===ua.Ao.pR&&""!==ua.Ao.Rna):aa=""===aa&&""!==ua.Ao.Rna):(z.ULS.sendTraceTag(5849622,202,50,"Null response headers received."),
ba=!0));oa=String.format("Success at RetryIndex: {0}, InvalidResponse: {1}, InstantiatingPersonalStorage: {2}, InfoFoundInResponseBody: {3}",ua.Ukb.Abb,ba,aa,oa);ua.HCb.Xba("GetMoreInfoActor.CreateGetMoreInfoFromServerSuccessCallback",Xa.data,oa);ua.jXf(3,aa,ba)}};f.prototype.h6g=function(ua){var Xa=this;return function(aa){Xa.HCb.Xba("GetMoreInfoActor.CreateGetMoreInfoFromServerFailureCallback",aa.data,"Failure");Xa.jXf(2);Xa.Ukb.VDj(Xa.c7g(ua))}};f.prototype.jXf=function(ua,Xa,aa){this.Ao.state=
ua;this.Ao.r7d=void 0===Xa?!1:Xa;this.Ao.MJc=void 0===aa?!1:aa;this.V6c(this.Ao)};f.vM=function(){return new f(new A.a(function(){return r.instance}),new A.a(function(){return D.AFrameworkApplication.zRh}))};f.$gf=function(ua){if(!ua)return z.ULS.sendTraceTag(5849624,202,50,"Attempted to check an empty url for validity as a StorageHostUrl."),!1;if(C.a.al(ua).startsWith("https://"))return!0;z.ULS.sendTraceTag(5849625,202,10,"StorageUrl has invalid scheme.");return!1};Mf.Object.defineProperties(f.prototype,
{HCb:{configurable:!0,enumerable:!0,get:function(){return this.G1.value}}});Mf.Object.defineProperties(f,{instance:{configurable:!0,enumerable:!0,get:function(){return f.Ma||(f.Ma=f.vM())}}});f.vce="PersonalFileStorageUrl";f.qge="StorageServiceDisplayName";f.Ma=null;Object(u.a)(f,"GetMoreInfoActor",w,[]);var Q=b(104),P=b(97);n.prototype.qTc=function(ua){this.$a.addHandler(this.fje,ua)};n.prototype.sBg=function(ua){this.$a.addHandler(this.C8e,ua)};n.prototype.NDj=function(){var ua=new N.a(5,2,this.Jpg,
Object(B.a)(this,this.R7h,"inactiveLoop"),108);this.S7h.Dg(ua)};n.prototype.R7h=function(){var ua=this.nZe(),Xa=this.aw()-ua;if(Xa>this.xzc&&this.US){var aa={};z.ULS.sendTraceTag(5849626,202,50,"User went inactive {0}",(aa.TimeSinceLastActive=Xa,aa));this.US=!1;this.$a.raiseEvent(this.C8e)}ua-this.q9d>this.xzc&&(this.US=!0,this.$a.raiseEvent(this.fje));this.q9d=ua};n.vM=function(){return new n(new A.a(function(){return Q.a.instance}),function(){return D.AFrameworkApplication.Uif.getTime()},function(){return(new Date).getTime()},
new A.a(function(){return D.AFrameworkApplication.xzc}),!0)};Mf.Object.defineProperties(n.prototype,{S7h:{configurable:!0,enumerable:!0,get:function(){return this.ae.value}},nZe:{configurable:!0,enumerable:!0,get:function(){return this.Eog}},aw:{configurable:!0,enumerable:!0,get:function(){return this.rIc}},xzc:{configurable:!0,enumerable:!0,get:function(){return this.eXb.value}}});Mf.Object.defineProperties(n,{instance:{configurable:!0,enumerable:!0,get:function(){return n.Ma||(n.Ma=n.vM())}}});
n.Ma=null;Object(u.a)(n,"InactivityManager",null,[]);var ka=b(85),R=b(1114);Rk(l,m);l.prototype.C0e=function(){return"MruActor Result"};Mf.Object.defineProperties(l.prototype,{Yvd:{configurable:!0,enumerable:!0,get:function(){return this.yae}},Kpf:{configurable:!0,enumerable:!0,get:function(){return this.zae}},Xvd:{configurable:!0,enumerable:!0,get:function(){return this.xae}},jJj:{configurable:!0,enumerable:!0,get:function(){return this.jhe}}});Object(u.a)(l,"MruResult",m,[726,727]);var fa=b(246);
k.prototype.Vji=function(ua,Xa){return ua===fa.a.Aad||20===Xa||18===Xa||3===Xa};k.prototype.hli=function(ua){return 3===ua||5===ua||6===ua||7===ua||9===ua||10===ua||11===ua||12===ua||13===ua||14===ua||15===ua||16===ua||23===ua||26===ua||27===ua||28===ua};k.prototype.reset=function(){this.ayb=this.retryCount=0;this.kOc=this.UAb=null;this.task&&(this.taskManager.Dp(this.task),this.task=null)};k.prototype.Qai=function(ua,Xa,aa,ba){this.kOc=String.format("{0}_{1}",aa,ba);if(this.retryCount>=this.Vyi)return z.ULS.sendTraceTag(562656907,
202,50,"Max retries exceeded"),!1;if(this.Vji(aa,ba))return z.ULS.sendTraceTag(562656908,202,50,"Encountered permanent error. Not retrying"),!1;if(this.hli(ba)&&1<=this.ayb)return this.UAb=aa,!1;Xa=Math.max(Xa,this.vec*Math.pow(2,this.ayb));if(26===ba)Xa=Math.max(Xa,3E4);else if(27===ba||28===ba)Xa=Math.max(Xa,6E4);9===ba||412===aa&&(null==this.UAb||412!==this.UAb)?Xa=500:this.ayb+=1;this.UAb=aa;this.retryCount+=1;this.task&&this.taskManager.Dp(this.task);z.ULS.sendTraceTag(562656909,202,50,"Scheduling next retry after {0} ms.",
Xa);this.task=new N.a(2,1,Xa,ua,107);this.taskManager.Dg(this.task);return!0};Mf.Object.defineProperties(k.prototype,{bqc:{configurable:!0,enumerable:!0,get:function(){return this.kOc}}});Object(u.a)(k,"RetryManager",null,[]);var ca=b(99),ea=b(136),wa=b(167);Object(u.a)(e,"WriteOptions",null,[]);var X=b(619),ja=b(190);Rk(d,w);d.prototype.M8i=function(){this.rw.E8a.Mb(K.a.renameMostRecentlyUsedFileEntry,H.a.frame,Object(B.a)(this,this.Fcj,"renameMruEntry"))};d.prototype.Fcj=function(){return this.XZd("Rename")};
d.prototype.Cxi=function(){this.Jnf("File Opened")};d.prototype.Dxi=function(){this.Jnf("IntervalUpdate")};d.prototype.Jnf=function(ua){var Xa={};z.ULS.sendTraceTag(5849670,202,50,"Starting update of MRU entry {0}",(Xa.Trigger=ua,Xa));this.XZd(ua)};d.prototype.Z3=function(ua){(ua=C.a.Z3(ua))&&ua.startsWith(".")&&(ua=ua.substring(1,ua.length));return ua};d.prototype.EVe=function(){switch(this.rw.gca){case 3:return"Word";case 1:return"Excel";case 2:return"PowerPoint";case 5:return"Visio";case 4:return"OneNote";
default:return"Unknown"}};d.prototype.MZh=function(ua){var Xa=this.Aog();if(!Xa)return null;var aa=new e;aa.documentUrl=this.L4d.value?encodeURI(Xa):Xa;aa.mruItemId=this.nUb;aa.app=this.EVe();if(Xa=this.xv())aa.folderName=Xa.breadcrumbFolderName,Xa=Xa.Pm,aa.documentName=C.a.nq(Xa),aa.documentExt=this.Z3(Xa);ua&&(aa.documentName?aa.documentName.length?255<=aa.documentName.length?ua.set("DocumentNameLength","Long"):2084<=aa.documentName.length&&ua.set("DocumentNameLength","VeryLong"):ua.set("DocumentNameLength",
"0"):ua.set("DocumentNameLength","Null"));return JSON.stringify(aa)};d.prototype.XZd=function(ua,Xa){Xa=void 0===Xa?!1:Xa;if(4===this.rw.gca&&!D.AFrameworkApplication.Dta)return 2;var aa=ea.a.Cr();aa&&(aa.set("Trigger",ua),aa.set("IsRetry",Xa?"true":"false"),aa.set("MruIdSent",this.nUb?"true":"false"),aa.set("URLEncoded",this.L4d.value?"true":"false"));ca.Health.instance.recordKpiUsage("WriteMru",0,"smartfio",aa);ua=this.MZh(aa);if(!ua)return Xa=!D.AFrameworkApplication.webEditingEnabled,aa&&(aa.set("WebEditingIsEnabled",
D.AFrameworkApplication.webEditingEnabled?"true":"false"),aa.set("ProtectedFile",D.AFrameworkApplication.mqc?"true":"false")),ca.Health.instance.recordKpiFailure("WriteMru","MissingDocumentUrl",Xa,!1,Object.assign(new ja.a,{extendedProperties:aa})),2;this.qra&&!Xa&&this.qra.reset();aa=String.format("{0}MruV2ServiceHandler.ashx?rs={1}",this.rw.IV,this.localeName);this.xie?this.MCc["X-FileId"]=D.AFrameworkApplication.Yi:aa+=String.format("&{0}",D.AFrameworkApplication.Yi);D.AFrameworkApplication.Ob&&
(this.MCc["X-Office-AudienceGroup"]=Object(ka.a)(String,D.AFrameworkApplication.Ob.AudienceGroup)||"");this.MCc["X-Timeout"]=15E3;return this.rw.bDb.Yl(aa,2,ua,this.MCc,!0,5,Object(B.a)(this,this.pXj,"writeMruV2EntryOnServerSuccessCallback"),Object(B.a)(this,this.K$g,"createWriteMruV2EntryOnServerFailureCallback"),null,void 0,void 0,void 0,void 0,"4")};d.prototype.pXj=function(ua){this.H4e(ua.data)};d.prototype.H4e=function(ua){var Xa=ea.a.Cr();this.qra&&(Xa&&this.qra.bqc&&(Xa.set("LastError",this.qra.bqc),
Xa.set("NumRetries",this.qra.retryCount.toString())),this.qra.reset());var aa=R.c(ua.Td);aa&&aa.diagnostics_data&&(this.nUb=aa.diagnostics_data.mru_id);ua=+ua.Z2-+ua.XE;Xa&&Xa.set("RequestDuration",ua.toString());ca.Health.instance.recordKpiSuccess("WriteMru",Object.assign(new ja.a,{extendedProperties:Xa}))};d.prototype.K$g=function(ua){if(ua.data.httpStatus===fa.a.prb)this.H4e(ua.data);else{var Xa=ua.data.httpStatus===fa.a.iGb,aa=ea.a.Cr();this.U4e(this.qra,ua,this.z$g(),aa);aa&&(aa.set("StatusCode",
ua.data.httpStatus.toString()),Xa||this.yTc(ua.data,aa));ca.Health.instance.recordKpiFailure("WriteMru",String.format("RequestFailed_{0}",ua.data.httpStatus),Xa,!1,Object.assign(new ja.a,{extendedProperties:aa}))}};d.prototype.z$g=function(){var ua=this;return function(){ua.XZd("Retry",!0)}};d.prototype.GRh=function(){this.h8a("Polling")};d.prototype.FRh=function(){this.h8a("Retry",!0)};d.prototype.vxi=function(){this.h8a("Open")};d.prototype.uxi=function(){this.h8a("Activity")};d.prototype.txi=function(){this.h8a("OpenRecentLinks",
!1,!0)};d.prototype.sxi=function(){this.h8a("ActivityRecentLinks",!1,!0)};d.prototype.h8a=function(ua,Xa,aa){Xa=void 0===Xa?!1:Xa;aa=void 0===aa?!1:aa;var ba={};z.ULS.sendTraceTag(5849674,202,50,"Making GetMru request {0}",(ba.Trigger=ua,ba));if(ba=ea.a.Cr())ba.set("Trigger",ua),ba.set("IsRetry",Xa?"true":"false"),aa&&ba.set("RecentLinks","true");ca.Health.instance.recordKpiUsage("GetMru",0,"smartfio",ba);this.Nqa&&!Xa&&this.Nqa.reset();aa?this.LCe(Object(B.a)(this,this.HRh,"getMruV2ForRecentLinksFromServerSuccessCallback"),
Object(B.a)(this,this.DRh,"getMruForRecentLinksFromServerFailureCallback"),!0):this.LCe(Object(B.a)(this,this.IRh,"getMruV2FromServerSuccessCallback"),Object(B.a)(this,this.ERh,"getMruFromServerFailureCallback"))};d.prototype.yTc=function(ua,Xa){ua&&ua.responseHeaders&&(ua=ua.responseHeaders["X-CorrelationId"])&&Xa.set("ServerCorrelationId",ua)};d.prototype.nui=function(ua,Xa){ua&&(Xa&&Xa.set("RequestDuration",(+ua.Z2-+ua.XE).toString()),ca.Health.instance.recordKpiSuccess("GetMru",Object.assign(new ja.a,
{extendedProperties:Xa})))};d.prototype.IRh=function(ua){this.PZe(ua)};d.prototype.PZe=function(ua,Xa){Xa=void 0===Xa?!1:Xa;var aa="",ba=null,oa=null,ra=null,db=R.c(ua.data.Td);db&&(ba=db.places?db.places.items:[],oa=db.documents?db.documents.items:[],(ra=R.a(db,Xa))&&(aa=M.c(ra)));D.AFrameworkApplication.ta&&D.AFrameworkApplication.ta.Qa.XZ&&wa.c()&&!Xa&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(aa,!0));aa=ea.a.Cr();this.Nqa&&(aa&&this.Nqa.bqc&&(aa.set("LastError",this.Nqa.bqc),
aa.set("NumRetries",this.Nqa.retryCount.toString())),this.Nqa.reset());Xa&&aa&&aa.set("RecentLinks","true");ra||ba||oa?(Xa?this.rw.Xba("MruActor.GetMruV2ForRecentLinksFromServerSuccessCallback",ua.data,"Success"):this.rw.Xba("MruActor.GetMruV2FromServerSuccessCallback",ua.data,"Success"),this.pBc(3,ra,ba,oa),this.nui(ua.data,aa)):(Xa?this.rw.Xba("MruActor.GetMruV2ForRecentLinksFromServerSuccessCallback",ua.data,"Failure: Invalid JSON"):this.rw.Xba("MruActor.GetMruV2FromServerSuccessCallback",ua.data,
"Failure: Invalid JSON"),aa&&this.yTc(ua.data,aa),ca.Health.instance.recordKpiFailure("GetMru","JsonParseFailed",!1,!1,Object.assign(new ja.a,{extendedProperties:aa})),this.pBc(3,null,null,null,!0));this.V6c(this.XS)};d.prototype.HRh=function(ua){this.PZe(ua,!0)};d.prototype.U4e=function(ua,Xa,aa,ba){var oa=0,ra=0,db=R.c(Xa.data.Td);db&&(null!=db.response_code&&(oa=db.response_code,ba&&ba.set("MruResponseCode",oa.toString()),9===oa&&(this.nUb="")),db.error_data&&null!=db.error_data.retry_after_ms&&
(ra=db.error_data.retry_after_ms,ba&&ba.set("ExpectedRetryAfter",ra.toString())));ua&&(Xa=ua.Qai(aa,ra,Xa.data.httpStatus,oa),ba&&(ba.set("CurrentRetryCount",ua.retryCount.toString()),ba.set("RetryScheduled",Xa?"true":"false")))};d.prototype.ERh=function(ua){this.OZe(ua)};d.prototype.OZe=function(ua,Xa){Xa=void 0===Xa?!1:Xa;var aa=ua.data.httpStatus===fa.a.iGb,ba=ea.a.Cr();ba&&(ba.set("StatusCode",ua.data.httpStatus.toString()),Xa&&ba.set("RecentLinks","true"),aa||this.yTc(ua.data,ba));Xa?this.rw.Xba("MruActor.GetMruForRecentLinksFromServerFailureCallback",
ua.data,"Failure"):this.rw.Xba("MruActor.GetMruFromServerFailureCallback",ua.data,"Failure");this.pBc(2);this.U4e(this.Nqa,ua,Object(B.a)(this,this.FRh,"getMruFromServerRetryTask"),ba);ca.Health.instance.recordKpiFailure("GetMru",String.format("RequestFailed_{0}",ua.data.httpStatus),aa,!1,Object.assign(new ja.a,{extendedProperties:ba}));this.V6c(this.XS);D.AFrameworkApplication.ta&&D.AFrameworkApplication.ta.Qa.XZ&&wa.c()&&(appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",!1)),Xa||appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",
!1)))};d.prototype.DRh=function(ua){this.OZe(ua,!0)};d.prototype.pBc=function(ua,Xa,aa,ba,oa){if(3!==this.XS.state||3===ua)this.XS.yae=void 0===Xa?null:Xa,this.XS.zae=void 0===aa?null:aa,this.XS.xae=void 0===ba?null:ba,this.XS.state=ua,this.XS.MJc=void 0===oa?!1:oa,this.XS.jhe=this.rw.aw()};d.prototype.BAf=function(ua,Xa){var aa={};z.ULS.sendTraceTag(6029918,202,50,"MRU result requested {0}",(aa.Trigger=ua,aa.ResultState=this.XS.state,aa));Xa&&3===this.XS.state&&this.JJe(Xa,this.XS);return this.XS};
d.prototype.LCe=function(ua,Xa,aa){aa=void 0===aa?!1:aa;this.pBc(1);var ba={};var oa=aa?String.format(this.rw.IV+"MruV2ServiceHandler.ashx?sort=Date&show={0}&apps={1}&rs={2}&cap={3}",this.aug,"OfficeSuite",this.localeName,"ClassicMru"):String.format(this.rw.IV+"MruV2ServiceHandler.ashx?sort=Date&show={0}&apps={1}&rs={2}",10,this.EVe(),this.localeName);this.$tg.value||(oa+="&entity=docs");D.AFrameworkApplication.Ob&&(ba["X-Office-AudienceGroup"]=Object(ka.a)(String,D.AFrameworkApplication.Ob.AudienceGroup)||
"");aa&&(ba["X-Office-Application"]="147");this.xie?ba["X-FileId"]=D.AFrameworkApplication.Yi:oa+=String.format("&{0}",D.AFrameworkApplication.Yi);this.rw.bDb.Yl(oa,1,null,ba,!0,5,ua,Xa,null)};d.vM=function(){return new d(new A.a(function(){return r.instance}),new A.a(function(){return X.a.aH(D.AFrameworkApplication.lcid).name}),new A.a(function(){return D.AFrameworkApplication.ta.Qa.Vu}),D.AFrameworkApplication.fa.qa("MruWriteFileIdInHeader"),function(){return D.AFrameworkApplication.ta.Qa.qx},function(){return D.AFrameworkApplication.am},
new A.a(function(){return D.AFrameworkApplication.fa.qa("OICEncodeUrlIsEnabled")}))};Mf.Object.defineProperties(d.prototype,{MCc:{configurable:!0,enumerable:!0,get:function(){return this.ryg}},rw:{configurable:!0,enumerable:!0,get:function(){return this.G1.value}},localeName:{configurable:!0,enumerable:!0,get:function(){return this.Hrg.value}}});Mf.Object.defineProperties(d,{instance:{configurable:!0,enumerable:!0,get:function(){return d.Ma||(d.Ma=d.vM())}}});d.Ma=null;Object(u.a)(d,"MruActor",w,
[]);c.prototype.Ph=function(ua){this.fb=ua;ua.register(664,"Common.INewAndOpenCommonHelpers").tc().Cc(function(){return r.instance});ua.register(665,"Common.IEventEmitter<Common.IGetMoreInfoResult>").tc().Cc(function(){return f.instance});ua.register(665,"Common.IEventEmitter<Common.IMruResult>").tc().Cc(function(){return d.instance})};c.prototype.init=function(){var ua=this;D.AFrameworkApplication.fa.Su(function(){ua.Lxb()})};c.prototype.Lxb=function(){this.fb.resolve("Common.INewAndOpenCommonHelpers");
this.fb.resolve("Common.IEventEmitter<Common.IGetMoreInfoResult>");this.fb.resolve("Common.IEventEmitter<Common.IMruResult>");var ua=!1;r.instance.a7i();D.AFrameworkApplication.rla&&(ua=!0);D.AFrameworkApplication.dLf&&(d.instance.vxi(),D.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.recentLinksIsEnabled",!1)&&d.instance.txi(),0<D.AFrameworkApplication.Lpf&&this.Ake(),this.Wtj(),ua=!0);D.AFrameworkApplication.supportsGetMoreInfoForPersonalStorage&&ua&&f.instance.rxi();
D.AFrameworkApplication.ERj&&(ua=d.instance,ua.M8i(),ua.Cxi(),Q.a.instance.Dg(this.FRj))};c.prototype.Wtj=function(){n.instance.qTc(Object(B.a)(d.instance,d.instance.uxi,"makeGetMruRequestActivityTrigger"));D.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.recentLinksIsEnabled",!1)&&n.instance.qTc(Object(B.a)(d.instance,d.instance.sxi,"makeGetMruForRecentLinksRequestActivityTrigger"));n.instance.qTc(Object(B.a)(this,this.Ake,"addGetMruFromServerTask"));n.instance.sBg(Object(B.a)(this,
this.Och,"deleteGetMruFromServerTask"))};c.prototype.Och=function(){Q.a.instance.Dp(this.Mpf)};c.prototype.Ake=function(){Q.a.instance.Dg(this.Mpf)};c.prototype.dispose=function(){this.nm||(this.nm=!0,this.Slb&&(Q.a.instance.Dp(this.Slb),this.Slb=null))};Mf.Object.defineProperties(c.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.NewAndOpen.Core"}},Mpf:{configurable:!0,enumerable:!0,get:function(){return this.ude||(this.ude=new N.a(5,2,D.AFrameworkApplication.Lpf,Object(B.a)(d.instance,
d.instance.GRh,"getMruFromServerTask"),109))}},FRj:{configurable:!0,enumerable:!0,get:function(){return this.Slb||(this.Slb=new N.a(2,2,6E4*D.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruUpdateIntervalInMinutes",1440),Object(B.a)(d.instance,d.instance.Dxi,"makeUpdateMruTask"),197))}}});Object(u.a)(c,"CorePackageManager",null,[10,11,3]);var va=b(254);b.d(E,"a",function(){return a})},1367:function(u,E,b){function a(){sa.a.Fa(c.ka)}function c(V){var Ia=za.call(this)||
this;Ia.$=V;Ia.Eb();return Ia}function d(){this.NKd=A.AFrameworkApplication.SWj;this.Xyi=A.AFrameworkApplication.QWj;this.vO=A.AFrameworkApplication.U_h();this.priority=A.AFrameworkApplication.OZd;this.Vde=this.Crj();this.pSc=A.AFrameworkApplication.T_h()}function e(V,Ia,Ha,ob,ib,La,zb){var Fb=this;ob=void 0===ob?null:ob;ib=void 0===ib?!1:ib;La=void 0===La?null:La;zb=void 0===zb?!1:zb;this.Rqa=0;this.ega=this.Di=null;this.hXb=new ra.a;this.PS=new ra.a;this.Wl=null;this.FTb=!1;this.ae=V;this.Kce=Ia;
this.Kce.execute(function(Yb){Yb.Ml(qa.a.jjd,Object(D.a)(Fb,Fb.lMi,"onHostResponseReceived"))});this.j9=Ha;this.khe=new na.a("WebServiceCall","TokenRefresh");this.Wi=ob||new k(V);this.fvg=ib;this.gT=La?La:xa.SessionStatusManager.instance;this.K4d=zb}function k(V){this.zo={};this.tX={};this.utg={};this.Wkf=15;this.X8d=!1;this.lvg=new Date;this.LTb=new Date;this.ae=V;this.YWb=new Ka.a(2,2,6E4*this.Wkf,Object(D.a)(this,this.agg,"writeMeasures"),135,"SL",!1);this.ae.Dg(this.YWb);this.Q$h()}function l(){}
function n(V,Ia){var Ha=this;this.documentVisibilityObserver=null;this.Pa=new T.a;this.mx=null;this.Adb=this.Mkb=!1;this.grc=null;this.tHb=!1;this.Ltd=!0;this.B9d=this.b9d=this.TG=this.Olb=!1;this.DS=null;this.I4e=function(){if(!Ha.N9b||Ha.N9b&&Ha.$.ea.dc)Ha.i5e(!1);else if(Ha.Ltd){Ha.Ltd=!1;var ob=C.a(Ha.$);x.ULS.sendTraceTag(537170709,0,50,"EwaAccessTokenExpirationRefreshManager.HandleOnTokenExpiring - session is not active - postponing refresh current-activity [{0}] TimeUntilTokenExpirationInMin [{1}]",
ob.ii?ob.ii.activityName:"None",Ha.E8f())}};this.Uc=function(ob,ib){Ha.context&&(ob=Ha.$.ea,ib.sH&&Ha.context.nHb&&!Ha.context.Izc?(Ha.context.Izc=!0,ib={Name:"EwaAccessTokenExpirationRefreshManager.OnSessionIdChanged - reconnect"},ib.IsUserActive=ob.df.Qr,ib.RefreshAccessTokenCorrelationID=Ha.context.correlationID,ib=ca.a.xc(ib),x.ULS.sendTraceTag(537170708,0,50,ib)):Ha.N9b&&Ha.Mkb&&!ob.dc&&!Ha.context.I3c&&(ib={Name:"EwaAccessTokenExpirationRefreshManager.OnSessionIdChanged - consider abort ongoing refresh due to reopen"},
Ha.mx&&(Ha.mx.cancel(),ib.Aborted=!0,ua.EwaSettings.isChangeGateEnabled("OfficeVSO:4877031_allowRefreshExpiringAfterAbort")&&(ib.ResetStopRefreshRetriesUntilTokenExpired=!0,Ha.Adb=!1)),ib.TimeUntilTokenExpirationInMin=Ha.E8f(),ib.RefreshAccessTokenCorrelationID=Ha.context.correlationID,ib=ca.a.xc(ib),x.ULS.sendTraceTag(572019856,0,50,ib)))};this.qya=function(){if(Ha.context&&Ha.context.nHb&&!Ha.context.Izc){var ob={Name:"EwaAccessTokenExpirationRefreshManager.OnOpenWorkbookFailed"};ob.CreatedForExpired=
Ha.context.I3c;ob.RefreshAccessTokenCorrelationID=Ha.context.correlationID;ob.OpenWorkbookErrors=O.a.Ec(Ha.$.ea.rF);ob.ExecutionContextErrors=O.a.Ec(C.a(Ha.$).fd.errors);ob.accesstokenTTL=A.AFrameworkApplication.mk;ob=ca.a.xc(ob);x.ULS.sendTraceTag(537170707,0,15,ob)}};this.h5e=function(){Ha.Adb=!1;Ha.i5e(!0)};this.YAd=function(){Ha.tHb&&(Ha.$.ea.df.VPa(Ha.YAd),Ha.tHb=!1);Ha.c5f()};this.$=V;this.fVd=Ia;this.HGd=V.Fb.Kg("WebServiceCall","refreshToken");this.N9b=ua.EwaSettings.isChangeGateEnabled("OfficeVSO:4874136_fixRaceOpenWorkbookRefreshExpiringToken");
F.a.instance.LUc(this.h5e);F.a.instance.JUc(this.I4e);Ia=this.$.ea;Ia.Vj(this.Uc);Ia.sZb(this.qya);this.Zzi=this.$.ya.MinTokenLifetimeForRegularExpirationPromptInMin;this.v0f=this.$.ya.ShortAccessTokenExpirationPromptSeconds;this.qMf=this.$.ya.RefreshAccessTokenDurationLimitInSec;this.gdg(V.ea.uEf,A.AFrameworkApplication.mk);V=new Date;Ia={};x.ULS.sendTraceTag(537170714,217,50,"Initializing EwaAccessTokenExpirationRefreshManager. {0}",(Ia.AccessTokenTtl=A.AFrameworkApplication.mk,Ia.NowGetTime=V.getTime(),
Ia.BootTime=A.AFrameworkApplication.eha,Ia.WopiTokenExpiresAfterMinutes=A.AFrameworkApplication.MZd,Ia.WopiTokenTaskItemPriority=A.AFrameworkApplication.OZd,Ia));this.$.da.Za(291,function(ob){Ha.documentVisibilityObserver=ob})}function f(V,Ia){this.hXb=V;this.PS=Ia}function v(){return r.apply(this,arguments)||this}function r(){}function y(){}function m(V,Ia){this.nHb=!1;this.correlationID=V;this.I3c=Ia;this.Izc=!1;this.creationTime=fa.a.Ta.Jb}function w(V){var Ia=B.call(this)||this;Ia.Pa=new T.a;
Ia.Olb=!1;Ia.TG=!1;Ia.$=V;return Ia}function B(){this.ife=this.VPc=!1;var V=A.AFrameworkApplication.mk;if(!(0>=V)){this.mk=V;V=new Date;var Ia={};x.ULS.sendTraceTag(17581890,217,50,"Initializing SessionExpirationManager. {0}",(Ia.AccessTokenTtl=this.mk,Ia.NowGetTime=V.getTime(),Ia.BootTime=A.AFrameworkApplication.eha,Ia));F.a.instance.LUc(Object(D.a)(this,this.vOa,"onSessionExpiredDetected"));F.a.instance.JUc(Object(D.a)(this,this.xBf,"onSessionExpiringDetected"))}}u=b(0);var A=b(4),z=b(232),x=b(14),
D=b(84),I=b(52),F=b(200);B.prototype.vOa=function(){F.a.instance.JId(Object(D.a)(this,this.vOa,"onSessionExpiredDetected"));x.ULS.sendTraceTag(19247381,217,50,"SessionExpiredDetected");this.s3h()};B.prototype.xBf=function(){F.a.instance.IId(Object(D.a)(this,this.xBf,"onSessionExpiringDetected"));this.ife||this.VPc||(x.ULS.sendTraceTag(20492680,217,50,"SessionExpiringDetected - Showing expiring dialog."),this.ife=!0,this.EAj())};B.prototype.s3h=function(){this.VPc||(A.AFrameworkApplication.DF(I.a.Xuc),
this.VPc=!0,this.DAj())};Object(u.a)(B,"ASessionExpirationManager",null,[]);var G=b(89),T=b(38),O=b(31),U=b(15),J=b(42),H=b(258),K=b(6),N=b(82),M=b(261),C=b(67);Rk(w,B);w.prototype.Xme=function(V){this.Pa.addHandler("SessionExpired",V)};w.prototype.qZb=function(V){this.Pa.addHandler("TokenRefreshed",V)};w.prototype.wId=function(V){this.Pa.removeHandler("TokenRefreshed",V)};w.prototype.hdc=function(){return F.a.instance.UQ(A.AFrameworkApplication.mk)};w.prototype.dispose=function(){G.a.Ia(this.Pa);
this.$=null};w.prototype.EAj=function(){this.$.isEditMode&&this.Hcc(!1)};w.prototype.DAj=function(){this.Olb=!0;this.Hcc(!0);this.Pa.raiseEvent("SessionExpired")};w.prototype.Hcc=function(V){var Ia=this;x.ULS.sendTraceTag(537170715,0,15,"EwaAccessTokenExpirationManager.HandleAccessTokenExpirationDialog: isExpired {0}, GotDeploymentOrTimedOutError {1}",V,this.$.ea.j4);var Ha=this.$.ob.Cp;V&&Ha&&Ha.isVisible&&1299163859===Ha.error.MessageId&&this.$.ob.Cp.It();var ob=this.Xc(V);J.a(this.$).Zs(new H.a(K.a.Zy,
5,function(){var ib=C.a(Ia.$),La=ib.fd.activityState;La[N.a.e2]=Ia.$.Tob(Ia.$.isEditMode);La[N.a.LL]=N.a.C8a;La[M.a.Oq]=K.a.accessTokenExpiringWarning;ib.fd.yt([ob])}))};w.prototype.Xc=function(V){return V?O.a.MDe():this.v9g()};w.prototype.v9g=function(){var V=O.a.Xc(12,1,0,0,0,1299163859,"AccessTokenExpiringWarning");V.Description=this.accessTokenExpiringMessage;return V};Mf.Object.defineProperties(w.prototype,{accessTokenExpiringMessage:{configurable:!0,enumerable:!0,get:function(){var V=(new Date(this.mk)).format(this.$.ya.ShortTimeFormat);
return String.format(U.a.instance.mb(78),V)}},tokenExpired:{configurable:!0,enumerable:!0,get:function(){return this.Olb}},Mcb:{configurable:!0,enumerable:!0,get:function(){return!1}},Gba:{configurable:!0,enumerable:!0,get:function(){return!1}},JGd:{configurable:!0,enumerable:!0,get:function(){return!1}},s5:{configurable:!0,enumerable:!0,get:function(){return!1}}});Object(u.a)(w,"EwaAccessTokenExpirationManager",B,[641,175,3]);var Q=b(7),P=b(178),ka=b(81),R=b(738),fa=b(28);Object(u.a)(m,"RefreshAccessTokenContext",
null,[]);var ca=b(54),ea=b(62),wa=b(179),X=b(44),ja=b(111),va=b(119),ua=b(1),Xa=b(22),aa=b(147),ba=b(35),oa=b(116);Object(u.a)(y,"Error",null,[]);Object(u.a)(r,"NamedResult",null,[]);Rk(v,r);Object(u.a)(v,"ErrorInfo",r,[]);Mf.Object.defineProperties(f.prototype,{vO:{configurable:!0,enumerable:!0,get:function(){return this.hXb}},errors:{configurable:!0,enumerable:!0,get:function(){return this.PS}}});Object(u.a)(f,"TokenRefreshArgs",null,[661]);n.prototype.Xme=function(V){this.Pa.addHandler("SessionExpired",
V)};n.prototype.qZb=function(V){this.Pa.addHandler("TokenRefreshed",V)};n.prototype.wId=function(V){this.Pa.removeHandler("TokenRefreshed",V)};n.prototype.hdc=function(){return F.a.instance.UQ(A.AFrameworkApplication.mk)};n.prototype.dispose=function(){F.a.instance.JId(this.h5e);F.a.instance.IId(this.I4e);var V=this.$.ea;V&&(V.wk(this.Uc),V.qsc(this.qya));G.a.Ia(this.Pa);this.documentVisibilityObserver=this.$=null};n.prototype.E8f=function(){return this.hdc()?0:(A.AFrameworkApplication.mk-(new Date).getTime())/
6E4};n.prototype.gdg=function(V,Ia){if(0<Ia&&!this.hdc()){var Ha=A.AFrameworkApplication.fa.kd("AccessTokenExpirationPromptSeconds",A.AFrameworkApplication.XX),ob=(Ia-V.getTime())/6E4;x.ULS.shipAssertTag(537170713,0,0<=ob,"TokenManager.UpdateTokenExpirationPromptByTokenLifeTime the access-token expiration time should be after token creation time accessTokenTTL [{0}] creationTime [{1}] tokenLifetimeInMin [{2}]",Ia,V.getTime(),ob);ob<this.Zzi?(x.ULS.sendTraceTag(537170712,0,15,"TokenManager.UpdateTokenExpirationPromptByTokenLifeTime updating AccessTokenExpirationPromptSeconds to [{0}] tokenLifetimeInMin [{1}]",
this.v0f,ob),A.AFrameworkApplication.XX=this.v0f):A.AFrameworkApplication.XX!==Ha&&(x.ULS.sendTraceTag(537170711,0,15,"TokenManager.UpdateTokenExpirationPromptByTokenLifeTime updating AccessTokenExpirationPromptSeconds to [{0}] tokenLifetimeInMin [{1}]",Ha,ob),A.AFrameworkApplication.XX=Ha)}};n.prototype.R3g=function(V){return!this.context||this.context.nHb||this.context.I3c!==V?(V=new m(P.a.create().toString(),V),this.context&&!this.context.Izc&&x.ULS.sendTraceTag(537170710,0,15,"TokenManager.InitContext: creating new context [{0}] although previeous one [{1}] not used successfully, isPreviousOneRefreshedSuccessfully [{2}] ",
V.correlationID,this.context.correlationID,this.context.nHb),this.DS=V,!0):!1};n.prototype.jfj=function(V){V&&this.TG&&!this.Gba&&this.$.ea.df.Qr&&!this.s5&&(this.TG=!1)};n.prototype.i5e=function(V){var Ia=this;this.jfj(V);if(!(this.Mkb||this.Adb&&!V||this.TG)&&this.Mcb){this.Mkb=!0;var Ha=this.context?this.context.creationTime:null,ob=this.R3g(V);this.Ltd=!0;var ib=this.$.ea,La={Name:"EwaAccessTokenExpirationRefreshManager.HandleTokenRefresh",newContextCreated:ob};La.IsUserActive=ib.df.Qr;La.IsSessionActive=
ib.dc;La.ContainsChangesWorkbookOperations=this.$.userOperationManager.gHa();La.isSessionExpired=V;La.stopRefreshRetriesUntilTokenExpired=this.Adb;La.FailedToRefreshExpiredToken=this.TG;La.numOfFailuresWhileUserIsActive=oa.a.U5;La.numOfFailuresWhileUserIsInActive=oa.a.V5;La.numOfFailuresWhileOffline=oa.a.Xxa;La.RefreshAccessTokenCorrelationID=this.context.correlationID;ob&&Ha&&(La.TimeInMinFromPreviosContextCreation=Math.round(va.b(fa.a.Ta,Ha)/60));Ha=ca.a.xc(La);x.ULS.sendTraceTag(40416199,0,50,
Ha);this.HGd.start();this.b9d=ib.df.Qr;this.mx=new R.a;this.Fri(V);var zb=this.fVd.L6i(!V,this.mx?this.mx.token:null);zb.continueWith(function(){Ia.wXg();var Fb=Ia.fVd.$0i(zb);Ia.HGd.stop();var Yb=Ia.hdc();if(!Fb||ua.EwaSettings.isChangeGateEnabled("OfficeVSO:5348973_FishbowlFixDuringTokenRefresh")&&Yb){var kb=zb.result.errors;Fb&&Yb&&Ia.AAg(kb);Ia.$2h(kb,V)}else Ia.Adb=!1,Ia.b3h(zb.result.vO,V);Ia.Mkb=!1},this.N9b?8:0)}};n.prototype.AAg=function(V){var Ia=[Object(Q.a)(new y,{Id:"200",Details:"Expired accesstoken recieved on successful token request."})];
V.add(Object(Q.a)(new v,{Name:"ExpiredTokenAfterSuccessfulRefresh",Errors:Ia}))};n.prototype.Fri=function(V){V&&(this.$.ea.df.Qr?this.c5f():(this.$.ea.df.Era(this.YAd),this.tHb=!0))};n.prototype.c5f=function(){var V=this;this.grc=wa.AsyncMethodContext.Ms(function(){V.K6i()},1E3*this.qMf,X.a.q6i,this.grc)};n.prototype.wXg=function(){this.grc&&this.grc.cancel();this.tHb&&(this.$.ea.df.VPa(this.YAd),this.tHb=!1);this.mx=null};n.prototype.K6i=function(){x.ULS.sendTraceTag(537170706,0,15,"EwaAccessTokenExpirationRefreshManager.RefreshTokenDurationThresholdReached durationLimitInSec [{0}]",
this.qMf);this.mx.cancel()};n.prototype.$2h=function(V,Ia){this.Adb=!0;Ia&&(this.TG||(this.Olb=this.TG=!0),this.fVd.Xgc(V)&&(this.B9d=!0));var Ha=!Ia||this.Mcb&&!oa.a.Ewc?40380379:39982555;Ia=this.pCe(Ia);Ia.Name="EwaAccessTokenExpirationRefreshManager.HandleRefreshError";Ia.FailedToRefreshExpiredToken=this.TG;Ia.LastErrorIsPermanent=this.s5;if(0<V.count){var ob=V.na(0);Ia.errorName=ob.Name;0<ob.Errors.length&&(Ia.ErrorId=ob.Errors[0].Id,ob=ob.Errors[0].Details,Ia.ErrorDetails=this.Vgh(ob.toString())?
"PiiScrubbed":ob)}Ia=ca.a.xc(Ia);x.ULS.sendTraceTag(Ha,0,15,Ia);this.Pa.raiseEvent("TokenRefreshed",new f(null,V))};n.prototype.Vgh=function(V){return Xa.a.contains(V,"makes the internet safe for businesses",!0)};n.prototype.pCe=function(V){var Ia={},Ha=this.$.ea;Ia.Name="";Ia.IsUserActive=Ha.df.Qr;Ia.IsSessionActive=Ha.dc;Ia.GotDeploymentOrTimedOutError=Ha.j4;Ia.TimeInSecFromLastStatefulSuccessfulRequest=Ha.L0;Ia.TimeFromLastUserActivityInMs=Ha.df.aNb;Ia.calledFromSessionExpiredFlow=V;Ia.RefreshTokenDurationInMS=
this.HGd.qc;Ia.numOfFailuresWhileUserIsActive=oa.a.U5;Ia.numOfFailuresWhileUserIsInActive=oa.a.V5;Ia.numOfFailuresWhileOffline=oa.a.Xxa;Ia.RefreshAccessTokenCorrelationID=this.context.correlationID;Ia.accessTokenTTL=A.AFrameworkApplication.mk;Ia.ContainsChangesWorkbookOperations=this.$.userOperationManager.gHa();Ia.IsDocumentHidden=this.documentVisibilityObserver?this.documentVisibilityObserver.Ni.toString():"Unknown";Ia.TimeFromFirstOpenInHr=Math.floor(va.b(fa.a.Ta,ja.toUtc(Ha.uEf))/3600);return Ia};
n.prototype.b3h=function(V,Ia){this.TG=!1;this.iTj();this.gdg(new Date,A.AFrameworkApplication.mk);var Ha=this.$.ea,ob=!Ia&&Ha.df.Qr,ib=!this.$.isEditMode&&Ha.pab;Ia=this.pCe(Ia);Ia.Name="EwaAccessTokenExpirationRefreshManager.HandleRefreshSuccess";Ia.shouldTriggerSilentReloadAfterExpiring=ob;Ia.WopiTokenTaskItemPriority=A.AFrameworkApplication.OZd;Ia.isDirtyViewSession=ib;Ia=ca.a.xc(Ia);x.ULS.sendTraceTag(39982556,0,15,Ia);this.Pa.raiseEvent("TokenRefreshed",new f(V,null));ib?Ha.df.Qr&&(x.ULS.sendTraceTag(537170705,
0,15,"EwaAccessTokenExpirationRefreshManager.HandleRefreshSuccess: User active after refresh dirty view session. trigger request to connect the same server."),Ha.Fad()):Ha.df.Qr?ob&&(V=C.a(this.$).fd.activityState,V[oa.a.reb]=!0,V[aa.a.aY]=!0,V[ba.a.As]=this.$.isEditMode,J.a(this.$).Zs(new H.a(K.a.gna,2,null))):Ha.dc&&ea.j(this.$.oa.xa,!0,!1,!1,null,null,null,null,null)};n.prototype.iTj=function(){void 0!==this.$.ea.workbookContext.WorkbookUri&&null!==this.$.ea.workbookContext.WorkbookUri?(this.$.ea.workbookContext.WorkbookUri=
ka.a.rT(this.$.ea.workbookContext.WorkbookUri,A.AFrameworkApplication.hP,A.AFrameworkApplication.accessToken),this.$.ea.workbookContext.WorkbookUri=ka.a.rT(this.$.ea.workbookContext.WorkbookUri,A.AFrameworkApplication.YX,A.AFrameworkApplication.mk.toString()),this.$.ea.ooc()):x.ULS.sendTraceTag(537170704,0,15,"EwaAccessTokenExpirationRefreshManager.UpdateTokensAtContext: WorkbookUri is null");this.$.ya.AccessToken=A.AFrameworkApplication.accessToken;this.$.ya.AccessTokenValidTo=A.AFrameworkApplication.mk;
void 0!==this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion&&null!==this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion&&(this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion=ka.a.rT(this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion,A.AFrameworkApplication.hP,A.AFrameworkApplication.accessToken),this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion=ka.a.rT(this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion,A.AFrameworkApplication.YX,A.AFrameworkApplication.mk.toString()));
void 0!==this.$.ya.EmbedConfiguratorUrl&&null!==this.$.ya.EmbedConfiguratorUrl&&(this.$.ya.EmbedConfiguratorUrl=ka.a.rT(this.$.ya.EmbedConfiguratorUrl,A.AFrameworkApplication.hP,A.AFrameworkApplication.accessToken),this.$.ya.EmbedConfiguratorUrl=ka.a.rT(this.$.ya.EmbedConfiguratorUrl,A.AFrameworkApplication.YX,A.AFrameworkApplication.mk.toString()));this.context.nHb=!0};Mf.Object.defineProperties(n.prototype,{tokenExpired:{configurable:!0,enumerable:!0,get:function(){return this.Olb}},Gba:{configurable:!0,
enumerable:!0,get:function(){return this.b9d}},s5:{configurable:!0,enumerable:!0,get:function(){return this.B9d}},context:{configurable:!0,enumerable:!0,get:function(){return this.DS}},Mcb:{configurable:!0,enumerable:!0,get:function(){return this.s5?!1:this.$.ea.df.Qr?1>oa.a.U5:6>oa.a.V5}},JGd:{configurable:!0,enumerable:!0,get:function(){return this.Mkb}}});Object(u.a)(n,"EwaAccessTokenExpirationRefreshManager",null,[641,175,3]);var ra=b(202),db=b(162);l.kYb="ActivityDuration";l.error="Error";l.vlh=
"Errors";l.failed="Failed";l.KAh="FirstActivity";l.initialized="Initialized";l.Ppi="LastActivity";l.Wgj="RetryOverride";l.Iej="RequestGroups";l.requests="Requests";l.CSf="Responses";l.Yuc="SessionDuration";l.status="Status";l.success="Success";l.Tna="Successful";l.vO="Tokens";Object(u.a)(l,"SessionExpirationStrings",null,[]);var Ka=b(108);k.prototype.agg=function(){var V={};x.ULS.sendTraceTag(41964821,217,50,x.ULS.xc((V.Aggregate=this.tX,V.Current=this.zo,V)))};k.prototype.Q$h=function(){this.tX[l.Iej]=
0;this.tX[l.requests]=0;this.tX[l.CSf]=0;this.tX[l.status]=l.initialized;this.tX[l.KAh]=new Date;this.tX[l.Yuc]=0;this.tX[l.kYb]=0;this.tX[l.Yuc]=0;this.zo[l.Yuc]=0;this.tX[l.kYb]=0;this.zo[l.kYb]=0};k.prototype.ekd=function(V,Ia){var Ha=V[Ia];Ha=Ha?Ha:0;Ha++;V[Ia]=Ha;this.TNd(V)};k.prototype.TNd=function(V){var Ia=new Date;V[l.kYb]=+Ia-+this.LTb;this.LTb=Ia;V[l.Yuc]=+this.LTb-+this.lvg;V[l.Ppi]=this.LTb};k.prototype.rcb=function(V,Ia){this.zo[V]=Ia;this.TNd(this.zo)};k.prototype.SXf=function(V,Ia){this.zo[V]=
Ia;this.TNd(this.zo)};k.prototype.incrementCounter=function(V){this.ekd(this.zo,V);this.ekd(this.tX,V);this.ekd(this.utg,V)};k.prototype.flush=function(){this.X8d||(this.tX[l.status]=this.zo[l.status],this.agg(this.YWb),this.ae.Pma(this.YWb,6E4*this.Wkf))};k.prototype.stop=function(){x.ULS.sendTraceTag(41964822,217,100,"Stopping logger. Flushing one last time");this.flush();this.X8d=!0;this.ae.Dp(this.YWb)};Object(u.a)(k,"SessionLogger",null,[724]);var Ga=b(99),xa=b(739),da=b(391),qa=b(170),na=b(1147),
ia=b(190),ta=b(172);e.prototype.lMi=function(V){if(V.MessageId!==qa.a.jjd)ta.a(39408099,306,15,"Unexpected message.");else{var Ia=new ra.a,Ha=new ra.a;this.Wi.incrementCounter(l.CSf);var ob=V.Values[da.a.$Wf];if(!ob||0>=ob.length)ta.a(40122317,306,15,"Found no tokens in the dictionary"),ob=V.Values;ta.a(40122318,306,100,"The Tokens array contains {0} tokens",ob.length);this.Wi.rcb("Correlation",V.CorrelationId);for(var ib="",La=0;La<ob.length;La++){this.Wi.SXf(l.vO,ob.length);var zb=ob[La],Fb=zb;
if(Fb&&Fb.Name){this.Wi.incrementCounter(Fb.Name);var Yb=zb;if(Yb&&Yb.Value)ta.a(39408128,306,100,"Received token with name: {0}",Yb.Name),Ia.add(Yb),this.hXb.add(Yb),this.Wi.rcb(l.status,l.success),this.K4d&&this.gT&&this.gT.Ifj();else if(zb=this.bWh(zb),ta.a(39408129,306,15,"Received error for token {0}. Creating error object from {1}, TaskId {2}",Fb.Name,JSON.stringify(zb),this.ega),Ha.add(zb),this.PS.add(zb),ib=JSON.stringify(zb),this.Wi.rcb(l.error,JSON.stringify(zb)),this.Wi.rcb(l.status,l.failed),
this.K4d)for(Fb=bk(zb.Errors),zb=Fb.next();!zb.done;zb=Fb.next())zb=this.cNh(zb.value),this.gT&&this.gT.RCg(zb)}}0<Ha.count&&""!==ib?(ob=Object.assign(new ia.a,{extendedProperties:new Map}),ob.extendedProperties.set("Errors",ib),Ga.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",!1,!1,ob)):Ga.Health.instance.recordKpiSuccess("WACTokenRefresh",null);ta.a(39408130,306,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",Ia.count,Ha.count,
V.CorrelationId,this.ega);0<Ha.count&&!this.Xgc(Ha)?(V=this.j9.wVh(Ha),V!==this.j9.NKd&&(this.Wi.SXf(l.Wgj,V),this.ae.Pma(this.Di,V))):(this.Wi.flush(),this.Di&&(ta.a(39408131,306,100,"Deleting task {0} from task manager",this.Di.name),this.ae.Dp(this.Di)),this.Wl&&!this.Wl.task.isCompleted&&this.Wl.setResult(new f(Ia,Ha)))}};e.prototype.bWh=function(V){if(!V)return null;var Ia=Object.assign(new v,{Name:V.Name,Errors:[]});V=bk(V.Errors);for(var Ha=V.next();!Ha.done;Ha=V.next()){Ha=Ha.value;var ob=
new y;ob.Id=Ha.Id;ob.Details=this.aWh(Ha.Details);Ia.Errors.push(ob)}return Ia};e.prototype.aWh=function(V){if(!V)return"";var Ia=V.toString().toLowerCase();return 0<Ia.indexOf("<!doctype")?this.ffd("Seems to contain HTML - Contains <!DOCTYPE"):0<Ia.indexOf("<html")?this.ffd("Seems to contain HTML - Contains <html>"):500<Ia.length?this.ffd(String.format("Error details content too long: Length: {0}",Ia.length)):V};e.prototype.ffd=function(V){return String.format("{0} - Reason: [{1}]","### REDACTED ###",
V)};e.prototype.requestTokensOnce=function(){this.LRf()};e.prototype.LRf=function(){A.AFrameworkApplication.Pjc("SendSynchronousPostMessage;SendSynchronousPostMessageIsEnabledCf");this.Rqa>=this.j9.Xyi?(ta.a(39408132,306,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",this.ega),this.vCe(this.Wl,"TOO_MANY_ATTEMPTS","We did not receive a new token from the host after the maximum allowed number of attempts")):(Ga.Health.instance.recordKpiUsage("WACTokenRefresh",1,"wwrelfc",null),this.Klj())};
e.prototype.Klj=function(){var V={};V[da.a.$Wf]=this.j9.vO;var Ia=P.a.create().toString();ta.a(39408133,306,50,"Refreshing tokens {0}. Attempt {1}. Correlation {2}. TaskId {3}.",JSON.stringify(this.j9.vO),this.Rqa+1,Ia,this.ega);this.Kce.execute(function(Ha){Ha.uj(qa.a.kpe,V,Ia)});this.Rqa++;this.Wi.incrementCounter(l.requests)};e.prototype.vCe=function(V,Ia,Ha){for(var ob=new ra.a,ib=0;ib<this.j9.vO.length;ib++){var La=Object.assign(new v,{Name:this.j9.vO[ib],Errors:[Object.assign(new y,{Id:Ia,Details:Ha})]});
ob.add(La);this.PS.add(La)}this.ae.Dp(this.Di);this.Wi.rcb(l.vlh,JSON.stringify(this.PS));this.Wi.rcb(l.status,l.failed);V&&!V.task.isCompleted&&V.setResult(new f(new ra.a,this.PS))};e.prototype.L6i=function(V,Ia){var Ha=this;Ia=void 0===Ia?null:Ia;this.khe.start();this.FTb=V;this.ega=P.a.create().toString();ta.a(41755338,306,50,"RefreshTokens Start, TaskId: [{0}]. IsTokenExpiring: [{1}].",this.ega,this.FTb);this.Rqa=0;this.PS.clear();this.hXb.clear();var ob=new db.a;this.Wl=ob;Ia&&Ia.R(function(){var ib=
!!ob&&!ob.task.isCompleted;ta.a(588096223,306,50,"RefreshTokens Cancelled, TaskId: [{0}]. IsTokenExpiring: [{1}]. isTaskStillRunning [{2}].",Ha.ega,Ha.FTb,ib);ib&&Ha.vCe(ob,"ABORTED_BY_CALLER","The refresh was aborted by the caller")});this.Di=new Ka.a(this.j9.priority,2,this.j9.NKd,Object(D.a)(this,this.requestTokensOnce,"requestTokensOnce"),98,qa.a.kpe,!0);this.fvg&&this.LRf();this.ae.Dg(this.Di);return this.Wl.task};e.prototype.$0i=function(V){this.khe.stop();var Ia=this.k4h(V.result.errors);x.ULS.sendTraceTag(41755339,
217,50,"ProcessTokensOrErrors: TokenRefreshResult:{0},TaskId:{1},IsTriggerByTokenExpiring:{2},RetryCount:{3},TotalErrorCount:{4},LastErrorName:{5},LastErrorId:{6},LastErrorDetail:{7}",!Ia,this.ega,this.FTb,this.Rqa,this.PS.count,0<V.result.errors.count?V.result.errors.na(0).Name:"",0<V.result.errors.count&&0<V.result.errors.na(0).Errors.length?V.result.errors.na(0).Errors[0].Id:"",0<V.result.errors.count&&0<V.result.errors.na(0).Errors.length?V.result.errors.na(0).Errors[0].Details:"");return Ia?
!1:this.Z0i(V.result.vO)};e.prototype.Xgc=function(V){return this.j9.Xgc(V)};e.prototype.Z0i=function(V){for(var Ia=0;Ia<V.count;Ia++){var Ha=V.na(Ia);if(Ha.Name===da.a.accessToken){var ob=(new Date).getTime();if(Ha.Expiry>A.AFrameworkApplication.mk){var ib={};x.ULS.sendTraceTag(39706827,217,50,"Updating AccessToken: {0}",(ib.AccessTokenTtl=Ha.Expiry,ib.NowGetTime=ob,ib.BootTime=A.AFrameworkApplication.eha,ib),"PreviousAccessTokenTtl",A.AFrameworkApplication.mk);A.AFrameworkApplication.accessToken=
Ha.Value;A.AFrameworkApplication.mk=Math.floor(Ha.Expiry);A.AFrameworkApplication.NZd=ob;A.AFrameworkApplication.JXa=Math.floor(Ha.Expiry)}else ib={},x.ULS.sendTraceTag(39706828,217,15,"Ignoring AccessToken because it expires sooner than the current one: {0}",(ib.AccessTokenTtl=Ha.Expiry,ib.NowGetTime=ob,ib.BootTime=A.AFrameworkApplication.eha,ib),"PreviousAccessTokenTtl",A.AFrameworkApplication.mk)}}return!0};e.prototype.k4h=function(V){for(var Ia=!1,Ha=0;Ha<V.count;Ha++){Ia=!0;var ob=V.na(Ha);x.ULS.sendTraceTag(39706829,
217,15,"Received error for token {0}. Errors: {1}. TaskId: {2} ",ob.Name,JSON.stringify(ob.Errors),this.ega)}return Ia};e.prototype.cNh=function(V){var Ia=I.a.Xuc;V=parseInt(V.Id);if(isNaN(V))Ia=I.a.MWj;else{switch(V){case 401:Ia=I.a.PWj;break;case 403:Ia=I.a.KWj;break;case 500:Ia=I.a.LWj;break;case 503:Ia=I.a.OWj}Ia===I.a.Xuc&&(Ia=500<V?I.a.NWj:I.a.JWj)}return Ia};Object(u.a)(e,"TokenRefreshManager",null,[637]);d.prototype.Xgc=function(V){V=JSON.stringify(V);if(this.pSc&&0<this.pSc.length)for(var Ia=
bk(this.pSc),Ha=Ia.next();!Ha.done;Ha=Ia.next())if(Ha=Ha.value,0<Ha.length&&0<=V.indexOf(Ha))return!0;return!1};d.prototype.wVh=function(V){try{if(V)for(var Ia=bk(V),Ha=Ia.next();!Ha.done;Ha=Ia.next()){var ob=Ha.value;if(ob.Errors)for(var ib=bk(ob.Errors),La=ib.next();!La.done;La=ib.next()){var zb=La.value;if(zb.Id in this.Vde)return Number.parseInvariant(this.Vde[zb.Id].toString())}}}catch(Fb){x.ULS.sendTraceTag(41501720,217,50,"TokenRefreshPolicy:GetRetryIntervalOverride, exception:{0}",Fb.toString())}return this.NKd};
d.prototype.Crj=function(){var V={};try{if(!A.AFrameworkApplication.rcc()||0>=A.AFrameworkApplication.rcc().length||""===A.AFrameworkApplication.rcc()[0])return V;for(var Ia=bk(A.AFrameworkApplication.rcc()),Ha=Ia.next();!Ha.done;Ha=Ia.next()){var ob=Ha.value;0<ob.length&&(V[ob]=A.AFrameworkApplication.RWj)}}catch(ib){x.ULS.sendTraceTag(41755340,217,50,"TokenRefreshPolicy:SetRetryIntervalForNetworkIssue, exception:{0}",ib.toString())}return V};Object(u.a)(d,"TokenRefreshPolicy",null,[638]);var za=
z.a;Rk(c,za);c.prototype.create=function(){A.AFrameworkApplication.$M("Microsoft.Office.Excel.Server.Flighting.IDenyListRefreshAccessTokenSilentlyV2_ManagerCreated");A.AFrameworkApplication.fa.qa("RefreshAccessTokenSilently")?this.pb(this.L5g()):this.pb(this.$.da.za(38)||this.$.da.Ga(38,new w(this.$)))};c.prototype.L5g=function(){var V=this.$.da.za(38);if(V)return V;V=new e(A.AFrameworkApplication.yi,A.AFrameworkApplication.$U(),new d);return this.$.da.Ga(38,new n(this.$,V))};c.ka=function(V){V.da.Ga(39,
new c(V))};Object(u.a)(c,"AccessTokenExpirationManagerFactory",z.a,[]);var sa=b(10);b.d(E,"a",function(){return a})},1395:function(u,E,b){function a(){Type.registerNamespace("Common.App.AccessibilitySettings");c.main()}function c(){this.fb=null}function d(){this.HVa=null}function e(D){return String.format("{0}RoamingServiceHandler.ashx?action={1}&{2}",B.AFrameworkApplication.fa.appSettings.RoamingServiceHandlerWebServiceBase||"",D,B.AFrameworkApplication.Yi)}function k(D){var I=new w.a;B.AFrameworkApplication.qd.Yl(e(D),
1,null,null,!0,2,function(F){200===F.data.httpStatus?I.setResult("true"===F.data.Td.toLowerCase()):I.setResult(!1)},function(){I.setResult(!1)},null,void 0,void 0,void 0,void 0,"7");return I.task}function l(D,I){this.La=D;this.ZPb=I}function n(D){var I=r.call(this,!1,!1,!0)||this;I.ZPb=D;return I}u=b(0);var f=b(84),v=b(150),r=v.a;Rk(n,r);n.prototype.start=function(){var D={},I={};D=(I.id="AccessibilitySettingsDialog",I.bodyControls=(D.tooltipPersistenceEnabled=this.ZPb.L7e,D),I);this.initializeAndShow("",
Object(f.a)(this,this.Hgj,"resultHandler"),D)};n.prototype.Hgj=function(D,I){1===D&&(this.ZPb.L7e=I.tooltipPersistenceEnabled)};Object(u.a)(n,"AccessibilitySettingsDialog",v.a,[]);var y=b(107),m=b(25);l.prototype.Bg=function(){this.La.Mb(m.a.ayj,y.a.frame,Object(f.a)(this,this.byj,"showAccessibilitySettingsDialogHandler"))};l.prototype.byj=function(){(new n(this.ZPb)).start();return 32};Object(u.a)(l,"AccessibilitySettingsDialogActor",null,[548]);var w=b(162),B=b(4),A=b(167);d.prototype.ksi=function(){var D=
this,I=new w.a;if(this.HVa)I.setResult(this.HVa);else if(this.nff()){var F=k("getHoverableRibbonTooltipIsEnabled");F.continueWith(function(){D.HVa=F.result;A.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(F.result);I.setResult(F.result)},8)}else I.setResult(!1)};d.prototype.nff=function(){var D=B.AFrameworkApplication.fa.qa("IsRoamingServiceEnabled"),I=B.AFrameworkApplication.fa.qa("IsAnonymousUser");return D&&!I};Mf.Object.defineProperties(d.prototype,{L7e:{configurable:!0,
enumerable:!0,get:function(){return!!this.HVa},set:function(D){D!==this.HVa&&(this.HVa=D,A.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(D),this.nff()&&B.AFrameworkApplication.qd.Yl(e("saveHoverableRibbonTooltipIsEnabled"),2,D.toString().toLowerCase(),null,!0,2,null,null,null,void 0,void 0,void 0,void 0,"8"))}}});Object(u.a)(d,"AccessibilitySettingsInfo",null,[546]);var z=b(254),x=b(172);c.prototype.Ph=function(D){var I=this;this.fb=D;this.fb.register(d,"Common.App.AccessibilitySettings.AccessibilitySettingsInfo").as("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo").Cc(function(){return new d}).tc();
this.fb.register(l,"Common.App.AccessibilitySettings.AccessibilitySettingsDialogActor").as("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor").Cc(function(){return new l(B.AFrameworkApplication.ub,I.fb.mh("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"))}).tc()};c.prototype.init=function(){var D=this.fb.mh("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"),I=this.fb.mh("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor");D&&I?(I.Bg(),D.ksi()):
x.a(539637639,200,15,"Failed to resolve IAccessibilitySettingsDialogActor or IAccessibilitySettingsInfo. A11y dialog feature is not enabled.")};c.prototype.dispose=function(){};c.main=function(){z.a.instance.Qi(new c)};Mf.Object.defineProperties(c.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.AccessibilitySettings"}}});Object(u.a)(c,"AccessibilitySettingsPackage",null,[10,11]);b.d(E,"a",function(){return a})},1401:function(u,E,b){function a(){n.a.Fa(function(ia){ia.da.Ga(134,
new c(ia));ia.da.Ga(330,new na.a(ia))})}function c(ia){var ta=qa.call(this)||this;ta.tableManager=null;ta.$=ia;ta.Eb();return ta}function d(ia){var ta=da.call(this,M.g(ia))||this;ta.lpb=null;ta.Syc=null;ta.I0=null;ta.npb=null;ta.cpe=!1;ta.p9d=null;ta.ARb=0;ta.l5b=null;ta.$_b=function(){var za={},sa=ta.dfd(),V;for(V in sa){var Ia=sa[V];if(Ia){var Ha=ta.$Xh(Ia);if(Ha){if(Ha in ta.mFa){var ob=ta.mFa[Ha];if(ob.fB){ob.Mn.equals(Ia)||(ob.Mn=Ia);delete ta.mFa[Ha];za[Ha]=ob;continue}}(ob=l.createInstance(M.g(ta.$),
Ia,ta.kHh(),ta))?za[Ha]=ob:v.ULS.sendTraceTag(537151239,0,15,"TableManager.AttachTableResizeBehavior - Attaching Grippie Failed for Range {0}",Ia.aB(!1))}}}ta.b2b(null,null);ta.cQb=za};ta.b2b=function(){var za=ta.mFa,sa;for(sa in za){var V=sa,Ia=za[sa];Ia&&(Ia.dispose(),delete ta.mFa[V])}ta.cQb={}};ta.yKf=function(){ta.b2b(null,null);ta.$_b(null,null)};ta.onFocus=function(){ta.p9d=M.g(ta.$).ha.sa.activeCell};ta.Z5=function(){ta.$.isEditMode&&ta.Ch(null,null)};ta.Ch=function(){!ta.cpe&&G.c(ta.$,ta.gridView.ha.sa.activeCell)&&
ta.vsi()};ta.KV=function(){ta.Rxb(1);ta.$.ea.mn(ta.KV)};ta.eGb=function(){ta.cpe=!0;ta.Syc=new e(ta.$)};ta.$=ia;ta.gridView=M.g(ta.$);ta.$.da.Ga(66,ta);ta.cQb={};ta.$_b(null,null);ta.$.va&&ta.$.va.If(ta.yKf);ta.$me(ta.$_b);ta.$.ea.o2(ta.Z5);ta.gridView.ha.hJ(ta.Ch);ta.$.isEditMode&&ta.Ch(null,null);return ta}function e(ia){var ta=xa.call(this,document.createElement("div"))||this;ta.zQ=!1;ta.PEf=!1;ta.Hmd=!1;ta.TSc=!1;ta.LJb=null;ta.Ch=function(){G.c(ta.$,ta.gridView.ha.sa.activeCell)?(ta.uLa=!0,ta.Qqb(!1)):
(ta.uLa=!1,ta.L4=!1,ta.Zag())};ta.Xs=function(){ta.uLa?ta.Qqb(!0):ta.L4=!1};ta.Ftf=function(){ta.TSc=!0;ta.uLa&&(ta.L4=!1)};ta.onContentReady=function(){ta.$.isEditMode?G.c(ta.$,ta.gridView.ha.sa.activeCell)&&(ta.uLa=!0,ta.Qqb(!1)):ta.L4=!1};ta.PDb=function(){ta.TSc=!1;ta.uLa?ta.Qqb(!1):ta.L4=!1};ta.ef=function(za,sa){ta.uLa&&(za=ta.gridView.Moc(sa.Zc.block.ie.BlockCachePosition.PaneType).cG(sa.Zc.hash))&&(za.QId(ta.GKa),za.TUc(ta.GKa))};ta.GKa=function(){ta.pQf()};ta.$=ia;ta.gridView=M.g(ta.$);ta.parentElement=
ta.domElement;ta.parentElement.className=k.Jrh;ta.rKa=ta.gridView.yj;ta.uLa=!0;ta.x$h();ta.CLg();ta.Qqb(!1);v.ULS.sendTraceTag(537151201,0,50,"TableTotalRowOptions - React Component Created ");return ta}function k(){}function l(ia,ta,za,sa){var V=va.call(this,ia)||this;V.m7f=[6];V.g7f=[26];V.Ar=null;V.$hc=!1;V.qzb=!1;V.Vaa=null;V.Ws=null;V.onPointerDown=function(Ia){if(1!==V.$.Ka.bH())return!0;Ia=ja.a(V.$).Rd(Ia);if(V.fB)return!0;var Ha=X.a(V.$).Hnd||X.a(V.$).Kp();if(V.Dpd||Ha)return V.nbb(),!0;V.Ws=
V.Mn;V.wHd();V.Tid();Ha=2===Ia.lb&&Ia.Hn===Sys.UI.MouseButton.leftButton;var ob=3===Ia.lb;if(Ha||ob)Ia=V.ha.Kn(Ia.clientPoint,Ia.zb,5,void 0,void 0,!0),Ia||(Ia=V.Ws),V.qzb=Ha,V.$hc=ob,V.Ws=V.w2e(Ia),V.Tid(),Ha?V.T7i():ob&&V.G8i(),ca.b(V.$,!0);return!0};V.ai=function(Ia){Ia=ja.a(V.$).Rd(Ia);if(!V.fB)return!1;if(Ia=V.qzb?V.ha.Kn(Ia.clientPoint,Ia.zb,5,void 0,void 0,!0):V.ha.Kn(Ia.clientPoint,Ia.zb,5,!0,!1,!0))Ia=V.w2e(V.DYa(Ia)),V.G0b(Ia.bottomRight),V.Ws.equals(Ia)||(V.Ws=Ia,V.GHb(!1),V.wHd(!1),V.Tid(!1),
V.c6h(),V.qb.update(!1)),V.oQj(V.Ws);return!0};V.Bf=function(Ia){ja.a(V.$).Rd(Ia);if(!V.fB)return!1;V.resizeTable();V.nbb();return!0};V.aFb=function(Ia){ja.a(V.$).Rd(Ia);if(!V.fB)return v.ULS.shipAssertTag(537151233,0,!0,"TableResizeBehavior.OnTouchUp - OnTouchUp Called without Operation in Progress"),!1;V.resizeTable();V.nbb();return!0};V.sca=function(Ia){ja.a(V.$).Rd(Ia);V.nbb();return!0};V.Btf=function(){V.fB&&V.nbb()};V.gridView=ta;V.$=ta.$;V.tableManager=sa;V.ha=ta.ha;V.qb=ta.qb;V.parentElement=
ia;V.lRg();y.a.Wo||y.a.rka||Q.a.instance.ra(P.a.pointerDown,V.Vaa,V.onPointerDown);V.Mn=za;V.Dpd=!1;V.RKc=!1;V.tableManager.yDg(V.Btf);return V}var n=b(10);u=b(0);var f=b(232),v=b(14),r=b(89),y=b(27),m=b(440),w=b(1326),B=b(570),A=b(189),z=b(234),x=b(24),D=b(64),I=b(45),F=b(169),G=b(248),T=b(47),O=b(44),U=b(12),J=b(69),H=b(129),K=b(1),N=b(11),M=b(21),C=b(354),Q=b(245),P=b(13),ka=b(161),R=b(94),fa=b(5),ca=b(257),ea=b(76),wa=b(95),X=b(42),ja=b(33),va=R.a;Rk(l,va);l.prototype.dispose=function(){this.nbb();
this.tableManager.I$i(this.Btf);this.pgf||y.a.Wo||y.a.rka||Q.a.instance.Ba(P.a.pointerDown,this.Vaa,this.onPointerDown);if(this.fB){ca.b(this.$,!1);try{this.qv()}catch(ia){v.ULS.sendTraceTag(537151236,0,10,"TableResizeBehavior.Dispose: Unregistering of Handlers failed with Exception {0}",ia)}}this.parentElement&&this.parentElement.contains(this.Vaa)&&this.parentElement.removeChild(this.Vaa);this.Vaa=this.parentElement=null;va.prototype.dispose.call(this)};l.prototype.w2e=function(ia){var ta=ia.bottom-
this.Mn.topLeft.bottom-1;return 0<=ia.right-this.Mn.topLeft.right+1&&0<=ta&&ia.bottom>=this.Mn.top&&ia.right>=this.Mn.left?new x.Range(this.Mn.top,this.Mn.left,ia.bottom,ia.right,!1,!1):this.Ws};l.prototype.Tid=function(ia){this.zvc([this.Ws],6,void 0===ia?!0:ia);this.qb.qn(this.m7f)};l.prototype.GHb=function(ia){ia=void 0===ia?!0:ia;this.qb.eh(this.m7f);this.zvc([null],6,ia)};l.prototype.wHd=function(ia){ia=void 0===ia?!0:ia;this.qb.eh(this.g7f);this.zvc([null],26,ia)};l.prototype.c6h=function(){var ia=
!1;ia=void 0===ia?!0:ia;var ta=this.VGj();0<ta.length&&(this.zvc(ta,26,ia),this.qb.qn(this.g7f))};l.prototype.VGj=function(){var ia=[];this.Mn.contains(this.Ws)&&(this.Mn.right!==this.Ws.right&&ia.push(new x.Range(this.Mn.top,this.Ws.right+1,this.Ws.bottom,this.Mn.right,!1,!1)),this.Mn.bottom!==this.Ws.bottom&&ia.push(new x.Range(this.Ws.bottom+1,this.Mn.left,this.Mn.bottom,this.Mn.right,!1,!1)));return ia};l.prototype.resizeTable=function(){if(!this.Ws.equals(this.Mn)){var ia=new x.Range(this.Mn.top,
this.Mn.left,this.Ws.bottom,this.Ws.right,!1,!1);this.MLj(ia);this.Dpd=!0}};l.prototype.onKeyDown=function(ia){ja.a(this.$).Rd(ia);return!0};l.prototype.i9a=function(){this.pgf&&(y.a.Wo||y.a.rka||(Q.a.instance.ra(P.a.pointerDown,this.Vaa,this.onPointerDown),this.Vaa.classList.remove("ewr-table-resize-default-cursor"),this.RKc=this.Vaa.disabled=!1),this.RKc=!1)};l.prototype.lRg=function(){var ia=document.createElement("div");ia.className="ewr-table-resize-handle";var ta=document.createElement("div");
ta.className="ewr-table-resize-fillhandle-higher";var za=document.createElement("div");za.className="ewr-table-resize-fillhandle-broader";ia.appendChild(ta);ia.appendChild(za);this.Vaa=ia;this.parentElement.appendChild(this.Vaa)};l.prototype.G0b=function(ia){var ta=this,za=this.Ws.contains(ia),sa=ia.top,V=ia.bottom,Ia=ia.left;ia=ia.right;var Ha=null;if(za){if(this.gridView.QQ(this.Mn.topLeft)&&!this.Mn.Kna)return;sa=Math.max(1,V-5,this.Mn.top);Ia=Math.max(1,ia-5,this.Mn.left);V=sa;ia=Ia;Ha=new x.Range(sa,
Ia,sa,Ia,!1,!1)}else V+=5,ia+=5,sa=V,Ia=ia,Ha=new x.Range(V,ia,V,ia,!1,!1);this.gridView.QQ(Ha)||(this.Ar?this.Ar.Lp||(this.Ar=T.a.instance.create(function(){ta.gridView.fr(Ha,60,wa.a.j7f)},40,O.a.k7f)):this.Ar=T.a.instance.create(function(){ta.gridView.fr(Ha,60,wa.a.j7f)},40,O.a.k7f))};l.prototype.DYa=function(ia){var ta=ia;if(this.gridView.eb.p4){if(!this.gridView.Ub(ia.topLeft)){var za=this.gridView.Xj("TableResizeBehavior.AdjustHiddenRowColumns",this.gridView.YG,this.Ws.top!==ia.top?1:2);try{za.Wk=
this.Ws.top<ia.top||this.Ws.left<ia.left,za.Tr(ia.topLeft),ta=za.$$cu().range}finally{za&&za.dispose()}}ta.right=ta.left+ia.width-1;ta.bottom=ta.top+ia.height-1}return ta};l.prototype.zvc=function(ia,ta,za){za=void 0===za?!0:za;var sa=[];ia=bk(ia);for(var V=ia.next();!V.done;V=ia.next())sa.push(new C.a(V.value,D.d(this.$.pa)));this.qb.Fw(sa,[ta],!0,void 0,za)};l.prototype.T7i=function(){for(var ia=bk(this.gridView.en),ta=ia.next();!ta.done;ta=ia.next())Q.a.instance.ra(P.a.Rj,ta.value.domElement,this.ai);
Q.a.instance.ra(P.a.Df,document.documentElement,this.Bf);this.YGe()};l.prototype.G8i=function(){for(var ia=bk(this.gridView.en),ta=ia.next();!ta.done;ta=ia.next())ka.a.instance.ra(P.a.lg,ta.value.domElement,this.ai);ka.a.instance.ra(P.a.pe,document.documentElement,this.aFb);this.YGe()};l.prototype.qv=function(){this.qzb&&this.EOj();this.$hc&&this.POj()};l.prototype.EOj=function(){for(var ia=bk(this.gridView.en),ta=ia.next();!ta.done;ta=ia.next())Q.a.instance.Ba(P.a.Rj,ta.value.domElement,this.ai);
Q.a.instance.Ba(P.a.Df,document.documentElement,this.Bf);this.oMf()};l.prototype.POj=function(){for(var ia=bk(this.gridView.en),ta=ia.next();!ta.done;ta=ia.next())ka.a.instance.Ba(P.a.lg,ta.value.domElement,this.ai);ka.a.instance.Ba(P.a.pe,document.documentElement,this.aFb);this.oMf()};l.prototype.YGe=function(){Q.a.instance.ra(P.a.fy,document.documentElement,this.sca);this.gridView.$b.x7b(!0)};l.prototype.oMf=function(){Q.a.instance.Ba(P.a.fy,document.documentElement,this.sca);this.gridView.$b.x7b(!1)};
l.prototype.MLj=function(ia){var ta={};ia=(ta.ResizeTableRange=ia,ta.OriginalTableRange=this.Mn,ta);this.$.Fd(-1400250766,ea.a.Cb,30,ia)};l.prototype.oQj=function(ia){if(!this.Mn.contains(ia)){ia=this.UGj();ia=bk(ia);for(var ta=ia.next();!ta.done;ta=ia.next())if(this.tableManager.cqd(ta.value)){this.gridView.hg.vo(fa.a.eDi);return}}this.gridView.rtl?this.gridView.hg.vo(fa.a.iCi):this.gridView.hg.vo(fa.a.tEi)};l.prototype.nbb=function(){if(this.fB){ca.b(this.$,!1);try{this.qv()}catch(ia){v.ULS.sendTraceTag(537151232,
0,10,"TableResizeBehavior.Dispose: Unregistering of Handlers failed with Exception {0}",ia)}}this.Ar&&(this.Ar.cancel(),this.Ar.dispose());this.$hc=this.qzb=!1;this.GHb();this.wHd();ca.b(this.$,!1);this.gridView.hg.vo(fa.a.m4)};l.prototype.UGj=function(){var ia=[];this.Mn.right!==this.Ws.right&&ia.push(new x.Range(this.Mn.top,this.Mn.right+1,this.Ws.bottom,this.Ws.right,!1,!1));this.Mn.bottom!==this.Ws.bottom&&ia.push(new x.Range(this.Mn.bottom+1,this.Mn.left,this.Ws.bottom,this.Mn.right,!1,!1));
return ia};l.createInstance=function(ia,ta,za,sa){if(!ta)return null;var V=ia.qb;V.Fw(za,[27],!0);V.qn(l.PGj);za=V.cw(27,ia.eb.dj(ta.bottomRight),l.tMh(ta,za)).mf;return new l(za,ia,ta,sa)};l.tMh=function(ia,ta){for(var za,sa=0;sa<ta.length;sa++)if((null===(za=ta[sa])||void 0===za?0:za.range)&&ta[sa].range.equals(ia))return sa;return 0};Mf.Object.defineProperties(l.prototype,{fB:{configurable:!0,enumerable:!0,get:function(){return this.qzb||this.$hc}},pgf:{configurable:!0,enumerable:!0,get:function(){return this.RKc}}});
l.PGj=[27];Object(u.a)(l,"TableResizeBehavior",R.a,[]);var ua=b(7);R=b(244);k.Jrh="ewa-ttrd-buttonarea";Object(u.a)(k,"CssClassNames",null,[]);var Xa=b(48),aa=b(133),ba=b(91),oa=b(22),ra=b(15),db=b(265),Ka=b(134),Ga=b(274),xa=R.a;Rk(e,xa);e.prototype.dispose=function(){this.$&&this.Bdh();this.$=this.gridView=this.parentElement=this.rKa=null;xa.prototype.dispose.call(this)};e.prototype.lKh=function(ia){var ta=this.$Yh(this.gridView.Ub(null).range);return ta?String.format("=SUBTOTAL({0},{1})",ia,ta):
null};e.prototype.$Yh=function(ia){var ta=M.g(this.$).Ab.dk(ia);if(!ta)return null;ta=F.a(ta,!1);ta.right=ta.left=ia.left;return ta.toString()};e.prototype.x$h=function(){e.TL={};e.TL["100"]=ra.a.instance.ga(1082);e.TL["101"]=ra.a.instance.ga(1085);e.TL["102"]=ra.a.instance.ga(1084);e.TL["103"]=ra.a.instance.ga(1089);e.TL["104"]=ra.a.instance.ga(1086);e.TL["105"]=ra.a.instance.ga(1087);e.TL["109"]=ra.a.instance.ga(1083);e.TL["107"]=ra.a.instance.ga(1090);e.TL["110"]=ra.a.instance.ga(1092);e.TL["111"]=
ra.a.instance.ga(1143)};e.prototype.WVi=function(){var ia=this.gridView.Ub(null);if(ia&&(ia=ia.ME?ia.formulaBarText:null))if("=SUBTOTAL("===ia.substring(0,10)){if(ia=ia.substring(10,13),ia in e.TL)return ia}else return"111";return"100"};e.prototype.CLg=function(){this.gridView.Ea.Ds(this.ef);this.gridView.ha.hJ(this.Ch);this.gridView.yu(this.onContentReady);this.gridView.$b.Ak(this.Ftf);this.gridView.$b.tm(this.PDb)};e.prototype.Bdh=function(){this.gridView&&(this.gridView.ha&&(this.gridView.ha.PN(this.Ch),
this.gridView.Ea.Dq(this.ef)),this.gridView.jy(this.onContentReady),this.gridView.$b&&(this.gridView.$b.vk(this.Ftf),this.gridView.$b.Nl(this.PDb)),this.Zag())};e.prototype.Qqb=function(ia){this.zQj(ia);this.iAb&&(this.sFj(),this.nmb?(this.PEf||this.NLg(),this.TSc?this.L4=!1:(this.L4=!0,this.pQf())):(v.ULS.sendTraceTag(537151199,0,15,"TableTotalRowOptions.CreateAndShowDropdownInUpdatedPosition : Offset bounds could not be determined"),this.L4=!1))};e.prototype.pQf=function(){var ia=this;appChrome.renderTableTotalRowOptions(this.parentElement,
e.TL,e.TL[this.WVi()].toString(),Math.round(ja.a(this.$).hi(17)),function(ta){v.ULS.sendTraceTag(537151198,0,50,"TableTotalRowOptions.RenderReactTotalRowDropdown - Selected Option : {0}",ta);var za={};za=(za.SelectedOption=e.TL[ta],za.FunctionKeyCode=ta,za.Location="canvas",za);Ka.b(ia.$).yd(aa.a.ZGj,za,null,!0);if("111"===ta)return ia.Yci(),!0;if("100"!==ta){ia.LJb=ia.lKh(ta);if(!ia.LJb)return v.ULS.sendTraceTag(537151197,0,50,"TableTotalRowOptions.RenderReactTotalRowDropdown - Selected Option was null"),
!0;ia.aRa(ia.LJb)}else ia.aRa("");U.DOMElementExtensions.setFocus(ia.gridView.Wb.textBox.domElement);return!0})};e.prototype.Yci=function(){v.ULS.sendTraceTag(537151196,0,50,"TableTotalRowOptions.InvokeMoreFunctionsDialog - More Functions dialog invoked");var ia=new ba.a(753860909,0,this.$.isEditMode?2:1,19,null);this.$.Ka.Kb(ia)};e.prototype.dva=function(ia){if(!ia)return null;var ta=this.gridView.$b.textBox.domElement;var za=0<U.DOMElementExtensions.getHeight(ta)&&0<U.DOMElementExtensions.getWidth(ta)&&
0<=ta.offsetTop&&0<=ta.offsetLeft;if(za)ta=U.DOMElementExtensions.dva(ta,this.gridView.yj);else{ta=this.gridView.getCellBounds(ia.cell);var sa=U.DOMElementExtensions.getBoundingClientRect(this.gridView.yj);ta=new Sys.UI.Bounds(ta.x-sa.x,ta.y-sa.y,ta.width,ta.height)}if(ta)if(za)2<ta.height&&2<ta.height&&(ta.x+=1,ta.y+=1,ta.height-=2,ta.width-=2);else if(za=M.g(this.$).LJ(ia.cell))za=za.width,sa=oa.a.equals(db.a.Qub(ia.cell,this.gridView.rtl),"right",!0),this.gridView.rtl&&sa&&(ta.x=ta.x+ta.width-
za),ia.Cka&&this.gridView.rtl===sa&&(ta.width=za);else return null;return ta};e.prototype.zQj=function(ia){var ta=this.nmb;if(ta){var za=17>=ta.height?ta.y:ta.y+ta.height-17-2;ta=this.Fii?this.gridView.rtl?ta.x:ta.x+ta.width-(17<ta.height?17:ta.height):this.gridView.rtl?ta.x-(17<ta.height?17:ta.height):ta.x+ta.width;var sa=ja.a(this.$).rja(new Sys.UI.Point(ta,za));this.parentElement.style.top=N.HelperMethods.jc(sa.y);this.parentElement.style.left=N.HelperMethods.jc(sa.x);ja.a(this.$).Xqj(this.parentElement);
ia&&(this.L4=this.gridView.hic(new Xa.a(ta,za)))}else this.L4=!1};e.prototype.NLg=function(){this.rKa.insertBefore(this.parentElement,this.rKa.firstChild);this.PEf=!0};e.prototype.sFj=function(){this.zQ||(this.gridView.view.Es(this.Xs),this.zQ=!0)};e.prototype.Zag=function(){this.zQ&&this.gridView.view&&(this.gridView.view.Fq(this.Xs),this.zQ=!1)};e.prototype.aRa=function(ia){var ta=this.gridView.Wb,za=this.gridView.Ub(null);za&&(ia=Object(ua.a)(new Ga.a,{Text:ia}),this.gridView.setCell(ia,za.range,
0,127,null),ta.endEdit(!0,"TableTotalRowOptions.SetCellContent",0))};Mf.Object.defineProperties(e.prototype,{L4:{configurable:!0,enumerable:!0,get:function(){return this.Hmd},set:function(ia){this.Hmd!==ia&&(this.Hmd=this.isVisible=ia)}},iAb:{configurable:!0,enumerable:!0,get:function(){return!!(this.$.Cd&16)}},Fii:{configurable:!0,enumerable:!0,get:function(){var ia=this.gridView.ha.sa.activeCell;return ia.right===ia.maxColumns}},nmb:{configurable:!0,enumerable:!0,get:function(){var ia=this.gridView.Ub(null);
return ia&&this.gridView.e5(ia.range)?this.dva(ia):(ia&&v.ULS.sendTraceTag(537151200,0,50,"TableTotalRowOptions.ActiveCellOffsetBounds - Active Cell not in viewport area"),null)}}});e.YGj="TableTotalRowDropDownIconButtonId";e.TL=null;Object(u.a)(e,"TableTotalRowOptions",R.a,[3]);var da=w.a;Rk(d,da);d.prototype.$me=function(ia){this.addHandler(w.a.vFd,ia)};d.prototype.HPf=function(ia){this.removeHandler(w.a.vFd,ia)};d.prototype.yDg=function(ia){this.addHandler("tce",ia)};d.prototype.I$i=function(ia){this.removeHandler("tce",
ia)};d.prototype.cqd=function(ia){return!!this.G_e(ia)};d.prototype.Vm=function(ia){return this.AUh(this.k0e(ia))};d.prototype.yub=function(ia){return this.k0e(ia)};d.prototype.C8i=function(ia){ia?(this.npb?this.npb!==ia&&(r.a.Ia(this.I0),this.I0=null,this.npb=ia):this.npb=ia,this.I0||(this.I0=H.a.instance.Sd(this.npb)),this.I0.Ym("focusin")||this.I0.ka("focusin",this.onFocus)):v.ULS.sendTraceTag(537151245,0,15,"TableManager.RegisterToTextboxFocusEvent empty textBoxDomElement recieved")};d.prototype.Dcf=
function(ia,ta){return ia?ia.Zaa&&ia.top===ta.top:(v.ULS.shipAssertTag(537151244,0,!!ia,"autofilterRange can't be null"),!1)};d.prototype.hva=function(ia){ia=this.lpb?I.I(ia,this.lpb):this.view.getRangeInformation(ia);return 0<ia.length&&Object(m.a)(z.PivotTableRange,ia[0])?ia[0]:null};d.prototype.nfi=function(ia,ta){return ia?!ia.Vfc&&!!ia.fM&&ia.fM.xd(ta):(v.ULS.shipAssertTag(537151243,0,!!ia,"Pivot table can't be null"),!1)};d.prototype.pli=function(ia,ta){return ia?!ia.Vfc&&!!ia.HW&&ia.HW.xd(ta):
(v.ULS.shipAssertTag(537151242,0,!!ia,"Pivot table can't be null"),!1)};d.prototype.PYb=function(ia){da.prototype.PYb.call(this,ia);if((ia=N.HelperMethods.R_e(ia))&&0<ia.length){this.lpb=Array(ia.length);for(var ta=0;ta<ia.length;ta++)this.lpb[ta]=A.a.pQ(ia[ta])}};d.prototype.zHb=function(){da.prototype.zHb.call(this);this.lpb=null};d.prototype.n3g=function(ia,ta){return this.zBe(ia,ta).returnValue};d.prototype.zBe=function(ia,ta){var za=this;var sa=!1;if(!ia||!ta)return{returnValue:!1,pY:sa};ia=
ia.clone();ia.right+=1;ia.left=ia.right;if(!ia.isValidRange)return{returnValue:!1,pY:sa};if(ia.top<ta.eb.Hi){var V=ia.clone();V.bottom>=ta.eb.Hi&&(V.bottom=ta.eb.Hi-1);if(!function(){var Ha=za.yBe(V,ta);sa=Ha.pY;return Ha}().returnValue)return{returnValue:!1,pY:sa}}if(ia.bottom>=ta.eb.Hi){var Ia=ia.clone();Ia.top<=ta.eb.Hi&&(Ia.top=ta.eb.Hi);if(!function(){var Ha=za.yBe(Ia,ta);sa=Ha.pY;return Ha}().returnValue)return{returnValue:!1,pY:sa}}return{returnValue:!0,pY:sa}};d.prototype.l7f=function(ia){(ia=
this.Vm(ia.topLeft))&&ia.toString()in this.mFa&&(this.mFa[ia.toString()].Dpd=!1)};d.prototype.A2i=function(){this.raiseEvent("tce")};d.prototype.Hh=function(ia,ta){if(!this.Syc)return!1;switch(ta){case -569786022:case 541421805:if(this.Syc.L4){var za=document.getElementById(e.YGj);za&&T.a.instance.create(function(){U.DOMElementExtensions.Sec(za,null)},0,O.a.SGj,!0,!0)}return!0;default:return!1}};d.prototype.dispose=function(){this.b2b(null,null);this.HPf(this.$_b);this.$.va.vg(this.yKf);this.$.Ol(this.b2b);
this.cQb=null;this.$.ea&&this.$.ea.b0(this.Z5);this.gridView.ha.PN(this.Ch);this.Syc=null;K.EwaSettings.ma(409)&&this.I0&&(r.a.Ia(this.I0),this.I0=null);da.prototype.dispose.call(this)};d.prototype.H3h=function(ia,ta,za,sa){var V=this.gridView.Ab.dk(new x.Range(ta,za,ta,za,!1,!1));if(this.l5b=V){var Ia=V.usedRange,Ha=ia.ctrlKey||y.a.isMac&&J.b(ia),ob=!ia.shiftKey&&Ha;ia=ia.shiftKey&&!Ha;K.EwaSettings.isChangeGateEnabled("OfficeVSO:5593089_TableSelectorsBugFixes")&&(M.g(this.$).ha.selectionType=3);
switch(sa){case 0:this.ARb=0;K.EwaSettings.isChangeGateEnabled("OfficeVSO:5501906_TableSelectionEnableShiftSelection")?(ta=this.E3c(ia,Ia.top,za,Ia.bottom,za),this.vOd(ta,ob,ia)):this.wOd(Ia.top,za,Ia.bottom,za,F.d(V),F.g(V),ob);break;case 1:this.ARb=1;K.EwaSettings.isChangeGateEnabled("OfficeVSO:5501906_TableSelectionEnableShiftSelection")?(ta=this.E3c(ia,ta,Ia.left,ta,Ia.right),this.vOd(ta,ob,ia)):this.wOd(ta,Ia.left,ta,Ia.right,!1,!1,ob);break;case 2:this.ARb=2;K.EwaSettings.isChangeGateEnabled("OfficeVSO:5501906_TableSelectionEnableShiftSelection")?
(ta=this.E3c(ia,Ia.top,Ia.left,Ia.bottom,Ia.right),this.vOd(ta,ob,ia)):this.wOd(Ia.top,Ia.left,Ia.bottom,Ia.right,F.d(V),F.g(V),ob);break;default:v.ULS.shipAssertTag(537151240,0,!1,"TableManager.HandleTableSelectorsSelection: Table Selector can not be of type: {0}",sa.toString());return}K.EwaSettings.isChangeGateEnabled("OfficeVSO:5501896_TableSelectionDragSelection")&&(M.g(this.$).ha.selectionType=3);v.ULS.sendTraceTag(527212953,0,50,"TableManager.handleTableSelectorsSelection: A table selector was clicked using hover arrows")}else v.ULS.shipAssertTag(537151241,
0,!1,"TableManager.HandleTableSelectorsSelection: Table for table selector selection can't be null")};d.prototype.Bvj=function(ia){var ta=this.l5b.usedRange;return this.Mef(ia)||1!==this.PHa&&this.Mef(new x.Range(ta.top,ia.left,ta.bottom,ia.right,!1,!1))?!0:!1};d.prototype.uFd=function(ia){return ia.Autofilters};d.prototype.yBe=function(ia,ta){var za=!1;var sa=ta.eb.dj(ia),V=ta.Cf(sa).Ug;if(!V)return v.ULS.sendTraceTag(537151238,0,15,"TableManager.CouldExpandImpl - loadedRange is null. PaneType={0}",
sa),{returnValue:!1,pY:za};if(!V.ze(ia))return{returnValue:!0,pY:za};ia=ta.Xj("TableManager.CouldExpandImpl",ia,2);try{for(;ia.$$mn();){if(ia.$$cu().text||ia.yn.O5e)return za=!0,{returnValue:!1,pY:za};if(ia.$$cu().ZE)return{returnValue:!1,pY:za}}}finally{ia&&ia.dispose()}return{returnValue:!0,pY:za}};d.prototype.AUh=function(ia){if(!ia)return null;var ta=new B.AutofilterRange(ia.top,ia.left,ia.bottom,ia.right,null,null,null,ia.id,ia.Zaa);ta.Kna=ia.Kna;if(K.EwaSettings.isChangeGateEnabled("OfficeVSO:6424701_fixIssueWithTheGrippieButton")){var za=
this.gridView.Ab.dk(ia,!0);if(!za)return null;for(var sa=0,V=this.rangeList.length;sa<V;sa++){var Ia=this.rangeList[sa],Ha=this.gridView.Ab.dk(Ia,!0);Ha&&Ha.name===za.name&&Ia!==ia&&this.Qef(Ia)&&(ta.union(Ia),Ia.Kna&&(ta.Kna=!0))}}else for(za=0,sa=this.rangeList.length;za<sa;za++)V=this.rangeList[za],V.id===ia.id&&V!==ia&&this.Qef(V)&&(ta.union(V),V.Kna&&(ta.Kna=!0));return ta};d.prototype.Qef=function(ia){return!!M.g(this.$).Ab.dk(ia)};d.prototype.kHh=function(){for(var ia=[],ta=bk(this.rangeList),
za=ta.next();!za.done;za=ta.next())za=new C.a(this.Vm(za.value.topLeft),D.d(this.$.pa)),ia.push(za);return ia};d.prototype.dfd=function(){for(var ia={},ta=bk(this.rangeList),za=ta.next();!za.done;za=ta.next())if(za=za.value){var sa=this.Vm(za.topLeft);sa&&(ia[sa.toString()]=this.Vm(za.topLeft))}return ia};d.prototype.vsi=function(){this.$.ea.Tg?this.Rxb(0):this.$.ea.il(this.KV)};d.prototype.Rxb=function(ia){var ta=this;this.$.bB(function(za){za.aja(ia).then(ta.eGb)})};d.prototype.$Xh=function(ia){var ta=
this.gridView.Ab.dk(ia);return ta?ta.name:ia.toString()};d.prototype.wOd=function(ia,ta,za,sa,V,Ia,Ha){var ob=ia+(V?1:0),ib=za-(Ia?1:0),La=this.gridView.inRangePicker||this.gridView.ui,zb=!1,Fb=new x.Range(ob,ta,ib,sa,!1,!1);if(V||Ia)for(V=La?C.a.irb(this.gridView.ha.rangePicker.xK):this.gridView.ha.sa.selectedRanges,V=bk(V),Ia=V.next();!Ia.done;Ia=V.next()){Ia=Ia.value;zb=this.pqb(Ia,ob,ta,ib,sa);var Yb=this.pqb(Ia,ia,ta,za,sa);if(La&&zb)break;if(!La&&(zb||Yb)){this.gridView.ha.updateSelection(Ia,
Ia.topLeft,0,1);if(Ha&&Yb)return;break}}zb&&(Fb.top=ia,Fb.bottom=za);ia=Fb.topLeft;Ha?this.gridView.ha.updateSelection(Fb,ia,0,1):La?this.gridView.ha.xB([Fb],0,ia,0):this.gridView.ha.updateSelection(Fb,ia,0,3)};d.prototype.vOd=function(ia,ta,za){ia&&(za=za?M.g(this.$).ha.sa.activeCell:ia.topLeft,ta?this.gridView.ha.updateSelection(ia,za,0,1):this.gridView.ha.xB([ia],0,za,0))};d.prototype.E3c=function(ia,ta,za,sa,V){var Ia=F.d(this.l5b),Ha=F.g(this.l5b),ob=ta+(1!==this.PHa&&Ia?1:0),ib=sa-(1!==this.PHa&&
Ha?1:0),La=this.gridView.inRangePicker||this.gridView.ui;if(ia){var zb=K.EwaSettings.isChangeGateEnabled("OfficeVSO:5593089_TableSelectorsBugFixes")&&La&&!C.a.irb(this.gridView.ha.rangePicker.xK).length?new x.Range(ob,za,ib,V,!1,!1):La?this.gridView.ha.rangePicker.activeCell:this.gridView.ha.sa.activeCell;zb=new x.Range(zb.top<ob?zb.top:ob,zb.left<za?zb.left:za,zb.bottom>ib?zb.bottom:ib,zb.right>V?zb.right:V,!1,!1)}else zb=new x.Range(ob,za,ib,V,!1,!1);if(1!==this.PHa&&(Ia||Ha)&&(!ia||ia&&this.pqb(zb,
ob,za,ib,V)))for(ia=La?C.a.irb(this.gridView.ha.rangePicker.xK):this.gridView.ha.sa.selectedRanges,ia=bk(ia),Ia=ia.next();!Ia.done;Ia=ia.next())if(this.pqb(Ia.value,ob,za,ib,V)){zb.top=ta;zb.bottom=sa;break}return zb};d.prototype.Mef=function(ia){var ta=this.gridView.inRangePicker||this.gridView.ui?C.a.irb(this.gridView.ha.rangePicker.xK):this.gridView.ha.sa.selectedRanges;ta=bk(ta);for(var za=ta.next();!za.done;za=ta.next())if(this.pqb(za.value,ia.top,ia.left,ia.bottom,ia.right))return!0;return!1};
d.prototype.pqb=function(ia,ta,za,sa,V){return!!ia&&ia.top===ta&&ia.bottom===sa&&ia.left===za&&ia.right===V};Mf.Object.defineProperties(d.prototype,{mFa:{configurable:!0,enumerable:!0,get:function(){return this.cQb}},rrd:{configurable:!0,enumerable:!0,get:function(){return this.p9d}},PHa:{configurable:!0,enumerable:!0,get:function(){return this.ARb}},pg:{configurable:!0,enumerable:!0,get:function(){var ia=M.g(this.$);return ia.Ab.dk(ia.ha.sa.activeCell,!1)}},cEd:{configurable:!0,enumerable:!0,get:function(){return this.rrd?
M.g(this.$).Ab.dk(this.rrd,!1):null}}});Object(u.a)(d,"TableManager",w.a,[633,3]);var qa=f.a;Rk(c,qa);c.prototype.create=function(){this.pb(this.tableManager||(this.tableManager=new d(this.$)))};Object(u.a)(c,"TableManagerFactory",f.a,[]);var na=b(1417);b.d(E,"a",function(){return a})},1417:function(u,E,b){function a(X){var ja=wa.call(this)||this;ja.tableStyleManager=null;ja.$=X;ja.Eb();return ja}function c(X,ja,va){var ua=ca.call(this)||this;var Xa={};ua.M_i=(Xa.height="100%",Xa);ua.rHb={};ua.Tfd=
0;ua.GHa=0;ua.lastSyncTime=new Date;ua.xda=-1;ua.DN=null;ua.oma={};ua.cL=null;ua.RF={};ua.ySa={};ua.drc=null;ua.Def=!1;ua.isInitialized=!1;ua.X5a=!1;ua.eAb=!1;ua.huc=null;ua.JTe=!1;ua.qMb=!1;ua.pyc=!1;ua.jyh=function(){ua.Rhc()?ua.$.ea.eId(ua.jyh):ua.kKa("tableStyleManagerInitialization")};ua.Kwf=function(aa,ba,oa){var ra=!1,db=N.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AccessibleAuthoringTab",!1);if(K.a(aa))-315732528!==aa.Errors[0].MessageId&&(r.ULS.sendTraceTag(42821707,0,10,"TableStyleManager.OnGetTableStyleSuccess - Webservice call failed with Unexpected error : {0}",
H.a.Ec(aa.Errors)),ua.Azd(null,ba,oa));else if(r.ULS.sendTraceTag(537151202,0,50,"TableStyleManager.OnGetTableStyleSuccess - Webservice call Success"),(aa=aa.Result)&&aa.TableStyleItems.length){oa=60<aa.TableStyleItems.length;var Ka=!1,Ga=!1;if(ua.cL)for(var xa=0;60>xa;++xa){var da=aa.TableStyleItems[xa],qa=ua.cL.TableStyleItems[xa];if(db&&da.HasStyleViolations!==qa.HasStyleViolations){ra=Ga=!0;break}for(var na=0;9>na&&!(na>=da.TableStyleElementsList.length);na++)if(!M.a.equals(da.TableStyleElementsList[na].BackgroundColor,
qa.TableStyleElementsList[na].BackgroundColor,!1)){ra=Ka=!0;break}}else for(ua.GHa=0,xa=bk(aa.TableStyleItems),da=xa.next();!da.done;da=xa.next())da=da.value,da.TableStyleElementsList&&da.TableStyleElementsList.sort(e.cmf),ua.RF[da.Name]=da;if(Ka||Ga)for(Ka=0;60>Ka;++Ka)Ga=aa.TableStyleItems[Ka],ua.RF[Ga.Name]=Ga;if(oa&&ua.cL)for(r.ULS.sendTraceTag(42821700,0,50,"TableStyleManager.OnGetTableStyleSuccess, Number Custom Styles present - {0}",aa.TableStyleItems.length-60),ra=!0,oa=60;oa<aa.TableStyleItems.length;++oa)Ka=
aa.TableStyleItems[oa],Ka.Name in ua.RF||Ka.TableStyleElementsList&&Ka.TableStyleElementsList.sort(e.cmf),ua.RF[Ka.Name]=Ka;if(fa.a(ua.RF).length!==aa.TableStyleItems.length)for(ra=!0,Ka=oa=60;Ka<ua.cL.TableStyleItems.length;)oa>=aa.TableStyleItems.length?delete ua.RF[ua.cL.TableStyleItems[Ka].Name]:oa>=aa.TableStyleItems.length||!M.a.equals(aa.TableStyleItems[oa].Name,ua.cL.TableStyleItems[Ka].Name,!1)?delete ua.RF[ua.cL.TableStyleItems[Ka].Name]:++oa,++Ka;ua.cL=aa;ua.LMf(ra);ra&&ua.gYc();db&&ba&&
("accessibility"===ba?(ua.qMb=!1,ua.pyc=!0):ua.pyc=!1);ua.Def||(ua.Nmi()&&ua.$.hf(),ua.Def=!0);ua.Tfd=0;ua.eAb||ua.JTe?db&&ua.pyc&&ua.raiseEvent("RefreshTableStyleGallery"):(ua.raiseEvent("RefreshTableStyleGallery"),ua.JTe=!0)}};ua.Azd=function(){r.ULS.sendTraceTag(42821712,0,10,"TableStyleManager.OnGetTableStyleFailed - Webservice call failed");ua.Tfd++;5>ua.Tfd&&T.a.instance.create(function(){ua.kKa("getTableStylesFailed")},1E3,O.a.n7f,!0,!0)};ua.uCf=function(){ua.eAb&&(ua.eAb=!1,ua.huc&&ua.huc(),
T.a.instance.create(function(){ua.kKa("galleryMenuClosed")},1E3,O.a.n7f,!0,!0))};ua.$=X;ua.Va=ja;ua.tableManager=va;ua.$.da.Ga(329,ua);ua.DYc=ua.Tub();ua.$.Ka.rYa(ua.uCf);return ua}function d(X,ja,va,ua,Xa,aa){this.headerRow=X;this.totalRow=ja;this.firstCol=va;this.lastCol=ua;this.ER=Xa;this.Eha=aa}function e(){}function k(){}u=b(0);var l=b(232),n=b(51),f=b(37),v=b(7),r=b(14),y=b(113),m=b(1025),w=b(1665),B=b(936),A=b(1594),z=b(38),x=b(5),D=b(168),I=b(76),F=b(62),G=b(169),T=b(47),O=b(44),U=b(111);
b(28);var J=b(198),H=b(31),K=b(295),N=b(1),M=b(22),C=b(15);b(29);Object(u.a)(k,"TableStyleElement",null,[]);var Q=b(962),P=b(217),ka=b(87),R=b(590);e.cmf=function(X,ja){return e.o7f[X.Type]-e.o7f[ja.Type]};e.D3a=function(X,ja){try{return appChrome.buildTableStyleGalleryIconNew(e.QAa,e.Yna,X,ja)}catch(va){return null}};e.rgf=function(X){return X&&I.a.Nc in X&&(X=X[I.a.Nc])?M.a.aL(X,x.a.oGb):!1};e.Psa=function(X){var ja=[],va=0;X=bk(X);for(var ua=X.next();!ua.done;ua=X.next()){ua=ua.value;ja[va]={};
ja[va].backgroundColor="white";ja[va].color="black";for(var Xa in ua){var aa=ua[Xa];switch(Xa){case "background-color":ja[va].backgroundColor=aa;break;case "color":ja[va].color=aa;break;case "font-size":ja[va].fontSize=aa;break;case "border-bottom":ja[va].borderBottom=aa;break;case "border-right":ja[va].borderRight=aa;break;case "border-left":ja[va].borderLeft=aa;break;case "border-top":ja[va].borderTop=aa}}va++}return ja};e.L3b=function(X,ja){var va=[];if(null===X||void 0===X?0:X.TableStyleElementsList)for(var ua=
0===X.Category,Xa=0;Xa<e.Yna;Xa++)va.push.apply(va,ck(e.iLh(X,ja,ua,Xa)));else{if(e.$4c)return e.$4c;X={color:"black","background-color":"white"};for(ja=0;ja<e.Yna;ja++)for(ua=0;ua<e.QAa;ua++)va.push(X);e.$4c=va}return va};e.aYh=function(X,ja){if(!X.TableStyleElementsList)return"";var va="";X=bk(X.TableStyleElementsList);for(var ua=X.next();!ua.done;ua=X.next())if(ua=ua.value,ua.BackgroundColor&&"#000000"!==ua.BackgroundColor)switch(ua.Type){case 0:va=ua.BackgroundColor;break;case 5:case 7:if(ja.Eha||
ja.ER)va=ua.BackgroundColor;break;case 3:case 4:if(ja.firstCol||ja.lastCol)va=ua.BackgroundColor;break;case 2:ja.totalRow&&(va=ua.BackgroundColor);break;case 1:ja.headerRow&&(va=ua.BackgroundColor)}return va};e.L2b=function(X){X=new P.a(parseInt(String("0x"+X.substr(1,2)),16),parseInt(String("0x"+X.substr(3,2)),16),parseInt(String("0x"+X.substr(5,2)),16));return Q.a.XJa(X)};e.U1e=function(X,ja){if(!X||!ja)return"";ja=(ja=e.aYh(X,ja))?e.L2b(ja)+", ":C.a.instance.ga(2040)+", ";switch(X.Index){case 0:return ja+
C.a.instance.ga(1974);case 1:return ja+C.a.instance.ga(1975);case 2:return ja+C.a.instance.ga(1976);case 3:return ja+C.a.instance.ga(1977);case 4:return ja+C.a.instance.ga(1978);case 5:return ja+C.a.instance.ga(1979);case 6:return ja+C.a.instance.ga(1980);case 7:return ja+C.a.instance.ga(1981);case 8:return ja+C.a.instance.ga(1982);case 9:return ja+C.a.instance.ga(1983);case 10:return ja+C.a.instance.ga(1984);case 11:return ja+C.a.instance.ga(1985);case 12:return ja+C.a.instance.ga(1986);case 13:return ja+
C.a.instance.ga(1987);case 14:return ja+C.a.instance.ga(1988);case 15:return ja+C.a.instance.ga(1989);case 16:return ja+C.a.instance.ga(1990);case 17:return ja+C.a.instance.ga(1991);case 18:return ja+C.a.instance.ga(1992);case 19:return ja+C.a.instance.ga(1993);case 20:return ja+C.a.instance.ga(1994);case 21:return ja+C.a.instance.ga(1995);case 22:return ja+C.a.instance.ga(1996);case 23:return ja+C.a.instance.ga(1997);case 24:return ja+C.a.instance.ga(1998);case 25:return ja+C.a.instance.ga(1999);
case 26:return ja+C.a.instance.ga(2E3);case 27:return ja+C.a.instance.ga(2001);case 28:return ja+C.a.instance.ga(2002);case 29:return ja+C.a.instance.ga(2003);case 30:return ja+C.a.instance.ga(2004);case 31:return ja+C.a.instance.ga(2005);case 32:return ja+C.a.instance.ga(2006);case 33:return ja+C.a.instance.ga(2007);case 34:return ja+C.a.instance.ga(2008);case 35:return ja+C.a.instance.ga(2009);case 36:return ja+C.a.instance.ga(2010);case 37:return ja+C.a.instance.ga(2011);case 38:return ja+C.a.instance.ga(2012);
case 39:return ja+C.a.instance.ga(2013);case 40:return ja+C.a.instance.ga(2014);case 41:return ja+C.a.instance.ga(2015);case 42:return ja+C.a.instance.ga(2016);case 43:return ja+C.a.instance.ga(2017);case 44:return ja+C.a.instance.ga(2018);case 45:return ja+C.a.instance.ga(2019);case 46:return ja+C.a.instance.ga(2020);case 47:return ja+C.a.instance.ga(2021);case 48:return ja+C.a.instance.ga(2022);case 49:return ja+C.a.instance.ga(2023);case 50:return ja+C.a.instance.ga(2024);case 51:return ja+C.a.instance.ga(2025);
case 52:return ja+C.a.instance.ga(2026);case 53:return ja+C.a.instance.ga(2027);case 54:return ja+C.a.instance.ga(2028);case 55:return ja+C.a.instance.ga(2029);case 56:return ja+C.a.instance.ga(2030);case 57:return ja+C.a.instance.ga(2031);case 58:return ja+C.a.instance.ga(2032);case 59:return ja+C.a.instance.ga(2033);default:return X.Name?X.Name:""}};e.eSh=function(X){return(X+1)%e.Z6h};e.Zvb=function(X,ja,va){va=void 0===va?"":va;return X||!va?String.format("{0}, {1}, -version, {2}",e.a8e,X.Index.toString(),
ja.toString()):String.format("{0}, {1}, -version, {2}",e.a8e,va,ja.toString())};e.iLh=function(X,ja,va,ua){for(var Xa=[],aa=0;aa<e.QAa;aa++)Xa.push(e.Ccd(X,ja,va,ua,aa));return Xa};e.Ccd=function(X,ja,va,ua,Xa){var aa=X.TableStyleElementsList;X=new k;var ba={};if(!aa)return ba;for(var oa=bk(aa),ra=oa.next();!ra.done;ra=oa.next())if(ra=ra.value,0===ra.Type){X=ra;break}oa=!!X.BackgroundColor;var db="";!va&&X.TableStyleBorderFromatList&&0<X.TableStyleBorderFromatList.length&&(db=X.TableStyleBorderFromatList[0].Color);
ba["background-color"]=oa?X.BackgroundColor:"#FFFFFF";X.FontColor||(X.FontColor="#000000");ba.color=X.FontColor;e.Iwe(ua,Xa,ba,X,db,va,oa);aa=bk(aa);for(ra=aa.next();!ra.done;ra=aa.next())(ra=ra.value)&&0!==ra.Type&&(2!==ra.Type||oa||(ra.BackgroundColor=X.BackgroundColor),e.Vpd(ra,ua,Xa,ja)&&(ra.BackgroundColor&&(ba["background-color"]=ra.BackgroundColor),ba.color=ra.FontColor||X.FontColor,e.Iwe(ua,Xa,ba,ra,db,va,oa)));return ba};e.XU=function(X,ja,va,ua,Xa,aa){va&&(va.Color&&!va.Style&&(va.Style=
1),va.Style&&!va.Color&&(va.Color=Xa?"#000000":ua?ua:aa?"#FFFFFF":"#000000"),ja[e.borders[X]]="1px "+e.zV[va.Style]+" "+va.Color)};e.Vpd=function(X,ja,va,ua){return-1===X.Type?!1:e.Wpd(X,ja,va,ua)||e.xmi(X,ja,va,ua)||e.Xpd(X,ja,va,ua)};e.xmi=function(X,ja,va,ua){return!ja&&ua.headerRow||ja===e.Yna-1&&ua.totalRow?!1:1===ja%2&&5===X.Type&&ua.ER&&ua.headerRow||1<ja&&!!((ja-1)%(X.BandSize+1))&&6===X.Type&&ua.ER&&ua.headerRow||!(ja%2)&&5===X.Type&&ua.ER&&!ua.headerRow||!!(ja%(X.BandSize+1))&&6===X.Type&&
ua.ER&&!ua.headerRow||!(va%2)&&7===X.Type&&ua.Eha||!!(va%(X.BandSize+1))&&8===X.Type&&ua.Eha};e.Xpd=function(X,ja,va,ua){return ja===e.Yna-1&&2===X.Type&&ua.totalRow||va===e.QAa-1&&ja===e.Yna-1&&12===X.Type&&ua.totalRow&&ua.lastCol||!va&&ja===e.Yna-1&&11===X.Type&&ua.totalRow&&ua.firstCol||va===e.QAa-1&&4===X.Type&&ua.lastCol};e.Wpd=function(X,ja,va,ua){return!ja&&1===X.Type&&ua.headerRow||!va&&3===X.Type&&ua.firstCol||!va&&!ja&&9===X.Type&&ua.headerRow&&ua.firstCol||va===e.QAa-1&&!ja&&10===X.Type&&
ua.headerRow&&ua.lastCol};e.Iwe=function(X,ja,va,ua,Xa,aa,ba){if(ua.TableStyleBorderFromatList)for(var oa=bk(ua.TableStyleBorderFromatList),ra=oa.next();!ra.done;ra=oa.next())if(ra=ra.value,ra.Style)switch(ra.Position){case 0:X&&12!==ua.Type&&11!==ua.Type&&2!==ua.Type&&5!==ua.Type&&6!==ua.Type||e.XU(0,va,ra,Xa,aa,ba);break;case 1:X!==e.Yna-1&&1!==ua.Type&&10!==ua.Type&&9!==ua.Type&&5!==ua.Type&&6!==ua.Type||e.XU(1,va,ra,Xa,aa,ba);break;case 2:ja&&12!==ua.Type&&10!==ua.Type&&7!==ua.Type&&8!==ua.Type&&
4!==ua.Type||e.XU(2,va,ra,Xa,aa,ba);break;case 3:ja!==e.QAa-1&&9!==ua.Type&&11!==ua.Type&&3!==ua.Type&&7!==ua.Type&&8!==ua.Type||e.XU(3,va,ra,Xa,aa,ba);break;case 5:ja!==e.QAa-1&&3!==ua.Type&&4!==ua.Type&&7!==ua.Type&&8!==ua.Type&&e.XU(3,va,ra,Xa,aa,ba);break;case 6:X!==e.Yna-1&&2!==ua.Type&&1!==ua.Type&&5!==ua.Type&&6!==ua.Type&&e.XU(1,va,ra,Xa,aa,ba)}};e.dYh=function(){var X=Array(12);X[0]=0;X[7]=1;X[8]=2;X[5]=3;X[6]=4;X[4]=5;X[3]=6;X[1]=7;X[2]=8;X[9]=9;X[10]=10;X[11]=11;X[12]=13;return X};e.Yna=
5;e.QAa=5;e.Z6h=5;e.a8e="TableStyleIcon";e.zV=[null,ka.a.solid,ka.a.dashed,ka.a.dotted,ka.a.dashed,ka.a.dotted,ka.a.dashed,ka.a.double];e.borders=[R.a.borderTop,R.a.borderBottom,R.a.borderLeft,R.a.borderRight];e.o7f=e.dYh();e.$4c=null;Object(u.a)(e,"TableStyleHelper",null,[]);d.prototype.equals=function(X){return X?this.headerRow===X.headerRow&&this.totalRow===X.totalRow&&this.firstCol===X.firstCol&&this.lastCol===X.lastCol&&this.Eha===X.Eha&&this.ER===X.ER:!1};Object(u.a)(d,"TableStyleOptions",null,
[]);var fa=b(1003),ca=z.a;Rk(c,ca);c.prototype.e5e=function(X){var ja=this.tableManager.pg;if(!ja)return!1;X=X[I.a.Nc];if(!X)return!1;switch(Number.parseInvariant(X)){case 0:return G.d(ja);case 1:return G.c(ja);case 2:return G.g(ja);case 3:return G.e(ja);case 4:return G.f(ja);case 5:return G.b(ja);case 6:return ja.hasAutoFilter}return!1};c.prototype.pGf=function(X,ja){if(y.a.isEmpty(this.RF))return!0;if("PopulateTableMoreStylesMenu"!==X&&"PopulateTableAccessibleStylesMenu"!==X)return!1;if(N.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AccessibleAuthoringTab",
!1)&&"PopulateTableAccessibleStylesMenu"===X&&!this.pyc)return this.qMb||(this.qMb=!0,this.kKa("accessibilityTab")),!0;this.eAb=!0;var va=this.Va.jq("TableStylesMenu"),ua=this.Va.lC("Ribbon.TableTools.TableStyles.Gallery.Custom",7,"Size48by48"),Xa=this.Va.lC("Ribbon.TableTools.TableStyles.Gallery.Dark",7,"Size48by48"),aa=this.Va.lC("Ribbon.TableTools.TableStyles.Gallery.Medium",7,"Size48by48"),ba=this.Va.lC("Ribbon.TableTools.TableStyles.Gallery.Light",7,"Size48by48"),oa=-123538519;if(ja.MenuId)if(M.a.contains(ja.MenuId,
"FormatAsTable",!0))oa=753331043,this.X5a=!0;else{var ra=C.a.instance.ga(1973);var db=e.Zvb(null,1,"-1");N.EwaSettings.isChangeGateEnabled("OfficeVSO:4185429_NonNullIconNameForSLRGalleryItem")?ba.zt("-1",oa,"QueryTableStyle",0,"-1",db,void 0,void 0,ra):ba.zt("-1",oa,"QueryTableStyle",0,"-1",void 0,void 0,void 0,ra);this.X5a=!1}db=0;var Ka=this.RF,Ga;for(Ga in Ka){var xa=Ka[Ga];if(!N.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AccessibleAuthoringTab",!1)||"PopulateTableAccessibleStylesMenu"!==
X||!xa.HasStyleViolations){ra=e.U1e(xa,this.Tub());var da=e.Zvb(xa,this.GHa);if(xa)switch(xa.Category){case 0:ua.zt(xa.Index.toString(),oa,"QueryTableStyle",0,xa.Index.toString(),da,void 0,void 0,ra);db++;break;case 3:Xa.zt(xa.Index.toString(),oa,"QueryTableStyle",0,xa.Index.toString(),da,void 0,void 0,ra);break;case 2:aa.zt(xa.Index.toString(),oa,"QueryTableStyle",0,xa.Index.toString(),da,void 0,void 0,ra);break;case 1:ba.zt(xa.Index.toString(),oa,"QueryTableStyle",0,xa.Index.toString(),da,void 0,
void 0,ra)}}}0<db&&this.m2(va,ua,1941);this.m2(va,ba,1942);this.m2(va,aa,1943);this.m2(va,Xa,1944);ja.MenuItems=va.$D();this.isInitialized||(this.isInitialized=!0);return!0};c.prototype.Chd=function(X){var ja=this;X[m.a.On]=!1;var va=X[I.a.Nc];if(va&&!y.a.isEmpty(this.RF)){M.a.contains(X.ParentMenuId,"FormatAsTable",!0)?this.X5a=!0:this.X5a=!1;this.X5a||this.Jbg();e.rgf(X)&&(va=this.lvb(va).toString());var ua=this.Tub();X[m.a.Alt]="-1"===va?C.a.instance.ga(1973):e.U1e(this.Sfd(va),ua);if(va in this.ySa&&
ua.equals(this.DYc))this.rGf(X,va,ua,!0);else{if(!this.drc||this.drc&&!this.drc.Lp)this.oma={},this.drc=T.a.instance.create(function(){ja.LMf();ja.DYc=ja.Tub()},0,O.a.XGj,!0,!0);this.XCd(ua,X,va)}}};c.prototype.getTableStyleIndexFromName=function(X){if(!X||y.a.isEmpty(this.RF))return-1;if(X in this.RF)return this.RF[X].Index;this.kKa("getTableStyleIndexFromName");return-1};c.prototype.Rhc=function(){return!!this.cL};c.prototype.lvb=function(X){this.DN||this.gYc();return X in this.DN?this.DN[X]:-1};
c.prototype.kKa=function(X){if(this.$.isEditMode)if(N.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AccessibleAuthoringTab",!1)){var ja=new Date;if(30<U.getElapsedSeconds(this.lastSyncTime,ja)||y.a.isEmpty(this.RF)||this.qMb){var va=this.$.oa.xa.Pb();this.lastSyncTime=ja;X=this.qMb&&"accessibilityTab"===X||"galleryMenuClosed"===X;F.n(this.$.oa.xa,X,this.Kwf,this.Azd,null,X?"accessibility":"normal",va)}}else if(va=new Date,30<U.getElapsedSeconds(this.lastSyncTime,va)||y.a.isEmpty(this.RF))X=
this.$.oa.xa.Pb(),this.lastSyncTime=va,F.m(this.$.oa.xa,this.Kwf,this.Azd,null,null,X)};c.prototype.dispose=function(){this.DN=this.ySa=this.cL=this.RF=null;this.$.Ka.bIb(this.uCf);ca.prototype.dispose.call(this)};c.prototype.eGg=function(X){this.addHandler("RefreshTableStyleGallery",X)};c.prototype.Obj=function(X){this.removeHandler("RefreshTableStyleGallery",X)};c.prototype.gYc=function(){var X={};this.tableManager.pg&&(this.xda=this.getTableStyleIndexFromName(this.tableManager.pg.Ryc));for(var ja=
1;7>=ja;ja++)X["preview"+ja]=this.hRh(ja);this.DN=X};c.prototype.hRh=function(X){var ja=this.cL.TableStyleItems.length;ja=4>=this.xda?this.xda+X-1:4<this.xda&&this.xda<ja-4?4===X?this.xda:Math.floor(this.xda+X-4):this.xda+X-1;-1===ja||ja.toString()in this.ySa||(ja=X-3);return ja};c.prototype.Jbg=function(){if(this.tableManager.pg){var X=!1,ja=this.getTableStyleIndexFromName(this.tableManager.pg.Ryc);if(ja!==this.xda){if(this.DN){var va=this.DN,ua;for(ua in va)va[ua]===ja&&(X=!0)}this.xda=ja;X||y.a.isEmpty(this.ySa)||
this.gYc()}}};c.prototype.m2=function(X,ja,va){var ua=this.Va.Bc();ua.Ep="Thin";ua.title=C.a.instance.ga(va);ua.buttons.push(ja);X.pc.push(ua)};c.prototype.Tub=function(){var X=this.tableManager.pg;return this.X5a||!X?new d(!0,!1,!1,!1,!0,!1):new d(G.d(X),G.g(X),G.c(X),G.e(X),G.f(X),G.b(X))};c.prototype.LMf=function(X){X=void 0===X?!1:X;var ja={},va={},ua=this.Tub();if(!y.a.isEmpty(this.RF)&&(this.tableManager.pg&&this.Jbg(),!ua.equals(this.DYc)||X||y.a.isEmpty(this.ySa))){this.GHa=e.eSh(this.GHa);
X=this.RF;for(var Xa in X){var aa=X[Xa],ba=e.Zvb(aa,this.GHa);ja[aa.Index.toString()]=e.D3a(e.Psa(e.L3b(aa,ua)),ba);va[ba]=ja[aa.Index.toString()];this.qHb(va)}Xa=e.Zvb(null,this.GHa,"-1");ja["-1"]=e.D3a(e.Psa(e.L3b(null,ua)),Xa);va[Xa]=ja["-1"];this.qHb(va);J.c(this.ySa,ja,!1)}};c.prototype.Nmi=function(){var X=D.a(this.$);return X?X.Ql.wB===x.a.lza:!1};c.prototype.XCd=function(X,ja,va){Number.parseInvariant(va);"-1"===va&&M.a.contains(ja.ParentMenuId,"FormatAsTable",!0)||this.rGf(ja,va,X,!1)};c.prototype.rGf=
function(X,ja,va,ua){var Xa=e.Zvb(null,this.GHa,ja);e.rgf(X)?(Xa in this.oma?va=this.oma[Xa]:(va=e.Psa(e.L3b(this.Sfd(ja),va)),this.oma[Xa]=va),X[m.a.GalleryButtonProps]=Object(v.a)(new w.a,{Command:"-123538519",QueryCommand:"QueryTableStyle",Id:Xa,Alt:X[m.a.Alt],MenuItemId:ja,TableCellStyles:va,TableStyles:this.M_i})):(X[B.a.Icon]=Xa,X[m.a.GalleryButtonProps]=Object(v.a)(new A.a,{Command:"-123538519",QueryCommand:"QueryTableStyle",Id:Xa,Alt:X[m.a.Alt],MenuItemId:ja}),ua||(ua=[],this.Sfd(ja),"-1"===
ja||M.a.contains(X.ParentMenuId,"FormatAsTable",!0)||(ua=e.L3b(this.cL.TableStyleItems[Number.parseInvariant(ja)],va)),this.ySa[ja]=e.D3a(e.Psa(ua),Xa)))};c.prototype.qHb=function(X){var ja=this;if(this.eAb)this.huc=function(){ja.qHb(X)};else{this.huc=null;var va=[],ua;for(ua in X){var Xa=ua;Xa in this.rHb?va.push(Xa):this.rHb[Xa]=!0}try{0<va.length&&appChrome.api.unregisterIcons(va),y.a.isEmpty(X)||appChrome.api.registerIconProvider(function(){return X})}catch(aa){}}};c.prototype.Sfd=function(X){X=
Number.parseInvariant(X);if(-1===X||!this.cL)return null;if(60<X)for(var ja=60;ja<this.cL.TableStyleItems.length;++ja){var va=this.cL.TableStyleItems[ja];if(va.Index===X)return va}return this.cL.TableStyleItems[X]};Object(u.a)(c,"TableStyleManager",z.a,[487,3]);var ea=b(58);b.d(E,"a",function(){return a});var wa=l.a;Rk(a,wa);a.prototype.create=function(){var X=this,ja=n.GetServiceTaskFactory.create(this.$.da,102,this.la,this.hb),va=n.GetServiceTaskFactory.Ra(this.$.da,66,134,this.hb);f.TaskExtensions.Aa(ea.Task.oL(ja,
va),function(){X.pb(X.tableStyleManager||(X.tableStyleManager=new c(X.$,ja.result,va.result)))},this.$.la,8)};Object(u.a)(a,"TableStyleManagerFactory",l.a,[])},1434:function(u,E,b){function a(){N.a.Fa(c.ka)}function c(M){var C=K.call(this)||this;C.$=M;C.Eb();return C}function d(M){var C=e.call(this,document.documentElement,M)||this;C.NB=0;C.eNg=[f.a.nBe,f.a.mxd,f.a.pdc,f.a.jVd,f.a.SKd,f.a.iYc,f.a.Oad,f.a.B3e,f.a.rXc,f.a.Yyc,f.a.BBj,f.a.Bcc,f.a.yZc,f.a.Otb,f.a.zPd,f.a.GZc,f.a.o5f,f.a.Gjf,f.a.NXc];
C.qVj=[f.a.pdc,f.a.Keg,f.a.Jeg,f.a.Leg];C.b0i=[f.a.pdc,f.a.SHf,f.a.THf,f.a.WHf];C.dVg=[f.a.TTe,f.a.A3e,f.a.Mad,f.a.Jad];C.D_i=[f.a.nBe,f.a.mxd,f.a.iYc,f.a.Oad,f.a.rXc,f.a.Yyc,f.a.Bcc,f.a.yZc,f.a.Otb,f.a.zPd,f.a.nHf,f.a.GZc,f.a.NXc];C.N_i=[f.a.Bcc,f.a.ZTe];var Q=H.a.instance.Xa(251);C.Ipj=C.$.shortcutKeyManager.SJa(Q);C.mode=0;M.da.Ga(15,C);I.TaskExtensions.Aa(D.GetServiceTaskFactory.Ra(M.da,21,137,1),function(P){P=P.result;P.Tn(n.a.amb);P.Ml(n.a.amb,C.NIb)},M.la);return C}function e(M,C){var Q=O.call(this,
M)||this;Q.S8=[];Q.l9d=null;Q.NIb=function(P){var ka="forward";P.Values[v.a.direction]?ka=P.Values[v.a.direction].toLowerCase():l.ULS.sendTraceTag(537166664,0,15,"Didn't find direction in message values");P=0;var R=!0;"backward"===ka?(P=Q.ord.length-1,R=!1):"forward"===ka?(P=0,R=!0):l.ULS.sendTraceTag(537166663,0,15,"Received unknown direction to resume focus: {0}",ka);Q.Dpf(R,P,!1)};Q.Mxf=function(){Q.S8=[]};Q.nOa=function(P){if(-411645385===Q.$.shortcutKeyManager.Qt(P,!0)&&Q.gdf()){var ka={};Q.$.Ka.Kb(new F.a(-411645385,
1,Q.$.Jc,6,null),(ka.event=P,ka),P);P.stopPropagation()}};Q.hNi=function(P){Q.Rla(P)};Q.jb=C;Q.Ac.ka("keydown",Q.hNi);Q.Ac.ka("keyup",Q.nOa);B.a(C).qGg(Q.Mxf);z.a(C.ya,27)&&I.TaskExtensions.Aa(D.GetServiceTaskFactory.Ra(C.da,21,137,1),function(P){P=P.result;P.Tn(n.a.q7e);P.Ml(n.a.q7e,Q.NIb)},C.la);return Q}u=b(0);var k=b(232),l=b(14),n=b(170),f=b(253),v=b(391),r=b(4),y=b(741),m=b(88),w=b(94),B=b(272),A=b(168),z=b(78),x=b(394),D=b(51),I=b(37),F=b(91),G=b(69),T=b(637),O=w.a;Rk(e,O);e.prototype.dispose=
function(){this.$&&B.a(this.$).bcj(this.Mxf);this.jb=null;Array.clear(this.S8);O.prototype.dispose.call(this)};e.prototype.B0i=function(M){this.Rla(M)};e.prototype.Dpf=function(M,C,Q,P){P=void 0===P?null:P;var ka=this.mGj(M,C,void 0===Q?!0:Q,P);if(!ka){Q=C;var R=M?1:-1,fa=this.ord;do{ka=!1;if(z.a(this.$.ya,27)){if(Q+=R,Q>=fa.length||0>Q)ka=!0}else Q=(Q+R+fa.length)%fa.length;if(ka){this.qwi(M,C,P);break}else if(ka=this.lGj(M,C,Q,P))break}while(Q!==C)}};e.prototype.mGj=function(M,C,Q,P){P=void 0===
P?null:P;var ka=null;0<=C&&(ka=this.S8[C]);return(null===ka||void 0===ka?0:ka.canReceiveFocus)&&ka.Sf(M,void 0===Q?!0:Q)?(P&&G.g(P),l.ULS.sendTraceTag(537166669,0,50,"Switched focus inside current section {0} into a sub region",ka.Yd),ka.ej(),!0):!1};e.prototype.lGj=function(M,C,Q,P){P=void 0===P?null:P;Q=this.S8[Q];if((null===Q||void 0===Q?0:Q.canReceiveFocus)&&Q.Sf(M,!1)){P&&G.g(P);Q.ej();if(M=this.S8[C])M.Aj(),l.ULS.sendTraceTag(537166668,0,50,"Switched focus from section {0} to {1}",M.Yd,Q.Yd);
return!0}return!1};e.prototype.qwi=function(M,C,Q){(Q=void 0===Q?null:Q)&&G.g(Q);if(C=this.S8[C])C.Aj(),l.ULS.sendTraceTag(537166666,0,50,"Lost focus from section {0}",C.Yd);I.TaskExtensions.Aa(D.GetServiceTaskFactory.Ra(this.$.da,21,137,0),function(P){var ka={};P.result.uj(n.a.amb,(ka[v.a.direction]=M?"forward":"backward",ka))},this.$.la)};e.prototype.Rla=function(M){var C=this.$.isEditMode?A.a(this.$):null;if(!this.$.ob.Dwa||e.gii(C))if(117===M.keyCode&&(M.ctrlKey||G.b(M))){C=this.cWh(M.target);
var Q=!M.shiftKey;l.ULS.sendTraceTag(537166662,0,50,"AccessibilityManager.OnKeyDownHandler: Ctrl+F6 loop. The root index section is: {0}",C);r.AFrameworkApplication.ta.Qa.lz&&this.$.Bka&&1===C&&1===this.$.uxc&&y.ShyRibbon.xP(1,0);this.Dpf(Q,C,!0,M)}else 117!==M.keyCode||e.VQe?-411645385===this.$.shortcutKeyManager.Qt(M)?this.gdf()&&(C={},this.$.Ka.Kb(new F.a(-411645385,1,this.$.Jc,6,null),(C.event=M,C),M),M.stopPropagation()):1588554917===this.$.shortcutKeyManager.Qt(M)?0===this.mode?(T.a(this.$)||
(C={},this.$.Ka.Kb(new F.a(1588554917,1,this.$.Jc,6,null),(C.event=M,C),M)),M.preventDefault(),M.stopPropagation()):3===this.mode&&(M.preventDefault(),M.stopPropagation()):this.O1h(M):(M=x.a.qA.notificationBar.J$(m.a.oNh(),!1),M.image=0,x.a.qA.notificationBar.OD(M),e.VQe=!0)};e.prototype.cWh=function(M){for(var C=this.ord,Q=0,P=C.length;Q<P;++Q){var ka=C[Q];if(ka&&ka.$g(M))return Q}return-1};e.prototype.kZe=function(){for(var M=[],C=0,Q=this.dxa.length;C<Q;C++){var P=B.a(this.$).DM(this.dxa[C]);P&&
M.push(P)}return M};e.prototype.gdf=function(){return 0===this.mode||4===this.mode};e.gii=function(M){return M?M.inKeytipMode:!1};Mf.Object.defineProperties(e.prototype,{$:{configurable:!0,enumerable:!0,get:function(){return this.jb}},ord:{configurable:!0,enumerable:!0,get:function(){this.S8.length||(this.S8=this.kZe());return this.S8}},dxa:{configurable:!0,enumerable:!0,get:function(){return this.l9d},set:function(M){this.l9d=M;this.S8=this.kZe()}}});e.VQe=!1;Object(u.a)(e,"AccessibilityManager",
w.a,[660,3]);var U=b(155),J=b(22),H=b(15);Rk(d,e);d.prototype.Rla=function(M){this.$.Cd&65536&&e.prototype.Rla.call(this,M)};d.prototype.O1h=function(M){if(J.a.equals(this.Ipj,this.$.shortcutKeyManager.Fdd(M),!1)){var C=U.b(this.$);if(null===C||void 0===C?0:C.canReceiveFocus)G.g(M),C.Sf(!0,!1)}};Mf.Object.defineProperties(d.prototype,{mode:{configurable:!0,enumerable:!0,get:function(){return this.NB},set:function(M){this.NB=M;switch(M){case 0:this.dxa=this.eNg;break;case 2:this.dxa=this.qVj;break;
case 3:this.dxa=this.b0i;break;case 4:this.dxa=this.dVg;break;case 5:this.dxa=this.D_i;break;case 6:this.dxa=this.N_i;break;default:l.ULS.shipAssertTag(537170759,0,!0,"Accessibility Mode value is not in allowed values")}}}});Object(u.a)(d,"EwaAccessibilityManager",e,[]);var K=k.a;Rk(c,K);c.prototype.create=function(){this.pb(this.$.da.za(15)||new d(this.$))};c.ka=function(M){M.da.Ga(157,new c(M))};Object(u.a)(c,"AccessibilityManagerFactory",k.a,[]);var N=b(10);b.d(E,"a",function(){return a})},1435:function(u,
E,b){function a(){k.a.Fa(c.ka)}function c(D){var I=x.call(this)||this;I.$=D;I.Eb();return I}function d(D){var I=this;this.tg=function(){I.Ljf();I.$.ea.mn(I.tg)};this.$=D;this.U6f={};this.LTd={};var F=r.EwaSettings.isChangeGateEnabled("OfficeVSO:4431502_UseCommonIconSpriteInEwa")?"excelInitialAppSprite":"excelAppSprite",G=this.SYe(F);G?(this.tle(G),this.$.ea.Tg?this.Ljf():D.ea.il(this.tg),this.$.da.Ga(388,this)):l.ULS.sendTraceTag(537151263,0,15,"window[{0}].icons returned null.",F)}function e(){}
var k=b(10);u=b(0);var l=b(14),n=b(232),f=b(37),v=b(53),r=b(1),y=b(303),m=b(224);e.qNe="ewa-svg-icon";Object(u.a)(e,"CssClassNames",null,[]);var w=b(51),B=b(12),A=b(325),z=b(256);d.prototype.dispose=function(){this.LTd=null;this.$.ea.mn(this.tg)};d.prototype.nva=function(D,I,F,G,T){G=void 0===G?null:G;T=void 0===T?null:T;var O;(O=this.LTd[D])||(this.LTd[D]=O=this.xWi(this.U6f[D]));if(!O)return l.ULS.shipAssertTag(537151262,0,!1,"SvgIconProvider.GetSvgElement: id {0} was not found in loaded SVG sprites.",
D),null;var U=O.cloneNode(!0);if(!U.style){var J=A.b(O),H=A.b(U),K={};K.iconId=D;K.isOriginalNodeStyleNull=void 0===O.style||null===O.style;K.isOriginalNodeCurrentStyleNull=void 0===O.currentStyle||null===O.currentStyle;K.isClonedNodeCurrentStyleNull=void 0===U.currentStyle||null===U.currentStyle;K.originalNode=J.substring(0,J.indexOf(">")+1);K.clonedNode=H.substring(0,H.indexOf(">")+1);l.ULS.sendTraceTag(537151261,0,10,"SvgIconProvider.GetSvgElement: cloned element's style is undefined. data: {0}",
JSON.stringify(K))}D=String.format("height: {0}px; width: {0}px;",I,F);U.setAttribute("style",D);T&&(D=document.createElement("title"),D.innerHTML=T,U.insertBefore(D,U.childNodes[0]));if(G)for(G=bk(G),T=G.next();!T.done;T=G.next())Sys.UI.DomElement.addCssClass(U,T.value);return U};d.prototype.iba=function(D,I,F,G,T,O,U,J){T=void 0===T?0:T;O=void 0===O?0:O;U=void 0===U?null:U;J=void 0===J?null:J;T&&O||(O=B.DOMElementExtensions.getBoundingClientRect(G),T=O.height,O=O.width);if(U=this.nva(D,I,F,U,J))G.appendChild(U),
(G=B.DOMElementExtensions.jZ(U,"style",null))?U.setAttribute("style",G+String.format(" margin: {0}px {1}px;",(T-I)/2,(O-F)/2)):l.ULS.sendTraceTag(537151260,0,10,'SvgIconProvider.InsertAndCenterSvgElement: svgElement\'s GetAttribte("styl") returned null. Icon ID: {0}',D);return U};d.prototype.Ljf=function(){var D=this;f.TaskExtensions.Aa(w.GetServiceTaskFactory.Ra(this.$.da,283,284,0),function(I){I=z.c(I.result.tn.loadScript("excel-uiSlice20-sprite"));f.TaskExtensions.Aa(I,function(){var F=D.SYe("excelUiSlice20Sprite");
F?D.tle(F):l.ULS.sendTraceTag(537151259,0,15,"window[{0}].icons returned null.","excelUiSlice20Sprite")},D.$.la,3)},this.$.da.la,3)};d.prototype.tle=function(D){D=bk(D);for(var I=D.next();!I.done;I=D.next())I=I.value,I.type===m.a.JTd&&(this.U6f[I.id]=I)};d.prototype.xWi=function(D){if(!D)return null;var I=D.viewBox;D=D.children;var F=document.createElementNS(y.a.NTd,m.a.JTd);Sys.UI.DomElement.addCssClass(F,e.qNe);F.setAttribute("focusable","false");F.setAttribute("viewBox",I);this.yCg(F,D);return F};
d.prototype.yCg=function(D,I){I=bk(I);for(var F=I.next();!F.done;F=I.next()){F=F.value;var G=document.createElementNS(y.a.NTd,F.type),T;for(T in F){var O=T,U=F[T];"className"===O?G.setAttribute("class",U):G.setAttribute(O,U)}D.appendChild(G)}};d.prototype.SYe=function(D){return(D=window[D])?D.icons:null};Object(u.a)(d,"SvgIconProvider",null,[636,3]);var x=n.a;Rk(c,x);c.prototype.create=function(){var D=this;f.TaskExtensions.Aa(v.a.BV([127],4,this.hb,void 0,void 0,void 0,387),function(){var I=r.EwaSettings.isChangeGateEnabled("OfficeVSO:4431502_UseCommonIconSpriteInEwa")?
"excelInitialAppSprite":"excelAppSprite";window[I]?D.pb(D.$.da.za(388)||new d(D.$)):l.ULS.sendTraceTag(537151258,0,50,"window.[{0}] returned null.",I)},this.la,3)};c.ka=function(D){D.da.Ga(387,new c(D))};Object(u.a)(c,"SvgIconProviderFactory",n.a,[]);b.d(E,"a",function(){return a})},1456:function(u,E,b){function a(){e.a.Fa(c.ka)}function c(r){var y=v.call(this)||this;y.sparklineManager=null;y.$=r;y.Eb();return y}function d(r,y){r=f.call(this,r)||this;y.Ga(240,r);return r}var e=b(10);u=b(0);var k=
b(232),l=b(21),n=b(1326),f=n.a;Rk(d,f);d.prototype.iXh=function(r){for(var y=bk(this.rangeList),m=y.next();!m.done;m=y.next())if(m=m.value,r.range.contains(m))return m;return null};d.prototype.uFd=function(r){return r.GridBlockModel&&(r=gridRenderer.CanvasRendererFactoryGlobal.getModelAccessor(r.GridBlockModel))?r.getSparklineRanges():null};Object(u.a)(d,"SparklineManager",n.a,[639]);var v=k.a;Rk(c,v);c.prototype.create=function(){this.pb(this.sparklineManager||(this.sparklineManager=new d(l.g(this.$),
this.$.da)))};c.ka=function(r){r.da.Ga(239,new c(r))};Object(u.a)(c,"SparklineManagerFactory",k.a,[]);b.d(E,"a",function(){return a})},1482:function(u,E,b){function a(){l.a.ml.Ga(141,new c)}function c(){return k.call(this)||this}u=b(0);var d=b(149),e=b(695),k=e.a;Rk(c,k);c.prototype.dispose=function(){d.WacAirSpace.Bld()&&d.WacAirSpace.Czc()};c.prototype.animate=function(n,f,v,r,y){f&&d.WacAirSpace.RK(n.element,f);d.WacAirSpace.animate(n,r,y);v&&d.WacAirSpace.i9i(n.element,v)};Object(u.a)(c,"AnimationManager",
e.a,[3]);var l=b(102);b.d(E,"a",function(){return a})},1654:function(u,E,b){function a(K){var N=T.call(this)||this;N.$=K;N.Eb();return N}function c(K){var N=G.call(this)||this;N.hsd=null;N.$=K;B.ULS.sendTraceTag(537155201,0,50,"NewAndOpenCoreManager created");return N}b.r(E);u=b(1395);E=b(1360);var d=b(1322),e=b(1323),k=b(1324),l=b(1327);b(1325);var n=b(1434),f=b(1482),v=b(10),r=b(0),y=b(232),m=b(202),w=b(615),B=b(14),A=b(1019),z=b(567),x=b(83),D=b(4),I=b(79),F=b(1114),G=I.a;Rk(c,G);c.prototype.Qgj=
function(){var K=new m.a,N=z.a.Jq(x.a.instance.Tb("Common.IEventEmitter<Common.IMruResult>")),M=new w.a(function(){return N.result});this.hsd=new w.a(function(){return new A.a(M.value,null)});if(!this.hsd)return K;var C=this.hsd.value.uZ("NewAndOpenCoreManager",!1);if(!C||3!==C.state||!C.Xvd)return C?B.ULS.sendTraceTag(544289226,0,50,"NewAndOpenCoreManager.RetrieveMruFiles - the mruResult state: {0}, mruResult MruDocuments is null: {1}",C.state,!C.Xvd):B.ULS.sendTraceTag(544289227,0,50,"NewAndOpenCoreManager.RetrieveMruFiles: the mruResult is null"),
null;C=C.Xvd;for(var Q=["xlsx","xlsb","xlsm"],P=0;P<C.length;P++){var ka=C[P];if(!(0>Array.indexOf(Q,ka.extension))){var R=String.format("{0}.{1}",ka.title,ka.extension),fa=F.b(ka,D.AFrameworkApplication.isRtl);ka=ka.url;if(R&&fa&&ka){var ca={};K.add((ca[c.fileName]=R,ca[c.friendlyPath]=fa,ca[c.section]="mru",ca[c.absoluteUrl]=ka,ca))}else ka||B.ULS.sendTraceTag(537155200,0,50,"ChangeSourceDialog.GetMruFiles: the DAV url of the file is null")}}return K};c.prototype.dispose=function(){G.prototype.dispose.call(this)};
c.fileName="FileName";c.friendlyPath="FriendlyPath";c.section="Section";c.absoluteUrl="AbsoluteUrl";Object(r.a)(c,"NewAndOpenCoreManager",I.a,[640,3]);var T=y.a;Rk(a,T);a.prototype.create=function(){this.pb(this.$.da.za(451)||this.$.da.Ga(451,new c(this.$)))};a.ka=function(K){K.da.Ga(164,new a(K))};Object(r.a)(a,"NewAndOpenCoreFactory",y.a,[]);r=b(1357);y=b(1456);I=b(1435);var O=b(1401),U=b(1358),J=b(1347),H=b(1367);b=b(1340);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.GridHighlightsBehavior");
Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.SheetTabBar");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.SvgIconProvider");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Table");Type.registerNamespace("_Ewa");Object(u.a)();Type.registerNamespace("Common.App.AltTextDialog");Object(E.a)();Object(d.a)();Object(e.a)();Object(k.a)();Object(n.a)();v.a.Fa(a.ka);Object(f.a)();Object(r.a)();Object(y.a)();Object(I.a)();Object(l.a)();Object(O.a)();Object(U.a)();Object(J.a)();
Type.registerNamespace("Common.App.SessionExpiration");Object(H.a)();Object(b.a)()}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.acc.js.map/91227b055df44228a19f39c3c69b2178/EwaDS.acc.js.map