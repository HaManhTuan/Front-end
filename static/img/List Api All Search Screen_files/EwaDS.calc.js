(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[14],{1002:function(u,E,b){function a(){}b.d(E,"a",function(){return a});u=b(0);a.abs="Abs";a.rel="Rel";Object(u.a)(a,"PositionBaseType",null,[])},1016:function(u,E,b){function a(I){this.calcManager=I}function c(){return v.call(this)||this}function d(){this.secondRow=this.firstRow=null;return this}function e(){return v.call(this)||this}function k(){this.right=this.left=this.bottom=this.top=null;return this}function l(){return v.call(this)||
this}function n(){this.secondColumn=this.firstColumn=null;return this}function f(){var I=v.call(this)||this;I.fhc=!1;return I}function v(){this.end=this.start=0;this.$u=null}function r(){this.column=this.row=null;return this}function y(){}b.r(E);u=b(0);var m=b(7),w=b(14);Object(u.a)(y,"Reference",null,[]);Rk(r,y);Object(u.a)(r,"CellReference",y,[]);v.prototype.UJg=function(I,F){for(var G=0;G<this.$u.length;G++){var T=this.t_b(I,this.$u[G]);F+=T;G<this.$u.length-1&&(F+=":")}return F};Object(u.a)(v,
"IReferenceSequence",null,[]);var B=b(24),A=b(1002);Rk(f,v);f.prototype.pbc=function(){var I=b(1016).RelativeAndAbsoluteReferencesManager,F=this.$u[0];return I.Kqf(F.row.kind===A.a.abs,F.column.kind===A.a.abs)};f.prototype.t_b=function(I,F){F=B.Range.Tc(F.row.index+1,F.column.index+1);return this.fhc?F.Bac(1===I||3===I,1===I||2===I):F.W3a(1===I||3===I,1===I||2===I,!0,!0)};Object(u.a)(f,"CellReferenceSequence",v,[]);Rk(n,y);Object(u.a)(n,"ColumnReference",y,[]);Rk(l,v);l.prototype.pbc=function(){var I=
this.$u[0];return b(1016).RelativeAndAbsoluteReferencesManager.epf(I.firstColumn,I.secondColumn).kind===A.a.abs?2:3};l.prototype.t_b=function(I,F){return B.Range.fub(F.firstColumn.index+1,F.secondColumn.index+1).W3a(1===I||3===I,!0,1===I||3===I,!0)};Object(u.a)(l,"ColumnReferenceSequence",v,[]);Rk(k,y);Object(u.a)(k,"RangeReference",y,[]);Rk(e,v);e.prototype.pbc=function(){var I=b(1016).RelativeAndAbsoluteReferencesManager,F=this.$u[0];return I.Kqf(F.top.kind===A.a.abs,F.left.kind===A.a.abs)};e.prototype.t_b=
function(I,F){F=new B.Range(F.top.index+1,F.left.index+1,F.bottom.index+1,F.right.index+1,!1,!1);var G=1===I||3===I;I=1===I||2===I;return F.W3a(G,I,G,I)};Object(u.a)(e,"RangeReferenceSequence",v,[]);Rk(d,y);Object(u.a)(d,"RowReference",y,[]);Rk(c,v);c.prototype.pbc=function(){var I=this.$u[0];return b(1016).RelativeAndAbsoluteReferencesManager.epf(I.firstRow,I.secondRow).kind===A.a.abs?0:1};c.prototype.t_b=function(I,F){return B.Range.m$b(F.firstRow.index+1,F.secondRow.index+1).W3a(!0,1===I||2===
I,!0,1===I||2===I)};Object(u.a)(c,"RowReferenceSequence",v,[]);var z=b(1184),x=b(1185),D=b(206);b.d(E,"RelativeAndAbsoluteReferencesManager",function(){return a});a.prototype.J0a=function(I,F,G){var T=F;var O=G;if(!I||!D.f(I))return{returnValue:I,Pwd:T,Owd:O};var U=this.calcManager.RQe(I);if(!U)return w.ULS.sendTraceTag(524039641,0,15,"RelativeAndAbsoluteReferencesManager.CycleThroughRelativeAndAbsoluteReferences: Couldn't extract references (might be invalid formula)"),{returnValue:null,Pwd:T,Owd:O};
U=this.pWh(U,I,F,G);for(var J=0,H="",K=0,N=0;N<U.length;N++)if(this.aIe(U[N],F,G)){J=U[N].pbc();T=U[N].start;break}for(;N<U.length&&this.aIe(U[N],F,G);N++)H+=I.substring(K,U[N].start),H=U[N].UJg(J,H),K=U[N].end;K&&(O=H.length);H+=I.substring(K,I.length);return{returnValue:H,Pwd:T,Owd:O}};a.prototype.pWh=function(I,F,G,T){for(var O=[],U=0;U<I.length;U++){var J=I[U];if(J.kind===z.a.range)if(J=J.ref,J.type===x.a.cell){var H=J;J=Object(m.a)(new f,{start:J.span.start,end:J.span.end,$u:[Object(m.a)(new r,
{column:H.col,row:H.row})],fhc:this.calcManager.I1b(J.span.end,F)});O.push(J)}else if(J.type===x.a.range)this.bIe(J.topLeftSpan,G,T)&&this.bIe(J.bottomRightSpan,G,T)?(H=new k,J.top.index<=J.bottom.index?(H.top=J.top,H.bottom=J.bottom):(H.bottom=J.top,H.top=J.bottom),J.left.index<=J.right.index?(H.left=J.left,H.right=J.right):(H.right=J.left,H.left=J.right),J=Object(m.a)(new e,{start:J.topLeftSpan.start,end:J.bottomRightSpan.end,$u:[H]}),O.push(J)):(H=Object(m.a)(new f,{start:J.topLeftSpan.start,end:J.topLeftSpan.end,
$u:[Object(m.a)(new r,{column:J.left,row:J.top})],fhc:this.calcManager.I1b(J.topLeftSpan.end,F)}),J=Object(m.a)(new f,{start:J.bottomRightSpan.start,end:J.bottomRightSpan.end,$u:[Object(m.a)(new r,{column:J.right,row:J.bottom})],fhc:this.calcManager.I1b(J.topLeftSpan.end,F)}),O.push(H),O.push(J));else if(J.type===x.a.column){H=J;for(J=Object(m.a)(new l,{start:J.span.start,end:J.span.end,$u:[Object(m.a)(new n,{firstColumn:H.startIndex,secondColumn:H.endIndex})]});J.end<F.length-1&&":"===F.charAt(J.end)&&
U<I.length-1;)if(H=I[U+1].ref,H.type===x.a.column&&H.span.start===J.end+1){var K=H;J.$u.push(Object(m.a)(new n,{firstColumn:K.startIndex,secondColumn:K.endIndex}));J.end=H.span.end;U++}else break;O.push(J)}else if(J.type===x.a.row){H=J;for(J=Object(m.a)(new c,{start:J.span.start,end:J.span.end,$u:[Object(m.a)(new d,{firstRow:H.startIndex,secondRow:H.endIndex})]});J.end<F.length-1&&":"===F.charAt(J.end)&&U<I.length-1;)if(H=I[U+1].ref,H.type===x.a.row&&H.span.start===J.end+1)K=H,J.$u.push(Object(m.a)(new d,
{firstRow:K.startIndex,secondRow:K.endIndex})),J.end=H.span.end,U++;else break;O.push(J)}}return O};a.prototype.aIe=function(I,F,G){return!(I.start>G||F>I.end)};a.prototype.bIe=function(I,F,G){return!(I.start>G||F>I.end)};a.epf=function(I,F){return I.index<=F.index?I:F};a.Kqf=function(I,F){return F||I?F&&I?2:!F&&I?3:0:1};Object(u.a)(a,"RelativeAndAbsoluteReferencesManager",null,[527])},1146:function(u,E,b){function a(B){var A=this;this.$=B;(this.fz=this.$.da.za(268))||d.ULS.shipAssertTag(537170070,
0,!1,"CalcHelper constructor - IInstantaneousSupportInformationManager is not available");var z=r.EwaSettings.isChangeGateEnabled("OfficeVSO:5543503_loadCalcCurrentVersion")?v.a.current.Ro(75):v.a.current.Ro(78);this.logger=new f.a;this.documentLoc=excelOnlineCalc.location.documentLoc("",this.$.workbookContext.FullDocumentInfo.BreadcrumbDocName);this.Vba=new c(B,this.fz);excelOnlineCalc.config.initCalc(this.logger,this.fz?function(x){return A.fz.isFeatureEnabled(x)}:function(){return!1},z);this.Ylg=
excelOnlineCalc.config.calcConfig(this.Vba.localeInfo)}function c(B,A){B=b(1146).CalcHelper;A&&(A.we||d.ULS.shipAssertTag(537169942,0,!1,"LocaleHolder constructor - locale information is not available"));this.Frg=B.WCe(A,B.ICe(A.Yia));this.Grg=excelOnlineCalc.calc.localeInfoFromData(this.localeData)}b.r(E);u=b(0);var d=b(14),e=b(276),k;(function(B){B[B.paren=0]="paren";B[B.lead=1]="lead";B[B.intern=2]="intern";B[B.trail=3]="trail";B[B.undefined=4]="undefined"})(k||(k={}));Object(u.b)("CurrencyFormatOption",
k);var l;(function(B){B[B.none=-1]="none";B[B.mdy=0]="mdy";B[B.dmy=1]="dmy";B[B.ymd=2]="ymd";B[B.myd=3]="myd";B[B.dym=4]="dym";B[B.ydm=5]="ydm"})(l||(l={}));Object(u.b)("DateOrderOption",l);var n=b(8);c.prototype.formatNumber=function(B){return this.localeInfo.formatNumber(B)};Mf.Object.defineProperties(c.prototype,{localeInfo:{configurable:!0,enumerable:!0,get:function(){return this.Grg}},localeData:{configurable:!0,enumerable:!0,get:function(){return this.Frg}}});Object(u.a)(c,"LocaleHolder",null,
[]);var f=b(1182),v=b(53),r=b(1),y=b(22),m=b(15),w=b(205);b.d(E,"CalcHelper",function(){return a});a.prototype.mah=function(){if(r.EwaSettings.isChangeGateEnabled("OfficeVSO:4986015_LetAutocompleteTelemetry")){if(!this.$.va)return d.ULS.shipAssertTag(537170069,0,!1,"CalcHelper.CurrentSheetIndex() - this.ewaControl.Sheets is null"),0;var B=this.$.va.pa;return B?B.index:(d.ULS.shipAssertTag(537170068,0,!1,"CalcHelper.CurrentSheetIndex() - sheet is null"),0)}return this.$.va.pa.index};a.prototype.createParser=
function(){var B={};B.config=this.config;return excelOnlineCalc.parse.createParser(B)};a.prototype.createNumberFormatter=function(){var B=this,A=excelOnlineCalc.numfmt.createFormatGlobals(this.config,function(z,x){return excelOnlineCalc.calc.getTime(B.config,z,x,"Estimation")});return excelOnlineCalc.numfmt.createNumberFormatter(A)};a.prototype.x9g=function(B,A,z,x){if(!x)return{range:{row:A,col:z},sheet:{document:this.documentLoc,index:B}};A=excelOnlineCalc.location.gridCell(A,z);B=excelOnlineCalc.location.sheetIndex(this.documentLoc,
B);return excelOnlineCalc.location.sheetGridCell(B,A)};a.prototype.Glh=function(B,A){var z=excelOnlineCalc.calc.getEvalResultKind(B);switch(z){case 4:return{returnValue:B?this.Vba.localeInfo.trueName:this.Vba.localeInfo.falseName,kind:z};case 1:return{returnValue:r.EwaSettings.isChangeGateEnabled("OfficeVSO:3594728_SupportEvaluatingArrayOpersToString")?this.Vzc(this.Vba.formatNumber(B),A):this.Vba.formatNumber(B),kind:z};case 2:return{returnValue:r.EwaSettings.isChangeGateEnabled("OfficeVSO:3594728_SupportEvaluatingArrayOpersToString")?
this.Vzc(B.toString(),A):B.toString(),kind:z};case 128:return{returnValue:"",kind:z};case 8:switch(B.type){case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:return{returnValue:this.Vba.localeInfo.errorNames[B.type],kind:z};default:return{returnValue:a.unknownError,kind:z}}case 32:return{returnValue:r.EwaSettings.isChangeGateEnabled("OfficeVSO:3594728_SupportEvaluatingArrayOpersToString")?this.Vzc(this.O9g(B,A),A):"##UNSUPPORTED: ARRAY",kind:z};default:return{returnValue:m.a.instance.ga(2188),
kind:z}}};a.prototype.Vzc=function(B,A){return B.length<=A?B:B.substring(0,A-3)+"..."};a.prototype.O9g=function(B,A){for(var z=this.Vba.localeInfo.leftBrace,x=0;x<B.rows;++x){for(var D=0;D<B.cols;++D)z+=B.opers[x][D],D<B.cols-1&&(z+=this.Vba.localeInfo.columnSeparator);x<B.rows-1&&(z+=this.Vba.localeInfo.rowSeparator)}return this.Vzc(z,A-1)+this.Vba.localeInfo.rightBrace};a.WCe=function(B,A){A=void 0===A?null:A;var z=a.n4b(),x=B.we.TrueValueString,D=B.we.FalseValueString,I=B.we.DecimalSeparator.toString(),
F=B.we.ListSeparator.toString(),G=B.we.ColumnSeparator.toString(),T=B.we.RowSeparator.toString(),O=B.we.ThousandsDataArray,U=B.we.ThousandSeparator.toString(),J=B.we.Lcid,H=B.we.Country,K=B.we.DigitsNumber,N=B.we.ExpSeparatedBySpace,M=B.we.FractionSeparator.toString(),C=B.we.PercentSeparatedBySpace,Q=y.a.BUg(Enum.toString(k,B.we.CurrencyFormat)),P=B.we.CurrencySymbolLead,ka=B.we.CurrencySeparatedBySpace,R=B.we.CurrencySymbolString,fa=B.we.DigitsCurrency,ca=-1===B.we.DateOrder?"MDY":w.e(Enum.toString(l,
B.we.DateOrder)),ea=B.we.DateSeparator.toString(),wa=B.we.DateAlternativeSeparator.toString(),X=B.we.Year4Digits,ja=B.we.Month2Digits,va=B.we.Day2Digits,ua=B.we.LongDateFormat,Xa=B.we.TimeSeparator.toString(),aa=B.we.TimeAltSeparator,ba=B.we.Hour2Digits,oa=B.we.Use24HourClock,ra=B.we.AmPmSeparatedBySpace,db=[B.we.AmString,B.we.PmString],Ka=B.we.DayNameShortArray,Ga=B.we.DayNameLongArray,xa=B.we.MonthNameShortArray,da=B.we.MonthNameLongArray,qa=B.we.PictureSpecialArray,na=e.a.map(("\x00"+B.we.PictureSingleString).split(""),
function(La){return"\x00"===La?null:La}),ia=B.we.PictureColorArray,ta=B.we.PictureDbnumArray,za=B.we.RowLetter.toString(),sa=B.we.ColumnLetter.toString(),V=B.we.LeftBrace.toString(),Ia=B.we.RightBrace.toString(),Ha=B.we.LeftBracket.toString(),ob=B.we.RightBracket.toString(),ib=a.kXh(B.we);return excelOnlineCalc.calc.localeData(A,z,x,D,za,sa,V,Ia,Ha,ob,I,F,G,T,O,U,J,H,K,N,M,C,Q,P,ka,R,fa,ca,ea,wa,X,ja,va,ua,Xa,aa,ba,oa,ra,db,Ka,Ga,xa,da,qa,na,ia,ta,ib,B.we.SysDateFormatString,B.we.SysTimeFormatString)};
a.ICe=function(B){var A=[];if(!B)return A;B=bk(B);for(var z=B.next();!z.done;z=B.next()){z=z.value;var x=null;z.IsDynamicUdf||(x=excelOnlineCalc.calc.worksheetFunctionName(z.FunctionIndexInServer,z.NameUI));x&&A.push(x)}return A};a.n4b=function(){for(var B=[],A=Object.keys(n.a.errorNames),z=0;z<A.length;z++){var x=excelOnlineCalc.calc.errorTypeName(z+1,A[z]);x&&B.push(x)}return B};a.kXh=function(B){var A=Array(6);A[1]="#"+B.AllStructRefString;A[3]="#"+B.HeadersStructRefString;A[2]="#"+B.DataStructRefString;
A[4]="#"+B.TotalsStructRefString;A[5]="#"+B.ThisRowStructRefString;return A};Mf.Object.defineProperties(a.prototype,{config:{configurable:!0,enumerable:!0,get:function(){return this.Ylg}}});a.unknownError="##ERR##";Object(u.a)(a,"CalcHelper",null,[])},1184:function(u,E,b){function a(){}b.d(E,"a",function(){return a});u=b(0);a.Vri="literal";a.operator="operator";a.func="function";a.namedRange="namedRange";a.range="range";a.kjf="letName";a.all="*";a.jTd="structRefRange";Object(u.a)(a,"TraverseFormulaInterestTypes",
null,[])},1185:function(u,E,b){function a(){}b.d(E,"a",function(){return a});u=b(0);a.cell="cell";a.range="range";a.row="row";a.column="col";Object(u.a)(a,"TraverseFormulaRefTypes",null,[])},1361:function(u,E,b){function a(){xa.a.Fa(c.ka)}function c(da){var qa=Ga.call(this)||this;qa.$=da;qa.Eb();return qa}function d(da){var qa=ra.call(this)||this;qa.Wq=null;qa.rfg=!1;qa.EFb=null;qa.instantaneousSupportInformationManager=null;qa.vKd=null;qa.Gxd=new Map;qa.$ae=null;qa.fnc=function(na){A.ULS.sendTraceTag(537170005,
0,50,"CalcManager.OnLocaleInformationAvailable() called");na.tId(qa.fnc);na.Yia.length?qa.Mmc(na,Sys.EventArgs.Empty):(A.ULS.sendTraceTag(537170004,0,50,"CalcManager.OnLocaleInformationAvailable() - waiting for functions information"),na.rme(qa.Mmc))};qa.Mmc=function(na){A.ULS.sendTraceTag(537170003,0,50,"CalcManager.OnFunctionsInfoReady called");na.kId(qa.Mmc);qa.HMj(na)};qa.onContentReady=function(){qa.Wq&&(qa.instantaneousSupportInformationManager&&qa.instantaneousSupportInformationManager.cld||
ua.Task.delay(0).continueWith(function(){qa.Wq.Keb(1)},0,null,Xa.a.current))};qa.ptf=function(na,ia){qa.Wq&&(qa.instantaneousSupportInformationManager&&qa.instantaneousSupportInformationManager.cld||qa.Wq.eEe(ia.Zc.block))};A.ULS.sendTraceTag(537170067,0,50,"Creating CalcManager");qa.Wld=!1;qa.jb=da;qa.Mq=ka.g(da);qa.jFc=null;qa.gridView.yu(qa.onContentReady);qa.gridView.Ea.hUc(qa.ptf);qa.$.da.Za(268,function(na){na.we?(A.ULS.sendTraceTag(537170066,0,50,"CalcManager.ctor: LocaleInformation already available..."),
qa.fnc(na,Sys.EventArgs.Empty)):(A.ULS.sendTraceTag(537170065,0,50,"CalcManager.ctor: waiting for LocaleInformation..."),na.Mme(qa.fnc))});return qa}function e(da){var qa=oa.call(this)||this;qa.rk=da;return qa}function k(){}function l(){}function n(){this.E4=this.G4=this.LZ=this.MZ=this.Mwa=!1}function f(da){var qa=this;this.dGd=null;this.Osd=this.cGd=this.KEb=!1;this.ZDd=0;this.PDd=this.RDd=this.SDd=this.QDd=-1;this.trueName="TRUE";this.falseName="FALSE";this.instantaneousSupportInformationManager=
this.Fm=this.errorTypeNames=null;this.Mp=this.currentStateId=-1;this.cta="";this.O$=null;this.getNameLoc=function(na,ia){return qa.Igc()?qa.Qe.na(qa.currentStateId).vj[0].R5.kb(ia)?(na=excelOnlineCalc.location.nameLoc(na,ia),excelOnlineCalc.util.success(na)):excelOnlineCalc.util.success(null):(na=excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure(na))};this.getContainingTable=function(na){if(!qa.Igc())return na=excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure(na);
var ia=na.range.col,ta=na.range.row,za=qa.Qe.na(qa.currentStateId).vj[0].R5,sa=null;za=bk(za);for(var V=za.next();!V.done;V=za.next())if(V=V.value.value,2===V.type&&G.a.equals(na.sheet.index.toString(),V.sheetId,!0)){var Ia=V.range;ia>=Ia.left-1&&ia<=Ia.right-1&&ta<=Ia.bottom-1&&ta>=Ia.top-1&&(sa=excelOnlineCalc.location.nameScope(qa.documentLoc,V.sheetId),sa=excelOnlineCalc.location.nameLoc(sa,V.fullName))}return sa?excelOnlineCalc.util.success(sa):excelOnlineCalc.util.success(null)};this.getStructRefColumn=
function(na,ia){if(!qa.Igc()){var ta=excelOnlineCalc.util.unavailable([2]);return excelOnlineCalc.util.failure(ta)}ta=na.name;var za=qa.Qe.na(qa.currentStateId).vj[0].R5;if(za.kb(ta)){za=za.na(ta);var sa=za.range;if(2!==za.type)return excelOnlineCalc.util.failure(qa.X2c(5));var V=za.iE?za.iE.v$:null;if(!V)return excelOnlineCalc.util.success(null);for(var Ia=bk(V),Ha=Ia.next();!Ha.done;Ha=Ia.next())if(Ha=Ha.value,G.a.equals(Ha.value,ia,!0))return na=excelOnlineCalc.location.documentLoc(na.scope.document.path,
na.scope.document.name),na=excelOnlineCalc.location.sheetIndex(na,za.sheetId),sa=excelOnlineCalc.location.gridRange(sa.top-1,Ha.key,sa.bottom-sa.top+1,1),sa=excelOnlineCalc.location.sheetGridRange(na,sa),ta=excelOnlineCalc.location.structRefColumnLoc(ta,sa,!!(za.attributes&16),!!(za.attributes&8)),excelOnlineCalc.util.success(ta);return sa.right-sa.left+1!==V.count?(ta=excelOnlineCalc.util.unavailable([17,na,ia]),excelOnlineCalc.util.failure(ta)):excelOnlineCalc.util.failure(qa.X2c(0))}return excelOnlineCalc.util.success(null)};
this.getStructRefSpecialRef=function(na,ia){if(!qa.Igc())return ia=excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure(ia);var ta=qa.Qe.na(qa.currentStateId).vj[0].R5;if(ta.kb(na.name)){var za=ta.na(na.name);if(2!==za.type)return excelOnlineCalc.util.failure(qa.X2c(5));ta=!!(za.attributes&16);var sa=!!(za.attributes&8),V=ta?1:0,Ia=sa?1:0;na=excelOnlineCalc.location.documentLoc(na.scope.document.path,na.scope.document.name);na=excelOnlineCalc.location.sheetIndex(na,za.sheetId);za=za.range;
var Ha={};if(1===ia)Ha=excelOnlineCalc.location.gridRange(za.top-V-1,za.left-1,za.bottom+Ia-za.top+V+1,za.right-za.left+1);else if(2===ia)Ha=excelOnlineCalc.location.gridRange(za.top-1,za.left-1,za.bottom-za.top+1,za.right-za.left+1);else if(3===ia)if(ta)Ha=excelOnlineCalc.location.gridRange(za.top-2,za.left-1,1,za.right-za.left+1);else return excelOnlineCalc.util.success(null);else if(4===ia)if(sa)Ha=excelOnlineCalc.location.gridRange(za.bottom,za.left-1,1,za.right-za.left+1);else return excelOnlineCalc.util.success(null);
ia=excelOnlineCalc.location.sheetGridRange(na,Ha);return excelOnlineCalc.util.success(ia)}return excelOnlineCalc.util.success(null)};this.getDocumentLoc=function(na,ia){if((G.a.equals(na,qa.documentLoc.path,!0)||!na)&&G.a.equals(ia,qa.documentLoc.name,!0))return excelOnlineCalc.util.success(qa.documentLoc);na=excelOnlineCalc.util.unavailable([0,excelOnlineCalc.location.documentLoc(na,ia)]);return excelOnlineCalc.util.failure(na)};this.getSheetIndex=function(na,ia){if(!qa.Qe.kb(qa.currentStateId)||
!qa.Qe.na(qa.currentStateId).vj)return ia=excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure(ia);na=qa.Qe.na(qa.currentStateId).vj;for(var ta=1;ta<na.length;ta++)if(G.a.equals(na[ta].o7.sheetName,ia,!0))return excelOnlineCalc.util.success(na[ta].o7.sheetId);return excelOnlineCalc.util.success(null)};this.getSheetName=function(na,ia){if(!qa.Qe.kb(qa.currentStateId)||!qa.Qe.na(qa.currentStateId).vj)return ia=excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure(ia);na=qa.Qe.na(qa.currentStateId).vj;
for(var ta=1;ta<na.length;ta++)if(G.a.equals(na[ta].o7.sheetId,ia,!0))return excelOnlineCalc.util.success(na[ta].o7.sheetName);return excelOnlineCalc.util.success(null)};this.getUserDefinedFuncLoc=function(){return excelOnlineCalc.util.notImplemented(["ParseGlobals.GetUserDefinedFuncLoc not implemented in main thread"])};this.getSheetRangeIndexes=function(){return excelOnlineCalc.util.notImplemented(["ParseGlobals.GetSheetRangeIndexes not implemented in main thread"])};this.dzf=function(){qa.setNumberFormats()};
this.Yc=function(){A.ULS.sendTraceTag(537170081,0,50,"CalcAsyncEngine.OnWorkbookOpened() called");qa.Qe=new C.a;qa.Mp=-1;qa.currentStateId=-1;qa.cta="";qa.Arb=null;qa.cGd=!1;qa.Fm&&qa.clearCache()};this.k4f=(this.Dc=da)?da.ya.CalcWebWorkerSmokeTestPingIntervalMS:this.k4f;this.Qe=new C.a;this.Arb=null;this.documentLoc=excelOnlineCalc.location.documentLoc("",this.Dc.workbookContext.FullDocumentInfo.BreadcrumbDocName);this.moa();this.snd=N.a.snd()}function v(da){this.y2d=null;this.init(da)}function r(){}
function y(da){this.o7=da;this.R5=new T.a(O.a.Ik());this.llc=!1}function m(da){this.Jdg=da;this.Afe=[];this.fbg=[];this.YZa={};this.uPd=new Map}function w(da,qa,na,ia,ta){this.type=da;this.fullName=qa;this.range=na;this.sheetId=ia;this.attributes=ta;this.iE=null}function B(da,qa){this.yue=da;this.sheetName=qa;this.Ruc=!1}u=b(0);var A=b(14),z=b(232),x=b(8),D=b(113),I=b(202),F=b(85);Object(u.a)(B,"CalcBlockInformation",null,[]);Object(u.a)(w,"CalcNamedObject",null,[]);var G=b(22);m.prototype.TZf=function(da,
qa){this.Afe[da]=qa;this.Jdg&&qa.o7&&this.uPd.set(qa.o7.sheetName,da)};m.prototype.getSheetIndex=function(da){if(this.Jdg){if(this.uPd.has(da))return this.uPd.get(da)}else for(var qa=1;qa<this.vj.length;qa++)if(G.a.equals(this.vj[qa].o7.sheetName,da,!1))return qa;return-1};Mf.Object.defineProperties(m.prototype,{vj:{configurable:!0,enumerable:!0,get:function(){return this.Afe}}});Object(u.a)(m,"GridCache",null,[]);var T=b(894),O=b(616);Object(u.a)(y,"SheetInformation",null,[]);var U=b(1146),J;(function(da){da[da.initialization=
0]="initialization";da[da.contentReady=1]="contentReady";da[da.cellEdit=2]="cellEdit"})(J||(J={}));Object(u.b)("UpdateDataTrigger",J);var H=b(64);r.local="Local";r.cIj="Thread";Object(u.a)(r,"RecalcServiceCreateMode",null,[]);var K=b(45),N=b(36),M=b(169),C=b(171);v.prototype.init=function(da){this.y2d=new C.a;if(void 0!==da&&null!==da&&void 0!==da.HeadersList&&null!==da.HeadersList&&0<da.HeadersList.length){da=bk(da.HeadersList);for(var qa=da.next();!qa.done;qa=da.next())qa=qa.value,this.v$.ia(qa.Index,
qa.Name)}};Mf.Object.defineProperties(v.prototype,{v$:{configurable:!0,enumerable:!0,get:function(){return this.y2d}}});Object(u.a)(v,"ColHeadersListData",null,[]);var Q=b(1),P=b(101),ka=b(21),R=b(206);b(205);var fa=b(256);f.prototype.dispose=function(){this.instantaneousSupportInformationManager&&this.instantaneousSupportInformationManager.tId(this.dzf);this.Dc&&this.Dc.rl(this.Yc);this.close()};f.prototype.Keb=function(da){if(!this.Fm)return!1;if(!this.instantaneousSupportInformationManager&&(this.instantaneousSupportInformationManager=
this.Dc.da.za(268),!this.instantaneousSupportInformationManager))return A.ULS.sendTraceTag(537170198,0,50,"CalcAsyncEngine.UpdateData Failed to get instantaneousSupportInformationManager"),!1;2!==da&&(this.currentStateId=this.Dc.ea.bjc,this.currentStateId===x.a.Ee&&(this.currentStateId=this.Dc.ea.Ue));if(1===da&&this.currentStateId<this.Mp)return A.ULS.sendTraceTag(537170197,0,50,"CalcAsyncEngine::UpdateData() currentStateId:{0} < lastUpdatedStateId:{1} - ignoring update",this.currentStateId,this.Mp),
!1;this.Moj();0!==da&&this.cGd||(this.dtj(),this.kqj(),this.Wqj(),this.setNumberFormats(),this.instantaneousSupportInformationManager.Mme(this.dzf),this.Dc.Tk(this.Yc),this.cGd=!0);this.F5i();var qa=!1;0===da&&(qa=this.v$h());if(0!==da||qa)this.psj()?(this.Tsj(da),this.Ssj(),this.Mp=this.currentStateId,this.hXg()):A.ULS.sendTraceTag(537170196,0,15,"CalcAsyncEngine::UpdateData() for StateId:{0} failed - no Sheets information",this.currentStateId);2!==da&&this.resumeRecalc();return!0};f.prototype.evalFormula=
function(da){if(!this.Fm)return A.ULS.sendTraceTag(537170195,0,15,"CalcAsyncEngine.EvalFormula: recalc engine is null"),Promise.resolve({});da=this.Fm.evalFormula(this.Dc.ea.Ue,da,H.d(this.Dc.va.pa));this.resumeRecalc();return da};f.prototype.evalFormulaRange=function(da,qa,na){if(!this.Fm)return A.ULS.sendTraceTag(537170194,0,15,"CalcAsyncEngine.EvalFormulaRange: recalc engine is null"),Promise.reject(null);A.ULS.shipAssertTag(537170193,0,qa.isSingle,"CalcAsyncEngine.EvalFormulaRange: originCell Range must be a single cell.");
na=K.j(na);qa=K.o(qa,this.Dc);qa=excelOnlineCalc.calc.cellLocation(qa.FirstRow,qa.FirstColumn);na=f.iU("EvalFormulaRange",H.d(this.Dc.va.pa),na.FirstRow,na.FirstColumn,na.LastRow,na.LastColumn);A.ULS.sendTraceTag(537170190,0,50,"CalcAsyncEngine.EvalFormulaRange: calling calc.ts's EvalFormulaRange API for state ID {0}",this.Mp);da=this.Fm.evalFormulaRange(this.Mp,da,qa,na,null);da.then(function(ia){if(excelOnlineCalc.util.isSuccess(ia)){var ta=[];ia=bk(ia.value);for(var za=ia.next();!za.done;za=ia.next())za=
za.value,excelOnlineCalc.util.isSuccess(za.value)||(za=za.value.reason.kind.toString(),Array.contains(ta,za)||ta.push(za));A.ULS.sendTraceTag(537170191,0,50,"CalcAsyncEngine.EvalFormulaRange - Evaluation of range complete. FailureReasons: {0}",ta.length?Sys.Serialization.JavaScriptSerializer.serialize(ta):"None")}else A.ULS.sendTraceTag(537170192,0,15,"CalcAsyncEngine.EvalFormulaRange: Calc.EvalFormulaRange returned a failed object. failure reason: {0}",ia.reason.kind)}).catch(function(ia){A.ULS.sendTraceTag(537170189,
0,10,"CalcAsyncEngine.EvalFormulaRange - promise rejected: {0}",Sys.Serialization.JavaScriptSerializer.serialize(ia));return Promise.reject(ia)});this.resumeRecalc();return da};f.prototype.XSg=function(da,qa,na,ia){ia=void 0===ia?null:ia;if(this.Fm&&da){var ta=H.d(this.Dc.va.pa),za=da.cell.WJ-1,sa=da.cell.VJ-1,V=za,Ia=sa,Ha=null;ia&&(Ha=excelOnlineCalc.calc.cellLocation(za,sa),za=ia.top-1,sa=ia.left-1,V=ia.bottom-1,Ia=ia.right-1);if(da.cell.Rt)if(ia=da.cell.Rt.DXc,ia===x.a.Ee)A.ULS.sendTraceTag(537170187,
0,15,"CalcAsyncEngine::CalculateFormula() BlockRevision unknown for block:{0}",da.cell.Rt.Kd);else if(ia<this.Mp)A.ULS.sendTraceTag(537170185,0,50,"CalcAsyncEngine::CalculateFormula() Can't calc edit in cell:({0},{1}) - blockRevision:{2} < lastUpdatedStateId:{3}",za,sa,ia,this.Mp);else if(ia<this.currentStateId)A.ULS.sendTraceTag(537170184,0,50,"CalcAsyncEngine::CalculateFormula() Can't calc edit in cell:({0},{1}) - blockRevision:{2} < currentStateId:{3}",za,sa,ia,this.currentStateId);else if(this.KEb||
(this.Fm.setOnRecalcResults(na),this.KEb=!0),this.Tag()&&!this.Keb(2))A.ULS.sendTraceTag(537170183,0,15,"CalcAsyncEngine.CalculateFormula: UpdateData failed");else{Ia=f.iU("CalculateFormula.cell",ta,za,sa,V,Ia);na=[];var ob=ka.g(this.Dc);V=ob.Ug;ka.g(this.Dc).eb.Ji&&(V=ob.Cf(1).Ug,V.jna(1,1),V.jna(3,1));ob=null;V?ob=f.iU("CalculateFormula.viewport",ta,V.top-1,V.left-1,V.bottom-1,V.right-1):A.ULS.sendTraceTag(537170182,0,50,"CalcAsyncEngine::CalculateFormula() viewportRange is null, calc will use entire sheet...");
qa=excelOnlineCalc.calc.inferredRangeFormulaEdit(Ia,qa,Ha,ob);na.push(qa);da=V?String.format("CalcAsyncEngine::CalculateFormula() for sheet:{0} pos:({1},{2}) text:{3} stateId:{4} viewport:(({5},{6})-({7},{8}))",ta,za,sa,G.a.g_b(da.cell.text),ia,V.top-1,V.left-1,V.bottom-1,V.right-1):String.format("CalcAsyncEngine::CalculateFormula() for sheet:{0} pos:({1},{2}) text:{3} stateId:{4} viewport:(({5},{6})-({7},{8}))",ta,za,sa,G.a.g_b(da.cell.text),ia,"","","","");A.ULS.sendTraceTag(537170181,0,50,da);
this.Fm.editRangeFormulas(ia,na);this.resumeRecalc()}else A.ULS.sendTraceTag(537170186,0,15,"CalcAsyncEngine::CalculateFormula() GridBlockModelProxy is null cell:({0},{1})",da.cell.WJ,da.cell.VJ)}else A.ULS.sendTraceTag(537170188,0,15,"CalcAsyncEngine::CalculateFormula() recalc engine is null:{0}, modifiedCell is null:{1}",!this.Fm,!da)};f.prototype.VSg=function(da,qa,na,ia){ia=void 0===ia?null:ia;var ta=H.d(this.Dc.va.pa),za=da.cell.WJ-1,sa=da.cell.VJ-1,V=za,Ia=sa,Ha=null;ia&&(Ha=excelOnlineCalc.calc.cellLocation(za,
sa),za=ia.top-1,sa=ia.left-1,V=ia.bottom-1,Ia=ia.right-1);na=this.KYd(da,na,"SetCell");0>na||(Ia=f.iU("CalculateFormula.cell",ta,za,sa,V,Ia),V=[],ia=this.rgd(ta),qa=excelOnlineCalc.calc.inferredRangeFormulaEdit(Ia,qa,Ha,ia),V.push(qa),da=(qa=this.I2e())?String.format("CalcAsyncEngine::CalculateFormula() for sheet:{0} pos:({1},{2}) text:{3} stateId:{4} viewport:(({5},{6})-({7},{8}))",ta,za,sa,G.a.g_b(da.cell.text),na,qa.top-1,qa.left-1,qa.bottom-1,qa.right-1):String.format("CalcAsyncEngine::CalculateFormula() for sheet:{0} pos:({1},{2}) text:{3} stateId:{4} viewport:(({5},{6})-({7},{8}))",
ta,za,sa,G.a.g_b(da.cell.text),na,"","","",""),A.ULS.sendTraceTag(537170180,0,50,da),this.Fm.editRangeFormulas(na,V),this.resumeRecalc())};f.prototype.$sb=function(da,qa,na,ia){if(!this.Fm)return A.ULS.sendTraceTag(537170179,0,15,"CalcAsyncEngine::EvalFormulaRangeOnClone recalc engine is null"),Promise.reject("RecalcService is null");if(!na||!qa)return A.ULS.sendTraceTag(524120779,0,15,"CalcAsyncEngine::EvalFormulaRangeOnClone inputs are null. originCell null: "+!na+", outputColumnRange null: "+!qa),
Promise.reject("CalcAsyncEngine::EvalFormulaRangeOnClone: null inputs");A.ULS.shipAssertTag(537170178,0,na.isSingle,"CalcAsyncEngine::EvalFormulaRangeOnClone originCell must be a single cell.");var ta=H.d(this.Dc.va.pa),za=this.rgd(ta),sa=null;if(da){sa=[];da=bk(da);for(var V=da.next();!V.done;V=da.next())if(V=V.value,V.column!==na.left){var Ia=V.row-1;var Ha=V.column-1;Ia=f.iU("EvalFormulaRangeOnClone.cell",ta,Ia,Ha,Ia,Ha);Ha=V.text;sa.push(excelOnlineCalc.calc.rangeWrite(Ia,excelOnlineCalc.calc.valueCellData(Ha,
Ha,V.Yk,null)))}}na=excelOnlineCalc.calc.cellLocation(na.top-1,na.left-1);qa=f.iU("EvalFormulaRangeOnClone.outputColumnRange",ta,qa.top-1,qa.left-1,qa.bottom-1,qa.right-1);ia=[excelOnlineCalc.calc.cellFormulaRangeFormulaEdit(qa,ia,na,za)];sa=this.Fm.evalOnClonedModel(sa,ia);this.resumeRecalc();return sa};f.prototype.eEe=function(da){var qa=null;try{if(da)if(this.cta=ka.g(this.Dc).Ea.Iua(da),this.currentStateId=da.sSa,this.currentStateId<this.Mp||this.currentStateId===x.a.Ee)A.ULS.sendTraceTag(537170176,
0,50,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel() hash:{0} blockRevision:{1} < lastUpdatedStateId:{2}",this.cta,this.currentStateId,this.Mp);else{if(this.A$h(),!this.$Ng()){var na=String.format("CalcAsyncEngine::CreateUpdatedRangesFromBlockModel() Block Hash:{0} StateId:{1}",this.cta,this.currentStateId);qa=this.Dc.Fb.sc("ModelUpdate",na);this.Arb=this.Vvb(da.pa.sheetName);if(!this.Arb){var ia=!!(this.Dc.Cd&32);A.ULS.sendTraceTag(537170147,0,15,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel SheetName not found. Number of existing sheets {0}, scratchPad:{1}, sheetNameLength:{2} Hash:{3}",
this.Qe.kb(this.currentStateId)&&this.Qe.na(this.currentStateId).vj?this.Qe.na(this.currentStateId).vj.length:0,ia,da.pa.sheetName?da.pa.sheetName.length:-1,da.pa.hash)}else if(ka.g(this.Dc).Ea.gm.j1a(da.Kd)){var ta=da.lf;if(ta){var za=ta.getCalcBlockModel();if(!za)A.ULS.sendTraceTag(537170145,0,15,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel no model for block");else if(this.SNg(za)){this.Qe.na(this.currentStateId).YZa[this.cta]=new B(za,da.pa.sheetName);var sa=da.ke;sa?this.nBg(sa.NamedObjects):
A.ULS.sendTraceTag(537170144,0,15,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel GetGridBlockContentResponse is null")}}else A.ULS.sendTraceTag(537170146,0,15,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel no model accessor for block:{0}",this.cta)}}}else A.ULS.shipAssertTag(537170177,0,!1,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel() blockCacheItem is null")}finally{qa&&qa.stop()}};f.prototype.c4a=function(da){if(!this.Qe.na(this.currentStateId).vj||!this.Qe.na(this.currentStateId).vj[0])return null;
var qa=this.Qe.na(this.currentStateId).vj[0].R5;if(!qa||!qa.kb(da.name))return null;qa=qa.na(da.name);if(!qa||!qa.iE)return null;da=new I.a;qa=bk(qa.iE.v$);for(var na=qa.next();!na.done;na=qa.next())da.add(na.value.value);return da};f.prototype.WSg=function(da,qa,na){var ia=ka.g(this.Dc),ta=ia.Ub(qa);ta=this.KYd(ta,null,"CopyPaste");na=this.KYd(ia.Ub(da),na,"CopyPaste");if(0>ta||0>na||ta!==na)A.ULS.sendTraceTag(537170143,0,15,"CalcAsyncEngine::CalculateFormulaForCopyPaste(). Revision not valid. sourceRevision:{0}, targetRevision:{1}.",
na,ta);else{na=[];ia=H.d(this.Dc.va.pa);var za=this.rgd(ia);da=f.iU("CalculateFormulaForCopyPaste.srcRange",ia,da.top-1,da.left-1,da.bottom-1,da.right-1);qa=f.iU("CalculateFormulaForCopyPaste.targetRange",ia,qa.top-1,qa.left-1,qa.bottom-1,qa.right-1);qa=excelOnlineCalc.calc.copyPasteRangePasteEdit(qa,da,za);na.push(qa);qa=za?String.format("CalcAsyncEngine::CalculateFormulaForCopyPaste() for sheet:{0}, stateId:{1} viewport:(({2},{3})-({4},{5}))",ia,ta,za.row,za.column,za.lastRow,za.lastColumn):String.format("CalcAsyncEngine::CalculateFormulaForCopyPaste() for sheet:{0}, stateId:{1} viewport:(({2},{3})-({4},{5}))",
ia,ta,"","","","");A.ULS.sendTraceTag(537170142,0,50,qa);this.Fm.editRangePaste(ta,na);this.resumeRecalc()}};f.prototype.rgd=function(da){var qa=this.I2e(),na=null;qa?na=f.iU("GetViewport.viewport",da,qa.top-1,qa.left-1,qa.bottom-1,qa.right-1):A.ULS.sendTraceTag(537170141,0,50,"CalcAsyncEngine::GetViewport() viewportRange is null, calc will use entire sheet...");return na};f.prototype.I2e=function(){var da=ka.g(this.Dc),qa=da.Ug;if(ka.g(this.Dc).eb.Ji){qa=da.Cf(1).Ug;if(Q.EwaSettings.isChangeGateEnabled("OfficeVSO:5497152_JSCrash_At_CalcAsyncEngine_GetViewportRange")&&
!qa)return A.ULS.sendTraceTag(537170140,0,15,"CalcAsyncEngine::GetViewportRange viewportRange is null."),null;qa.jna(1,1);qa.jna(3,1)}return qa};f.prototype.KYd=function(da,qa,na){if(!this.Fm||!da)return A.ULS.sendTraceTag(537170139,0,15,"CalcAsyncEngine::ValidateCalculateFormulaInit() recalc engine is null:{0}, modifiedCell is null:{1}, operation:{2}",!this.Fm,!da,na),-1;var ia=da.cell.WJ-1,ta=da.cell.VJ-1;if(da.cell.Rt){var za=da.cell.Rt.DXc;if(za===x.a.Ee)return A.ULS.sendTraceTag(537170138,0,
15,"CalcAsyncEngine::ValidateCalculateFormulaInit() BlockRevision unknown for block:{0}, operation:{1}",da.cell.Rt.Kd,na),-1}else return A.ULS.sendTraceTag(537170137,0,15,"CalcAsyncEngine::ValidateCalculateFormulaInit() GridBlockModelProxy is null cell:({0},{1}), operation:{2}",da.cell.WJ,da.cell.VJ,na),-1;if(za<this.Mp)return A.ULS.sendTraceTag(537170136,0,50,"CalcAsyncEngine::ValidateCalculateFormulaInit() Can't calc edit in cell:({0},{1}) - blockRevision:{2} < lastUpdatedStateId:{3}, operation:{4}",
ia,ta,za,this.Mp,na),-1;if(za<this.currentStateId)return A.ULS.sendTraceTag(537170135,0,50,"CalcAsyncEngine::ValidateCalculateFormulaInit() Can't calc edit in cell:({0},{1}) - blockRevision:{2} < currentStateId:{3}, operation:{4}",ia,ta,za,this.currentStateId,na),-1;qa&&!this.KEb&&(this.Fm.setOnRecalcResults(qa),this.KEb=!0);return this.Tag()&&!this.Keb(2)?(A.ULS.sendTraceTag(537170134,0,15,"CalcAsyncEngine.ValidateCalculateFormulaInit: UpdateData failed. operation:{0}",na),-1):za};f.prototype.getFormulaBarText=
function(da,qa,na){return qa&&qa.startsWith("'")?qa:da.cell.formulaBarText||na.toString()};f.prototype.E8g=function(da,qa,na){var ia=null;if(this.hve()&&this.Qe.na(this.Mp).YZa){var ta=this.Qe.na(this.Mp).YZa[da];if(null===ta||void 0===ta?0:ta.Ruc)ia=ta.yue}na=this.pei(ia,qa,na);qa=this.K_g(ia,qa,na);A.ULS.sendTraceTag(50671754,0,50,"CalcAsyncEngine::CreateRangeUpdateCommands() completed for Block Hash:{0} StateId:{1} number of formulas {2}",da,this.currentStateId,qa)};f.prototype.pei=function(da,
qa,na){var ia=!1,ta=f.cWe(qa);if(da){var za=f.cWe(da);G.a.equals(za,ta,!1)&&(ia=!0)}ia?this.QBg(da,this.Mp,na):this.SBg(qa,na);return ia};f.prototype.hve=function(){var da=!1;this.Fm&&-1!==this.Mp&&(da=this.Fm.stateIdAvailable(this.Mp));return da&&this.Qe.kb(this.Mp)&&this.Mp<this.currentStateId};f.prototype.K_g=function(da,qa,na){var ia=0;var ta,za;for(qa.reset();ta=qa.getNextCell();)R.f(ta.formula)&&ia++,(za=na?da.getCell(ta.row,ta.col):null)?this.G_g(qa,ta,za):this.RBg(qa,ta);if(na)for(da.reset();za=
da.getNextCell();)(ta=qa.getCell(za.row,za.col))||this.ale(da,za);return ia};f.prototype.Wqj=function(){this.Fm.setOnUpdateRequest(function(){})};f.prototype.Vqj=function(){var da=this;this.Fm.setOnUnresponsive(function(qa,na,ia,ta){da.YSi(qa,na,ia,ta)})};f.prototype.YSi=function(da,qa,na,ia){A.ULS.sendTraceTag(537170126,0,15,"CalcAsyncEngine.onUnresponsive: worker thread was unresponsive. timeout:{0}, waitTime:{1}, timeoutCount:{2}, hasBeenClosed:{3}.",da,qa,na,ia);ia&&(this.Kfj(),this.moa())};f.prototype.Kfj=
function(){this.Yc(null,null);this.Osd=this.KEb=!1;this.ZDd=0;this.PDd=this.RDd=this.SDd=this.QDd=-1};f.prototype.close=function(){this.Fm.close()};f.prototype.clearCache=function(){this.Fm.clearCache()};f.prototype.resumeRecalc=function(){this.Fm.resumeRecalc()};f.prototype.kqj=function(){this.Fm.setA1ReferenceStyle(!0)};f.prototype.F5i=function(){if(this.instantaneousSupportInformationManager){var da=this.instantaneousSupportInformationManager.Hbi,qa=this.instantaneousSupportInformationManager.Kbi,
na=this.instantaneousSupportInformationManager.Jbi,ia=this.instantaneousSupportInformationManager.Ibi,ta=!1;da!==this.QDd&&(ta=!0,this.QDd=da);qa!==this.SDd&&(ta=!0,this.SDd=qa);na!==this.RDd&&(ta=!0,this.RDd=na);ia!==this.PDd&&(ta=!0,this.PDd=ia);var za=[];Q.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CalcTSExceLintExperimentIsEnabled",!1)&&(ta=excelOnlineCalc.calc.runExperiment("ExceLintExperiment",null),za.push(ta),ta=!0);Q.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UnitExperiment",
!1)&&(ta=excelOnlineCalc.calc.runExperiment("UnitExperiment",null),za.push(ta),ta=!0);Q.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CalcTSAutocompleteExperimentIsEnabled",!1)&&(ta=excelOnlineCalc.calc.runExperiment("AutocompleteExperiment",null),za.push(ta),ta=!0);ta&&(da=excelOnlineCalc.calc.recalcServiceConfig(null,da,null,qa,null,null,null,na,za,ia),this.Fm.reconfigure(da))}};f.prototype.Tsj=function(da){var qa=this,na=null;if(this.Qe.kb(this.currentStateId))try{this.O$=[];var ia=
String.format("CalcAsyncEngine::SetUpdatedRanges() StateId:{0} UpdateTriggerData:{1}",this.currentStateId,J[da]);na=this.Dc.Fb.sc("ModelUpdate",ia);D.a.forEach(this.Qe.na(this.currentStateId).YZa,function(ta,za){za.Ruc||(qa.E8g(ta,za.yue,za.sheetName),za.Ruc=!0)},null);this.Fm.updateRanges(this.currentStateId,this.O$)}finally{na&&na.stop()}else A.ULS.sendTraceTag(537170122,0,15,"CalcAsyncEngine::SetUpdatedRanges StateId:{0} does not exist in GridCache",this.currentStateId)};f.prototype.Ssj=function(){var da=
[],qa=this.hve(),na=qa&&this.Qe.na(this.Mp).vj&&this.Qe.na(this.Mp).vj[0]&&this.Qe.na(this.Mp).vj[0].llc?this.Qe.na(this.Mp).vj[0].R5:null;this.Nze(na,this.Qe.na(this.currentStateId).vj[0].R5,null,this.Mp,da);this.Qe.na(this.currentStateId).vj[0].llc=!0;for(var ia=1;ia<this.Qe.na(this.currentStateId).vj.length;ia++)na=-1,qa&&this.Qe.na(this.Mp).vj&&(na=this.Bfd(this.Qe.na(this.currentStateId).vj[ia].o7.sheetName,this.Mp)),na=-1!==na&&this.Qe.na(this.Mp).vj[na].llc?this.Qe.na(this.Mp).vj[na].R5:null,
this.Nze(na,this.Qe.na(this.currentStateId).vj[ia].R5,this.Qe.na(this.currentStateId).vj[ia].o7.sheetId,this.Mp,da),this.Qe.na(this.currentStateId).vj[ia].llc=!0;this.Fm.updateNamedObjects(this.currentStateId,da)};f.prototype.Nze=function(da,qa,na,ia,ta){if(void 0!==na&&null!==na){var za=excelOnlineCalc.calc.undefinedNamesWrite(na);ta.push(za)}if(da){var sa=!1,V=[];za=[];if(qa)for(var Ia=bk(qa),Ha=Ia.next();!Ha.done;Ha=Ia.next()){Ha=Ha.value;var ob=Ha.value;if(da.kb(Ha.key)){var ib=da.na(Ha.key);
f.OCi(ib,ob)?sa=!0:(ib=excelOnlineCalc.calc.namedObject(Ha.key,null),V.push(ib),f.JTc(Ha.key,ob,za))}else f.JTc(Ha.key,ob,za)}da=bk(da);for(Ha=da.next();!Ha.done;Ha=da.next())Ia=Ha.value,qa&&qa.kb(Ia.key)||(Ia=excelOnlineCalc.calc.namedObject(Ia.key,null),V.push(Ia));sa&&(qa=excelOnlineCalc.calc.namedObjectsPromote(na,ia),ta.push(qa));0<V.length&&(qa=excelOnlineCalc.calc.namedObjectsWrite(na,V),ta.push(qa));0<za.length&&(na=excelOnlineCalc.calc.namedObjectsWrite(na,za),ta.push(na))}else if(qa){za=
[];qa=bk(qa);for(ia=qa.next();!ia.done;ia=qa.next())ia=ia.value,f.JTc(ia.key,ia.value,za);0<za.length&&(na=excelOnlineCalc.calc.namedObjectsWrite(na,za),ta.push(na))}};f.prototype.$Ng=function(){return this.Qe.na(this.currentStateId).YZa[this.cta]?(A.ULS.sendTraceTag(537170121,0,50,"CalcAsyncEngine::BlockPreviouslyHandled Block Hash:{0} StateId:{1} previously handled",this.cta,this.currentStateId),!0):!1};f.prototype.SNg=function(da){return 1===da.getColumnNumbers().length&&da.getColumnNumbers()[0]===
f.evd+1?!1:!0};f.prototype.v$h=function(){var da=this,qa=!1;ka.g(this.Dc).Ea.yad(function(na){na.state&1&&da.Dc.ea.Ue===na.ie.Revision&&(da.eEe(na),qa=!0)});return qa};f.prototype.aCe=function(da,qa){var na=da.getRowNumbers(),ia=da.getColumnNumbers();da=na[0]-1;na=na[na.length-1]-1;var ta=ia[0]-1;ia=ia[ia.length-1]-1;(qa=this.Vvb(qa))||A.ULS.sendTraceTag(537170120,0,15,"CalcAsyncEngine::CreateBlockRangeLocation SheetName not found. Number of existing sheets {0}",this.Qe.kb(this.currentStateId)&&this.Qe.na(this.currentStateId).vj?
this.Qe.na(this.currentStateId).vj.length:0);return f.iU("CreateBlockRangeLocation",qa,da,ta,na,ia)};f.prototype.QBg=function(da,qa,na){if(na=this.aCe(da,na)){var ia=f.o4b(da.getRowNumbers());da=f.o4b(da.getColumnNumbers());qa=excelOnlineCalc.calc.rangePromote(na,qa,ia,da);this.O$[this.O$.length]=qa}};f.prototype.SBg=function(da,qa){if(qa=this.aCe(da,qa)){var na=f.o4b(da.getRowNumbers());da=f.o4b(da.getColumnNumbers());da=excelOnlineCalc.calc.rangeWrite(qa,null,na,da);this.O$[this.O$.length]=da}};
f.prototype.G_g=function(da,qa,na){var ia=null,ta=0,za=0;switch(qa.valueType){case 2:ia=this.ogd(qa);var sa=this.ogd(na);sa=G.a.equals(sa,ia,!1);break;case 1:null===qa.value&&null===na.value?sa=!0:(ta=parseFloat(qa.value),sa=parseFloat(na.value)===ta);break;default:null===qa.value&&null===na.value?sa=!0:(za=parseFloat(qa.value),sa=za===parseFloat(na.value))}sa&&qa.valueType===na.valueType&&qa.ifmt===na.ifmt&&qa.formulaType===na.formulaType&&G.a.equals(na.formula,qa.formula,!1)||(void 0!==qa.formula&&
null!==qa.formula||void 0!==qa.value&&null!==qa.value||void 0!==qa.text&&null!==qa.text?this.OYb(da,qa,ia,ta,za):this.ale(da,qa))};f.prototype.nBg=function(da){if(this.Dc.vb&&this.Dc.vb.items)for(var qa=0;qa<this.Dc.vb.count;qa++){var na=this.Dc.vb.items[qa];if(2===na.type||3===na.type){var ia=0,ta=na.name,za=ta.lastIndexOf("!");if(0<za){ia=ta.substr(0,za);"'"===ia.charAt(0)&&(ia=ia.substr(1,ia.length-2));ia=this.Bfd(ia,this.currentStateId);if(-1===ia){A.ULS.sendTraceTag(595096334,0,15,"CalcAsyncEngine::AddNamedObjectsInBlock SheetName not found. Number of existing sheets {0}",
this.Qe.kb(this.currentStateId)&&this.Qe.na(this.currentStateId).vj?this.Qe.na(this.currentStateId).vj.length:0);continue}ta=ta.substr(za+1)}ia=this.Qe.na(this.currentStateId).vj[ia].R5;var sa=na.usedRange;2===na.type&&(sa=M.a(na));if(ia.kb(ta)){if(za=ia.na(ta),za.range=sa,za.attributes=na.attributes,2===za.type&&(ta=f.kSe(na.name,da),na=(ia=Q.EwaSettings.isChangeGateEnabled("OfficeVSO:6053425_loadHeadersForAllTablesCalc"))?na.mO:null===ta||void 0===ta?void 0:ta.ColHeadersList,ta||ia))if(!za.iE)za.iE=
new v(na);else if(na)for(na=bk(na.HeadersList),ta=na.next();!ta.done;ta=na.next())ta=ta.value,za.iE.v$.ia(ta.Index,ta.Name)}else if(za=this.Vvb(na.sheetName)){za=new w(na.type,na.name,sa,za,na.attributes);if(2===za.type)if(Q.EwaSettings.isChangeGateEnabled("OfficeVSO:6053425_loadHeadersForAllTablesCalc")&&na.mO)za.iE=new v(na.mO);else if(na=f.kSe(na.name,da))za.iE=new v(na.ColHeadersList);ia.ia(ta,za)}else A.ULS.sendTraceTag(537170117,0,50,"CalcAsyncEngine::AddNamedObjectsInBlock SheetName not found. Number of existing sheets {0}",
this.Qe.kb(this.currentStateId)&&this.Qe.na(this.currentStateId).vj?this.Qe.na(this.currentStateId).vj.length:0)}}};f.prototype.OYb=function(da,qa,na,ia,ta){var za=da.getRowNumbers()[qa.row]-1;da=da.getColumnNumbers()[qa.col]-1;za=f.iU("AddRangeUpdateCommand",this.Arb,za,da,za,da);da=null;var sa=qa.formula||qa.text,V=excelOnlineCalc.calc.blankValue,Ia=null;void 0!==qa.text&&null!==qa.text||void 0!==qa.value&&null!==qa.value||(na="",Ia="This cell contains blanks only",0===qa.formulaType&&(sa=""));
switch(qa.valueType){case 2:null!==na&&(0===qa.formulaType&&(da=excelOnlineCalc.calc.valueCellData(sa,na,qa.ifmt,Ia)),1===qa.formulaType&&(da=excelOnlineCalc.calc.cellFormulaCellData(sa,na,qa.ifmt,Ia)),2===qa.formulaType&&(da=excelOnlineCalc.calc.valueCellData("",V,0,"This cell is a part of an array")));break;case 1:isNaN(ia)?A.ULS.sendTraceTag(537170116,0,50,"CalcAsyncEngine::AddRangeUpdateCommand Cell({0},{1}) invalid numeric value",qa.row,qa.col):(0===qa.formulaType&&(da=excelOnlineCalc.calc.valueCellData(sa,
ia,qa.ifmt,null)),1===qa.formulaType&&(da=excelOnlineCalc.calc.cellFormulaCellData(sa,ia,qa.ifmt,null)),2===qa.formulaType&&(da=excelOnlineCalc.calc.valueCellData("",V,0,"This cell is a part of an array")));break;case 3:isNaN(ta)?A.ULS.sendTraceTag(537170115,0,15,"CalcAsyncEngine::AddRangeUpdateCommand Cell({0},{1}) invalid boolean value",qa.row,qa.col):(na=1===ta?!0:!1,0===qa.formulaType&&(da=excelOnlineCalc.calc.valueCellData(sa,na,qa.ifmt,null)),1===qa.formulaType&&(da=excelOnlineCalc.calc.cellFormulaCellData(sa,
na,qa.ifmt,null)),2===qa.formulaType&&(da=excelOnlineCalc.calc.valueCellData("",V,0,"This cell is a part of an array")));break;case 4:isNaN(ta)?A.ULS.sendTraceTag(537170114,0,15,"CalcAsyncEngine::AddRangeUpdateCommand Cell({0},{1}) invalid error value",qa.row,qa.col):(na=excelOnlineCalc.calc.errorValue(ta),0===qa.formulaType&&(da=excelOnlineCalc.calc.valueCellData(sa,na,qa.ifmt,null)),1===qa.formulaType&&(da=excelOnlineCalc.calc.cellFormulaCellData(sa,na,qa.ifmt,null)),2===qa.formulaType&&(da=excelOnlineCalc.calc.valueCellData("",
V,0,"This cell is a part of an array")));break;default:da=excelOnlineCalc.calc.valueCellData("",V,qa.ifmt,null)}da&&(qa=excelOnlineCalc.calc.rangeWrite(za,da,null,null),this.O$[this.O$.length]=qa)};f.prototype.RBg=function(da,qa){switch(qa.valueType){case 2:this.OYb(da,qa,this.ogd(qa),null,0);break;case 1:this.OYb(da,qa,null,parseFloat(qa.value),0);break;default:this.OYb(da,qa,null,null,parseFloat(qa.value))}};f.prototype.ale=function(da,qa){var na=da.getRowNumbers()[qa.row]-1;da=da.getColumnNumbers()[qa.col]-
1;na=f.iU("AddRangeUpdateCommandEmptyCell",this.Arb,na,da,na,da);qa=excelOnlineCalc.calc.valueCellData("",excelOnlineCalc.calc.blankValue,qa.ifmt,null);qa=excelOnlineCalc.calc.rangeWrite(na,qa,null,null);this.O$[this.O$.length]=qa};f.prototype.Vvb=function(da){da=this.Bfd(da,this.currentStateId);return 0<da?this.Qe.na(this.currentStateId).vj[da].o7.sheetId:null};f.prototype.Bfd=function(da,qa){if(!this.Qe.kb(qa))return A.ULS.sendTraceTag(537170113,0,15,"CalcAsyncEngine.GetSheetInternalIndex StateId:{0} does not exist in GridCache",
qa),-1;var na=this.Qe.na(qa);return na.vj?na.getSheetIndex(da):(A.ULS.sendTraceTag(537170112,0,15,"CalcAsyncEngine.GetSheetInternalIndex sheetsInformation == null for StateId:{0}",qa),-1)};f.prototype.psj=function(){if(!this.Qe.kb(this.currentStateId)||!this.Qe.na(this.currentStateId).vj.length)return A.ULS.sendTraceTag(537170083,0,15,"CalcAsyncEngine::SetSheetNamesAndUsedRanges() No sheets information for StateId:{0} or StateId does not exist in GridCache",this.currentStateId),!1;for(var da=[],qa=
1;qa<this.Qe.na(this.currentStateId).vj.length;qa++){var na=this.Qe.na(this.currentStateId).vj[qa];na&&da.push(na.o7)}this.Fm.updateSheetNames(this.currentStateId,da);this.Fm.updateUnusedCells(this.currentStateId,this.Qe.na(this.currentStateId).fbg);return!0};f.prototype.setNumberFormats=function(){if(this.instantaneousSupportInformationManager){for(var da=[],qa=bk(this.instantaneousSupportInformationManager.Yxa),na=qa.next();!na.done;na=qa.next())na=na.value,na=excelOnlineCalc.calc.numberFormat(na.IfmtIndex,
na.FormatString,na.Builtin),da.push(na);this.Fm.setNumberFormats(da,!0)}};f.prototype.Moj=function(){if(this.instantaneousSupportInformationManager&&this.instantaneousSupportInformationManager.we){var da=this.y$h();if(!this.Osd||da)this.n4b(),this.instantaneousSupportInformationManager.we.TrueValueString&&(this.trueName=this.instantaneousSupportInformationManager.we.TrueValueString),this.instantaneousSupportInformationManager.we.FalseValueString&&(this.falseName=this.instantaneousSupportInformationManager.we.FalseValueString),
da=U.CalcHelper.WCe(this.instantaneousSupportInformationManager,da),this.Fm.setLocale(da),this.Osd=!0}};f.prototype.dtj=function(){var da=null;if(void 0!==this.Dc.workbookContext.TimeZoneInformation&&null!==this.Dc.workbookContext.TimeZoneInformation){da=null;this.Dc.workbookContext.TimeZoneInformation.StandardDate.Month&&(da=excelOnlineCalc.date.dateTime(this.Dc.workbookContext.TimeZoneInformation.StandardDate.Year,this.Dc.workbookContext.TimeZoneInformation.StandardDate.Month,this.Dc.workbookContext.TimeZoneInformation.StandardDate.Day,
this.Dc.workbookContext.TimeZoneInformation.StandardDate.Hour,this.Dc.workbookContext.TimeZoneInformation.StandardDate.Minute,this.Dc.workbookContext.TimeZoneInformation.StandardDate.Second,this.Dc.workbookContext.TimeZoneInformation.StandardDate.DayOfWeek+1,this.Dc.workbookContext.TimeZoneInformation.StandardDate.Milliseconds,3));var qa=null;this.Dc.workbookContext.TimeZoneInformation.DaylightDate.Month&&(qa=excelOnlineCalc.date.dateTime(this.Dc.workbookContext.TimeZoneInformation.DaylightDate.Year,
this.Dc.workbookContext.TimeZoneInformation.DaylightDate.Month,this.Dc.workbookContext.TimeZoneInformation.DaylightDate.Day,this.Dc.workbookContext.TimeZoneInformation.DaylightDate.Hour,this.Dc.workbookContext.TimeZoneInformation.DaylightDate.Minute,this.Dc.workbookContext.TimeZoneInformation.DaylightDate.Second,this.Dc.workbookContext.TimeZoneInformation.DaylightDate.DayOfWeek+1,this.Dc.workbookContext.TimeZoneInformation.DaylightDate.Milliseconds,3));da=excelOnlineCalc.date.tzData(this.Dc.workbookContext.TimeZoneInformation.Bias,
da,this.Dc.workbookContext.TimeZoneInformation.StandardBias,qa,this.Dc.workbookContext.TimeZoneInformation.DaylightBias)}else A.ULS.sendTraceTag(537170082,0,15,"CalcAsyncEngine.SetWorkbookProperties: TimeZoneInformation is null");da=excelOnlineCalc.calc.workbookProps(this.Dc.workbookContext.F1904,this.Dc.workbookContext.FDateCompatibility,da);this.Fm.setWorkbookProps(da)};f.prototype.moa=function(){var da=this;Q.EwaSettings.ma(306)&&fa.c(excelOnlineCalc.worker.runSmokeTest(1/0,this.k4f,!0)).continueWith(function(ta){ta.exception?
A.ULS.sendTraceTag(537170079,0,15,"CalcAsyncEngine.TryInitialize: calc smoke test failed: {0}",ta.exception.toString()):A.ULS.sendTraceTag(537170080,0,50,"CalcAsyncEngine.TryInitialize: calc smoke test ended - a new one should start")});var qa=Q.EwaSettings.ma(657)?r.local:r.cIj,na=bk(N.a.mV()?[excelOnlineCalc.x10.PluginSchedulerSingleton.instance(),excelOnlineCalc.x10.GridImportManagerSingleton.instance()]:[void 0,void 0]),ia=na.next().value;na=na.next().value;this.dGd=fa.c(excelOnlineCalc.calc.createRecalcService(qa,
ia,na));this.dGd.continueWith(function(ta){ta.exception?A.ULS.sendTraceTag(537170075,0,50,"CalcAsyncEngine.TryInitialize: Calc web worker failed: {0}",ta.exception.toString()):(A.ULS.sendTraceTag(537170078,0,50,"CalcAsyncEngine.TryInitialize: Calc web worker is working as expected"),da.Fm=da.dGd.result,da.Fm?da.Keb(0)?da.Vqj():A.ULS.sendTraceTag(537170077,0,15,"CalcAsyncEngine.TryInitialize: UpdateData failed to initialize"):A.ULS.sendTraceTag(537170076,0,50,"CalcAsyncEngine.TryInitialize: Calc web worker result is null"))})};
f.prototype.y$h=function(){var da=this.instantaneousSupportInformationManager.Yia;if(!da||this.ZDd===da.length)return null;this.ZDd=da.length;return U.CalcHelper.ICe(da)};f.prototype.n4b=function(){this.errorTypeNames=U.CalcHelper.n4b()};f.prototype.A$h=function(){if(!(this.Qe.kb(this.currentStateId)&&0<this.Qe.na(this.currentStateId).vj.length)){this.Qe.ia(this.currentStateId,new m(this.snd));this.Qe.na(this.currentStateId).TZf(0,new y(null));for(var da=this.Dc.va,qa=0;qa<da.count;qa++){var na=Object(F.a)(P.a,
da.getItem(qa));if(na){void 0!==na.sheetId&&null!==na.sheetId&&void 0!==na.name&&null!==na.name&&na.sheetId.length&&na.sheetName.length||A.ULS.sendTraceTag(537170074,0,15,"CalcAsyncEngine::InitializeGridForStateId() invalid sheet - index:{0} Id:{1} Hash:{2} NameLength:{3}",qa,na.sheetId,na.hash,na.name?na.name.length:-1);var ia=excelOnlineCalc.calc.sheetName(na.sheetId,na.name);this.Qe.na(this.currentStateId).TZf(qa+1,new y(ia));ia=na.usedRange.jS();ia=excelOnlineCalc.calc.rangeLocation(0,0,ia.LastRow,
ia.LastColumn);na=excelOnlineCalc.calc.unusedCellsUpdate(na.sheetId,ia);Array.add(this.Qe.na(this.currentStateId).fbg,na)}else A.ULS.sendTraceTag(537170073,0,15,"CalcAsyncEngine.InitializeGridForStateId(): not sheet item for StateId:{0} sheet-index:{1}",this.currentStateId,qa)}}};f.prototype.hXg=function(){for(var da=bk(this.Qe),qa=da.next();!qa.done;qa=da.next())qa=qa.value,qa.key<this.Mp&&this.Qe.remove(qa.key)};f.prototype.ogd=function(da){da=da.value||da.text;if(void 0===da||null===da)da="";return da};
f.prototype.Tag=function(){if(!this.Qe.kb(this.currentStateId))return!1;var da=!1;D.a.forEach(this.Qe.na(this.currentStateId).YZa,function(qa,na){na.Ruc||(da=!0)},null);return da};f.prototype.X2c=function(da){var qa={};qa.reason=da;qa.kind=1;return qa};f.prototype.Igc=function(){return this.Qe.kb(this.currentStateId)&&this.Qe.na(this.currentStateId).vj&&this.Qe.na(this.currentStateId).vj[0]&&this.Qe.na(this.currentStateId).vj[0].R5?!0:!1};f.I4g=function(da){var qa=[];if(null===da||void 0===da?0:da.v$){da=
bk(da.v$);for(var na=da.next();!na.done;na=da.next())na=na.value,na=excelOnlineCalc.calc.columnData(na.key,na.value),qa.push(na)}return qa};f.OCi=function(da,qa){if(da.type!==qa.type||da.attributes!==qa.attributes||!G.a.equals(da.fullName,qa.fullName,!1)||!da.range.equals(qa.range))return!1;if(!da.iE&&!qa.iE)return!0;if(!da.iE||!qa.iE||da.iE.v$.count!==qa.iE.v$.count)return!1;var na={};da=bk(da.iE.v$);for(var ia=da.next();!ia.done;na={Lfb:na.Lfb,Sfb:na.Sfb},ia=da.next())if(na.Lfb=ia.value,na.Sfb=
void 0,!(na.Lfb.value&&function(ta){return function(){var za=qa.iE.v$.yc(ta.Lfb.key);ta.Sfb=za.value;return za}}(na)().returnValue&&na.Sfb&&G.a.equals(na.Lfb.value,na.Sfb,!1)))return!1;return!0};f.JTc=function(da,qa,na){var ia=f.iU("NamedObject",qa.sheetId,qa.range.top-1,qa.range.left-1,qa.range.bottom-1,qa.range.right-1);if(2===qa.type){var ta=!!(qa.attributes&16),za=!!(qa.attributes&8);qa=f.I4g(qa.iE);ia=excelOnlineCalc.calc.namedTableData(ia,ta,za,qa);da=excelOnlineCalc.calc.namedObject(da,ia)}else ia=
excelOnlineCalc.calc.namedRangeData(ia),da=excelOnlineCalc.calc.namedObject(da,ia);na.push(da)};f.cWe=function(da){var qa=Sys.Serialization.JavaScriptSerializer.serialize(da.getRowNumbers());da=Sys.Serialization.JavaScriptSerializer.serialize(da.getColumnNumbers());return qa+da};f.o4b=function(da){var qa=null;if(1<da.length)for(var na=1;na<da.length;na++)for(var ia=0;da[na-1]+1+ia<da[na];)qa=qa||[],qa.push(da[na-1]+ia),ia++;return qa};f.kSe=function(da,qa){if(!qa)return null;for(var na=0,ia=qa.length;na<
ia;++na)if(G.a.equals(da,qa[na].Name,!1))return qa[na];return null};f.iU=function(da,qa,na,ia,ta,za){function sa(V,Ia,Ha,ob){(0>Ha||Ha>=ob)&&A.ULS.sendTraceTag(537170072,0,15,"CalcAsyncEngine::CreateSheetRangeLocation() callerId:{0} invalid {1}:{2}",V,Ia,Ha)}void 0!==qa&&null!==qa||A.ULS.sendTraceTag(537170071,0,15,"CalcAsyncEngine::CreateSheetRangeLocation() callerId:{0} sheetId is null",da);sa(da,"top",na,f.uof);sa(da,"left",ia,f.evd);sa(da,"bottom",ta,f.uof);sa(da,"right",za,f.evd);return excelOnlineCalc.calc.sheetRangeLocation(qa,
na,ia,ta,za)};f.uof=1048576;f.evd=16384;Object(u.a)(f,"CalcAsyncEngine",null,[3]);Object(u.a)(n,"AbsoluteRelativeReferenceInfo",null,[]);var ca=b(1183),ea=b(24);l.GGf="#";Object(u.a)(l,"Operators",null,[]);var wa=b(1184);k.sheet="Sheet";k.sheetRange="SheetRange";k.document="Document";k.j7h="Ident";Object(u.a)(k,"TraverseFormulaQualifierTypes",null,[]);var X=b(1185),ja=b(1083),va=b(1002),ua=b(58),Xa=b(63),aa=b(445),ba=b(38),oa=Sys.EventArgs;Rk(e,oa);Object(u.a)(e,"EditedCellRecalcCompleteEventArgs",
Sys.EventArgs,[]);var ra=ba.a;Rk(d,ra);d.prototype.eEg=function(da){this.addHandler(d.P6c,da)};d.prototype.maj=function(da){this.removeHandler(d.P6c,da)};d.prototype.hrf=function(da){this.raiseEvent(d.P6c,new e(da))};d.prototype.dispose=function(){var da=this;A.ULS.sendTraceTag(537170064,0,50,"CalcManager.Dispose called");this.$.da.Za(268,function(qa){qa.tId(da.fnc);qa.kId(da.Mmc)});this.gridView&&(this.gridView.jy(this.onContentReady),this.gridView.Ea&&this.gridView.Ea.ROf(this.ptf),this.Mq=null);
this.jFc=null};d.prototype.YSg=function(da,qa,na,ia){ia=void 0===ia?null:ia;this.Wq&&(Q.EwaSettings.isChangeGateEnabled("OfficeVSO:5470583_Calculate_Formula_Refactoring")?this.Wq.VSg(da,qa,na,ia):this.Wq.XSg(da,qa,na,ia))};d.prototype.evalFormula=function(da){return this.Wq?this.Wq.evalFormula(da):Promise.reject("calc engine not initialized")};d.prototype.evalFormulaRange=function(da,qa,na){return this.Wq?this.Wq.evalFormulaRange(da,qa,na):Promise.reject("calc engine not initialized")};d.prototype.$sb=
function(da,qa,na,ia){return this.Wq?this.Wq.$sb(da,qa,na,ia):Promise.reject("CalcEngine is null")};d.prototype.c4a=function(da){return this.Wq?(A.ULS.shipAssertTag(537170059,0,2===da.type,"CalcManager.GetTableHeaders() - ActiveItem is not a table"),this.Wq.c4a(da)):null};d.prototype.qIg=function(da,qa){if(!qa||2!==da.type)return!1;da=M.a(da);return da.right-da.left+1===qa.count};d.prototype.RQe=function(da){if(!this.EFb)return this.rfg||A.ULS.sendTraceTag(537170057,0,15,"CalcManager.ExtractReferenceWrappers - parser not initialized"),
null;var qa=this.Rsa(ea.Range.Tc(1,1));qa=this.EFb.parseFormula(excelOnlineCalc.parse.parseLocals(1,qa.range),da);if(!excelOnlineCalc.parse.parseResultHelper.isSuccess(qa))return A.ULS.sendTraceTag(537170056,0,10,"CalcManager.ExtractReferenceWrappers - ParseFormula failed"),null;try{if(Q.EwaSettings.isChangeGateEnabled("OfficeVSO:6518739_FlightRemovalStructuredReferencesHighlighting")){var na=this.gridView.ha.sa.activeCell,ia=excelOnlineCalc.location.gridCell(na.top-1,na.left-1),ta=excelOnlineCalc.location.documentLoc("",
this.$.workbookContext.FullDocumentInfo.BreadcrumbDocName),za=excelOnlineCalc.location.sheetIndex(ta,this.$.va.pa.sheetId),sa=this.$8g(ia,za);this.vKd||(this.vKd=excelOnlineCalc.util.createResolver(this.Z8g()));var V=excelOnlineCalc.parse.parseResultHelper.extractReferences(qa,this.Br.config.localeInfo,Q.EwaSettings.ma(594),sa,this.vKd)}else V=excelOnlineCalc.parse.parseResultHelper.extractReferences(qa,this.Br.config.localeInfo,Q.EwaSettings.ma(594));Q.EwaSettings.ma(103)&&this.hSj(V,da);return V}catch(Ia){return A.ULS.sendTraceTag(537170055,
0,10,"CalcManager.ExtractReferenceWrappers - exception: {0}",Ia.message),null}};d.prototype.extractLetVariables=function(da,qa){if(!this.EFb)return this.rfg||A.ULS.sendTraceTag(537170054,0,15,"CalcManager.ExtractLetVariables - parser not initialized"),null;var na=this.Rsa(ea.Range.Tc(1,1));da=this.EFb.parseFormula(excelOnlineCalc.parse.parseLocals(1,na.range),da);if(!excelOnlineCalc.parse.parseResultHelper.isSuccess(da))return A.ULS.sendTraceTag(537170053,0,10,"CalcManager.ExtractLetVariables - ParseFormula failed"),
null;try{return excelOnlineCalc.parse.parseResultHelper.extractLetVariables(da,qa,this.Br.config.localeInfo)}catch(ia){return A.ULS.sendTraceTag(537170052,0,10,"CalcManager.ExtractLetVariables - exception: {0}",ia.message),null}};d.prototype.extractReferences=function(da,qa,na,ia){if(!qa)return A.ULS.sendTraceTag(537170051,0,10,"CalcManager.ExtractReferences - sheetName is null"),null;if(!na)return A.ULS.sendTraceTag(537170050,0,10,"CalcManager.ExtractReferences - documentName is null"),null;var ta=
this.RQe(da);if(!ta)return A.ULS.sendTraceTag(537170049,0,15,"CalcManager.ExtractReferences - ExtractReferenceWrappers returned null"),null;try{return this.Y7g(ta,qa,na,da,ia)}catch(za){return A.ULS.sendTraceTag(537170048,0,10,"CalcManager.ExtractReferences - exception: {0}",za.message),null}};d.prototype.FXh=function(da,qa,na,ia){if(!da)return A.ULS.sendTraceTag(537170019,0,10,"CalcManager.GetSubExpressionSpanForContextualFormulaPreview - range is null"),null;if(!qa||0>=qa.length)return A.ULS.sendTraceTag(537170018,
0,10,"CalcManager.GetSubExpressionSpanForContextualFormulaPreview - formula is null/empty"),null;da=this.Rsa(da);if(!this.Br||!da)return null;var ta=this.Fub(da).returnValue;if(!ta||ta.K5a)return null;na=excelOnline.utils.getCharIndexInTextFromPoint(na,ia,Q.EwaSettings.ma(594));return 0>na?null:excelOnlineCalc.runtime.getSubExpressionFromFormulaCharacterIndex(this.Br.config,na,qa,da)};d.prototype.LSg=function(da,qa,na,ia){var ta=this;if(!da)return A.ULS.sendTraceTag(537170017,0,10,"CalcManager.CalcPartialResultsForFormula - range is null"),
null;var za=null;return this.evalFormula(qa).then(function(sa){var V=ta.Br.Glh(sa,na),Ia=V.returnValue;8!==V.kind||Ia.length&&Ia!==U.CalcHelper.unknownError?sa=0:(A.ULS.sendTraceTag(537170016,0,50,"EvalSession.GetPartialResultValueForFormula - EvalResultToString error"),sa=excelOnlineCalc.calc.getEvalFailureReason(sa),void 0!==sa&&null!==sa||A.ULS.shipAssertTag(537170015,0,!1,"CalcHelper.GetEvalFailureReason() - result is not a failure, function should not be called"),sa=1);return za=ia?new ca.a(Ia,
ia.start,ia.end,sa):new ca.a(Ia,-1,-1,sa)},function(sa){A.ULS.sendTraceTag(537170014,0,10,"EvalSession.GetPartialResultValueForFormula - exception: {0}",sa);return Promise.resolve(za)})};d.prototype.getSubExpressionSpan=function(da){return this.Br&&da?excelOnlineCalc.runtime.getSubExpressionSpan(da):null};d.prototype.getFormulaSubExpressionObject=function(da,qa,na){return this.Br&&da&&qa&&na?excelOnlineCalc.runtime.getFormulaSubExpressionObject(this.Br.config,qa,na,this.Rsa(da)):null};d.prototype.IXh=
function(da,qa,na){return this.Br&&da&&qa?excelOnlineCalc.runtime.getSubstitutedSubExpressionString(this.Br.config,qa,na,this.Rsa(da)):null};d.prototype.GXh=function(da,qa,na){return this.Br&&da&&qa?excelOnlineCalc.runtime.getSubExpressionSubspans(this.Br.config.localeInfo,qa,na):null};d.prototype.NQh=function(){return this.Br?this.Br.config.localeInfo.listSeparator:null};d.prototype.isFormulaSubExpressionVolatile=function(da){return this.Br?excelOnlineCalc.runtime.isFormulaSubExpressionVolatile(this.Br.config.localeInfo,
da):!1};d.prototype.Rsa=function(da,qa){qa=void 0===qa?!0:qa;return da&&this.Br?this.Br.x9g(this.Br.mah(),da.top-1,da.left-1,qa):null};d.prototype.thi=function(da,qa){da=this.tbc(da);if(void 0===da||null===da)return null;da=this.lF.createFormat(da.FormatString,da.Builtin);if(!excelOnlineCalc.util.isSuccess(da))return null;qa=this.lF.parseEdit(qa,da.value);return excelOnlineCalc.util.isSuccess(qa)?qa.value.kind===ja.a.formula:null};d.prototype.rbc=function(da){if(null==this.lF)return Object(aa.a)("Number formatter is null");
if(null==this.instantaneousSupportInformationManager)return Object(aa.a)("Instantaneous manager is null");if(this.Gxd.has(da))return Object(aa.d)(this.Gxd.get(da));if("number"===typeof da){var qa=this.tbc(da);if(null==qa)return Object(aa.a)("Invalid ifmt="+da);var na=qa.FormatString;qa=qa.Builtin}else na=da,qa=!1;na=this.lF.createFormat(na,qa);return excelOnlineCalc.util.isSuccess(na)?(this.Gxd.set(da,na.value),Object(aa.d)(na.value)):Object(aa.a)("Could not create number format")};d.prototype.getWorksheetFuncId=
function(da){return this.localeInfo.getWorksheetFuncId(da)};d.prototype.Y7g=function(da,qa,na,ia,ta){for(var za={Items:[]},sa=0;sa<da.length;sa++){var V=da[sa],Ia={};Ia.Start=V.span.start;Ia.End=V.span.end;if(ta||V.kind!==wa.a.func)if(ta||V.kind!==wa.a.Vri){if(this.Xgh(V,qa,na)){var Ha=new n,ob=this.zUh(V,qa,Ha,ia);if(Q.EwaSettings.ma(594)){var ib=this.EQh(V),La=this.DQh(V);if(ob||La&&0<=ib)Ia={Span:Ia,LetNumber:ib,LetName:La,Range:ob},Ia.IsRangeRef=Ha.Mwa,Ia.IsAbsoluteFirstRow=Ha.MZ,Ia.IsAbsoluteFirstColumn=
Ha.LZ,Ia.IsAbsoluteSecondRow=Ha.G4,Ia.IsAbsoluteSecondColumn=Ha.E4,Ia.IsStructRef=V.kind===wa.a.jTd,za.Items.push(Ia)}else ob&&(Ia={Span:Ia,Range:ob},Ia.IsRangeRef=Ha.Mwa,Ia.IsAbsoluteFirstRow=Ha.MZ,Ia.IsAbsoluteFirstColumn=Ha.LZ,Ia.IsAbsoluteSecondRow=Ha.G4,Ia.IsAbsoluteSecondColumn=Ha.E4,Ia.IsStructRef=V.kind===wa.a.jTd,za.Items.push(Ia))}}else V=V.ref.value.oper.kind,za.Items.push({Span:Ia,IsString:2===V,IsBoolean:4===V,IsNumber:1===V});else Ia.End=V.span.start+V.ref.name.length,V={Span:Ia,IsFunction:!0},
V.FunctionId=this.getWorksheetFuncId(ia.substring(Ia.Start,Ia.End)),za.Items.push(V)}za.Items.sort(function(zb,Fb){return zb.Span.Start-Fb.Span.Start});return za};d.prototype.EQh=function(da){return da.kind===wa.a.kjf?da.ref.number:-1};d.prototype.DQh=function(da){return da.kind===wa.a.kjf?da.ref.name:null};d.prototype.zUh=function(da,qa,na,ia){if(da.kind===wa.a.range)return na.Mwa=!0,this.YAe(da,qa,na,ia);if(da.kind===wa.a.namedRange){na=da.ref;(da=this.$.vb.getItemByName(na.name))||(da=this.$.vb.getItemByName(qa+
"!"+na.name));if(!(da&&da.sheetName&&da.usedRange&&G.a.equals(da.sheetName,qa,!0)))return null;qa=2===da.type?M.a(da):da.usedRange;return K.m(qa,da)}if(da.kind===wa.a.jTd){var ta=da.ref,za;ta.name?(za=this.$.vb.getItemByName(ta.name))||(za=this.$.vb.getItemByName(qa+"!"+ta.name)):za=this.gridView.Ab.dk(this.gridView.ha.sa.activeCell);if(!(za&&za.sheetName&&za.usedRange&&G.a.equals(za.sheetName,qa,!0)))return null;na.Mwa=!1;return this.YAe(da,qa,na,ia)}return null};d.prototype.YAe=function(da,qa,na,
ia){da=da.ref;if(da.type){if(da.type===X.a.column){var ta=da.startIndex;da=da.endIndex;na.LZ=ta.kind===va.a.abs;na.E4=da.kind===va.a.abs;return this.createRange(0,ta.index,x.a.sh,da.index,qa)}if(da.type===X.a.row)return ta=da.endIndex,na.MZ=da.startIndex.kind===va.a.abs,na.G4=ta.kind===va.a.abs,this.createRange(da.startIndex.index,0,da.endIndex.index,x.a.Bh,qa);if(da.type===X.a.cell){ta=da.row;var za=da.col;na.MZ=na.G4=ta.kind===va.a.abs;na.LZ=na.E4=za.kind===va.a.abs;return this.I1b(da.span.end,
ia)&&(na=ea.Range.Tc(ta.index+1,za.index+1),na=this.gridView.Ab.y1e(na))?K.n(na,qa):this.createRange(ta.index,za.index,ta.index,za.index,qa)}if(da.type===X.a.range){ta=da.top;za=da.left;ia=da.bottom;da=da.right;var sa=Math.min(ta.index,ia.index),V=Math.min(za.index,da.index),Ia=Math.max(ta.index,ia.index),Ha=Math.max(za.index,da.index);na.MZ=ta.kind===va.a.abs;na.G4=ia.kind===va.a.abs;na.LZ=za.kind===va.a.abs;na.E4=da.kind===va.a.abs;return this.createRange(sa,V,Ia,Ha,qa)}A.ULS.sendTraceTag(537170010,
0,10,"CalcManager.CovertFormulaRefToRange: Unsupported formula ref type '{0}'",da.type);return null}A.ULS.sendTraceTag(537170011,0,15,"CalcManager.CovertFormulaRefToRange: traverseFormulaRef.Type is null");return null};d.prototype.I1b=function(da,qa){return qa.length>=da&&0<da&&qa.charAt(da-1)===l.GGf};d.prototype.SSg=function(da,qa,na){this.Wq&&this.Wq.WSg(da,qa,na)};d.prototype.tbc=function(da){return this.instantaneousSupportInformationManager&&this.instantaneousSupportInformationManager.Yxa&&
this.instantaneousSupportInformationManager.Yxa[da]&&this.lF?this.instantaneousSupportInformationManager.Yxa[da]:null};d.prototype.toXLNumber=function(da){if(!this.lF)return null;da=excelOnlineCalc.numfmt.toXLNumber(this.config.mathpack,this.lF,da);return excelOnlineCalc.util.isSuccess(da)?da.value:null};d.prototype.hSj=function(da,qa){if(da){da=bk(da);for(var na=da.next();!na.done;na=da.next())if(na=na.value,na.ref.type&&na.ref.type===X.a.cell){var ia=na.ref;d.wZi(ia,qa)&&(ia.span.end+=1,na.span.end+=
1)}}};d.prototype.createRange=function(da,qa,na,ia,ta){var za={};za.FirstRow=da;za.FirstColumn=qa;za.LastRow=na;za.LastColumn=ia;za.SheetName=ta;return za};d.prototype.Xgh=function(da,qa,na){var ia=da.ref.qualifier;if(!ia)return!0;switch(da.ref.qualifier.type){case k.sheet:return da=ia.document,G.a.equals(ia.sheet,qa,!0)&&(!da||G.a.equals(da.document,na,!0));case k.sheetRange:return qa=this.$.va.getItemByName(qa),na=this.$.va.getItemByName(ia.sheet1),ia=this.$.va.getItemByName(ia.sheet2),!!qa&&!!na&&
!!ia&&(na.index<=qa.index&&qa.index<=ia.index||ia.index<=qa.index&&qa.index<=na.index);case k.document:return G.a.equals(ia.document,na,!0);case k.j7h:return ia=ia.name,G.a.equals(ia,qa,!0)||G.a.equals(ia,na,!0);default:return A.ULS.sendTraceTag(537170009,0,10,"CalcManager.GetQualifierData: Unsupported formula qualifier type '{0}'",ia.type),!1}};d.prototype.HMj=function(da){this.instantaneousSupportInformationManager=da;da.Yxa.length&&da.Yia.length?(this.jFc=new U.CalcHelper(this.gridView.$),this.EFb=
this.Br.createParser(),this.$ae=this.Br.createNumberFormatter(),this.Wld=!0,A.ULS.sendTraceTag(537170007,0,50,"CalcManager.TryInitializeInternal: calc initialized"),this.Wq||(A.ULS.sendTraceTag(537170006,0,50,"CalcManager creating calc engine"),this.Wq=new f(this.$))):A.ULS.sendTraceTag(537170008,0,15,"CalcManager.TryInitializeInternal: IInstantaneousSupportInformationManager locale information missing, cannot initialize calc. number formats count = {0}, functions info count = {1}",da.Yxa.length,
da.Yia.length.toString())};d.prototype.Fub=function(da){if(!da)return{returnValue:null,emptyCell:!1};var qa=this.getSheetName(da.sheet.index);if(!qa)return A.ULS.sendTraceTag(537169998,0,50,"CalcManager.GetCellFromBlockCache: No sheet index {0}",da.sheet.index),{returnValue:null,emptyCell:!1};var na=d.convertToRange(da);qa=this.gridView.Fub(qa,na.top,na.left);return qa?qa.Rgh?{returnValue:qa,emptyCell:!1}:(A.ULS.sendTraceTag(537169996,0,50,"CalcManager.GetCellFromBlockCache: cell {0} {1} is empty",
da.range.row,da.range.col),{returnValue:null,emptyCell:!0}):(A.ULS.sendTraceTag(537169997,0,50,"CalcManager.GetCellFromBlockCache: cellProxy is null for cell {0} {1}",da.range.row,da.range.col),{returnValue:null,emptyCell:!1})};d.prototype.getSheetName=function(da){var qa=this.gridView.$.va.getItem(da);return qa?qa.sheetName:(A.ULS.sendTraceTag(537169995,0,50,"CalcManager.GetSheetName - no sheet in index {0}",da),null)};d.prototype.$8g=function(da,qa){var na={allowUnqualifiedCell:!0,wrapCellReferences:!0};
na.config=this.Br.config;na.originGridCell=excelOnlineCalc.util.success(da);na.originSheet=excelOnlineCalc.util.success(qa);return na};d.prototype.Z8g=function(){var da={};da.config=this.Br.config;da.getNameLoc=this.Wq.getNameLoc;da.getContainingTable=this.Wq.getContainingTable;da.getStructRefColumn=this.Wq.getStructRefColumn;da.getStructRefSpecialRef=this.Wq.getStructRefSpecialRef;da.getDocumentLoc=this.Wq.getDocumentLoc;da.getSheetIndex=this.Wq.getSheetIndex;da.getSheetName=this.Wq.getSheetName;
da.getUserDefinedFuncLoc=this.Wq.getUserDefinedFuncLoc;da.getSheetRangeIndexes=this.Wq.getSheetRangeIndexes;return da};d.wZi=function(da,qa){return qa.length>da.span.end&&qa.charAt(da.span.end)===l.GGf};d.convertToRange=function(da){return ea.Range.Tc(da.range.row+1,da.range.col+1)};Mf.Object.defineProperties(d.prototype,{Br:{configurable:!0,enumerable:!0,get:function(){return this.jFc}},gridView:{configurable:!0,enumerable:!0,get:function(){return this.Mq}},$:{configurable:!0,enumerable:!0,get:function(){return this.jb}},
lF:{configurable:!0,enumerable:!0,get:function(){return this.$ae}},localeInfo:{configurable:!0,enumerable:!0,get:function(){return this.Br?this.Br.config.localeInfo:null}},config:{configurable:!0,enumerable:!0,get:function(){return this.Br.config}}});d.P6c="ECRC";Object(u.a)(d,"CalcManager",ba.a,[810,3]);var db=b(37),Ka=b(53),Ga=z.a;Rk(c,Ga);c.prototype.create=function(){var da=this;if(this.$){A.ULS.sendTraceTag(537169993,0,50,"CalcManagerFactory.Create: Start loading script");if(Q.EwaSettings.isChangeGateEnabled("OfficeVSO:5543503_loadCalcCurrentVersion")){var qa=
75;var na="Current"}else qa=78,na="Stable";A.ULS.sendTraceTag(537169992,0,50,"CalcManagerFactory.Create: Calc {0} JS was loaded",na);db.TaskExtensions.Aa(Ka.a.loadScript(qa,4,this.hb,void 0,void 0,265),function(){A.ULS.sendTraceTag(537169991,0,50,"CalcManagerFactory.Create: Raised create service event");var ia=da.$.da.za(266,!1);ia||(A.ULS.sendTraceTag(537169990,0,50,"CalcManagerFactory.Create: CalcManager is not registered, creating new CalcManager"),ia=new d(da.$),Q.EwaSettings.isChangeGateEnabled("OfficeVSO:6143820_MoveServiceRegistrationFromFAM")&&
da.$.da.Ga(266,ia));da.pb(ia)},this.la,3)}else A.ULS.sendTraceTag(537169994,0,50,"CalcManagerFactory.Create: ewaControl is null, cann't create the service")};c.ka=function(da){da&&da.da&&da.da.Ga(265,new c(da))};Object(u.a)(c,"CalcManagerFactory",z.a,[]);var xa=b(10);b.d(E,"a",function(){return a})},1406:function(u,E,b){function a(){l.a.Fa(c.ka)}function c(C){var Q=M.call(this)||this;Q.$=C;Q.Eb();return Q}function d(C,Q){var P=K.call(this)||this;P.TMa=m.a.Ee;P.FYc=null;P.Hic=!1;P.rfb=!1;P.vsf=function(ka,
R){var fa;(ka=J.g(P.$))&&(R=null!==(fa=null===R||void 0===R?void 0:R.cell)&&void 0!==fa?fa:ka.Ub(null))&&P.cTa(R.cell.Yk,!0)};P.mKi=function(ka){P.isActive()&&(G.a.Uq(ka.Errors)||!ka.Result?n.ULS.sendTraceTag(537155726,0,50,"GetCategoryFromServer failed, ignoring - server errors: {0}",ka.Errors?ka.Errors.join(","):"None"):(ka=ka.Result,n.ULS.sendTraceTag(537155725,0,50,"Updating number format category cache, format index = {0}, category = {1}",ka.Index,ka.Category),P.Qqj(ka.Index,ka.Category),P.raiseEvent(d.HZc,
new B.a(ka.Index,ka.Category),P)))};P.refresh=function(){n.ULS.sendTraceTag(537155722,0,50,"InstantaneousSupportInformationManager.Refresh: start refresh");P.u1b();P.isActive()&&P.ea.hc.allowEdits&&(P.rfb||P.cn&&!(P.ea.bjc>P.TMa)?P.xCc():(n.ULS.sendTraceTag(537155721,0,50,"InstantaneousSupportInformationManager.Refresh: getting instantaneous support information."),P.Ydd=x.a(P.$.oa.xa,P.cn?P.cn.Digest:"",P.VKi,P.UKi,null,null)),n.ULS.sendTraceTag(537155720,0,50,"InstantaneousSupportInformationManager.Refresh: getting functions info."),
P.sYe())};P.Cwf=function(ka){n.ULS.sendTraceTag(537155716,0,50,"InstantaneousSupportInformationManager.OnGetFunctionListFailed failed, status = {0}, HTTP status = {1}.",ka.data.status,ka.data.httpStatus);P.QJa=null};P.C_=function(){P.rfb=!1;P.ea.hD(P.C_);P.EQa(P.Hic?d.GPd:d.dxd)};P.Uc=function(ka,R){n.ULS.sendTraceTag(537155715,0,50,"InstantaneousSupportInformationManager.OnSessionIdChanged called");A.a(R)&&P.EQa(d.GPd)};P.Qf=function(){n.ULS.sendTraceTag(537155714,0,50,"InstantaneousSupportInformationManager.OnWorkbookMetadataChanged called");
3!==P.$.workbookContext.CalcMode&&P.pxd(0===P.$.workbookContext.CalcMode)};P.Yc=function(){n.ULS.sendTraceTag(537155713,0,50,"InstantaneousSupportInformationManager.OnWorkbookOpened called");P.EQa(d.GPd);T.EwaSettings.ma(302)&&3!==P.$.workbookContext.CalcMode&&P.pxd(0===P.$.workbookContext.CalcMode)};P.NKi=function(ka,R,fa){n.ULS.sendTraceTag(537155712,0,50,"InstantaneousSupportInformationManager.OnGetFunctionListSuccess called.");P.QJa=null;P.isActive()?ka.StateId===m.a.Ee?(n.ULS.sendTraceTag(537155682,
0,50,"InstantaneousSupportInformationManager.OnGetFunctionListSuccess: no session, waiting for session."),P.xCc()):!ka.Result||P.DX&&P.DX.length?P.EQa(d.dxd):P.lAf(ka,R,fa):n.ULS.sendTraceTag(537155683,0,50,"InstantaneousSupportInformationManager.OnGetFunctionListSuccess: manager is inactive, skipping.")};P.lAf=function(ka){P.DX=ka.Result;n.ULS.sendTraceTag(537155681,0,50,"InstantaneousSupportInformationManager.OnGetFunctionListSuccess refreshing functions info list, returned {0} functions.",P.DX?
P.DX.length:-1);ka=!1;if(P.DX){for(var R=bk(P.DX),fa=R.next();!fa.done;fa=R.next())if(fa=fa.value)P.mUe[fa.NameUI.toLocaleUpperCase()]=fa.FunctionIndex.toString(),fa.NameUI!==fa.NameDataStrings&&(P.mUe[fa.NameDataStrings.toLocaleUpperCase()]=fa.FunctionIndex.toString(),ka=!0),P.SDh.ia(fa.FunctionIndex,fa.NameUI);P.raiseEvent(d.fbd,Sys.EventArgs.Empty,P)}ka&&n.ULS.sendTraceTag(537155680,0,50,"InstantaneousSupportInformationManager.OnGetFunctionListSuccess NameDataStrings functions names were used.")};
P.VKi=function(ka){if(P.isActive())if(n.ULS.shipAssertTag(537155679,0,!!P.$,"null ewaControl"),P.Hic=!1,P.TMa=ka.StateId,P.TMa===m.a.Ee)P.Hic=!0,P.xCc();else{if(ka.Result){var R=P.cn;P.cn=ka.Result;n.ULS.sendTraceTag(537155678,0,50,"InstantaneousSupportInformation updated, new result digest: {0}.",P.cn.Digest);ka=[];if(R)ka=d.sRh(R.NumberFormats,P.cn.NumberFormats);else for(R=0;R<P.cn.NumberFormats.length;R++)P.Llc.ia(R,P.cn.NumberFormats[R].NumberFormatCategory);R=bk(ka);for(var fa=R.next();!fa.done;fa=
R.next())fa=fa.value,P.Llc.ia(fa,P.cn.NumberFormats[fa].NumberFormatCategory);P.raiseEvent(d.Lxd,new k(ka),P);T.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.StructuredReferencesInRangePicker",!1)&&P.raiseEvent(d.jkf)}P.EQa(d.dxd)}};P.UKi=function(ka){P.isActive()&&(10===ka.data.status?n.ULS.sendTraceTag(537155677,0,50,"Instantaneous support information request cancelled."):(n.ULS.sendTraceTag(21311555,0,10,"Failed to update instantaneous support information, status = {0}, HTTP status = {1}.",
ka.data.status,ka.data.httpStatus),P.Hic=!0,P.xCc()))};n.ULS.sendTraceTag(537155737,0,50,"InstantaneousSupportInformationManager ctor start");P.ea=C;P.$=Q;P.mHb=null;P.Ydd=null;P.QJa=null;P.cn=null;P.Llc=new H.a;P.Eub=new H.a;P.DX=[];P.SDh=new H.a;P.mUe={};P.ea.Vj(P.Uc);P.$.Tk(P.Yc);J.g(P.$).ha.Bga(P.vsf);T.EwaSettings.ma(302)&&P.ea.zu(P.Qf);P.EQa(d.w8e);n.ULS.sendTraceTag(537155736,0,50,"InstantaneousSupportInformationManager ctor end");return P}function e(C){this.data=C}function k(C){var Q=D.call(this)||
this;Q.t_j=C;return Q}var l=b(10);u=b(0);var n=b(14),f=b(232),v=b(89),r=b(4),y=b(202),m=b(8),w=b(38),B=b(1082),A=b(235),z=b(62),x=b(1081),D=Sys.EventArgs;Rk(k,D);Object(u.a)(k,"NumberFormatsUpdatedEventArgs",Sys.EventArgs,[]);var I=b(47),F=b(44);b(34);var G=b(31),T=b(1),O=b(710);b(22);var U=b(294),J=b(21);b(206);Object(u.a)(e,"NumberFormatDataHolder",null,[]);var H=b(171),K=w.a;Rk(d,K);d.prototype.Mme=function(C){this.addHandler(d.Lxd,C)};d.prototype.tId=function(C){this.removeHandler(d.Lxd,C)};d.prototype.BDg=
function(C){this.addHandler(d.HZc,C)};d.prototype.L$i=function(C){this.removeHandler(d.HZc,C)};d.prototype.rme=function(C){this.addHandler(d.fbd,C)};d.prototype.kId=function(C){this.removeHandler(d.fbd,C)};d.prototype.dFg=function(C){this.addHandler(d.jkf,C)};d.prototype.cTa=function(C,Q){var P=this.Llc.yc(C,0);var ka=P.value;P=P.returnValue;!P&&0<C&&this.$&&(n.ULS.sendTraceTag(537155735,0,50,"InstantaneousSupportInformationManager.TryGetNumberFormatCategory: failed to get category from numberFormatIndexToCategoryCache {0}",
C),this.tJh(C),Q&&(ka=this.sJh(C),P=!0),O.a(C,this.$.aG)&&(ka=6));return{returnValue:P,category:ka}};d.prototype.phi=function(C){var Q=this.cTa(C,!0);var P=Q.category;if(Q.returnValue)return 6===P;n.ULS.sendTraceTag(537155733,0,50,"InstantaneousSupportInformationManager.IsFormatInPercentageCategory: failed to get category from format index {0}",C);return!1};d.prototype.pCh=function(C){n.ULS.sendTraceTag(537155730,0,50,"InstantaneousSupportInformationManager.ForceRefreshFunctionInfo: Forcing refresh of functions");
this.QJa=z.p(this.$.oa.xa,{FilterType:0},U.b(this.lAf,C),this.Cwf,null,null,null)};d.prototype.ETe=function(){this.EQa(d.w8e)};d.prototype.pxd=function(C){this.FYc=C};d.prototype.tJh=function(C){if(this.Eub&&this.$){var Q=this.Eub.yc(C);var P=Q.value;if(!Q.returnValue||P.isCompleted)n.ULS.sendTraceTag(537155728,0,50,"Getting number format category for format index: {0}",C),(P=x.b(this.$.oa.xa,C,this.mKi,null,null,null))&&this.Eub.ia(C,P)}else n.ULS.sendTraceTag(537155729,0,15,"GetCategoryFromServerAsync called on disposed InstantaneousSupportInformationManager instance, skipping")};
d.prototype.sJh=function(C){return 1<=C&&8>=C?1:9<=C&&12>=C?2:13===C||14===C?6:15===C?8:17===C|18===C?7:19===C?4:16===C||20<=C&&29>=C||31===C?11:30===C?9:32<=C&&35>=C?3:0};d.prototype.isActive=function(){var C=void 0===this.ea||null===this.ea,Q=!C&&this.ea.dc;n.ULS.sendTraceTag(537155727,0,50,"InstantaneousSupportInformationManager.IsActive: instantaneous support information manager active:{0} - sessionStateManager IsNullOrUndefined: {1}",Q,C);return Q};d.prototype.Qqj=function(C,Q){this.Llc.ia(C,
Q)};d.prototype.dispose=function(){v.a.Ia(this.mHb);this.mHb=null;this.u1b();for(var C=bk(this.Eub),Q=C.next();!Q.done;Q=C.next())(Q=Q.value.value)&&!Q.isCompleted&&r.AFrameworkApplication.qd.ku(Q.Dt);this.Eub=null;this.ea&&(this.ea.wk(this.Uc),this.rfb&&this.ea.hD(this.C_),this.rfb=!1,this.ea.Bw(this.Qf));this.ea=null;this.$&&J.g(this.$)&&J.g(this.$).ha&&(J.g(this.$).ha.Fma(this.vsf),this.$.rl(this.Yc));this.$=null;K.prototype.dispose.call(this)};d.prototype.isFeatureEnabled=function(C){try{switch(C){case "LocaleLongDateFormat":return T.EwaSettings.ma(197);
case "GetLocaleDayNames":return T.EwaSettings.ma(198);case "CalculateTextWidthIgnoreLetterSpacing":return T.EwaSettings.ma(284);case "OfficeVSO:3657744_CalcFixForDateFormat":return T.EwaSettings.isChangeGateEnabled("OfficeVSO:3657744_CalcFixForDateFormat");case "OfficeVSO:3858161_ClientSideEstimationForDateWithTheYearZero":return T.EwaSettings.isChangeGateEnabled("OfficeVSO:3858161_ClientSideEstimationForDateWithTheYearZero");case "CalcAutocompleteExperiment":return T.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CalcTSAutocompleteExperimentIsEnabled",
!1);case "CalcNewFunctions":return T.EwaSettings.ma(247);case "CalcContractChecks":return T.EwaSettings.ma(248);case "CalcSupportDynamicArrays":return T.EwaSettings.ma(249);case "CalcFormatCalculations":return T.EwaSettings.ma(250);case "CalcFormulaCacheAPIChanges":return T.EwaSettings.ma(251);case "CalcStrictFormulaChecking":return T.EwaSettings.ma(252);case "CalcSupportRowReference":return T.EwaSettings.ma(263);case "CalcParserUsesPledges":return T.EwaSettings.ma(307);case "CalcWebWorker":return!0;
case "CalcWebWorkerTest":return T.EwaSettings.ma(306);case "CalcLookupFunctions":return T.EwaSettings.ma(308);case "CalcLogStopWatch":return T.EwaSettings.ma(371);case "CalcPreventSpillingHack":return T.EwaSettings.ma(253);case "CalcDynamicArrayOperators":return T.EwaSettings.ma(103);case "CalcDotOperator":return T.EwaSettings.ma(583);case "CalcLetFunction":return T.EwaSettings.ma(702);default:return C.startsWith("OfficeVSO:")?T.EwaSettings.isChangeGateEnabled(C):!1}}catch(Q){return n.ULS.sendTraceTag(537155724,
0,15,"InstantaneousSupportInformation.IsFeatureEnabled({0}): feature parsing failed, returning false. Exception: {1}.",C,Q.toString()),!1}};d.prototype.EQa=function(C){this.isActive()&&this.ea.hc.allowEdits?(v.a.Ia(this.mHb),this.mHb=null,this.mHb=I.a.instance.create(this.refresh,C,F.a.Lbi)):n.ULS.sendTraceTag(537155723,0,50,"InstantaneousSupportInformationManager.ScheduleRefresh: won't schedule refresh. Edit permission: AllowEdits {0}, IsEditMode {1}",void 0!==this.ea&&null!==this.ea&&void 0!==this.ea.hc&&
null!==this.ea.hc?this.ea.hc.allowEdits:!1,void 0===this.ea||null===this.ea?!1:this.$.ea.isEditMode)};d.prototype.sYe=function(){n.ULS.sendTraceTag(537155719,0,50,"InstantaneousSupportInformationManager.GetFunctionsInfoAsync called.");this.QJa?n.ULS.sendTraceTag(537155718,0,50,"InstantaneousSupportInformationManager.GetFunctionsInfoAsync already running, skipping."):this.isActive()?this.DX&&this.DX.length||(this.QJa=z.p(this.$.oa.xa,{FilterType:0},this.NKi,this.Cwf,null,null,null)):n.ULS.sendTraceTag(537155717,
0,50,"InstantaneousSupportInformationManager.GetFunctionsInfoAsync session is not yet active, skipping.")};d.prototype.xCc=function(){this.rfb||(this.rfb=!0,this.ea.RD(this.C_))};d.prototype.u1b=function(){this.ku(this.Ydd);this.ku(this.QJa);this.QJa=this.Ydd=null};d.prototype.ku=function(C){C&&!C.isCompleted&&this.$.oa.xa.veb(C.Dt)};d.sRh=function(C,Q){if(!C||!C.length)return[];if(!Q||!Q.length){Q=Array(C.length);for(var P=0;P<C.length;++P)Q[P]=C[P].IfmtIndex;return Q}var ka=new H.a;C=bk(C);for(P=
C.next();!P.done;P=C.next())P=P.value,ka.ia(P.IfmtIndex,new e(P));C=new y.a;P={};Q=bk(Q);for(var R=Q.next();!R.done;P={Jfb:P.Jfb,CPb:P.CPb},R=Q.next())P.Jfb=R.value,P.CPb=void 0,function(fa){return function(){var ca=ka.yc(fa.Jfb.IfmtIndex);fa.CPb=ca.value;return ca}}(P)().returnValue&&P.CPb.data.FormatString===P.Jfb.FormatString||C.add(P.Jfb.IfmtIndex);return C.toArray()};Mf.Object.defineProperties(d.prototype,{we:{configurable:!0,enumerable:!0,get:function(){return this.cn?this.cn.LocaleInformation:
null}},Yxa:{configurable:!0,enumerable:!0,get:function(){return this.cn?this.cn.NumberFormats:[]}},Yia:{configurable:!0,enumerable:!0,get:function(){this.DX&&this.DX.length||this.sYe();return this.DX}},Hbi:{configurable:!0,enumerable:!0,get:function(){return this.cn&&void 0!==this.cn.InstantaneousCalcWebWorkerPrecisionSamplingRate&&null!==this.cn.InstantaneousCalcWebWorkerPrecisionSamplingRate?this.cn.InstantaneousCalcWebWorkerPrecisionSamplingRate:d.Vbh}},Kbi:{configurable:!0,enumerable:!0,get:function(){return this.cn&&
void 0!==this.cn.InstantaneousCalcWebWorkerSampleWorkbookStatisticsRate&&null!==this.cn.InstantaneousCalcWebWorkerSampleWorkbookStatisticsRate?this.cn.InstantaneousCalcWebWorkerSampleWorkbookStatisticsRate:d.Zbh}},Jbi:{configurable:!0,enumerable:!0,get:function(){return this.cn&&void 0!==this.cn.InstantaneousCalcWebWorkerSampleRecalcStatisticsRate&&null!==this.cn.InstantaneousCalcWebWorkerSampleRecalcStatisticsRate?this.cn.InstantaneousCalcWebWorkerSampleRecalcStatisticsRate:d.Ybh}},Ibi:{configurable:!0,
enumerable:!0,get:function(){return this.cn&&void 0!==this.cn.InstantaneousCalcWebWorkerSamplePrecisionPrintFormulaRate&&null!==this.cn.InstantaneousCalcWebWorkerSamplePrecisionPrintFormulaRate?this.cn.InstantaneousCalcWebWorkerSamplePrecisionPrintFormulaRate:d.Xbh}},j$e:{configurable:!0,enumerable:!0,get:function(){return this.cn?this.cn.InstantaneousCalcWebWorkerRenderingTimeLimitInMs:d.Wbh}},cld:{configurable:!0,enumerable:!0,get:function(){return null!==this.FYc?this.FYc:this.cn?this.cn.InstantaneousCalcManualMode:
!1}}});d.Lxd="isim0";d.HZc="isim1";d.fbd="isim2";d.jkf="isim3";d.w8e=100;d.GPd=1E3;d.dxd=3E5;d.Vbh=.001;d.Zbh=.1;d.Ybh=.2;d.Xbh=.001;d.Wbh=50;Object(u.a)(d,"InstantaneousSupportInformationManager",w.a,[792,3]);var N=b(911),M=f.a;Rk(c,M);c.prototype.create=function(){var C=this;if(this.$){n.ULS.sendTraceTag(537155672,0,50,"InstantaneousSupportInformationManagerFactory.Create: Start loading script");var Q=Object(N.a)(this.$.da,268,function(){return new d(C.$.ea,C.$)});this.pb(Q)}};c.ka=function(C){if(!C)throw Error.argumentNull("ewaControl");
C.da.Ga(246,new c(C))};Object(u.a)(c,"InstantaneousSupportInformationManagerFactory",f.a,[]);b.d(E,"a",function(){return a})},1423:function(u,E,b){function a(){N.a.Fa(c.ka)}function c(M){var C=K.call(this)||this;C.$=M;C.Eb();return C}function d(M,C){var Q=this;this.Sja=this.ITd=this.Tlf=!1;this.G8=null;this.PDb=function(){Q.Sja=!1};this.Dc=M;this.gridView=F.g(M);this.calcManager=C;this.Pii=x.EwaSettings.isChangeGateEnabled("OfficeVSO:5041666_ImplementLogRecorderOnEwaJS");this.daf=x.EwaSettings.ma(691);
this.S4=O.a.S4(M);this.eka=x.EwaSettings.isChangeGateEnabled("OfficeVSO:6592066_FixAutoCompleteCardFocusBug");this.gridView.Wb.tm(this.PDb)}function e(M,C,Q,P){this.NHj=M;this.$7f=C;this.hhc=void 0===P?!1:P;Q?(this.Mwa=Q.Mwa,this.MZ=Q.MZ,this.LZ=Q.LZ,this.G4=Q.G4,this.E4=Q.E4):r.ULS.shipAssertTag(524039642,0,!1,"MarqueeMetadata.Ctor: rangeData is null")}function k(M){this.E4=this.G4=this.LZ=this.MZ=!1;this.Mwa=M}function l(M){if(M){var C=new k(M.IsRangeRef);C.MZ=M.IsAbsoluteFirstRow;C.LZ=M.IsAbsoluteFirstColumn;
C.G4=M.IsAbsoluteSecondRow;C.E4=M.IsAbsoluteSecondColumn;return C}}function n(M){var C;if(M){var Q=new k(0===M.kind);M=null===(C=null===M||void 0===M?void 0:M.rangeInfo)||void 0===C?void 0:C.positionKindInfo;if(!M)return Q;Q.MZ=0===M.firstRow;Q.LZ=0===M.firstColumn;Q.G4=0===M.secondRow;Q.E4=0===M.secondColumn;return Q}}u=b(0);var f=b(232),v=b(7),r=b(14),y=b(85),m=b(5),w=b(337);Object(u.a)(k,"MarqueeRangeData",null,[]);Object(u.a)(e,"MarqueeMetadata",null,[]);var B=b(45),A=b(144),z=b(34),x=b(1),D=
b(22),I=b(698),F=b(21),G=b(206),T=b(354),O=b(36),U=b(978),J=b(1186),H="rgba(95, 140, 237, {0});rgba(235, 94, 96, {0});rgba(141, 97, 194, {0});rgba(45, 150, 57, {0});rgba(191, 76, 145, {0});rgba(227, 130, 34, {0});rgba(55, 127, 158, {0})".split(";");d.prototype.$F=function(M,C){this.Pii&&M.textBox.addEventLogRecord("ColoredReferencesManager.TryUpdateColoredReferences");if(this.ITd||M.wH)return!1;var Q=void 0===C||null===C?M.text:C;if(this.calcManager&&1<Q.length&&G.f(Q)){var P=this.Dvb(),ka=this.C_e(),
R=this.Dc.workbookContext.WorkbookFileName,fa=!1,ca=.01>Math.random()?Object(y.a)(A.a,this.Dc.Fb.sc("LoadingUIShown","ColoredReferencesManager")):null;try{var ea=this.calcManager.extractReferences(Q,ka,R,!this.daf);if(!ea)return r.ULS.sendTraceTag(524039689,0,50,"ColoredReferencesManager.UpdateColoredReferences: extractReferences is null (might be an invalid formula)"),!1;ka=[];R=[];for(var wa=[],X=[],ja=0,va=0,ua=new z.a(!1),Xa="",aa=bk(ea.Items),ba=aa.next();!ba.done;ba=aa.next()){var oa=ba.value;
fa=oa.IsStructRef||fa;if(oa.IsBoolean||oa.IsNumber||oa.IsString){var ra=oa.IsBoolean?"rgba(0, 0, 255, 1)":oa.IsNumber?"rgba(9, 134, 88, 1)":"rgba(163, 21, 21, 1)";this.eY(R,Q,ja,oa.Span.Start,null);this.eY(R,Q,oa.Span.Start,oa.Span.End,ra);ja=oa.Span.End}else if(x.EwaSettings.ma(594)){if(oa.Range||oa.LetName&&0<=oa.LetNumber){ea=null;if(oa.Range){var db=B.D(oa.Range);ea=this.EJa(db,ua,1);ka.push(new T.a(db,P))}else oa.LetName&&0<=oa.LetNumber&&(ea=Xa=this.eKh(oa.LetName,oa.LetNumber,ua,Xa),va!==ua.count&&
M.colors.add(oa.Span.Start+"-"+oa.Span.End,H[(ua.count-1)%H.length]));this.eY(R,Q,ja,oa.Span.Start,null);this.eY(R,Q,oa.Span.Start,oa.Span.End,ea);ja=oa.Span.End;wa.push(oa.Span);var Ka=R.length-1;X.push(new e(Ka,R[Ka].text,l(oa)));va=ua.count}}else if(oa.Range){var Ga=B.D(oa.Range),xa=this.EJa(Ga,ua,1);this.eY(R,Q,ja,oa.Span.Start,null);this.eY(R,Q,oa.Span.Start,oa.Span.End,xa);ka.push(new T.a(Ga,P));ja=oa.Span.End;wa.push(oa.Span);var da=R.length-1;X.push(new e(da,R[da].text,l(oa)))}}this.eY(R,
Q,ja,Q.length,null);this.e_f(M,R,!!C);var qa=M.textBox.text;if(!D.a.equals(qa,Q,!1)){r.ULS.shipAssertTag(38114182,0,!1,"ColoredReferencesManager.UpdateColoredReferences: The text we created is different from the original text. Setting the original text back. currentTextLength [{0}], originalTextLength [{1}]",qa.length,Q.length);var na=M.textBox.caretPosition;M.textBox.text=Q;M.textBox.caretPosition=na;return!0}this.KM(ka,ua,X);x.EwaSettings.ma(594)&&0<ka.length&&r.ULS.sendTraceTag(524039688,0,50,
"ColoredReferencesManager.UpdateColoredReferences: Cell reference(s) colored");x.EwaSettings.ma(594)&&0<M.colors.count&&r.ULS.sendTraceTag(524039687,0,50,"ColoredReferencesManager.UpdateColoredReferences: Let name(s) colored");return this.Sja=!0}finally{ca&&ca.KAa(function(){fa&&r.ULS.sendTraceTag(524039686,0,50,"ColoredReferencesManager.UpdateColoredReferences: Formula with structured reference is highlighted in {0} ms",ca.qc)})}}else return this.KM(null,null),this.Sja&&(this.Sja=!1,P=M.textBox.caretPosition,
M.textBox.setPlainText(Q),M.textBox.caretPosition=Math.min(P,Q.length),C)?!0:!1};d.prototype.kAc=function(M,C,Q){if(this.ITd||M.wH)return!1;var P=isNullOrUndefined(C)?M.text:C,ka=[],R=new z.a(!1);if(1<P.length&&Object(U.b)(Q)){var fa=[],ca=[],ea=[],wa=0,X=this.Dvb();Q=bk(Q.formulaHighlights);for(var ja=Q.next();!ja.done;ja=Q.next()){ja=ja.value;this.eY(fa,P,wa,ja.span.start,null);switch(ja.kind){case 0:case 1:case 2:wa=B.B(ja.rangeInfo.sharedRange);if(isNullOrUndefined(wa)){r.ULS.sendTraceTag(521211937,
0,10,"ColoredReferencesManager.tryUpdateFormulaHighlights: Received formula highlight with undefined range, HighlightKind:{0},",ja.kind.toString());this.eY(fa,P,ja.span.start,ja.span.end,null);break}var va=this.EJa(wa,R,1);this.eY(fa,P,ja.span.start,ja.span.end,va);ka.push(new T.a(wa,X));ca.push({Start:ja.span.start,End:ja.span.end});wa=fa.length-1;ea.push(new e(wa,fa[wa].text,n(ja)));break;case 3:this.eY(fa,P,ja.span.start,ja.span.end,null,"rgba(229, 229, 229, 1)")}wa=ja.span.end}this.eY(fa,P,wa,
P.length);this.e_f(M,fa,!!C);C=M.textBox.text;if(!D.a.equals(C,P,!1))return r.ULS.shipAssertTag(521211936,0,!1,"ColoredReferencesManager.UpdateFormulaHighlights: The text we created is different from the original text. Setting the original text back. currentTextLength [{0}], originalTextLength [{1}]",C.length,P.length),C=M.textBox.caretPosition,M.textBox.text=P,M.textBox.caretPosition=C,!0;this.KM(ka,R,ea);return this.Sja=!0}this.KM(null,null);return this.Sja&&(this.Sja=!1,ka=M.textBox.caretPosition,
M.textBox.setPlainText(P),M.textBox.caretPosition=Math.min(ka,P.length),C)?!0:!1};d.prototype.Fpf=function(M,C,Q){if(!M||!C||!Q)return r.ULS.shipAssertTag(524039685,0,!!M,"ColoredReferencesManager.MoveMarqueeRange: cellContentEditor is null"),r.ULS.shipAssertTag(524039684,0,!!C,"ColoredReferencesManager.MoveMarqueeRange: highlightState is null"),r.ULS.shipAssertTag(524039683,0,!!Q,"ColoredReferencesManager.MoveMarqueeRange: newRange is null"),!1;var P=Object(y.a)(e,C.metadata);if(!P)return r.ULS.shipAssertTag(524039682,
0,!1,"ColoredReferencesManager.MoveMarqueeRange: marqueeMetadata is null"),!1;var ka=P.NHj,R=P.$7f,fa=this.gridView.Ab.Abf(Q)?Q.Bac(P.LZ,P.MZ):Q.W3a(P.LZ,P.MZ,P.E4,P.G4);if(!fa)return r.ULS.shipAssertTag(524039681,0,!1,"ColoredReferencesManager.MoveMarqueeRange: newText is null"),!1;var ca=R.indexOf("!");-1!==ca&&(fa=R.substring(0,ca+1)+fa);if(!M.textBox.changeTextInExistingTextPart(ka,R,fa))return r.ULS.shipAssertTag(38926105,0,!1,"ColoredReferencesManager.MoveMarqueeRange: failed to change the text part"),
!1;P.$7f=fa;ka=!0;for(R=1;4>=R;R++)(fa=F.g(this.Dc).qb.cw(3,R,C.w$))?(fa.range=Q,fa.metadata=P):(r.ULS.shipAssertTag(524039680,0,!1,"ColoredReferencesManager.MoveMarqueeRange: highlightStateInPane is null"),ka=!1);this.gridView.qb.update(!1,!1);this.gridView.pj&&(this.gridView.$b.textBox.text=M.text);this.gridView.$b.KGb(new w.a({Iyb:!0}));return ka};d.prototype.Tii=function(M){if(3!==M.hr)return r.ULS.shipAssertTag(524039651,0,!1,"ColoredReferencesManager.IsMarqueeHighlightDragable: not HighlightDivIndex.Marquee."),
!1;M=Object(y.a)(e,M.metadata);return M?M.Mwa&&!M.hhc:(r.ULS.shipAssertTag(524039650,0,!1,"ColoredReferencesManager.IsMarqueeHighlightDragable: marqueeMetadata is null."),!1)};d.prototype.Jdb=function(M,C){r.ULS.sendTraceTag(524039649,0,50,"ColoredReferencesManager.SuspendResumeColoredReferences: "+(C?"suspending":"resuming")+" colored references");C&&this.Sja&&(this.Sja=!1,this.KM(null,null),M.textBox.DXg());this.ITd=C};d.prototype.dispose=function(){this.gridView&&this.gridView.Wb&&this.gridView.Wb.Nl(this.PDb)};
d.prototype.Sid=function(M){var C=this.formulaAssistanceTelemetryManager;C||this.Tlf||(this.Tlf=!0,r.ULS.sendTraceTag(521211935,0,50,"ColoredReferencesManager.highlightPreviewRanges: Failed to log highlightPreviewRanges measurement, FormulaAssistanceTelemetryManager unavailable"));null===C||void 0===C?void 0:C.iO(["highlightPreviewRanges"]);this.S4?this.f6h(M):this.e6h(M);null===C||void 0===C?void 0:C.dQ(["highlightPreviewRanges"],!0)};d.prototype.f6h=function(M){var C=this.formulaAssistanceManager.wdd(M,
J.a);if(isNullOrUndefined(C))this.eka&&this.KM(null,null);else{var Q=this.Dvb(),P=[],ka=new z.a(!1),R=[];C=bk(C.formulaHighlights);for(var fa=C.next();!fa.done;fa=C.next()){fa=fa.value;var ca=fa.kind;if(0===ca||2===ca||1===ca)ca=B.B(fa.rangeInfo.sharedRange),Object(U.b)(ca)&&(P.push(new T.a(ca,Q)),this.EJa(ca,ka,1),R.push(new e(fa.span.start,M.substring(fa.span.start,fa.span.end),n(fa),!0)))}this.KM(P,ka,R)}};d.prototype.e6h=function(M){var C=this.Dvb(),Q=this.C_e(),P=this.Dc.workbookContext.WorkbookFileName,
ka=[],R=new z.a(!1),fa=[];if(Q=this.calcManager.extractReferences(M,Q,P,!this.daf)){Q=bk(Q.Items);for(P=Q.next();!P.done;P=Q.next())if(P=P.value,P.Range){var ca=B.D(P.Range);ka.push(new T.a(ca,C));this.EJa(ca,R,1);fa.push(new e(P.Span.Start,M.substring(P.Span.Start,P.Span.End),l(P),!0))}this.KM(ka,R,fa)}else this.eka&&this.KM(null,null)};d.prototype.EJa=function(M,C,Q){var P=C.getItem(M.toString());P||(P=H[C.count%H.length],C.add(M.toString(),P));return String.format(P,Q)};d.prototype.eKh=function(M,
C,Q,P){M="["+M+", "+C+"]";C=Q.getItem(M);C||(C=Q.count%H.length,C=H[C],P===String.format(C,1)&&(Q.add("skip-"+M,C),C=Q.count%H.length,C=H[C]),Q.add(M,C));return String.format(C,1)};d.prototype.eY=function(M,C,Q,P,ka,R){ka=void 0===ka?null:ka;R=void 0===R?null:R;r.ULS.shipAssertTag(524039648,0,Q<=P,"ColoredReferencesManager.AddTextPart: startIndex cannot be larger than endIndex");Q<P&&(C=C.substring(Q,P),M.push(Object(v.a)(new I.a,{text:C,color:ka,backgroundColor:R})))};d.prototype.KM=function(M,C,
Q){var P=this;Q=void 0===Q?null:Q;M&&M.length?(r.ULS.sendTraceTag(524039647,0,50,"ColoredReferencesManager.HighlightRanges: number of ranges to highlight: "+M.length),M.reverse(),Q.reverse(),this.gridView.qb.Fw(M,[3],!0,function(ka,R){if(ka&&ka.range&&R){r.ULS.shipAssertTag(524039643,0,C.kb(ka.range.toString()),"ColoredReferencesManager.HighlightRanges: The range '{0}' doesn't exist in the range to color dictionary",ka.range.toString());var fa=P.EJa(ka.range,C,.1),ca=P.EJa(ka.range,C,1);P.Dc.frame&&
P.Dc.frame.nH&&P.Dc.frame.nH.oka||(R.style.background=fa);R.style.borderColor=ca;Q&&(R.setAttribute(m.a.Ixb,ka.w$.toString()),ka.metadata=Q[ka.w$])}else r.ULS.shipAssertTag(524039646,0,!!ka,"ColoredReferencesManager.HighlightRanges: state is null"),r.ULS.shipAssertTag(524039645,0,!!ka.range,"ColoredReferencesManager.HighlightRanges: state.Range is null"),r.ULS.shipAssertTag(524039644,0,!!R,"ColoredReferencesManager.HighlightRanges: div is null")})):(M=this.Dc.Fb.sc("UserAction","HideRangesHighlightsStopwatch"),
this.gridView.qb.eh([3]),this.gridView.qb.ncb(new T.a(null,this.Dvb()),[3]),M.stop())};d.prototype.e_f=function(M,C,Q){var P=M.textBox;P.UJ=!0;var ka=P.selection,R=ka.index;ka=R+ka.length;P.setTextFromTextParts(C);C=P.text.length;P.selectRange(Math.min(R,C),Math.min(ka,C));Q&&M.KGb(new w.a);P.UJ=!1};d.prototype.Dvb=function(){return this.B_e().sheetId};d.prototype.C_e=function(){return this.B_e().sheetName};d.prototype.B_e=function(){return this.gridView.dt&&this.gridView.dt.tK?this.gridView.dt.tK:
this.Dc.pa};Mf.Object.defineProperties(d.prototype,{formulaAssistanceManager:{configurable:!0,enumerable:!0,get:function(){this.G8||(this.G8=this.Dc.da.za(464));return this.G8}},formulaAssistanceTelemetryManager:{configurable:!0,enumerable:!0,get:function(){this.lDa||(this.lDa=this.Dc.da.za(491));return this.lDa}}});Object(u.a)(d,"ColoredReferencesManager",null,[526,3]);var K=f.a;Rk(c,K);c.prototype.create=function(){var M=this;this.$.da.Za(266,function(C){C=x.EwaSettings.xl()||x.EwaSettings.isChangeGateEnabled("OfficeVSO:6143820_MoveServiceRegistrationFromFAM")?
M.$.da.za(281)||M.$.da.Ga(281,new d(M.$,C)):new d(M.$,C);M.pb(C)})};c.ka=function(M){M.da.Ga(282,new c(M))};Object(u.a)(c,"ColoredReferencesManagerFactory",f.a,[]);var N=b(10);b.d(E,"a",function(){return a})},1471:function(u,E,b){function a(){n.a.Fa(c.ka)}function c(f){var v=l.call(this)||this;v.$=f;v.Eb();return v}u=b(0);var d=b(232),e=b(1016),k=b(1),l=d.a;Rk(c,l);c.prototype.create=function(){var f=this;this.$.da.Za(266,function(v){v=k.EwaSettings.xl()||k.EwaSettings.isChangeGateEnabled("OfficeVSO:6143820_MoveServiceRegistrationFromFAM")?
f.$.da.za(294)||f.$.da.Ga(294,new e.RelativeAndAbsoluteReferencesManager(v)):new e.RelativeAndAbsoluteReferencesManager(v);f.pb(v)})};c.ka=function(f){f.da.Ga(295,new c(f))};Object(u.a)(c,"RelativeAndAbsoluteReferencesManagerFactory",d.a,[]);var n=b(10);b.d(E,"a",function(){return a})},1597:function(u,E,b){b.r(E);u=b(1406);E=b(1361);var a=b(1423);b=b(1471);Type.registerNamespace("_Ewa");Object(u.a)();Object(E.a)();Object(a.a)();Object(b.a)()}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.calc.js.map/af10a3f01d616d55484ccdd3890e6ae7/EwaDS.calc.js.map