(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[4],{1047:function(u,E,b){function a(){}b.d(E,"a",function(){return a});u=b(0);var c=b(14),d=b(4),e=b(39),k=b(27);a.FVe=function(l,n){switch(l){case 3:return a.n_h(n);case 2:return a.WSh(n);case 1:return a.lNh(n)}return""};a.n_h=function(l){switch(l){case 1:return d.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkWordWac.toString();case 2:return d.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkWordWac.toString()}return""};
a.WSh=function(l){switch(l){case 1:return d.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkPptWac.toString();case 2:return d.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkPptWac.toString()}return""};a.lNh=function(l){switch(l){case 1:return d.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkExcelWac.toString();case 2:return d.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkExcelWac.toString()}return""};a.openInClient=function(l,n,f){if(k.a.rh||k.a.To)window.setTimeout(function(){a.mMf(f,
a.jcc())},500),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(a.ppe(f),l,0,!1)};a.mYg=function(l,n,f,v){n&&v&&v();a.openInClient(l,n,f)};a.jcc=function(){return k.a.rh?1:k.a.To?2:k.a.f7a?3:k.a.isMac?4:0};a.j_h=function(l){switch(l){case 3:return"WildFireWordBizBar";case 2:return"WildFirePowerPointBizBar";case 1:return"WildFireExcelBizBar";default:return""}};a.k_h=function(l){switch(l){case 3:return"WildFireWordBizBarFlight";case 2:return"WildFirePowerPointBizBarFlight";case 1:return"WildFireExcelBizBarFlight";
default:return""}};a.mMf=function(l,n){1===n?(c.ULS.sendTraceTag(17151569,306,50,"User Directed to App Store"),l=a.FVe(l,n),8<k.a.W4a?e.a.Ze(l,void 0,void 0,"RedirectToAppStore"):e.a.PU(l)):document.hidden||(a.kzb?(l=d.AFrameworkApplication.fa.appSettings.WildFireUrlChinaStoreAndroid.toString())?(c.ULS.sendTraceTag(18088018,306,50,"User Directed to China Proxy Page"),e.a.PU(l)):c.ULS.sendTraceTag(18088019,306,50,"Empty Url in China Proxy Page BRS Setting"):(c.ULS.sendTraceTag(18088020,306,50,"User Directed to Play Store"),
MSOJS.ClientUtils.NavigateToUrlUsingClickingOnATag(a.FVe(l,n),null,null)))};a.ppe=function(l){switch(l){case 3:return 5;case 2:return 3;case 1:return 1;default:return 0}};a.Xbd=function(l){switch(l){case 3:return"WordBizBarDismiss";case 2:return"PptBizBarDismiss";case 1:return"ExcelBizBarDismiss";default:return""}};a.Ynd=function(l){return(l=a.cQh(l))&&""!==l?Boolean.parse(l):!1};a.AOd=function(l){a.mqj(l)};a.cQh=function(l){try{return localStorage.getItem(l)}catch(n){return c.ULS.sendTraceTag(18416668,
306,50,"WildFire LocalStorage GetItem Failed with NullReferenceException : "+n.message),null}};a.mqj=function(l){try{localStorage.setItem(l,"true")}catch(n){c.ULS.sendTraceTag(18416669,306,50,"WildFire LocalStorage SetItem Failed with exception : "+n.message)}};Mf.Object.defineProperties(a,{kzb:{configurable:!0,enumerable:!0,get:function(){return"zh-CN"===window.navigator.language}},Qwc:{configurable:!0,enumerable:!0,get:function(){return(k.a.f7a||k.a.isMac)&&k.a.Uo}},sxj:{configurable:!0,enumerable:!0,
get:function(){return k.a.rh||k.a.To}}});a.ixe="ChromeExtensionBarDismiss";Object(u.a)(a,"WildFireUtilities",null,[])},1252:function(u,E,b){function a(){c.a.ti(".ewa-bb{padding:0;display:block;background-color:#fcf7b6;color:#444;position:relative;overflow:hidden;cursor:default}.ewa-bb-entry{position:relative;height:auto;border-bottom:1px solid #d7d889;overflow:hidden}.ewa-bb.ewa-bb-react{background-color:#f5f5f5}.ewa-bb-entry:first-child{border-top:1px solid #d7d889}.ewa-bb-entry-body{min-height:24px;position:relative}.ewa-bb-icon{vertical-align:middle;display:inline-block}.ewa-bb-entry-icon{margin:2px 6px 0;display:inline-block}.ewa-bb-entry-title{font-weight:bold}.ewa-bb-entry-message{padding:0 8px}.ewa-bb-entry-button{background-color:#fff;border:1px solid #ababab;color:#444;text-align:center;cursor:default;margin-bottom:1px;padding:3px 10px 4px}.ewa-bb-entry-button:hover{background:#f0f0f0}.ewa-bb-entry-button:active{background:#c6c6c6}.ewa-bb-entry-link{color:#369}.ewa-bb-entry-close{position:absolute;top:50%;margin-top:-8px;cursor:pointer}.ewa-bb-entry-close .clip16x16{display:inline-block}.ewa-bb-entry-title,.ewa-bb-entry-message,.ewa-bb-entry-button-holder,.ewa-bb-entry-link{vertical-align:middle}.ewa-root-ltr .ewa-bb-entry-close,.ewa-nov2-ltr .ewa-bb-entry-close{right:2px}.ewa-root-ltr .ewa-bb-content,.ewa-nov2-ltr .ewa-bb-content{margin-right:26px}.ewa-root-ltr .ewa-bb-entry-button-holder,.ewa-nov2-ltr .ewa-bb-button-holder,.ewa-root-ltr .ewa-bb-entry-link,.ewa-nov2-ltr .ewa-bb-entry-link{margin-left:8px}.ewa-root-rtl .ewa-bb-entry-close,.ewa-nov2-rtl .ewa-bb-entry-close{left:2px}.ewa-root-rtl .ewa-bb-content,.ewa-nov2-rtl .ewa-bb-content{margin-left:26px}.ewa-root-rtl .ewa-bb-entry-button-holder,.ewa-nov2-rtl .ewa-bb-button-holder,.ewa-root-rtl .ewa-bb-entry-link,.ewa-nov2-rtl .ewa-bb-entry-link{margin-right:8px}")}
b.d(E,"a",function(){return a});var c=b(559)},1253:function(u,E,b){function a(f,v,r,y,m,w,B){B=void 0===B?null:B;var A=n.call(this)||this;A.KI=null;A.La=v;A.sX=y;A.nga=w;A.ib=f;A.ps=m;A.Re=r;A.Vhb=A.ib.qa("SaveToHostWithExtraCharsInFileName");A.xh=B;A.mc(1,CommonUIStrings.l_SaveButtonLabel);return A}b.d(E,"a",function(){return a});u=b(0);var c=b(14),d=b(84);E=b(150);var e=b(4),k=b(43),l=b(29),n=E.a;Rk(a,n);a.prototype.bHe=function(f,v){this.TK(1,!!f&&f!==v);this.KI=document.getElementById(a.BRe);
k.a.addHandler(this.KI,"change",Object(d.a)(this,this.Imc,"onFileNameChange"));k.a.addHandler(this.KI,"input",Object(d.a)(this,this.Imc,"onFileNameChange"));this.KI.focus()};a.prototype.i9b=function(f){return this.Vhb?(new RegExp("["+this.S7b('\\/:*?"<>|')+"]")).test(f):(new RegExp("["+this.S7b('\\/:*?"<>|#{}%~&')+"]")).test(f)};a.prototype.S7b=function(f){return f.replace(RegExp("[.*+?|()\\[\\]{}\\\\]","g"),"\\\\$&")};a.prototype.chd=function(){var f=l.a.nq(e.AFrameworkApplication.am.Pm);this.TK(1,
!!this.KI&&""!==this.KI.value&&this.KI.value!==f)};a.prototype.Imc=function(){var f=this;this.KI&&window.setTimeout(function(){f.chd()},0)};a.prototype.h9b=function(f,v){if(1!==f)c.ULS.sendTraceTag(23881882,216,50,"User click cancel to cancel upload file in file name dialog.");else{f=v[a.BRe];v=a.oEf in v?v[a.oEf]:!1;c.ULS.sendTraceTag(23881883,216,50,"User click save to upload file with new name {0} and overwrite the target {1}.",l.a.Xqc(f),v);var r=l.a.Z3(e.AFrameworkApplication.fileName);(f=f?
f.trim():null)&&""!==f&&""!==r||1===this.ta.state?this.i9b(f)?this.ps.create().displayError(1,f,v):this.nga.Nna(f+r,v,this.xh):this.ps.create().displayError(2,f,v)}};a.prototype.dispose=function(){this.KI&&(k.a.removeHandler(this.KI,"change",Object(d.a)(this,this.Imc,"onFileNameChange")),k.a.removeHandler(this.KI,"input",Object(d.a)(this,this.Imc,"onFileNameChange")),this.KI=null);n.prototype.dispose.call(this)};Mf.Object.defineProperties(a.prototype,{ta:{configurable:!0,enumerable:!0,get:function(){return this.Re}}});
a.BRe="txtFileName";a.oEf="chkOverwrite";Object(u.a)(a,"FileNameDialogBase",E.a,[])},1254:function(u,E,b){function a(y,m,w,B){this.KVb=null;this.Wug=y;this.ib=w;this.Ebe=m;this.l$d=new d.a;this.ph=B}b.d(E,"a",function(){return a});u=b(0);var c=b(14),d=b(162),e=b(84),k=b(4),l=b(739),n=b(1046),f=b(392),v=b(107),r=b(25);a.prototype.V6a=function(){return this.ib.qa("SaveToCloudStorageUIIsEnabled")};a.prototype.gVe=function(){return r.a.saveToCloudStorage};a.prototype.i1b=function(){f.a.PGd(Object(e.a)(this,
this.JUf,"saveToCloudActionDispatcher"));f.a.o7c([new n.a(r.a.saveToCloudStorage,v.a.frame,0)],this.Ebe.K3a())};a.prototype.Bg=function(){var y=this,m=this.Ebe.K3a();m?(m.E9(function(){y.l$d.setResult(!0)}),this.i1b()):c.ULS.sendTraceTag(6590596,216,15,"Failure with OneDrive API download as the onedrive url received is empty ")};a.prototype.aMf=function(){c.ULS.sendTraceTag(6590597,216,50,"User clicked on SaveToOneDrive button")};a.prototype.JUf=function(y,m,w,B,A){var z=this;return m.contextId!==
v.a.frame||y!==this.gVe()?2:this.V6a()?1===w?l.SessionStatusManager.instance.Dwb||k.AFrameworkApplication.Y4?8:32:2===w?(this.aMf(),A&&A.FileDownloadUrl&&c.ULS.sendTraceTag(50708835,216,50,"SaveToCloudStorageActor FileDownloadUrl is there"),this.ph&&(this.KVb=this.ph.sc("DialogShown","SaveToOneDriveReponseTime")),this.l$d.task.continueWith(function(){z.KVb&&(z.KVb.stop(),z.KVb=null);z.Wug.start(A)}),32):8:8};Object(u.a)(a,"SaveToCloudStorageActor",null,[692])},1255:function(u,E,b){function a(m,w,
B,A,z){this.E8=this.qm=this.xCa=null;this.fDa=!1;this.xh=this.mga=null;this.RRc=m;this.Bkb=w;this.ps=B;this.Re=A;this.ph=z}b.d(E,"a",function(){return a});u=b(0);var c=b(14),d=b(84),e=b(1256),k=b(4),l=b(41),n=b(39),f=b(246),v=b(391),r=b(170),y=b(977);a.prototype.PLb=function(){this.Re&&1===this.Re.state||(this.qm=this.Bkb(),this.qm.message=CommonUIStrings.l_CommentProgressTooltip,this.qm.Rb=5,this.qm.Pu=!1,this.qm.DAa(CommonUIStrings.l_DefaultDialogTitle,null,null))};a.prototype.kIa=function(){this.qm&&
(this.qm.close(),this.qm=null)};a.prototype.$R=function(){1!==k.AFrameworkApplication.ta.state&&this.ps().displayError(e.a.default)};a.prototype.FPa=function(){c.ULS.sendTraceTag(6590599,216,50,"Redirecting to OneDrive Folder.");n.a.Ze(this.E8,n.a.jX(3),void 0,"UploadToCloudManager.RedirectToFolder")};a.prototype.EPa=function(m){var w=!1,B=!1;k.AFrameworkApplication.fa&&(w=k.AFrameworkApplication.fa.qa("SaveACopyIsEnabledForUiHost"),B=k.AFrameworkApplication.fa.qa("UiHostSupportsDocRebootFeatures"));
c.ULS.sendTraceTag(6654163,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",m,w);if(w&&B){c.ULS.sendTraceTag(594929733,216,50,"UploadToCloudManager.RedirectToEditUrl: Sending DocumentRefresh post message.");var A={};A[v.a.zPa]="1";A[v.a.documentUrl]=m;k.AFrameworkApplication.$U().execute(function(z){z.uj(r.a.Eta,A)})}else n.a.Ze(m,n.a.jX(3),void 0,"UploadToCloudManager.RedirectToEditUrl")};a.prototype.Nna=function(m,w,B,A){B=void 0===B?null:B;A=void 0===A?null:A;c.ULS.sendTraceTag(7143886,
216,50,"Starting to upload file");this.ph&&(this.mga=this.ph.sc("DialogShown","SaveToOneDriveUploadTime"));this.PLb();this.E8=w;this.xCa=this.RRc.create(m,B,A);this.xh=A;this.gQ()};a.prototype.gQ=function(){c.ULS.sendTraceTag(6590600,216,50,"Calling SkydriveUploadHandler.");this.xCa.execute(Object(d.a)(this,this.AQi,"onSaveToCloudUploadFinished"),Object(d.a)(this,this.zQi,"onSaveToCloudUploadFailed"))};a.prototype.AQi=function(m){this.kIa();this.fDa=!1;if(m&&m.data&&m.data.Td){var w=l.d(m.data.Td);
var B=w.Lt;if(w.returnValue)if(B.StatusCode!==f.a.JO&&B.StatusCode!==f.a.prb)c.ULS.sendTraceTag(6590602,216,10,"UploadToCloudManager upload failure. Response data is not JSON."),this.$R();else{c.ULS.sendTraceTag(6590603,216,50,"UploadToCloudManager upload success.");try{B.NewDocumentUrl&&""!==B.NewDocumentUrl?this.EPa(B.NewDocumentUrl):this.FPa()}catch(A){c.ULS.sendTraceTag(37025728,216,15,"Redirect failed with exception: {0}",A.toString())}this.QFb()}else B={},c.ULS.sendTraceTag(7660114,216,10,"Failed to deserialize : {0}",
(B.ResponseData=y.a.ueb(m.data.Td),B)),this.$R()}else c.ULS.sendTraceTag(6590601,216,10,"UploadToCloudManager upload failure. Response data is null"),this.$R()};a.prototype.zQi=function(m){5!==m.data.status&&12!==m.data.status||this.fDa?(c.ULS.sendTraceTag(6590605,216,10,"UploadToCloudManager HTTP failure with code: {0}",m.data.status),this.kIa(),this.$R(),this.QFb()):(c.ULS.sendTraceTag(6590604,216,10,"UploadToCloudManager failure. Retrying."),this.fDa=!0,this.gQ())};a.prototype.QFb=function(){this.mga&&
(this.mga.stop(),this.mga=null)};Object(u.a)(a,"UploadToCloudManager",null,[672])},1256:function(u,E,b){function a(){}b.d(E,"a",function(){return a});u=b(0);a.default=0;Object(u.a)(a,"SaveToCloudErrorCodes",null,[])},1257:function(u,E,b){function a(l,n,f,v,r,y){this.xh=null;this.Tvg=l;this.P1=n;this.Tlb=f;this.ib=v;this.sQb=r;this.ps=y}b.d(E,"a",function(){return a});u=b(0);var c=b(14),d=b(84),e=b(1256),k=b(83);a.prototype.start=function(l){this.xh=l;if("SharePointOnlineConsumer"===this.ib.Wa("FileSource")){var n=
k.a.instance.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager");if(n){n.start(null,l);return}}this.P1.zLa?(c.ULS.sendTraceTag(6590559,216,50,"User is signed in. We will show file picker."),this.uTg()):(c.ULS.sendTraceTag(6590560,216,50,"User is not signed in. We will show sign in dialog."),this.showSignInDialog())};a.prototype.showSignInDialog=function(){this.Tvg.create().YP()};a.prototype.hj=function(){this.ps().displayError(e.a.default)};a.prototype.uTg=function(){try{c.ULS.sendTraceTag(6590561,
216,50,"Initializing OneDrive API");var l={},n=(l.client_id=this.ib.appSettings.UploadToSkyDriveClientId,l.env="INT",l);if(1===this.sQb||2===this.sQb)l={},n=(l.client_id=this.ib.appSettings.UploadToSkyDriveClientId,l);l={};var f=(l.mode="save",l.lightbox="grey",l);WL.init(n);c.ULS.sendTraceTag(6590562,216,50,"OneDrive API is initialized. Launching file dialogue");WL.fileDialog(f).then(Object(d.a)(this,this.onSuccess,"onSuccess"),Object(d.a)(this,this.e6,"onFailure"))}catch(v){c.ULS.sendTraceTag(6590563,
216,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",v,v.stack),this.hj()}};a.prototype.onSuccess=function(l){c.ULS.sendTraceTag(6590592,216,50,"Success Callback called. Calling UploadToCloudManger to start upload.");l&&l.data&&l.data.folders&&this.Tlb.Nna(l.data.folders[0].id,l.data.folders[0].urls.viewInBrowser,null,this.xh)};a.prototype.e6=function(l){if(l&&l.error){if("user_canceled"===l.error.code){c.ULS.sendTraceTag(6590593,216,50,"User cancelled upload to their OneDrive.");return}c.ULS.sendTraceTag(6590594,
216,50,"File Dialog returned with error code:{0}, and error message: {1}",l.error.code,l.error.message)}else c.ULS.sendTraceTag(6590595,216,50,"File Dialog returned with no response");this.hj()};Object(u.a)(a,"SaveToCloudManager",null,[693])},1258:function(u,E,b){function a(l,n){l=k.call(this,l,n)||this;c.ULS.sendTraceTag(537170201,0,50,"WacGdprNoticeBusinessBarEntry.WacGdprNoticeBusinessBarEntry: Called");l.title="";l.message=a.yxa;l.Cva=!0;return l}b.d(E,"a",function(){return a});u=b(0);var c=b(14),
d=b(39),e=b(81);b=b(919);var k=b.a;Rk(a,k);a.prototype.Sla=function(l){k.prototype.Sla.call(this,l);d.a.openWindow(4,e.a.dH(a.dnf))};a.prototype.PC=function(l){k.prototype.PC.call(this,l);a.hud&&a.hud(null)};a.initialize=function(l,n,f,v){c.ULS.sendTraceTag(537170200,0,50,"WacGdprNoticeBusinessBarEntry.Initialize: Called");a.yxa=l;a.enf=n;a.dnf=f;a.hud=v};Mf.Object.defineProperties(a.prototype,{linkText:{configurable:!0,enumerable:!0,get:function(){return a.enf}}});a.yxa=null;a.enf=null;a.dnf=null;
a.hud=null;Object(u.a)(a,"WacGdprNoticeBusinessBarEntry",b.a,[])},1259:function(u,E,b){function a(){}b.d(E,"a",function(){return a});u=b(0);a.Ylh="ewa-bb";a.$lh="ewa-bb-entry";a.hmh="ewa-bb-react";a.amh="ewa-bb-entry-body";a.gmh="ewa-bb-icon";a.cmh="ewa-bb-entry-icon";a.fmh="ewa-bb-entry-title";a.emh="ewa-bb-entry-message";a.DLe="ewa-bb-entry-button";a.dmh="ewa-bb-entry-link";a.bmh="ewa-bb-entry-close";a.ELe="ewa-bb-entry-button-holder";a.Zlh="ewa-bb-content";Object(u.a)(a,"CssClassNames",null,[])},
1260:function(u,E,b){function a(d,e){d=c.call(this,d,e)||this;d.Ou=!0;d.title=a.Soa;d.message=a.Qoa;return d}b.d(E,"a",function(){return a});u=b(0);b=b(919);var c=b.a;Rk(a,c);a.prototype.lo=function(d){c.prototype.lo.call(this,d);(d=a.Roa)&&d(null)};a.initialize=function(d,e,k,l){a.Soa=d;a.Qoa=e;a.Poa=k;a.Roa=l};Mf.Object.defineProperties(a.prototype,{actionButton:{configurable:!0,enumerable:!0,get:function(){return a.Poa}}});a.Soa=null;a.Qoa=null;a.Poa=null;a.Roa=null;Object(u.a)(a,"AutomaticSensitivityLabelBusinessBarEntry",
b.a,[])},1261:function(u,E,b){function a(d,e){d=c.call(this,d,e)||this;d.Ou=!0;d.title=a.Soa;d.message=a.Qoa;return d}b.d(E,"a",function(){return a});u=b(0);b=b(919);var c=b.a;Rk(a,c);a.prototype.lo=function(d){c.prototype.lo.call(this,d);(d=a.Roa)&&d(null)};a.initialize=function(d,e,k,l){a.Soa=d;a.Qoa=e;a.Poa=k;a.Roa=l};Mf.Object.defineProperties(a.prototype,{actionButton:{configurable:!0,enumerable:!0,get:function(){return a.Poa}}});a.Soa=null;a.Qoa=null;a.Poa=null;a.Roa=null;Object(u.a)(a,"RecommendedSensitivityLabelBusinessBarEntry",
b.a,[])},1262:function(u,E,b){function a(d,e){d=c.call(this,d,e)||this;d.Ou=!0;d.title=a.Soa;d.message=a.Qoa;return d}b.d(E,"a",function(){return a});u=b(0);b=b(919);var c=b.a;Rk(a,c);a.prototype.lo=function(d){c.prototype.lo.call(this,d);(d=a.Roa)&&d(null)};a.initialize=function(d,e,k,l){a.Soa=d;a.Qoa=e;a.Poa=k;a.Roa=l};Mf.Object.defineProperties(a.prototype,{actionButton:{configurable:!0,enumerable:!0,get:function(){return a.Poa}}});a.Soa=null;a.Qoa=null;a.Poa=null;a.Roa=null;Object(u.a)(a,"MandatorySensitivityLabelBusinessBarEntry",
b.a,[])},1263:function(u,E,b){function a(d,e){d=c.call(this,d,e)||this;d.Ou=!0;d.title=a.jCb;d.message=a.yxa;return d}b.d(E,"a",function(){return a});u=b(0);b=b(919);var c=b.a;Rk(a,c);a.prototype.lo=function(d){c.prototype.lo.call(this,d);a.Axa&&a.Axa(null)};a.initialize=function(d,e,k,l){a.jCb=d;a.yxa=e;a.X7a=k;a.Axa=l};Mf.Object.defineProperties(a.prototype,{actionButton:{configurable:!0,enumerable:!0,get:function(){return a.X7a}}});a.jCb=null;a.yxa=null;a.X7a=null;a.Axa=null;Object(u.a)(a,"SensitivityLabelMinorVersionLimitReachedBusinessBarEntry",
b.a,[])},1264:function(u,E,b){function a(d,e){d=c.call(this,d,e)||this;a.X7a&&a.Axa&&(d.Ou=!0);d.title=a.jCb;d.message=a.yxa;return d}b.d(E,"a",function(){return a});u=b(0);b=b(919);var c=b.a;Rk(a,c);a.prototype.lo=function(d){c.prototype.lo.call(this,d);a.Axa&&a.Axa(null)};a.initialize=function(d,e,k,l){a.jCb=d;a.yxa=e;a.X7a=k;a.Axa=l};Mf.Object.defineProperties(a.prototype,{actionButton:{configurable:!0,enumerable:!0,get:function(){return a.X7a}}});a.jCb=null;a.yxa=null;a.X7a=null;a.Axa=null;Object(u.a)(a,
"SensitivityApplicationSetLabelErrorBusinessBarEntry",b.a,[])},1265:function(u,E,b){b.d(E,"a",function(){return a});var a;"undefined"==typeof a&&(a={});window.MSOJS=a;a.Vfb=function(){function c(){return f()&&(z()||3<=(w()?x("version/"):0))}function d(){return 0<=window.navigator.userAgent.indexOf("Windows")}function e(){return 0<=window.navigator.userAgent.indexOf("Windows Phone")}function k(){Wa||(Wa=!0,qb=l("Windows Phone"))}function l(ya){ya=(new RegExp(ya+"\\s+(\\d+(\\.\\d*)?)")).exec(window.navigator.userAgent);
var ma=-1;return null!=ya&&2<=ya.length&&(ma=parseFloat(ya[1]),isNaN(ma)&&(ma=-1)),ma}function n(){return"function"==typeof navigator.msLaunchUri&&!e()&&!A()&&!v()}function f(){return 0<=window.navigator.userAgent.indexOf("Macintosh")}function v(){return 0<=window.navigator.userAgent.indexOf("Edge/")}function r(){return 0<=window.navigator.userAgent.indexOf(" MSIE ")||0<=window.navigator.userAgent.indexOf("Trident/")}function y(){return r()?8==window.document.documentMode:!1}function m(){return 0<=
window.navigator.userAgent.indexOf(" Firefox/")}function w(){return 0<=window.navigator.userAgent.indexOf(" AppleWebKit/")}function B(){return 0<=window.navigator.userAgent.toLowerCase().indexOf("chrome")}function A(){var ya=window.navigator.userAgent.toLowerCase();return 0<=ya.indexOf("android")&&0<=ya.indexOf("chrome")}function z(){return 3<=(m()?x("firefox/"):0)}function x(ya){var ma=window.navigator.userAgent.toLowerCase(),ha=ma.indexOf(ya),Z,Na;return 0<=ha?(Z=ha+ya.length,Na=ma.length,parseInt(ma.substring(Z,
Na))):0}function D(ya,ma,ha,Z,Na){if(Z&&null!=ma)ma();else if(n())navigator.msLaunchUri(ya,ma,ha);else if(!(B()||0<=window.navigator.userAgent.indexOf("iPhone")||0<=window.navigator.userAgent.indexOf("iPad")||0<navigator.maxTouchPoints&&f())||v())F(ya,ma,ha);else if(B()&&Na)a:{try{window.open(ya,"_self")}catch(eb){null!=ha&&ha();break a}null!=ma&&ma()}else I(ya,ma,ha)}function I(ya,ma,ha){var Z=document.getElementById("OICLinkTag"),Na;null==Z&&(Z=document.createElement("a"),Z.id="OICLinkTag",Z.style.visibility=
"hidden",Z.href="",Z.target=0==(Yb.Options&ec.SupportsTopTargetNavigation)||Yb.NoBrowserModalDialogs?"_blank":"_top",document.body.appendChild(Z),null!=Z.addEventListener&&Z.addEventListener("click",function(eb){null!=eb.stopPropagation&&eb.stopPropagation()},!1));try{"undefined"==typeof MouseEvent&&(Na=function(eb){var cb=document.createEvent("MouseEvent");return cb.initMouseEvent(eb,!1,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),cb},Na.prototype=Event.prototype,window.MouseEvent=Na),Z.href=ya,Z.dispatchEvent(new MouseEvent("click"))}catch(eb){null!=
ha&&ha();return}null!=ma&&ma()}function F(ya,ma,ha){var Z=document.getElementById("OICFrame");null==Z&&(Z=document.createElement("iframe"),Z.className="ObjectInDialog",Z.style.visibility="hidden",Z.src="about:blank",document.body.appendChild(Z),Z.id="OICFrame");try{Z.contentWindow.location.href=ya}catch(Na){null!=ha&&ha();return}null!=ma&&ma()}function G(ya){return 0!=(ya.Options&ec.SkipProtocolHandler)||y()}function T(ya){return ya===yb.ReadOnly||ya===yb.ReadWrite}function O(ya,ma,ha,Z){var Na,eb;
try{if(Na=new ActiveXObject(Xa),Na)return eb=Na.ViewDocument3(window.self,ya,ma,Z),eb?(wa(Cb.O14ActiveX),Ob.None):Ob.Failed}catch(cb){}if(ec.O14Only===(ha&ec.O14Only))return Yb.DescriptiveUnattemptedEnums?Ob.O14AttemptFailure:Ob.Unattempted;try{if(Na=new ActiveXObject(aa),Na)return eb=Na.ViewDocument3(window.self,ya,ma,Z),eb?(wa(Cb.O12ActiveX),Ob.None):Ob.Failed}catch(cb){}if(ec.O12UpOnly===(ha&ec.O12UpOnly))return Yb.DescriptiveUnattemptedEnums?Ob.O12UpOnlyFail:Ob.Unattempted;try{if(Na=new ActiveXObject(ba),
Na)return eb=T(ma)?Na.ViewDocument2(window.self,ya,Z):Na.EditDocument2(window.self,ya,Z),eb?(wa(Cb.O11ActiveX),Ob.None):Ob.Failed}catch(cb){}return Yb.DescriptiveUnattemptedEnums?Ob.ActiveXUnattempted:Ob.Unattempted}function U(ya,ma,ha,Z,Na){var eb,cb,Ua;ya==ab.Visio&&ha==yb.ReadWrite&&(ha=yb.WriteOnly);ya=Na;(Z=Z||e()&&!(k(),8<=qb))||(eb="",eb+=T(ha)?na+ia:ta,eb+=za,ya+=H(eb));ya+=H(ma);Yb.NewTelemetryDataIsEnabled&&(cb=-1!==ya.indexOf("?")?"&":"?",cb+=Yb.SessionOrigin?"OR="+Yb.SessionOrigin+"&":
"",cb+=Yb.ClickTime?"CT="+Yb.ClickTime+"&":"",cb+=Yb.CorrelationId?"CID="+Yb.CorrelationId:"",cb="?"!=cb?cb:"",cb="&"!=cb.slice(-1)?cb:cb.slice(0,-1),ya+=H(cb),Yb.CorrelationIdForWinClient&&(ya+=H(Yb.CorrelationIdForWinClient)));ma=window.location.href;ha=V;Z=ma.toLowerCase().indexOf("&"+ha+"=");var pa;ha=-1==Z?void 0:(Ua=Z+(ha.length+2),pa=ma.indexOf("&",Ua),-1==pa)?ma.substr(Ua):ma.substring(Ua,pa);if(null!=ha&&"undefined"!=typeof ha){Ua="";try{Ua=decodeURIComponent(ha)}catch(Qa){}0<Ua.length&&
RegExp("(c|t)[\\w]{8}-[\\w]{4}-[\\w]{4}-[\\w]{4}-[\\w]{12}").test(Ua)&&(ya+=sa,ya+=Ua)}return ya}function J(ya,ma,ha,Z,Na,eb){var cb=fa(ya),Ua;return null==cb?(X(Yb.DescriptiveUnattemptedEnums?Ob.ProtocolHandlerIsNull:Ob.Unattempted,Yb.Application),!1):(Ua=U(ya,ma,ha,Z,cb),D(Ua,K,N,Na,eb),!0)}function H(ya){if(f()&&B()){var ma="";try{ma=decodeURI(ya)}catch(ha){}if(ma==ya)return encodeURI(ya)}return ya}function K(){wa(Cb.ProtocolHandler)}function N(){Yb.Options|=ec.SkipProtocolHandler;ea(Yb,ib,La)}
function M(){null!=zb&&zb(Cb.RoamingProtocolHandler)}function C(){null!=Fb&&Fb(Ob.ControlNeeded)}function Q(){var ya=document.getElementById(xa),ma;if(null==ya){if(ma=oa,f()&&3<=(w()?x("version/"):0)&&P(ra,!0)&&(ma=ra),!P(ma,!0))if(f()&&P(Ga,!0))ma=Ga;else return null;ya=document.createElement("object");ya.id=xa;ya.type=ma;ya.style.width="0px";ya.style.height="0px";ya.style.setProperty("visibility","hidden","");document.body.appendChild(ya);ya=document.getElementById(xa)}return ya}function P(ya,ma){var ha=
window.navigator.mimeTypes,Z;return null==ha?!1:(Z=ha[ya],Z)?ma&&!Z.enabledPlugin?!1:!0:!1}function ka(ya){try{if(null!=new ActiveXObject(ya))return!0}catch(ma){}return!1}function R(ya){switch(ya){case ab.OneNote:return qa;default:return""}}function fa(ya){if(ya!=ab.OneNote&&e()&&!(k(),8<=qb))return"office:";switch(ya){case ab.Excel:return"ms-excel:";case ab.OneNote:return"onenote:";case ab.PowerPoint:return"ms-powerpoint:";case ab.Visio:return"ms-visio:";case ab.Word:return"ms-word:";case ab.Project:return"ms-project:";
case ab.Publisher:return"ms-publisher:";case ab.Infopath:return"ms-infopath:";case ab.Access:return"ms-access:";default:return""}}function ca(ya){switch(ya){case ab.Excel:return"root\\office15\\excel.exe";case ab.PowerPoint:return"root\\office15\\powerpnt.exe";case ab.Visio:return"root\\office15\\visio.exe";case ab.Word:return"root\\office15\\winword.exe";case ab.Project:return"root\\office15\\winproj.exe";case ab.Publisher:return"root\\office15\\mspub.exe";case ab.Infopath:return"root\\office15\\infopath.exe";
case ab.Access:return"root\\office15\\msaccess.exe";default:return null}}function ea(ya,ma,ha){if(Yb=ya,ib=ma,La=ha,ya.DocumentUrl){var Z=ha=ma=ya.DocumentUrl;try{Z=decodeURIComponent(ya.DocumentUrl)}catch(Qa){}try{ha=encodeURI(ya.DocumentUrl)}catch(Qa){}Yb.NewTelemetryDataIsEnabled||(ma=ma+""+ya.CorrelationIdForWinClient,Z+=ya.CorrelationIdForWinClient,ha+=ya.CorrelationIdForWinClient);ya.Mode===yb.ReadWrite&&ec.CheckoutRequired===(ya.Options&ec.CheckoutRequired)&&(ya.Mode=yb.ForceCheckout);ec.HostIsEditOnly===
(ya.Options&ec.HostIsEditOnly)&&(ya.Mode=yb.WriteOnly);if(G(ya)?0:f()&&(ya.Application==ab.OneNote||P(db,!1)||P(Ka,!1))||n()||A()||!(c()||z()||"ActiveXObject"in window&&!e()||B())||15<=ja())J(ya.Application,ya.EncodeUrl?ha:ma,ya.Mode,ya.Application==ab.OneNote,ya.SilentExternalHandler,ya.NavigateUsingWindowOpen);else{var Na;if(Na=y())a:{var eb=ya.EncodeUrl?ma:Z,cb=ya.Mode,Ua=R(ya.Application);try{Na=(new ActiveXObject(ua)).ViewDocument3(window.self,eb,cb,Ua);break a}catch(Qa){}Na=!1}if(Na)wa(Cb.O15ActiveX);
else{if(c()||z()){var pa=ya.EncodeUrl?ma:Z;Z=ya.Mode;Na=R(ya.Application);eb=Q();if(null==eb)pa=Yb.DescriptiveUnattemptedEnums?Ob.PluginIsNull:Ob.Unattempted;else{cb=!1;try{cb=eb.ViewDocument3(window.self,pa,Z,Na)}catch(Qa){}if(!cb)try{cb=T(Z)?eb.ViewDocument2(window.self,pa,Na):eb.EditDocument2(window.self,pa,Na)}catch(Qa){}pa=cb?(wa(Cb.NpapiPlugin),Ob.None):Ob.Failed}}else{try{pa=new ActiveXObject(da),null!=pa&&pa.SaveSSOCreds()}catch(Qa){}pa=O(ya.EncodeUrl?ma:Z,ya.Mode,ya.Options,R(ya.Application))}if(pa!=
Ob.None){if(Z=ya.CouldUseRoamingApps)kb||(kb=!0,vb=l("Windows NT")),Z=6.1<=vb&&!(0<=window.navigator.userAgent.indexOf("ARM;"))&&(r()||z()||B());if(Z&&ya.Application!=ab.OneNote){if(!a.Vfb.TXj()){X(Ob.ControlNeeded,Yb.Application);return}if(ya.RoamingAppsLauncher){"undefined"==typeof ya.RoamingAppsLauncher||null==ya.RoamingAppsLauncher?X(Yb.DescriptiveUnattemptedEnums?Ob.RoamingLauncherIsNull:Ob.Unattempted,Yb.Application):"undefined"==typeof ya.RoamingBitsUrl||null==ya.RoamingBitsUrl?a.Vfb.kYj(ya.DocumentUrl,
ya.RoamingAppsLauncher,ya.Application,ya.ApplicationParameters,ib,La):a.Vfb.gig(ya.DocumentUrl,ya.RoamingAppsLauncher,ya.RoamingApplicationExe,ya.ApplicationParameters,ya.RoamingPlatform,ya.RoamingBitsUrl,ib,La);return}if(!ya.ContinueIfLauncherIsNull){X(Ob.LauncherNeeded,Yb.Application);return}}ec.NoProtocolHandlerFallback==(ya.Options&ec.NoProtocolHandlerFallback)||G(ya)||r()||f()&&!(Yb.DescriptiveUnattemptedEnums?pa>=Ob.O14Unattempted&&pa<=Ob.DocumentUrlIsNull:pa==Ob.Unattempted)?X(pa,Yb.Application):
J(ya.Application,ya.EncodeUrl?ha:ma,ya.Mode,ya.Application==ab.OneNote,ya.SilentExternalHandler,ya.NavigateUsingWindowOpen)}}}}else X(Yb.DescriptiveUnattemptedEnums?Ob.DocumentUrlIsNull:Ob.Unattempted,Yb.Application)}function wa(ya){null!=ib&&ib(ya)}function X(ya,ma){"undefined"==typeof ma&&(ma=null);null!=La&&La(ya,ma)}function ja(){var ya=0;if(c()||z()||B()){var ma=Q();try{null!=ma&&(ya=ma.GetOfficeVersion())}catch(ha){}}else ka(ua)?ya=15:ka(Xa)?ya=14:ka(aa)?ya=12:ka(ba)&&(ya=11);return ya}function va(){return f()&&
(P(oa,!0)||P(ra,!0))}var ua="SharePoint.OpenDocuments.5",Xa="SharePoint.OpenDocuments.4",aa="SharePoint.OpenDocuments.3",ba="SharePoint.OpenDocuments.2",oa="application/x-sharepoint",ra="application/x-sharepoint-webkit",db="application/x-sharepoint-protocolhandler",Ka="application/x-sharepoint-webkit-protocolhandler",Ga="application/officelive",xa="npSharePointPlugin",da="IDBHO.IDBHOCtrl",qa="OneNote.Notebook",na="ofv|",ia="ofc|",ta="ofe|",za="u|",sa="|f|",V="wdlor",Ia="",Ha="",ob="",ib,La,zb,Fb,
Yb,kb,vb,Wa,qb,yb={ReadWrite:0,ReadOnly:1,WriteOnly:2,ForceCheckout:3,WriteLocalCopy:4,OpenInBrowser:5},ec={None:0,CheckoutRequired:1,O14Only:2,HostIsEditOnly:4,O12UpOnly:8,SkipProtocolHandler:16,NoProtocolHandlerFallback:32,SupportsTopTargetNavigation:64},Ob={None:0,Failed:1,Unattempted:2,LauncherNeeded:3,ControlNeeded:4,PopupBlocked:5,O14Unattempted:6,O12UpOnlyUnattempted:7,PluginIsNull:8,ActiveXUnattempted:9,ProtocolHandlerIsNull:10,ProtocolHandlerNoCallbackIsNull:11,RoamingLauncherIsNull:12,DocumentUrlIsNull:13},
Cb={Unknown:0,NpapiPlugin:1,O10ActiveX:2,O11ActiveX:3,O12ActiveX:4,O14ActiveX:5,ProtocolHandler:6,RoamingActiveX:7,RoamingFFExtension:8,RoamingProtocolHandler:9,O15ActiveX:10},ab={Unknown:0,Excel:1,OneNote:2,PowerPoint:3,Visio:4,Word:5,Project:6,Publisher:7,Infopath:8,Access:9};return{OpenDocumentMode:yb,OpenDocumentOptions:ec,OpenDocumentFailureType:Ob,OpenDocumentControl:Cb,OfficeApplication:ab,EditDocumentInClient:ea,EditDocumentInClientParams:function(){this.DocumentUrl="";this.Options=this.Mode=
0;this.Application=ab.Unknown;this.CouldUseRoamingApps=!1;this.RoamingAppsLauncher="";this.ContinueIfLauncherIsNull=!1;this.RoamingBitsUrl=this.RoamingApplicationExe=this.RoamingPlatform=this.ApplicationParameters="";this.EncodeUrl=this.SilentExternalHandler=!1;this.CorrelationIdForWinClient="";this.NewTelemetryDataIsEnabled=this.NoBrowserModalDialogs=this.DescriptiveUnattemptedEnums=this.NavigateUsingWindowOpen=!1;this.SessionOrigin=this.ClickTime=this.CorrelationId=""},OfficeVersionInstalled:ja,
IsO14MacPluginInstalled:va,OfferOfficeInDialog:function(){return d()&&11>=ja()},OfferOfficeNoIntrusive:function(){return d()&&15>ja()},OfferMacOffice:function(){return f()&&!(0<=window.navigator.userAgent.indexOf("PPC Mac"))&&!va()},InstallRoamingControl:function(){m()?window.InstallTrigger.install({Office:{URL:Ha}}):F(ob,null,null)},CanUseRoamingControl:function(){var ya,ma,ha;if(n())return!0;if(B())return"undefined"!=typeof navigator.plugins.refresh&&navigator.plugins.refresh(!1),!!navigator.mimeTypes["application/x-vnd.officeondemand"];
if(m())return ya=document.createElement("RoamingExtensionElement"),document.documentElement.appendChild(ya),ma=document.createEvent("Events"),ma.initEvent("RoamingOfficeInstalled",!0,!1),ya.dispatchEvent(ma),!!ya.getAttribute("installed");if(r())try{return ha=new ActiveXObject("RoamingOfficeActiveX.RoamingOffice"),ha.HrExists()}catch(Z){}return!1},InitUrls:function(ya,ma,ha){Ia=ya;Ha=ha;ob=ma},LaunchRoamingApps:function(ya,ma,ha,Z,Na,eb){a.Vfb.gig(ya,ma,ca(ha),Z,"x86",Ia,Na,eb)},LaunchRoamingApps2:function(ya,
ma,ha,Z,Na,eb,cb,Ua){var pa="",Qa;if(null!=Z&&(pa+=" "+Z),null!=ya&&(pa+=' "'+ya+'"'),n()||B())zb=cb,Fb=Ua,cb='office: "'+(eb+'" "')+(ha+'" "ROAMING"'),cb+=' "'+ma+'"',cb+=' "'+Na+'"',cb+=" "+pa,D(cb,M,C,!1,!1);else if(m())ya=document.createElement("RoamingExtensionElement"),ya.setAttribute("cabUrl",eb),ya.setAttribute("app",ha),ya.setAttribute("licensingEntitlements",ma),ya.setAttribute("platform",Na),ya.setAttribute("args",pa),document.documentElement.appendChild(ya),ma=document.createEvent("Events"),
ma.initEvent("RoamingOfficeLaunch",!0,!1),ya.dispatchEvent(ma),null!=cb&&cb(Cb.RoamingFFExtension);else if(r()){if(Qa=new ActiveXObject("RoamingOfficeActiveX.RoamingOffice"),null!=Qa)try{Qa.HrConfigureSingle(eb,ha,ma,Na,pa),null!=cb&&cb(Cb.RoamingActiveX)}catch(Db){}}else null!=Ua&&Ua(Ob.Failed)},ShouldShowDialog:function(){return!e()},NavigateToUrlUsingClickingOnATag:I,OpenDocumentWithProtocolHandler:J,OpenDocumentWithProtocolHandlerNoCallBack:function(ya,ma,ha,Z){var Na=fa(ya),eb;return null==Na?
(X(Yb.DescriptiveUnattemptedEnums?Ob.ProtocolHandlerNoCallbackIsNull:Ob.Unattempted,Yb.Application),!1):(eb=U(ya,ma,ha,Z,Na),D(eb,null,null,!1,!1),!0)}}}();a.ClientUtils=a.Vfb},1266:function(u,E,b){function a(d,e){this._url=d;this.Psg=e}b.d(E,"a",function(){return a});u=b(0);var c=b(39);a.prototype.xre=function(){};a.prototype.V5c=function(){this.Psg?c.a.downloadFile(this._url):c.a.Ze(this._url,"_blank",void 0,"OpenUrlInTabDialogDownloadBehavior:DoDownload")};a.prototype.dispose=function(){};Object(u.a)(a,
"OpenUrlInTabDialogDownloadBehavior",null,[353,3])},1267:function(u,E,b){function a(){c.a.ti('.HyperlinkDialog .ewa-dlg-body-sectionlabel{margin-bottom:5px}.HyperlinkDialog .disabledInput{background-color:#ebebe4;border:solid 1px #b5b5b5}.HyperlinkDialog .ewa-dlg-body-fullLine{width:inherit;min-width:318px;padding-right:5px;padding-left:25px}.ewa-dlg-elements-container-rtl .HyperlinkDialog .ewa-dlg-body-fullLine{padding-right:25px;padding-left:5px}.HyperlinkDialog input[type="text"]{width:100%;outline:none;padding-left:3px;border:solid 1px #ccc}.HyperlinkDialog .ewa-dlg-body-sectionbreak{height:50px;position:relative}.HyperlinkDialog input[type="radio"]{position:absolute;left:0}.ewa-dlg-elements-container-rtl .HyperlinkDialog input[type="radio"]{left:auto;right:0}.HyperlinkDialog .ewa-dlg-body-sectionlabel label{margin-left:24px}.ewa-dlg-elements-container-rtl .HyperlinkDialog .ewa-dlg-body-sectionlabel label{margin-right:24px;margin-left:auto}.ValidationLabel{position:relative;display:block}.ValidationLabelWarning{color:#cc4200}.ValidationLabelError{color:#d90000}.ValidationWarningGlowColor,.ValidationErrorGlowColor,.ValidationLableGlow{border-style:solid;border-width:1px;transition:all .2s ease-in-out}.HyperlinkDialog div .ValidationErrorGlowColor{box-shadow:0 0 2px #d90000;border-color:#d90000}.HyperlinkDialog div .ValidationWarningGlowColor{box-shadow:0 0 2px #cc4200;border-color:#cc4200}')}
b.d(E,"a",function(){return a});var c=b(559)},1268:function(u,E,b){function a(l,n,f,v,r,y){this.KX=l;this.LX=n;this.iJc=f;this.vD=v;this.NRb=r;this.uUa=y}b.d(E,"a",function(){return a});u=b(0);var c=b(1396),d=b(4),e=b(52),k=b(83);a.prototype.A4i=function(l){this.osf(l)};a.prototype.qri=function(l){this.osf(l)};a.prototype.osf=function(l){var n=10;1===l?(k.a.instance.resolve("Common.IOfficeTrialExperience").fjc(this.uUa),n=3):2===l&&((!this.iJc||this.iJc(this.vD))&&this.LX&&c.a.instance.I7g(this.LX,
this.KX,this.vD),n=5);(0===l||1===l)&&this.KX&&this.KX(this.vD);d.AFrameworkApplication.Osc(e.a.RDf,this.NRb,n);this.dispose()};a.prototype.dispose=function(){this.vD=this.LX=this.KX=null};Mf.Object.defineProperties(a.prototype,{y2f:{configurable:!0,enumerable:!0,get:function(){return!this.LX&&!this.iJc}},Trf:{configurable:!0,enumerable:!0,get:function(){return 2===this.uUa?CommonUIStrings.l_OICErrorC2ROneNoteOffer:CommonUIStrings.l_OICErrorC2ROffer}},id:{configurable:!0,enumerable:!0,get:function(){return"OICErrorDialogWithTrial"}},
eLe:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorMessageNoOffice}},V7e:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorIHaveOfficeButton}},Gva:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorHelpLink}},B6e:{configurable:!0,enumerable:!0,get:function(){return"OICFailure"}},icon:{configurable:!0,enumerable:!0,get:function(){return 3}},OXb:{configurable:!0,enumerable:!0,get:function(){return 2===this.uUa?
CommonUIStrings.l_OICErrorC2RInstallOneNoteButton:CommonUIStrings.l_OICErrorC2RInstallButton}},zl:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_DefaultDialogTitle}}});Object(u.a)(a,"AOICErrorDialogWithTrial",null,[3])},1269:function(u,E,b){function a(){this.BaseDocQuerySignature=null;this.RoamingApp=0}b.d(E,"a",function(){return a});u=b(0);var c=b(1560),d=b(4),e=b(41),k=b(81);a.prototype.QMd=function(){return e.c([this.Eaa(),this])};a.prototype.execute=function(l,n,f){var v=
"RoamingAppsHandler.ashx";c.a.instance.roamingAppsAreEnabled&&0<document.URL.toUpperCase().indexOf("WDENABLEROAMING=1")&&(v=k.a.wl(v,"wdEnableRoaming","1"));d.AFrameworkApplication.qd.Yl(v,2,this.QMd(),{"Content-Type":"application/json; charset=utf-8"},!1,this.Kvb(),l,n,f,void 0,void 0,void 0,void 0,"6")};Object(u.a)(a,"ARoamingAppsRequest",null,[])},1270:function(u,E,b){function a(){c.a.ti(".ewa-presentMode-overlay{pointer-events:none}.ewa-presentMode-panel-container{z-index:1054;position:absolute;bottom:32px;visibility:hidden}.ewr-presentMode-on .ewa-presentMode-panel-container{visibility:visible}.ewa-presentMode-rowHdrParent-container{position:relative;z-index:1055}.ewa-presentMode-right-frame{position:absolute;bottom:32px;top:0;right:0;width:0;opacity:0;background-color:#f5f5f5}.ewr-presentMode-on .ewa-presentMode-right-frame{width:32px;opacity:1;background-color:#323130}.ewr-presentMode-on-rtl .ewa-presentMode-right-frame{width:0;opacity:0}.ewr-presentMode-on-headers-off .ewa-presentMode-right-frame{width:12px !important;opacity:1}.ewr-namedsheetview .ewa-presentMode-right-frame{background-color:#000 !important}.ewr-presentMode-transition .ewa-presentMode-right-frame{transition:background-color .4s linear}.ewr-presentMode-on #dialogHost{z-index:1056 !important}")}
b.d(E,"a",function(){return a});var c=b(559)},1271:function(u,E,b){function a(){c.a.ti('.PrintDialogBody{height:260px;width:516px;margin-top:17px}.PrintDialogTitle{font-size:21px;margin-top:14px;margin-left:18px;font-family:"Segoe UI Light"}.ewa-dlg-elements-container-rtl .PrintDialogTitle{margin-left:auto;margin-right:18px}.PrintDialogLeftContainer{float:left;width:240px;height:100%;font-size:14px;margin-left:18px}.ewa-dlg-elements-container-rtl .PrintDialogLeftContainer{float:right;margin-left:auto;margin-right:18px}.PrintDialogRightContainer{float:left;font-size:14px;width:240px;height:inherit;margin-left:18px}.ewa-dlg-elements-container-rtl .PrintDialogRightContainer{float:right;margin-left:auto;margin-right:18px}.PrintDialogRadioButtonContainer{width:224px;height:32px;display:flex;align-items:center}.PrintRadioButtonElementInnerDiv{vertical-align:middle;display:table-cell}.PrintRadioButtonElementOuterDiv{position:absolute;top:0;left:64px;height:32px;width:140px;vertical-align:middle;display:table}.ewa-dlg-elements-container-rtl .PrintRadioButtonElementOuterDiv{left:auto;right:64px}.PrintDialogTitleSection{width:224px;height:19px}.PrintDialogComboBoxContainer{width:224px;height:32px;margin-top:12px}.PrintRadioButtonIcon{margin:0 16px;vertical-align:middle}.PrintButtonArea{margin-right:32px}.ewa-dlg-elements-container-rtl .PrintButtonArea{margin-right:auto;margin-left:32px}.PrintPreviewerContainer{height:100%;width:100%;z-index:998;position:absolute;background:#edebe9}.ewa-hide-print-elements-siblings{display:none}')}
b.d(E,"a",function(){return a});var c=b(559)},1272:function(u,E,b){function a(){c.a.ti(".ewa-resizehdr-row-hidden{width:inherit;height:0}.ewa-resizehdr-col-hidden{width:0;height:inherit}")}b.d(E,"a",function(){return a});var c=b(559)},1278:function(u,E,b){function a(d){this.isEnabled=Boolean.parse(d.DirectPrintIsEnabled||"false");Boolean.parse(d.DirectPrintProbeIsEnabled||"false");this.qii=Boolean.parse(d.DirectPrintEnabledForInternetExplorer||"false");this.uSa=(d.DirectPrintSupportedMimeTypes||"").split(a.A5c);
this.vSa=(d.DirectPrintSupportedPlugins||"").split(a.A5c);this.H7h=(d.DirectPrintImmersivePreviewPlugins||"").split(a.A5c);this.Ebf=Boolean.parse(d.DirectPrintEnabledForEdge||"false");this.$ei=Boolean.parse(d.ChromePrintLayoutFixIsEnabled||"false");this.WWg=parseInt(d.ChromeVersionFromWhichPrintLayoutIsEnabled||"76");this.Evd=14;this.fpf=14394;if(d=d.DirectPrintMinimalSupportedEdgeVersion){var e=d.split(".");2===e.length?(this.Evd=parseInt(e[0]),this.fpf=parseInt(e[1])):c.ULS.sendTraceTag(20734112,
208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is invalid: {0}",d)}else c.ULS.sendTraceTag(20734113,208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is not set in BRS")}b.d(E,"a",function(){return a});u=b(0);var c=b(14);a.A5c=",";Object(u.a)(a,"DirectPrintBrsSettings",null,[])},1279:function(u,E,b){function a(){this.printOperationCallbacks=this.universalPrintAppSettings=this.setAdditionalHeaderText=this.disableBackToSheetButton=this.disableTellMeControl=
this.logger=this.printPreviewPaneCallbacks=this.backActionButtonText=null}b.d(E,"a",function(){return a});u=b(0);Object(u.a)(a,"PrintPreviewPaneProps",null,[])},1280:function(u,E,b){function a(){}b.d(E,"a",function(){return a});u=b(0);a.V_i="PrintDialogBody";a.printDialogTitle="PrintDialogTitle";a.a8b="ewa-dlg-elements-container-rtl";a.W_i="PrintDialogLeftContainer";a.X_i="PrintDialogRightContainer";a.P$a="PrintDialogRadioButtonContainer";a.VHf="PrintRadioButtonElementInnerDiv";a.c0i="PrintRadioButtonElementOuterDiv";
a.Q$a="PrintDialogTitleSection";a.hEd="PrintDialogComboBoxContainer";a.d0i="PrintRadioButtonIcon";a.U_i="PrintButtonArea";a.ww="PrintPreviewerContainer";Object(u.a)(a,"CssClassNames",null,[])},1341:function(u,E,b){function a(){R.a.Fa(c.ka)}function c(Pb){return uc.call(this,Pb)||this}function d(Pb,sc,nb){var pc=this;this.ignorePrintArea=!1;this.jLj=function(){var Dc=ra.g(pc.$).Ea;pc.iQc=!0;Dc.wxd()};this.TOi=function(){pc.nhd()};this.SOi=function(Dc,oc,Gc){ca.ULS.sendTraceTag(537154272,0,10,"PrintCommandHandler:OnPageLayoutCommandFailure Method : {0} failed to execute",
Gc);pc.nhd()};this.$=Pb;this.ea=Pb.ea;this.aia=sc;this.BN=new H(1,this.ignorePrintArea);this.dD=sc=new e(Pb,sc,ea.AFrameworkApplication.qd,nb);this.$.da.Ga(418,sc);this.NHf=new x(Pb);this.$.da.Ga(384,this);this.iQc=!1}function e(Pb,sc,nb,pc){var Dc=this;this.activeCell=this.selectedRange=this.kg=this.graphServiceEndpoint=null;this.O_=0;this.Em=this.Zu=null;this.pH=new z;this.pk=new z;this.Pba=0;this.q7a=null;this.BMb=!1;this.N2a=this.yFb=null;this.Nod=!1;this.p6a=this.Azb=!0;this.ema=this.Gya=this.RMa=
null;this.zyb=!1;this.n7a=null;this.I5a=this.CKc=!1;this.lzd=function(oc){if(!(oc&&oc.data&&oc.data.Td&&oc.data.responseHeaders&&oc.data.Td.length)){var Gc=oc?oc.data?oc.data.Td?oc.data.responseHeaders?oc.data.Td.length?null:"requestSucceededEventArgs.Data.ResponseData.Length":"requestSucceededEventArgs.Data.ResponseHeaders":"requestSucceededEventArgs.Data.ResponseData":"requestSucceededEventArgs.Data":"requestSucceededEventArgs";Dc.kg&&(oc=Dc.zQa(oa.a.instance.ga(1192)),Dc.CAa(oc,0));ca.ULS.sendTraceTag(593266765,
0,10,"PrintPreviewManager:OnFileHandlerSuccessCallback - Invalid Parameter : {0}",Gc);Dc.wJd&&(oc=Object(ha.a)(new Ab.a,{extendedProperties:new Map}),oc.extendedProperties.set("InvalidParameterName",Gc),Na.Health.instance.recordQosError(Qa.a.PHf,[Db.a.QHf],!1,!0,!0,!1,oc))}else if(0<Dc.Pba&&oc.data.id===Dc.Pba){if(oc.data.responseHeaders["Content-Type"]&&(Cb.a.contains(oc.data.responseHeaders["Content-Type"].toString(),"application/pdf",!0)||Cb.a.contains(oc.data.responseHeaders["Content-Type"].toString(),
"text/plain",!0))){ca.ULS.sendTraceTag(593266764,0,50,"PrintPreviewManager:OnFileHandlerSuccessCallback - pdf converted successfully");var ld=null;Cb.a.contains(oc.data.responseHeaders["Content-Type"].toString(),"text/plain",!0)&&(ld=Dc.v4g(oc));Gc={};Dc.aEb(Gc,null,null,ld);oc.data.responseHeaders["Total-Pdf-PageCount"]?(ld=parseInt(oc.data.responseHeaders["Total-Pdf-PageCount"].toString(),10),Dc.zyb||(Dc.kEd>=ld?Dc.ema=ld:Dc.zyb=!0),Dc.p6a&&Dc.kg&&Dc.kg.setPageRangeSettings(ld,Dc.kEd,Dc.zyb,Dc.Gya,
Dc.ema)):ca.ULS.sendTraceTag(537154257,0,15,"PrintPreviewManager:OnFileHandlerSuccessCallback - did not receive the TotalPdfPageCount header.")}else Gc=kb.a.Th(oc.data.Td),Ob.a.T9(Gc.Errors)||fb.a(Dc.$).fd.eJ(Gc.Errors[0].MessageId),Dc.a6i(Gc.Errors),Dc.kg&&(ld=Dc.zQa(Gc.Errors[0].Description),-1831476778===Gc.Errors[0].MessageId?(ca.ULS.sendTraceTag(537154256,0,15,"PrintPreviewManager:OnFileHandlerSuccessCallback - showing pdf print timeout error message"),Dc.CAa(ld,0,oa.a.instance.ga(1195))):Dc.CAa(ld,
0)),297284985===Gc.Errors[0].MessageId?ca.ULS.sendTraceTag(570716892,0,50,"PrintPreviewManager:OnFileHandlerSuccessCallback - Nothing to print. Message Id: {0}",Gc.Errors[0].MessageId):ca.ULS.sendTraceTag(593266763,0,15,"PrintPreviewManager:OnFileHandlerSuccessCallback - Failed to convert workbook. Error message Id: {0}",Gc.Errors[0].MessageId);oc=oc.data.state;oc.v8c(Gc,oc.userContext,oc.methodName)}};this.kzd=function(oc){if(0<Dc.Pba&&oc.data.id===Dc.Pba){var Gc=za.a.Mf(oc.data);Dc.kg&&Dc.CAa(Dc.zQa(Gc[0].Description),
1);ca.ULS.sendTraceTag(593266762,0,15,"PrintPreviewManager:OnFileHandlerFailureCallback has failed - Errors: [{0}]",Ob.a.Ec(Gc));Gc=oc.data.state;Gc.maa(oc,Gc.userContext,Gc.methodName);Dc.$.userOperationManager.Lka.operation.pna(function(){return Dc.BMb})}};this.$Hi=function(oc,Gc,ld){oc.Errors&&0<oc.Errors.length&&Dc.kg?(Ob.a.T9(oc.Errors)||fb.a(Dc.$).fd.eJ(oc.Errors[0].MessageId),Dc.CAa(Dc.zQa(oc.Errors[0].Description),0),ca.ULS.sendTraceTag(537154254,0,50,"PrintPreviewManager: Failed to convert workbook. Error message Id: {0}",
oc.Errors[0].MessageId)):(ca.ULS.sendTraceTag(537154253,0,50,"PrintPreviewManager:OnConvertWorkbookToPdfSucceededInWebParts - Pdf conversion succeeded"),Dc.aEb(oc,Gc,ld,null))};this.ZHi=function(oc){oc=za.a.Mf(oc.data);Dc.kg&&Dc.CAa(Dc.zQa(oc[0].Description),1);ca.ULS.sendTraceTag(537154252,0,15,"PrintPreviewManager:OnConvertWorkbookToPdfFailed invoked - Errors: [{0}]",Ob.a.Ec(oc));Dc.$.userOperationManager.Lka.operation.pna(function(){return Dc.BMb})};this.azf=function(oc,Gc){if(Gc)switch(Gc.$_i){case 1:if(Dc.pk&&
Dc.N2a)switch(oc=Dc.N2a.qc,Dc.N2a.stop(),Dc.N2a=null,Dc.pk.tv){case 1:Dc.f_c(oc,4800,"ActiveSheet");break;case 0:Dc.f_c(oc,6100,"CurrentSelection");break;case 2:Dc.f_c(oc,7500,"EntireWorkbook")}break;case 0:Dc.yFb&&(oc=Dc.yFb.qc,Dc.yFb.stop(),2400<oc&&(Gc=Object(ha.a)(new Ab.a,{extendedProperties:new Map}),Gc.extendedProperties.set("PaneLoadTime",oc.toString()),Na.Health.instance.recordQosError(Qa.a.gCj,[Db.a.f4f],!1,!0,!0,!1,Gc)),Dc.Zu.Qci(function(ld){Dc.jAj(ld)}))}};this.vz=function(oc,Gc){(1===
Gc.Cq&&Dc.RMa===Gc.Ef||2===Gc.Cq)&&Dc.iKd()};this.$=Pb;this.aia=sc;this.S2=nb;this.xDb=pc;this.wJd=sa.HelperMethods.VZ;this.Pa=new jb.a;this.kEd=this.$.ya.PrintPreviewerPaginationRange;this.useMSPdfViewer=this.Vxj();this.H$h();this.lei=this.fWg();this.Mod=ua.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ExcelWebPrintFloodgateSurvey",!1);if(this.isUniversalPrintEnabled=!!pc&&pc.w5a()&&ua.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UniversalPrint",!1)&&this.$.Jf.get(116))this.graphServiceEndpoint=
this.$.ya.GraphServiceEndpoint}function k(){this.appName=this.disabledChangeGates=this.isUniversalPrintFlowEnabled=this.graphServiceEndpointVersion=this.graphServiceEndpoint=null}function l(){this.onBackToSheet=null}function n(){this.onNotifyPrintJobStatus=this.onClosePreviewer=this.getGraphServiceAuthorizationToken=this.onLocalPrint=null}function f(){this.selectedColor=this.selectedMargin=this.selectedScaling=this.selectedPaperSize=this.selectedOrientation=this.selectedWhatToPrint=0;this.selectedPrintGridlines=
this.selectedIgnorePrintArea=!1;this.selectedRowAndColumnHeadings=this.selectedVerticalCenter=this.selectedHorizontalCenter=this.selectedDraft=this.selectedPageEnd=this.selectedPageStart=null}function v(){this.onDropdownSettingsFocus=this.onPrint=this.onSettingChange=null}function r(Pb,sc,nb,pc,Dc,oc){var Gc=m.call(this,Dc)||this;Gc.Bd=!1;Gc.Y3f=!1;Gc.pAd=function(ld){Gc.dD.pAd(ld)};Gc.yAd=function(ld){Gc.dD.yAd(ld)};Gc.yQi=function(){ca.ULS.sendTraceTag(537154190,0,50,"PrintSettingsManager.OnSavePrintSettingsToFileSuccess: Saving print settings to file successful.")};
Gc.xQi=function(ld){ld=za.a.Mf(ld.data);ca.ULS.sendTraceTag(537154189,0,10,"PrintSettingsManager.OnSavePrintSettingsToFileFailure: Save print settings to file failed. Errors: {0}.",Ob.a.Ec(ld))};Gc.vz=function(ld,gd){2===gd.Cq?Gc.Yu.clear():1===gd.Cq&&Gc.Yu&&Gc.Yu.contains(gd.Ef)&&(ca.ULS.sendTraceTag(537154188,0,50,"PrintSettingsManager.OnQueueChanged: web method {0} returned, it took {1} milliseconds to complete.",Va.a(gd.Ef.operation.operationName),gd.Ef.dequeueUtcTime.getTime()-gd.Ef.enqueueUtcTime.getTime()),
Gc.Yu.remove(gd.Ef))};Gc.dD=Pb;Gc.BN=nb;Gc.$=sc;Gc.sheetName=pc;Gc.locale=window.navigator.browserLanguage||window.navigator.language||Gc.$.ya.UICultureTag;Gc.IVi=Gc.u2g();Gc.$.userOperationManager.zr(Gc.vz);Gc.Yu=new Rb.a;Gc.isUniversalPrintEnabled=oc;return Gc}function y(Pb,sc){this.sheetPrintOptions=this.sheetName=null;this.sheetName=Pb;this.sheetPrintOptions=sc}function m(Pb){this.aDi=[.75,.75,.7,.7,.3,.3];this.NBi=[.75,.75,.25,.25,.3,.3];this.EWj=[1,1,1,1,.5,.5];this.O$d=this.Gee=this.dce=this.Nbe=
this.nie=this.B6=this.narrow=this.wide=this.normal=null;this.sheetPrintOptions={};this.Gm=Pb;this.Y$h();this.eai()}function w(){this.printSettingOptionKey=0;this.printSettingOptionText=null}function B(){this.footer=this.header=this.bottom=this.top=this.right=this.left=0}function A(){this.marginValue=this.printSettingOption=null}function z(){this.margin=this.i0=this.yca=this.orientation=this.tv=0;this.ignorePrintArea=!1;this.sheetPrintOptions=null;this.o1a=!1;this.NoColor=null}function x(Pb){var sc=
this;this.ribbonCommandInfo=this.mFb=null;this.qLj=function(nb,pc,Dc){pc=!!nb&&!!nb.RequestTelemetryData;ra.g(sc.$).si&&ra.g(sc.$).si.dla(sc.sKa.na(sc.ribbonCommandInfo.command),nb.StateId,pc?nb.RequestTelemetryData.EcsOperationDuration:0,pc?nb.RequestTelemetryData.EcsRequestDuration:0,pc?nb.RequestTelemetryData.WfeRequestDuration:0);sa.HelperMethods.VZ&&sc.aWg(Dc)};this.$=Pb;this.sKa=new ub.a;this.uva=new ub.a;this.uva.add(78661008,12);this.uva.add(275604654,13);this.uva.add(-13332329,14);this.uva.add(-837651977,
9);this.uva.add(-1778266776,10);this.uva.add(845325699,11);this.Mod=ua.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ExcelWebPrintFloodgateSurvey",!1)}function D(){this.LastColumn=this.LastRow=this.FirstColumn=this.FirstRow=0}function I(){this.Max=this.Min=this.Index=0}function F(){this.Col=this.Row=null}function G(Pb){this.sheetName=null;this.sheetName=Pb}function T(Pb){this.sheetName=null;this.sheetName=Pb}function O(Pb){this.sharedSheetCell=null;this.sharedSheetCell=Pb}function U(Pb){this.sharedSheetCell=
null;this.sharedSheetCell=Pb}function J(Pb,sc){this.multiRange=null;this.addToPrintArea=!1;this.multiRange=Pb;this.addToPrintArea=sc}function H(Pb,sc){this.C6=0;this.W6d=!1;this.tv=Pb;this.ignorePrintArea=sc}function K(Pb,sc,nb,pc,Dc,oc,Gc,ld){var gd=ka.call(this,Pb,sc,nb,pc,Dc,ua.EwaSettings.ma(397))||this;gd.Mca=null;gd.eaa=null;gd.aec=null;gd.bSd=!1;gd.exa=null;gd.A$a=null;gd.Iya=null;gd.Sza=null;gd.a5a=null;gd.aza=1;gd.qma=1;gd.N_=0;gd.C6=1;gd.xGb=!1;gd.Wr=null;gd.uJb=0;gd.tJb=0;gd.Jya=null;gd.Tza=
null;gd.selectedRange=null;gd.O_=0;gd.$8a=function(){gd.O_++;gd.C6=gd.HYc();gd.Y6c(gd.eaa.checked?!0:!1);gd.v7&&(gd.aec.disabled=gd.Sv.checked);gd.vNd(gd.eaa.checked?!0:!1);ca.ULS.sendTraceTag(595194762,0,50,"PdfPrintDialog:OnChangeWhatToPrint What to print option changed to {0}",gd.C6.toString());return!0};gd.Itf=function(){gd.O_++;gd.xGb=gd.a5a.checked;ca.ULS.sendTraceTag(537154311,0,50,"PdfPrintDialog:OnChangeIgnorePrintArea Setting Ignore print area changed to {0}",gd.xGb.toString())};gd.lmc=
function(){gd.O_++;gd.aza=gd.Kue();ca.ULS.sendTraceTag(595079450,0,50,"PdfPrintDialog:OnChangeOrienation orientation option changed to {0}",gd.aza.toString());return!0};gd.Jtf=function(){gd.O_++;var Cc=gd.qma;gd.qma=K.paperSizeOptions[gd.Iya.selectedIndex];ca.ULS.sendTraceTag(595079449,0,50,"PdfPrintDialog:OnChangePaperSize paperSize option changed from {0} to {1}",Cc.toString(),gd.qma.toString());return!0};gd.Ktf=function(){gd.O_++;var Cc=gd.N_;gd.N_=K.scalingOptions[gd.Sza.selectedIndex];2===gd.N_?
(gd.uJb=1,gd.tJb=0):3===gd.N_?(gd.uJb=0,gd.tJb=1):1===gd.N_&&(gd.uJb=1,gd.tJb=1);ca.ULS.sendTraceTag(595079448,0,50,"PdfPrintDialog:OnChangeScaling scaling option changed from {0} to {1}",Cc.toString(),gd.N_.toString());return!0};gd.lzd=function(Cc){if(Cc&&Cc.data&&Cc.data.Td&&Cc.data.responseHeaders&&Cc.data.Td.length){if(Cc.data.responseHeaders["Content-Type"]&&Cb.a.contains(Cc.data.responseHeaders["Content-Type"].toString(),"application/pdf",!0)){ca.ULS.sendTraceTag(51676164,0,50,"PdfPrintDialog:OnFileHandlerSuccessCallback - pdf converted successfully");
var kd={};gd.aEb(kd,null,null)}else kd=kb.a.Th(Cc.data.Td),ca.ULS.sendTraceTag(51676165,0,15,"PdfPrintDialog:OnFileHandlerSuccessCallback - Failed to convert workbook. Error message Id: {0}",kd.Errors[0].MessageId);Cc=Cc.data.state;Cc.v8c(kd,Cc.userContext,Cc.methodName)}else ca.ULS.sendTraceTag(51676163,0,10,"PdfPrintDialog:OnFileHandlerSuccessCallback - Invalid Parameter : {0}",Cc?Cc.data?Cc.data.Td?Cc.data.responseHeaders?Cc.data.Td.length?null:"requestSucceededEventArgs.Data.ResponseData.Length":
"requestSucceededEventArgs.Data.ResponseHeaders":"requestSucceededEventArgs.Data.ResponseData":"requestSucceededEventArgs.Data":"requestSucceededEventArgs")};gd.kzd=function(Cc){var kd=za.a.Mf(Cc.data);ca.ULS.sendTraceTag(51676166,0,15,"PdfPrintDialog:OnFileHandlerFailureCallback has failed - Errors: [{0}]",Ob.a.Ec(kd));kd=Cc.data.state;kd.maa(Cc,kd.userContext,kd.methodName)};gd.aEb=function(Cc){Cc.Errors&&0<Cc.Errors.length?ca.ULS.sendTraceTag(51499295,0,50,"PdfPrintDialog: Failed to convert workbook. Error message Id: {0}",
Cc.Errors[0].MessageId):(6===gd.Ed.Le&&ea.AFrameworkApplication.ta.xe.Gj(ra.g(gd.$).nVf),ca.ULS.shipAssertTag(537154309,0,!!gd.$.va.pa,"PdfPrintDialog.OnConvertWorkbookToPdfSucceeded: EwaControl.Sheets.ActiveItem should not be null"),gd.$.va.pa&&gd.aia.Z2f(gd.uHa()))};gd.aia=oc;gd.activeCell=gd.$.pa.activeCell.toString();gd.Em.SelectedRanges&&gd.Em.SelectedRanges.Ranges&&0<gd.Em.SelectedRanges.Ranges.length&&gd.Em.SelectedRanges.Ranges[0]&&(gd.selectedRange=aa.B(gd.Em.SelectedRanges.Ranges[0]).toString());
gd.sheetName=Gc;gd.BN=ld;gd.TBd={};Pb=0;for(sc=K.paperSizeOptions.length;Pb<sc;++Pb)gd.TBd[K.paperSizeOptions[Pb].toString()]=Pb;gd.locale=window.navigator.browserLanguage||window.navigator.language||gd.$.ya.UICultureTag;gd.v7=ua.EwaSettings.isChangeGateEnabled("OfficeVSO:4738349_EnableIgnorePrintAreaSettingInPrintDialog");return gd}function N(Pb,sc){this.printSettings=this.sheetName=null;this.sheetName=Pb;this.printSettings=sc}function M(Pb,sc,nb,pc,Dc){Pb=ka.call(this,Pb,sc,nb,pc,Dc)||this;Pb.Tsb=
null;return Pb}function C(Pb,sc,nb,pc,Dc,oc,Gc,ld){ld=Pb.Na(1,void 0===ld?null:ld);ld.sheetName=sc;ld.locale=nb;return Ia.g(Pb,"GetPrintSettings",ld,pc,Dc,oc,Gc,4)}function Q(Pb,sc,nb,pc,Dc,oc,Gc){Gc=Pb.Na(1,void 0===Gc?null:Gc);Gc.ConvertInParameters=sc;return Ia.g(Pb,"ConvertWorkbookToPrintPdf",Gc,nb,pc,Dc,oc,4)}function P(Pb,sc,nb,pc,Dc,oc,Gc,ld){ld=Pb.Na(9,void 0===ld?null:ld);ld.sheetName=sc;ld.printSettings=nb;return Ia.g(Pb,"SetSheetPrintSettings",ld,pc,Dc,oc,Gc,0)}function ka(Pb,sc,nb,pc,
Dc,oc){Pb=qa.call(this,Pb,sc,nb,void 0===oc?!1:oc)||this;Pb.Sv=null;Pb.Em=pc;Pb.dRb=Dc;return Pb}var R=b(10),fa=b(0),ca=b(14),ea=b(4),wa=b(1543),X=b(905),ja=b(51),va=b(37),ua=b(1),Xa=b(64),aa=b(45),ba=b(186),oa=b(15),ra=b(21),db=b(390),Ka=b(637),Ga=b(27),xa=b(1079),da=b(12),qa=xa.a;Rk(ka,qa);ka.prototype.setFocus=function(){this.Sv.checked?da.DOMElementExtensions.setFocus(this.Sv):da.DOMElementExtensions.setFocus(this.getButton(0).get_element())};Mf.Object.defineProperties(ka.prototype,{Ed:{configurable:!0,
enumerable:!0,get:function(){return this.dRb}}});ka.g5b="printCurrentSelection";Object(fa.a)(ka,"BasePrintDialog",xa.a,[]);var na=b(118),ia=b(5),ta=b(216),za=b(121),sa=b(11),V=b(240),Ia=b(62);Rk(M,ka);M.prototype.initialize=function(){ca.ULS.sendTraceTag(537154316,0,50,"HtmlPrintDialog:Initialize - Preparing dialog for HTML Legacy print");this.s$h();this.aYa(1199);this.addButton(1);ka.prototype.initialize.call(this)};M.prototype.hha=function(){var Pb=this;return function(sc,nb,pc){var Dc=Pb.$.oa.xa,
oc=Pb.Em;sc=Pb.cja(sc);nb=Pb.Caa(nb);var Gc=Pb.Ed,ld=Dc.Na(1,null);ld.printOptions=oc;return Ia.g(Dc,"ValidatePrint",ld,sc,nb,pc,Gc,0)}};M.prototype.commit=function(){this.x_g();return!0};M.prototype.Xx=function(Pb,sc,nb){var pc,Dc=Pb.Result;if(Dc&&sc){var oc=0,Gc=0;(null===(pc=Dc.SelectedRanges)||void 0===pc?0:pc.Ranges)&&0<Dc.SelectedRanges.Ranges.length&&Dc.SelectedRanges.Ranges[0]&&(oc=Math.min(M.k0f(Dc.SelectedRanges.Ranges[0]),65535));Dc.UsedRange&&(Gc=Math.min(M.k0f(aa.j(aa.D(Dc.UsedRange))),
65535));V.h(sc,oc);V.i(sc,Gc)}this.Em=Dc;ka.prototype.Xx.call(this,Pb,sc,nb)};M.prototype.setFocus=function(){this.Tsb.checked?da.DOMElementExtensions.setFocus(this.Tsb):ka.prototype.setFocus.call(this)};M.prototype.s$h=function(){this.Gb.innerHTML=M.YZi(this.$.ea.isNamedObjectViewMode);this.Sv=da.DOMElementExtensions.getElementById(this.Gb,ka.g5b);this.Tsb=da.DOMElementExtensions.getElementById(this.Gb,"printEntireItem");0!==this.Em.Type&&this.Em.UseSelection?(this.Sv.checked=!0,this.Tsb.disabled=
!this.Em.SheetName):(this.Tsb.checked=!0,this.Sv.disabled=0===this.Em.Type||!ra.g(this.$).ha.sa.sg)};M.prototype.x_g=function(){ca.ULS.sendTraceTag(51499290,0,50,"HtmlPrintDialog:CommitWithGenerateHtml - CommitWithGenerateHtml called");var Pb=new Sys.StringBuilder;this.LFh(Pb);var sc=String.format("location=0,scrollbars=1,resizable=1,menubar=1,toolbar={0},status=0",Ga.a.Nf?0:1);sa.HelperMethods.Ze(Pb.toString(),"",sc,"PrintDialog.PrintViewUrl")||ca.ULS.sendTraceTag(51499291,0,10,"HtmlPrintDialog:CommitWithGenerateHtml - A browser blocked the xlprintview.aspx page!")};
M.prototype.LFh=function(Pb){var sc=this.$.ya;Pb.append(this.$.Bda+sc.LayoutsRelativeUri+"/xlprintview.aspx?");ta.a.Pg(Pb,ia.a.A1i,this.Em.SessionId);ta.a.Pg(Pb,ia.a.C1i,this.Sv.checked?"1":"0");if(0===this.Em.Type)ta.a.Pg(Pb,ia.a.x1i,this.Em.ObjectId);else{if(!this.Em.UsedRangeTooBig){var nb=aa.D(this.Em.UsedRange);(nb=aa.x(nb,this.Em.SheetName))&&ta.a.Pg(Pb,ia.a.D1i,nb)}1===this.Em.Type?ta.a.Pg(Pb,ia.a.y1i,this.Em.ObjectId):(nb=aa.B(this.Em.SelectedRanges.Ranges[0]),nb=aa.x(nb,this.Em.SheetName),
ta.a.Pg(Pb,ia.a.z1i,nb))}za.a.RYa(Pb,sc);ta.a.Pg(Pb,ia.a.B1i,this.Em.Title)};M.YZi=function(Pb){return String.format("<div class='"+na.a.Cn+"'>{0}</div>\r\n\t<div class='"+na.a.$7b+"'>\r\n\t\t<input type='radio' id='{1}' name='print' /> <label for='{1}'>{2}</label><br />\r\n\t\t<input type='radio' id='{3}' name='print' /> <label for='{3}'>{4}</label>\r\n\t</div>\r\n</div>",oa.a.instance.ga(1200),ka.g5b,oa.a.instance.ga(1203),"printEntireItem",Pb?oa.a.instance.ga(1202):oa.a.instance.ga(1201))};M.k0f=
function(Pb){return(Pb.LastColumn-Pb.FirstColumn+1)*(Pb.LastRow-Pb.FirstRow+1)};Mf.Object.defineProperties(M.prototype,{nc:{configurable:!0,enumerable:!0,get:function(){return"HtmlPrintDialog"}}});Object(fa.a)(M,"HtmlPrintDialog",ka,[]);var Ha=b(178),ob=b(617),ib=b(13),La=b(8),zb=b(66),Fb=b(1280),Yb=b(980),kb=b(54),vb=b(177),Wa=b(306),qb=b(1076),yb=b(218),ec=b(938),Ob=b(31),Cb=b(22),ab=b(294);N.prototype.getSheetName=function(){return this.sheetName};N.prototype.getPrintSettings=function(){return this.printSettings};
Object(fa.a)(N,"MacroRecorderSheetPrintSettingsSavedPayload",null,[438]);var ya=b(158),ma=b(58);Rk(K,ka);K.prototype.initialize=function(){this.v7&&ua.EwaSettings.isChangeGateEnabled("OfficeVSO:4879681_PrintAreaCheckboxKeyboardFocus")&&K.I6g(this.Gb);this.Ae?this.hAe(1013,null):(this.Dl(),this.aYa(1013));ka.prototype.initialize.call(this)};K.prototype.dispose=function(){this.HNj();ka.prototype.dispose.call(this)};K.prototype.close=function(Pb){ca.ULS.sendTraceTag(591196544,0,50,"PdfPrintDialog.Close: User changed printSettings {0} times before exiting dialog {1} printing done",
this.O_,0===Pb?"with":"without");this.ljj();if(this.Wr){var sc=this.oLh();!this.bSd&&!this.eaa.checked&&this.$.isEditMode&&this.Zhd(sc)&&this.cjj(sc)}ka.prototype.close.call(this,Pb)};K.prototype.hha=function(){var Pb=this;return function(sc,nb,pc){return C(Pb.$.oa.xa,Pb.$.va.pa.name,Pb.locale,Pb.cja(sc),Pb.Caa(nb),pc,null)}};K.prototype.Xx=function(Pb,sc,nb){this.Wr=Pb.Result;this.uJb=this.Wr.ScalingWidth;this.tJb=this.Wr.ScalingHeight;this.W$c();this.$9h();ka.prototype.Xx.call(this,Pb,sc,nb)};K.prototype.Dl=
function(){ca.ULS.sendTraceTag(537154315,0,50,"PdfPrintDialog:InitializeDialogElements - Preparing dialog for Print Pdf");this.t$h();ka.prototype.Dl.call(this)};K.prototype.commit=function(){this.w_g();return!0};K.prototype.setFocus=function(){this.Ae?yb.a.jAc(this.Mca):this.Mca.checked?da.DOMElementExtensions.setFocus(this.Mca):ka.prototype.setFocus.call(this)};K.prototype.Lai=function(){switch(this.BN.tv){case 1:this.Mca.checked=!0;break;case 0:this.Sv.disabled?this.Mca.checked=!0:this.Sv.checked=
!0;break;case 2:this.eaa.checked=!0;break;default:ca.ULS.sendTraceTag(537154314,0,10,"Invalid what to print state {0}. Resetting to defaults.",this.BN.tv),this.BN.tv=1,this.Mca.checked=!0}};K.prototype.ljj=function(){this.BN.tv=this.HYc();this.v7&&(this.BN.ignorePrintArea=this.a5a.checked)};K.prototype.W$c=function(){if(100!==this.Wr.ScalingPercent||this.Wr.FitToPage&&(1<this.Wr.ScalingWidth||1<this.Wr.ScalingHeight))this.bSd=!0,this.Wr.ScalingWidth=K.Y4c,this.Wr.ScalingHeight=K.X4c,this.Wr.ScalingPercent=
K.M5b,this.Wr.FitToPage=K.R4c;this.Wr.PaperSize.toString()in this.TBd||(this.bSd=!0,this.Wr.PaperSize=this.Wr.PaperSize===K.WMg?34:K.Qrb)};K.prototype.$9h=function(){this.aza=this.Wr.IsLandscape?2:1;this.N_=this.Wr.FitToPage?1===this.Wr.ScalingWidth&&1===this.Wr.ScalingHeight?1:this.Wr.ScalingWidth||1!==this.Wr.ScalingHeight?2:3:0;this.qma=this.Wr.PaperSize;this.Y6c(this.eaa.checked?!0:!1);this.vNd(this.eaa.checked?!0:!1)};K.prototype.G$h=function(){this.aec.disabled=this.Sv.checked;this.xGb=this.a5a.checked=
this.BN.ignorePrintArea};K.prototype.m9g=function(Pb){this.Tza=document.createElement("select");this.Tza.style.width=224+zb.a.Xe;this.Tza.style.height=32+zb.a.Xe;this.Tza.setAttribute(ia.a.XD,"scalingElementId");this.Sza=new ec.a(this.Tza,!0);for(var sc=0,nb=K.scalingOptions.length;sc<nb;++sc){var pc=oa.a.instance.ga(K.Jjj[sc]);this.Sza.ML(pc,K.scalingOptions[sc].toString(),!1)}Pb.appendChild(this.Tza)};K.prototype.vDe=function(Pb){this.Jya=document.createElement("select");this.Jya.style.width=224+
zb.a.Xe;this.Jya.style.height=32+zb.a.Xe;this.Jya.setAttribute(ia.a.XD,"paperSizeElementId");this.Iya=new ec.a(this.Jya,!0);for(var sc=0,nb=K.paperSizeOptions.length;sc<nb;++sc){var pc=oa.a.instance.ga(K.JVi[sc]);this.Iya.ML(pc,K.paperSizeOptions[sc].toString(),!1)}Pb.appendChild(this.Jya)};K.prototype.oLh=function(){var Pb={};Pb.IsLandscape=2===this.aza;Pb.PaperSize=this.qma;Pb.ScalingWidth=this.uJb;Pb.ScalingHeight=this.tJb;Pb.ScalingPercent=100;Pb.FitToPage=0===this.N_?!1:!0;return Pb};K.prototype.uHa=
function(){var Pb=new Sys.StringBuilder;Pb.append(qb.a(this.$,"Pdf",!0));this.aia.Swc()&&ta.a.Pg(Pb,La.a.Fdg,"1");ta.a.Pg(Pb,La.a.$Ed,""+this.C6);ta.a.Pg(Pb,La.a.mJf,this.$.va.pa.name);0===this.C6&&(ta.a.Pg(Pb,La.a.lJf,this.selectedRange),ta.a.Pg(Pb,La.a.fJf,this.activeCell));ta.a.Pg(Pb,La.a.gJf,""+this.aza);ta.a.Pg(Pb,La.a.hJf,""+this.qma);ta.a.Pg(Pb,La.a.kJf,""+this.N_);ta.a.Pg(Pb,La.a.jJf,"1");ta.a.Pg(Pb,La.a.eJf,this.xGb?"1":"0");ta.a.Pg(Pb,La.a.iJf,"1");ca.ULS.sendTraceTag(51499296,0,50,"PdfPrintDialog: Print Pdf Url {0}",
Pb.toString());return Pb.toString()};K.prototype.fyb=function(){var Pb=this,sc=null;ca.ULS.sendTraceTag(537154313,0,50,"PdfPrintDialog:InvokeGetFileCopyFileHandler - Invoking GetFileCopyFileHandler");this.$.userOperationManager.Sb(new vb.a(223,0,function(nb,pc,Dc){nb=new Wa.a(nb,null,pc,Dc,null,!0,!1,"GetFileCopyFileHandler","");nb.correlationID=Ha.a.create().toString();sc=nb;ea.AFrameworkApplication.qd.A9(Pb.uHa(),1,null,null,K.j$c,!1,2,Pb.lzd,Pb.kzd,sc,void 0,void 0,void 0,12E4);return ma.Task.Ua(!0)},
16),null)};K.prototype.t$h=function(){ca.ULS.sendTraceTag(537154312,0,50,"PdfPrintDialog:InitializeForPrintPdf - Preparing full print pdf dialog");this.XZi(this.Gb);this.Y6c(!0);this.vNd(!0);this.Sv=da.DOMElementExtensions.getElementById(this.Gb,ka.g5b);this.Mca=da.DOMElementExtensions.getElementById(this.Gb,"printActiveSheet");this.eaa=da.DOMElementExtensions.getElementById(this.Gb,"printEntireWorkbook");this.v7&&(this.aec=da.DOMElementExtensions.getElementById(this.Gb,"ignorePrintAreaCheckboxButtonId"),
this.a5a=new Yb.a(this.aec));this.rwc()&&(this.Sv.disabled=!0,this.Em.SheetName=this.sheetName);this.Lai();this.v7&&this.G$h();this.M7i()};K.prototype.rwc=function(){return!!this.Em.ObjectId||!ra.g(this.$).ha.sa.sg};K.prototype.M7i=function(){ob.a.instance.ra(ib.a.change,this.Mca,this.$8a);ob.a.instance.ra(ib.a.change,this.eaa,this.$8a);ob.a.instance.ra(ib.a.change,this.Sv,this.$8a);ob.a.instance.ra(ib.a.change,this.exa,this.lmc);ob.a.instance.ra(ib.a.change,this.A$a,this.lmc);ob.a.instance.ra(ib.a.change,
this.Jya,this.Jtf);ob.a.instance.ra(ib.a.change,this.Tza,this.Ktf);this.v7&&this.a5a.Tmb(this.Itf)};K.prototype.HNj=function(){ob.a.instance.Ba(ib.a.change,this.Mca,this.$8a);ob.a.instance.Ba(ib.a.change,this.eaa,this.$8a);ob.a.instance.Ba(ib.a.change,this.Sv,this.$8a);ob.a.instance.Ba(ib.a.change,this.exa,this.lmc);ob.a.instance.Ba(ib.a.change,this.A$a,this.lmc);ob.a.instance.Ba(ib.a.change,this.Jya,this.Jtf);ob.a.instance.Ba(ib.a.change,this.Tza,this.Ktf);this.v7&&this.a5a.cda(this.Itf)};K.prototype.XZi=
function(Pb){Pb.classList.add(Fb.a.V_i);if(!this.Ae){document.getElementById("ewaDialogTitle").classList.add(Fb.a.printDialogTitle);var sc=document.getElementById("ewaDialogCloseButtonLink");sc.style.top=32+zb.a.Xe;this.rtl?sc.style.left=32+zb.a.Xe:sc.style.right=32+zb.a.Xe}sc=K.Uy(Fb.a.W_i);Pb.appendChild(sc);var nb=K.Uy(Fb.a.Q$a,1207);nb.style.marginBottom=12+zb.a.Xe;nb.id="whatToPrintTitleElementId";sc.appendChild(nb);nb=K.Uy(Fb.a.P$a);sc.appendChild(nb);K.hrb(nb,this.rtl,"printActiveSheet",1211,
"whatToPrintRbName","PrintWhatExcelActiveSheets_32x32x32","activeSheetRadioButtonInnerLabelElementId","whatToPrintTitleElementId");sc.appendChild(document.createElement("BR"));nb=K.Uy(Fb.a.P$a);sc.appendChild(nb);K.hrb(nb,this.rtl,"printEntireWorkbook",1204,"whatToPrintRbName","PrintWhatExcelEntireWorkbook_32x32x32","entireWorkbookRadioButtonInnerLabelElementId","whatToPrintTitleElementId");sc.appendChild(document.createElement("BR"));nb=K.Uy(Fb.a.P$a);sc.appendChild(nb);K.hrb(nb,this.rtl,ka.g5b,
1203,"whatToPrintRbName","PrintWhatExcelSelection_32x32x32","currentSelectionRadioButtonInnerLabelElementId","whatToPrintTitleElementId");this.v7?(nb=K.Uy(Fb.a.Q$a,1236),nb.style.marginTop=24+zb.a.Xe,nb.id="printAreaElementId",sc.appendChild(nb),ua.EwaSettings.isChangeGateEnabled("OfficeVSO:4879681_PrintAreaCheckboxKeyboardFocus")?(nb.style.marginBottom=12+zb.a.Xe,nb=K.Uy(na.a.f8c),nb.id="ignorePrintAreaCheckboxWarpperId",da.DOMElementExtensions.setVisible(nb,!0),sc.appendChild(nb),sc=this.getElementById("ignorePrintAreaCheckboxButtonId"),
da.DOMElementExtensions.setVisible(sc,!0),nb.appendChild(sc),sc=this.getElementById("ignorePrintAreaCheckboxLabelId"),da.DOMElementExtensions.setVisible(sc,!0),nb.appendChild(sc)):(nb=K.Uy(Fb.a.P$a),sc.appendChild(nb),K.A4g(nb,this.rtl))):(nb=K.Uy(Fb.a.Q$a,1209),nb.style.marginTop=24+zb.a.Xe,nb.id="paperSizeElementId",sc.appendChild(nb),nb=K.Uy(Fb.a.hEd),this.vDe(nb),sc.appendChild(nb));sc=K.Uy(Fb.a.X_i);Pb.appendChild(sc);Pb=K.Uy(Fb.a.Q$a,1208);Pb.style.marginBottom=12+zb.a.Xe;Pb.id="orientationTitleElementId";
sc.appendChild(Pb);Pb=K.Uy(Fb.a.P$a);sc.appendChild(Pb);K.hrb(Pb,this.rtl,"portraitRadioButtonId",1214,"orientationRbName","Portrait_32x32x32","portraitRadioButtonInnerLabelElementId","orientationTitleElementId");sc.appendChild(document.createElement("BR"));Pb=K.Uy(Fb.a.P$a);sc.appendChild(Pb);K.hrb(Pb,this.rtl,"landscapeRadioButtonId",1213,"orientationRbName","Landscape_32x32x32","landscapeRadioButtonInnerLabelElementId","orientationTitleElementId");this.v7&&(Pb=K.Uy(Fb.a.Q$a,1209),Pb.style.marginTop=
12+zb.a.Xe,Pb.id="paperSizeElementId",sc.appendChild(Pb),Pb=K.Uy(Fb.a.hEd),this.vDe(Pb),sc.appendChild(Pb));Pb=K.Uy(Fb.a.Q$a,1210);Pb.style.marginTop=(this.v7?10:74)+zb.a.Xe;Pb.id="scalingElementId";sc.appendChild(Pb);Pb=K.Uy(Fb.a.hEd);this.m9g(Pb);sc.appendChild(Pb);this.Ae||document.getElementById("buttonarea").classList.add(Fb.a.U_i);this.exa=da.DOMElementExtensions.getElementById(this.Gb,"landscapeRadioButtonId");this.A$a=da.DOMElementExtensions.getElementById(this.Gb,"portraitRadioButtonId")};
K.prototype.w_g=function(){var Pb=this;ca.ULS.sendTraceTag(51499294,0,50,"PdfPrintDialog:CommitWithConvertPdf - CommitWithConvertPdf called");this.C6=this.HYc();2!==this.C6&&(this.aza=this.Kue(),this.Iya&&(this.qma=K.paperSizeOptions[this.Iya.selectedIndex]),this.Sza&&(this.N_=K.scalingOptions[this.Sza.selectedIndex]));if(this.$.mwa&&ua.EwaSettings.isChangeGateEnabled("OfficeVSO:4445349_DisablePrintLatencyImprovementForCrossDomain")){var sc=this.$.oa.xa.Pb();this.$.userOperationManager.Sb(new vb.a(133,
0,function(nb,pc,Dc){var oc={};oc.WhatToPrint=Pb.C6;oc.UseNamedAction=Pb.aia.Swc();oc.SelectedSheetName=Pb.$.va.pa.name;oc.ActiveCell=Pb.activeCell;oc.SelectedRanges=[Pb.selectedRange];oc.IsPdfDocumentRequired=!1;oc.Orientation=Pb.aza;oc.PaperSize=Pb.qma;oc.Scaling=Pb.N_;oc.RichValuesEnabled=!0;Pb.v7&&(oc.IgnorePrintArea=Pb.xGb);return Q(Pb.$.oa.xa,oc,ab.b(Pb.aEb,nb),pc,Dc,sc)},16),null)}else this.fyb()};K.prototype.Y6c=function(Pb){this.A$a.disabled=Pb;this.exa.disabled=Pb;this.Iya.Rp.disabled=Pb;
this.Sza.Rp.disabled=Pb};K.prototype.vNd=function(Pb){Pb?(this.exa.checked=!1,this.A$a.checked=!1,this.Iya.selectedIndex=-1,this.Sza.selectedIndex=-1):(2===this.aza?this.exa.checked=!0:this.A$a.checked=!0,this.Iya.selectedIndex=this.TBd[this.qma.toString()],this.Sza.selectedIndex=this.N_)};K.prototype.cjj=function(Pb){var sc=this;ca.ULS.sendTraceTag(537154310,0,50,"PdfPrintDialog:SavePrintSettingsToFile - We should make a set SheetPrintSettings call here to set print Settings.");var nb=this.$.va.pa.name,
pc=this.$.oa.xa.Pb();this.$.userOperationManager.Sb(new vb.a(226,0,function(Dc,oc,Gc){return P(sc.$.oa.xa,nb,Pb,Dc,oc,Gc,pc)},void 0,function(){return new N(nb,Pb)}),null)};K.prototype.Zhd=function(Pb){return this.Wr.IsLandscape!==Pb.IsLandscape||this.Wr.PaperSize!==Pb.PaperSize||this.Wr.FitToPage!==Pb.FitToPage||this.Wr.ScalingHeight!==Pb.ScalingHeight||this.Wr.ScalingWidth!==Pb.ScalingWidth?!0:!1};K.prototype.Kue=function(){return this.exa&&this.exa.checked?2:1};K.prototype.HYc=function(){return this.Sv.checked?
0:this.Mca.checked?1:this.eaa.checked?2:1};K.Uy=function(Pb,sc){Pb=void 0===Pb?null:Pb;sc=void 0===sc?0:sc;var nb=document.createElement("div");Pb&&(nb.className=Pb);0!==sc&&(nb.innerHTML=oa.a.instance.ga(sc));return nb};K.I6g=function(Pb){var sc=document.createElement("input");sc.setAttribute("type","checkbox");sc.className=na.a.TLe;sc.id="ignorePrintAreaCheckboxButtonId";sc.setAttribute("name","ignorePrintAreaCbName");sc.style.height=16+zb.a.Xe;sc.style.width=16+zb.a.Xe;da.DOMElementExtensions.setVisible(sc,
!1);var nb=oa.a.instance.ga(1236),pc=oa.a.instance.ga(1237);sc.setAttribute(ia.a.Bt,nb+zb.a.space+pc);Pb.appendChild(sc);sc=document.createElement("label");sc.setAttribute("for","ignorePrintAreaCheckboxButtonId");sc.id="ignorePrintAreaCheckboxLabelId";sc.innerHTML=pc;sc.setAttribute(ia.a.pP,"true");sc.style.position="relative";sc.style.marginLeft=15+zb.a.Xe;da.DOMElementExtensions.setVisible(sc,!1);Pb.appendChild(sc)};K.A4g=function(Pb,sc){var nb=document.createElement("input");nb.setAttribute("type",
"checkbox");nb.id="ignorePrintAreaCheckboxButtonId";nb.setAttribute("name","ignorePrintAreaCbName");nb.setAttribute(ia.a.XD,"printAreaElementId"+zb.a.space+"ignorePrintAreaCheckboxButtonInnerLabelElementId");nb.style.height=16+zb.a.Xe;nb.style.width=16+zb.a.Xe;sc?nb.style.marginRight=0+zb.a.Xe:nb.style.marginLeft=0+zb.a.Xe;Pb.appendChild(nb);sc=document.createElement("label");sc.setAttribute("for","ignorePrintAreaCheckboxButtonId");sc.setAttribute(ia.a.pP,"true");sc.style.position="relative";sc.style.marginLeft=
15+zb.a.Xe;Pb.appendChild(sc);Pb=K.Uy(Fb.a.VHf,1237);Pb.id="ignorePrintAreaCheckboxButtonInnerLabelElementId";sc.appendChild(Pb)};K.hrb=function(Pb,sc,nb,pc,Dc,oc,Gc,ld){var gd=document.createElement("input");gd.setAttribute("type","radio");gd.id=nb;gd.setAttribute("name",Dc);gd.setAttribute(ia.a.XD,ld+zb.a.space+Gc);gd.style.height=16+zb.a.Xe;gd.style.width=16+zb.a.Xe;sc?gd.style.marginRight=0+zb.a.Xe:gd.style.marginLeft=0+zb.a.Xe;Pb.appendChild(gd);sc=document.createElement("label");sc.setAttribute("for",
nb);sc.style.position="relative";Pb.appendChild(sc);Pb=ya.createClusteredImage(32,32,oc,Fb.a.d0i,!0,oa.a.instance.ga(pc));pc=K.Uy(Fb.a.VHf,pc);pc.id=Gc;pc.setAttribute(ia.a.pP,"true");Gc=K.Uy(Fb.a.c0i);Gc.appendChild(pc);sc.appendChild(Gc);sc.appendChild(Pb)};Mf.Object.defineProperties(K.prototype,{nc:{configurable:!0,enumerable:!0,get:function(){return"PdfPrintDialog"}}});K.Y4c=1;K.X4c=0;K.M5b=100;K.Qrb=9;K.R4c=!0;K.WMg=13;K.paperSizeOptions=[1,5,6,7,8,9,11,12,3,20,27,28,34,37,43,14];K.JVi=[1216,
1217,1224,1218,1219,1220,1221,1222,1215,1225,1226,1227,1228,1229,1230,1231];K.scalingOptions=[0,1,2,3];K.Jjj=[1232,1233,1234,1235];K.j$c=["Content-Type"];Object(fa.a)(K,"PdfPrintDialog",ka,[]);Mf.Object.defineProperties(H.prototype,{tv:{configurable:!0,enumerable:!0,get:function(){return this.C6},set:function(Pb){0<=Pb&&2>=Pb?this.C6=Pb:(ca.ULS.sendTraceTag(537154308,0,10,"Attempt to set invalid state. Setting ActiveSheets instead."),this.C6=1)}},ignorePrintArea:{configurable:!0,enumerable:!0,get:function(){return this.W6d},
set:function(Pb){Pb||!Pb?this.W6d=Pb:ca.ULS.sendTraceTag(537154307,0,10,"Attempt to set invalid ignorePrintArea")}}});Object(fa.a)(H,"PdfPrintDialogBrowserSessionState",null,[]);var ha=b(7),Z=b(135),Na=b(99),eb=b(1598);Object(fa.a)(J,"MacroRecorderPrintAreaSetPayload",null,[438]);var cb=b(564),Ua=b(388),pa=b(74);Object(fa.a)(U,"MacroRecorderPageBreakInsertedPayload",null,[438]);Object(fa.a)(O,"MacroRecorderPageBreakRemovedPayload",null,[438]);T.prototype.getSheetName=function(){return this.sheetName};
Object(fa.a)(T,"MacroRecorderPageBreaksAllResetPayload",null,[438]);G.prototype.getSheetName=function(){return this.sheetName};Object(fa.a)(G,"MacroRecorderPrintAreaClearedPayload",null,[438]);var Qa=b(126),Db=b(112),Kb=b(50),Ab=b(190);Object(fa.a)(F,"PageBreaksInformation",null,[]);Object(fa.a)(I,"RowColBreak",null,[]);Object(fa.a)(D,"SharedRange",null,[]);var ub=b(171);x.prototype.executeCommand=function(Pb,sc,nb,pc,Dc,oc,Gc){Dc=void 0===Dc?null:Dc;oc=void 0===oc?null:oc;Gc=void 0===Gc?null:Gc;
this.ZVd();this.ribbonCommandInfo=sc;this.tDj(sc.command);Pb=ab.b(Dc,this.qLj);ca.ULS.sendTraceTag(543794888,0,50,"PrintCommandHandler.ExecuteCommand: {0} command execution started",sc.command);switch(sc.command){case 78661008:return this.X4e(sc,Pb,oc,Gc,!1);case 275604654:return this.X4e(sc,Pb,oc,Gc,!0);case -13332329:return this.W3e(sc,Pb,oc,Gc);case -837651977:return this.i2h(sc,Pb,oc,Gc);case -1778266776:return this.e3h(sc,Pb,oc,Gc);case 845325699:return this.S4e(sc,Pb,oc,Gc)}return ba.a(sc.command)};
x.prototype.zc=function(Pb,sc){switch(sc.command){case 78661008:case 275604654:case -837651977:case -1778266776:return 1===Pb;case 845325699:case -13332329:return!0}return!1};x.prototype.GZf=function(Pb,sc,nb){var pc=ra.g(this.$),Dc=pc.Ea,oc=aa.r(pc.ha.sa.selectedRanges,this.$);if((Dc=Dc.FE())&&Dc.length){Dc=bk(Dc);for(var Gc=Dc.next();!Gc.done;Gc=Dc.next()){Gc=Gc.value;var ld=Gc.lf;if(ld){for(var gd=aa.j(Gc.jf),Cc=[],kd=bk(oc.Ranges),Fd=kd.next();!Fd.done;Fd=kd.next()){var rb=Fd.value;rb.FirstRow>
gd.LastRow+1||rb.LastRow<gd.FirstRow||rb.FirstColumn>gd.LastColumn+1||rb.LastColumn<gd.FirstColumn||(Fd=this.TTh(gd,rb,ld),rb=this.STh(gd,rb,ld),Cc.push(Object(ha.a)(new D,{FirstRow:Fd.FirstRow,FirstColumn:rb.FirstColumn,LastRow:Fd.LastRow,LastColumn:rb.LastColumn})))}0<Cc.length&&!nb?ld.setPrintArea(Cc):0<Cc.length&&nb?ld.addToPrintArea(Cc):!nb&&ld.hasPrintArea()&&ld.clearPrintArea();!ld.isDirty()&&ld.hasPageLayout()&&ld.setDirty("PrintAreaBreakManager::SetPrintAreaInstantaneous, hash: "+Gc.Kd,4)}}this.zNb(pc,
Pb,sc)}};x.prototype.RXg=function(Pb,sc){var nb=ra.g(this.$),pc=ra.g(this.$).Ea.FE();if(pc&&pc.length){pc=bk(pc);for(var Dc=pc.next();!Dc.done;Dc=pc.next()){Dc=Dc.value;var oc=Dc.lf;oc&&(oc.clearPrintArea(),!oc.isDirty()&&oc.hasPageLayout()&&oc.setDirty("PrintAreaBreakManager::ClearPrintAreaInstantaneous, hash: "+Dc.Kd,4))}this.zNb(nb,Pb,sc)}};x.prototype.sbi=function(Pb,sc){var nb=ra.g(this.$),pc=nb.Ea,Dc=aa.o(nb.ha.sa.activeCell,this.$);if(Dc){var oc=pc.FE();if(oc&&oc.length){pc=null;for(var Gc=
bk(oc),ld=Gc.next();!ld.done;ld=Gc.next()){ld=ld.value;var gd=ld.lf;if(gd){var Cc=aa.j(ld.jf);if(!(Dc.FirstRow>Cc.LastRow||Dc.FirstRow<Cc.FirstRow||Dc.FirstColumn>Cc.LastColumn||Dc.FirstColumn<Cc.FirstColumn)&&(pc=this.U7g(gd,Cc,Dc),gd.insertPageBreak(pc),!gd.isDirty()&&gd.hasPageLayout()&&gd.setDirty("PrintAreaBreakManager::InsertPageBreakInstantaneous, hash: "+ld.Kd,4),pc))break}}if(!pc)for(oc=bk(oc),ld=oc.next();!ld.done;ld=oc.next())if(pc=ld.value,Gc=pc.lf)pc=aa.j(pc.jf),pc=this.uDe(Gc,pc,Dc),
Gc.insertPageBreak(pc);this.zNb(nb,Pb,sc)}}};x.prototype.d$i=function(Pb,sc){var nb=ra.g(this.$),pc=nb.Ea,Dc=aa.o(nb.ha.sa.activeCell,this.$);if(Dc&&(pc=pc.FE())&&pc.length){pc=bk(pc);for(var oc=pc.next();!oc.done;oc=pc.next()){oc=oc.value;var Gc=oc.lf;if(Gc){var ld=aa.j(oc.jf);(ld=this.uDe(Gc,ld,Dc))&&Gc.removePageBreak(ld);!Gc.isDirty()&&Gc.hasPageLayout()&&Gc.setDirty("PrintAreaBreakManager::RemovePageBreakInstantaneous, hash: "+oc.Kd,4)}}this.zNb(nb,Pb,sc)}};x.prototype.Wej=function(Pb,sc){var nb=
ra.g(this.$),pc=nb.Ea.FE();if(pc&&pc.length){pc=bk(pc);for(var Dc=pc.next();!Dc.done;Dc=pc.next()){Dc=Dc.value;var oc=Dc.lf;oc&&(oc.resetAllPageBreak(),!oc.isDirty()&&oc.hasPageLayout()&&oc.setDirty("PrintAreaBreakManager::ResetAllPageBreakInstantaneous, hash: "+Dc.Kd,4))}this.zNb(nb,Pb,sc)}};x.prototype.X4e=function(Pb,sc,nb,pc,Dc){if(!Dc){var oc=this.$.vb.getItemByName("PRINT_AREA");if(oc&&(ca.ULS.sendTraceTag(537154306,0,15,"PrintCommandHandler.HandleSetPrintAreaCommand: Print_Area already present as NamedObject of type : {0}",
oc.type),2===oc.type))return this.Zci(),ma.Task.Ua(!0)}oc=ra.g(this.$).ha.sa;var Gc=aa.r(oc.selectedRanges,this.$);if(1===Gc.Ranges.length&&!Dc){if(oc.Eba())return this.u3h(Pb,Gc,sc,nb,pc,Dc),ma.Task.Ua(!0);if(aa.R(Gc.Ranges[0]))return this.$.va.pa.hasPrintArea?this.W3e(Pb,sc,nb,pc):ma.Task.Ua(!0)}this.GZf(Pb.command,pc,Dc);return this.S$e(Pb,sc,nb,Gc,Dc)};x.prototype.W3e=function(Pb,sc,nb,pc){this.RXg(Pb.command,pc);return this.Lci(Pb,sc,nb)};x.prototype.i2h=function(Pb,sc,nb,pc){this.sbi(Pb.command,
pc);return this.Wci(Pb,sc,nb)};x.prototype.e3h=function(Pb,sc,nb,pc){var Dc=aa.r(ra.g(this.$).ha.sa.selectedRanges,this.$);if(aa.R(Dc.Ranges[0]))return this.S4e(Pb,sc,nb,pc);this.d$i(Pb.command,pc);return this.$ci(Pb,sc,nb)};x.prototype.S4e=function(Pb,sc,nb,pc){this.Wej(Pb.command,pc);return this.cdi(Pb,sc,nb)};x.prototype.S$e=function(Pb,sc,nb,pc,Dc){function oc(){return new J(pc,Dc)}function Gc(gd,Cc,kd){gd=ab.b(gd,sc);Cc=ab.a(Cc,nb);var Fd=ld.Na(1,null);Fd.selectedRanges=pc;Fd.addToPrintArea=
Dc;return Ia.g(ld,"SetPrintArea",Fd,gd,Cc,kd,null,0)}var ld=this.$.oa.xa;return ua.EwaSettings.Zb()?Ua.a(this.$.userOperationManager,Gc,function(gd){return new vb.a(241,0,gd,64,oc)},Pb):Ua.a(this.$.userOperationManager,Gc,function(gd){return new cb.a(241,0,gd,void 0,oc)},Pb)};x.prototype.Lci=function(Pb,sc,nb){function pc(){return new G(oc)}function Dc(ld,gd,Cc){ld=ab.b(ld,sc);gd=ab.a(gd,nb);var kd=Gc.Na(1,null);kd.sheetName=oc;return Ia.g(Gc,"ClearPrintArea",kd,ld,gd,Cc,null,0)}var oc=this.$.va.pa.name,
Gc=this.$.oa.xa;return ua.EwaSettings.Zb()?Ua.a(this.$.userOperationManager,Dc,function(ld){return new vb.a(243,0,ld,64,pc)},Pb):Ua.a(this.$.userOperationManager,Dc,function(ld){return new cb.a(243,0,ld,void 0,pc)},Pb)};x.prototype.Wci=function(Pb,sc,nb){function pc(){return new U(ld)}function Dc(gd,Cc,kd){var Fd=oc.$.oa.xa;gd=ab.b(gd,sc);Cc=ab.a(Cc,nb);var rb=Fd.Na(9,null);rb.sheetCell=ld;return Ia.g(Fd,"InsertPageBreak",rb,gd,Cc,kd,null,0)}var oc=this,Gc=ra.g(this.$),ld=aa.o(Gc.ha.sa.activeCell,
this.$);return ua.EwaSettings.Zb()?Ua.a(this.$.userOperationManager,Dc,function(gd){return new vb.a(244,0,gd,64,pc)},Pb):Ua.a(this.$.userOperationManager,Dc,function(gd){return new cb.a(244,0,gd,void 0,pc)},Pb)};x.prototype.$ci=function(Pb,sc,nb){function pc(){return new O(ld)}function Dc(gd,Cc,kd){var Fd=oc.$.oa.xa;gd=ab.b(gd,sc);Cc=ab.a(Cc,nb);var rb=Fd.Na(9,null);rb.sheetCell=ld;return Ia.g(Fd,"RemovePageBreak",rb,gd,Cc,kd,null,0)}var oc=this,Gc=ra.g(this.$),ld=aa.o(Gc.ha.sa.activeCell,this.$);
return ua.EwaSettings.Zb()?Ua.a(this.$.userOperationManager,Dc,function(gd){return new vb.a(245,0,gd,64,pc)},Pb):Ua.a(this.$.userOperationManager,Dc,function(gd){return new cb.a(245,0,gd,void 0,pc)},Pb)};x.prototype.cdi=function(Pb,sc,nb){function pc(){return new T(Gc)}function Dc(ld,gd,Cc){var kd=oc.$.oa.xa;ld=ab.b(ld,sc);gd=ab.a(gd,nb);var Fd=kd.Na(9,null);Fd.sheetName=Gc;return Ia.g(kd,"ResetAllPageBreaks",Fd,ld,gd,Cc,null,0)}var oc=this,Gc=this.$.va.pa.name;return ua.EwaSettings.Zb()?Ua.a(this.$.userOperationManager,
Dc,function(ld){return new vb.a(246,0,ld,64,pc)},Pb):Ua.a(this.$.userOperationManager,Dc,function(ld){return new cb.a(246,0,ld,void 0,pc)},Pb)};x.prototype.TTh=function(Pb,sc,nb){if(!Pb||!sc||!nb)return null;var pc=new D;pc.FirstRow=sc.FirstRow===Pb.LastRow+1?nb.getRowIndex(Pb.LastRow+1)+1:sc.FirstRow<Pb.FirstRow?0:nb.getRowIndex(sc.FirstRow+1);pc.LastRow=sc.FirstRow===Pb.LastRow+1||sc.LastRow>Pb.LastRow?nb.getRowIndex(Pb.LastRow+1)+1:nb.getRowIndex(sc.LastRow+1);return pc};x.prototype.STh=function(Pb,
sc,nb){if(!Pb||!sc||!nb)return null;var pc=new D;pc.FirstColumn=sc.FirstColumn===Pb.LastColumn+1?nb.getColumnIndex(Pb.LastColumn+1)+1:sc.FirstColumn<Pb.FirstColumn?0:nb.getColumnIndex(sc.FirstColumn+1);pc.LastColumn=sc.FirstColumn===Pb.LastColumn+1||sc.LastColumn>Pb.LastColumn?nb.getColumnIndex(Pb.LastColumn+1)+1:nb.getColumnIndex(sc.LastColumn+1);return pc};x.prototype.U7g=function(Pb,sc,nb){if(!sc||!nb||!Pb)return null;var pc=Pb.getPrintArea();if(!pc||!pc.length)return null;var Dc=Pb.getRowIndex(nb.FirstRow+
1),oc=Pb.getColumnIndex(nb.FirstColumn+1),Gc=null,ld=null;pc=bk(pc);for(var gd=pc.next();!gd.done;gd=pc.next())if(gd=gd.value,Dc>=gd.FirstRow&&Dc<=gd.LastRow&&oc>=gd.FirstColumn&&oc<=gd.LastColumn){if(nb.FirstRow===gd.FirstRow&&nb.FirstColumn===gd.FirstColumn)return new F;Dc>gd.FirstRow&&(Gc=Object(ha.a)(new I,{Index:Dc-1,Min:gd.FirstColumn-1,Max:Math.min(gd.LastColumn,Pb.getColumnIndex(sc.LastColumn+1))}));oc>gd.FirstColumn&&(ld=Object(ha.a)(new I,{Index:oc-1,Min:gd.FirstRow-1,Max:Math.min(gd.LastRow,
Pb.getRowIndex(sc.LastRow+1))}));break}return Gc||ld?Object(ha.a)(new F,{Row:Gc?[Gc]:null,Col:ld?[ld]:null}):null};x.prototype.i9g=function(Pb,sc,nb){if(!sc||!nb||!Pb)return null;var pc=null;nb.FirstRow>sc.FirstRow&&nb.FirstRow<=sc.LastRow?pc=Object(ha.a)(new I,{Index:Pb.getRowIndex(nb.FirstRow+1)-1,Min:-1,Max:-1}):nb.FirstRow===sc.LastRow+1&&(pc=Object(ha.a)(new I,{Index:Pb.getRowIndex(sc.LastRow+1),Min:-1,Max:-1}));return pc};x.prototype.G4g=function(Pb,sc,nb){if(!sc||!nb||!Pb)return null;var pc=
null;nb.FirstColumn>sc.FirstColumn&&nb.FirstColumn<=sc.LastColumn?pc=Object(ha.a)(new I,{Index:Pb.getColumnIndex(nb.FirstColumn+1)-1,Min:-1,Max:-1}):nb.FirstColumn===sc.LastColumn+1&&(pc=Object(ha.a)(new I,{Index:Pb.getColumnIndex(sc.LastColumn+1),Min:-1,Max:-1}));return pc};x.prototype.uDe=function(Pb,sc,nb){if(!nb||!Pb||!sc)return null;var pc=this.i9g(Pb,sc,nb);Pb=this.G4g(Pb,sc,nb);return pc||Pb?Object(ha.a)(new F,{Row:pc?[pc]:null,Col:Pb?[Pb]:null}):null};x.prototype.Zci=function(){var Pb=new Z.StandardDialog;
Pb.Rb=0;Pb.mc(1,oa.a.instance.ga(4));Pb.ql(oa.a.instance.ga(572),oa.a.instance.ga(573),1,null)};x.prototype.tDj=function(Pb){if(this.uva.kb(Pb)&&(sa.HelperMethods.VZ&&(this.mFb=this.$.Fb.sc("UserAction","PrintAreaPageBreaksTimeStopwatch")),this.sKa.kb(Pb)&&this.sKa.remove(Pb),this.sKa.add(Pb,Ha.a.create().toString()),ra.g(this.$).si)){var sc=Kb.b()?Kb.b().ei(Pb):"";ra.g(this.$).si.y7(this.uva.na(Pb),this.sKa.na(Pb),sc)}};x.prototype.aWg=function(Pb){if(this.mFb&&Pb){var sc=this.mFb.qc;this.mFb.stop();
this.mFb=null;switch(Pb){case "SetPrintArea":this.Hpb(sc,1700,Pb);break;case "ClearPrintArea":this.Hpb(sc,1500,Pb);break;case "InsertPageBreak":this.Hpb(sc,1500,Pb);break;case "RemovePageBreak":this.Hpb(sc,1600,Pb);break;case "ResetAllPageBreaks":this.Hpb(sc,1700,Pb)}}};x.prototype.Hpb=function(Pb,sc,nb){Pb>sc&&(sc=Object(ha.a)(new Ab.a,{extendedProperties:new Map}),sc.extendedProperties.set("OperationName",nb),sc.extendedProperties.set("OperationExecutionTime",Pb.toString()),Na.Health.instance.recordQosError(Qa.a.hCj,
[Db.a.dCj],!1,!0,!0,!1,sc))};x.prototype.u3h=function(Pb,sc,nb,pc,Dc,oc){var Gc=this,ld=new Z.StandardDialog,gd=new eb.a(oa.a.instance.ga(570),oa.a.instance.ga(571),oa.a.instance.ga(6),oa.a.instance.ga(5));ld.Rb=1;ld.mc(1,gd.confirmButton);ld.mc(0,gd.cancelButton);ld.ql(gd.title,gd.body,3,function(Cc){1===Cc&&(Gc.GZf(Pb.command,Dc,oc),Gc.S$e(Pb,nb,pc,sc,oc))})};x.prototype.zNb=function(Pb,sc,nb){nb();this.sKa.kb(sc)&&Pb.si.A0(this.sKa.na(sc),pa.BasicTelemetryCalculator.HQ)};x.prototype.ZVd=function(){this.Mod&&
this.$.Fd(-1753588160,-1,0,null)};Object(fa.a)(x,"PrintAreaBreakManager",null,[701]);var Mb=b(410),Aa=b(89);z.prototype.equals=function(Pb){return Pb?this.orientation===Pb.orientation&&this.yca===Pb.yca&&this.i0===Pb.i0&&this.margin===Pb.margin&&this.sheetPrintOptions===Pb.sheetPrintOptions&&this.o1a===Pb.o1a&&this.NoColor===Pb.NoColor:!1};z.rBe=function(Pb,sc){Pb&&sc&&(sc.tv=Pb.tv,sc.orientation=Pb.orientation,sc.yca=Pb.yca,sc.i0=Pb.i0,sc.margin=Pb.margin,sc.ignorePrintArea=Pb.ignorePrintArea,sc.sheetPrintOptions=
Pb.sheetPrintOptions,sc.o1a=Pb.o1a,sc.NoColor=Pb.NoColor)};Object(fa.a)(z,"PrintSettingsContainer",null,[]);var Za=b(160),Zb=b(356),jb=b(38),Vb=b(1024),Ic=b(994),Rb=b(202),kc=b(737),xb=b(616);Object(fa.a)(A,"PrintSettingMarginOption",null,[]);Object(fa.a)(B,"PrintSettingMarginValue",null,[]);Object(fa.a)(w,"PrintSettingOption",null,[]);m.prototype.dispose=function(){};m.prototype.Jvb=function(Pb){if(!Pb)return null;var sc=new B;sc.left=Pb.Left;sc.right=Pb.Right;sc.top=Pb.Top;sc.bottom=Pb.Bottom;sc.header=
Pb.Header;sc.footer=Pb.Footer;return sc};m.prototype.j3c=function(Pb){ca.ULS.shipAssertTag(537154186,0,6===Pb.length,"PrintPreviewManager.CreatePageMargin: marginValue array passed in, doesn't contain 6 margin values");var sc={};sc.Top=Pb[0];sc.Bottom=Pb[1];sc.Left=Pb[2];sc.Right=Pb[3];sc.Header=Pb[4];sc.Footer=Pb[5];return sc};m.prototype.eai=function(){this.nie=[Object(ha.a)(new w,{printSettingOptionKey:1,printSettingOptionText:this.Gm.ga(1211)}),Object(ha.a)(new w,{printSettingOptionKey:2,printSettingOptionText:this.Gm.ga(1204)}),
Object(ha.a)(new w,{printSettingOptionKey:0,printSettingOptionText:this.Gm.ga(1203)})];this.Nbe=[Object(ha.a)(new w,{printSettingOptionKey:1,printSettingOptionText:this.Gm.ga(1214)}),Object(ha.a)(new w,{printSettingOptionKey:2,printSettingOptionText:this.Gm.ga(1213)})];this.dce=[Object(ha.a)(new w,{printSettingOptionKey:1,printSettingOptionText:this.Gm.ga(1216)}),Object(ha.a)(new w,{printSettingOptionKey:5,printSettingOptionText:this.Gm.ga(1217)}),Object(ha.a)(new w,{printSettingOptionKey:6,printSettingOptionText:this.Gm.ga(1224)}),
Object(ha.a)(new w,{printSettingOptionKey:7,printSettingOptionText:this.Gm.ga(1218)}),Object(ha.a)(new w,{printSettingOptionKey:8,printSettingOptionText:this.Gm.ga(1219)}),Object(ha.a)(new w,{printSettingOptionKey:9,printSettingOptionText:this.Gm.ga(1220)}),Object(ha.a)(new w,{printSettingOptionKey:11,printSettingOptionText:this.Gm.ga(1221)}),Object(ha.a)(new w,{printSettingOptionKey:12,printSettingOptionText:this.Gm.ga(1222)}),Object(ha.a)(new w,{printSettingOptionKey:13,printSettingOptionText:this.Gm.ga(1223)}),
Object(ha.a)(new w,{printSettingOptionKey:3,printSettingOptionText:this.Gm.ga(1215)})];this.Gee=[Object(ha.a)(new w,{printSettingOptionKey:0,printSettingOptionText:this.Gm.ga(1232)}),Object(ha.a)(new w,{printSettingOptionKey:1,printSettingOptionText:this.Gm.ga(1233)}),Object(ha.a)(new w,{printSettingOptionKey:2,printSettingOptionText:this.Gm.ga(1234)}),Object(ha.a)(new w,{printSettingOptionKey:3,printSettingOptionText:this.Gm.ga(1235)})];this.O$d=[Object(ha.a)(new A,{printSettingOption:Object(ha.a)(new w,
{printSettingOptionKey:0,printSettingOptionText:this.Gm.ga(1238)}),marginValue:this.Jvb(this.normal)}),Object(ha.a)(new A,{printSettingOption:Object(ha.a)(new w,{printSettingOptionKey:1,printSettingOptionText:this.Gm.ga(1239)}),marginValue:this.Jvb(this.wide)}),Object(ha.a)(new A,{printSettingOption:Object(ha.a)(new w,{printSettingOptionKey:2,printSettingOptionText:this.Gm.ga(1240)}),marginValue:this.Jvb(this.narrow)}),Object(ha.a)(new A,{printSettingOption:Object(ha.a)(new w,{printSettingOptionKey:3,
printSettingOptionText:this.Gm.ga(1241)}),marginValue:this.Jvb(this.B6)})]};m.prototype.Y$h=function(){this.normal=this.j3c(this.aDi);this.narrow=this.j3c(this.NBi);this.wide=this.j3c(this.EWj)};Mf.Object.defineProperties(m.prototype,{whatToPrintOptions:{configurable:!0,enumerable:!0,get:function(){return this.nie}},orientationOptions:{configurable:!0,enumerable:!0,get:function(){return this.Nbe}},paperSizeOptions:{configurable:!0,enumerable:!0,get:function(){return this.dce}},scalingOptions:{configurable:!0,
enumerable:!0,get:function(){return this.Gee}},marginDetailedOptions:{configurable:!0,enumerable:!0,get:function(){return this.O$d}}});m.pch=1;m.cch=1;m.Qrb=9;m.hch=2;m.ach=0;m.Ubh=!1;m.Qbh=!1;m.VHa={PrintGrid:!1,HorizontalCenter:!1,VerticalCenter:!1,PrintHeaders:!1};Object(fa.a)(m,"PrintSettingsManagerBase",null,[3]);var Va=b(127),tb=b(295);y.prototype.getSheetName=function(){return this.sheetName};Object(fa.a)(y,"MacroRecorderSheetPrintOptionsSavedPayload",null,[438]);Rk(r,m);r.prototype.Qci=function(Pb){var sc=
this;this.Rci(function(nb){Pb&&(nb=sc.YTh(nb),Pb(nb))})};r.prototype.BLd=function(Pb,sc){if(Pb){var nb=new H(Pb.tv,Pb.ignorePrintArea);this.bjj(nb);!sc||this.Y3f?ca.ULS.sendTraceTag(593294034,0,50,"PrintSettingsManager.SavePrintSettings: Saving of print settings skipped because {0}",sc?"skipSaveToFile is true":"shouldFilePersistedPrintSettingsBeSaved is false"):(sc=this.$Th(Pb.i0),sc.IsLandscape=2===Pb.orientation,sc.PaperSize=Pb.yca,this.isUniversalPrintEnabled&&(sc.NoColor=Pb.NoColor),sc.PageMargin=
this.Wed(Pb.margin),sc.SheetPrintOptions=m.VHa,sc.SheetPrintOptions.PrintGrid=Pb.sheetPrintOptions.PrintGrid,sc.SheetPrintOptions.HorizontalCenter=Pb.sheetPrintOptions.HorizontalCenter,sc.SheetPrintOptions.VerticalCenter=Pb.sheetPrintOptions.VerticalCenter,sc.SheetPrintOptions.PrintHeaders=Pb.sheetPrintOptions.PrintHeaders,this.ajj(sc))}else ca.ULS.sendTraceTag(593294035,0,10,"PrintSettingsManager.SavePrintSettings: printSettingsContainer passed as parameter is null")};r.prototype.Wed=function(Pb){var sc=
{};0===Pb?sc=this.normal:1===Pb?sc=this.wide:2===Pb?sc=this.narrow:3===Pb&&(sc=this.B6);return sc};r.prototype.gdi=function(Pb){var sc=this;if(Pb){ca.ULS.sendTraceTag(537154197,0,50,"PrintSettingsManager.InvokeSetPrintOptionsWebMethod: Make server call to save print options to file");var nb=function(){return new y(sc.$.va.pa.name,Pb)},pc=this.$.oa.xa,Dc=this.$.oa.xa.Pb(),oc=function(Gc,ld,gd){var Cc=sc.$.va.pa.name;Gc=ab.b(sc.pAd,Gc);ld=ab.a(sc.yAd,ld);var kd=pc.Na(1,null);kd.sheetName=Cc;kd.printOptions=
Pb;return Ia.g(pc,"SetPrintOptions",kd,Gc,ld,gd,Dc,0)};nb=ua.EwaSettings.Zb()?new vb.a(598,0,oc,64,nb):new cb.a(598,0,oc,void 0,nb);this.$.userOperationManager.Sb(nb,null)}else ca.ULS.sendTraceTag(537154198,0,10,"PrintSettingsManager.InvokeSetPrintOptionsWebMethod: sheetPrintOptions passed as parameter is null")};r.prototype.dispose=function(){this.Bd||(this.Bd=!0,this.$.userOperationManager.so(this.vz),this.WX())};r.prototype.bjj=function(Pb){this.BN.tv=Pb.tv;this.BN.ignorePrintArea=Pb.ignorePrintArea};
r.prototype.Rci=function(Pb){function sc(ld,gd,Cc){return C(Dc.$.oa.xa,Dc.sheetName,Dc.locale,ab.b(ld,pc),ab.a(gd,nb),Cc,oc)}function nb(ld){ld=za.a.Mf(ld.data);ca.ULS.sendTraceTag(537154194,0,10,"PrintSettingsManager.GetPrintSettingsPersistedInFile: Get print settings failed. Errors: {0}.",Ob.a.Ec(ld));Pb(null)}function pc(ld){tb.a(ld)?ca.ULS.sendTraceTag(537154196,0,15,"PrintSettingsManager.GetPrintSettingsPersistedInFile: Get print settings failed. Errors: {0}.",Ob.a.Ec(ld.Errors)):(ca.ULS.sendTraceTag(537154195,
0,50,"PrintSettingsManager.GetPrintSettingsPersistedInFile: Get print settings succeeded."),Pb(ld.Result))}var Dc=this,oc=this.$.oa.xa.Pb();var Gc=ua.EwaSettings.Zb()?new vb.a(247,0,sc,80):new cb.a(247,0,sc,16);Gc=this.$.userOperationManager.Sb(Gc,null);this.Yu.add(Gc)};r.prototype.ajj=function(Pb){var sc=this;ca.ULS.sendTraceTag(593294031,0,50,"PrintSettingsManager.SavePrintSettingsPersistedInFile: Make server call to save print settings to file");var nb=this.$.oa.xa.Pb();this.$.userOperationManager.Sb(new vb.a(226,
0,function(pc,Dc,oc){return P(sc.$.oa.xa,sc.sheetName,Pb,ab.b(pc,sc.yQi),ab.a(Dc,sc.xQi),oc,nb)},void 0,function(){return new N(sc.sheetName,Pb)}),null)};r.prototype.kki=function(Pb){return this.jbf(Pb)||!this.sef(Pb.PaperSize)};r.prototype.W$c=function(Pb){this.jbf(Pb)&&(ca.ULS.sendTraceTag(537154192,0,50,"PrintSettingsManager.FixPrintSettingsNotSupportedInXlo: Custom scaling present in file."),Pb.ScalingWidth=r.Y4c,Pb.ScalingHeight=r.X4c,Pb.ScalingPercent=r.M5b,Pb.FitToPage=r.R4c);this.sef(Pb.PaperSize)||
(ca.ULS.sendTraceTag(537154191,0,15,"PrintSettingsManager.FixPrintSettingsNotSupportedInXlo: Paper size {0} present in file which is unsupported by XLO.",Pb.PaperSize.toString()),Pb.PaperSize=r.Qrb);return Pb};r.prototype.WTh=function(Pb){if(Pb.FitToPage){if(1===Pb.ScalingWidth&&1===Pb.ScalingHeight)return 1;if(!Pb.ScalingWidth&&1===Pb.ScalingHeight)return 3}else return 0;return 2};r.prototype.VTh=function(Pb){return this.vod(Pb,this.normal)?0:this.vod(Pb,this.wide)?1:this.vod(Pb,this.narrow)?2:3};
r.prototype.vod=function(Pb,sc){return Pb.Left===sc.Left&&Pb.Right===sc.Right&&Pb.Top===sc.Top&&Pb.Bottom===sc.Bottom&&Pb.Header===sc.Header&&Pb.Footer===sc.Footer};r.prototype.$Th=function(Pb){var sc={};sc.ScalingPercent=r.M5b;sc.FitToPage=0!==Pb;2===Pb?(sc.ScalingWidth=1,sc.ScalingHeight=0):3===Pb?(sc.ScalingWidth=0,sc.ScalingHeight=1):1===Pb&&(sc.ScalingWidth=1,sc.ScalingHeight=1);return sc};r.prototype.sef=function(Pb){return this.IVi.contains(Pb.toString())};r.prototype.jbf=function(Pb){return 100!==
Pb.ScalingPercent||Pb.FitToPage&&(1<Pb.ScalingWidth||1<Pb.ScalingHeight)};r.prototype.u2g=function(){for(var Pb=new kc.a(xb.a.Ik()),sc=0;sc<this.paperSizeOptions.length;sc++)Pb.add(this.paperSizeOptions[sc].printSettingOptionKey.toString());return Pb};r.prototype.YTh=function(Pb){var sc=null;if(Pb){var nb=this.BN.tv,pc=this.BN.ignorePrintArea;this.kki(Pb)&&(this.Y3f=!0,Pb=this.W$c(Pb));sc=new z;sc.tv=nb;sc.ignorePrintArea=pc;sc.orientation=Pb.IsLandscape?2:1;sc.yca=Pb.PaperSize;sc.i0=this.WTh(Pb);
sc.sheetPrintOptions=m.VHa;sc.sheetPrintOptions.PrintGrid=Pb.SheetPrintOptions.PrintGrid;sc.o1a=Pb.Draft;this.isUniversalPrintEnabled&&(sc.NoColor=Pb.NoColor);sc.sheetPrintOptions.HorizontalCenter=Pb.SheetPrintOptions.HorizontalCenter;sc.sheetPrintOptions.VerticalCenter=Pb.SheetPrintOptions.VerticalCenter;sc.sheetPrintOptions.PrintHeaders=Pb.SheetPrintOptions.PrintHeaders;sc.margin=this.VTh(Pb.PageMargin);ua.EwaSettings.isChangeGateEnabled("OfficeVSO:5466517_AddPageMarginLogs")&&ca.ULS.sendTraceTag(553965398,
0,50,"PageMargin received : {0}",sc.margin);3===sc.margin&&(this.B6={},this.B6.Left=Pb.PageMargin.Left,this.B6.Right=Pb.PageMargin.Right,this.B6.Top=Pb.PageMargin.Top,this.B6.Bottom=Pb.PageMargin.Bottom,this.B6.Header=Pb.PageMargin.Header,this.B6.Footer=Pb.PageMargin.Footer)}return sc};r.prototype.WX=function(){if(this.Yu){for(var Pb=bk(this.Yu),sc=Pb.next();!sc.done;sc=Pb.next())sc=sc.value,this.$&&this.$.userOperationManager&&(sc.operation&&ca.ULS.sendTraceTag(537154187,0,50,"PrintSettingsManager.AbortOutstandingUserOperation: Trying to abort pending operation {0}.",
Va.a(sc.operation.operationName)),this.$.userOperationManager.uta(sc)),this.Yu.remove(sc);this.Yu=null}};r.Y4c=1;r.X4c=0;r.M5b=100;r.Qrb=9;r.R4c=!0;Object(fa.a)(r,"PrintSettingsManager",m,[]);var fb=b(67);Object(fa.a)(v,"PrintSettingsTaskPaneCallbacks",null,[]);Object(fa.a)(f,"SelectedPrintSettings",null,[]);Object(fa.a)(n,"PrintOperationCallbacks",null,[]);Object(fa.a)(l,"PrintPreviewPaneCallbacks",null,[]);var ac=b(1279);Object(fa.a)(k,"UniversalPrintAppSettings",null,[]);var Ac=b(394);e.prototype.ZFg=
function(Pb){this.Pa.addHandler("ppocek",Pb)};e.prototype.Kbj=function(Pb){this.Pa.removeHandler("ppocek",Pb)};e.prototype.iAj=function(Pb,sc){this.tfj();this.$.userOperationManager.zr(this.vz);this.Em=Pb;this.Pa.raiseEvent("ppocek");this.Em.SelectedRanges&&this.Em.SelectedRanges.Ranges&&0<this.Em.SelectedRanges.Ranges.length&&this.Em.SelectedRanges.Ranges[0]&&(this.selectedRange=aa.B(this.Em.SelectedRanges.Ranges[0]).toString());ca.ULS.shipAssertTag(537154268,0,!this.Zu,"PrintPreviewManager.ShowPrintPreviewer: printSettingsManager should be null.");
this.Zu=new r(this,this.$,sc,this.$.va.pa.name,oa.a.instance,this.isUniversalPrintEnabled);ca.ULS.shipAssertTag(537154267,0,!this.kg,"PrintPreviewManager.ShowPrintPreviewer: printPreviewPane should be null.");this.kg=new Ic.PrintPreviewPane(this.$,this,this.useMSPdfViewer,this.isUniversalPrintEnabled);this.kg.Ufh();this.kg.kAj();this.kg.rFg(this.azf)};e.prototype.dRh=function(){this.Zu.B6&&4<=this.Zu.marginDetailedOptions.length&&(this.Zu.marginDetailedOptions[3].marginValue=this.Zu.Jvb(this.Zu.B6));
return this.Zu.marginDetailedOptions};e.prototype.rwc=function(){return!!this.Em&&!!this.Em.ObjectId||!ra.g(this.$).ha.sa.sg};e.prototype.aUh=function(){var Pb=Object(ha.a)(new f,{selectedWhatToPrint:m.pch,selectedOrientation:m.cch,selectedPaperSize:m.Qrb,selectedScaling:m.hch,selectedMargin:m.ach,selectedIgnorePrintArea:m.Ubh,selectedPrintGridlines:m.VHa.PrintGrid,selectedDraft:m.Qbh,selectedHorizontalCenter:m.VHa.HorizontalCenter,selectedVerticalCenter:m.VHa.VerticalCenter,selectedRowAndColumnHeadings:m.VHa.PrintHeaders});
this.pH?(Pb.selectedWhatToPrint=this.pH.tv,Pb.selectedOrientation=this.pH.orientation,Pb.selectedPaperSize=this.pH.yca,Pb.selectedScaling=this.pH.i0,Pb.selectedMargin=this.pH.margin,Pb.selectedIgnorePrintArea=this.pH.ignorePrintArea,Pb.selectedPrintGridlines=this.pH.sheetPrintOptions.PrintGrid,Pb.selectedDraft=this.pH.o1a,this.isUniversalPrintEnabled&&(Pb.selectedColor=this.pH.NoColor?0:1),Pb.selectedHorizontalCenter=this.pH.sheetPrintOptions.HorizontalCenter,Pb.selectedVerticalCenter=this.pH.sheetPrintOptions.VerticalCenter,
Pb.selectedRowAndColumnHeadings=this.pH.sheetPrintOptions.PrintHeaders):ca.ULS.sendTraceTag(593294038,0,10,"PrintPreviewManager.GetPrintSettingsSelectedOnPaneOpen: initialPrintSettings is null.");return Pb};e.prototype.a0e=function(){var Pb=this;return Object(ha.a)(new l,{onBackToSheet:function(){Pb.Fla()}})};e.prototype.XTh=function(){var Pb=this;return Object(ha.a)(new ac.a,{backActionButtonText:oa.a.instance.ga(1191),printPreviewPaneCallbacks:this.a0e(),logger:new Mb.a,disableTellMeControl:!0,
printOperationCallbacks:Object(ha.a)(new n,{onClosePreviewer:function(){Pb.Fla()},getGraphServiceAuthorizationToken:this.M$b(),onLocalPrint:function(){Pb.Nzf()},onNotifyPrintJobStatus:this.onNotifyPrintJobStatus}),universalPrintAppSettings:Object(ha.a)(new k,{graphServiceEndpoint:this.graphServiceEndpoint,graphServiceEndpointVersion:this.sei()?"testppebeta-print":"v1.0",isUniversalPrintFlowEnabled:this.isUniversalPrintEnabled,appName:"Excel"})})};e.prototype.ZTh=function(){var Pb=this;return Object(ha.a)(new v,
{onSettingChange:function(sc){Pb.nPi(sc)},onPrint:function(){Pb.Nzf()}})};e.prototype.nPi=function(Pb){this.O_++;Pb?(this.kg&&this.kg.aBj(),this.pk.tv=Pb.selectedWhatToPrint,this.pk.i0=Pb.selectedScaling,this.pk.orientation=Pb.selectedOrientation,this.pk.yca=Pb.selectedPaperSize,this.pk.margin=Pb.selectedMargin,this.isUniversalPrintEnabled&&(this.pk.NoColor=!Pb.selectedColor),this.pk.ignorePrintArea=Pb.selectedIgnorePrintArea,this.arj(Pb.selectedPageStart,Pb.selectedPageEnd),this.Zu&&this.A4h(this.pk,
Pb)?(this.pk.sheetPrintOptions=m.VHa,this.pk.sheetPrintOptions.PrintGrid=Pb.selectedPrintGridlines,this.pk.sheetPrintOptions.HorizontalCenter=Pb.selectedHorizontalCenter,this.pk.sheetPrintOptions.VerticalCenter=Pb.selectedVerticalCenter,this.pk.sheetPrintOptions.PrintHeaders=Pb.selectedRowAndColumnHeadings,this.Zu.gdi(this.pk.sheetPrintOptions)):this.fyb()):ca.ULS.sendTraceTag(593294037,0,10,"PrintPreviewManager.OnPrintSettingsChange: changedPrintSettings passed as input is null.")};e.prototype.Fla=
function(){this.I5a&&(this.BMb=!0);ca.ULS.sendTraceTag(591196513,0,50,"PrintPreviewManager.OnCloseButtonClick: User changed printSettings {0} times before clicking on backToWorkbook icon",this.O_);this.Mzf();this.sxe()};e.prototype.Nzf=function(){ca.ULS.sendTraceTag(591196512,0,50,"PrintPreviewManager.OnPrintButtonClick: User changed printSettings {0} times before clicking on print button.",this.O_);ua.EwaSettings.isChangeGateEnabled("OfficeVSO:5466517_AddPageMarginLogs")&&ca.ULS.sendTraceTag(543024129,
0,50,"PrintPreviewManager.OnPrintButtonClick: Current margin value : {0}, Initial margin value : {1}",this.pk.margin,this.pH.margin);if(this.useMSPdfViewer)this.RHf();else if(this.p6a)try{this.kg.printPdf(),this.j0c()}catch(Pb){ca.ULS.sendTraceTag(574482433,0,15,"PrintPreviewManager.OnPrintButtonClick: Unable to print. Opening the window."),this.RHf()}else this.aia.Z2f(this.uHa(!0)),this.j0c()};e.prototype.RHf=function(){var Pb=this.uHa(!0);this.j0c();sa.HelperMethods.Ze(Pb,void 0,void 0,"PrintPreviewManager.CreateFileCopyFileHandlerURL")};
e.prototype.dispose=function(){Aa.a.Ia(this.Pa)};e.prototype.fyb=function(){var Pb=this;if(this.$.mwa)this.Nci();else{this.WX();this.VSf();var sc=null;this.w$h();ca.ULS.sendTraceTag(593266766,0,50,"PrintPreviewManager:InvokeGetFileCopyFileHandler - Invoking GetFileCopyFileHandler");var nb=function(pc,Dc,oc){pc=new Wa.a(pc,null,Dc,oc,null,!0,!1,"GetFileCopyFileHandler","");pc.correlationID=Ha.a.create().toString();sc=pc;Pb.Pba=Pb.S2.A9(Pb.uHa(Pb.p6a?!1:!0,Pb.lei?"Base64":"Pdf"),1,null,null,e.j$c,!1,
2,Pb.lzd,Pb.kzd,sc,void 0,void 0,void 0,12E4);pc.requestId=Pb.Pba;ca.ULS.sendTraceTag(537154264,0,50,"PrintPreviewManager.InvokeGetFileCopyFileHandler: Creating request with id: {0}.",Pb.Pba);return ma.Task.Ua(!0)};this.RMa=ua.EwaSettings.Zb()?this.$.userOperationManager.Sb(new vb.a(223,0,nb,80),null):this.$.userOperationManager.Sb(new cb.a(223,0,nb,16),null)}};e.prototype.j0c=function(){this.Mzf();this.sxe()};e.prototype.pAd=function(Pb){Ob.a.Uq(Pb.Errors)?this.kg.showErrorMessageForPrintOptions(oa.a.instance.ga(1242)):
(ca.ULS.sendTraceTag(537154263,0,50,"PrintPreviewManager.OnPrintOptionsUpdationSuccess: SetPrintOptions server call is successful."),this.fyb(),this.kg&&this.kg.hideErrorMessageForPrintOptions())};e.prototype.yAd=function(Pb){this.kg&&this.kg.showErrorMessageForPrintOptions(oa.a.instance.ga(1242));Pb=za.a.Mf(Pb.data);ca.ULS.sendTraceTag(537154262,0,10,"PrintPreviewManager.OnSavePrintOptionsToFileFailure: Save print options to file failed. Errors: {0}.",Ob.a.Ec(Pb))};e.prototype.Nci=function(){function Pb(pc,
Dc,oc){var Gc={};Gc.WhatToPrint=sc.pk.tv;Gc.UseNamedAction=sc.aia.Swc();Gc.SelectedSheetName=sc.$.va.pa.name;Gc.ActiveCell=sc.activeCell;Gc.SelectedRanges=[sc.selectedRange];Gc.IsPdfDocumentRequired=!1;Gc.Orientation=sc.pk.orientation;Gc.PaperSize=sc.pk.yca;Gc.Scaling=sc.pk.i0;Gc.RichValuesEnabled=!0;Gc.IgnorePrintArea=sc.pk.ignorePrintArea;Gc.Preview=!0;sc.isUniversalPrintEnabled&&(Gc.NoColor=sc.pk.NoColor);sc.D0f()&&(Gc.PaginationStartPage=sc.Gya,Gc.PaginationEndPage=sc.ema,Gc.OutputTotalPdfPageCount=
!0);var ld=sc.Zu.Wed(sc.pk.margin);ld&&(Gc.PageMargin={},Gc.PageMargin.Top=ld.Top,Gc.PageMargin.Bottom=ld.Bottom,Gc.PageMargin.Left=ld.Left,Gc.PageMargin.Right=ld.Right,Gc.PageMargin.Header=ld.Header,Gc.PageMargin.Footer=ld.Footer);sc.q7a=Q(sc.$.oa.xa,Gc,ab.b(sc.$Hi,pc),ab.a(sc.ZHi,Dc),oc,nb);return sc.q7a}var sc=this;ca.ULS.sendTraceTag(553649883,0,50,"PrintPreviewManager:InvokeConvertWorkbookToPrintPdf - Invoking ConvertWorkbookToPrintPdf");this.WX();var nb=this.$.oa.xa.Pb();ua.EwaSettings.Zb()?
this.RMa=this.$.userOperationManager.Sb(new vb.a(133,0,Pb,80),null):this.RMa=this.$.userOperationManager.Sb(new cb.a(133,0,Pb,16),null)};e.prototype.sxe=function(){this.$.userOperationManager.so(this.vz);this.WX();this.VSf();ca.ULS.shipAssertTag(537154261,0,!!this.kg,"PrintPreviewManager.cleanUpPrintPreviewPanes: printPreviewPane should not be null");this.kg&&(this.kg.nbj(this.azf),this.kg.cgh(),this.kg=null);this.Em=null;this.Zu&&(this.Zu.dispose(),this.Zu=null);this.N2a=this.yFb=null;this.CKc=!1;
this.Pa&&this.Pa.raiseEvent("ppocek")};e.prototype.Yvj=function(){return this.$.isEditMode&&!!this.pH&&!!this.pk&&2!==this.pk.tv&&this.Zhd()};e.prototype.BLd=function(){ca.ULS.shipAssertTag(537154260,0,!!this.Zu,"PrintPreviewManager.SavePrintSettings: printSettingsManager should not be null");this.Zu&&this.Zu.BLd(this.pk,this.Yvj())};e.prototype.uHa=function(Pb,sc){sc=void 0===sc?"Pdf":sc;var nb=new Sys.StringBuilder;nb.append(qb.a(this.$,sc,!0));ta.a.Pg(nb,La.a.$Ed,""+this.pk.tv);Pb&&this.aia.Swc()&&
ta.a.Pg(nb,La.a.Fdg,"1");ta.a.Pg(nb,La.a.mJf,this.$.va.pa.name);0===this.pk.tv&&(ta.a.Pg(nb,La.a.lJf,this.selectedRange),ta.a.Pg(nb,La.a.fJf,this.activeCell));ta.a.Pg(nb,La.a.gJf,""+this.pk.orientation);ta.a.Pg(nb,La.a.hJf,""+this.pk.yca);ta.a.Pg(nb,La.a.kJf,""+this.pk.i0);ta.a.Pg(nb,La.a.jJf,"1");ta.a.Pg(nb,La.a.eJf,this.pk.ignorePrintArea?"1":"0");ta.a.Pg(nb,La.a.iJf,"1");this.GJg(nb);this.isUniversalPrintEnabled&&ta.a.Pg(nb,La.a.Z1i,this.pk.NoColor?"1":"0");this.FJg(nb);Cb.a.equals(sc,"Pdf",!0)&&
(nb.append("&#toolbar=0"),nb.append("&zoom=100"));Pb=nb.toString().replace("GetFileCopyFileHandler.aspx?","GetFileCopyFileHandler.aspx/?");ca.ULS.sendTraceTag(537154259,0,50,"PrintPreviewManager: Print Pdf Url {0}",Pb);return Pb};e.prototype.arj=function(Pb,sc){Pb||sc?(this.zyb=!0,this.Gya=Pb,this.ema=sc):this.hSf()};e.prototype.GJg=function(Pb){this.D0f()&&(ta.a.Pg(Pb,La.a.a2i,""+this.Gya),ta.a.Pg(Pb,La.a.$1i,""+this.ema),ta.a.Pg(Pb,La.a.b2i,"1"),ca.ULS.sendTraceTag(537154258,0,50,"PrintPreviewManager: AppendPaginationQueryParameter Print Pdf page range from {0} to {1}",
this.Gya,this.ema))};e.prototype.D0f=function(){return null!=this.Gya&&0<this.Gya&&null!=this.ema&&0<this.ema};e.prototype.FJg=function(Pb){if(this.Zu&&this.pk){var sc=this.Zu.Wed(this.pk.margin);sc&&ta.a.Pg(Pb,La.a.Y1i,""+sc.Top+" "+sc.Bottom+" "+sc.Left+" "+sc.Right+" "+sc.Header+" "+sc.Footer)}};e.prototype.aEb=function(Pb,sc,nb,pc){this.kg&&(ca.ULS.shipAssertTag(537154255,0,!!this.$.va.pa,"PrintPreviewManager.OnConvertWorkbookToPdfSucceeded: ewaControl.Sheets.ActiveItem should not be null"),this.$.va.pa&&
(this.p6a?(pc||(pc=this.uHa(!1)),this.kg.tsi(pc)):this.cAj()))};e.prototype.Zhd=function(){return!this.pH.equals(this.pk)};e.prototype.Mzf=function(){!this.BMb&&0<this.O_&&(this.Nod?this.BLd():ca.ULS.sendTraceTag(537154251,0,50,"PrintPreviewManager:OnPreviewerClose - Previewer is being closed without settings pane being loaded."));ca.ULS.shipAssertTag(537154250,0,!!this.kg,"PrintPreviewManager.OnPreviewerClose: printPreviewPane should not be null");this.kg&&this.kg.M5h();this.ZVd()};e.prototype.hj=
function(){ca.ULS.sendTraceTag(593294036,0,50,"PrintPreviewManager.ShowErrorDialog: Error Dialog displayed.");if(this.kg){var Pb=this.zQa(oa.a.instance.ga(1));this.CAa(Pb,1)}else Pb=Ob.a.Xc(1,0,26,0,1,-1100324317,"GetPrintSettingsFailedError"),ua.EwaSettings.kz()?new Zb.a(this.$,Pb):(new Za.ErrorDialog(this.$,Pb)).gf()};e.prototype.jAj=function(Pb){Pb?(0===Pb.tv&&this.rwc()&&(ca.ULS.sendTraceTag(537154249,0,50,"PrintPreviewManager.ShowPrintPreviewer: Falling back to ActiveSheet because current selection is a ${0}.",
this.Em.ObjectId?"floatingObject":"discontinuousRange"),Pb.tv=1),z.rBe(Pb,this.pH),z.rBe(Pb,this.pk),ca.ULS.shipAssertTag(537154248,0,!!this.kg,"PrintPreviewManager.ShowPrintPreviewer: printPreviewPane should not be null"),this.kg&&(this.Nod=!0,this.kg.lAj(),this.fyb())):(ca.ULS.sendTraceTag(537154247,0,10,"PrintPreviewManager.ShowPrintPreviewer: printSettings fetched from server is null."),this.hj())};e.prototype.f_c=function(Pb,sc,nb){Pb>sc&&(sc=Object(ha.a)(new Ab.a,{extendedProperties:new Map}),
sc.extendedProperties.set("WtpSelectedValue",nb),sc.extendedProperties.set("FullyRenderedPdfLoadTime",Pb.toString()),Na.Health.instance.recordQosError(Qa.a.fCj,[Db.a.f4f],!1,!0,!0,!1,sc))};e.prototype.WX=function(){this.RMa&&(0<this.Pba||this.q7a)&&(ca.ULS.sendTraceTag(537154246,0,50,"PrintPreviewManager.AbortOutstandingUserOperation: Cancelling request with id: {0}.",this.Pba),this.$.userOperationManager.uta(this.RMa),this.q7a?za.a.ku(this.q7a.Dt):this.S2.ku(this.Pba),this.iKd())};e.prototype.iKd=
function(){this.q7a=this.RMa=null};e.prototype.w$h=function(){this.wJd&&this.pk&&(this.N2a=this.$.Fb.sc("UserAction",(1===this.pk.tv?"ActiveSheet":0===this.pk.tv?"CurrentSelection":"EntireWorkbook")+"FullyRenderedPdfLoadTimeStopwatch"))};e.prototype.hSf=function(){this.zyb=!1;this.Gya=1;this.ema=this.kEd};e.prototype.zQa=function(Pb){if(Pb)return Pb.replace("&#39;","'");ca.ULS.sendTraceTag(537154245,0,15,"PrintPreviewManager.SanitizeErrorMessage: error message is null");return Pb};e.prototype.cAj=
function(){ca.ULS.sendTraceTag(537154244,0,50,"PrintPreviewManager.ShowPdfRenderingError invoked");if(this.Azb)ca.ULS.sendTraceTag(537154243,0,10,"PrintPreviewManager.ShowPdfRenderingError: Called when preview was supported in both host & browser");else{var Pb=this.zQa(oa.a.instance.ga(1197));this.CAa(Pb,3)}};e.prototype.CAa=function(Pb,sc,nb){this.kg.Iz(Pb,sc,void 0===nb?null:nb)};e.prototype.H$h=function(){this.p6a=this.Azb=this.yWg();ca.ULS.sendTraceTag(557061534,0,50,"PrintPreviewManager.InitializeIsPdfPreviewSupportedVars: isPdfPreviewSupportedInCurrentHost: {0}, isPdfPreviewSupportedInPreviewer: {1}",
this.Azb,this.p6a)};e.prototype.tfj=function(){this.n7a=null;this.iKd();this.hSf();this.yFb=this.$.Fb.sc("UserAction","paneLoadTimeStopwatch");this.activeCell=this.$.pa.activeCell.toString();this.O_=0;this.Nod=this.I5a=this.BMb=!1;this.CKc=!0};e.prototype.Vxj=function(){var Pb=this.Vmi()||this.Fgf()&&ua.EwaSettings.isChangeGateEnabled("OfficeVSO:6059097_EnablePreviewer3rdParty")?!0:!1;ca.ULS.sendTraceTag(537154242,0,50,"PrintPreviewManager.ShouldUseMSPdfViewer : {0}",Pb);return Pb};e.prototype.fWg=
function(){var Pb=15;Ga.a.xH&&Ga.a.Bsb&&(Pb=parseFloat(Ga.a.Bsb));return 14<Pb&&this.Azb};e.prototype.yWg=function(){return this.Fgf()&&!ua.EwaSettings.isChangeGateEnabled("OfficeVSO:6059097_EnablePreviewer3rdParty")?!1:!0};e.prototype.Vmi=function(){return Ga.a.HC||ea.AFrameworkApplication.isUnifiedHostMode};e.prototype.Fgf=function(){return!this.$.Jf.get(111)};e.prototype.VSf=function(){this.n7a&&(URL.revokeObjectURL(this.n7a),this.n7a=null)};e.prototype.v4g=function(Pb){var sc=Pb.data.Td;Pb=this.$.Fb.sc("UserAction",
"PrintPreviewBlobFileCreation");var nb=window.self.atob(sc);sc=new Uint8Array(sc.length);for(var pc=0;pc<nb.length;pc++)sc[pc]=nb.charCodeAt(pc)&255;nb=new Blob([sc],{type:"application/pdf"});this.n7a=URL.createObjectURL(nb);ca.ULS.sendTraceTag(537154241,0,50,"PrintPreviewManager:OnFileHandlerSuccessCallback - Blob created. Total time to create : {0} ms. Blob size: {1}",Pb.qc,nb.size);Pb.stop();return this.n7a+"#toolbar=0&zoom=100"};e.prototype.a6i=function(Pb){if(this.wJd&&Ob.a.Zg(Pb,e.VWi)){var sc=
Object(ha.a)(new Ab.a,{extendedProperties:new Map});sc.extendedProperties.set("ErrorMessageIdName",Pb[0].MessageIdName);Na.Health.instance.recordQosError(Qa.a.PHf,[Db.a.QHf],!1,!0,!0,!1,sc)}};e.prototype.A4h=function(Pb,sc){return Pb.sheetPrintOptions.PrintGrid!==sc.selectedPrintGridlines||Pb.sheetPrintOptions.HorizontalCenter!==sc.selectedHorizontalCenter||Pb.sheetPrintOptions.VerticalCenter!==sc.selectedVerticalCenter||Pb.sheetPrintOptions.PrintHeaders!==sc.selectedRowAndColumnHeadings};e.prototype.ZVd=
function(){this.Mod&&this.$.Fd(-1753588160,-1,0,null)};e.prototype.sei=function(){return!!this.$.ya&&!!this.$.ya.DocumentHostInfo&&"TestHost"===this.$.ya.DocumentHostInfo.HostTier};e.prototype.getToken=function(){ca.ULS.sendTraceTag(522314589,0,50,"PrintPreviewManager:GetToken: Token requested for universal print graph service");return this.xDb.xO("Print",this.graphServiceEndpoint).then(function(Pb){return Pb?(Pb.IsSuccess||ca.ULS.sendTraceTag(537154240,0,15,"PrintPreviewManager:GetToken: failed to get token. Error code: {0}, Error message : {1}",
Pb.ErrorCode,Pb.ErrorMessage),ca.ULS.sendTraceTag(522314588,0,50,"PrintPreviewManager:GetToken: successfully acquired token for universal print graph service"),Pb):Object(ha.a)(new Vb.a,{IsSuccess:!1,ErrorMessage:"Missing result object",ErrorCode:"need_result"})}).catch(function(Pb){var sc=new Vb.a;Object.getType(Pb)===Object.getType(sc)?sc=Pb:(sc.ErrorMessage=Pb.toString(),sc.ErrorCode="exception");return Promise.resolve(sc)})};e.prototype.M$b=function(){var Pb=this;return function(){var sc=Promise.resolve("");
try{if(Pb.xDb&&Pb.xDb.w5a())return Pb.getToken().then(function(nb){return nb.IsSuccess?Promise.resolve(nb.Token):sc},function(){return sc})}catch(nb){ca.ULS.sendTraceTag(537154211,0,10,"PrintPreviewManager:GetAuthTokenDelegate - Exception thrown while fetching token",nb)}return sc}};e.prototype.onNotifyPrintJobStatus=function(Pb,sc){Pb=Ac.a.qA.notificationBar.J$(Pb,!1);"pending"==sc&&(Pb.displayTimeoutSeconds=3);if(ua.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactToast",!1))switch(sc){case "failure":Pb.image=
1;break;case "success":Pb.image=3;break;default:Pb.image=0}else Pb.image=0;Ac.a.qA.notificationBar.OD(Pb)};Mf.Object.defineProperties(e.prototype,{jki:{configurable:!0,enumerable:!0,get:function(){return this.CKc}}});e.VWi=[-953554093,1773721536,-1104435974,-1243918982,1205917367,1931972532,1294226134,1239184329,1207537900,-1053855722,-2077518688,1348242499,2030854436,-1831476778];e.j$c=["Content-Type","Total-Pdf-PageCount"];Object(fa.a)(e,"PrintPreviewManager",null,[702,3,703]);d.prototype.Lc=function(){return!1};
d.prototype.executeCommand=function(Pb,sc,nb,pc){var Dc=sc.command;return 1588554917===Dc?(sc.Jyb=!0,db.a(this.$)&&this.$.da.za(423).jxc(!1),this.Dgh(sc)?ma.Task.Ua(!0):ba.a(Dc)):this.NHf.executeCommand(Pb,sc,nb,pc,this.TOi,this.SOi,this.jLj)};d.prototype.zc=function(Pb,sc){return 1588554917===sc.command?(ca.ULS.shipAssertTag(537154305,0,this.$.ika,"Command execute requested for Print operation when data duplication is disallowed."),!0):this.NHf.zc(Pb,sc)};d.prototype.Qc=function(){return!1};d.prototype.Dgh=
function(Pb){return this.$.ea.dc?this.Egh(Pb):!1};d.prototype.Egh=function(Pb){ca.ULS.sendTraceTag(21099871,0,50,"PrintCommandHandler:DoPrintHtml");var sc=this.$.Fb.sc("UserAction","DoPrintHtml"),nb=this.$,pc=this.ea.isNamedObjectViewMode?nb.vb.pa.sheetName:nb.va.pa.name,Dc=this.ea.isNamedObjectViewMode,oc=!Dc;nb=this.UTh(nb,pc,oc);var Gc=!0;!ua.EwaSettings.isChangeGateEnabled("OfficeVSO:5315453_MoveWebpartsSessionsToPreviewer")&&this.$.mwa&&(Gc=!1);oc?Gc?Ka.a(this.$)?ca.ULS.sendTraceTag(537154304,
0,50,"PrintCommandHandler:DoPrintHtml - Print previewer is already opened."):(this.dD.iAj(nb,this.BN),ca.ULS.sendTraceTag(591196515,0,50,"PrintCommandHandler:DoPrintHtml Print previewer opened")):((new K(this.$,oa.a.instance.ga(1205),3,nb,Pb,this.aia,pc,this.BN)).gf(),ca.ULS.sendTraceTag(595194760,0,50,"PrintCommandHandler:DoPrintHtml Print dialog shown in pdf mode in {0} ms.",sc.qc)):((new M(this.$,oa.a.instance.ga(1205),3,nb,Pb)).gf(),ca.ULS.sendTraceTag(591196514,0,15,"PrintCommandHandler:DoPrintHtml Print dialog shown in html mode in {0} ms. isNamedObjectViewMode: {1}.",
sc.qc,Dc));sc.stop();this.nhd();return!0};d.prototype.UTh=function(Pb,sc,nb){var pc={};pc.SessionId=this.ea.sessionId;pc.UsedRangeTooBig=!1;var Dc=ra.g(Pb),oc=Dc.ha,Gc=oc.Pe;if(Xa.e(Pb.pa))pc.Type=0,pc.ObjectId=Pb.pa.name,pc.UseSelection=!1;else if(Xa.g(Pb.pa))pc.Type=1,pc.ObjectId=Pb.pa.dLa,pc.UseSelection=!0;else if(2===Gc||4===Gc||64===Gc)Dc=oc.Oa.Yb.floatingObject,pc.Type=1,pc.SheetName=sc,pc.ObjectId=Dc.id,pc.UseSelection=!0;else if(nb&&Gc&470)pc.ObjectId=oc.Oa.Yb.floatingObject.id,pc.SheetName=
sc;else if(Xa.i(Pb.pa)){pc.Type=2;pc.SheetName=sc;if(oc.sa.sg)if(nb=oc.sa.Vc,pc.SelectedRanges=aa.q(nb,Pb),20<nb.EG)pc.UseSelection=!0;else{sc=0;Dc=Dc.Xj("PrintCommandHandler.DoPrintHtml",nb);try{for(Dc.$$rst();Dc.$$mn()&&2>sc;)Dc.$$cu().text&&sc++;pc.UseSelection=2<=sc}finally{Dc&&Dc.dispose()}}else pc.UseSelection=!1,pc.SelectedRanges=aa.q(oc.sa.activeRange,Pb);this.ea.isNamedObjectViewMode&&(pc.UsedRange=aa.v(Pb.pa.usedRange,Pb))}pc.Title=Pb.workbookContext.WorkbookFileName;return pc};d.prototype.nhd=
function(){ra.g(this.$);if(!this.L0f){this.iQc=!0;var Pb=this.$.Fb.sc("UserAction","HandlePageLayoutRendering");this.BLj();ca.ULS.sendTraceTag(537154274,0,50,"PrintCommandHandler:HandlePageLayoutRendering rendering is done in {0} ms.",Pb.qc);Pb.stop()}};d.prototype.BLj=function(){for(var Pb=ra.g(this.$).Ea,sc=Pb.FE(),nb=!1,pc=0,Dc=0;Dc<sc.length;Dc++){var oc=sc[Dc],Gc=oc.lf;Gc&&Gc.hasPageLayout()&&(nb=!0,Gc.setDirty("PrintCommandHandler::TriggerPageLayoutRendering, hash: "+oc.Kd,4),pc++)}nb&&(ca.ULS.sendTraceTag(537154273,
0,50,"PrintCommandHandler:TriggerPageLayoutRendering number of total cached blocks is {0}, number of blocks that require re-rendering is {1}",sc.length,pc),Pb.wxd())};Mf.Object.defineProperties(d.prototype,{L0f:{configurable:!0,enumerable:!0,get:function(){return this.iQc}}});Object(fa.a)(d,"PrintCommandHandler",null,[429,669]);var Rc=b(1278),Fc=b(1489),wb=b(1490),uc=X.a;Rk(c,uc);c.prototype.Ad=function(){var Pb=this,sc=ea.AFrameworkApplication.fa.appSettings,nb=this.$.ya.DirectPrintSetting;sc.DirectPrintIsEnabled=
nb.DirectPrintIsEnabled.toString();sc.DirectPrintProbeIsEnabled=nb.DirectPrintProbeIsEnabled.toString();sc.DirectPrintEnabledForInternetExplorer=nb.DirectPrintEnabledForInternetExplorer.toString();sc.DirectPrintSupportedMimeTypes=nb.DirectPrintSupportedMimeTypes;sc.DirectPrintSupportedPlugins=nb.DirectPrintSupportedPlugins;sc.DirectPrintImmersivePreviewPlugins=nb.DirectPrintImmersivePreviewPlugins;sc.DirectPrintMinimalSupportedEdgeVersion=nb.DirectPrintMinimalSupportedEdgeVersion;sc.DirectPrintEnabledForEdge=
nb.DirectPrintEnabledForEdge.toString();sc=new Rc.a(sc);var pc=null;nb=null;try{nb=window.navigator.mimeTypes}catch(Gc){ca.ULS.sendTraceTag(537154270,0,15,"Failed to get Window.Navigator.mimeTypes")}var Dc=null;try{Dc=window.navigator.plugins}catch(Gc){ca.ULS.sendTraceTag(537154269,0,15,"Failed to get Window.Navigator.plugins")}pc=new wb.a(sc,nb,Dc,wb.a.Fbf,wb.a.igf,new Fc.a(ea.AFrameworkApplication.ta.aX),ea.AFrameworkApplication.ta.pD,wb.a.jgf,function(Gc,ld){return new wa.a(Gc,!1,ld)},!1);if(ua.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UniversalPrint",
!1)&&this.$.Jf.get(116)){var oc=ja.GetServiceTaskFactory.Ra(this.$.da,349,350,this.hb);va.TaskExtensions.Aa(oc,function(){var Gc=new d(Pb.$,pc,oc.result);Pb.jd([Gc])},this.$.la)}else this.jd([new d(this.$,pc,null)])};c.ka=function(Pb){X.a.Qd(73,new c(Pb))};Object(fa.a)(c,"PrintCommandHandlerFactory",X.a,[]);b.d(E,"a",function(){return a})},1346:function(u,E,b){function a(){H.a.Fa(function(uc){uc.da.Ga(57,new c(uc));uc.da.Ga(60,new G(uc));uc.da.Ga(63,new T(uc))})}function c(uc){var Pb=wb.call(this)||
this;Pb.$=uc;uc.da.Ga(56,new e(uc));Pb.Eb();return Pb}function d(uc,Pb){return Fc.call(this,uc,Pb)||this}function e(uc){var Pb=ac.call(this)||this;Pb.$=uc;Pb.Eb();e.C0g();return Pb}function k(uc,Pb,sc){var nb=l.call(this,!0)||this;nb.Pa=new Ha.a;nb.CTe=!1;nb.e6c=!1;nb.Iye=null;nb.um=null;nb.a3b=null;nb.Uc=function(){wa.a.wg(aa.a(nb.$).fd.activityState,ra.a.Zxd)||nb.lua.reset()};nb.YIi=function(pc){nb.MQf(pc)};nb.XIi=function(){nb.Tyj()};nb.$=uc;nb.ea=uc.ea;nb.OJ=Pb;nb.businessBar=sc;nb.ea.Vj(nb.Uc);
nb.lua=J.Are(nb.$);nb.D0g();uc.da.Ga(55,nb);nb.Zfa=sa.a.instance.Tb("Common.ISystemInitiatedFeedback");return nb}function l(uc){this.Gfa=this.o4d=this.FUa=null;this.jib=!1;this.lMc=this.obe=null;this.YQb=this.xD=this.lWb="";this.application=this.NB=0;this.eGj=this.ETd=!1;this.JTj=uc&&qa.AFrameworkApplication.fa.qa("OICLaunchDialogIsEnabled");qa.AFrameworkApplication.ub.Y3(za.a.mQa)||qa.AFrameworkApplication.ub.Mb(za.a.mQa,ta.a.frame,Object(da.a)(this,this.Vgj,"retryOpenInClientAction"));this.I3f=
!!qa.AFrameworkApplication.fa&&qa.AFrameworkApplication.fa.qa("SilentExternalHandler")}function n(){}function f(){}function v(uc){var Pb=Cb.call(this)||this;Pb.Zp=uc;Pb.ye="ProtocolLaunchingDialog";qa.AFrameworkApplication.yi.H4a&&qa.AFrameworkApplication.yi.ntc();qa.AFrameworkApplication.ta.Qa.Egd&&Pb.vke(CommonUIStrings.l_OICStandardDialogSectionGiveFeedback,Object(da.a)(Pb,Pb.Omc,"onGiveFeedbackClick"));v.w5e?(Pb.Rb=12,Pb.mc(1,CommonUIStrings.l_CloseFile),Pb.mc(2,CommonUIStrings.l_OICDialogContinueHere),
Pb.mc(3,CommonUIStrings.l_OICDialogLaunchAgain)):(Pb.Rb=4,Pb.mc(1,CommonUIStrings.l_OICDialogContinueHere),Pb.mc(2,CommonUIStrings.l_OICDialogLaunchAgain));Pb.ACb(CommonUIStrings.l_OICDialog2ndTitle,5===Pb.Zp.LDf?CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICStandardDialogSectionTitle,null,null,Object(da.a)(Pb,Pb.PEd,"protocolLaunchingDialogResultHandler"),null);return Pb}function r(uc){var Pb=yb.call(this)||this;Pb.Nea=null;Pb.yUa=null;Pb.Cpa=!1;Pb.gpa=null;Pb.Zp=uc;Pb.Vf=y.Vf;Pb.cse=
!0;Pb.Rb=5;Pb.ye="ProtocolLaunchingDialog";Pb.wGc="OICRetryDialog";qa.AFrameworkApplication.yi.H4a&&qa.AFrameworkApplication.yi.ntc();qa.AFrameworkApplication.yi.Dg(new qb.a(2,1,5E3,function(){Pb.switchToBackupMode()},101));Pb.showDialog("",Object(da.a)(Pb,Pb.PEd,"protocolLaunchingDialogResultHandler"));Pb.$Yf();Pb.PW("Issues");Pb.pTe();Q.ULS.sendTraceTag(19239262,211,50,"OIC dialog launched");document.getElementById("WACDialogTitlePanel").className+=" OICDialog";return Pb}function y(){}function m(uc){var Pb=
Wa.call(this)||this;Pb.tCa=null;Pb.zUa=null;Pb.Cpa=!1;Pb.Zp=uc;Pb.Vf=w.Vf;Pb.cse=!0;Pb.Rb=5;Pb.ye="OICLaunchDialog";Pb.showDialog("",Object(da.a)(Pb,Pb.ZEi,"oicLaunchDialogResultHandler"));Pb.$Yf();Pb.PW("ProtocolLaunchingDialogTitle");4!==qa.AFrameworkApplication.ta.Qa.editMode&&(document.getElementById("ProtocolLaunchingDialogTitle").innerText=CommonUIStrings.l_OICLaunchDialogTitleForView);Pb.kI(Pb.tCa);Q.ULS.sendTraceTag(22140865,211,50,"OIC launch dialog opened");document.getElementById("WACDialogTitlePanel").className+=
" OICDialog";return Pb}function w(){}function B(uc,Pb,sc,nb,pc){var Dc=document.createElement("img");Dc.alt=uc;Dc.className=La.getImageClassWithCluster(sc,nb);Dc.src=Pb;Dc.setAttribute(vb.a.Hd,vb.a.Gs);uc=document.createElement("span");uc.className="ProtocolLaunchingDialogImg32Container";uc.appendChild(Dc);Dc=document.createElement("span");Dc.className="ProtocolLaunchingDialogIconContainer";Dc.appendChild(uc);pc.appendChild(Dc)}function A(uc,Pb,sc,nb,pc,Dc,oc){var Gc=document.createElement("a");Gc.className=
"ProtocolLaunchingDialogButtonAnchor";Gc.className+=" OICDialog";Gc.id=uc;Gc.setAttribute(vb.a.Hd,vb.a.Fs);Gc.style.padding="0";Gc.style.margin="0";nb&&B(pc,Pb,sc,nb,Gc);uc=document.createElement("span");uc.className="ProtocolLaunchingDialogButtonLabel";uc.innerText=pc;Gc.appendChild(uc);Gc.tabIndex=0;Dc&&zb.a.instance.ra(Fb.a.click,Gc,Dc);oc&&kb.KeyInputManager.instance.ra(Fb.a.Gd,Gc,oc);return Gc}function z(uc){return uc.Ca.keyCode===Yb.a.Oh||uc.Ca.keyCode===Yb.a.Doa?(uc.zb.click(),!0):!1}function x(uc){for(var Pb=
0;Pb<uc.children.length;Pb++){var sc=uc.children[Pb];sc.style.position="relative";sc.style.top=(sc.parentNode.offsetHeight-sc.offsetHeight)/2+"px"}}function D(){}function I(uc,Pb,sc){var nb=this;this.La=uc;this.Gqg=Pb;this.sEc=null;(this.rXb=qa.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1))&&sa.a.instance.Tb("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(pc){nb.sEc=pc});this.B1=
sc}function F(uc,Pb,sc){this.La=uc;this.Cqg=Pb;this.B1=sc}function G(uc){var Pb=xa.call(this)||this;Pb.$=uc;Pb.Eb();return Pb}function T(uc){var Pb=Ga.call(this)||this;Pb.$=uc;Pb.Eb();return Pb}function O(uc,Pb,sc){sc=void 0===sc?!1:sc;var nb=Ka.call(this,uc,Pb)||this;nb.bCb=null;nb.qAd=function(pc){nb.unsubscribe(function(Dc){pc.remove_disposing(Dc)});nb.kh(ua.a.Dk);nb.$o()};nb.dkc=sc;return nb}function U(uc,Pb){var sc=this;this.Uc=function(){wa.a.wg(aa.a(sc.$).fd.activityState,ra.a.Zxd)||sc.lua.reset()};
this.$=Pb;this.dkc=uc;this.ea=Pb.ea;this.ea.Vj(this.Uc);this.lua=J.Are(this.$)}function J(uc,Pb){var sc=oa.call(this,uc)||this;sc.FTj=["id","sessionId","workbookType","workbookFileType","dataloss"];sc.command=0;sc.mEb=function(){var nb=sc.iNh();if(nb){sc.$.XH(!0);if(-2028960985!==sc.command&&1461300262!==sc.command){var pc=aa.a(sc.$).fd.activityState;pc[Xa.a.XXa]=ua.a.download;pc[ba.a.dTc]=sc.command}va.a(sc.$).nr(nb.Errors)}};sc.iframe=uc;sc.$=Pb;sc.Ac.ka("load",sc.mEb);return sc}var H=b(10),K=b(0),
N=b(232),M=b(51),C=b(37),Q=b(14),P=b(89),ka=b(85),R=b(249),fa=b(718),ca=b(216),ea=b(121),wa=b(34),X=b(39),ja=b(244),va=b(42),ua=b(6),Xa=b(35),aa=b(67),ba=b(651),oa=ja.a;Rk(J,oa);J.prototype.downloadFile=function(uc,Pb){var sc={};(uc=this.yxh(uc,sc))&&X.a.Epc("dlfr",uc,sc);this.command=Pb};J.prototype.yxh=function(uc,Pb){var sc=uc.split("?");if(2!==sc.length)return uc=null,Q.ULS.sendTraceTag(537154816,0,15,"FileLoader.ExtractParametersFromUriToDictionary: unable to parse URI (missing '?')"),uc;sc=
sc[1].split("&");sc=bk(sc);for(var nb=sc.next();!nb.done;nb=sc.next()){var pc=nb.value.split("=",2);if(2!==pc.length){uc=null;Q.ULS.sendTraceTag(537154787,0,15,"FileLoader.ExtractParametersFromUriToDictionary: unable to parse URI (key value pair has no '=' sign)");break}nb=pc[0];Array.contains(this.FTj,nb)&&(pc=decodeURIComponent(pc[1]),Pb[nb]=pc,uc=ca.a.OHb(uc,nb))}return uc};J.prototype.reset=function(){this.iframe&&(this.iframe.src="about:blank");this.command=1461300262};J.prototype.iNh=function(){try{return this.iframe.contentWindow.ewaResult}catch(Pb){if(!this.$.ea.hc.isDivSyndicated){var uc=
window.document.referrer.match(RegExp("://(.[^/]+)/"));Q.ULS.sendTraceTag(537154785,0,50,"FileLoader.OnFrameLoad: parent domain: {0}, current domain: {1}, iframe domain: {2}. ewaControl IsCrossDomain: {3}",1<uc.length?uc[1]:"",escape(window.location.host),escape(this.iframe.contentWindow.location.host),this.$.mwa);throw Pb;}return null}};J.Are=function(uc){var Pb=document.createElement("iframe");Pb.id="ewaFileLoader";Pb.style.cssText="height:0;width:0;display:none";Pb.src="about:blank";Pb.setAttribute("name",
"dlfr");Pb=uc.domElement.appendChild(Pb);return new J(Pb,uc)};Mf.Object.defineProperties(J.prototype,{m7h:{configurable:!0,enumerable:!0,get:function(){return"loading"!=this.iframe.contentDocument.readyState&&"uninitialized"!=this.iframe.contentDocument.readyState}}});Object(K.a)(J,"FileLoader",ja.a,[]);var ra=b(147),db=b(58);U.prototype.jhh=function(){var uc=this,Pb=this.ERg(this.$),sc=this.$.userOperationManager.operationCount;0<sc&&Q.ULS.sendTraceTag(537154822,0,15,"flushing queue in downloadcopy. Queue is {0}",
sc);this.$.userOperationManager.T3("DownloadACopyOperation.DownloadForkedFile");this.dkc&&Q.ULS.sendTraceTag(537154821,0,50,"DownloadACopyOperation - Dataloss scenario");this.lua.downloadFile(Pb,-21742208);C.TaskExtensions.Aa(db.Task.delay(1),function(){uc.h8e()},this.lua.la,3)};U.prototype.dispose=function(){this.ea&&this.ea.wk(this.Uc);this.$=this.ea=null};U.prototype.h8e=function(uc){var Pb=this;(uc=void 0===uc?null:uc)||(uc=this.$.Fb.sc("LoadResource","DownloadACopyOperation"));!this.lua.m7h&&
uc.qc<U.dof?window.setTimeout(function(){Pb.h8e(uc)},U.khh):(uc.qc>=U.dof&&Q.ULS.sendTraceTag(537154820,0,15,"Download did not complete after 10 seconds."),aa.a(this.$).fd.eM())};U.prototype.ERg=function(uc){var Pb=new Sys.StringBuilder,sc=uc.workbookContext,nb=uc.ya;Pb.append(uc.Bda);Pb.append(nb.FileHandlerRelativeUri);Pb.append("?id=");Pb.append(encodeURIComponent(ca.a.OHb(sc.WorkbookUri,"sc")));uc.ea.dc&&(Pb.append("&sessionId="),Pb.append(encodeURIComponent(uc.ea.sessionId)));Pb.append("&workbookType=FullForkedWorkbook");
Pb.append("&dataloss=");Pb.append(this.dkc?"true":"false");ea.a.RYa(Pb,nb);return Pb.toString()};U.dof=1E5;U.khh=100;Object(K.a)(U,"DownloadACopyOperation",null,[3]);var Ka=R.a;Rk(O,Ka);O.prototype.execute=function(uc){var Pb=Object(ka.a)(4,uc.ue);if(!Pb.ika)return Q.ULS.sendTraceTag(537154818,0,50,"DownloadAForkedCopyActivity.Execute: blocking Download action as the workbook is protected"),this.sld(uc),this.kh(ua.a.idle),1;this.bCb||(this.bCb=new U(this.dkc,Pb));this.bCb.jhh();Q.ULS.shipAssertTag(537154817,
0,3!==aa.a(Pb).ii.Pt,"The current activity should not be closed.");return 1};O.prototype.sld=function(uc){var Pb=Object(ka.a)(4,uc.ue),sc=new fa.a(Pb);this.subscribe(uc,this.qAd,function(nb){sc.add_disposing(nb)});Q.ULS.sendTraceTag(50954707,0,50,"DownloadAForkedCopyActivity.ProtectedFileDataLeakErrorDialog: showing alert dialog to user");sc.initialize();sc.gf()};O.prototype.dispose=function(){P.a.Ia(this.bCb);this.bCb=null;Ka.prototype.dispose.call(this)};Object(K.a)(O,"DownloadAForkedCopyActivity",
R.a,[]);var Ga=N.a;Rk(T,Ga);T.prototype.create=function(){var uc=this;C.TaskExtensions.Aa(M.GetServiceTaskFactory.create(this.$.da,155,this.la,this.hb),function(){uc.pb(new O(ua.a.n1a,ua.a.Dk,!0))},this.la)};Object(K.a)(T,"DownloadACopyPreDatalossActivityFactory",N.a,[]);var xa=N.a;Rk(G,xa);G.prototype.create=function(){var uc=this;C.TaskExtensions.Aa(M.GetServiceTaskFactory.create(this.$.da,155,this.la,this.hb),function(){uc.pb(new O(ua.a.unmergeableDownloadCopy,ua.a.poa))},this.la)};Object(K.a)(G,
"DownloadAForkedCopyActivityFactory",N.a,[]);var da=b(84),qa=b(4),na=b(81),ia=b(27),ta=b(107),za=b(25);F.prototype.Bg=function(){this.La.Mb(za.a.tryMacOffice,ta.a.frame,Object(da.a)(this,this.USi,"onTryMacOffice"));this.La.Mb(za.a.C$f,ta.a.frame,Object(da.a)(this,this.VCf,"onTryMacOfficeFromViewer"));this.La.Mb(za.a.B$f,ta.a.frame,Object(da.a)(this,this.VCf,"onTryMacOfficeFromViewer"))};F.prototype.USi=function(uc,Pb,sc,nb,pc){if(1===sc)return 32;pc?(uc=pc.SourceControlId,"btnjTryMacOfficeForWordEditor"===
uc?X.a.Ze(na.a.nZ(12),"_blank",void 0,"MacOfficeOffer.TriggerFromWordEditor"):"PptJewel.About.TryMacOffice"===uc&&X.a.Ze(na.a.nZ(22),"_blank",void 0,"MacOfficeOffer.TriggerFromPPTEditor")):this.ajf();return 32};F.prototype.VCf=function(uc,Pb,sc){if(1===sc)return 32;switch(uc){case za.a.C$f:X.a.Ze(na.a.nZ(15),"_blank",void 0,"MacOfficeOffer.TriggerFromWordViewer");break;case za.a.B$f:X.a.Ze(na.a.nZ(25),"_blank",void 0,"MacOfficeOffer.TriggerFromPPTViewer")}return 32};F.prototype.ajf=function(){var uc=
void 0===uc?null:uc;var Pb=0;uc&&(Pb=uc);X.a.Ze(2===Pb?"https://go.microsoft.com/fwlink/?LinkId=331579":F.dxi,"_blank",void 0,"LaunchMacTrialWindow")};Mf.Object.defineProperties(F.prototype,{Cwc:{configurable:!0,enumerable:!0,get:function(){return this.Cqg&&ia.a.isMac&&!ia.a.cki&&!MSOJS.ClientUtils.IsO14MacPluginInstalled()}},vwj:{configurable:!0,enumerable:!0,get:function(){return this.Cwc}}});Mf.Object.defineProperties(F,{dxi:{configurable:!0,enumerable:!0,get:function(){return na.a.dH("522401")}}});
Object(K.a)(F,"MacOfficeOffer",null,[382]);var sa=b(83);I.prototype.Bg=function(){this.La.Mb(za.a.tryOffice,ta.a.frame,Object(da.a)(this,this.VSi,"onTryOffice"));this.La.Mb(za.a.tryOfficeThroughTellMe,ta.a.frame,Object(da.a)(this,this.tryOfficeThroughTellMe,"tryOfficeThroughTellMe"));this.La.Mb(za.a.F$f,ta.a.frame,Object(da.a)(this,this.G$f,"tryOfficeThroughViewer"));this.La.Mb(za.a.E$f,ta.a.frame,Object(da.a)(this,this.G$f,"tryOfficeThroughViewer"))};I.prototype.VSi=function(uc,Pb,sc,nb,pc){if(this.rXb&&
1===sc)return this.isFreemiumUpsellEnabled&&this.nLb?32:8;2===sc&&(pc?(uc=pc.SourceControlId,"btnjTryOfficeForWordEditor"===uc?X.a.Ze(na.a.nZ(11),"_blank",void 0,"OfficeTrial.TriggerFromWordEditor"):"PptJewel.About.TryOffice"===uc?X.a.Ze(na.a.nZ(21),"_blank",void 0,"OfficeTrial.TriggerFromPPTViewer"):this.fjc()):this.fjc());return 32};I.prototype.tryOfficeThroughTellMe=function(uc,Pb,sc,nb,pc){if(this.rXb&&1===sc)return this.isFreemiumUpsellEnabled&&this.nLb?32:8;2===sc&&(pc?(uc=pc.SourceControlId,
X.a.Ze(na.a.dH("862405")+this.ZSh(uc),"_blank",void 0,"TryOfficeThroughTellMe.WithSourceControlId")):X.a.Ze(na.a.dH("522402"),"_blank",void 0,"TryOfficeThroughTellMe.Legacy"));return 32};I.prototype.G$f=function(uc,Pb,sc){if(this.rXb&&1===sc)return this.isFreemiumUpsellEnabled&&this.nLb?32:8;if(2===sc)switch(uc){case za.a.F$f:X.a.Ze(na.a.nZ(14),"_blank",void 0,"TryOfficeThroughViewer.Word");break;case za.a.E$f:X.a.Ze(na.a.nZ(24),"_blank",void 0,"TryOfficeThroughViewer.PPT")}return 32};I.prototype.fjc=
function(uc){uc=void 0===uc?null:uc;var Pb=0;uc&&(Pb=uc);X.a.Ze(I.KQh(Pb),"_blank",void 0,"LaunchOfficeOffer")};I.prototype.ZSh=function(uc){var Pb=0;switch(uc){case "jbtnTryOfficeThroughTellMeForWordTrackChanges":Pb=1;break;case "jbtnTryOfficeThroughTellMeForWordShapes":Pb=2;break;case "jbtnTryOfficeThroughTellMeForWordLabel":Pb=3;break;case "jbtnTryOfficeThroughTellMeForWordCitations":Pb=4;break;case "jbtnTryOfficeThroughTellMeForWordTextBox":Pb=5;break;case "jbtnTryOfficeThroughTellMeForWordTableOfContent":Pb=
6;break;case "jbtnTryOfficeThroughTellMeForWordSmartArt":Pb=7;break;case "jbtnTryOfficeThroughTellMeForWordWordArt":Pb=8;break;case "jbtnTryOfficeThroughTellMeForWordMultiColumnLayout":Pb=9;break;case "jbtnTryOfficeThroughTellMeForWordEquation":Pb=10;break;case "jbtnTryOfficeThroughTellMeForPPTGroupShapes":Pb=16;break;case "jbtnTryOfficeThroughTellMeForPPTWordArt":Pb=17;break;case "jbtnTryOfficeThroughTellMeForPPTSpellCheckDict":Pb=18;break;case "jbtnTryOfficeThroughTellMeForPPTInsertAudio":Pb=19;
break;case "jbtnTryOfficeThroughTellMeForPPTInsertChart":Pb=20;break;case "TellMe.TryOfficeThroughTellMeForXLSSpellCheck":Pb=26;break;case "TellMe.TryOfficeThroughTellMeForXLSMacros":Pb=27;break;case "TellMe.TryOfficeThroughTellMeForXLSPivotTable":Pb=28;break;case "TellMe.TryOfficeThroughTellMeForXLSHeaderFooter":Pb=29}return 0===Pb?"":String.format("&pc={0:D}",Pb)};I.KQh=function(uc){if(ia.a.rh)switch(uc){case 1:return na.a.dH("393806");case 2:return na.a.dH("393810");case 3:return na.a.dH("393809");
case 5:return na.a.dH("393805")}else if(ia.a.To)switch(uc){case 1:return na.a.dH("521979");case 3:return na.a.dH("521980");case 5:return na.a.dH("521978");case 2:return na.a.dH("522490")}else{if(2===uc)return na.a.dH("517778");if(1===uc)return na.a.nZ(30)}return na.a.dH("522402")};Mf.Object.defineProperties(I.prototype,{Srf:{configurable:!0,enumerable:!0,get:function(){return this.nLb}},FEi:{configurable:!0,enumerable:!0,get:function(){return this.nLb&&MSOJS.ClientUtils.OfferOfficeInDialog()}},nLb:{configurable:!0,
enumerable:!0,get:function(){return this.Gqg&&!ia.a.isMac}},isFreemiumUpsellEnabled:{configurable:!0,enumerable:!0,get:function(){var uc=!1;this.sEc&&(uc=this.sEc.isFreemiumUpsellEnabled());return uc}}});Object(K.a)(I,"OfficeTrialExperience",null,[383]);D.prototype.Ph=function(uc){uc.register(I,"Common.App.OpenInClient.OfficeTrialExperience").as("Common.IOfficeTrialExperience").tc().Cc(function(){return new I(qa.AFrameworkApplication.ub,qa.AFrameworkApplication.vzb,qa.AFrameworkApplication.lcid)});
uc.register(F,"Common.App.OpenInClient.MacOfficeOffer").as("Common.IMacOfficeOffer").tc().Cc(function(){return new F(qa.AFrameworkApplication.ub,qa.AFrameworkApplication.zgc,qa.AFrameworkApplication.lcid)})};Object(K.a)(D,"OpenInClientConfiguration",null,[11]);var V=b(615),Ia=b(1560),Ha=b(38),ob=b(1396),ib=b(150),La=b(158),zb=b(233),Fb=b(13),Yb=b(86),kb=b(109),vb=b(88);Mf.Object.defineProperties(w,{Vf:{configurable:!0,enumerable:!0,get:function(){return ib.a.No(w.qk,CommonUIStrings.l_OICLaunchDialogTitle)}}});
w.qk="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='OICDialogRow' id='OICDialog'> <div class='OICDialogButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonLaunchRichClient'> <div id='OICLaunchRichClient' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonReturn'> <div id='OICReturnToApp' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(K.a)(w,"OICLaunchDialogHtml",null,[]);var Wa=ib.a;Rk(m,Wa);m.prototype.n9a=function(){this.tCa=A("BtnRichClient",this.Zp.hsb,this.Zp.Bxb,this.Zp.Qjd,CommonUIStrings.l_OICLaunchRichClient,Object(da.a)(this,this.IAf,"onRichClientButtonClick"),z);document.getElementById("OICLaunchRichClient").appendChild(this.tCa);x(this.tCa);this.zUa=A("BtnReturn",this.Zp.hsb,this.Zp.Bxb,this.Zp.v8e,CommonUIStrings.l_OICReturnToOnlineClient,Object(da.a)(this,this.FAf,"onReturnButtonClick"),z);document.getElementById("OICReturnToApp").appendChild(this.zUa);
x(this.zUa)};m.prototype.FAf=function(){this.hide();this.Zp.ybb();return!0};m.prototype.IAf=function(){Q.ULS.sendTraceTag(22140866,211,50,"OIC dialog: launch rich client");this.hide();qa.AFrameworkApplication.ub.processAction(za.a.mQa,2);return!0};m.prototype.ZEi=function(){this.Zp.ybb()};m.prototype.dispose=function(){this.Cpa||(this.tCa&&(zb.a.instance.Ba(Fb.a.click,this.tCa,Object(da.a)(this,this.IAf,"onRichClientButtonClick")),kb.KeyInputManager.instance.Ba(Fb.a.Gd,this.tCa,z)),this.zUa&&(zb.a.instance.Ba(Fb.a.click,
this.zUa,Object(da.a)(this,this.FAf,"onReturnButtonClick")),kb.KeyInputManager.instance.Ba(Fb.a.Gd,this.zUa,z)),Wa.prototype.dispose.call(this),this.Cpa=!0)};Object(K.a)(m,"OICLaunchDialog",ib.a,[]);Mf.Object.defineProperties(y,{Vf:{configurable:!0,enumerable:!0,get:function(){return ib.a.No(y.qk,CommonUIStrings.l_OICDialogTitle)}}});y.qk="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='ProtocolLaunchingDialogIssues OICDialog' id='ProtocolhandlerGetHelp'> <div class='UIFontDialogText OICDialog' id='Issues'> </div> <div class='ProtocolLaunchingDialogHelpButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonEdit'> <div id='ProtocolHandlerDialogEditInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonGiveFeedback'> <div id='ProtocolHandlerDialogGiveFeedbackInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonRetryOIC'> <div id='ProtocolHandlerDialogRetryOIC' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(K.a)(y,"ProtocolLaunchingDialogV2Html",null,[]);b(442);var qb=b(108),yb=ib.a;Rk(r,yb);r.prototype.n9a=function(){var uc=document.getElementById("Issues");if(uc){B("",this.Zp.hsb,this.Zp.Bxb,this.Zp.Qjd,uc);var Pb=document.createElement("span");Pb.className="WACDialogSectionTitle";Pb.innerText=5===this.Zp.LDf?CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICDialogSectionTitle;uc.appendChild(Pb);x(uc);uc.style.display="none"}qa.AFrameworkApplication.ta.Qa.Egd?(this.yUa=A("GiveFeedback",
this.Zp.hsb,this.Zp.Bxb,"",CommonUIStrings.l_OICDialogSectionGiveFeedback,Object(da.a)(this,this.Omc,"onGiveFeedbackClick"),Object(da.a)(this,this.Mwf,"onGiveFeedbackKeyUp")),document.getElementById("ProtocolHandlerDialogGiveFeedbackInApp").appendChild(this.yUa),x(this.yUa)):document.getElementById("ButtonGiveFeedback").style.display="none";0===qa.AFrameworkApplication.ta.Qa.editMode||qa.AFrameworkApplication.Ueh?document.getElementById("ButtonEdit").style.display="none":(this.Nea=A("Edit",this.Zp.hsb,
this.Zp.Bxb,"",2===qa.AFrameworkApplication.ta.Qa.Cj?4===qa.AFrameworkApplication.ta.Qa.editMode?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICReturnToOnlineClient:4===qa.AFrameworkApplication.ta.Qa.editMode?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICContinueInBrowser,Object(da.a)(this,this.uvf,"onEditClick"),Object(da.a)(this,this.yvf,"onEditKeyUp")),document.getElementById("ProtocolHandlerDialogEditInApp").appendChild(this.Nea),x(this.Nea));0===qa.AFrameworkApplication.ta.Qa.editMode&&
!qa.AFrameworkApplication.vzb&&uc&&(uc.style.display="none")};r.prototype.rTe=function(){return this.gpa?(this.kI(this.gpa),!0):!1};r.prototype.pTe=function(){return this.Nea?(this.kI(this.Nea),!0):!1};r.prototype.yvf=function(uc){return this.xyd(uc,0)};r.prototype.Mwf=function(uc){return this.xyd(uc,2)};r.prototype.DAf=function(uc){return this.xyd(uc,1)};r.prototype.xyd=function(uc,Pb){var sc=!1;if(uc.Ca.keyCode===Yb.a.Oh||uc.Ca.keyCode===Yb.a.Doa)uc.zb.click(),sc=!0;else if(uc.Ca.keyCode===Sys.UI.Key.down||
uc.Ca.keyCode===Sys.UI.Key.up)switch(Pb){case 1:sc=this.pTe();break;case 0:sc=this.rTe()}return sc};r.prototype.uvf=function(){this.hide();4===qa.AFrameworkApplication.ta.Qa.editMode?(Q.ULS.sendTraceTag(18715411,211,50,"Restart the App and continue editing"),this.Zp.ybb()):(Q.ULS.sendTraceTag(18715412,211,50,"Switch to edit doc in browser"),this.Zp.ahd());return!0};r.prototype.Omc=function(){Q.ULS.sendTraceTag(37339423,211,50,"Open give feedback dialog");this.Zp.v4e();return!0};r.prototype.Nnc=function(){Q.ULS.sendTraceTag(19239263,
211,50,"OIC dialog retry");document.getElementById("WACDialogPanel").style.display="none";qa.AFrameworkApplication.ub.processAction(za.a.mQa,2);return!0};r.prototype.PEd=function(){this.Zp.ybb()};r.prototype.switchToBackupMode=function(){var uc=document.getElementById("ProtocolLaunchingDialogTitle");if(uc){uc.innerText=CommonUIStrings.l_OICDialog2ndTitle;if(uc=document.getElementById("Issues"))uc.style.display="block";(uc=document.getElementById("ProtocolHandlerDialogRetryOIC"))&&!uc.children.length&&
(this.gpa=A("RetryOIC","","","",CommonUIStrings.l_OICDialogRetry,Object(da.a)(this,this.Nnc,"onRetryOICClick"),Object(da.a)(this,this.DAf,"onRetryOICKeyUp")),uc.appendChild(this.gpa),x(this.gpa),this.Nea||this.rTe())}};r.prototype.dispose=function(){this.Cpa||(this.Nea&&(zb.a.instance.Ba(Fb.a.click,this.Nea,Object(da.a)(this,this.uvf,"onEditClick")),kb.KeyInputManager.instance.Ba(Fb.a.Gd,this.Nea,Object(da.a)(this,this.yvf,"onEditKeyUp"))),this.yUa&&(zb.a.instance.Ba(Fb.a.click,this.yUa,Object(da.a)(this,
this.Omc,"onGiveFeedbackClick")),kb.KeyInputManager.instance.Ba(Fb.a.Gd,this.yUa,Object(da.a)(this,this.Mwf,"onGiveFeedbackKeyUp"))),this.gpa&&(zb.a.instance.Ba(Fb.a.click,this.gpa,Object(da.a)(this,this.Nnc,"onRetryOICClick")),kb.KeyInputManager.instance.Ba(Fb.a.Gd,this.gpa,Object(da.a)(this,this.DAf,"onRetryOICKeyUp"))),yb.prototype.dispose.call(this),this.Cpa=!0)};Object(K.a)(r,"ProtocolLaunchingDialog",ib.a,[]);var ec=b(135),Ob=b(459),Cb=ec.StandardDialog;Rk(v,Cb);v.prototype.Omc=function(uc){Q.ULS.sendTraceTag(595342858,
211,50,"Open give feedback dialog");this.Ovf(uc)};v.prototype.Nnc=function(){Q.ULS.sendTraceTag(595342857,211,50,"OIC dialog retry");qa.AFrameworkApplication.ub.processAction(za.a.mQa,2)};v.prototype.PEd=function(uc){v.w5e?3===uc?this.OSf():2===uc||0===uc?this.continueEditing():1===uc&&this.NYg():2===uc?this.OSf():(1===uc||0===uc)&&this.continueEditing()};v.prototype.NYg=function(){Q.ULS.sendTraceTag(577783557,211,50,"Closing the document");qa.AFrameworkApplication.ub.$d(za.a.close,2,Ob.a)};v.prototype.OSf=
function(){Q.ULS.sendTraceTag(593602691,211,50,"OIC dialog retry");window.setTimeout(Object(da.a)(this,this.Nnc,"onRetryOICClick"),0)};v.prototype.continueEditing=function(){4===qa.AFrameworkApplication.ta.Qa.editMode||qa.AFrameworkApplication.fa.qa("WordConsumptionViewToEditRedirectIsEnabled")&&1===qa.AFrameworkApplication.ta.mode?(Q.ULS.sendTraceTag(593602690,211,50,"Restart the App and continue editing"),this.Zp.ybb()):(Q.ULS.sendTraceTag(593602689,211,50,"Switch to edit doc in browser"),this.Zp.ahd())};
Mf.Object.defineProperties(v,{w5e:{configurable:!0,enumerable:!0,get:function(){return qa.AFrameworkApplication.fa.qa("OICDialogThreeActions")&&32===qa.AFrameworkApplication.ub.processAction(za.a.close,1)}}});Object(K.a)(v,"StandardProtocolLaunchingDialog",ec.StandardDialog,[]);var ab=b(1442);Object(K.a)(f,"EditDocumentInClientParams",null,[]);n.G6c=function(uc,Pb,sc,nb,pc,Dc,oc,Gc,ld,gd,Cc,kd,Fd,rb,Kd,Qd){oc=void 0===oc?!1:oc;Gc=void 0===Gc?!1:Gc;ld=void 0===ld?"":ld;gd=void 0===gd?!1:gd;Cc=void 0===
Cc?!1:Cc;kd=void 0===kd?!1:kd;Fd=void 0===Fd?"":Fd;rb=void 0===rb?"":rb;Kd=void 0===Kd?"":Kd;Qd=void 0===Qd?!1:Qd;var ve=new f;ve.DocumentUrl=uc;ve.Mode=Pb;ve.Options=sc;ve.Application=nb;ve.SilentExternalHandler=oc;ve.EncodeUrl=Gc;ve.CorrelationIdForWinClient=ld;ve.NavigateUsingWindowOpen=gd;ve.DescriptiveUnattemptedEnums=Cc;ve.NoBrowserModalDialogs=kd;ve.SessionOrigin=Fd;ve.CorrelationId=rb;ve.ClickTime=Kd;ve.NewTelemetryDataIsEnabled=Qd;MSOJS.ClientUtils.EditDocumentInClient(ve,pc,Dc)};Object(K.a)(n,
"ClientUtils",null,[]);var ya=b(99),ma=b(187),ha=b(521),Z=b(178),Na=b(1030),eb=b(391),cb=b(170),Ua=b(80),pa=b(190);l.prototype.Rvc=function(uc,Pb,sc){Pb=void 0===Pb?"":Pb;this.xD=(void 0===sc?"":sc)||Z.a.create().toString();this.lWb=Pb||ha.a.i_e();this.YQb=uc};l.prototype.Vgj=function(uc,Pb,sc){return Pb.contextId!==ta.a.frame?2:1===sc?32:this.mQa()};l.prototype.bGj=function(){return!(2===this.application&&qa.AFrameworkApplication.fa.qa("IsEmbeddedScenario"))};l.prototype.closeApplication=function(){this.ETd||
this.swh()};l.prototype.ybb=function(){this.eGj||this.Iwh()};l.prototype.ELf=function(uc){this.JTj&&ia.a.rh?new m(this):this.$2b(uc)};l.prototype.$2b=function(uc){uc=this.oqi(uc);var Pb=uc.returnValue;Q.ULS.sendTraceTag(34198736,211,50,"OICLaunchClient,{0},{1}",32===Pb,uc.lBa);return Pb};l.prototype.kGa=function(uc,Pb,sc,nb,pc,Dc){this.FUa=uc;this.o4d=Pb;this.Gfa=Dc;this.application=sc;this.NB=nb;qa.AFrameworkApplication.downloadCopyOnOpenInClient?this.Yif():qa.AFrameworkApplication.limitedEdit&&
!qa.AFrameworkApplication.hostAuthenticatesUsersDuringOpenInClient?qa.AFrameworkApplication.e3f():this.lNg(pc)};l.prototype.mQa=function(){this.YEi&&this.nti();return this.$2b(this.jib)};l.prototype.BWf=function(){var uc=new Na.a(cb.a.openInClient);uc.Values["ui-language"]=qa.AFrameworkApplication.lcid.toString();uc.Values[ab.a.U3c]=qa.AFrameworkApplication.userSessionId;return this.Gfa.value.send(uc)?32:8};l.prototype.nti=function(){ya.Health.instance.recordQosError("UserClickedRetryOpenInDesktop",
["OpenInClientFailed"],!1,!1,!1,!1,Object.assign(new pa.a,{inStaging:!0}))};l.prototype.zmj=function(uc){var Pb=new Na.a(cb.a.TVj);Pb.Values["ui-language"]=qa.AFrameworkApplication.lcid.toString();Pb.Values[ab.a.U3c]=qa.AFrameworkApplication.userSessionId;Pb.Values[eb.a.SVj]=uc;this.Gfa.value.send(Pb)};l.prototype.oqi=function(uc){this.jib=uc;this.zmj(5===this.NB?l.pUi:l.rUi);return 5===this.NB?this.nqi():this.sqi()};l.prototype.nqi=function(){this.djf();return{returnValue:32,lBa:"HostEditUrl,"}};
l.prototype.sqi=function(){var uc,Pb=uc="";qa.AFrameworkApplication.mle&&(Pb="|f|"+qa.AFrameworkApplication.userSessionId);var sc=qa.AFrameworkApplication.fa.qa("IsAssignmentMode")&&qa.AFrameworkApplication.fa.qa("UseWindowOpenForOpenInClientInChromeAssignmentsIsEnabled")||qa.AFrameworkApplication.isUnifiedHostMode||ia.a.Wwa,nb=qa.AFrameworkApplication.fa.qa("UnattemptedEnumIsEnabled"),pc=qa.AFrameworkApplication.fa.qa("NoBrowserModalDialogs");if(qa.AFrameworkApplication.ub.ulc){var Dc=qa.AFrameworkApplication.ub.vZ(3588168074);
Dc&&this.Rvc(Dc.epochClickTime,Dc.sessionOrigin,Dc.correlationId);this.glf()}if(qa.AFrameworkApplication.NGf){uc+="NewOrder,";Dc=8;this.Gfa&&this.Gfa.value&&this.Gfa.value.isEnabled()&&qa.AFrameworkApplication.pYd&&(uc+="Post,",Dc=this.BWf());if(32===Dc)return{returnValue:Dc,lBa:uc};Q.ULS.sendTraceTag(4994821,211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage");return qa.AFrameworkApplication.am.R9a?(Q.ULS.shipAssertTag(5566816,211,!!qa.AFrameworkApplication.am.R9a),uc+="HostUrl,",
{returnValue:qa.AFrameworkApplication.ta.B8a(qa.AFrameworkApplication.am.R9a),lBa:uc}):this.FUa?(Q.ULS.sendTraceTag(18715405,211,15,"Try to open doc in rich client, SessionId {0}",qa.AFrameworkApplication.userSessionId),uc+="DocUrl,",n.G6c(this.FUa,this.NB,this.options,this.application,Object(da.a)(this,this.xvf,"onEditInClientSuccess"),Object(da.a)(this,this.wvf,"onEditInClientFailure"),this.I3f,qa.AFrameworkApplication.fa.qa("OICEncodeUrlIsEnabled"),Pb,sc,nb,pc,this.lWb,this.xD,this.YQb,qa.AFrameworkApplication.ub.ulc),
{returnValue:32,lBa:uc}):{returnValue:8,lBa:uc}}uc+="OldOrder,";if(!this.FUa&&qa.AFrameworkApplication.am.R9a)return this.Gfa&&this.Gfa.value&&this.Gfa.value.isEnabled()&&qa.AFrameworkApplication.pYd?(uc+="Post,",Pb=this.BWf()):(Q.ULS.sendTraceTag(22595483,211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage"),Pb=8),32!==Pb?(Q.ULS.shipAssertTag(22595484,211,!!qa.AFrameworkApplication.am.R9a),uc+="HostUrl,",{returnValue:qa.AFrameworkApplication.ta.B8a(qa.AFrameworkApplication.am.R9a),
lBa:uc}):{returnValue:Pb,lBa:uc};Q.ULS.sendTraceTag(22595485,211,15,"Try to open doc in rich client, SessionId {0}",qa.AFrameworkApplication.userSessionId);uc+="DocUrl,";n.G6c(this.FUa,this.NB,this.options,this.application,Object(da.a)(this,this.xvf,"onEditInClientSuccess"),Object(da.a)(this,this.wvf,"onEditInClientFailure"),this.I3f,qa.AFrameworkApplication.fa.qa("OICEncodeUrlIsEnabled"),Pb,sc,nb,pc,this.lWb,this.xD,this.YQb,qa.AFrameworkApplication.ub.ulc);return{returnValue:32,lBa:uc}};l.prototype.MQf=
function(uc){qa.AFrameworkApplication.Hm.setDw(8981,uc)};l.prototype.xvf=function(uc){this.MQf(uc);Q.ULS.sendTraceTag(18715406,211,50,"Open in rich client succeed");6===uc&&MSOJS.ClientUtils.ShouldShowDialog()?(this.P6f||this.djf(),this.glf()):this.ETd||this.closeApplication()};l.prototype.wvf=function(uc,Pb){Pb=void 0===Pb?0:Pb;Q.ULS.sendTraceTag(18715407,211,10,"Fail to open doc in rich client. Failure Type: {0:D2}, Application: {1}",uc,Pb);if(5===uc)alert(CommonUIStrings.l_OICErrorPopupBlockerForSafari);
else{var sc=!!this.o4d&&!this.jib,nb=0;1===uc&&(nb=2);6<=uc&&13>=uc&&(nb=1,1===Pb&&(this.ETd=!0));this.nzc.FEi?(Q.ULS.sendTraceTag(18715408,211,50,"Open OICErrorDialogWithTrial. Dialog cause: {0}",nb),ob.a.instance.J7g(this.jib?Object(da.a)(this,this.msf,"oicErrorDialogHandlerCloseForced"):Object(da.a)(this,this.nsf,"oicErrorDialogHandlerNoCloseForced"),sc?Object(da.a)(this,this.Uxf,"onLaunchDownload"):null,this.QGe(!1)?Object(da.a)(this,this.S6h,"iHaveOfficeButtonHandler"):null,nb,Pb)):(Q.ULS.sendTraceTag(18715409,
211,50,"Open OICErrorDialog. Dialog cause: {0}",nb),ob.a.instance.H7g(this.jib?Object(da.a)(this,this.msf,"oicErrorDialogHandlerCloseForced"):Object(da.a)(this,this.nsf,"oicErrorDialogHandlerNoCloseForced"),sc?Object(da.a)(this,this.Uxf,"onLaunchDownload"):null,nb))}};l.prototype.glf=function(){try{var uc=[Object.assign(new Ua.a,{name:"CorrelationId",string:this.xD}),Object.assign(new Ua.a,{name:"SessionOrigin",string:this.lWb}),Object.assign(new Ua.a,{name:"ClickTime",string:this.YQb}),Object.assign(new Ua.a,
{name:"ProtocolHandlerFinishedTimestamp",double:(new Date).getTime()})];ma.a("OpenInClientCompleted",!0,0,uc)}catch(Pb){Q.ULS.sendTraceTag(537773316,306,15,"Record OIC attempt failed: "+Pb.toString())}};l.prototype.djf=function(){qa.AFrameworkApplication.ta&&qa.AFrameworkApplication.ta.Qa.Vu&&qa.AFrameworkApplication.fa.qa("StandardProtocolDialogIsEnabled")?new v(this):new r(this)};l.prototype.msf=function(){this.closeApplication()};l.prototype.nsf=function(){this.ybb()};l.prototype.Uxf=function(){this.Yif()};
l.prototype.S6h=function(){return this.QGe(!0)};l.prototype.QGe=function(uc){var Pb=(ia.a.ddf||ia.a.xH)&&!!qa.AFrameworkApplication.m6b;Pb&&uc&&(X.a.Ze(qa.AFrameworkApplication.m6b,"_blank",void 0,"OpenInClient"),this.closeApplication());return Pb};Mf.Object.defineProperties(l.prototype,{LDf:{configurable:!0,enumerable:!0,get:function(){return this.NB}},options:{configurable:!0,enumerable:!0,get:function(){var uc=0;qa.AFrameworkApplication.Tej&&(uc|=1);qa.AFrameworkApplication.openInClientEditOnly&&
(uc|=4);this.bGj()&&(uc|=64);return uc}},hsb:{configurable:!0,enumerable:!0,get:function(){return qa.AFrameworkApplication.FC}},Bxb:{configurable:!0,enumerable:!0,get:function(){return qa.AFrameworkApplication.wxb}},v8e:{configurable:!0,enumerable:!0,get:function(){return""}},Qjd:{configurable:!0,enumerable:!0,get:function(){return""}},P6f:{configurable:!0,enumerable:!0,get:function(){return qa.AFrameworkApplication.fa.qa("OneNoteMobileViewerIsEnabled")}},nzc:{configurable:!0,enumerable:!0,get:function(){return this.obe||
(this.obe=sa.a.instance.resolve("Common.IOfficeTrialExperience"))}},YEi:{configurable:!0,enumerable:!0,get:function(){return!!qa.AFrameworkApplication.fa&&qa.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OicAshaLoggingIsEnabled",!1)}}});l.rUi="OpenInDesktop";l.pUi="OpenInBrowser";Object(K.a)(l,"AOpenInClientOperation",null,[]);var Qa=b(5),Db=b(210),Kb=b(76),Ab=b(59),ub=b(336),Mb=b(47),Aa=b(44),Za=b(197),Zb=b(91),jb=b(31),Vb=b(1),Ic=b(11),Rb=b(21),kc=b(525),xb=b(258),
Va=b(261),tb=b(156),fb=b(650);Rk(k,l);k.prototype.V_g=function(){this.ELf(this.CTe)};k.prototype.X1g=function(){var uc=this,Pb=this.$;C.TaskExtensions.Aa(this.OJ.value,function(sc){uc.kGa(Pb.workbookContext.ClientUrl,qa.AFrameworkApplication.v3,1,Pb.isEditMode?2:0,!0,new V.a(function(){return sc.result}))},this.la,3)};k.prototype.ahd=function(){0!==Ab.a.qg.editMode&&(this.$.ob.mz=!1)};k.prototype.v4e=function(){var uc={};uc[Qa.a.c9b]=!1;uc[Qa.a.NU]="OpenInExcel";this.$.Fd(802602464,Kb.a.Cb,8,uc)};
k.prototype.G1c=function(){var uc=this;if(this.ea.dc){var Pb=this.$;Pb.isEditMode&&C.TaskExtensions.Aa(this.OJ.value,function(sc){uc.kGa(Pb.workbookContext.ClientUrl,qa.AFrameworkApplication.v3,1,2,!1,new V.a(function(){return sc.result}))},this.la,3)}};k.prototype.MAe=function(){var uc=this;this.ea.dc&&C.TaskExtensions.Aa(this.OJ.value,function(Pb){uc.kGa(uc.$.workbookContext.ClientUrl,qa.AFrameworkApplication.v3,1,uc.$.isEditMode?2:0,!1,new V.a(function(){return Pb.result}))},this.la,3)};k.prototype.Rvc=
function(uc){l.prototype.Rvc.call(this,uc)};k.prototype.openInExcelClient=function(){var uc=this;this.ea.dc&&(this.$.isEditMode||C.TaskExtensions.Aa(this.OJ.value,function(Pb){uc.kGa(uc.$.workbookContext.ClientUrl,qa.AFrameworkApplication.v3,1,0,!1,new V.a(function(){return Pb.result}))},this.la,3))};k.prototype.openInBrowser=function(){var uc=this;this.ea.dc&&C.TaskExtensions.Aa(this.OJ.value,function(Pb){uc.kGa(uc.$.workbookContext.ClientUrl,qa.AFrameworkApplication.v3,1,5,!1,new V.a(function(){return Pb.result}))},
this.la,3)};k.prototype.downloadFile=function(uc){var Pb=this.Qte(uc);this.lua.downloadFile(Pb,uc);this.Pti()};k.prototype.Pti=function(){qa.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CollabCornerFloodgateDownloadCopy",!1)&&null!=this.Zfa&&this.Zfa.execute(function(uc){return uc.logActivity("CollabCornerSurveyLogDownloadACopyCommandActivity","CollabCornerFloodgateSurveysIsEnabled")})};k.prototype.HDf=function(uc,Pb){Pb=void 0===Pb?0:Pb;if(this.ea.dc){var sc=this.$;
aa.a(sc).ALa?this.IDf(uc,sc):0<Pb?this.XDj(uc,sc,Pb):this.T1f(sc)}};k.prototype.kGa=function(uc,Pb,sc,nb,pc,Dc){this.$.ob.mz=!Vb.EwaSettings.isChangeGateEnabled("OfficeVSO:5209012_KeepMenuEnableAfterOIC")||!this.$.hc.inWebPart;this.CTe=pc;this.a3b=null;this.e6c=!1;this.qNg(uc,Pb,nb,pc,Dc)};k.prototype.$2b=function(uc){var Pb=this.$.hc;Q.ULS.sendTraceTag(537154775,0,50,"OpenInExcelOperation.CompleteClientLaunch: IsEmbedded:{0}, InWebPart:{1}, DivSyndicated:{2}, Mode:{3}",Pb.inEmbedView,Pb.inWebPart,
Pb.isDivSyndicated,this.$.isEditMode?Db.a.edit:Db.a.view);return k.Tdf()?(this.z2b(),n.G6c(this.FUa,this.NB,this.options,1,this.YIi,this.XIi,!1,qa.AFrameworkApplication.fa.qa("OICEncodeUrlIsEnabled")),32):l.prototype.$2b.call(this,uc)};k.prototype.swh=function(){this.QRf();var uc=this.$;if(!this.ea.hc.inWebPart&&this.ea.dc&&!uc.isEditMode){var Pb=new Zb.a(2145659238,Kb.a.Cb,this.$.Jc,0,null);this.Iye=Mb.a.instance.create(function(){uc.Ka.Kb(Pb)},0,Aa.a.sUi)}};k.prototype.dispose=function(){this.ea&&
this.ea.wk(this.Uc);P.a.oc([this.Pa,this.Iye,this.um]);this.$=this.ea=null};k.prototype.Iwh=function(){this.QRf()};k.prototype.Yif=function(){var uc=this;Mb.a.instance.create(function(){uc.$.Ka.Kb(new Zb.a(-2028960985,Kb.a.Cb,0,30,null))},0,Aa.a.tUi,!0,!0)};k.prototype.lNg=function(uc){var Pb=this.$,sc=aa.a(this.$).fd.activityState;sc[kc.a.zje]=!0;Pb.isEditMode&&this.ea.dc?(this.z2b(),va.a(Pb).Zs(new xb.a(ua.a.Zy,5,function(){Pb.XH(!1);sc[Va.a.Oq]=ua.a.B2b;sc[kc.a.uzg]=uc;sc[ra.a.T$c]=!0;Pb.isEditMode&&
(sc[ra.a.pT]=1,sc[ra.a.aY]=!0,sc[tb.a.uYb]=!0,sc[tb.a.jTc]=!0);sc[kc.a.Cje]=1455037301}))):this.ELf(uc)};k.prototype.J4f=function(){var uc=qa.AFrameworkApplication.v3;if(this.$.downloadCopyOnOpenInClient){if(8===this.$.frame.B8a(uc,!0)){var Pb=this.$.ea.hc;Q.ULS.sendTraceTag(537154773,0,50,"Url:[{0}] IsEmbedded:[{1}] InWebPart:[{2}] DivSyndicated:[{3}], Mode:[{4}]",uc,Pb.inEmbedView,Pb.inWebPart,Pb.isDivSyndicated,this.$.isEditMode?Db.a.edit:Db.a.view)}}else this.lua.downloadFile(uc,-2028960985);
this.e6c=!0;this.z2b()};k.prototype.Lqi=function(){this.nzc.Srf&&this.nzc.fjc(1)};k.prototype.Mqi=function(){this.nzc.Srf&&Ic.HelperMethods.Ze(na.a.nZ(33),"_blank",void 0,"OpenExcelOperation.XLSViewerUnknownTryOffice")};k.prototype.Wqi=function(){Ic.HelperMethods.Ze(na.a.nZ(31),"_blank",void 0,"OpenExcelOperation.XLSBackstageUnknownTryMacOffice")};k.prototype.Xqi=function(){Ic.HelperMethods.Ze(na.a.nZ(34),"_blank",void 0,"OpenExcelOperation.XLSViewerUnknownTryMacOffice")};k.prototype.Qte=function(uc){var Pb=
new Sys.StringBuilder,sc=this.$.workbookContext,nb=this.$.ya;Pb.append(this.$.Bda);Pb.append(nb.FileHandlerRelativeUri);Pb.append("?id=");Pb.append(encodeURIComponent(ca.a.OHb(sc.WorkbookUri,"sc")));this.$.ea.dc&&(Pb.append("&sessionId="),Pb.append(encodeURIComponent(this.$.ea.sessionId)));switch(uc){case -974518828:Pb.append("&workbookType=PublishedItemsSnapshot");break;case -1804063550:Pb.append("&workbookType=FullWorkbook");break;case -1059172980:Pb.append("&workbookType=FullWorkbook&workbookFileType=Odf");
break;default:Pb.clear()}ea.a.RYa(Pb,nb);return Pb.toString()};k.prototype.D0g=function(){Ia.a.instance.JWg();var uc=this.$.ya;MSOJS.ClientUtils.InitUrls(uc.RoamingAppsX86RootUrl,uc.RoamingAppsControlInstallerUrl,uc.RoamingAppsFirefoxExtensionUrl)};k.prototype.QRf=function(){var uc=this.$;this.ea.dc||ub.a.TEd(uc,aa.a(uc).fd);this.z2b();this.a3b&&this.a3b(this,this.e6c);uc.frame.mt.$l(this.$.frame.Haa());uc.frame.aX.$l(this.$.frame.Haa());uc.ob.mz=!1;Rb.g(uc).focus()};k.prototype.qNg=function(uc,Pb,
sc,nb,pc){var Dc=this.$;qa.AFrameworkApplication.ta&&!k.Tdf()&&(Dc.frame.mt.Wm(Dc.frame.Haa()),Dc.frame.aX.Wm(Dc.frame.Haa()));l.prototype.kGa.call(this,uc,Pb,1,sc,nb,pc)};k.prototype.z2b=function(){var uc=this.$;aa.a(uc).ii.activityName===ua.a.openInExcelClient&&aa.a(uc).fd.eM()};k.prototype.Tyj=function(){var uc=jb.a.Xc(1,0,684,685,0,1341525452,"OpenInExcelActiveXError");va.a(this.$).nr([uc])};k.prototype.XDj=function(uc,Pb,sc){var nb=this,pc=null,Dc=window.setTimeout(function(){aa.a(Pb).Zrc(pc);
nb.T1f(Pb)},sc);pc=function(){aa.a(Pb).ALa&&(aa.a(Pb).Zrc(pc),window.clearTimeout(Dc),nb.IDf(uc,Pb))};aa.a(Pb).kUc(pc)};k.prototype.T1f=function(uc){var Pb=jb.a.Xc(1,1,0,699,0,-1753121099,"ProcessingUserChangesFileDownloadIgnored");va.a(uc).nr([Pb])};k.prototype.IDf=function(uc,Pb){var sc=this;va.a(Pb).Zs(new xb.a(ua.a.Zy,5,function(){Pb.XH(!1);var nb=aa.a(Pb).fd,pc=nb.activityState;pc[Va.a.Oq]=ua.a.mIe;pc[fb.a.wYb]=Pb.ea.hc.hasUnsupportedFeaturesForEdit;pc[ba.a.dTc]=uc;nb.yt(jb.a.laa(sc.businessBar.S6c,
[1437034227]))}))};k.Tdf=function(){return 1<Ab.a.getRegisteredEwaInstances().length};Mf.Object.defineProperties(k.prototype,{v8e:{configurable:!0,enumerable:!0,get:function(){return"EditInExcelWebApp_32x32x32"}},la:{configurable:!0,enumerable:!0,get:function(){this.um=this.um||new Za.a;return this.um.token}},Qjd:{configurable:!0,enumerable:!0,get:function(){return"excel32"}},P6f:{configurable:!0,enumerable:!0,get:function(){return this.ea.hc.inWebPart}}});Object(K.a)(k,"OpenInExcelOperation",l,[753,
3]);var ac=N.a;Rk(e,ac);e.prototype.create=function(){var uc=this;if(this.$.da.za(55))this.pb(this.$.da.za(55));else{var Pb=M.GetServiceTaskFactory.create(this.$.da,155,this.la,this.hb),sc=M.GetServiceTaskFactory.Ra(this.$.da,5,4,this.hb);C.TaskExtensions.Aa(db.Task.oL(Pb,sc),function(){uc.pb(new k(uc.$,new V.a(function(){return M.GetServiceTaskFactory.create(uc.$.da,137,uc.la,uc.hb)}),sc.result))},this.la,3)}};e.C0g=function(){e.psf||(e.psf=!0,(new D).Ph(sa.a.instance),sa.a.instance.resolve("Common.IOfficeTrialExperience").Bg(),
sa.a.instance.resolve("Common.IMacOfficeOffer").Bg())};e.psf=!1;Object(K.a)(e,"OpenInClientFactory",N.a,[]);var Ac=b(115),Rc=b(413),Fc=Ac.a;Rk(d,Fc);d.prototype.execute=function(uc){var Pb=Object(ka.a)(4,uc.ue);C.TaskExtensions.Aa(M.GetServiceTaskFactory.create(Pb.da,56,Pb.la,0),function(sc){Pb.downloadCopyOnOpenInClient?(uc.activityState[Rc.a.Aje]=!0,sc.result.J4f()):sc.result.X1g()},Pb.la,3);return 1};Object(K.a)(d,"OpenInExcelClientActivity",Ac.a,[]);var wb=N.a;Rk(c,wb);c.prototype.create=function(){var uc=
this;C.TaskExtensions.Aa(M.GetServiceTaskFactory.create(this.$.da,155,this.la,this.hb),function(){uc.pb(new d(ua.a.openInExcelClient,ua.a.idle))},this.la)};Object(K.a)(c,"OpenInExcelClientActivityFactory",N.a,[]);b.d(E,"a",function(){return a})},1352:function(u,E,b){function a(Ob,Cb){var ab=ec.call(this,Cb)||this;ab.jCh=H.DOMElementExtensions.er+",div";ab.lU=Array(68);ab.nm=!1;ab.NV=function(ya){if(ya.Ca.keyCode===F.a.Pz){var ma=ab.ic.querySelectorAll(ab.jCh),ha=H.DOMElementExtensions.Cl(ma);ma=H.DOMElementExtensions.az(ma);
return H.DOMElementExtensions.kna(ya.Ca,ha,ma)}return!1};ab.jb=Ob;ab.set_visible(!1);ab.addCssClass(N.a.Ylh);qb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactBusinessBar",!1)&&ab.addCssClass(N.a.hmh);G.KeyInputManager.instance.ra(T.a.Lb,ab.ic,ab.NV);C.a(Ob).Lh(ab);return ab}function c(Ob,Cb,ab,ya,ma,ha){var Z=D.call(this,Ob,Cb,ab)||this;Wa.a.instance.create(function(){if(Z.businessBar&&Z.businessBar.QLa(Cb.rGa)){var Na=new R.a(-847286761,0,Z.businessBar.$.Jc,0,null),eb={};eb=(eb.CalloutName=
ya,eb.Target=qb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactBusinessBar",!1)?Z.domElement.getElementsByClassName("ms-Button")[0]:Z.uS.domElement,eb);Z.businessBar.$.Ka.Kb(Na,eb)}},ma,ha,!0,!0);return Z}function d(Ob,Cb,ab,ya){Ob=vb.call(this,Ob,Cb)||this;Ob.automateCommandManager=ab.da.za(352);I.ULS.shipAssertTag(526787654,0,!!Ob.automateCommandManager);Ob.id=zb.a.create();Ob.$=ab;Ob.title=wa.a.instance.ga(2247);Ob.message="";Ob.YSd=wa.a.instance.ga(2243);Ob.GVj=wa.a.instance.ga(2244);
Ob.Seg=wa.a.instance.ga(2245);Ob.j1g=wa.a.instance.ga(2246);Ob.update(ya);return Ob}function e(Ob,Cb){Ob=sa.call(this,Ob,Cb)||this;Ob.TBa=za.a.H4b();Ob.Ou=!0;Ob.xZ=Ob.TBa.PTj;Ob.title=Ob.TBa.title;Ob.message=Ob.TBa.message;return Ob}function k(Ob,Cb){Ob=ia.call(this,Ob,Cb)||this;Ob.Ou=!0;Ob.title="";return Ob}function l(Ob,Cb){Cb=Ka.call(this,Ob,Cb)||this;Cb.policyManager=Ob.$.da.za(274);if(!Cb.policyManager)return I.ULS.sendTraceTag(537170202,306,50,"Tried creating PolicyBusinessBarEntry but policyManager service has not been registered."),
Cb;Cb.message=Cb.policyManager.vpc;Cb.title=Cb.policyManager.title;Cb.Cva=!0;return Cb}function n(Ob,Cb){Ob=ra.call(this,Ob,Cb)||this;Ob.Ou=!0;Ob.xZ=!0;return Ob}function f(Ob,Cb,ab,ya){Ob=oa.call(this,Ob,Cb)||this;Ob.Zwb=ab;Ob.command=ya;Ob.Cva=!0;Ob.Ou=1461300262!==ya;return Ob}function v(Ob,Cb,ab){Ob=aa.call(this,Ob,Cb)||this;Ob.Zwb=ab;Ob.Cva=!0;return Ob}function r(Ob,Cb,ab){Ob=Xa.call(this,Ob,Cb)||this;Ob.Zwb=ab;Ob.Ou=!0;return Ob}function y(Ob,Cb){Ob=va.call(this,Ob,Cb)||this;Ob.Ou=!0;Ob.xZ=
!1;return Ob}function m(Ob,Cb){Ob=ja.call(this,Ob,Cb)||this;Ob.Ou=!0;Ob.xZ=!0;return Ob}function w(Ob,Cb,ab,ya,ma,ha,Z,Na){return B.call(this,Ob,0,Cb,ab,ya,ma,ha,Z,Na)||this}function B(Ob,Cb,ab,ya,ma,ha,Z,Na,eb){this.QI=this.i8=this.uS=0;this.$kg=Ob;this.nJj=Cb;this.$O=ab;this.ypg=Z;this.wib=J.a.Kv(eb);this.rng=eb;this.flg=Na;0!==ya&&(this.uS=ya);0!==ma&&(this.i8=ma);0!==ha&&(this.QI=ha)}function A(Ob,Cb,ab,ya,ma){Ob=z.call(this,Ob,Cb,ab,ya)||this;Ob.command=ma;Ob.xZ=!0;return Ob}function z(Ob,Cb,
ab,ya){Ob=ea.call(this,Ob,Cb)||this;Ob.error=ab;Ob.options=ya;Ob.error&&Ob.options&2&&(Ob.message=Ob.error.Description);Ob.error&&Ob.options&1&&(Ob.title=Ob.error.Caption);Ob.Ou=!(ya&4);return Ob}function x(Ob,Cb,ab){return D.call(this,Ob,Cb,ab)||this}function D(Ob,Cb,ab){Ob=fa.call(this,Ob,Cb)||this;Ob.Ou=!0;Ob.command=ab;return Ob}b.r(E);u=b(0);var I=b(14),F=b(86),G=b(109),T=b(13),O=b(89),U=b(52),J=b(29),H=b(12),K=b(244),N=b(1259),M=b(5),C=b(272),Q=b(1260),P=b(919),ka=b(1461),R=b(91),fa=P.a;Rk(D,
fa);D.prototype.lo=function(Ob){fa.prototype.lo.call(this,Ob);this.businessBar.$.Ka.Kb(new R.a(this.command,Ob,this.businessBar.$.Jc,10,null))};Object(u.a)(D,"CommandActionBusinessBarEntry",P.a,[]);Rk(x,D);x.prototype.PC=function(Ob){D.prototype.PC.call(this,Ob)};Object(u.a)(x,"EditAttemptReadOnlyBusinessBarEntry",D,[]);var ca=b(42),ea=P.a;Rk(z,ea);z.prototype.lo=function(Ob){ea.prototype.lo.call(this,Ob);this.error.Appearance&=-33;ca.a(this.businessBar.$).nr([this.error])};Object(u.a)(z,"ErrorBusinessBarEntry",
P.a,[]);Rk(A,z);A.prototype.y_=function(Ob){z.prototype.y_.call(this,Ob);this.businessBar.$.Ka.Kb(new R.a(this.command,Ob,this.businessBar.$.Jc,10,null))};Object(u.a)(A,"ErrorAndCommandBusinessBarEntry",z,[]);var wa=b(15);B.ga=function(Ob){return wa.a.instance.ga(Ob)};Mf.Object.defineProperties(B.prototype,{title:{configurable:!0,enumerable:!0,get:function(){return B.ga(this.nJj)}},message:{configurable:!0,enumerable:!0,get:function(){return B.ga(this.$O)}},messageId:{configurable:!0,enumerable:!0,
get:function(){return this.$O}},rGa:{configurable:!0,enumerable:!0,get:function(){return this.$kg}},actionButton:{configurable:!0,enumerable:!0,get:function(){return B.ga(this.uS)}},WFa:{configurable:!0,enumerable:!0,get:function(){return B.ga(this.i8)}},link:{configurable:!0,enumerable:!0,get:function(){return B.ga(this.QI)}},Jk:{configurable:!0,enumerable:!0,get:function(){return this.ypg}},MRg:{configurable:!0,enumerable:!0,get:function(){return this.flg}},hash:{configurable:!0,enumerable:!0,get:function(){return this.wib}},
alt:{configurable:!0,enumerable:!0,get:function(){var Ob=b(1352).BusinessBarControl;switch(this.Jk){case Ob.nia:return B.ga(26);case Ob.Rz:return B.ga(25);case Ob.Ki:return B.ga(24);default:return B.ga(0)}}},J7c:{configurable:!0,enumerable:!0,get:function(){return this.rng}}});Object(u.a)(B,"EwaBusinessBarEntry",null,[]);Rk(w,B);Mf.Object.defineProperties(w.prototype,{title:{configurable:!0,enumerable:!0,get:function(){return""}}});Object(u.a)(w,"EwaNoTitleBusinessBarEntry",B,[]);var X=b(69),ja=P.a;
Rk(m,ja);m.prototype.lo=function(Ob){ja.prototype.lo.call(this,Ob);this.set_visible(!1);this.businessBar.$.$H();this.businessBar.$.Ka.Kb(new R.a(1038998010,Ob,this.businessBar.$.Jc,10,null))};m.prototype.y_=function(Ob){ja.prototype.y_.call(this,Ob);this.businessBar.$.Ka.Kb(new R.a(-722953877,Ob,this.businessBar.$.Jc,10,null))};m.prototype.PC=function(Ob){this.businessBar.removeEntry(54);X.g(Ob)};Object(u.a)(m,"ExternalLinksEnableContentBusinessBarEntry",P.a,[]);var va=P.a;Rk(y,va);y.prototype.lo=
function(Ob){va.prototype.lo.call(this,Ob);this.businessBar.$.Ka.Kb(new R.a(-722953877,Ob,this.businessBar.$.Jc,10,null))};y.prototype.PC=function(Ob){this.businessBar.removeEntry(5);X.g(Ob)};Object(u.a)(y,"ExternalLinksShowErrorBusinessBarEntry",P.a,[]);var ua=b(11),Xa=P.a;Rk(r,Xa);r.prototype.lo=function(Ob){Xa.prototype.lo.call(this,Ob);ua.HelperMethods.RV(this.businessBar.$.aG,this.Zwb,this.businessBar.$.nS)};Object(u.a)(r,"HelpButtonBusinessBarEntry",P.a,[]);var aa=P.a;Rk(v,aa);v.prototype.Sla=
function(Ob){aa.prototype.Sla.call(this,Ob);ua.HelperMethods.RV(this.businessBar.$.aG,this.Zwb,this.businessBar.$.nS)};Object(u.a)(v,"HelpTextBusinessBarEntry",P.a,[]);var ba=b(76),oa=P.a;Rk(f,oa);f.prototype.lo=function(Ob){oa.prototype.lo.call(this,Ob);this.businessBar.$.Ka.Kb(new R.a(this.command,Ob,this.businessBar.$.Jc,10,null))};f.prototype.Sla=function(Ob){oa.prototype.Sla.call(this,Ob);var Cb=new R.a(-859308420,Ob,this.businessBar.$.Jc,12,null),ab={};Ob=(ab[ba.a.Uf]="HelpID="+this.Zwb,ab.InputMethod=
Ob,ab[ba.a.Nc]=M.a.CQ,ab[M.a.Vda]=!0,ab);this.businessBar.$.Ka.Kb(Cb,Ob)};Object(u.a)(f,"HelpTextTaskPaneAndCommandBusinessBarEntry",P.a,[]);var ra=P.a;Rk(n,ra);n.prototype.lo=function(Ob){ra.prototype.lo.call(this,Ob);this.set_visible(!1);this.businessBar.$.$H();this.businessBar.$.Ka.Kb(new R.a(-1081442996,Ob,this.businessBar.$.Jc,10,null))};n.prototype.y_=function(Ob){ra.prototype.y_.call(this,Ob);this.businessBar.$.Ka.Kb(new R.a(1702917262,Ob,this.businessBar.$.Jc,10,null))};n.prototype.PC=function(Ob){this.businessBar.removeEntry(58);
X.g(Ob)};Object(u.a)(n,"LinkedEntitiesEnableUntrustedImagesBusinessBarEntry",P.a,[]);var db=b(1262),Ka=P.a;Rk(l,Ka);l.prototype.Sla=function(Ob){Ka.prototype.Sla.call(this,Ob);(Ob=this.policyManager.zNi)&&Ob(null)};Mf.Object.defineProperties(l.prototype,{linkText:{configurable:!0,enumerable:!0,get:function(){return this.policyManager.linkText}}});Object(u.a)(l,"PolicyBusinessBarEntry",P.a,[]);var Ga=b(1261),xa=b(1264),da=b(1263);b(442);var qa=b(187),na=b(25),ia=P.a;Rk(k,ia);k.prototype.lo=function(Ob){ia.prototype.lo.call(this,
Ob);qa.c(na.a.rCi);window.open("https://www.microsoft.com/edge?form=MI13FQ&OCID=MI13FQ","_blank")};Object(u.a)(k,"UnsupportedBrowserBusinessBarEntry",P.a,[]);var ta=b(1258),za=b(1494),sa=P.a;Rk(e,sa);e.prototype.lo=function(Ob){sa.prototype.lo.call(this,Ob);this.TBa.vtf(null)};e.prototype.y_=function(Ob){sa.prototype.y_.call(this,Ob);this.TBa.ytf(null)};e.prototype.PC=function(Ob){sa.prototype.PC.call(this,Ob);this.TBa.jHe(null)};Mf.Object.defineProperties(e.prototype,{actionButton:{configurable:!0,
enumerable:!0,get:function(){return this.TBa.fue}},WFa:{configurable:!0,enumerable:!0,get:function(){return this.TBa.hue}}});Object(u.a)(e,"WildFireMobileAppBusinessBarEntry",P.a,[]);var V=b(253),Ia=b(22),Ha=b(227),ob=b(165),ib=b(46),La=b(7),zb=b(178),Fb=b(1169),Yb=b(80),kb=b(133),vb=P.a;Rk(d,vb);d.prototype.update=function(Ob){this.scriptLink=Ob.scriptLink;this.runStatus=Ob.runStatus;this.buttonText=Ob.buttonText||"";this.pti(Ob.clickId);this.afj();"preparing"===this.runStatus?(this.message=String.format(wa.a.instance.mb(203),
this.buttonText),this.Ou=!0,this.LXa=this.YSd,this.$pb=this.iFa=this.I9a):"running"===this.runStatus?(this.message=String.format(wa.a.instance.mb(202),this.buttonText),this.Ou=!0,this.LXa=this.YSd,this.$pb=this.iFa=this.I9a):"succeeded"===this.runStatus?(this.message=String.format(wa.a.instance.mb(205),this.buttonText),this.Ou=!0,this.LXa=this.Seg,this.iFa=this.iDf,this.xZ=!0,this.rVc=this.GVj,this.sVc=this.vTi):"runFailed"===this.runStatus?(this.message=String.format(wa.a.instance.mb(204),this.buttonText),
this.X4a=a.nia,this.Ou=!0,this.LXa=this.Seg,this.iFa=this.iDf,"false"===Ob.isOwner&&(this.xZ=!0,this.rVc=this.j1g,this.sVc=this.IHi)):"fetchFailed"===this.runStatus?(this.X4a=a.nia,this.message=String.format(wa.a.instance.mb(206),this.buttonText)):"canceled"===this.runStatus?(this.X4a=a.Rz,this.message=String.format(wa.a.instance.mb(208),this.buttonText)):"alreadyRunning"===this.runStatus?(this.X4a=a.Rz,this.message=String.format(wa.a.instance.mb(207),this.buttonText),this.Ou=!0,this.LXa=this.YSd,
this.$pb=this.iFa=this.I9a):"initializing"===this.runStatus&&(this.X4a=a.Ki,this.message=wa.a.instance.ga(2248))};d.prototype.lo=function(Ob){vb.prototype.lo.call(this,Ob);this.iFa&&this.iFa()};d.prototype.y_=function(Ob){vb.prototype.y_.call(this,Ob);this.WFa&&this.sVc()};d.prototype.PC=function(Ob){vb.prototype.PC.call(this,Ob);this.$pb&&this.$pb()};d.prototype.afj=function(){this.message="";this.X4a=a.Ki;this.Ou=!1;this.LXa="";this.iFa=void 0;this.xZ=!1;this.rVc="";this.sVc=void 0;this.N4a=!1;
this.$pb=void 0};d.prototype.I9a=function(){var Ob=zb.a.create().toString();this.automateCommandManager.d1h(Ob);this.Ejc(-2186799,Ob)};d.prototype.iDf=function(){var Ob=zb.a.create().toString();this.automateCommandManager.c1h(Ob);this.Ejc(1036446140,Ob)};d.prototype.vTi=function(){var Ob=zb.a.create();if(this.scriptLink){var Cb=new Fb.b(this.scriptLink);this.automateCommandManager.Z4e(this.id.toString(),JSON.stringify(Cb),Ob)}this.Ejc(-585097204,Ob.toString())};d.prototype.IHi=function(){var Ob=zb.a.create().toString();
this.automateCommandManager.b1h(Ob);this.Ejc(-639858579,Ob)};d.prototype.pti=function(Ob){var Cb=[];Cb.push(Object(La.a)(new Yb.a,{name:"id",string:this.id.toString()}));Cb.push(Object(La.a)(new Yb.a,{name:"hasScriptLink",bool:!!this.scriptLink}));Cb.push(Object(La.a)(new Yb.a,{name:"runStatus",string:this.runStatus}));Cb.push(Object(La.a)(new Yb.a,{name:"clickId",string:Ob}));Cb.push(Object(La.a)(new Yb.a,{name:"hasButtonText",bool:!!this.buttonText&&""!==this.buttonText}));qa.a(kb.a.KEi,void 0,
void 0,Cb)};d.prototype.Ejc=function(Ob,Cb){var ab=[];ab.push(Object(La.a)(new Yb.a,{name:"id",string:this.id.toString()}));ab.push(Object(La.a)(new Yb.a,{name:"hasScriptLink",bool:!!this.scriptLink}));ab.push(Object(La.a)(new Yb.a,{name:"runStatus",string:this.runStatus}));ab.push(Object(La.a)(new Yb.a,{name:"clickId",string:Cb}));qa.d(Ob,void 0,void 0,void 0,void 0,void 0,ab)};Mf.Object.defineProperties(d.prototype,{Jk:{configurable:!0,enumerable:!0,get:function(){return this.X4a}},actionButton:{configurable:!0,
enumerable:!0,get:function(){return this.LXa}},WFa:{configurable:!0,enumerable:!0,get:function(){return this.rVc}}});Object(u.a)(d,"OfficeScriptsRunStatusBusinessBarEntry",P.a,[]);var Wa=b(47),qb=b(1);Rk(c,D);Object(u.a)(c,"CalloutBusinessBarEntry",D,[]);var yb=b(19);b.d(E,"BusinessBarControl",function(){return a});var ec=K.a;Rk(a,ec);a.prototype.Sf=function(Ob,Cb){Cb||H.DOMElementExtensions.setFocus(this.domElement.firstChild);return!Cb};a.prototype.$g=function(Ob){return H.DOMElementExtensions.nf(this.ic,
Ob)};a.prototype.ej=function(){};a.prototype.Aj=function(){};a.prototype.dispose=function(){this.nm||(G.KeyInputManager.instance.Ba(T.a.Lb,this.ic,this.NV),O.a.oc(this.lU),this.lU=Array(68),this.jb=null,ec.prototype.dispose.call(this),this.nm=!0)};a.prototype.QLa=function(Ob){if(!this.get_visible())return!1;Ob=this.lU[Ob];return!!Ob&&Ob.isVisible};a.prototype.cC=function(Ob){return!!this.lU[Ob]};a.prototype.ZNb=function(Ob,Cb){if(Ob=this.lU[Ob])Ob.update(Cb),Ob.KPj()};a.prototype.OD=function(Ob,Cb,
ab,ya){ab=void 0===ab?null:ab;ya=void 0===ya?null:ya;var ma=!1;if(this.cC(Ob))ab=this.lU[Ob].get_visible();else{this.set_visible(!0);var ha=a.V2e()[Ob];this.lU[Ob]=this.J$(Ob,Cb,ab,ya);ab=!1;ma=!0;ya="";var Z=0;Cb&&(ya=Cb.MessageIdName,Z=Cb.MessageId);var Na=ha.J7c;I.ULS.sendTraceTag(537170258,0,50,"BusinessBarControl.AddEntry of type: {0}, time from app interactive: {1}",Ob,ib.PageLoadTrackingInfo.instance.bKa(new Date));if(qb.EwaSettings.isChangeGateEnabled("OfficeVSO:6069521_TelemetryForBusinessBar")){var eb=
this.lU.filter(function(cb){return null!=cb}).length;1<eb&&I.ULS.sendTraceTag(525349006,0,50,"Total BizBars: {0}",eb.toString())}ob.a(this.$).pJd(ha.hash,ya,Z,U.a.rAc,!0,1,Cb,Na)}ab||!Array.contains(ka.a.lcc(),Ob)&&!ma||(this.lU[Ob].set_visible(!0),this.$.$H())};a.prototype.removeEntry=function(Ob){return this.C9i(Ob)};a.prototype.pHd=function(){O.a.oc(this.lU);this.lU=Array(68);this.set_visible(!1)};a.prototype.C9i=function(Ob){if(!this.cC(Ob))return!1;O.a.Ia(this.lU[Ob]);this.lU[Ob]=null;this.domElement.hasChildNodes()||
this.set_visible(!1);this.$.$H();return!0};a.prototype.J$=function(Ob,Cb,ab,ya){ab=void 0===ab?null:ab;ya=void 0===ya?null:ya;var ma=a.V2e()[Ob],ha=!!(this.$.Cd&64);switch(Ob){case 2:case 4:case 23:case 25:case 26:case 35:case 34:Ob=new P.a(this,ma);break;case 12:case 29:case 30:case 31:case 32:case 56:Ob=ha?new D(this,ma,-8805455):new P.a(this,ma);break;case 22:Ob=new x(this,ma,-8805455);break;case 45:case 44:Ob=ha?new A(this,ma,Cb,0,-8805455):new z(this,ma,Cb,0);break;case 11:case 42:case 7:case 0:case 1:case 3:case 33:Ob=
new z(this,ma,Cb,0);break;case 19:Ob=new P.a(this,ma);break;case 46:Ob=new z(this,ma,Cb,0);break;case 6:case 14:Ob=new r(this,ma,Cb.HelpTopicId);break;case 67:case 65:Ob=new v(this,ma,Cb.HelpTopicId);break;case 36:Ob=new v(this,ma,M.a.Vah);break;case 37:Ob=new P.a(this,ma);break;case 16:Ob=new P.a(this,ma);Ob.title=J.a.zg(this.$.workbookContext.FullDocumentInfo.IrmPolicyTitle);Ob.message=J.a.zg(this.$.workbookContext.FullDocumentInfo.IrmPolicyDescription);break;case 18:Ob=new D(this,ma,-1762562205);
Ob.N4a=!0;break;case 20:Ob=new e(this,ma);break;case 21:case 55:Ob=new P.a(this,ma);break;case 28:Ob=new P.a(this,ma);break;case 24:Ob=new k(this,ma);break;case 27:Ob=new l(this,ma);break;case 38:Ob=new ta.a(this,ma);break;case 39:Ob=new Q.a(this,ma);break;case 40:Ob=new Ga.a(this,ma);break;case 41:Ob=new db.a(this,ma);break;case 47:Ob=new P.a(this,ma);break;case 48:Ob=new P.a(this,ma);break;case 49:Ob=new P.a(this,ma);break;case 50:Ob=new P.a(this,ma);break;case 51:Ob=new P.a(this,ma);break;case 52:Ob=
new da.a(this,ma);break;case 53:Ob=new xa.a(this,ma);break;case 54:Ob=new m(this,ma);break;case 5:Ob=new y(this,ma);break;case 57:Ob=new D(this,ma,-1753056834);Cb?(Cb=Cb.Directive,Ia.a.tq(Cb)||"&nbsp;"===Cb||(Ob.message=Cb)):ab&&(Ob.message=ab);break;case 58:Ob=new n(this,ma);break;case 59:Ob=new P.a(this,ma);break;case 60:case 63:Ob=new v(this,ma,M.a.TDi);break;case 61:Ob=new f(this,ma,M.a.bNg,-8805455);break;case 66:Ob=new f(this,ma,M.a.d5i,1461300262);break;case 62:Ob=qb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerBusinessBarTeachingCallout",
!1)?new c(this,ma,515196233,13,3E5,"OptimizeWorkbookManager.ShowBusinessBarTeachingCallout"):new D(this,ma,515196233);break;case 64:Ob=new d(this,ma,this.$,ya);break;default:Ob=new z(this,ma,Cb,7)}Ob.s2c();return Ob};a.V2e=function(){var Ob=Ha.a.VLa()?263:262;return a.Vte||(a.Vte=[new B(0,278,279,280,0,0,a.nia,1,"BB_UnableToRefreshLock"),new B(1,278,279,280,0,0,a.nia,1,"BB_UnableToRefreshLockExpected"),new B(2,270,271,0,0,0,a.Rz,5,"BB_WorkbookAlmostTooLarge"),new B(3,272,273,274,0,0,a.nia,1,"BB_WorkbookTooLarge"),
new B(4,261,Ob,0,0,0,a.Rz,5,"BB_ExternalWorkbookLinksDisabled"),new B(5,265,264,266,0,0,a.nia,1,"BB_ExternalWorkbookLinksShowError"),new B(6,267,268,269,0,0,a.Ki,0,"BB_EditAndRefreshDisabledOnBIAHostedFiles"),new B(7,253,254,255,0,0,a.Ki,0,"BB_UnsupportedFeatures"),new B(8,0,0,0,0,0,a.Ki,0,"BB_CollabDataAndDataStringsLocaleMismatch"),new B(9,0,0,0,0,0,a.Ki,0,"BB_CollabDataStringsLocaleMismatch"),new B(10,0,0,0,0,0,a.Ki,0,"BB_CollabDataLocaleMismatch"),new B(11,281,282,283,0,0,a.nia,1,"BB_LastGenericStatusError"),
new B(12,284,285,286,0,0,a.Rz,5,"BB_ScratchPadWarning"),new B(13,287,288,289,0,0,a.nia,1,"BB_AuthenticationLost"),new B(14,290,291,292,0,0,a.Rz,5,"BB_OdfCompatibilityIssues"),new B(15,0,578,0,0,0,a.Rz,5,"BB_PivotChartInteractivityMissingWarning"),new B(16,0,0,0,0,0,a.Ki,0,"BB_WorkbookIsIrmProtected"),new B(17,0,0,0,0,0,a.Ki,0,"BB_BIFeatureNotAvailable"),new B(18,293,294,289,0,0,a.Rz,5,"BB_AnonymousCreateMode"),new B(19,256,257,0,0,0,a.Rz,5,"BB_UnsupportedInteractiveReportEditing"),new B(20,0,0,0,
0,0,a.Ki,0,"BB_MobileAppCampaignBizBar"),new B(21,299,300,0,0,0,a.Ki,0,"BB_TransientServerCommunicationFailures"),new B(22,1623,1634,1635,0,0,a.Ki,0,"BB_EditAttemptInReadOnly"),new B(23,1623,1634,0,0,0,a.Ki,0,"BB_EditAttemptInReadOnlyNoEditPermissions"),new B(24,0,ua.HelperMethods.gPj(),1612,0,0,a.Ki,0,"BB_UnsupportedBrowser"),new B(25,302,303,0,0,0,a.Ki,0,"BB_ReadOnlyPermissions"),new B(26,304,305,0,0,0,a.Ki,0,"BB_DocumentIsIrmProtectedWarning"),new B(27,0,0,0,0,0,a.Rz,5,"BB_PolicyWarningMessage"),
new B(28,1266,301,0,0,0,a.Ki,0,"BB_WorkingOnIt"),new B(29,1623,1621,1622,0,0,a.Ki,0,"BB_PasswordProtectedWorkbookLockedForEdit"),new B(30,1636,1637,1638,0,0,a.Ki,0,"BB_WorkbookIsReadOnlyRecommended"),new B(31,1623,1639,1640,0,0,a.Ki,0,"BB_WorkbookHasPasswordToModify"),new B(32,1623,1641,1644,0,0,a.Ki,0,"BB_LegacySharedWorkbookEditWarning"),new B(33,1631,1642,255,0,0,a.Ki,0,"BB_LegacyConnectionsWarning"),new B(34,1632,1633,0,0,0,a.Ki,0,"BB_GroupedSlicers"),new B(35,315,316,0,0,0,a.Rz,5,"BB_ThirdPartyAddinDisabled"),
new B(36,1764,1765,0,0,1766,a.Ki,0,"BB_FinanceLinkedEntityDisclaimerBar"),new B(37,1793,1794,0,0,0,a.Rz,5,"BB_WolframDeprecationAlertBar"),new B(38,0,0,0,0,0,a.Ki,0,"BB_WacGdprNotice"),new B(39,0,0,0,0,0,a.Ki,0,"BB_AutomaticSensitivityLabel"),new B(40,0,0,0,0,0,a.Ki,0,"BB_RecommendedSensitivityLabel"),new B(41,0,0,0,0,0,a.Ki,0,"BB_MandatorySensitivityLabel"),new B(42,317,318,319,0,0,a.Ki,0,"BB_LocalStorageDisabled"),new B(43,635,636,0,0,0,a.Ki,0,"BB_AutoRefreshDisabled"),new B(44,1006,1004,1008,1295,
0,a.Ki,0,"BB_CorruptedFileRepaired"),new B(45,1007,1005,1008,1295,0,a.Ki,0,"CorruptedOdsFileRepaired"),new B(46,275,276,277,0,0,a.Rz,5,"BB_MinorVersionLimitReached"),new B(47,306,307,0,0,0,a.Rz,5,"BB_SensitivityApplicationGenericError"),new B(48,308,310,0,0,0,a.Rz,5,"BB_SensitivityApplicationTooLargeFileError"),new B(49,309,310,0,0,0,a.Rz,5,"BB_SensitivityApplicationLabelNotSupportedError"),new B(50,311,312,0,0,0,a.Rz,5,"BB_SensitivityApplicationLabelDisabledError"),new B(51,313,314,0,0,0,a.Rz,5,
"BB_SensitivityApplicationMandatoryConflictError"),new B(52,0,0,0,0,0,a.Rz,5,"BB_SensitivityApplicationMinorVersionLimitReachedError"),new B(53,0,0,0,0,0,a.Rz,5,"BB_SensitivityApplicationSetLabelError"),new B(54,2089,2090,2091,2094,0,a.Ki,0,"BB_ExternalWorkbookLinksPromptEnableContent"),new B(55,299,300,0,0,0,a.Ki,0,"BB_NetworkDown"),new B(56,320,321,322,0,0,a.Ki,0,"BB_DefaultToViewDueToCogs"),new B(57,1790,1791,1792,0,0,a.Ki,0,"BB_RefreshLinkedEntityErrorBar"),new B(58,1767,1768,1769,1770,0,a.Ki,
0,"BB_LinkedEntitiesUntrustedImagesDisabled"),new w(59,252,0,0,0,a.Ki,0,"BB_CanvasHealth"),new B(60,323,324,0,0,325,a.Ki,0,"BB_NovModeDepreciation"),new B(61,1009,1010,1295,0,1011,a.Ki,0,"BB_MismatchedFileFormatConverted"),new B(62,2204,2205,2206,0,0,a.Ki,0,"BB_OptimizeWorkbook"),new B(63,326,327,0,0,328,a.Ki,0,"BB_NovModePostDepreciation"),new B(64,0,0,0,0,0,a.Ki,0,"BB_OfficeScriptsRunning"),new B(65,2182,2183,0,0,2185,a.Ki,0,"BB_PowerQueryRefreshDataSourceNotSupported"),new B(66,329,330,0,0,331,
a.Ki,0,"BB_ReadOnlyPivotTable"),new B(67,2182,2184,0,0,2185,a.Ki,0,"BB_PowerQueryRefreshHostNotSupported")])};Mf.Object.defineProperties(a.prototype,{Yd:{configurable:!0,enumerable:!0,get:function(){return V.a.iYc}},ic:{configurable:!0,enumerable:!0,get:function(){return this.domElement}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return this.get_visible()}},$:{configurable:!0,enumerable:!0,get:function(){return this.jb}}});a.nia=yb.a.qph;a.Rz=yb.a.sph;a.Ki=yb.a.rph;a.Vte=null;
Object(u.a)(a,"BusinessBarControl",K.a,[448])},1354:function(u,E,b){function a(){Type.registerNamespace("Common.App.SaveToSharePoint");c.main()}function c(){this.cra=this.OMc=this.JMc=this.fb=null}function d(V,Ia,Ha,ob,ib){this.qm=this.xCa=null;this.cEc=!1;this.CPc=this.E8=null;this.RRc=Ia;this.Bkb=Ha;this.ps=ob;this.Re=ib;this.La=V}function e(V){this.dFa=V.appSettings.SaveAsToHostWebServiceBase;this.dA=V.appSettings.FileName;this.lfa=V.Wa("SharePointSaveAsHandler")||"sharepointsaveashandler.ashx"}
function k(V,Ia,Ha,ob,ib,La,zb,Fb){this.cFa=V;this.dA=Ia;this.pVa=ob;this.xOc=La;this.E8=Ha;this.$vg=ib;this.lfa=zb;this.xh=Fb}function l(V,Ia,Ha,ob){this.xh=this.Lae=null;this.WEa=V;this.ps=Ia;this.vNc=Ha;this.Re=ob}function n(V,Ia,Ha,ob,ib,La,zb){this.ib=V;this.HHc=Ha;this.La=Ia;this.blb=ob;this.aib=ib;this.vNc=La;this.rlg=zb}function f(){return ja.call(this)||this}function v(V,Ia,Ha,ob){var ib=this;this.yo=this.bkb=null;this.aib=V;this.Re=Ha;this.mtg=ob;this.pDa=new x.a(function(){return new R.a(Ia.value,
Object(T.a)(ib,ib.uvb,"getMoreInfoEventReceived"))})}function r(V,Ia,Ha,ob,ib,La,zb,Fb,Yb,kb){this.La=Ia;this.ib=V;this.sX=ob;this.nga=La;this.ps=ib;this.Re=Ha;this.Dee=zb;this.wrg=void 0===Fb?null:Fb;this.WEa=void 0===Yb?null:Yb;this.hXa=void 0===kb?null:kb}function y(V,Ia,Ha,ob,ib,La,zb,Fb,Yb){this.NLc=null;this.dA="";this.blb=V;this.ps=Ia;this.xh=Yb;this.nga=Ha;this.Re=ib;this.xv=ob;this.WEa=zb;this.hXa=Fb;La&&(this.NLc=new x.a(function(){return new R.a(La.value,null)}))}function m(){this.properties=
this.friendlyPath=this.folderName=null}function w(){this.extension=this.fileName=null;this.enableMoreLocations=!1;this.saveLocations=this.scenario=null}function B(V,Ia,Ha,ob,ib,La,zb,Fb){V=C.call(this,V,Ia,Ha,ob,ib,La,Fb)||this;V.By=null;V.GPc=null;V.Vpa=null;V.XRg=CommonUIStrings.l_SaveToAnotherFolder;V.Vf=A.Vf;V.ye="FileNameDialog-SaveToSharePoint";V.blb=zb;V.Rsg=Fb;return V}function A(){}function z(){var V=G.call(this)||this;V.Rb=0;V.mc(1,CommonUIStrings.l_DialogClose);return V}u=b(0);var x=b(615),
D=b(14),I=b(135),F=b(52),G=I.StandardDialog;Rk(z,G);z.prototype.displayError=function(V,Ia){this.uHe(V,Ia,F.a.Qij)};z.prototype.uHe=function(V,Ia,Ha){D.ULS.sendTraceTag(25180161,216,10,"Show upload error dialog with error code {0}.",Ha);this.Iz(Ha,V,Ia,null)};z.prototype.O5c=function(V,Ia){D.ULS.sendTraceTag(25235986,216,15,"Show warning dialog of Picker related issue.");this.Iz(F.a.Sij,V,Ia,null,!0)};Object(u.a)(z,"ErrorDialog",I.StandardDialog,[43]);var T=b(84);I=b(1253);var O=b(150);Mf.Object.defineProperties(A,
{Vf:{configurable:!0,enumerable:!0,get:function(){return O.a.No(A.qk,CommonUIStrings.l_FileNameLabel,CommonUIStrings.l_NewFileLocationLabel,CommonUIStrings.l_CurrentOnlineFolder,"")}}});A.qk="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='DocumentLocationBlock'> <label id='locationName' class='WACDialogLabel' for='locationName' >{1}</label> <div class='FolderLocationDiv' id='folderLocation'> <label id='currentLocation' class='WACDialogLabel' for='currentLocation' >{2}</label> <span id='anotherFolder' class='WACDialogSpan'>{3}</span> </div> </div>";
Object(u.a)(A,"FileNameDialogHtml",null,[]);var U=b(4),J=b(13),H=b(43),K=b(86),N=b(88),M=b(29),C=I.a;Rk(B,C);B.prototype.YP=function(V){var Ia=M.a.nq(U.AFrameworkApplication.am.Pm),Ha=U.AFrameworkApplication.breadcrumbFolderName,ob=U.AFrameworkApplication.breadcrumbBrandName,ib={};ib=(ib.txtFileName=V||Ia,ib);var La=CommonUIStrings.L_SaveAs;2===U.AFrameworkApplication.ta.Qa.Cj&&(La=CommonUIStrings.L_SaveACopy);this.initializeAndShow(La,Object(T.a)(this,this.h9b,"fileNameDialogHandler"),ib);this.bHe(V,
Ia);this.cIa.style.width="450px";Sys.UI.DomElement.addCssClass(document.getElementById("DocumentLocationBlock"),"SaveAsDialogRow");U.AFrameworkApplication.fa.qa("HideSaveToAnotherFolderButtonforUIHost")||(this.By=document.getElementById("anotherFolder"),V=document.getElementById("folderLocation"),this.GPc=N.a.ype(V,this.By,"anotherFolderDescribedBy"),this.By.className="WACButton WACDialogButtonNormal",V=!1,Ha&&Ha.length?(this.ake(this.By,this.GPc,String.format(CommonUIStrings.l_ScreenReader_CurrentFileLocation,
ob,Ha)),V=this.Uzg(ob,Ha)):this.ake(this.By,this.GPc,CommonUIStrings.l_CurrentOnlineFolder),this.QAg(this.By),this.Wzg(this.By),V?(document.getElementById("currentLocation").style.width="100%",Sys.UI.DomElement.addCssClass(this.By,"SaveToAnotherLocationTwo"),D.ULS.sendTraceTag(24459297,216,50,"Move save to another folder button to second line.")):Sys.UI.DomElement.addCssClass(this.By,"SaveToAnotherLocationOne"),H.a.addHandler(this.By,J.a.click,Object(T.a)(this,this.zAd,"onSaveToAnotherLocationClick")),
H.a.addHandler(this.By,J.a.Lb,Object(T.a)(this,this.QAf,"onSaveToAnotherLocationKeyDown")))};B.prototype.Uzg=function(V,Ia){var Ha=!1;var ob=document.getElementById("currentLocation");ob.innerText="";var ib=this.RZe(ob,V),La=this.RZe(ob,Ia),zb=255,Fb=255;255<ib+La&&(zb=Math.max(238,408-ib),Fb=Math.max(170,408-La),Ha=!0);this.nCg(ob,V,Fb,Ia,zb);return Ha};B.prototype.RZe=function(V,Ia){var Ha=document.createElement("div");Ha.innerText=Ia;Ha.style.visibility="hidden";V.appendChild(Ha);Ia=Ha.clientWidth;
V.removeChild(Ha);return Ia};B.prototype.nCg=function(V,Ia,Ha,ob,ib){Ia&&(this.Zje(V,Ia,Ha),this.fCg(V));ob&&this.Zje(V,ob,ib)};B.prototype.Zje=function(V,Ia,Ha){var ob=document.createElement("div");ob.innerText=Ia;ob.title=Ia;ob.className="SaveToAnotherFolderBreadcrumb";ob.style.maxWidth=Ha.toString()+"px";V.appendChild(ob)};B.prototype.fCg=function(V){var Ia=document.createElement("span");Ia.id="FolderSeparator";var Ha=document.createElementNS("http://www.w3.org/2000/svg","svg");Ha.setAttribute("class",
"SeparatorCaret");var ob=document.createElementNS("http://www.w3.org/2000/svg","polygon");ob.setAttribute("points","1 4 1 11 5 7.5");Ha.appendChild(ob);Ia.appendChild(Ha);V.appendChild(Ia)};B.prototype.ake=function(V,Ia,Ha){Ha=String.format(CommonUIStrings.l_ScreenReader_SaveToAnotherFolderButton,Ha);Ia&&(Ia.innerText=Ha);V.tabIndex=0;V.setAttribute(N.a.Hd,N.a.Fs)};B.prototype.Wzg=function(V){var Ia=document.createElement("span");Ia.id="anotherFolderText";Ia.innerText=this.XRg;Ia.className="AnotherFolderTextSpan";
V.appendChild(Ia)};B.prototype.QAg=function(V){var Ia=document.createElement("span");Ia.className="cui-img-cont-float cui-img-16by16 ";this.Vpa=document.createElementNS("http://www.w3.org/2000/svg","svg");this.Vpa.setAttribute("class","FolderIconSVG");var Ha=document.createElementNS("http://www.w3.org/2000/svg","path");Ha.setAttribute("d","M0,14V4L1.25,3h6.5L9.606,1H13.25L14,2V6h1.5L16,7.25,14.25,14H0ZM13,6V2H10L8.25,4,1.957,3.914,1,4.75V12L3.25,6.75l1-.75H13Z");this.Vpa.appendChild(Ha);Ia.appendChild(this.Vpa);
V.appendChild(Ia)};B.prototype.QAf=function(V){!V||V.keyCode!==K.a.Oh&&V.keyCode!==K.a.X0||this.zAd(V)};B.prototype.zAd=function(){if(this.KI){var V=M.a.Z3(U.AFrameworkApplication.fileName),Ia=this.KI.value;this.hide();Ia&&""!==Ia&&""!==V||1===this.ta.state?(""!==V&&(Ia+=V),this.i9b(Ia)?this.ps.create().displayError(1,Ia,!1):this.blb.start(Ia,this.Rsg)):this.ps.create().displayError(2,Ia,!1)}};B.prototype.FVg=function(V){this.By&&this.Vpa&&(V?(this.By.tabIndex=0,Sys.UI.DomElement.removeCssClass(this.By,
"DisabledSaveAsButton"),Sys.UI.DomElement.removeCssClass(this.Vpa,"DisabledFolderIconSVG")):(this.By.tabIndex=-1,Sys.UI.DomElement.containsCssClass(this.By,"DisabledSaveAsButton")||Sys.UI.DomElement.containsCssClass(this.Vpa,"DisabledFolderIconSVG")||(Sys.UI.DomElement.addCssClass(this.By,"DisabledSaveAsButton"),Sys.UI.DomElement.addCssClass(this.Vpa,"DisabledFolderIconSVG"))))};B.prototype.chd=function(){C.prototype.chd.call(this);this.FVg(!!this.KI&&""!==this.KI.value)};B.prototype.dispose=function(){this.By&&
(H.a.removeHandler(this.By,J.a.click,Object(T.a)(this,this.zAd,"onSaveToAnotherLocationClick")),H.a.removeHandler(this.By,J.a.Lb,Object(T.a)(this,this.QAf,"onSaveToAnotherLocationKeyDown")),this.By=null);C.prototype.dispose.call(this)};Object(u.a)(B,"FileNameDialog",I.a,[74]);var Q=b(894),P=b(616),ka=b(202),R=b(1019),fa=b(1114),ca=b(99),ea=b(136);Object(u.a)(w,"SaveAsDialogInput",null,[]);Object(u.a)(m,"SaveLocation",null,[]);var wa=b(391),X=b(190);y.prototype.nLh=function(){var V=new Q.a(P.a.Ik());
V.ia("type","currentHost");return Object.assign(new m,{folderName:this.xv.breadcrumbFolderName,friendlyPath:this.xv.breadcrumbBrandName,properties:V})};y.prototype.ami=function(V){return!!V&&"ClassicMru"===V.type&&!!V.service_info&&!!V.service_info.service_id&&-1!==V.service_info.service_id.indexOf("SHAREPOINT")};y.prototype.IWh=function(){if(!this.NLc||!this.WEa)return null;var V=this.NLc.value.uZ("SaveAsToSharePointDialog",!1);if(!V||3!==V.state||!V.Kpf)return null;V=V.Kpf;for(var Ia=new ka.a,Ha=
0,ob=0,ib=0;ib<V.length;ib++){var La=V[ib];if(this.ami(La)&&(Ha++,La.sharepoint_info)){var zb=La.url,Fb=La.sharepoint_info.site_url,Yb=La.title;La=fa.b(La,U.AFrameworkApplication.isRtl);if(zb&&Fb&&Yb&&La){ob++;var kb=new Q.a(P.a.Ik());kb.ia("type","SharePoint");kb.ia("siteUrl",Fb);kb.ia("folderUrl",zb);ob++;Ia.add(Object.assign(new m,{folderName:Yb,friendlyPath:La,properties:kb}))}}}ib=new Map;ib.set("NumPlaces",V.length.toString());ib.set("NumSharepointPlaces",Ha.toString());ib.set("placesWithMetadata",
ob.toString());ca.Health.instance.recordKpiUsage("SharePointSaveAsDialogMru",0,"smartfio",ib);0<Ha&&(ob?.5>1*ob/Ha&&ca.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","PartialPlacesMetadataMissing",!1,!1,null):ca.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","AllPlacesMetadataMissing",!1,!1,null));return Ia};y.prototype.eMh=function(){var V=new ka.a;V.add(this.nLh());var Ia=this.IWh();Ia&&V.addRange(Ia);return Object.assign(new w,{enableMoreLocations:!U.AFrameworkApplication.fa.qa("HideSaveToAnotherFolderButtonforUIHost"),
fileName:this.dA,extension:M.a.Z3(this.xv.Pm),saveLocations:V.toArray(),scenario:"SaveToSharePoint"})};y.prototype.wac=function(){return{inputPropsCallback:Object(T.a)(this,this.eMh,"getDialogInput")}};y.prototype.YP=function(V){this.dA=V;this.dA||(this.dA=String.format(CommonUIStrings.l_SaveACopy_Filename,M.a.nq(this.xv.Pm)));V={};V=(V.id="SaveAsDialog",V.bodyControls=this.wac(),V);var Ia=CommonUIStrings.L_SaveAs;2===this.Re.Qa.Cj&&(Ia=CommonUIStrings.L_SaveACopy);var Ha=new O.a(!1,!1,!0);Ha.Rb=
1;Ha.ye="SaveAsDialog";Ha.mc(1,CommonUIStrings.l_SaveButtonLabel);Ha.initializeAndShow(Ia,Object(T.a)(this,this.Mij,"saveAsDialogHandler"),V)};y.prototype.Lzj=function(V,Ia){V&&""!==V&&""!==Ia||1===this.Re.state?this.$li()?this.Dsi(V,Ia):(""!==Ia&&(V+=Ia),this.blb.start(V,this.xh)):(D.ULS.sendTraceTag(579179796,216,10,"filename is empty but dialog should have handled this error case"),this.ps.create().displayError(2,V,!1))};y.prototype.Dsi=function(V,Ia){var Ha=this;ca.Health.instance.recordKpiUsage("SaveACopySFP",
0,"smartfio",null);var ob=this.hXa.GCe(CommonUIStrings.l_PickerSaveACopyOkButton,CommonUIStrings.l_PickerSaveACopyTitle,!1,!0,null,"SaveACopy",2);this.hXa.fdd(ob).then(function(ib){if(ib&&0<ib.length){var La=ib[0][wa.a.uXi];ib=ib[0][wa.a.FFf];if(""!==La&&""!==ib)Ha.WEa.Nna(ib,V+Ia,La,Ha.xh),ca.Health.instance.recordKpiSuccess("SaveACopySFP",null);else{Ha.ps.create().displayError(0,V,!1);var zb=ea.a.Cr();zb&&(zb.set("SiteUrlAvailable",""===La?"false":"true"),zb.set("FolderUrlAvailable",""===ib?"false":
"true"));ca.Health.instance.recordKpiFailure("SaveACopySFP","Not all values Available to start upload",!1,!1,Object.assign(new X.a,{extendedProperties:zb}))}}else Ha.ps.create().displayError(0,V,!1),ca.Health.instance.recordKpiFailure("SaveACopySFP","Picker Data is unavaliable",!1,!1,null)}).catch(function(ib){"Canceled"===ib?((ib=ea.a.Cr())&&ib.set("IsCanceled","true"),ca.Health.instance.recordKpiSuccess("SaveACopySFP",Object.assign(new X.a,{extendedProperties:ib}))):ca.Health.instance.recordKpiFailure("SaveACopySFP",
ib,!1,!1,null)})};y.prototype.$li=function(){return this.hXa?this.hXa.Gpd():(D.ULS.sendTraceTag(572343636,216,50,"_sharedFilePickerManager is null"),!1)};y.prototype.Mij=function(V,Ia){if(Ia&&1===V){V=Ia.fileName;var Ha=M.a.Z3(this.xv.Pm);Ia.moreLocationsSelected&&this.Lzj(V,Ha);if(Ia.locationCallback){var ob=Ia.locationCallback();ob?ob.properties&&"currentHost"===ob.properties.na("type")?this.nga.Nna(V+Ha,!1,this.xh):ob.properties&&"SharePoint"===ob.properties.na("type")?(Ia=ob.properties.na("siteUrl"),
ob=ob.properties.na("folderUrl"),this.WEa.Nna(ob,V+Ha,Ia,this.xh)):D.ULS.sendTraceTag(579179799,216,10,"unknown location type sent back"):D.ULS.sendTraceTag(579179798,216,10,"selected location is empty")}else D.ULS.sendTraceTag(579179797,216,10,"locationCallback is empty")}};Object(u.a)(y,"ReactSaveAsDialog",null,[74]);r.prototype.create=function(V){return this.Re&&this.Re.Qa.Vu?new y(this.Dee,this.ps,this.nga,U.AFrameworkApplication.am,this.Re,this.wrg,this.WEa,this.hXa,V):new B(this.ib,this.La,
this.Re,this.sX,this.ps,this.nga,this.Dee,V)};Object(u.a)(r,"FileNameDialogFactory",null,[39]);v.prototype.start=function(V){var Ia=this;if(!this.BDf)if(U.AFrameworkApplication.breadcrumbFolderUrl&&U.AFrameworkApplication.breadcrumbFolderUrl.length)this.bkb=U.AFrameworkApplication.breadcrumbFolderUrl;else return D.ULS.sendTraceTag(23881884,216,10,"CachedGetMoreInfoResult is null, can't get OneDrive for Bussiness page url. BreadcrumbFolderUrl is null. Get more info result is null: ",!this.yo),!1;var Ha=
this.mtg();Ha.eAj();var ob=Ha.hTh();if(!ob)return D.ULS.sendTraceTag(24664067,216,10,"Picker container is null, will not show picker."),!1;this.aib.start(function(ib,La){Ha.hide();V(ib,La)},function(){Ia.cOa(Ha)},ob,this.bkb);return!0};v.prototype.cOa=function(V){V.hide();D.ULS.sendTraceTag(24664068,216,50,"User cancelled save to another folder.")};v.prototype.ASh=function(V){V=V.toLowerCase();V.endsWith("/")||(V+="/");var Ia=V.indexOf("/documents/");return-1!==Ia?V.substring(0,Ia+1)+"_layouts/15/onedrive.aspx":
""};v.prototype.uvb=function(V){this.yo||3!==V.state||(this.yo=V)};Mf.Object.defineProperties(v.prototype,{BDf:{configurable:!0,enumerable:!0,get:function(){this.bkb||(this.pDa.value.uZ("Save As",!0),this.yo&&this.yo.pR&&this.yo.pR.length&&(this.bkb=this.ASh(this.yo.pR)));return this.bkb}}});Object(u.a)(v,"OneDriveFilePickerHelper",null,[42]);var ja=O.a;Rk(f,ja);f.prototype.eAj=function(){this.wGc="FilePickerDialog";this.Vf="<div class='FilePickerDiv' id='FilePickerDiv'></div>";this.ye="PickerDialog-MsoSp";
this.showDialog("",null)};f.prototype.hTh=function(){return document.getElementById("FilePickerDiv")};f.prototype.fO=function(){};f.prototype.sPa=function(){};Object(u.a)(f,"PickerDialog",O.a,[44]);var va=b(739),ua=b(1046),Xa=b(392),aa=b(27),ba=b(107),oa=b(25);n.prototype.Bg=function(){var V=this,Ia=this.aib.K3a();Ia?aa.a.pka||this.ib.qa("SaveToSharePointOnDemandDownloadJsIsEnabled")?this.La.He(oa.a.saveToSharePoint,ba.a.frame,Object(T.a)(this,this.LUf,"saveToSharePointActionDispatcher"),64):(Ia.K7a.continueWith(function(Ha){Ha.Xf&&
V.aib.Pzd(Ha)}),this.i1b()):D.ULS.sendTraceTag(25180162,216,15,"Failure with OneDrive API download as the js url is empty.")};n.prototype.i1b=function(){Xa.a.PGd(Object(T.a)(this,this.LUf,"saveToSharePointActionDispatcher"));Xa.a.o7c([new ua.a(oa.a.saveToSharePoint,ba.a.frame,0)],this.aib.K3a())};n.prototype.LUf=function(V,Ia,Ha,ob,ib){return Ia.contextId!==ba.a.frame||V!==oa.a.saveToSharePoint?2:this.V6a&&(this.vNc.BDf||this.qve)?1===Ha?va.SessionStatusManager.instance.Dwb||U.AFrameworkApplication.Y4?
8:this.rlg()?32:8:2===Ha?(D.ULS.sendTraceTag(23881885,216,50,"User clicked on SaveToSharePoint button from "+(ib&&ib.SaveEntryPoint&&"VersionHistory"===ib.SaveEntryPoint.toString()?"version history.":"the backstage.")),this.qve?(D.ULS.sendTraceTag(24524226,216,50,"Show save a copy dialog."),this.HHc.create(ib).YP(null)):(D.ULS.sendTraceTag(24524225,216,50,"No permission save to current folder, show Picker to save to another folder."),this.blb.start(null,ib)),32):8:8};Mf.Object.defineProperties(n.prototype,
{V6a:{configurable:!0,enumerable:!0,get:function(){return this.ib.qa("SaveToAnotherFolderBrsIsEnabled")}},qve:{configurable:!0,enumerable:!0,get:function(){return this.ib.qa("UserCanWriteRelative")}}});Object(u.a)(n,"SaveToSharePointActor",null,[]);l.prototype.start=function(V,Ia){var Ha=this;D.ULS.sendTraceTag(25180163,216,50,"Try launch Picker.");this.Lae=V;this.xh=Ia;this.vNc.start(function(ob,ib){Ha.T0i(ob,ib)})||this.lRd()};l.prototype.T0i=function(V,Ia){if(V)this.onSuccess(Ia);else this.e6(Ia)};
l.prototype.lRd=function(){1!==this.Re.state&&this.ps().O5c(CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError)};l.prototype.onSuccess=function(V){D.ULS.sendTraceTag(23881886,216,50,"Success Callback called. Calling UploadToSharePointManager to start upload.");if(V&&V.data&&V.data.value&&V.data.value.length&&V.data.value[0].sharePoint){var Ia=V.data.value[0].sharePoint.url;V=V.data.value[0].sharePoint.listUrl;var Ha=null;if(Ia&&(Ha=V?this.dXh(V):this.cXh(Ia))){this.WEa.Nna(Ia,
this.Lae,Ha,this.xh);return}D.ULS.sendTraceTag(25180164,216,10,"Picker return invalid data, folder url is null: {0}, siteUrl url is null: {1}.",!Ia,!Ha)}D.ULS.sendTraceTag(23881887,216,10,"Picker return invalid data or empty SharePoint url.");this.lRd()};l.prototype.cXh=function(V){V.endsWith("/")||(V+="/");for(var Ia=0,Ha=0;Ha<V.length;Ha++)if("/"===V.charAt(Ha)&&5===++Ia)return V.substr(0,Ha);return null};l.prototype.dXh=function(V){V.endsWith("/")&&(V=V.substring(0,V.length-1));var Ia=V.lastIndexOf("/");
return-1!==Ia?V.substring(0,Ia):null};l.prototype.e6=function(V){D.ULS.sendTraceTag(23881888,216,10,"Picker failure Callback called.");V&&V.error?D.ULS.sendTraceTag(23881889,216,10,"File Dialog returned with error code:{0}, and error message: {1}.",V.error.errorCode,V.error.message):D.ULS.sendTraceTag(23881890,216,10,"File Dialog returned empty error.");this.lRd()};Object(u.a)(l,"SaveToSharePointManager",null,[684]);var ra=b(81);k.prototype.execute=function(V,Ia){if(!U.AFrameworkApplication.Ag&&U.AFrameworkApplication.qd){var Ha=
this.cFa+this.lfa;Ha=ra.a.wl(Ha,"fu",M.a.$e(this.E8));Ha=ra.a.wl(Ha,"su",M.a.$e(this.$vg));Ha=ra.a.wl(Ha,"fn",M.a.$e(this.dA));Ha=ra.a.wl(Ha,"n",M.a.$e((new Date).getTime().toString()));this.xh&&this.xh.FileDownloadUrl&&(Ha=ra.a.wl(Ha,"furl",M.a.$e(this.xh.FileDownloadUrl)));Ha=Ha+"&"+this.xOc;this.pVa&&this.pVa.length?Ha=ra.a.wl(Ha,"fnn",M.a.$e(this.pVa)):D.ULS.sendTraceTag(23881891,216,15,"No new file name in request.");D.ULS.sendTraceTag(23881920,216,50,"Trying send SharePointSaveAsHandler.ashx request.");
U.AFrameworkApplication.qd.Yl(Ha,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,V,Ia,null,void 0,void 0,void 0,void 0,"9")}};Object(u.a)(k,"SharePointSaveAsCaller",null,[714]);e.prototype.create=function(V,Ia,Ha,ob){return new k(this.dFa,this.dA,V,Ia,Ha,U.AFrameworkApplication.Yi,this.lfa,ob)};Object(u.a)(e,"SharePointUploadCallerFactory",null,[683]);var db=b(41),Ka=b(39),Ga=b(246),xa=b(897),da=b(170),qa=b(740),na=b(977);d.prototype.Nna=function(V,Ia,Ha,ob){this.cEc=!1;D.ULS.sendTraceTag(23881921,
216,50,"UploadToSharePointManager.StartUpload : Starting to upload file");this.PLb();this.E8=V;ob&&ob.SaveEntryPoint&&(this.CPc=ob.SaveEntryPoint);this.xCa=this.RRc.create(V,Ia,Ha,ob);ob&&"true"===ob.SkipSaveToHost?this.gQ():this.rCh()};d.prototype.rCh=function(){function V(){D.ULS.sendTraceTag(23881923,216,15,"The file change is not saved successfully, this operation may lead to data loss.");Ia.gQ()}var Ia=this;32!==this.La.$d(oa.a.CQa,2,[function(){D.ULS.sendTraceTag(23881922,216,50,"Call the force save file change successfully.");
Ia.gQ()},V])&&V()};d.prototype.gQ=function(){D.ULS.sendTraceTag(23881924,216,50,"Send SharePointSaveAsHandler.ashx request.");this.xCa.execute(Object(T.a)(this,this.CQi,"onSaveToSharePointUploadFinished"),Object(T.a)(this,this.BQi,"onSaveToSharePointUploadFailed"))};d.prototype.CQi=function(V){if(V&&V.data&&V.data.Td){var Ia=db.d(V.data.Td);var Ha=Ia.Lt;if(Ia.returnValue)if(Ha.StatusCode!==Ga.a.JO&&Ha.StatusCode!==Ga.a.prb)D.ULS.sendTraceTag(25235987,216,15,"UploadToSharePointManager upload failed with status: {0}, status code: {1}.",
V.data.status,Ha.StatusCode),Ha.StatusCode!==Ga.a.CRf&&this.SHe(V.data.status)||(this.kda(Ha.StatusCode.toString()),this.Ryj(Ha.StatusCode));else{D.ULS.sendTraceTag(23881927,216,50,"UploadToSharePointManager upload success.");this.EJd();try{Ha.NewDocumentUrl?this.EPa(Ha.NewDocumentUrl):this.FPa()}catch(ob){D.ULS.sendTraceTag(37025729,216,15,"Redirect failed with exception: {0}",ob.toString())}}else Ha={},D.ULS.sendTraceTag(23881926,216,10,"Failed to deserialize : {0}",(Ha.ResponseData=na.a.ueb(V.data.Td),
Ha)),this.P6b()||(this.kda("Failed to deserialize response"),this.NLb())}else D.ULS.sendTraceTag(23881925,216,10,"Upload failure. Response data is null"),this.P6b()||(this.kda("Unknown"),this.NLb())};d.prototype.BQi=function(V){V&&V.data?this.SHe(V.data.status)||(D.ULS.sendTraceTag(23881929,216,10,"Upload failed."),this.kda(xa.a[V.data.status]),this.NLb()):(D.ULS.sendTraceTag(23881928,216,10,"Upload failure. Response data is null"),this.P6b()||(this.kda("Unknown"),this.NLb()))};d.prototype.P6b=function(){if(!this.cEc)return D.ULS.sendTraceTag(23881930,
216,10,"Upload fail. Retrying."),this.cEc=!0,this.gQ(),!0;D.ULS.sendTraceTag(23881931,216,10,"Upload fail. Already retry once but still fail.");return!1};d.prototype.SHe=function(V){D.ULS.sendTraceTag(23881932,216,10,"HTTP failure with code: {0}",V);return this.P6b()};d.prototype.FPa=function(){D.ULS.sendTraceTag(23881933,216,50,"Redirecting to Folder.");Ka.a.Ze(this.E8,Ka.a.jX(3),void 0,"UploadToSharePointManager.RedirectToFolder")};d.prototype.EPa=function(V){var Ia=!1,Ha=!1;U.AFrameworkApplication.fa&&
(Ia=U.AFrameworkApplication.fa.qa("SaveACopyIsEnabledForUiHost"),Ha=U.AFrameworkApplication.fa.qa("UiHostSupportsDocRebootFeatures"));D.ULS.sendTraceTag(23881934,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",V,Ia);if(Ia&&Ha){D.ULS.sendTraceTag(51245198,216,50,"UploadToSharePointManager.RedirectToEditUrl: Sending DocumentRefresh post message.");var ob={};ob[wa.a.zPa]="1";ob[wa.a.documentUrl]=V;ob[wa.a.reason]=qa.a.saveAs;U.AFrameworkApplication.$U().execute(function(ib){ib.uj(da.a.Eta,
ob)})}else Ka.a.Ze(V,Ka.a.jX(3),void 0,"UploadToSharePointManager.RedirectToEditUrl")};d.prototype.PLb=function(){this.Re&&1===this.Re.state||(this.qm=this.Bkb(),this.qm.message=CommonUIStrings.l_CommentProgressTooltip,this.qm.Rb=5,this.qm.Pu=!1,this.qm.DAa(CommonUIStrings.l_DefaultDialogTitle,null,null))};d.prototype.kIa=function(){this.qm&&(this.qm.close(),this.qm=null)};d.prototype.NLb=function(){this.hj(CommonUIStrings.l_SaveFailedDialogTitle,CommonUIStrings.l_FailToSaveFile)};d.prototype.Pzj=
function(){this.hj(CommonUIStrings.l_NoSavePermissionDialogTitle,CommonUIStrings.l_NoSavePermissionDialogMessage)};d.prototype.Xyj=function(){var V=String.format(CommonUIStrings.l_SaveAsFileTooLargeMessage,250);this.hj(CommonUIStrings.l_SaveAsFileTooLargeTitle,V,F.a.Nij)};d.prototype.hj=function(V,Ia,Ha){Ha=void 0===Ha?F.a.Rij:Ha;D.ULS.sendTraceTag(25180165,216,10,"Upload failure with title: {0}, message: {1}",V,Ia);this.kIa();1!==this.Re.state&&this.ps().uHe(V,Ia,Ha)};d.prototype.Ryj=function(V){D.ULS.sendTraceTag(25180166,
216,50,"Upload fail with status code: {0}.",V);switch(V){case Ga.a.hag:this.Pzj();break;case Ga.a.CRf:this.Xyj();break;default:this.NLb()}};d.prototype.EJd=function(){"VersionHistory"===this.CPc&&this.La.processAction(oa.a.Wsc,2)};d.prototype.kda=function(V){if("VersionHistory"===this.CPc){var Ia={};this.La.$d(oa.a.GJd,2,(Ia.FailureReason=V,Ia))}};Object(u.a)(d,"UploadToSharePointManager",null,[673]);var ia=b(254),ta=b(995),za=b(567),sa=b(58);c.prototype.init=function(){};c.prototype.dispose=function(){};
c.prototype.Ph=function(V){var Ia=this;this.fb=V;this.JMc=za.a.Jq(V.Tb("Common.IEventEmitter<Common.IGetMoreInfoResult>"));this.OMc=za.a.Jq(V.Tb("Common.IEventEmitter<Common.IMruResult>"));this.cra=za.a.Jq(V.Tb("Common.App.SharedFilePicker.ISharedFilePicker"));sa.Task.WAA.call(null,this.JMc,this.OMc,this.cra).continueWith(function(){Ia.N6i()})};c.prototype.N6i=function(){var V=this;this.fb.register(e,"Common.App.SaveToSharePoint.SharePointUploadCallerFactory").as("Common.App.SaveToSharePoint.ISharePointUploadCallerFactory").Cc(function(){return new e(U.AFrameworkApplication.fa)}).tc();
this.fb.register(d,"Common.App.SaveToSharePoint.UploadToSharePointManager").as("Common.App.SaveToSharePoint.IUploadToSharePointManager").Cc(function(){return new d(U.AFrameworkApplication.ub,V.fb.resolve("Common.App.SaveToSharePoint.SharePointUploadCallerFactory"),function(){return(new ta.a).create()},function(){return new z},U.AFrameworkApplication.ta)}).tc();this.fb.register(l,"Common.App.SaveToSharePoint.SaveToSharePointManager").as("Common.App.SaveToSharePoint.ISaveToSharePointManager").Cc(function(){return new l(V.fb.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),
function(){return new z},V.fb.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),U.AFrameworkApplication.ta)}).tc();this.fb.register(v,"Common.App.SaveToSharePoint.OneDriveFilePickerHelper").as("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper").Cc(function(){return new v(V.fb.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),new x.a(function(){return V.JMc.result}),U.AFrameworkApplication.ta,function(){return new f})}).tc();this.fb.register(r,"Common.App.SaveToSharePoint.FileNameDialogFactory").Cc(function(){return new r(U.AFrameworkApplication.fa,
U.AFrameworkApplication.ub,U.AFrameworkApplication.ta,U.AFrameworkApplication.ta.Qa,V.fb.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),V.fb.resolve("Common.App.SaveAsToHost.IUploadToHostManager"),V.fb.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),new x.a(function(){return V.OMc.result}),V.fb.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),V.cra?V.cra.result:null)}).tc();this.fb.register(n,"Common.App.SaveToSharePoint.SaveToSharePointActor").Cc(function(){return new n(U.AFrameworkApplication.fa,
U.AFrameworkApplication.ub,V.fb.resolve("Common.App.SaveToSharePoint.FileNameDialogFactory"),V.fb.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),V.fb.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),V.fb.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),function(){return U.AFrameworkApplication.ta.YTg})}).tc();U.AFrameworkApplication.fa.qa("SaveToAnotherFolderBrsIsEnabled")&&this.fb.resolve("Common.App.SaveToSharePoint.SaveToSharePointActor").Bg()};
c.main=function(){ia.a.instance.Qi(new c)};Mf.Object.defineProperties(c.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.SaveToSharePoint"}}});Object(u.a)(c,"PackageManager",null,[10,11]);b.d(E,"a",function(){return a})},1355:function(u,E,b){function a(){O.a.Fa(function(ma){e.ka(ma);c.ka(ma)})}function c(ma){var ha=ya.call(this)||this;ha.$=ma;ha.Eb();return ha}function d(ma){ma.da.Ga(446,this)}function e(ma){return ab.call(this,ma)||this}function k(ma,ha){var Z=this;
this.sortOptions=this.$Ra=this.selectedRange=null;this.$af=!1;this.activeCell=this.De=this.rb=this.rc=null;this.onContentReady=function(){Z.UMf(!1);var Na=Z.ha();Na.sa.sg&&Na.sa.Vc.equals(Z.$Ra)&&(Xa.EwaSettings.isChangeGateEnabled("OfficeVSO:6378426_setActiveCellWithinRangeDuringSortAnimation")?Na.updateSelection(Z.selectedRange,fa.C(Z.activeCell),0,void 0,void 0,void 0,!0):Na.updateSelection(Z.selectedRange,Na.sa.activeCell,0,void 0,void 0,void 0,!0))};this.pLi=function(Na,eb){Na&&!va.a.Qg(Na.Errors)&&
Z.rc&&(Z.rc.Fo=Na.Result,Z.nKb(),Z.applyPivotSort(eb))};this.oLi=function(){};this.OSi=function(Na,eb){eb&&eb.GJj&&Xa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.IntelligentMetadataTableProactiveSuggestions",!1)&&(Na=Cb.d(Z.$.va.pa),Z.HJj(new Ob.a(fa.B(eb),Na)))};this.$=ma;this.Lif="";this.namedSheetViewPublic=ha;this.gridView=ra.g(this.$);this.$.Fb.Kg("LoadResource","LoadDialogControlsStopwatch")}function l(ma,ha,Z,Na,eb,cb,Ua){Ua=ma.Na(41,void 0===Ua?null:Ua);Ua.filterRange=ha;return Fb.g(ma,
"ReapplyAutoFilter",Ua,Z,Na,eb,cb,0)}function n(ma,ha,Z,Na,eb,cb,Ua){Ua=ma.Na(41,void 0===Ua?null:Ua);Ua.options=ha;return Fb.g(ma,"Sort",Ua,Z,Na,eb,cb,0)}function f(ma){this.filterRange=null;this.filterRange=ma}function v(ma){this.selection=null;this.selection=ma}function r(ma,ha,Z,Na){var eb=La.call(this,ma)||this;eb.lQd=!1;eb.Lfc=!1;eb.x6=[];eb.Tci=function(cb,Ua){var pa=eb.j6g(cb);eb.oLa(214,function(Qa,Db,Kb){return X.o(eb.$.oa.xa,pa,eb.n_a(Qa,eb.PEh(Ua)),eb.YT(Db),Kb,null)},16,!0)};eb.Sci=function(cb,
Ua,pa){cb=X.n(eb.$.oa.xa,Ua,eb.AFh(Ua,pa),eb.HLi,null,cb);eb.x6.push(cb)};eb.HLi=function(){K.ULS.sendTraceTag(529105632,0,10,"CustomSortDialog.OnGetSortConditionColorsOrIconsRequestFailure: GetSortConditionColorsOrIcons request failed.");eb.x6b(r.Xqb())};eb.v5c=function(cb,Ua){if(1===cb){cb=Ua.sortRangeType;var pa={};pa.SortOptions=Ua.sortOptions;pa.ShouldRestoreSelection=eb.lQd;pa.SelectedRange=eb.selectedRange;pa.OriginalActiveCell=eb.woc;pa.TopCellAddress=eb.QSa;pa.ShouldPromptNamedSheetViewTeachingDialog=
Xa.EwaSettings.isChangeGateEnabled("OfficeVSO:6170028_HandleSheetProtectionForSortFeatures")?0===cb||3===cb:!1;if(!Xa.EwaSettings.isChangeGateEnabled("OfficeVSO:6170028_HandleSheetProtectionForSortFeatures")&&eb.Ewj(cb)){var Qa=eb.$;eb.namedSheetViewPublic.BAa().continueWith(function(Db){Db.result&&r.YJf(Qa,pa)})}else r.YJf(eb.$,pa)}else eb.lQd&&eb.xoa(eb.selectedRange,eb.woc)};eb.i6h=function(cb,Ua){eb.lQd=!0;eb.xoa(cb,Ua)};eb.getColorName=function(cb){return Ka.a.XJa(xa.a.WG(cb))};K.ULS.shipAssertTag(529105669,
0,!!ha.ActiveCell);K.ULS.shipAssertTag(529105668,0,!!ha.SelectedRange);K.ULS.shipAssertTag(529105667,0,fa.D(ha.SelectedRange).contains(fa.C(ha.ActiveCell)));K.ULS.shipAssertTag(529105666,0,ba.a.equals(ha.SelectedRange.SheetName,ha.ActiveCell.SheetName,!0));Xa.EwaSettings.isChangeGateEnabled("OfficeVSO:5963270_DialogMergeSuspension")&&(eb.Kbb=new ib.a(ma,ob.a.vah,function(){return eb.Lfc},1));eb.selectedRange=ha.SelectedRange;eb.woc=ha.ActiveCell;eb.DTg=ha.ExpandSelection;eb.namedSheetViewPublic=Z;
eb.QSa=Na;eb.initializeAndShow(da.a.instance.ga(183),eb.v5c,eb.Xsa(ha));return eb}function y(ma,ha){ma=Ia.call(this,ma,ha)||this;ma.zCb=ma.wbd();ma.pr();return ma}function m(ma,ha){var Z=ma.SortRange;ma=ma.SortTopToBottom?Z.LastColumn-Z.FirstColumn:Z.LastRow-Z.FirstRow;return 0<=ha&&ha<=ma}function w(ma,ha){if(!ma.SortColumnInfoItems)return K.ULS.sendTraceTag(537151618,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: SortColumnInfoItems is null"),!1;for(var Z=new na.a,Na=bk(ma.SortColumnInfoItems),
eb=Na.next();!eb.done;eb=Na.next()){eb=eb.value;if(!m(ma,eb.ColumnOffset))return K.ULS.sendTraceTag(537151617,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: offset [{0}] is out of bounds. sort range: {1}",eb.ColumnOffset,ma.SortRange),!1;if(!eb.Name)return K.ULS.sendTraceTag(537151616,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: invalid column name for offset [{0}]",eb.ColumnOffset),!1;if(eb.CellColors&&!eb.CellColors.length)return K.ULS.sendTraceTag(537151587,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: cell colors are not null but length = [{0}]",
eb.CellColors.length),!1;if(eb.TextColors&&!eb.TextColors.length)return K.ULS.sendTraceTag(537151586,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: text colors are not null but length = [{0}]",eb.TextColors.length),!1;if(eb.Icons&&!eb.Icons.length)return K.ULS.sendTraceTag(537151585,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: icons are not null but length = [{0}]",eb.Icons.length),!1;Z.add(eb.ColumnOffset)}if(ma.SortConditions)for(Na=bk(ma.SortConditions),eb=Na.next();!eb.done;eb=
Na.next())if(eb=eb.value,!Z.contains(eb.RowColOffset))return K.ULS.shipAssertTag(537151584,0,!1,"SharedSortInfoResultExtension.VerifyColumnInfo: missing column info item for sort condition [{0}]",eb.RowColOffset),!1;if(ma.HeaderColumnInfoItems){if(ma.HeaderColumnInfoItems.length!==ma.SortColumnInfoItems.length)return K.ULS.shipAssertTag(537151583,0,!1,"SharedSortInfoResultExtension.VerifyColumnInfo: header columnInfo length doesn't match sort column info length"),!1;for(Z=0;Z<ma.HeaderColumnInfoItems.length;++Z){Na=
ma.HeaderColumnInfoItems[Z];if(ha&&Na.ColumnOffset!==ma.SortColumnInfoItems[Z].ColumnOffset)return K.ULS.shipAssertTag(537151582,0,!1,"SharedSortInfoResultExtension.VerifyColumnInfo: header columnInfo item offset doesn't match sort columnInfo item offset."),!1;if(Na.CellColors&&1<Na.CellColors.length)return K.ULS.sendTraceTag(537151581,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: headerColumnInfo.CellColors is not null and has more than 1 background color"),!1;if(Na.TextColors&&1<Na.TextColors.length)return K.ULS.sendTraceTag(537151580,
0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: headerColumnInfo.TextColors is not null and has more than 1 font color"),!1;if(Na.Icons&&1<Na.Icons.length)return K.ULS.sendTraceTag(537151579,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: headerColumnInfo.Icons is not null and has more than 1 icon"),!1}}return!0}function B(ma){if(!ma.SortConditions)return!0;for(var ha=bk(ma.SortConditions),Z=ha.next();!Z.done;Z=ha.next()){Z=Z.value;if(!m(ma,Z.RowColOffset))return K.ULS.sendTraceTag(537151620,
0,10,"SharedSortInfoResultExtension.VerifySortConditions: offset [{0}] is out of bounds. sort range: {1}",Z.RowColOffset,ma.SortRange),!1;if(1===Z.SortConditionType&&Z.FillGradient&&!z.isValid(Z.FillGradient))return K.ULS.sendTraceTag(537151619,0,10,"SharedSortInfoResultExtension.VerifySortConditions: sortCondition contains invalid fillGradient"),!1}return!0}function A(ma){return ma.SortRange?4===ma.SortRangeType?(K.ULS.sendTraceTag(537151622,0,10,"SharedSortInfoResultExtension.VerifySortRange: Unsupported sort range type: {0}",
ma.SortRangeType),!1):2===ma.SortRangeType&&ma.SortTopToBottom&&(null==ma.HeaderRowSize||0>ma.HeaderRowSize)?(K.ULS.sendTraceTag(537151621,0,10,"SharedSortInfoResultExtension.VerifySortRange: header row size must be equal or greater than 1, when range is sheetrange"),!1):!0:(K.ULS.sendTraceTag(537151623,0,10,"SharedSortInfoResultExtension.VerifySortRange: sort range is null"),!1)}function z(){}function x(ma,ha,Z,Na){new Sys.UI.Point(ma,ha);new Sys.UI.Point(Z,Na)}function D(){}function I(ma,ha,Z,Na){ma=
ma.HeaderColumnInfo;return Na||ma?2===ha&&Z?ma.CellColors&&1!==ma.CellColors.length?(K.ULS.sendTraceTag(537151626,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyHeaderColumnInfo: headerColumnInfo.CellColors should be null or have exactly 1 color."),!1):ma.TextColors&&1!==ma.TextColors.length?(K.ULS.sendTraceTag(537151625,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyHeaderColumnInfo: headerColumnInfo.TextColors should be null or have exactly 1 color"),!1):ma.Icons&&1!==
ma.Icons.length?(K.ULS.sendTraceTag(537151624,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyHeaderColumnInfo: headerColumnInfo.Icons should be null or have exactly 1 icon"),!1):!0:ma?(K.ULS.sendTraceTag(537151627,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyHeaderColumnInfo: headerColumnInfo should be null when range type is not SheetRange, or when headerRowSize{0} == 0.",Z),!1):!0:!0}function F(ma,ha){ma=ma.ColumnInfo;switch(ha){case 1:return ma.CellColors&&ma.CellColors.length?
!0:(K.ULS.sendTraceTag(537151631,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyColumnInfo: sort on cell color result cell colors is null or there are no colors (must have at least 1)."),!1);case 2:return ma.TextColors&&ma.TextColors.length?!0:(K.ULS.sendTraceTag(537151630,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyColumnInfo: sort on font color result text colors is nullor there are no colors (must have at least 1)."),!1);case 3:return ma.Icons&&ma.Icons.length?!0:(K.ULS.sendTraceTag(537151629,
0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyColumnInfo: sort on icon result icons is nullor there are no icons (must have at least 1)."),!1);default:return K.ULS.sendTraceTag(537151628,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyColumnInfo: illeagl sort condition type."),!1}}function G(ma){var ha=this;this.Uv=function(Z){switch(Z){case 0:ha.rNa("Cancel");break;case 1:ha.rNa("Expand and sort");ha.uQe(!0);break;case 2:ha.rNa("Just sort"),ha.uQe(!1)}};this.uQe=ma}function T(ma){this.options=
null;this.options=ma}var O=b(10);u=b(0);var U=b(905),J=b(51),H=b(37),K=b(14),N=b(1273),M=b(154),C=b(24),Q=b(76),P=b(54);Object(u.a)(T,"MacroRecorderRangeCustomSortedPayload",null,[438]);var ka=b(1164),R=b(1165),fa=b(45),ca=b(564),ea=b(388),wa=b(177),X=b(255),ja=b(151),va=b(31),ua=b(295),Xa=b(1),aa=b(186),ba=b(22),oa=b(294),ra=b(21),db=b(1011),Ka=b(962),Ga=b(324),xa=b(217),da=b(15),qa=b(135);G.prototype.show=function(){var ma=new qa.StandardDialog;ma.Rb=11;ma.mc(1,da.a.instance.ga(2096));ma.mc(2,da.a.instance.ga(2097));
ma.a3f(da.a.instance.ga(2095),da.a.instance.Xa(647),this.Uv)};G.prototype.rNa=function(ma){K.ULS.sendTraceTag(594125219,0,50,"ExpandSortSelectionDialog: user operation: {0}",ma)};Object(u.a)(G,"ExpandSortSelectionDialog",null,[]);var na=b(202);D.isValid=function(ma){return Array.contains(D.Zwh,ma.Position)?!0:(K.ULS.shipAssertTag(537159826,0,!1,"FillGradientStopExtension.IsValid: unexpected position value [{0}]",ma.Position),!1)};D.Zwh=[0,.5,1];Object(u.a)(D,"FillGradientStopExtension",null,[]);Object(u.a)(x,
"GradientLine",null,[]);z.isValid=function(ma){if(!(ma.Degree.toString()in z.Xwh))return K.ULS.shipAssertTag(537159829,0,!1,"FillGradientExtension.IsValid: unexpected degree value [{0}]",ma.Degree),!1;if(!ma.GradientStops)return K.ULS.shipAssertTag(537159828,0,!1,"FillGradientExtension.IsValid: no gradient stops"),!1;if(ma.GradientStops.length<z.Tzi||ma.GradientStops.length>z.Cyi)return K.ULS.shipAssertTag(537159827,0,!1,"FillGradientExtension.IsValid: unexpected number of gradient stops [{0}]",ma.GradientStops.length),
!1;ma=bk(ma.GradientStops);for(var ha=ma.next();!ha.done;ha=ma.next())if(!D.isValid(ha.value))return!1;return!0};z.Tzi=2;z.Cyi=3;var ia={};z.Xwh=(ia["0"]=new x(0,0,1,0),ia["180"]=new x(1,0,0,0),ia["90"]=new x(0,0,0,1),ia["270"]=new x(0,1,0,0),ia["45"]=new x(0,0,1,1),ia["225"]=new x(1,1,0,0),ia["135"]=new x(1,0,0,1),ia["315"]=new x(0,1,1,0),ia);Object(u.a)(z,"FillGradientExtension",null,[]);ia=b(399);var ta=b(133),za=b(98),sa=b(95),V=b(134),Ia=ia.a;Rk(y,Ia);y.prototype.hO=function(ma,ha){if(1===ma){var Z=
fa.v(this.zCb,this.$);ra.g(this.$).gg(Z,null,null,null,0,sa.a.xCj)}Z={};Z=(Z.DialogButton=ma,Z.Location="dialog",Z);V.b(this.$).yd(ta.a.zCj,Z,null,!0);Ia.prototype.hO.call(this,ma,ha)};y.prototype.pr=function(){Ia.prototype.pr.call(this);var ma=this.vCj();this.Rb=1;this.mc(1,da.a.instance.ga(2211));this.ql(da.a.instance.ga(2212),za.a.qh(ma),1,this.B0)};y.prototype.vCj=function(){return String.format(da.a.instance.mb(170),this.zCb.toString())};y.prototype.wbd=function(){var ma=this.error.Description.split("_");
return new C.Range(Number.parseInvariant(ma[1])+1,Number.parseInvariant(ma[2])+1,Number.parseInvariant(ma[3])+1,Number.parseInvariant(ma[4])+1,!0,!1)};Mf.Object.defineProperties(y.prototype,{nc:{configurable:!0,enumerable:!0,get:function(){return"SortMergedCellsErrorDialog"}}});Object(u.a)(y,"SortMergedCellsErrorDialog",ia.a,[]);var Ha=b(67),ob=b(639),ib=b(706),La=db.a;Rk(r,La);r.prototype.dispose=function(){this.Lfc||(this.Lfc=!0,this.u1b(),this.x6=null,Xa.EwaSettings.isChangeGateEnabled("OfficeVSO:5963270_DialogMergeSuspension")&&
(this.Kbb.dispose(),this.Kbb=null));La.prototype.dispose.call(this)};r.prototype.PEh=function(ma){var ha=this;return function(Z){if(ua.b(Z,-901005882))Ha.a(ha.$).fd.eJ(-901005882),ha.MEd();else if(ua.b(Z,-569193796))Ha.a(ha.$).fd.eJ(-569193796),ha.hide(),new y(ha.$,Z.Errors[0]);else if(ua.a(Z))K.ULS.sendTraceTag(529105665,0,10,"CustomSortDialog.GenerateGetSortInfoSuccessCallback: GetSortInfo result contains non-status messages"),ha.hide();else{Z=Z.Result;ha.$.Lj(Z.SortRange);var Na=Xa.EwaSettings.isChangeGateEnabled("OfficeVSO:4545720_FixingSharedSortInfoResultExtension");
Z&&A(Z)&&B(Z)&&w(Z,Na)?ma(Z):ha.x6b(r.Xqb())}}};r.prototype.AFh=function(ma,ha){var Z=this;return function(Na,eb){if(Z.Lfc)K.ULS.sendTraceTag(529105635,0,50,"CustomSortDialog.GenerateOnGetSortConditionColorsOrIconsRequestSuccess: response was received after dialog is disposed");else if(!Na||ua.a(Na))K.ULS.sendTraceTag(529105634,0,10,"CustomSortDialog.GenerateOnGetSortConditionColorsOrIconsRequestSuccess: Unexpected error: {0}",va.a.Ec(Na.Errors)),Z.$.ea.fp(Na.Errors),Z.hide();else{Na=Na.Result;var cb=
ma.RangeType,Ua=ma.HeaderRowSize,pa=ma.SortTopToBottom;Na&&F(Na,ma.ConditionType)&&I(Na,cb,Ua,pa)?(Na.ColumnInfo.ColumnOffset=eb,void 0!==Na.HeaderColumnInfo&&null!==Na.HeaderColumnInfo&&(Na.HeaderColumnInfo.ColumnOffset=eb),ha(Na,ma.ConditionType,ma.SortTopToBottom)):(K.ULS.sendTraceTag(529105633,0,10,"CustomSortDialog.GenerateOnGetSortConditionColorsOrIconsRequestSuccess: sortConditionColorsOrIconsResult is not valid"),Z.x6b(r.Xqb()))}}};r.prototype.Ewj=function(ma){return!!this.namedSheetViewPublic&&
(0===ma||3===ma)};r.prototype.j6g=function(ma){var ha={};ha.SelectedRange=this.selectedRange;ha.ActiveCell=this.woc;ha.SortInfoMode=ma;ha.ExpandSortSelection=this.DTg;ha.ExpandSortSelectionSupported=!0;return ha};r.prototype.Xsa=function(ma){var ha={};ha[Ga.a.Vv]=this.nc;ha.fromAutoFilter=ma.FromAutoFilter;ha.gridRTL=ra.g(this.$).rtl;ha.activeCell=ma.ActiveCell;ha.selectedRange=ma.SelectedRange;ha.invokeGetSortInfo=this.Tci;ha.invokeGetSortConditionColorsOrIcons=this.Sci;ha.highlightSortRange=this.i6h;
ha.getColorName=this.getColorName;return ha};r.prototype.xoa=function(ma,ha){ma=fa.D(ma);this.ha.sa.Vc.equals(ma)||this.ha.updateSelection(ma,fa.C(ha),0,void 0,void 0,void 0,!0)};r.prototype.MEd=function(){var ma=this;(new G(function(ha){var Z={};Z.ActiveCell=ma.woc;Z.SelectedRange=ma.selectedRange;Z.ExpandSelection=ha;Z.FromAutoFilter=!1;ha={};ma.$.Fd(-207540907,Q.a.Cb,8,(ha.SortCommandData=Z,ha))})).show()};r.prototype.u1b=function(){if(void 0!==this.x6&&null!==this.x6)for(var ma=bk(this.x6),ha=
ma.next();!ha.done;ha=ma.next())this.$.oa.xa.veb(ha.value.Dt)};r.YJf=function(ma,ha){var Z={};ma.Fd(1659552324,Q.a.Cb,8,(Z.CustomSortCommandData=ha,Z))};r.Xqb=function(){return va.a.Xc(1,0,26,0,1,-1517197771,"CustomSortValidationError")};Mf.Object.defineProperties(r.prototype,{nc:{configurable:!0,enumerable:!0,get:function(){return"CustomSortDialog"}},ha:{configurable:!0,enumerable:!0,get:function(){return ra.g(this.$).ha}}});Object(u.a)(r,"CustomSortDialog",db.a,[]);var zb=b(1274);v.prototype.getSelection=
function(){return this.selection};Object(u.a)(v,"MacroRecorderRangeAutoFilterClearedPayload",null,[438]);Object(u.a)(f,"MacroRecorderRangeFilterReappliedPayload",null,[438]);var Fb=b(62),Yb=b(983),kb=b(984),vb=b(112),Wa=b(58),qb=b(1275),yb=b(203),ec=b(36),Ob=b(354),Cb=b(64);k.prototype.Lc=function(ma,ha){return!this.kpd(ma,ha)};k.prototype.executeCommand=function(ma,ha,Z){var Na=null;ma=ha.command;switch(ma){case -864298118:Na=this.ugh(ha,Z);break;case -1010737776:Na=this.$5c(!0,ha,Z);break;case 2123420468:Na=
this.$5c(!1,ha,Z);break;case -1089513346:Z=this.lXe(Z);if(!this.bAb([fa.D(Z.SortOptions.SelectedRange)]))return H.TaskExtensions.jk();Na=this.OHe(ha,Z);break;case -1032691499:case -764711886:case -2016161444:Na=this.w1i(ha,Z);break;case -207540907:case -1677817820:Na=this.gridView.Ab.d5(this.ha().sa.activeCell)?this.n1i():this.k1i(ha,Z);break;case 1659552324:Na=this.OHe(ha,this.lXe(Z));break;case 368460465:Na=this.Kgh(ha,Z);break;case 529856798:Na=this.pgh(ha);break;case 644342024:Na=this.Fgh(ha)}return Na||
aa.a(ma)};k.prototype.zc=function(ma,ha){if(ma=1===ma)switch(ha.command){case -864298118:case -1010737776:case 2123420468:case -1089513346:case -207540907:case -1677817820:case 1659552324:case 368460465:case 529856798:case 644342024:break;case -1032691499:case -764711886:case -2016161444:ma=Xa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PutSelectedItemOnTop",!1);break;default:ma=!1}return ma};k.prototype.Qc=function(){return!1};k.prototype.ha=function(){return this.$&&this.gridView?
this.gridView.ha:null};k.prototype.UMf=function(ma){ma?this.gridView.yu(this.onContentReady):this.gridView.jy(this.onContentReady);this.$af=ma};k.prototype.Hxj=function(ma){return!!this.sortOptions&&ba.a.equals(this.Lif,ma.Xha,!0)};k.prototype.kpd=function(ma,ha){var Z=ra.g(this.$).ha.sa.selectedRanges;return(new ja.a(this.$.va)).zm(ma,ha,Z,this.gridView)};k.prototype.$5c=function(ma,ha,Z){var Na=new N.a;Xa.EwaSettings.isChangeGateEnabled("OfficeVSO:6496842_createDefaultSortOptions")?this.t9e(Na,
Z,ma):(Na.OperationType=0,Na.IsAscending=ma,Na.HasHeader=!0,Na.GuessHeader=!0,Na.SortTopToBottom=!0,Na.ExpandSortSelectionSupported=!0,Z&&void 0!==Z[k.Lna]&&null!==Z[k.Lna]?(Z=Z[k.Lna],Na.ActiveCell=Z.ActiveCell,Na.SelectedRange=Z.SelectedRange,Na.ExpandSortSelection=Z.ExpandSelection):(Na.ActiveCell=fa.o(this.sa.activeCell,this.$),Na.SelectedRange=fa.v(this.sa.Vc,this.$),Na.ExpandSortSelection=null));return this.bAb([fa.D(Na.SelectedRange)])?this.gridView.Ab.d5(fa.D(Na.SelectedRange))?this.Cgh(ma):
this.tld(Na,ha):H.TaskExtensions.jk()};k.prototype.ugh=function(ma,ha){K.ULS.shipAssertTag(520901652,0,!1,"SortCommandHandler.doDefaultSort: using default sort");var Z=null,Na=this.ha();Na&&(this.Hxj(Na)?this.bAb(Na.sa.selectedRanges)&&(this.sortOptions.IsAscending=!this.sortOptions.IsAscending,Z=this.tld(this.sortOptions,ma)):Z=this.$5c(!0,ma,ha));return Z};k.prototype.bAb=function(ma){return Xa.EwaSettings.isChangeGateEnabled("OfficeVSO:6516289_SheetProtectionSettings")&&(Xa.EwaSettings.isChangeGateEnabled("OfficeVSO:5767424_EnablePauseProtectionInViewMode")||
this.$.isEditMode)?this.$.isEditMode?this.$.hq(ma,!0,1):this.$.dWc(ma,!0,1):!0};k.prototype.Cgh=function(ma){this.nTh(ma);return Wa.Task.Ua(!0)};k.prototype.nQg=function(ma){if(Xa.EwaSettings.isChangeGateEnabled("OfficeVSO:4112173_MacroRecorderTableSortOnRange")){var ha=this.gridView.Ab.dk(this.sa.Vc,!1);if(ha)return new R.a(ha.name,this.sa.activeCell.left-ha.usedRange.left,ma.IsAscending)}return new ka.a(ma)};k.prototype.tld=function(ma,ha){function Z(){return Na.nQg(ma)}var Na=this;this.gridView.hg.GG(!1);
return this.p7c(function(eb,cb,Ua){return n(Na.$.oa.xa,ma,oa.b(eb,Na.BFh(ha)),cb,Ua,ma)},function(eb){return new wa.a(141,0,eb,void 0,Z)},ha,this.Dwj(ma))};k.prototype.Dwj=function(ma){if(!this.namedSheetViewPublic)return!1;var ha=this.sa.Vc,Z=fa.v(this.sa.Vc,this.$),Na=this.gridView.Ab.gMa(ha,!0),eb=this.sa.Eba()&&this.gridView.Ab.Pef(Z),cb=this.gridView.Ab.uki(Z);ma=(ha.m5||ha.YZ)&&!ha.isSingle&&(null==ma.ExpandSortSelection?!1:ma.ExpandSortSelection)&&this.gridView.Ab.Pef(Z);return Na||eb||cb||
ma};k.prototype.n1i=function(){return this.$.Fd(-1556797033,Q.a.Cb,8,null)};k.prototype.k1i=function(ma,ha){ma=8===ma.Le&&ha&&void 0!==ha[k.Lna]&&null!==ha[k.Lna]?ha[k.Lna]:19===ma.Le&&ha&&void 0!==ha[Q.a.Uf]&&null!==ha[Q.a.Uf]?P.a.Th(ha[Q.a.Uf]):this.m5g();if(!this.bAb([fa.D(ma.SelectedRange)]))return H.TaskExtensions.jk();ra.g(this.$).hg.GG(!1);var Z=null;(ha=ha.TopCellAddress)&&(Z=fa.o(ha,this.$));new r(this.$,ma,this.namedSheetViewPublic,Z);return Wa.Task.Ua(!0)};k.prototype.lXe=function(ma){return ma[k.uah]};
k.prototype.OHe=function(ma,ha){function Z(Qa){return new wa.a(187,0,Qa,void 0,Na)}function Na(){return new T(ha.SortOptions)}function eb(Qa,Db,Kb){return n(pa.$.oa.xa,ha.SortOptions,oa.b(Qa,Ua),oa.a(Db,cb),Kb,pa.sortOptions)}function cb(){ha.ShouldRestoreSelection&&pa.xoa(ha.SelectedRange,ha.OriginalActiveCell);K.ULS.sendTraceTag(537151575,0,10,"SortCommandHandler.DoCustomSort.onSortFailedCallback: Custom Sort failed. Called from: {0}",ma.Le)}function Ua(Qa){Xa.EwaSettings.isChangeGateEnabled("OfficeVSO:5899794_MergedCellsErrorFix")&&
pa.S5e(Qa)?pa.F4e(Qa.Errors[0]):(ha.ShouldRestoreSelection&&pa.xoa(ha.SelectedRange,ha.OriginalActiveCell),K.ULS.sendTraceTag(537151576,0,50,"SortCommandHandler.DoCustomSort.onSortSuccessCallback: Custom Sort succeeded. Called from: {0}",ma.Le),pa.DLj(ha))}var pa=this;return Xa.EwaSettings.isChangeGateEnabled("OfficeVSO:6170028_HandleSheetProtectionForSortFeatures")?this.p7c(eb,Z,null,ha.ShouldPromptNamedSheetViewTeachingDialog):ea.a(this.$.userOperationManager,eb,Z,null)};k.prototype.xoa=function(ma,
ha){ma=fa.D(ma);ra.g(this.$).ha.sa.Vc.equals(ma)||ra.g(this.$).ha.updateSelection(ma,fa.C(ha),0,void 0,void 0,void 0,!0)};k.prototype.m5g=function(){var ma={};ma.ActiveCell=fa.o(this.sa.activeCell,this.$);ma.SelectedRange=fa.v(this.sa.Vc,this.$);ma.FromAutoFilter=!1;ma.ExpandSelection=null;return ma};k.prototype.Kgh=function(ma,ha){function Z(){return new zb.a(eb)}var Na=this,eb=this.Gaa();if(!eb)return Wa.Task.Ua(!1);var cb=this.$.oa.xa.Pb();return Xa.EwaSettings.Zb()?ea.a(this.$.userOperationManager,
function(Ua,pa,Qa){return X.A(Na.$.oa.xa,eb,oa.b(Yb.a.mva(vb.a.qZa,kb.a.toggleAutoFilter,Ua),Na.OSi),pa,Qa,{selection:eb,GJj:ha.On},cb)},function(Ua){return new wa.a(516,0,Ua,64,Z)},ma):ea.a(this.$.userOperationManager,function(Ua,pa,Qa){return X.A(Na.$.oa.xa,eb,Yb.a.mva(vb.a.qZa,kb.a.toggleAutoFilter,Ua),pa,Qa,null,cb)},function(Ua){return new ca.a(516,0,Ua,void 0,Z)},ma)};k.prototype.pgh=function(ma){function ha(){return new v(Na)}var Z=this,Na=this.Gaa();if(!Na)return Wa.Task.Ua(!1);var eb=this.gridView.Ab.dk(this.sa.Vc,
!0);eb&&K.ULS.sendTraceTag(537151574,0,50,"DoClearAutoFilter for namedObject: Type : {0}",eb.type.toString());var cb=this.$.oa.xa.Pb();eb=Xa.EwaSettings.Zb()?function(Ua){return new wa.a(517,0,Ua,64,ha)}:function(Ua){return new ca.a(517,0,Ua,void 0,ha)};return this.p7c(function(Ua,pa,Qa){var Db=Z.$.oa.xa;Ua=Yb.a.mva(vb.a.Yra,kb.a.clearAutoFilter,Ua);var Kb=Db.Na(41,void 0===cb?null:cb);Kb.selectedRange=Na;return Fb.g(Db,"ClearAutoFilter",Kb,Ua,pa,Qa,null,0)},eb,ma)};k.prototype.p7c=function(ma,ha,
Z,Na){var eb=this;return this.namedSheetViewPublic&&(void 0===Na||Na)?this.namedSheetViewPublic.BAa().continueWith(function(cb){cb.result&&ea.a(eb.$.userOperationManager,ma,ha,Z)}):ea.a(this.$.userOperationManager,ma,ha,Z)};k.prototype.Fgh=function(ma){function ha(){return new f(Na)}var Z=this,Na=this.Gaa();if(!Na)return Wa.Task.Ua(!1);var eb=this.$.oa.xa.Pb();return Xa.EwaSettings.Zb()?ea.a(this.$.userOperationManager,function(cb,Ua,pa){return l(Z.$.oa.xa,Na,Yb.a.mva(vb.a.Yra,kb.a.xKf,cb),Ua,pa,
null,eb)},function(cb){return new wa.a(518,0,cb,64,ha)},ma):ea.a(this.$.userOperationManager,function(cb,Ua,pa){return l(Z.$.oa.xa,Na,Yb.a.mva(vb.a.Yra,kb.a.xKf,cb),Ua,pa,null,eb)},function(cb){return new ca.a(518,0,cb,void 0,ha)},ma)};k.prototype.BFh=function(ma){var ha=this;return function(Z,Na){var eb;ua.b(Z,-901005882)?(Ha.a(ha.$).fd.eJ(-901005882),ha.MEd(Na,ma.command)):ha.S5e(Z)?ha.F4e(Z.Errors[0]):!ua.a(Z)&&Z.Result&&(ha.sortOptions=Na,ha.$Ra=fa.D(Z.Result.ActualSortRange),ha.Lif=ha.ha().Xha,
ha.$af||(ha.selectedRange=ha.sa.Vc,ha.selectedRange.equals(ha.$Ra)||(Xa.EwaSettings.isChangeGateEnabled("OfficeVSO:6378426_setActiveCellWithinRangeDuringSortAnimation")&&(ha.activeCell=fa.o(ha.sa.activeCell,ha.$)),ha.KAj())),(null===(eb=ha.sortOptions)||void 0===eb?0:eb.ActiveCell)&&(!Xa.EwaSettings.isChangeGateEnabled("OfficeVSO:6611537_shouldTriggerPivotTableHandRaise")||ha.L1f(ha.sortOptions))&&(Z=ha.sortOptions.ActiveCell,Z=new C.Range(Z.FirstRow+1,Z.FirstColumn+1,Z.FirstRow+1,Z.FirstColumn+1,
!0,!1),ha.hL(Z),ha.$Vd(Z)))}};k.prototype.S5e=function(ma){return ua.b(ma,-569193796)};k.prototype.F4e=function(ma){Ha.a(this.$).fd.eJ(-569193796);new y(this.$,ma)};k.prototype.MEd=function(ma,ha){var Z=this;(new G(function(Na){var eb={};eb.ActiveCell=ma.ActiveCell;eb.SelectedRange=ma.SelectedRange;eb.ExpandSelection=Na;Na={};Z.$.Fd(ha,Q.a.Cb,8,(Na[k.Lna]=eb,Na))})).show()};k.prototype.KAj=function(){var ma=this.ha();if(Xa.EwaSettings.isChangeGateEnabled("OfficeVSO:6378426_setActiveCellWithinRangeDuringSortAnimation")){var ha=
fa.C(this.activeCell);this.$Ra.ze(ha)||(ha=this.$Ra.topLeft);ma.updateSelection(this.$Ra,ha,0,void 0,void 0,void 0,!0)}else ma.updateSelection(this.$Ra,ma.sa.activeCell,0,void 0,void 0,void 0,!0);this.UMf(!0)};k.prototype.Gaa=function(){var ma=this.ha();if(!ma)return K.ULS.shipAssertTag(537151573,0,!!ma,"SelectionManger is null"),null;this.gridView.hg.GG(!1);return fa.v(ma.sa.Vc,this.$)};k.prototype.nKb=function(){this.rc&&this.rc.Fo&&(this.De=this.rc.Fo,this.rb=this.rc.sac())};k.prototype.nTh=function(ma){var ha=
this;if(this.$.isEditMode&&(this.rc=this.gridView.Ab.Qo(this.sa.activeCell))){this.activeCell=fa.o(this.sa.activeCell,this.$);if(this.rc&&this.rc.Fo){var Z=this.rc.Fo.CurrentCol;if(this.rc.Fo.CurrentRow===this.activeCell.FirstRow&&Z===this.activeCell.FirstColumn){this.nKb();this.applyPivotSort(ma);return}}this.$.oa.xa.Pb();Z=new wa.a(228,0,function(Na,eb,cb){return X.k(ha.$.oa.xa,ha.activeCell,oa.b(Na,ha.pLi),oa.a(eb,ha.oLi),cb,ma)},16);this.$.userOperationManager.Sb(Z,null)}};k.prototype.applyPivotSort=
function(ma){var ha=this;if(this.rc&&this.rb&&this.activeCell&&this.De){var Z=8===this.De.CellArea,Na=1===this.De.CellArea||2===this.De.CellArea;(Z||Na)&&8!==this.De.CellType&&4!==this.De.CellType&&(Z?ea.a(this.$.userOperationManager,function(eb,cb,Ua){return X.b(ha.$.oa.xa,ha.activeCell,ma?1:2,ha.rb.Caption,eb,cb,Ua,null)},function(eb){return new wa.a(1015,0,eb,void 0,null)},null):(Z=1===this.De.CellArea?1:2,this.$.ma(696)?M.a.naps(this.$.domElement,this.activeCell.FirstRow,this.activeCell.FirstColumn,
this.rc.externalSourceIndex,this.rb.Index.toString(),this.rb.Caption,this.rc.isOlap?"":this.rb.Caption,Z,ma):M.a.aps(this.$.domElement,this.activeCell.FirstRow,this.activeCell.FirstColumn,this.rc.externalSourceIndex,this.rb.Index.toString(),ma)))}};k.prototype.DLj=function(ma){this.L1f(ma.SortOptions)&&(ma.TopCellAddress?ma=fa.C(ma.TopCellAddress):(ma=ma.OriginalActiveCell,ma=new C.Range(ma.FirstRow+1,ma.FirstColumn+1,ma.FirstRow+1,ma.FirstColumn+1,!0,!1)),this.hL(ma))};k.prototype.hL=function(ma){ec.a.Bba(this.$)&&
H.TaskExtensions.Aa(J.GetServiceTaskFactory.Ra(this.$.da,430,431,1),function(ha){ha.result.eea(ma);K.ULS.sendTraceTag(537151571,306,50,"SortCommandHandler:TriggerPivotTableHandRaise Trigger hand raise from sort.")},this.$.la,3)};k.prototype.$Vd=function(ma){Xa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.DataCleansingProactiveSuggestion",!1)&&H.TaskExtensions.Aa(J.GetServiceTaskFactory.Ra(this.$.da,476,475,0),function(ha){ha.result.$Vd(ma,0);K.ULS.sendTraceTag(537151570,0,50,"SortCommandHandler:TriggerProactiveSuggestion Trigger proactive suggestion from sort.")},
this.$.la,3)};k.prototype.w1i=function(ma,ha){if(!this.bAb(this.sa.selectedRanges))return H.TaskExtensions.jk();var Z=new N.a;this.t9e(Z,ha);Z.SortConditions=[this.z8g(ma)];Z.OperationType=2;return this.tld(Z,ma)};k.prototype.z8g=function(ma){var ha=this.gridView.Ub(this.sa.activeCell),Z=new qb.a;Z.IsAscending=!0;switch(ma.command){case -1032691499:ha.ywb?(ma=yb.a.Oo(ha.backgroundColor),Z.SortColor=ma.iS(!0)):Z.SortColor=k.NoColor;Z.SortConditionType=1;break;case -764711886:Z.SortColor=ha.w0c===k.NoColor?
k.NoColor:yb.a.Ase(ha.w0c);Z.SortConditionType=2;break;case -2016161444:ha.Gwb?(Z.SortIcon=ha.cell.wic,Z.SortIconSet=ha.xic):(Z.SortIcon=k.L_d,Z.SortIconSet=k.L_d);Z.SortConditionType=3;break;default:K.ULS.debugAssertTag(522723787,0,!1,"SortCommandHandler.createSortConditionsFromSelectedCell: ribbon command didn't match any of the case statements")}return Z};k.prototype.HJj=function(ma){H.TaskExtensions.Aa(J.GetServiceTaskFactory.Ra(this.$.da,426,427,1),function(ha){ha.result.WVd(ma,"Filter")},this.$.la,
3)};k.prototype.t9e=function(ma,ha,Z){ma.OperationType=0;ma.IsAscending=void 0===Z?!0:Z;ma.HasHeader=!0;ma.GuessHeader=!0;ma.SortTopToBottom=!0;ma.ExpandSortSelectionSupported=!0;ha&&ha[k.Lna]?(ha=ha[k.Lna],ma.ActiveCell=ha.ActiveCell,ma.SelectedRange=ha.SelectedRange,ma.ExpandSortSelection=ha.ExpandSelection):(ma.ActiveCell=fa.o(this.sa.activeCell,this.$),ma.SelectedRange=fa.v(this.sa.Vc,this.$),ma.ExpandSortSelection=null)};k.prototype.L1f=function(ma){return!ma.SortConditions||ma.SortConditions.some(function(ha){return 0===
ha.SortConditionType})};Mf.Object.defineProperties(k.prototype,{sa:{configurable:!0,enumerable:!0,get:function(){return this.ha().sa}}});k.uah="CustomSortCommandData";k.Lna="SortCommandData";k.L_d=-1;k.NoColor=0;Object(u.a)(k,"SortCommandHandler",null,[429]);var ab=U.a;Rk(e,ab);e.prototype.Ad=function(){var ma=this;H.TaskExtensions.Aa(J.GetServiceTaskFactory.Ra(this.$.da,309,310,this.hb),function(ha){ma.jd([new k(ma.$,ha.result)])},this.$.la,3)};e.ka=function(ma){U.a.Qd(160,new e(ma))};Object(u.a)(e,
"SortCommandHandlerFactory",U.a,[]);db=b(232);d.prototype.J9g=function(ma,ha){new y(ma,ha)};Object(u.a)(d,"SortUtil",null,[499]);var ya=db.a;Rk(c,ya);c.prototype.create=function(){var ma=this.$.da.za(446);ma||(ma=new d(this.$),this.$.da.Ga(446,ma));this.pb(ma)};c.ka=function(ma){ma.da.Ga(447,new c(ma))};Object(u.a)(c,"SortUtilFactory",db.a,[]);b.d(E,"a",function(){return a})},1365:function(u,E,b){function a(){B.a.Fa(function(ta){c.ka(ta);m.ka(ta)})}function c(ta){var za=ia.call(this)||this;za.$=ta;
za.Eb();return za}function d(ta){var za=this;this.koa=this.hUe=this.mGb=this.W1a=this.Rpc=this.Jca=this.hPa=null;this.zpd=this.aOb=this.PKd=!1;this.tLb=!0;this.Rfc=!1;this.pRd=!0;this.$Nb=this.B0a=this.CAe=0;this.Duc={};this.Ioc={};this.Hoc={};this.mHf=0;this.J6a=this.G8d=!1;this.p$i=function(){ca.DOMElementExtensions.toggleCssClass(za.$.Tq,"ewr-presentMode-transition",!1);$removeHandler(za.W1a,"transitionend",za.koa)};this.Oi=function(){parseInt(za.$.Ov.style.right,10)!==za.CAe&&window.requestAnimationFrame(function(){za.UAc(0);
za.$.hza(C.a.oZ("PresentModeManager.OnContentAreaResized"))})};this.wya=function(){var sa=Object(H.a)(wa.a,za.$.pa);if(sa&&za.jz){za.gridView.wnd=!1;sa=sa.headersVisible;var V=ja.g(za.$).rtl;ca.DOMElementExtensions.toggleCssClass(za.$.Tq,"ewr-presentMode-on-headers-off",!sa);ca.DOMElementExtensions.toggleCssClass(za.$.Tq,"ewr-presentMode-on-rtl",V);(12!==za.B0a&&!sa||32!==za.B0a&&sa&&!V||0!==za.B0a&&sa&&V)&&window.requestAnimationFrame(function(){za.UAc(2)})}};this.Yc=function(){za.Q$e();za.Lg("OnWorkbookOpened");
T.ULS.sendTraceTag(537154323,0,50,"PresentModeManager.OnWorkbookOpened: Silent reload happened during present mode")};this.ep=function(){za.zpd=!0;za.lea("OnSelectionStarted")};this.ug=function(){za.zpd=!1;za.lea("OnSelectionEnded");za.DUf()};this.Dh=function(){za.lea("OnEditStarted")};this.Af=function(){za.lea("OnEditEnded")};this.qw=function(){if(!za.Rfc){var sa=D.EwaSettings.isChangeGateEnabled("OfficeVSO:5411756_FlickerFixForPresentModeOverlay");za.lea("OnVisibleAreaChanged",!0,sa)}};this.LDb=
function(){za.Rfc=!0};this.ap=function(){za.lea("OnCurrentSelectionModeChanged");za.DUf();za.Lg("OnCurrentSelectionModeChanged")};this.Dm=function(){za.lea("OnBlockCacheItemEvicted")};this.ef=function(){za.lea("OnBlockCacheItemChanged")};this.mF=function(){za.Rfc||za.lea("OnActiveItemPanesChanged")};this.uh=function(){za.Rfc=!1;za.Jca.Lg("ActiveSheetChanged");za.wya()};this.REb=function(sa,V){if(sa=Object(H.a)(wa.a,V.item))sa.Dpb(16,!0),sa.hnb(za.wya)};this.$Ji=function(){e.zhi||(za.Rpc&&za.Rpc.uq&&
za.Rpc.hide(),ja.g(za.$).isEditing&&ja.g(za.$).wo(!0),za.jxc(!1),T.ULS.sendTraceTag(537154321,0,50,"PresentModeManager.OnFullScreenChangeEventHandler: Esc pressed to exit present mode"))};this.aKi=function(){T.ULS.sendTraceTag(537154320,0,10,"PresentModeManager.OnFullScreenErrorEventHandler: Error handling full screen mode")};this.$=ta;this.gridView=ja.g(this.$);this.Tjj=ta.ya.PresentModeRenderUpdateTimeout;this.initialize(ta)}function e(){}function k(ta,za){var sa=qa.call(this,ta)||this;sa.A_i=function(){sa.Jca.kRd(!0)};
sa.Jca=za;sa.domElement.classList.add("ewr-presentMode-on");ta={};ta=(ta[k.Vv]=sa.nc,ta);sa.Rb=0;sa.initializeAndShow("",sa.A_i,ta);return sa}function l(ta){this.VZa=this.FDd=null;this.$=ta;this.gridView=ja.g(this.$)}function n(){this.overlayCavityInfos=this.overlayContainerInfo=this.containerId=null}function f(){this.height=this.width=0}function v(){this.angle=this.translateY=this.translateX=this.height=this.width=this.top=this.left=0}function r(ta){var za=this;this.sre=this.fPa=this.DDd=this.EDd=
this.Ica=this.ewaAccessibilityManager=null;this.isInitialized=!1;this.zpc={};this.ypc={};this.cPa=null;this.aGf=0;this.onKeyDown=function(sa){sa=sa.Ca;if(9===sa.keyCode){var V=za.Ica.querySelectorAll(ca.DOMElementExtensions.er),Ia=ca.DOMElementExtensions.Cl(V);V=ca.DOMElementExtensions.az(V);ca.DOMElementExtensions.kna(sa,Ia,V);return!0}return!1};this.Kl=function(){za.$.da.Za(337,function(sa){za.fPa.getPresentModeFloatieControlsMap().then(function(V){for(var Ia={},Ha=0;Ha<V.length;Ha++)Ia[V[Ha].controlId]=
V[Ha].modelType;V=sa.N6.d4a(Ia);0<V.length&&appChrome.api.dispatch(V);za.kjj()})})};this.$=ta}function y(){}function m(ta){return F.call(this,ta)||this}function w(ta,za){this.$=ta;this.presentModeManager=za}var B=b(10);u=b(0);var A=b(905),z=b(51),x=b(37),D=b(1),I=b(186);w.prototype.Lc=function(){return!1};w.prototype.zc=function(ta,za){if(!D.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PresentMode",!1))return!1;switch(za.command){case 642419866:return!0;case 588342182:return this.presentModeManager.jz;
default:return!1}};w.prototype.executeCommand=function(ta,za){ta=x.TaskExtensions.jk();za=za.command;switch(za){case 642419866:this.presentModeManager.jxc(!this.presentModeManager.jz);this.presentModeManager.Lg("TogglePresentMode");break;case 588342182:this.presentModeManager.J6a=!this.presentModeManager.J6a;this.presentModeManager.S2f(this.presentModeManager.J6a,"TogglePresentModeOverlay");this.presentModeManager.Lg("TogglePresentModeOverlay");break;default:ta=I.a(za)}return ta};w.prototype.Qc=function(){return!1};
Object(u.a)(w,"PresentModeCommandHandler",null,[429]);var F=A.a;Rk(m,F);m.prototype.Ad=function(){var ta=this;x.TaskExtensions.Aa(z.GetServiceTaskFactory.Ra(this.$.da,423,424,this.hb),function(za){ta.jd([new w(ta.$,za.result)])},this.la,3)};m.ka=function(ta){A.a.Qd(420,new m(ta))};Object(u.a)(m,"PresentModeCommandHandlerFactory",A.a,[]);var G=b(232),T=b(14),O=b(130),U=b(4),J=b(113),H=b(85);y.gqh="ewa-presentMode-overlay";y.hqh="ewa-presentMode-panel-container";y.iqh="ewa-presentMode-rowHdrParent-container";
Object(u.a)(y,"CssClassNames",null,[]);var K=b(19),N=b(5),M=b(155),C=b(305),Q=b(133),P=b(388),ka=b(177);b(59);var R=b(114),fa=b(469),ca=b(12),ea=b(11),wa=b(101),X=b(358),ja=b(21),va=b(134),ua=b(444),Xa=b(109),aa=b(13),ba=b(272),oa=b(253),ra=b(179),db=b(44);r.prototype.dispose=function(){this.$=this.DDd=this.EDd=this.Ica=this.fPa=null};r.prototype.l$h=function(){var ta=this;window.requestAnimationFrame(function(){ta.Ica=document.createElement("div");ta.$.Ov.insertBefore(ta.Ica,ta.$.Ov.lastChild);ta.Ica.id=
ta.$.yb+N.a.P9b;ta.Ica.classList.add(y.hqh);ta.EDd=document.getElementById(ta.$.yb+N.a.C4c);ta.DDd=[ta.$.hE];ta.isInitialized=!0});this.fPa=presentMode.PresentModeControllerFactoryGlobal.createPresentModeFloatieController();this.fPa.initializePresentModeFloatie()};r.prototype.fYh=function(){var ta={};ta.PollingCountPerCaller=J.a.toJSON(this.ypc);ta.PollingDurationPerCaller=J.a.toJSON(this.zpc);return ta};r.prototype.kRd=function(ta){this.isInitialized?ta?(this.fPa.showPresentModeFloatie(this.Ica,
this.EDd,this.DDd),this.Lg("ShowOrHideFloatiePanel"),this.P7i()):(this.fPa.hidePresentModeFloatie(),this.COj()):T.ULS.sendTraceTag(537154326,0,15,"PresentModeFloatieManager.ShowOrHideFloatiePanel called before initialization complete")};r.prototype.Lg=function(ta){this.aGf=ea.HelperMethods.Qb();this.cPa=ta;this.sre=ra.AsyncMethodContext.Ms(this.Kl,100,db.a.z_i+ta,this.sre)};r.prototype.Sf=function(ta,za){if(za)return!1;ta=ca.DOMElementExtensions.Cl(this.Ica.querySelectorAll(ca.DOMElementExtensions.er));
if(!ta)return T.ULS.sendTraceTag(537154325,0,10,"PresentModeFloatieManager.SetFocusOnSection: Could not find first focusable item in present mode toolbar"),!1;ta.focus();return!0};r.prototype.$g=function(ta){return ca.DOMElementExtensions.nf(this.ic,ta)};r.prototype.ej=function(){};r.prototype.Aj=function(){};r.prototype.P7i=function(){var ta=this;ba.a(this.$).Lh(this);this.$.da.Za(15,function(za){ta.ewaAccessibilityManager=za;ta.ewaAccessibilityManager.mode=5});Xa.KeyInputManager.instance.ra(aa.a.Lb,
this.ic,this.onKeyDown)};r.prototype.COj=function(){ba.a(this.$).Az(this);ja.g(this.$).s0();this.ewaAccessibilityManager&&(this.ewaAccessibilityManager.mode=0);Xa.KeyInputManager.instance.Ba(aa.a.Lb,this.ic,this.onKeyDown)};r.prototype.kjj=function(){var ta=ea.HelperMethods.Qb()-this.aGf,za=this.zpc[this.cPa]?this.zpc[this.cPa]:0;this.zpc[this.cPa]=za>ta?za:ta;this.ypc[this.cPa]=this.ypc[this.cPa]?this.ypc[this.cPa]+1:1};Mf.Object.defineProperties(r.prototype,{ic:{configurable:!0,enumerable:!0,get:function(){return this.Ica}},
canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){this.fPa.updatePresentModeFloatieShyState(2);return!!this.Ica}},Yd:{configurable:!0,enumerable:!0,get:function(){return oa.a.nHf}}});Object(u.a)(r,"PresentModeFloatieManager",null,[699,448,3]);var Ka=b(7),Ga=b(60);Object(u.a)(v,"OverlayCavityInfo",null,[]);Object(u.a)(f,"OverlayContainerInfo",null,[]);Object(u.a)(n,"PresentModeOverlayProps",null,[]);l.prototype.X$h=function(){var ta=this;this.FDd=presentMode.PresentModeControllerFactoryGlobal.createPresentModeOverlayController();
window.requestAnimationFrame(function(){ta.VZa=Array(5);for(var za,sa,V=1;4>=V;V++)za=document.createElement("div"),ca.DOMElementExtensions.setVisible(za,!1),za.id=String.format("{0}-{1}","PresentModeOverlay",V),ca.DOMElementExtensions.toggleCssClass(za,y.gqh,!0),sa=ta.gridView.Cf(V).domElement,sa.insertBefore(za,sa.firstChild),ta.VZa[V]=za})};l.prototype.R2f=function(ta){ta&&this.URj();for(var za=1;4>=za;za++)this.qef(za)&&ca.DOMElementExtensions.setVisible(this.VZa[za],ta);ca.DOMElementExtensions.toggleCssClass(this.$.Tq,
"ewr-presentMode-overlay",ta)};l.prototype.URj=function(){for(var ta=this.gTg(),za,sa=1;4>=sa;sa++)za=sa,ta[za]&&this.FDd.showOverlayWithCavity(this.VZa[za],ta[za])};l.prototype.dispose=function(){this.FDd=this.VZa=this.gridView=this.$=null};l.prototype.gTg=function(){for(var ta,za,sa=ja.g(this.$).rtl,V,Ia=Array(5),Ha=1;4>=Ha;Ha++)za=Ha,this.qef(Ha)&&(ta=this.gridView.Cf(Ha),V=this.gridView.ha.Oa.O4?this.cOh(Ha,ta,sa):this.VOh(Ha,ta,sa),ta=this.T7g(ta),Ia[za]=this.m8g(this.VZa[za].id,ta,V));return Ia};
l.prototype.qef=function(ta){return this.gridView.eb.BQ(ta)};l.prototype.T7g=function(ta){return Object(Ka.a)(new f,{width:ta.fn.width,height:ta.fn.height})};l.prototype.m8g=function(ta,za,sa){return Object(Ka.a)(new n,{containerId:ta,overlayContainerInfo:za,overlayCavityInfos:sa?[sa]:null})};l.prototype.cOh=function(ta,za,sa){var V=ja.g(this.$).ha.Oa.Yb;if(!V)return T.ULS.sendTraceTag(537154317,0,10,"PresentModeOverlayRenderer.GetFloatingObjectOverlayCavityInfo: Selected Floating Object is null."),
null;var Ia=V.extension.fOh(ta);ta=Ia.MBa;V=Ia.rotation;var Ha=Ia.translateX;var ob=Ia.translateY;return Ia.returnValue?(Ia=ta.x-za.fn.x,Object(Ka.a)(new v,{left:(sa?za.fn.width-(Ia+ta.width):Ia)-3+1,top:ta.y-za.fn.y-3+1,width:ta.width+5,height:ta.height+5,angle:V,translateX:Ha,translateY:ob})):null};l.prototype.VOh=function(ta,za,sa){ta=this.gridView.qb.Dub(this.gridView.ha.sa.activeRange,ta)||Ga.a.I3;if(!ta.ze(za.fn))return null;var V=ta.x-za.fn.x;return Object(Ka.a)(new v,{left:sa?za.fn.width-
(V+ta.width)-2:V-3,top:ta.y-za.fn.y-3,width:ta.width+5,height:ta.height+5})};Object(u.a)(l,"PresentModeOverlayRenderer",null,[700,3]);var xa=b(62),da=b(389),qa=da.a;Rk(k,qa);k.prototype.hide=function(){qa.prototype.hide.call(this);O.a.Gw(N.a.X2f,"false",this.$.ya.ShowPresentModeWelcomeDialogCookieExpirationDays)};Mf.Object.defineProperties(k.prototype,{nc:{configurable:!0,enumerable:!0,get:function(){return"PresentModeWelcomeDialog"}}});Object(u.a)(k,"PresentModeWelcomeDialog",da.a,[]);e.requestFullscreen=
function(ta){ta.webkitRequestFullscreen?ta.webkitRequestFullscreen():ta.msRequestFullscreen?ta.msRequestFullscreen():ta.mozRequestFullScreen?ta.mozRequestFullScreen():ta.requestFullscreen?ta.requestFullscreen():T.ULS.sendTraceTag(7145619,210,50,"RequestFullscreen got invoked in unknown browser")};e.exitFullscreen=function(){document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():
document.exitFullscreen?document.exitFullscreen():T.ULS.sendTraceTag(7145620,210,50,"ExitFullscreen got invoked in unknown browser")};Mf.Object.defineProperties(e,{FDh:{configurable:!0,enumerable:!0,get:function(){return document.webkitFullscreenEnabled?"webkitfullscreenchange":document.msFullscreenEnabled?"MSFullscreenChange":document.mozFullScreenEnabled?"mozfullscreenchange":document.fullscreenEnabled?"fullscreenchange":null}},GDh:{configurable:!0,enumerable:!0,get:function(){return"undefined"!==
typeof document.webkitFullscreenEnabled?"webkitfullscreenerror":"undefined"!==typeof document.msFullscreenEnabled?"MSFullscreenError":"undefined"!==typeof document.mozFullScreenEnabled?"mozfullscreenerror":"undefined"!==typeof document.fullscreenEnabled?"fullscreenerror":null}},zhi:{configurable:!0,enumerable:!0,get:function(){return!!document.webkitFullscreenElement||!!document.msFullscreenElement||!!document.mozFullScreenElement||!!document.fullscreenElement}}});Object(u.a)(e,"FullscreenUtils",
null,[]);d.prototype.jxc=function(ta){var za=this;this.jz!==ta&&(this.G8d=ta,this.J6a=this.jz,this.Q$e(),this.tLb=this.E1f(),window.requestAnimationFrame(function(){ca.DOMElementExtensions.toggleCssClass(za.$.Tq,"ewr-presentMode-transition",!0);$addHandler(za.W1a,"transitionend",za.koa);za.Vzj(!ta);za.sVi();ca.DOMElementExtensions.toggleCssClass(za.$.Tq,"ewr-presentMode-on",ta);za.Uzj(ta);M.b(za.$).P2f(za.jz);M.c(za.$).P2f(za.jz);za.$.Iza();za.hPa.R2f(za.tLb);if(za.jz){za.iZa();O.a.get(N.a.X2f)?za.Jca.kRd(za.jz):
za.Rpc=new k(za.$,za.Jca);var sa=ua.b(za.$);sa&&(za.PKd=sa.Z6c(!1));za.mHf=ea.HelperMethods.Qb()}else za.Jca.kRd(ta),za.PKd&&(sa=ua.b(za.$))&&(sa.Z6c(!0),za.PKd=!1),za.a6b(),za.evi()}))};d.prototype.S2f=function(ta,za){this.pRd=ta;this.lea(za)};d.prototype.Lg=function(ta){this.Jca.Lg(ta)};d.prototype.dispose=function(){this.a6b();this.hPa&&(this.hPa.dispose(),this.hPa=null);this.gridView=this.$=null};d.prototype.Vzj=function(ta){var za=this.$.da.za(25);void 0===za||null===za?T.ULS.sendTraceTag(537154324,
0,10,"PresentModeManager.ShowOrHideGridPresence: presenceView is null"):ta?za.dxc():za.ydc()};d.prototype.sVi=function(){var ta=this;ca.DOMElementExtensions.toggleCssClass(document.getElementById(U.AFrameworkApplication.f2a),K.a.Gp,this.jz);ca.DOMElementExtensions.toggleCssClass(this.$.Tq,"ewr-presentMode-on",this.jz);this.Yzj(this.jz);this.gridView.wnd=!this.jz;this.kSj();this.$.da.Za(32,function(za){za.ISj(ta.jz)});R.b(this.$,function(za){za.bcg(ta.jz)})};d.prototype.Yzj=function(ta){if(this.mGb)if(ta){if(ta=
Object(H.a)(wa.a,this.$.pa))ca.DOMElementExtensions.toggleCssClass(this.$.Tq,"ewr-presentMode-on-headers-off",!ta.headersVisible),ca.DOMElementExtensions.toggleCssClass(this.$.Tq,"ewr-presentMode-on-rtl",ja.g(this.$).rtl);this.UAc(0)}else this.$.Tq.classList.remove("ewr-presentMode-on-headers-off"),this.$.Tq.classList.remove("ewr-presentMode-on-rtl"),this.UAc(1)};d.prototype.UAc=function(ta){var za=Object(H.a)(wa.a,this.$.pa);if(za){var sa=parseInt(this.$.Ov.style.right,10);if(1===ta||2===ta){if(isNaN(sa)||
sa<this.B0a)return;sa-=this.B0a}if(0===ta||2===ta)ta=za.headersVisible,za=ja.g(this.$).rtl,ta=ta?za?0:32:12,sa=isNaN(sa)?ta:sa+ta,this.B0a=ta;this.$.Ov.style.right=ea.HelperMethods.jc(sa);this.CAe=sa}};d.prototype.kSj=function(){var ta=document.getElementById(this.$.yb+N.a.B5b).parentNode;ca.DOMElementExtensions.toggleCssClass(ta,y.iqh,this.jz)};d.prototype.initialize=function(ta){this.hPa=new l(ta);this.hPa.X$h();this.Jca=new r(ta);this.Jca.l$h();this.W1a=document.getElementById("MainApp");this.hUe=
this.$Ji;$addHandler(this.W1a,e.FDh,this.hUe);$addHandler(this.W1a,e.GDh,this.aKi);this.mGb||(this.mGb=document.createElement("div"),this.mGb.className="ewa-presentMode-right-frame",this.$.hE.appendChild(this.mGb));this.koa=this.p$i};d.prototype.iZa=function(){this.gridView.ha.s2(this.ep);this.gridView.ha.gY(this.ug);this.gridView.$b.Ak(this.Dh);this.gridView.$b.tm(this.Af);this.gridView.QD(this.ap);this.gridView.view.Es(this.qw);this.gridView.fUc(this.LDb);this.gridView.Ea.uG(this.Dm);this.gridView.Ea.Ds(this.ef);
this.$.va.If(this.uh);this.$.va.Cra(this.mF);this.$.va.Ega(this.REb);this.$.sA(this.Oi);this.$.Tk(this.Yc);var ta=Object(H.a)(X.a,this.$.va);ta=bk(ta.items);for(var za=ta.next();!za.done;za=ta.next())za.value.hnb(this.wya)};d.prototype.a6b=function(){this.gridView&&(this.gridView.ha.S6(this.ep),this.gridView.ha.rW(this.ug),this.gridView.$b.vk(this.Dh),this.gridView.$b.Nl(this.Af),this.gridView.yF(this.ap),this.gridView.view.Fq(this.qw),this.gridView.$Hd(this.LDb),this.gridView.Ea.YH(this.Dm),this.gridView.Ea.Dq(this.ef));
if(this.$){this.$.va.vg(this.uh);this.$.va.yza(this.mF);this.$.va.Ima(this.REb);this.$.gD(this.Oi);this.$.rl(this.Yc);var ta=Object(H.a)(X.a,this.$.va);ta=bk(ta.items);for(var za=ta.next();!za.done;za=ta.next())za.value.KId(this.wya)}};d.prototype.E1f=function(){if(!this.jz||!this.J6a)return!1;if(1===this.gridView.ha.Pe){var ta=this.$.pa.activeRange.isSingle,za=1===this.$.pa.selectedRanges.length&&!ta,sa=this.gridView.isEditing,V=this.zpd;za||T.ULS.sendTraceTag(537154322,0,50,"PresentModeManager.ShouldShowPresentModeOverlay: Not showing present mode overlay, single cell selection : {0}",
ta);return this.pRd&&za&&!sa&&!V}return this.pRd};d.prototype.Uzj=function(ta){ta?e.requestFullscreen(this.W1a):e.exitFullscreen()};d.prototype.lea=function(ta,za,sa){var V=this;sa=void 0===sa?!1:sa;void 0!==za&&za||(this.tLb=this.E1f());T.ULS.sendTraceTag(555356484,0,100,"PresentModeManager.UpdateLayout: UpdateLayout triggered by {0}, visibility: {1}, immediateUpdate: {2}",ta,this.tLb,sa);if(this.aOb&&sa)T.ULS.sendTraceTag(543023559,0,50,"PresentModeManager.UpdateLayout: Cancel update layout for {0}",
this.$Nb),window.cancelAnimationFrame(this.$Nb),this.$Nb=0;else if(this.aOb){T.ULS.sendTraceTag(543023558,0,50,"PresentModeManager.UpdateLayout: Skipping update layout for {0}",ta);return}sa?this.EXd(ea.HelperMethods.Qb(),ta):(this.$Nb=window.requestAnimationFrame(function(Ia){V.EXd(Ia,ta)}),this.aOb=!0)};d.prototype.EXd=function(ta,za){var sa=this,V=ea.HelperMethods.Qb();if(V-ta>this.Tjj)this.$Nb=window.requestAnimationFrame(function(Ha){sa.EXd(Ha,za)}),this.aOb=!1,T.ULS.sendTraceTag(537154319,0,
50,"PresentModeManager.UpdateLayoutCallback: Scheduling update for next frame,  ElapsedTime = {0}ms.",V-ta);else{this.hPa.R2f(this.tLb);this.aOb=!1;var Ia=ea.HelperMethods.Qb();ta=ea.HelperMethods.Qb()-ta;V=Ia-V;this.Yij(ta,za);T.ULS.sendTraceTag(537154318,0,50,"PresentModeManager.UpdateLayoutCallback: UpdateLayoutTotalDuration = {0}ms. rafTotalDuration = {1}ms",V,ta)}};d.prototype.Q$e=function(){var ta=this;P.a(this.$.userOperationManager,function(za,sa,V){var Ia=ta.$.oa.xa,Ha=ta.jz,ob=Ia.Na(41,
null);ob.shouldEnablePresentMode=Ha;return xa.g(Ia,"SetPresentMode",ob,za,sa,V,null,0)},function(za){return new ka.a(252,0,za)},null)};d.prototype.DUf=function(){var ta=fa.a(this.gridView.Pe);1!==this.gridView.Pe||this.$.pa.activeRange.isSingle||(ta="Range");this.Duc[ta]=this.Duc[ta]?this.Duc[ta]+1:1};d.prototype.Yij=function(ta,za){var sa=this.Ioc[za]?this.Ioc[za]:0;this.Ioc[za]=sa>ta?sa:ta;this.Hoc[za]=this.Hoc[za]?this.Hoc[za]+1:1};d.prototype.evi=function(){var ta={},za=ea.HelperMethods.Qb()-
this.mHf;ta.PresentModeDuration=za;ta.SelectionCountPerObject=J.a.toJSON(this.Duc);ta.OverlayCountPerCaller=J.a.toJSON(this.Hoc);ta.OverlayDurationPerCaller=J.a.toJSON(this.Ioc);za=this.Jca.fYh();for(var sa in za)ta[sa]=za[sa];va.b(this.$).yd(Q.a.y_i,ta,void 0,!0)};Mf.Object.defineProperties(d.prototype,{jz:{configurable:!0,enumerable:!0,get:function(){return this.G8d}}});Object(u.a)(d,"PresentModeManager",null,[668,3]);var na=b(256),ia=G.a;Rk(c,ia);c.prototype.create=function(){var ta=this,za=z.GetServiceTaskFactory.Ra(this.$.da,
283,284,1);x.TaskExtensions.Aa(za,function(){x.TaskExtensions.Aa(na.c(za.result.tn.loadScript("presentMode")),function(){var sa=ta.$.da.za(423);sa||(sa=new d(ta.$),ta.$.da.Ga(423,sa));ta.pb(sa)},ta.$.la,3)},this.$.la,3)};c.ka=function(ta){ta.da.Ga(424,new c(ta))};Object(u.a)(c,"PresentModeManagerFactory",G.a,[]);b.d(E,"a",function(){return a})},1369:function(u,E,b){function a(){w.a.Fa(c.ka)}function c(cb){return eb.call(this,cb)||this}function d(cb,Ua,pa,Qa){var Db=Z.call(this)||this;Db.$=cb;Db.businessBar=
Qa;Db.openInExcelOperation=Ua;Db.OJ=pa;return Db}function e(){}function k(cb){var Ua=ta.call(this,cb)||this;Ua.sessionId=cb.ya.UserSessionId;Ua.yQg=cb.ya.BuildVersion;return Ua}function l(cb){var Ua=this;this.T6h="itms-apps://";this.U6h="apps.apple.com/app/apple-store/id586683407?mt=8&pt=80423&ct=miniWAC";this.uig=function(pa){1==pa&&Ua.nDc()};this.$=cb;this.qx=F.AFrameworkApplication.ta.Qa.qx;this.Bla="ms-excel:ofe|u|"+this.qx;this.hm=F.AFrameworkApplication.fa.Wa("AppUrl");H.a.tba||H.a.rh?this.hm=
this.T6h+this.U6h:H.a.To&&(F.AFrameworkApplication.fa.qa("UseAppAndroidMarketURL")?(D.ULS.sendTraceTag(523534414,306,100,"OpenInAppDialogReact: Using app android market url"),this.hm=F.AFrameworkApplication.fa.Wa("WildFireMarketUrlExcelAndroid")):H.a.kzb?this.hm=F.AFrameworkApplication.fa.Wa("WildFireUrlChinaStoreAndroid"):4<H.a.xVc.f8a&&(this.hm=F.AFrameworkApplication.fa.Wa("WildFireUrlExcelAndroid")))}function n(cb){var Ua=qa.call(this,cb)||this;Ua.GH=null;Ua.UDb=function(){D.ULS.sendTraceTag(574993313,
306,50,"MouseClick: Open with redirection timer");if(Ua.$.ya.IsMeetingLiveSession)return Ua.nDc(),!0;H.a.To?(D.ULS.sendTraceTag(574993312,306,50,"Android intent scheme is being used to open android app from browser"),Ua.qx&&Ua.qx.length||D.ULS.sendTraceTag(537162595,306,15,"ClientUrl is null"),Ua.openUrl("intent:"+Ua.qx+"#Intent;scheme=ms-excel;action=android.intent.action.VIEW;S.browser_fallback_url="+Ua.hm+";end","_top")):9<=H.a.wjd?(D.ULS.sendTraceTag(537162594,306,50,"OpenInAppDialog.onClickHandler: Open in app directly if installed for iOS version 9 or above"),
Ua.openUrl(Ua.Bla,"_top"),window.setTimeout(function(){Ua.openUrl(Ua.hm,"_blank")},9E3)):(D.ULS.sendTraceTag(537162593,306,50,"OpenInAppDialog.onClickHandler: Open in app if installed, else redirection to appstore for iOS version below 9."),Ua.openUrl(Ua.Bla,"_top"),window.setTimeout(function(){Ua.openUrl(Ua.hm,"_blank")},500));return!0};Ua.nOa=function(pa){return pa.Ca.keyCode===oa.a.Oh||pa.Ca.keyCode===oa.a.Doa?(D.ULS.sendTraceTag(537162592,306,50,"KeyPress: Open with redirection timer"),pa.zb.click(),
!0):!1};if(1!==F.AFrameworkApplication.ta.Qa.Cj)return Ua;Ua.qx=Ua.$.workbookContext.ClientUrl;Ua.Bla="ms-excel:ofe|u|"+Ua.qx;Ua.hm=F.AFrameworkApplication.fa.Wa("AppUrl");H.a.tba?Ua.hm="itms-apps://"+F.AFrameworkApplication.fa.Wa("WildFireUrlExceliOS")+"&referrer=utm_source%3Dwac%26utm_medium%3Dweb%26utm_campaign%3Dminiwac":H.a.To&&(xa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseAppAndroidMarketURL",!1)&&Ua.$.ya.IsMeetingLiveSession?(D.ULS.sendTraceTag(529397969,306,100,"Using app android market url"),
Ua.hm=F.AFrameworkApplication.fa.Wa("WildFireMarketUrlExcelAndroid")):H.a.kzb?Ua.hm=F.AFrameworkApplication.fa.Wa("WildFireUrlChinaStoreAndroid"):4<H.a.xVc.f8a&&(Ua.hm=F.AFrameworkApplication.fa.Wa("WildFireUrlExcelAndroid")+"&referrer=utm_source%3Dwac%26utm_medium%3Dweb%26utm_campaign%3Dminiwac"));return Ua}function f(){}function v(cb){this.calculateType=0;this.calculateType=cb}function r(cb){this.calculationMode=0;this.calculationMode=cb}function y(cb,Ua){var pa=this;this.dialog=null;this.dvf=function(){pa.dialog&&
pa.dialog.hide()};this.$Ei=cb;this.ob=Ua;this.ob.Wmb(this.dvf)}function m(cb,Ua){return ba.call(this,cb,void 0,void 0,Ua)||this}var w=b(10);u=b(0);var B=b(615),A=b(905),z=b(51),x=b(37),D=b(14),I=b(1442),F=b(4),G=b(170),T=b(964),O=b(99),U=b(276),J=b(740),H=b(27),K=b(162),N=b(207),M=b(303),C=b(5),Q=b(154),P=b(103),ka=b(76),R=b(78),fa=b(388),ca=b(177),ea=b(59),wa=b(62),X=b(336),ja=b(649),va=b(1538),ua=b(442),Xa=b(330),aa=b(15),ba=va.a;Rk(m,ba);m.prototype.Fkf=function(){D.ULS.sendTraceTag(537162658,
0,50,"DownloadACopyAsOdsDialog.LogDialogDisplayed - ODS download dialog displayed")};m.prototype.Hkf=function(){D.ULS.sendTraceTag(537162657,0,50,"DownloadACopyAsOdsDialog.LogDownloadLinkClicked - ODS download dialog link clicked")};m.prototype.hjc=function(){ua.Redirect.showHelp(Xa.a.DEi);return!0};Mf.Object.defineProperties(m.prototype,{HNa:{configurable:!0,enumerable:!0,get:function(){return aa.a.instance.Xa(411)}},ojc:{configurable:!0,enumerable:!0,get:function(){return aa.a.instance.Xa(412)}},
njc:{configurable:!0,enumerable:!0,get:function(){return"DownloadOdsLink"}},qBb:{configurable:!0,enumerable:!0,get:function(){return"#"}},F7a:{configurable:!0,enumerable:!0,get:function(){return aa.a.instance.Xa(413)}},Xof:{configurable:!0,enumerable:!0,get:function(){return!0}}});Object(u.a)(m,"DownloadACopyAsOdsDialog",va.a,[]);y.prototype.xre=function(cb){this.dialog=cb};y.prototype.V5c=function(){this.$Ei.HDf(-1059172980)};y.prototype.dispose=function(){this.ob.VHb(this.dvf)};Object(u.a)(y,"DownloadACopyAsOdsDialogDownloadBehavior",
null,[353,3]);Object(u.a)(r,"MacroRecorderWorkbookCalculationModeSetPayload",null,[438]);Object(u.a)(v,"MacroRecorderWorkbookRecalculatedPayload",null,[438]);var oa=b(86),ra=b(150),db=b(195),Ka=b(13),Ga=b(109),xa=b(1);va=b(324);Mf.Object.defineProperties(f,{lUi:{configurable:!0,enumerable:!0,get:function(){return f.kUi}}});f.kUi="<div class='\"\"' id='OpenInAppDialog'> <div class='PrivacyDialogTitle UIFontDialogTitle' id='OpenInAppTitle'> <label id='OpenInAppTitle' class='\"\"' style='font-size:16pt' >{0}</label> </div> <div class='WACDialogRow' id='InfoMessageArea'> <label id='InfoMessageAreaLine1' class='\"\"' style='font-size:12pt' >{1}</label> <br/> </div> <br/> <div class='AppInstallButton' id='LinkToInstall' role='button' tabIndex='0'> <div class='clip32x32' id='BottomInfoIconClip' unselectable='on' style='display: inline-block; pointer-events:none;' role='img'> <img id='BottomIconInfo' class='{3}' role='presentation' src={2} /> </div> <div class='\"\"' id='AppstoreLink' style='display:inline-block; padding-top:4px; vertical-align:top;'> <label id='AppstoreLinkTitle' class='PrivacyDialogTitle' unselectable='on' style='font-size: 14pt; margin-left:8px' >{4}</label> </div> </div>";
Object(u.a)(f,"OpenInAppDialogCopyHtml",null,[]);var da=b(158),qa=va.a;Rk(n,qa);n.prototype.openUrl=function(cb,Ua){var pa=document.getElementById("link");pa||(pa=document.createElement("a"),pa.id="link",pa.style.visibility="hidden",pa.href="",document.body.appendChild(pa));pa.target=Ua;pa.href=cb;pa.click()};n.prototype.nDc=function(){var cb=this;D.ULS.sendTraceTag(529397968,306,50,"OpenInAppForLiveFiles API invoked");x.TaskExtensions.Aa(z.GetServiceTaskFactory.Ra(this.$.da,21,137,1),function(Ua){var pa=
{};pa.OpenInAppUrl=cb.Bla;pa.StoreUrl=cb.hm;Ua.result.uj("UI_OpenInMobileApp",pa)},this.$.la)};n.prototype.mUi=function(){D.ULS.sendTraceTag(529397967,306,100,"OpenInAppDialogHandler invoked")};n.prototype.rg=function(){this.Vf=ra.a.No(f.lUi,aa.a.instance.ga(665),aa.a.instance.ga(666),F.AFrameworkApplication.FC,da.getImageClass(F.AFrameworkApplication.fa.Wa("AppIcon")),aa.a.instance.ga(667));this.ye="OpenInAppDialog";this.Rb=5;this.initializeAndShow("",this.mUi.bind(this),null);this.kI(this.GH)};
n.prototype.hv=function(cb){qa.prototype.hv.call(this,cb);document.getElementById("WACDialogBodyPanel").style.padding="0 4px 0 24px";this.GH=document.getElementById("LinkToInstall");db.a.instance.ra(Ka.a.click,this.GH,this.UDb);Ga.KeyInputManager.instance.ra(Ka.a.Gd,this.GH,this.nOa)};n.prototype.dispose=function(){this.GH&&(db.a.instance.Ba(Ka.a.click,this.GH,this.UDb),Ga.KeyInputManager.instance.Ba(Ka.a.Gd,this.GH,this.nOa),this.GH=null);qa.prototype.dispose.call(this)};Mf.Object.defineProperties(n.prototype,
{nc:{configurable:!0,enumerable:!0,get:function(){return"OpenInAppDialogCopy"}}});Object(u.a)(n,"OpenInAppDialogCopy",va.a,[]);var na=b(135),ia=b(391);l.prototype.nDc=function(){var cb=this;D.ULS.sendTraceTag(523534413,306,50,"OpenInAppDialogReact: OpenInAppForLiveFiles API invoked");x.TaskExtensions.Aa(z.GetServiceTaskFactory.Ra(this.$.da,21,137,1),function(Ua){var pa={};pa[ia.a.NDf]=cb.Bla;pa[ia.a.hm]=cb.hm;Ua.result.uj("UI_OpenInMobileApp",pa)},this.$.la)};l.prototype.rg=function(){D.ULS.sendTraceTag(523534412,
0,50,"initializeAndShowDialog: React Edit in app dialog opened.");var cb=new na.StandardDialog;cb.Rb=0;cb.mc(1,aa.a.instance.ga(671));cb.ql(aa.a.instance.ga(669),aa.a.instance.ga(670),0,this.uig)};Object(u.a)(l,"OpenInAppDialogReact",null,[]);va=b(389);var ta=va.a;Rk(k,ta);k.prototype.BM=function(){var cb={};return cb[k.rnj]=aa.a.instance.ga(672),cb[k.snj]=this.sessionId,cb[k.id]="WACSessionIdDialog",cb[k.cYc]=aa.a.instance.ga(673),cb[k.buildVersion]=this.yQg,cb};k.prototype.rg=function(){var cb=
this.BM();this.Rb=5;this.initializeAndShow(aa.a.instance.ga(1018),this.cWj.bind(this),cb)};k.prototype.cWj=function(){D.ULS.sendTraceTag(521434688,306,100,"Show WACSessionIdDialogHandler invoked")};Mf.Object.defineProperties(k.prototype,{nc:{configurable:!0,enumerable:!0,get:function(){return"WACSessionIdDialog"}}});k.id="id";k.rnj="sessionIdLabel";k.snj="sessionIdValue";k.cYc="buildLabel";k.buildVersion="buildVersion";Object(u.a)(k,"WACSessionIdDialog",va.a,[]);var za=b(28),sa=b(31),V=b(371),Ia=
b(11),Ha=b(186),ob=b(294),ib=b(21),La=b(42),zb=b(258),Fb=b(494),Yb=b(396),kb=b(50),vb=b(6),Wa=b(147),qb=b(1173),yb=b(82),ec=b(35),Ob=b(377),Cb=b(261);e.prototype.tQ=function(cb,Ua){cb=sa.a.Xc(12,1,674,0,0,0,"Blank");cb.Description=String.format(aa.a.instance.ga(675),Ua);return cb};e.prototype.D$b=function(cb){switch(cb){case 1:case 2:return 0;default:return 2}};Object(u.a)(e,"ReloadCloseConfirmation",null,[663]);var ab=b(156),ya=b(650),ma=b(67),ha=b(58),Z=N.a;Rk(d,Z);d.prototype.Lc=function(){return!1};
d.prototype.executeCommand=function(cb,Ua,pa,Qa){var Db=this,Kb=this.R6b,Ab=this.$,ub=Ua.command,Mb=this.openInExcelOperation,Aa=this.$.yb,Za=pa.SourceControlId;Ab.Nk.ble(ub);Mb.Rvc(Ua.startTime.getTime().toString());cb=null;switch(ub){case 1455037301:this.$.g5?Mb.MAe():Mb.G1c();break;case -2044628748:case 2004484710:this.$.g5?Mb.MAe():Mb.openInExcelClient();break;case 213236505:"ContextMenu.ShowOpenInAppDialogOnMobile"===Za?(this.RBb("CellLongPress"),D.ULS.sendTraceTag(576495705,0,50,"FileOperationsCommandHandler.ExecuteCommand: Open-in-app dialog invoked from cell long press")):
(this.RBb("PencilIcon"),D.ULS.sendTraceTag(576495704,0,50,"FileOperationsCommandHandler.ExecuteCommand: Open-in-app dialog invoked from pencil icon in toolbar"));this.showOpenInAppDialog();break;case 480922297:xa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShowWacSessionIdDialogOnMobile",!1)&&(new k(this.$)).rg();break;case -2028960985:Mb.J4f();break;case -1059172980:new m(Mb.Qte(ub),new y(Mb,Ab.ob));break;case -1285148982:this.clientWorkflow.fd.activityState[ec.a.fTc]=!0;this.Zzc(!1);
break;case -75280711:this.Zzc(!1);break;case -455164169:this.Zzc(!0);break;case -1388494670:this.$.da.Za(400,function(xb){xb.fyi();Db.Zzc(!1)});break;case 810888577:F.AFrameworkApplication.mk=(new Date).getTime();D.ULS.sendTraceTag(537162656,0,50,"FileOperationsCommandHandler.ExecuteCommand: Set AccessTokenTtl to {0}",F.AFrameworkApplication.mk);break;case -1804063550:case -974518828:Ua=0;C.a.gBd in pa&&(Ua=pa[C.a.gBd]);Mb.HDf(ub,Ua);break;case -1339961039:Ua=!1;pa&&C.a.SIb in pa&&(Ua=pa[C.a.SIb]);
this.reloadWorkbook(!1,Ua);break;case -8805455:var Zb=this.workbookContext;Ab.isEditMode||(d.sye(Ab),cb=x.TaskExtensions.Aa(this.OJ.value,function(xb){xb=xb.result;var Va=xb.isEnabled();Va&&ja.a(xb,G.a.copyAndEdit,ea.a.qg.YWe(),Db.$.ea.Jg.get(2))?D.ULS.sendTraceTag(537162655,0,50,"FileOperationsCommandHandler.ExecuteCommand: ReloadInEditMode ribbon command was procesed through SendMessageIfOptionSet()"):Va&&F.AFrameworkApplication.zdg?(Va={},Va[I.a.dEd]=F.AFrameworkApplication.userSessionId,Va[F.AFrameworkApplication.qAi]=
za.a.Ta.Jb.getTime().toString(),D.ULS.sendTraceTag(537162654,0,50,"FileOperationsCommandHandler.ExecuteCommand: processing ReloadInEditMode ribbon command whike UseEditModePostMessage flag is ON"),xb.uj(G.a.editMode,Va)):Kb.CopyAndEditUrl?Db.X2g():(Db.hc.supportsEditing||Zb.EditUrl)&&Db.reloadWorkbookInEditMode()},this.la,3));break;case -723527778:Ab.isEditMode&&(d.sye(Ab),this.reloadWorkbookInViewMode());break;case 1783960667:case -1355155015:var jb=Ab.oa.xa.Pb(),Vb=-1355155015===ub?1:0,Ic=function(){return new v(Vb)};
cb=fa.a(this.$.userOperationManager,function(xb,Va,tb){return wa.z(Ab.oa.xa,Vb,null,xb,Va,tb,null,jb)},function(xb){return new ca.a(128,0,xb,void 0,Ic)},Ua);ib.g(Ab).hg.GG(!1);break;case -1158102843:cb=ib.g(Ab).hg.recalcSheet(Ua);ib.g(Ab).hg.GG(!1);break;case -988468372:if(xa.EwaSettings.ma(302))if(Qa=parseInt(pa[ka.a.Nc],10),0<=Qa&&3>Qa)this.setCalculationMode(Ua,Qa);else return D.ULS.sendTraceTag(537162652,0,10,"SetCalculationMode , unexpected menuItemId: {0}",pa[ka.a.Nc]),Ha.a(ub);break;case 257398710:Q.a.ntw(Kb.ReportAbuseUrl,
Ab);break;case 1800405051:this.Tij();break;case -48469327:this.saveACopy();break;case 214430355:Ua=!1;pa&&C.a.B6c in pa&&(Ua=pa[C.a.B6c]);if(!this.Cwj(Ua,pa))break;F.AFrameworkApplication.Y4?this.businessBar.Tf(41,null):this.businessBar.Tf(Ua?22:23,null);break;case 1389557314:cb=x.TaskExtensions.Aa(this.OJ.value,function(xb){ja.a(xb.result,G.a.Uyh,null,Db.$.ea.Jg.get(6))||Q.a.ntw(Kb.FileVersionUrl,Ab)},this.la,3);break;case 2145659238:this.closeWorkbook();break;case 1773624819:Za===Aa+C.a.Ehf?Mb.Mqi():
Mb.Lqi();break;case 512141517:Za===Aa+C.a.Dhf?Mb.Xqi():Mb.Wqi();break;case -1224038235:var Rb=T.a.On in pa?!pa[T.a.On]:P.j(Ab.ea.workbookContext.Options);pa[T.a.Description]=Rb?aa.a.instance.ga(574):aa.a.instance.ga(575);cb=fa.a(this.$.userOperationManager,function(xb,Va,tb){var fb=Db.$.oa.xa,ac=fb.Na(9,null);ac.isReadOnlyRecommended=!Rb;return wa.g(fb,"SetReadOnlyRecommended",ac,xb,Va,tb,null,0)},function(xb){return new ca.a(129,0,xb)},Ua);break;case 1118926154:if(this.$.isEditMode){var kc=new K.a;
this.$.da.Za(53,function(xb){xb?(xb.Ql.Gqi(Db.$.yb+C.a.Yqd),kc.setResult(!0)):D.ULS.sendTraceTag(537162649,0,50,"Ignoring RibbonCommand.LaunchFileMenuShortcut, the ribbonManager is null.")});cb=kc.task}break;case -1698025133:Mb.openInBrowser();break;case 520859864:cb=x.TaskExtensions.Aa(z.GetServiceTaskFactory.Ra(this.$.da,393,394,Qa.tja()),function(xb){xb.result||D.ULS.sendTraceTag(537162648,0,10,"FileMenuCommandHandler::ExecuteCommand Failed to create SaveToHostManager")},this.$.la,3);break;default:cb=
Ha.a(ub)}return cb||ha.Task.Ua(!0)};d.prototype.RBb=function(cb){if(xa.EwaSettings.isChangeGateEnabled("OfficeVSO:4859963_LogUsageKpiForOpenInAppDialog"))if(Ia.HelperMethods.VZ){var Ua=new Map;Ua.set("EntryPoint",cb);O.Health.instance.recordKpiUsage(Yb.a.jUi,0,Fb.a.aAi,Ua)}else D.ULS.sendTraceTag(537162647,0,15,"FileOperationsCommandHandler.LogUsageKpiOpenInAppDialog: KPI Usage not supported")};d.prototype.showOpenInAppDialog=function(){F.AFrameworkApplication.isMobileMode&&(this.$.ya.IsMeetingLiveSession&&
xa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OpenInAppExcelReactDialog",!1)?(D.ULS.sendTraceTag(522859990,0,50,"FileOperationsCommandHandler.ShowOpenInAppDialog: SD-side open-in-app React dialog used"),(new l(this.$)).rg()):xa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseOpenInAppDialogCopyMobile",!1)?(D.ULS.sendTraceTag(574993315,0,50,"FileOperationsCommandHandler.ShowOpenInAppDialog: SD-side open-in-app dialog used"),(new n(this.$)).rg()):(D.ULS.sendTraceTag(574993314,
0,50,"FileOperationsCommandHandler.ShowOpenInAppDialog: Git-side open-in-app dialog used"),F.AFrameworkApplication.showOpenInAppDialog()))};d.prototype.Cwj=function(cb,Ua){var pa=this;return F.AFrameworkApplication.isMobileMode&&!R.a(this.$.ya,30)?(this.showOpenInAppDialog(),D.ULS.sendTraceTag(577300448,0,50,"FileOperationsCommandHandler.ShouldPromptEditInBrowser: Open-in-app dialog invoked from cell double tap"),this.RBb("CellDoubleTap"),D.ULS.sendTraceTag(537162646,0,50,"FileOperationsCommandHandler.ShouldPromptEditInBrowser: User attempted to edit in reading view in mobile browser "),
!1):F.AFrameworkApplication.Kgc&&(cb&&V.c(this.workbookContext.WorkbookFileName)||!this.workbookContext.FullDocumentInfo.HostEditUrl)?(D.ULS.sendTraceTag(537162645,0,50,"FileOperationsCommandHandler.ShouldPromptEditInBrowser: User attempted to edit in reading view a non-editable format .{0}, HostEditUrl {1}empty. Skipped prompt to edit",V.d(this.workbookContext.WorkbookFileName)?"xls":"csv",this.workbookContext.FullDocumentInfo.HostEditUrl?"not ":""),!1):U.a.any([25,26,30,31,56,32],function(Qa){return pa.businessBar.QLa(Qa)})?
(D.ULS.sendTraceTag(537162644,0,50,"FileOperationsCommandHandler.ShouldPromptEditInBrowser: User attempted to edit in reading view after opening in Edit by default"),!1):Ua&&C.a.l1i in Ua&&!cb?!1:!0};d.prototype.zc=function(cb,Ua){cb=!1;switch(Ua.command){case 1455037301:case -2044628748:case 2004484710:case -2028960985:case -974518828:case -1339961039:case -8805455:case -723527778:case 1783960667:case -1158102843:case -1355155015:case 257398710:case 214430355:case 1389557314:case 2145659238:case 1773624819:case 512141517:case 1118926154:case -1698025133:case 213236505:cb=
!0;break;case 480922297:case 520859864:cb=xa.EwaSettings.isChangeGateEnabled("OfficeVSO:3773098_SaveDeferredActionDispatcherEnabled")?!0:!1;break;case -1285148982:case -75280711:case -455164169:cb=xa.EwaSettings.ma(109);break;case -1388494670:cb=xa.EwaSettings.ma(109);break;case 810888577:cb=xa.EwaSettings.ma(271);break;case -1224038235:cb=this.$.ea.amIAlone;break;case -988468372:cb=xa.EwaSettings.ma(302);break;case -1804063550:case -1059172980:case 1800405051:case -48469327:cb=!0,D.ULS.shipAssertTag(537162642,
0,this.$.ika,"Command execute requested for SaveAs or Copy operation when data duplication is disallowed.")}return cb};d.prototype.Qc=function(){return!1};d.prototype.Tij=function(){var cb=this;if(this.dc){var Ua=this.$;La.a(Ua).Zs(new zb.a(vb.a.Zy,5,function(){Ua.XH(!1,!0);var pa=cb.clientWorkflow.fd.activityState;pa[Cb.a.Oq]=vb.a.tda;pa[Wa.a.pT]=2;pa[ec.a.As]=Ua.isEditMode;pa[Wa.a.tga]=!1}))}};d.prototype.saveACopy=function(){var cb=this;if(this.dc){var Ua=this.$;La.a(Ua).Zs(new zb.a(vb.a.Zy,5,
function(){Ua.XH(!1,!1);var pa=cb.clientWorkflow.fd,Qa=pa.activityState;Qa[Cb.a.Oq]=vb.a.hUf;Qa[ya.a.wYb]=cb.hc.hasUnsupportedFeaturesForEdit;Qa[Wa.a.tga]=!1;pa.yt(sa.a.laa(cb.businessBar.S6c,[-502303485]))}))}};d.prototype.Zzc=function(cb){var Ua=this;La.a(this.$).Zs(new zb.a(vb.a.gna,2,function(){Ua.$.XH(!0,!0);var pa=ma.a(Ua.$).fd,Qa=Ua.$.isEditMode;Qa=sa.a.Xc(1,1,0,0,0,Qa?-315732528:-2087635043,Qa?"DeploymentInvalidEditSession":"InvalidOrTimedOutSession");Qa.ForceVersionUpgrade=cb;pa.yt([Qa]);
pa=ma.a(Ua.$).fd.activityState;pa[Cb.a.Oq]=vb.a.gna;pa[ec.a.As]=Ua.$.isEditMode;pa[Wa.a.tga]=!1}))};d.prototype.closeWorkbook=function(){var cb=this;if(this.dc){var Ua=this.$;ea.a.qg.owc("2145659238")?x.TaskExtensions.Aa(this.OJ.value,function(pa){pa.result.uj(G.a.wRe,{})},this.la,3):La.a(Ua).Zs(new zb.a(vb.a.Zy,5,function(){Ua.XH(!0,!1);var pa=cb.clientWorkflow.fd.activityState;pa[Wa.a.aY]=!1;pa[Wa.a.tga]=!1;cb.hc.inViewerFromWebPart?(X.a.TEd(Ua,cb.clientWorkflow.fd),Ua.Nk.Dy("InViewerFromWebPart"),
pa[Cb.a.Oq]=vb.a.u_):(pa[Cb.a.Oq]=vb.a.Dk,Ua.Cd&32?pa[Wa.a.pT]=0:(pa[Wa.a.pT]=1,pa[Wa.a.lYb]=new qb.a),pa[ab.a.yje]=!0)}))}};d.prototype.X2g=function(){var cb=this,Ua=this.hc.vbaRemovedDuringConversion;D.ULS.sendTraceTag(537162636,0,50,"FileOperationsCommandHandler.CopyAndEditWorkbook: vbaRemovedDuringConversion = {0}",Ua);var pa=this.$;Ua?La.a(pa).Zs(new zb.a(vb.a.Zy,5,function(){var Qa=sa.a.Xc(3,0,0,1246,0,1069271157,"XLSMacroFailure");cb.clientWorkflow.fd.yt([Qa]);cb.clientWorkflow.fd.activityState[Cb.a.Oq]=
vb.a.oeb})):F.AFrameworkApplication.hideHeader?Ia.HelperMethods.Ze(this.R6b.CopyAndEditUrl,"_blank",void 0,"FileOperationCommandHandler.CopyAndEditUrl"):Q.a.ntw(this.R6b.CopyAndEditUrl,pa)};d.prototype.reloadWorkbookInEditMode=function(){var cb=this;if(this.dc)if(xa.EwaSettings.isChangeGateEnabled("OfficeVSO:4585988_RefreshRibbonCookieOnModeRefresh")&&ea.a.qg.rV&&ea.a.qg.GGd(),F.AFrameworkApplication.Kgc&&!F.AFrameworkApplication.Dka)Ia.HelperMethods.Ze(this.$.Tob(!0),M.a.blank,void 0,"FileOperationCommandHandler.BuildHostUrl");
else{var Ua=this.$,pa=!1,Qa=this.hc.hasUnsupportedFeaturesForEdit,Db=this.workbookContext.FileWasRepaired;V.d(this.workbookContext.WorkbookFileName)?(pa=!0,D.ULS.sendTraceTag(537162634,0,50,"FileOperationsCommandHandler.ReloadWorkbookInEditMode: working on an XLS file, unsupported features = {0}",Qa)):V.a(this.workbookContext.WorkbookFileName)&&(pa=!0,D.ULS.sendTraceTag(537162633,0,50,"FileOperationsCommandHandler.ReloadWorkbookInEditMode: working on an CSV file"));var Kb=Ua.Jf.get(59);Kb=!(Ua.ea.hc.supportsEditing&&
Kb);if(pa&&!Qa||Kb&&(pa||Qa)){var Ab=Kb?Qa?-2066104278:816071846:xa.EwaSettings.isChangeGateEnabled("OfficeVSO:4035916_RemoveConvertInTeams")&&R.a(this.$.ya,25)&&!this.$.Uzb?765011943:-213064907;pa=function(){var ub=sa.a.LZa([Ab]);cb.clientWorkflow.fd.yt(ub);cb.clientWorkflow.fd.activityState[Cb.a.Oq]=vb.a.oeb}}else pa=function(){Ua.XH(!0,!1);var ub=cb.clientWorkflow.fd,Mb=ub.activityState;Mb[Wa.a.pT]=1;Mb[Ob.a.qYb]=J.a.Rkc;Mb[ec.a.As]=!0;Mb[ya.a.wYb]=cb.hc.hasUnsupportedFeaturesForEdit;Mb[Wa.a.tga]=
!!cb.workbookContext.EditUrl;Mb[yb.a.e2]=cb.workbookContext.EditUrl;if(!cb.R6b.CopyAndEditUrl){var Aa=[xa.EwaSettings.isChangeGateEnabled("OfficeVSO:4035912_RemoveEditACopyInTeams")&&R.a(cb.$.ya,25)&&!cb.$.Uzb?-943219229:1821390342];ub.yt(sa.a.laa(cb.businessBar.S6c,Aa))}Db&&!Qa?(V.b(cb.workbookContext.WorkbookFileName)&&xa.EwaSettings.isChangeGateEnabled("OfficeVSO:5693008_CGForFlightODFRepairEnabled")?(ub=sa.a.LZa([-425642652]),D.ULS.sendTraceTag(537162631,0,50,"FileOperationsCommandHandler.ReloadWorkbookInEditMode: working on an .ods file")):
ub=sa.a.LZa([108482388]),cb.clientWorkflow.fd.yt(ub),Mb[Cb.a.Oq]=vb.a.vUf):cb.$.ea.U5e?(D.ULS.sendTraceTag(546111811,0,50,"Password-To-Modify Workbook: User trying to switch to edit-mode."),kb.b().MSd("DialogShown","Password-To-Modify Workbook: Logging StopWatch duration after user tries to switch to exclusive edit-session","PasswordToModifyDialogShown"),Mb[Cb.a.Oq]=vb.a.GFb):Mb[Cb.a.Oq]=cb.$.ea.vgc?vb.a.uBb:vb.a.oeb};La.a(Ua).Zs(new zb.a(vb.a.Zy,5,pa))}};d.prototype.reloadWorkbookInViewMode=function(){var cb=
this;if(this.dc){xa.EwaSettings.isChangeGateEnabled("OfficeVSO:4585988_RefreshRibbonCookieOnModeRefresh")&&ea.a.qg.rV&&ea.a.qg.GGd();var Ua=this.$;H.a.rh&&ib.g(Ua).Wb.textBox.blur();La.a(Ua).Zs(new zb.a(vb.a.Zy,5,function(){Ua.XH(!Ua.ea.isNamedObjectViewMode,!1);var pa=cb.clientWorkflow.fd.activityState;pa[Cb.a.Oq]=vb.a.Cha;pa[Wa.a.pT]=1;pa[Wa.a.aY]=!0;pa[ec.a.As]=!1;pa[ec.a.wmb]=!0;pa[Ob.a.qYb]=J.a.Rkc}))}};d.prototype.reloadWorkbook=function(cb,Ua){var pa=this;if(this.dc){var Qa=this.$;Qa.mQ&65536&&
La.a(Qa).Zs(new zb.a(vb.a.Zy,5,function(){Qa.XH(cb,!0);var Db=pa.clientWorkflow.fd.activityState;Db[Cb.a.Oq]=vb.a.Ek;Db[ec.a.iTc]=pa.workbookContext.NovMode;Ua||(Db[Wa.a.pT]=1,Db[Wa.a.lYb]=new e)}))}};d.prototype.setCalculationMode=function(cb,Ua){function pa(){return new r(Ua)}var Qa=this;D.ULS.sendTraceTag(537162629,0,50,"SetCalculationMode ,calculation mode chosen : {0} ",Ua);var Db=this.$.ea.workbookContext.CalcMode;this.$.ea.workbookContext.CalcMode=Ua;return fa.a(this.$.userOperationManager,
function(Kb,Ab,ub){var Mb=Qa.$.oa.xa;Kb=ob.b(Kb,d.cRi(Qa.$,Db));Ab=ob.a(Ab,d.bRi(Qa.$,Db));var Aa=Mb.Na(9,null);Aa.calc_type=Ua;return wa.g(Mb,"SetCalculationOptions",Aa,Kb,Ab,ub,null,0)},function(Kb){return new ca.a(197,0,Kb,void 0,pa)},cb)};d.sye=function(cb){cb.ob&&0<cb.ob.nR&&cb.ob.p9c(function(Ua){Ua.It()})};d.cRi=function(cb,Ua){return function(pa){sa.a.Qg(pa.Errors)&&(cb.ea.workbookContext.CalcMode=Ua,D.ULS.sendTraceTag(537162628,0,50,"OnSetCalcModeSucess: successCallback was called with errors for SetCalculationMode. reverting calc mode to {0}.  Error id names: {1}",
Ua,sa.a.Ec(pa.Errors)))}};d.bRi=function(cb,Ua){return function(){cb.ea.workbookContext.CalcMode=Ua;D.ULS.sendTraceTag(537162627,0,50,"OnSetCalcModeFailure: failedCallback was called for SetCalculationMode. reverting calc mode to {0})",Ua)}};Mf.Object.defineProperties(d.prototype,{dc:{configurable:!0,enumerable:!0,get:function(){return this.$.ea.dc}},workbookContext:{configurable:!0,enumerable:!0,get:function(){return this.$.workbookContext}},R6b:{configurable:!0,enumerable:!0,get:function(){return this.$.workbookContext.FullDocumentInfo}},
clientWorkflow:{configurable:!0,enumerable:!0,get:function(){return ma.a(this.$)}},hc:{configurable:!0,enumerable:!0,get:function(){return this.$.hc}}});Object(u.a)(d,"FileOperationsCommandHandler",N.a,[429]);var Na=b(159),eb=A.a;Rk(c,eb);c.prototype.Ad=function(){var cb=this,Ua=this.$,pa=[],Qa=z.GetServiceTaskFactory.create(Ua.da,56,this.la,this.hb);pa.push(Qa);var Db=z.GetServiceTaskFactory.Ra(Ua.da,5,4,this.hb);pa.push(Db);x.TaskExtensions.Aa(ha.Task.oL.apply(ha.Task,ck(pa)),function(){Na.b(Qa)&&
cb.jd([new d(Ua,Qa.result,new B.a(function(){return z.GetServiceTaskFactory.create(Ua.da,137,cb.la,cb.hb)}),Db.result)])},this.la,0)};c.ka=function(cb){A.a.Qd(94,new c(cb))};Object(u.a)(c,"FileOperationsCommandHandlerFactory",A.a,[]);b.d(E,"a",function(){return a})},1370:function(u,E,b){function a(){m.a.Fa(function(kb){n.ka(kb);c.ka(kb)})}function c(kb){return Yb.call(this,kb)||this}function d(kb,vb){var Wa=this;this.YPi=function(qb,yb){if(!ta.a(qb)&&yb){var ec=!!qb&&!!qb.RequestTelemetryData;V.g(Wa.$).si.dla(yb,
qb.StateId,ec?qb.RequestTelemetryData.EcsOperationDuration:0,ec?qb.RequestTelemetryData.EcsRequestDuration:0,ec?qb.RequestTelemetryData.WfeRequestDuration:0)}};this.sHi=function(qb,yb){yb&&yb.d0b&&yb.d0b.SheetName&&yb.d0b.Ranges.length&&yb.mfi&&wa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.IntelligentMetadataTableProactiveSuggestions",!1)&&(qb=Fb.d(Wa.$.va.pa),Wa.xZg(new La.a(ka.B(yb.d0b.Ranges[0]),qb)))};this.$=kb;this.Fg=vb}function e(kb,vb){var Wa=ob.call(this,kb)||this;Wa.mvb=function(qb){qb=
Wa.Wdd(qb);return Wa.rbd(qb)};Wa.Qfj=function(qb,yb){var ec=Wa.$zb=yb[e.Yfi];1===qb?(qb=yb[e.nBj],ec=Wa.x2e(qb,ec),B.ULS.shipAssertTag(537153996,0,ec!==e.mba,"ResizeHeadersDialogHandler - invalid size input, size = {0}",qb),qb=ec!==Wa.xkd,B.ULS.sendTraceTag(537153995,0,50,"ResizeHeadersDialog OK button pressed, isRow = {0}, isDefaultUnits = {1}, inputPx = {2}, inputChanged = {3}.",Wa.isRow,Wa.$zb,ec,qb),qb&&Wa.V3g(ec)):B.ULS.sendTraceTag(537153994,0,50,"ResizeHeadersDialog Cancel button pressed, isRow = {0}.",
Wa.isRow)};Wa.isRow=2040891415===vb.command;Wa.gridView=V.g(Wa.$);Wa.itc=new v(Wa.$.workbookContext.DxDigitNormal);Wa.xkd=Wa.bTg();kb=Wa.G2g(Wa.xkd);vb=Wa.I2g(Wa.xkd);Wa.zl=ja.a.instance.ga(Wa.isRow?480:481);kb=Wa.BM(kb,vb);Wa.initializeAndShow(Wa.zl,Wa.Qfj,kb);B.ULS.sendTraceTag(537153997,0,50,"ResizeHeaders React Dialog opened, isRow = {0}.",Wa.isRow);return Wa}function k(kb){this.resizeParameters=null;this.resizeParameters=kb}function l(kb,vb){this.isRow=!1;this.autoFitRange=null;this.isRow=kb;
this.autoFitRange=vb}function n(){var kb=ra.call(this)||this;kb.Eb();return kb}function f(kb,vb){var Wa=oa.call(this,vb.domElement)||this;Wa.qSf=!1;Wa.HX=!1;Wa.lSa=null;Wa.p7a=null;Wa.mj=null;Wa.UJd=!0;Wa.whc=!1;Wa.offset=0;Wa.Vk=0;Wa.sJb=0;Wa.F0=null;Wa.BW=null;Wa.IM=null;Wa.d5h="headerResizeTooltip";Wa.xtd=null;Wa.ZF=null;Wa.Kza=!1;Wa.P8=!1;Wa.VWc=!1;Wa.X9a=U.a.cwa;Wa.eEf=U.a.cwa;Wa.raf=wa.EwaSettings.isChangeGateEnabled("OfficeVSO:6649809_AutoFitHiddenRowCol");Wa.zCc=!1;Wa.pN=function(qb){if(Wa.grid.Pj)return!1;
qb=ba.a(Wa.grid.$).Rd(qb);if(3===qb.lb&&!Wa.Kgf(qb.Ca)||!Wa.ZGf(qb,!1))return!1;B.ULS.sendTraceTag(537154058,2,50,"HeaderResizeBehavior.OnMouseDown: About to generate tooltip");var yb=Wa.nxc();Wa.ybd(qb.clientPoint,yb,!0);Wa.Kza||(A.a.instance.ra(z.a.Rj,Wa.domElement.ownerDocument.body,Wa.e9a),x.a.instance.ra(z.a.lg,Wa.domElement.ownerDocument.body,Wa.e9a),Wa.Kza=!0);Wa.Ecf()&&Wa.HX&&Wa.n8e(qb);return!1};Wa.bEb=function(qb){qb=ba.a(Wa.grid.$).Rd(qb);Wa.Ecf()&&Wa.VWc&&Wa.n8e(qb);if(wa.EwaSettings.isChangeGateEnabled("OfficeVSO:6093232_ResizeRowColUsingTouch")){if(!qb.Ca.type.includes("touch")&&
qb.Ca.button!==Sys.UI.MouseButton.leftButton||!Wa.y6a)return!1}else if(qb.Ca.button!==Sys.UI.MouseButton.leftButton||!Wa.y6a)return!1;ea.g(qb.Ca);Wa.iKe();qb=Wa.grid.Pj?Wa.X9a:U.a.cwa;if(Wa.grid.Pj&&Wa.mj)var yb=qb!==Wa.Vk||!Wa.raf&&Wa.P8;else Wa.mj&&(qb=Wa.P8?Wa.Scd():Wa.mj.a4()),yb=qb!==Wa.Vk;if(Wa.lSa&&yb&&qb!==U.a.cwa){qb=Wa.grid;yb=Wa.ifd(qb);var ec={};ec.SheetMultiRange=ka.r(yb,qb.$);f.kOd(ec,Wa.isRow,Wa.Vk);Wa.rkh(ec);qb.xGj=!0}else Wa.ug(null,null),Wa.IHb();Wa.P8=!1;return Wa.zCc=!1};Wa.oca=
function(qb){if(Wa.grid.Pj)return!1;qb=D.a.create(qb.eventName,qb.zb,qb.Ca,qb.lb);qb=ba.a(Wa.grid.$).Rd(qb);if(!Wa.ZGf(qb,!0))return!1;qb=Wa.grid;var yb=Wa.ifd(qb);yb=ka.r(yb,qb.$);qb.qb.eh([Wa.isRow?13:14]);qb.qb.ORa();Wa.IHb();var ec={};qb.$.Fd(Wa.isRow?146338636:1391094586,Q.a.Cb,30,(ec.autoFitRanges=yb,ec));return!1};Wa.$wf=function(qb){Wa.HX?(Wa.P8&&!Wa.zCc&&Wa.MAg(),Wa.whc||Wa.F9e(),qb=new Sys.UI.DomEvent(qb),qb=D.a.create(z.a.gha,Wa.domElement,qb,2),qb=ba.a(Wa.grid.$).Rd(qb),Wa.axf(qb.clientPoint,
void 0)):B.ULS.sendTraceTag(521480320,2,50,"HeaderResizeBehavior.onHeaderResizeChanged: Reached during no resize mode. cellAbsoluteIndex = "+(Wa.mj?Wa.mj.Iie:-1)+", isRow = "+Wa.isRow)};Wa.bxf=function(qb){qb=new Sys.UI.DomEvent(qb);qb=D.a.create(z.a.gha,Wa.domElement,qb,2);Wa.bEb(qb)};Wa.fMi=function(qb){Wa.kya(qb,Wa.mj,!1)};Wa.e9a=function(qb){qb=ba.a(Wa.grid.$).Rd(qb);wa.EwaSettings.isChangeGateEnabled("OfficeVSO:6195348_StopBubblingOnDocumentMouseMoveInnerEvent")&&ea.g(qb.Ca);return Wa.axf(qb.clientPoint,
qb.Ca)};Wa.UH=function(qb){if(Wa.grid.Pj)return!1;qb=ba.a(Wa.grid.$).Rd(qb);var yb;if(!Wa.gff||-1!==Wa.grid.ha.selectionType)return aa.a(Wa.grid.$).Kp()&&(yb=Wa.Hdd(qb))&&(yb.Dva.style.cursor=""),!1;if(Wa.HX)return Wa.F9e(),!1;yb=Wa.Hdd(qb);if(!yb)return!1;yb.Dva.style.cursor=!Wa.grid.isEditing&&Wa.Iqd(yb)?Wa.isRow?"row-resize":"col-resize":"";ea.g(qb.Ca);return!0};Wa.ep=function(){Wa.IHb()};Wa.ug=function(){if((3===Q.a.Cb||I.a.Wo)&&Wa.grid.ha.sa.sg){var qb=Wa.grid.ha.sa.Vc;if(!(!qb.isRow&&!qb.Te||
!Wa.domElement||qb.isRow&&Wa.isRow&&!Array.contains(Wa.Fe.Fn,qb.top)||qb.Te&&!Wa.isRow&&!Array.contains(Wa.Fe.Fn,qb.left))){var yb=Wa.grid.fg(qb,Wa.Fe.lj.paneType);if(yb){if(Wa.grid.Pj){var ec=Wa.isRow?qb.bottom:qb.right;Wa.mj=Wa.Fe.Kr(C.Range.Tc(qb.bottom,qb.right));if(!Wa.mj){B.ULS.sendTraceTag(522826880,2,50,"HeaderResizeBehavior.onSelectionEnded: Cell being resized is undefined. Couldn't create touch resizer. Absolute index "+ec+", is row "+Wa.isRow);return}}Wa.ZF||Wa.o$g();qb.isRow&&Wa.isRow?
(ca.DOMElementExtensions.setVisible(Wa.ZF,!0),Wa.ZF.style.top=yb.bottomRight.y-Wa.ZF.offsetHeight/2+"px"):qb.isRow||Wa.isRow||(ca.DOMElementExtensions.setVisible(Wa.ZF,!0),va.c(Wa.ZF.style,Wa.grid.rtl,yb.bottomRight.x-Wa.ZF.offsetWidth/2+"px"))}}}};Wa.oF=function(qb,yb){wa.EwaSettings.isChangeGateEnabled("OfficeVSO:6385697_HeaderResize_LogOnPartialInteractivityStatusChanged")&&B.ULS.sendTraceTag(521787422,2,50,"HeaderResizeBehavior.onPartialInteractivityStatusChanged: was called. isActivated "+yb.JL);
yb.JL&&Wa.upb()};Wa.Fe=vb;Wa.isRow=vb.isRow;Wa.rtl=vb.lj.rtl;Wa.grid=kb;Wa.eof=Wa.isRow?U.a.cvd:U.a.vkc;Wa.$4h=ja.a.instance.ga(439);Wa.i5h=ja.a.instance.ga(438);Wa.c5h=ja.a.instance.ga(440);ua.a(Wa.grid.$,function(qb){Wa.xtd=qb.OP(P.a.Yfj,!1)});Wa.o7i();Wa.grid.ha.lP(Wa.ug);Wa.grid.ha.s2(Wa.ep);Wa.grid.yu(Wa.ug);aa.a(Wa.grid.$).Rf.G9(Wa.oF);return Wa}function v(kb){this.t6c=kb}function r(kb,vb,Wa,qb,yb,ec,Ob){this.Dva=kb;this.ICb=vb;this.YNa=Wa;this.jid=qb;this.vbb=yb;this.Jgf=ec;this.g4h=Ob}function y(){}
var m=b(10);u=b(0);var w=b(232),B=b(14),A=b(245),z=b(13),x=b(161),D=b(728),I=b(27),F=b(233),G=b(4),T=b(276),O=b(94),U=b(8),J=b(30);y.Jqh="ewa-resizehdr-row-hidden";y.Iqh="ewa-resizehdr-col-hidden";Object(u.a)(y,"CssClassNames",null,[]);var H=b(19),K=b(65),N=b(60),M=b(5),C=b(24),Q=b(76),P=b(133),ka=b(45),R=b(151),fa=b(53),ca=b(12),ea=b(69),wa=b(1),X=b(11),ja=b(15),va=b(259),ua=b(134),Xa=b(390),aa=b(42);Object(u.a)(r,"HeaderEventCachedInfo",null,[]);v.prototype.cBe=function(kb){kb=X.HelperMethods.HCd(kb);
return Math.max(0,Math.min(v.tof,kb))};v.prototype.UAe=function(kb){return this.TXi(kb)};v.prototype.yZg=function(kb){return Math.round(this.t6c*kb+2*this.DXe()+1)};v.prototype.TXi=function(kb){return Math.max(0,Math.min(v.bof,(Math.max(0,Math.min(U.a.vkc,kb))-2*this.DXe()-1)/this.t6c))};v.prototype.DXe=function(){return Math.floor(Math.max((this.t6c+3)/4,2))};v.prototype.kbc=function(kb,vb){return vb?kb?v.tof:U.a.cvd:kb?v.bof:U.a.vkc};v.tof=409;v.bof=255;Object(u.a)(v,"ResizeHeadersConverter",null,
[]);var ba=b(33),oa=O.a;Rk(f,oa);f.prototype.kya=function(kb,vb,Wa){kb=new Sys.UI.DomEvent(kb);kb=D.a.create(z.a.gha,this.domElement,kb,2);kb=ba.a(this.grid.$).Rd(kb);this.YGf(vb,kb.clientPoint.x,kb.clientPoint.y,!1,Wa);vb=this.nxc();this.ybd(this.lSa,vb,!0);this.Kza||(vb=this.domElement.ownerDocument.body,vb.addEventListener(z.a.gha,this.$wf),vb.addEventListener(z.a.qGa,this.bxf),this.Kza=!0)};f.prototype.dMi=function(kb,vb,Wa){this.YGf(vb,kb.clientX,kb.clientY,!0,this.raf?Wa:!1);kb=this.grid;vb=
this.ifd(kb);vb=ka.r(vb,kb.$);kb.qb.eh([this.isRow?13:14]);kb.qb.ORa();this.IHb();Wa={};kb.$.Fd(this.isRow?146338636:1391094586,Q.a.Cb,30,(Wa.autoFitRanges=vb,Wa))};f.prototype.dispose=function(){this.K_c();this.grid.ha&&(this.grid.ha.sW(this.ug),this.grid.ha.S6(this.ep));this.grid.jy(this.ug);aa.a(this.grid.$)&&aa.a(this.grid.$).Rf.fda(this.oF);F.a.instance.Ba(z.a.$j,this.domElement,this.oca);A.a.instance.Ba(z.a.Df,this.domElement.ownerDocument.body,this.bEb);x.a.instance.Ba(z.a.pe,this.domElement.ownerDocument.body,
this.bEb);I.a.Wo||(A.a.instance.Ba(z.a.pointerDown,this.domElement,this.pN),A.a.instance.Ba(z.a.Rj,this.domElement,this.UH));this.Kza&&(A.a.instance.Ba(z.a.Rj,this.domElement.ownerDocument.body,this.e9a),x.a.instance.Ba(z.a.lg,this.domElement.ownerDocument.body,this.e9a),this.Kza=!1);this.ZF&&(A.a.instance.Ba(z.a.pointerDown,this.ZF,this.pN),F.a.instance.Ba(z.a.$j,this.ZF,this.oca),this.K_c(),this.ZF=null);this.qSf&&(ca.DOMElementExtensions.ff(f.wbb),f.wbb=null);this.Fe=null;oa.prototype.dispose.call(this)};
f.prototype.o7i=function(){F.a.instance.ra(z.a.$j,this.domElement,this.oca);A.a.instance.ra(z.a.Df,this.domElement.ownerDocument.body,this.bEb);x.a.instance.ra(z.a.pe,this.domElement.ownerDocument.body,this.bEb);I.a.Wo||(A.a.instance.ra(z.a.pointerDown,this.domElement,this.pN),A.a.instance.ra(z.a.Rj,this.domElement,this.UH))};f.prototype.Zkh=function(){if(!f.wbb){document.getElementById(f.pSf);this.qSf=!0;var kb=f.wbb=document.createElement("div");this.grid.$.frame.Haa().appendChild(kb);kb.id=f.pSf;
kb.className=J.a.Kqh;ca.DOMElementExtensions.setVisible(kb,!1)}};f.prototype.iKe=function(){if(this.Kza){var kb=this.domElement.ownerDocument.body;this.grid.Pj?(kb.removeEventListener(z.a.gha,this.$wf),kb.removeEventListener(z.a.qGa,this.bxf)):(A.a.instance.Ba(z.a.Rj,kb,this.e9a),x.a.instance.Ba(z.a.lg,kb,this.e9a));this.Kza=!1}this.HX=!1;wa.EwaSettings.isChangeGateEnabled("OfficeVSO:6443346_removeResizeArtifacts")?this.vOf():(this.SSf(),this.RHd());Xa.c(this.grid.$,!0,"HeaderResizeBehavior:PrepareResizeOperation")};
f.prototype.SSf=function(){this.grid.qb.eh([this.isRow?13:14]);this.grid.qb.ORa()};f.prototype.MAg=function(){this.Fe.addRowColToModel(this.mj.Iie-1,this.mj.R8i);this.zCc=!0};f.prototype.axf=function(kb,vb){if(!this.HX)return!1;this.grid.Pj||wa.EwaSettings.isChangeGateEnabled("OfficeVSO:6195348_StopBubblingOnDocumentMouseMoveInnerEvent")||ea.g(vb);vb=this.isRow;if(!this.grid.Pj&&!this.F0){this.F0=document.createElement("div");this.F0.style.cssText="position: relative; width: inherit; height: inherit;"+
(vb?"top: 0px; ":this.rtl?"right: 0px:":"left: 0px:");for(var Wa=this.mj.NJ();Wa.nextSibling;)this.F0.appendChild(Wa.nextSibling);Wa.parentNode.appendChild(this.F0)}Wa=vb?kb.y-this.p7a.y:(this.rtl?-1:1)*(kb.x-this.p7a.x);var qb=vb?kb.y-this.lSa.y:(this.rtl?-1:1)*(kb.x-this.lSa.x),yb=this.grid.Pj?this.X9a:this.mj.a4();if(yb===U.a.cwa)return!1;Wa&&(0<this.Vk||0<yb+qb)&&yb+qb<=this.eof&&(this.Vk=this.nxc(qb),this.ybd(kb,this.Vk,!1),this.grid.Pj?this.Vk>=f.p6e?(this.UJd=!0,this.mj.setCellExtent(this.Vk)):
this.UJd&&(this.UJd=!1,this.mj.setCellExtent(f.p6e)):(ca.DOMElementExtensions.voa(this.mj.NJ(),!vb,Math.max(this.sJb+qb,0)),this.F0.style[vb?"top":this.rtl?"right":"left"]=Math.max(qb,-this.sJb)+"px"),Wa=(this.grid.Pj?this.eEf:vb?this.mj.Fe.YD:this.mj.Fe.ZD)+Math.max(qb,this.grid.Pj?-this.X9a+f.Ccc:-this.sJb),ca.DOMElementExtensions.voa(this.mj.Fe.domElement,!vb,Wa),this.grid.Pj&&this.mj.Fe.Znj(Wa),this.p7a=new Sys.UI.Point(kb.x,kb.y),ca.DOMElementExtensions.setVisible(this.ZF,!1));return!0};f.prototype.a4=
function(){return this.mj?this.P8?f.q5h:this.mj.a4():U.a.cwa};f.prototype.ybd=function(kb,vb,Wa){this.IM&&Wa&&(B.ULS.sendTraceTag(537154051,2,15,"HeaderResizeBehavior.GenerateResizeTooltip: headerResizeTooltipElement already created, creating a new element instead"),this.RHd());this.IM||Wa||B.ULS.sendTraceTag(537154050,2,15,"HeaderResizeBehavior.GenerateResizeTooltip: headerResizeTooltipElement is null, creating a new element instead");this.xtd&&this.xtd(function(){var qb={};return qb.Location="canvas",
qb});this.IM?this.$Ue(vb):(this.IM=document.createElement("div"),this.IM.id=this.d5h,this.$Ue(vb),this.IM.className=J.a.dph,vb=document.getElementById(this.grid.$.yb+M.a.Tpf),vb.insertBefore(this.IM,vb.firstChild),kb=ba.a(this.grid.$).rja(kb),this.IM.style.left=(this.rtl?Math.max(kb.x-this.IM.offsetWidth,0):kb.x-Math.max(kb.x+this.IM.offsetWidth-vb.offsetWidth,0)).toString()+"px",vb=document.getElementById(M.a.$Fa),this.IM.style.top=(kb.y-(G.AFrameworkApplication.ta&&G.AFrameworkApplication.ta.Qa.Of?
0:vb.offsetHeight)-this.IM.offsetHeight).toString()+"px")};f.prototype.RHd=function(){ca.DOMElementExtensions.ff(this.IM);this.IM=null};f.prototype.$Ue=function(kb){var vb=new v(this.grid.$.workbookContext.DxDigitNormal);vb=this.isRow?vb.cBe(kb).toFixed(2):vb.UAe(kb).toFixed(2);this.IM.innerText=String.format("{0} {1} ({2} {3})",this.isRow?this.$4h:this.i5h,vb,kb.toString(),this.c5h)};f.prototype.ZGf=function(kb,vb){var Wa;if(-1!==this.grid.ha.selectionType||2===kb.lb&&kb.Ca.button!==Sys.UI.MouseButton.leftButton||
!this.Iqd(Wa=this.Hdd(kb))||!this.gff)return!1;ea.g(kb.Ca);this.lSa=this.p7a=new Sys.UI.Point(kb.clientPoint.x,kb.clientPoint.y);this.BSg(Wa,vb);if(!this.mj)return!1;this.HX=!0;this.cli(this.mj,Wa)&&this.f9h();this.sJb=this.Scd();return this.$Gf(vb)};f.prototype.YGf=function(kb,vb,Wa,qb,yb){this.HX=!0;this.P8=yb;this.mj=kb;this.whc=!1;this.lSa=this.p7a=new Sys.UI.Point(vb,Wa);kb=this.mj.getRange();this.BW=yb?this.Wne(kb):kb;this.X9a=this.a4();this.eEf=this.isRow?this.mj.Fe.YD:this.mj.Fe.ZD;this.$Gf(qb)};
f.prototype.$Gf=function(kb){var vb={};ua.b(this.grid.$).yd(P.a.Pfj,(vb.IsResizingHiddenHeader=this.P8,vb.IsAutoFitting=kb,vb.NumberOfSelectedRanges=this.grid.ha.sa.qK,vb.Location="canvas",vb));this.offset=this.mj.Raa();this.Vk=this.grid.Pj?this.X9a:this.mj.a4();if(this.Vk===U.a.cwa)return!1;Xa.c(this.grid.$,!1,"HeaderResizeBehavior:prepareResizeOperationInternal");return!0};f.prototype.cli=function(kb,vb){var Wa=this.mj.NJ();if(!Wa)return B.ULS.shipAssertTag(537154049,2,!1,"cell being resized element received is null"),
!1;Wa=Wa.nextSibling;if(!Wa)return!1;kb=kb.getRange();Wa=this.Fe.Lua(Wa).getRange();if(!kb||!Wa)return B.ULS.shipAssertTag(537154048,2,!1,"IsResizingHidden: range is null"),!1;var qb=wa.EwaSettings.isChangeGateEnabled("OfficeVSO:6101474_EnableUnhideRowByMouseDrag");kb=qb&&this.isRow?kb.bottom:kb.right;Wa=qb&&this.isRow?Wa.bottom:Wa.right;return kb+1!==Wa&&kb!==Wa&&this.Iqd(vb,!0)};f.prototype.f9h=function(){var kb=this.mj.NJ(),vb=this.Fe.Lua(kb.nextSibling);f.dli(vb,this.isRow)?(this.mj=vb,this.BW=
this.mj.getRange()):(this.NAg(kb),this.mj=vb,kb=this.mj.getRange(),this.BW=this.Wne(kb),this.P8=!0)};f.prototype.Wne=function(kb){return this.isRow?new C.Range(kb.top-1,kb.left,kb.top-1,kb.right,!1,!0):new C.Range(kb.top,kb.left-1,kb.bottom,kb.left-1,!1,!0)};f.prototype.NAg=function(kb){var vb=this.Fe.Lua(kb.nextSibling),Wa=f.s6g(vb,this.isRow,this.rtl);Wa&&kb.parentNode.insertBefore(Wa,vb.NJ())};f.prototype.ifd=function(kb){var vb=this.BW,Wa=kb.ha.sa.selectedRanges;if(kb.ha.sa.msb(vb))if(this.isRow){if(T.a.all(Wa,
function(qb){return qb.isRow}))return Wa}else if(T.a.all(Wa,function(qb){return qb.Te}))return Wa;return[vb]};f.prototype.getCellExtent=function(){return this.mj.getCellExtent()};f.prototype.Scd=function(){var kb=this.mj.NJ().style;return Math.max(0,Math.min(this.eof,0|parseInt(this.isRow?kb.height:kb.width,10)))};f.prototype.nxc=function(kb){kb=void 0===kb?0:kb;var vb=this.grid,Wa=this.Fe.lj.paneType;Wa=this.isRow?3===Wa?[3,2]:[1,4]:4===Wa?[2,4]:[1,3];var qb=vb.view.visibleArea.bottomRight,yb=Math.max(this.grid.Pj?
this.X9a:this.mj.a4(),0);kb=this.P8&&!this.grid.Pj?Math.max(this.Scd(),0):Math.max(yb+kb,0);qb=this.isRow?new N.a(0,this.offset,qb.x,kb):new N.a(this.offset,0,kb,qb.y);yb=[this.isRow?13:14];vb.qb.Ti(C.Range.Tc(1,1),yb,!1);vb.qb.qn(yb,qb,Wa);return kb};f.prototype.K_c=function(){this.BW=this.lSa=this.p7a=null;if(this.F0){var kb=this.F0.parentNode;if(kb)for(kb.removeChild(this.F0);this.F0.firstChild;)kb.appendChild(this.F0.firstChild);this.F0=null}this.mj=null;this.HX=!1;wa.EwaSettings.isChangeGateEnabled("OfficeVSO:6443346_removeResizeArtifacts")||
this.vOf()};f.prototype.vOf=function(){this.whc=!1;this.RHd();ca.DOMElementExtensions.setVisible(f.wbb,!1);ca.DOMElementExtensions.setVisible(this.ZF,!1);wa.EwaSettings.isChangeGateEnabled("OfficeVSO:6443346_removeResizeArtifacts")&&this.SSf()};f.prototype.Hdd=function(kb){if(ca.DOMElementExtensions.hz(kb.zb,"a"))return null;var vb=this.Kgf(kb.Ca);if(vb&&this.grid.ha.sa.sg){var Wa=this.grid.ha.sa.Vc;Wa=this.Fe.Kr(C.Range.Tc(Wa.bottom,Wa.right))}else Wa=this.Fe.Lua(kb.zb);if(!Wa)return null;var qb=
Wa.NJ(),yb=new Sys.UI.Bounds(qb.offsetLeft,qb.offsetTop,qb.offsetWidth,qb.offsetHeight),ec=ca.DOMElementExtensions.getBoundingClientRect(kb.zb);ec=new Sys.UI.Point(kb.clientPoint.x-ec.x,kb.clientPoint.y-ec.y);this.isRow&&!vb&&(ec.y+=X.HelperMethods.zC(kb.zb,qb,this.rtl).y);return new r(qb,ec,yb,Wa.getRange(),Math.max(f.Yzi,Math.min(f.Uyi,(this.isRow?yb.height:yb.width)*f.Zfj)),vb,!this.isRow&&0<qb.getElementsByTagName("input").length)};f.prototype.Iqd=function(kb,vb){vb=void 0===vb?!1:vb;if(!kb||
this.grid.isEditing)return!1;if(kb.Jgf)return!0;var Wa=kb.YNa,qb=kb.vbb,yb=this.Fe.lj.paneType,ec=this.grid.Cf(yb).Ug,Ob=!!ec&&ec.top===kb.jid.top,Cb=!!ec&&ec.left===kb.jid.left;yb=!!ec&&ec.bottom===kb.jid.bottom&&(3===yb||2===yb);this.isRow?(Cb=kb.ICb.y,kb=Cb<=qb&&!Ob,Wa=Cb>=Wa.height-qb-(yb?f.xDh:0),vb=vb?kb:Wa||kb):(yb=kb.g4h,Ob=this.rtl,ec=kb.ICb.x,kb=ec<=qb&&(!Cb||Ob)&&(!yb||!Ob),Wa=ec>=Wa.width-qb&&(!Ob||!Cb)&&(!yb||Ob),vb=vb?Ob?Wa:kb:kb||Wa);return vb};f.prototype.BSg=function(kb,vb){var Wa=
this.isRow;if(kb.Jgf)this.mj=this.Fe.Lua(kb.Dva);else if(Wa&&kb.ICb.y<=kb.vbb&&kb.YNa.height>kb.vbb||!Wa&&kb.YNa.width>kb.vbb&&(!this.rtl&&kb.ICb.x<=kb.vbb||this.rtl&&kb.ICb.x>=kb.YNa.width-kb.vbb)){if(this.mj=kb.Dva.previousSibling?this.Fe.Lua(kb.Dva.previousSibling):this.rQh(),vb&&kb.Dva.classList.contains(Wa?J.a.RPe:J.a.QPe)&&(kb=this.Fe.Lua(kb.Dva)))kb=kb.getRange(),this.BW=Wa?new C.Range(kb.top-1,kb.left,kb.top-1,kb.right,!1,!0):new C.Range(kb.top,kb.left-1,kb.bottom,kb.left-1,!1,!0)}else this.mj=
this.Fe.Lua(kb.Dva);!this.BW&&this.mj&&(this.BW=this.mj.getRange())};f.prototype.rQh=function(){var kb=this.isRow?1:0;return(kb=this.Fe.lj.cG(this.Fe.lj.Ea.Gg(this.grid.$.pa,K.a.hM(this.Fe.position.X+kb-1,this.Fe.position.Y-kb,this.Fe.position.PaneType))))?kb.qQh():null};f.prototype.F9e=function(){this.whc=!0;var kb=this.$fj;ca.DOMElementExtensions.setVisible(kb,!0);kb.style.cursor=this.isRow?J.a.ZMe:J.a.KLe;this.nxc()};f.prototype.rkh=function(kb){var vb={};this.grid.$.Fd(this.isRow?745189930:-445963340,
Q.a.Cb,30,(vb.resizeRowColumnParameters=kb,vb))};f.prototype.o$g=function(){var kb=document.createElement("div");kb.className=J.a.Irh;var vb=document.createElement("div");vb.className=H.a.IA;kb.appendChild(vb);var Wa=document.createElement("img");Wa.src=fa.a.Se(0);Wa.className=this.isRow?H.a.Hqh:H.a.Cqh;vb.appendChild(Wa);this.Fe.wA.domElement.parentNode.insertBefore(kb,this.Fe.wA.domElement);this.grid.Pj?kb.addEventListener(z.a.fha,this.fMi):(A.a.instance.ra(z.a.pointerDown,kb,this.pN),F.a.instance.ra(z.a.$j,
kb,this.oca));ca.DOMElementExtensions.setVisible(kb,!1);this.ZF=kb};f.prototype.IHb=function(){this.K_c();this.ZF&&(this.Fe.wA.domElement.parentNode.removeChild(this.ZF),this.ZF=null)};f.prototype.Kgf=function(kb){return ca.DOMElementExtensions.nf(this.ZF,kb.target)};f.prototype.upb=function(){this.HX&&(this.iKe(),ca.DOMElementExtensions.voa(this.mj.NJ(),!this.isRow,this.sJb),this.IHb(),this.zCc=this.P8=!1)};f.prototype.Ecf=function(){return wa.EwaSettings.ma(680)};f.prototype.n8e=function(kb){(kb=
kb.Ca.rawEvent)&&kb.detail===f.Hkj&&(kb.type===z.a.Pp?(this.HX=!1,this.VWc=!0):kb.type===z.a.NH&&(this.HX=!0,this.VWc=!1))};f.o6g=function(kb,vb){return new f(kb,vb)};f.kOd=function(kb,vb,Wa){if(vb)for(kb.ColumnWidth=-1,kb.RowHeight=Wa,kb=bk(kb.SheetMultiRange.Ranges),vb=kb.next();!vb.done;vb=kb.next())vb=vb.value,vb.FirstColumn=0,vb.LastColumn=0;else for(kb.RowHeight=-1,kb.ColumnWidth=Wa,kb=bk(kb.SheetMultiRange.Ranges),vb=kb.next();!vb.done;vb=kb.next())vb=vb.value,vb.FirstRow=0,vb.LastRow=0};f.dli=
function(kb,vb){if(!kb||!kb.NJ())return B.ULS.shipAssertTag(537154014,2,!1,"header after hidden headers is null"),!1;var Wa=kb.getRange();kb=kb.NJ().style;if(!Wa||!kb)return B.ULS.shipAssertTag(537154013,2,!1,"header range or style is null"),!1;kb=vb?kb.height:kb.width;return(vb?Wa.top:Wa.left)===(vb?U.a.sh:U.a.Bh)&&kb===f.fgg};f.s6g=function(kb,vb,Wa){if(!kb)return B.ULS.shipAssertTag(537154012,2,!1,"header after hidden is null"),null;var qb=kb.NJ();if(!qb||!qb.style)return B.ULS.shipAssertTag(537154011,
2,!1,"header after hidden element or style is null"),null;kb=document.createElement("div");var yb=qb.style;kb.style.top=vb?yb.top:f.fgg;vb||(Wa?kb.style.right=yb.right:kb.style.left=yb.left);kb.classList.add(vb?y.Jqh:y.Iqh);kb.classList.add(vb?J.a.ntb:J.a.mtb);Wa=document.createElement("div");Wa.classList.add(vb?J.a.DPe:J.a.b9c);qb=vb?Number.parseInvariant(qb.innerText):C.Range.M_a(qb.innerText);Wa.innerText=vb?(qb-1).toString():C.Range.GP(qb-1);kb.appendChild(Wa);return kb};Mf.Object.defineProperties(f.prototype,
{y6a:{configurable:!0,enumerable:!0,get:function(){return this.HX}},gff:{configurable:!0,enumerable:!0,get:function(){var kb=(new R.a(this.grid.$.va)).Ud(this.isRow?16:8),vb=this.grid.$.ob.mz,Wa=this.grid.ui,qb=aa.a(this.grid.$).Kp();return kb&&!vb&&!Wa&&!qb}},$fj:{configurable:!0,enumerable:!0,get:function(){this.Zkh();return f.wbb}}});f.Yzi=0;f.Uyi=5;f.Ccc=1;f.p6e=1;f.q5h=0;f.xDh=3;f.Zfj=.1;f.pSf="ewa-rszrbg";f.fgg="0px";f.Hkj=2;f.wbb=null;Object(u.a)(f,"HeaderResizeBehavior",O.a,[752]);var ra=
w.a;Rk(n,ra);n.prototype.create=function(){this.pb(f.o6g)};n.ka=function(kb){kb.da.Ga(136,new n)};Object(u.a)(n,"HeaderResizeBehaviorFactory",w.a,[]);var db=b(905),Ka=b(51),Ga=b(37),xa=b(178),da=b(447),qa=b(564),na=b(388),ia=b(177),ta=b(295),za=b(294),sa=b(74),V=b(21);Object(u.a)(l,"MacroRecorderSheetRowsColumnsAutoFitPayload",null,[438]);Object(u.a)(k,"MacroRecorderSheetRowsColumnsResizedPayload",null,[438]);var Ia=b(85);w=b(389);var Ha=b(22),ob=w.a;Rk(e,ob);e.prototype.BM=function(kb,vb){var Wa=
{};return Wa[e.z4]=this.nc,Wa[e.qli]=this.isRow,Wa[e.C9h]=kb,Wa[e.B9h]=vb,Wa[e.hii]=this.$zb,Wa[e.Vdd]=this.mvb,Wa};e.prototype.bTg=function(){var kb=this.KGh();try{return this.qLh(kb)}finally{kb&&kb.dispose()}};e.prototype.V3g=function(kb){var vb={};vb.SheetMultiRange=ka.r(this.gridView.ha.sa.selectedRanges,this.$);e.kOd(vb,this.isRow,kb);kb={};this.$.Fd(this.isRow?745189930:-445963340,Q.a.Cb,8,(kb.resizeRowColumnParameters=vb,kb))};e.prototype.x2e=function(kb,vb){return Ha.a.b5(kb)?vb?this.F2g(kb):
this.H2g(kb):e.mba};e.prototype.H2g=function(kb){return Math.floor(parseFloat(kb))};e.prototype.F2g=function(kb){kb=parseFloat(kb);return 0>kb?e.mba:kb?this.isRow?X.HelperMethods.aYi(kb):this.itc.yZg(kb):0};e.prototype.I2g=function(kb){return kb===e.mba?"":this.isRow?this.itc.cBe(kb).toString():this.itc.UAe(kb).toFixed(2)};e.prototype.G2g=function(kb){return kb===e.mba?"":kb.toString()};e.prototype.qLh=function(kb){if(!kb||!kb.$$mn()||!kb.yn)return e.mba;var vb=Object(Ia.a)(710,kb.yn);if(!vb)return e.mba;
for(vb=this.isRow?vb.Pxb:vb.vkd;kb.$$mn();){var Wa=Object(Ia.a)(710,kb.yn);if(Wa&&(this.isRow?Wa.Pxb:Wa.vkd)!==vb)return e.mba}return vb};e.prototype.KGh=function(){for(var kb=[],vb=bk(this.gridView.ha.sa.selectedRanges),Wa=vb.next();!Wa.done;Wa=vb.next()){Wa=Wa.value.clone();var qb=this.gridView.Cf(this.gridView.eb.dj(Wa));qb=Wa.ze(qb.Ug);if(!qb)return null;this.isRow?Wa.right=Wa.left=qb.left:Wa.top=Wa.bottom=qb.top;kb.push(Wa)}return kb.length?this.gridView.K$("ResizeHeadersDialog.GetActiveRowColumnLoadedRangeEnumerator",
kb):null};e.prototype.Wdd=function(kb){if(!Ha.a.b5(kb))return 1;kb=this.x2e(kb,this.$zb);return!kb&&this.bli()?3:this.Yni(kb)?0:2};e.prototype.bli=function(){var kb=this.gridView.ha.sa.selectedRanges;return this.isRow&&ka.P(kb)||!this.isRow&&ka.O(kb)};e.prototype.rbd=function(kb){var vb="";switch(kb){case 0:vb="";break;case 1:vb=ja.a.instance.ga(770);break;case 2:kb=this.$zb;vb=String.format(ja.a.instance.mb(99),0,this.kbc(kb));break;case 3:vb=ja.a.instance.ga(771)}return vb};e.prototype.Yni=function(kb){return 0<=
kb&&kb<=this.kbc(!1)};e.prototype.kbc=function(kb){return this.itc.kbc(kb,this.isRow)};e.kOd=function(kb,vb,Wa){if(vb)for(kb.ColumnWidth=e.mba,kb.RowHeight=Wa,kb=bk(kb.SheetMultiRange.Ranges),vb=kb.next();!vb.done;vb=kb.next())vb=vb.value,vb.FirstColumn=0,vb.LastColumn=0;else for(kb.RowHeight=e.mba,kb.ColumnWidth=Wa,kb=bk(kb.SheetMultiRange.Ranges),vb=kb.next();!vb.done;vb=kb.next())vb=vb.value,vb.FirstRow=0,vb.LastRow=0};Mf.Object.defineProperties(e.prototype,{nc:{configurable:!0,enumerable:!0,get:function(){return"ResizeHeadersDialog"}},
$zb:{configurable:!0,enumerable:!0,get:function(){return e.U8d},set:function(kb){e.U8d=kb}}});e.z4="id";e.qli="isRow";e.C9h="initialSizeInPx";e.B9h="initialSizeInDefaultUnits";e.hii="isInitialUnitsDefaultUnits";e.Vdd="getInputErrorIfInvalid";e.nBj="size";e.Yfi="isDefaultUnits";e.mba=-1;e.U8d=!0;Object(u.a)(e,"ResizeHeadersDialog",w.a,[]);var ib=b(62),La=b(354),zb=b(445),Fb=b(64);d.prototype.Lc=function(kb,vb){kb=!0;switch(vb){case -445963340:case 1391094586:kb=this.Ud(8);break;case 745189930:case 146338636:kb=
this.Ud(16)}return!kb};d.prototype.executeCommand=function(kb,vb,Wa){var qb=Ga.TaskExtensions.jk();var yb=V.g(this.$);kb=xa.a.create().toString();var ec=vb.command;switch(ec){case 1391094586:case 146338636:var Ob=1391094586===ec;(kb=Wa.autoFitRanges)&&kb.Ranges&&kb.Ranges.length||(kb=ka.r(yb.ha.sa.selectedRanges,this.$));qb=this.ogh(Ob?1:0,kb,vb);break;case -445963340:case 745189930:case -706918724:case 1051390410:case 369708605:case 1542466017:Ob=-445963340===ec||-706918724===ec||369708605===ec;
if(-445963340===ec||745189930===ec)Ob=da.a(vb.command),yb.si.y7(16,kb,Ob),qb=Wa.resizeRowColumnParameters;else{Wa=yb.ha.sa.selectedRanges;if(wa.EwaSettings.isChangeGateEnabled("OfficeVSO:6476251_ReduceLongOpsTel")){var Cb=0,ab=bk(Wa);for(yb=ab.next();!yb.done;yb=ab.next())if(yb=yb.value,-706918724===ec||369708605===ec)yb=yb.right-yb.left+1,Cb+=0<yb?yb:-1*yb;else if(1542466017===ec||1051390410===ec)Cb+=yb.bottom-yb.top+1;369708605===ec||1542466017===ec?B.ULS.sendTraceTag(520938758,0,50,"ResizeCommandHandler.doResize: Unhide Rows/Columns NumberOfRanges={0}",
Cb):(-706918724===ec||1051390410===ec)&&B.ULS.sendTraceTag(520938757,0,50,"ResizeCommandHandler.doResize: hide Rows/Columns NumberOfRanges={0}",Cb)}if(-706918724===ec&&6===vb.Le&&ka.O(Wa)){B.ULS.sendTraceTag(537154007,0,50,"ResizeCommandHandler.HandleResizeCommand: Command 'HideColumn' was ignored because entire row is selected");break}if(1051390410===ec&&6===vb.Le&&ka.P(Wa)){B.ULS.sendTraceTag(537154006,0,50,"ResizeCommandHandler.HandleResizeCommand: Command 'HideRow' was ignored because entire column is selected");
break}ec=369708605===ec||1542466017===ec?-2:0;qb={};qb.SheetMultiRange=ka.r(Wa,this.$);if(Ob)for(Wa=bk(qb.SheetMultiRange.Ranges),yb=Wa.next();!yb.done;yb=Wa.next())yb=yb.value,yb.FirstRow=0,yb.LastRow=0;else for(Wa=bk(qb.SheetMultiRange.Ranges),yb=Wa.next();!yb.done;yb=Wa.next())yb=yb.value,yb.FirstColumn=0,yb.LastColumn=0;qb.RowHeight=Ob?-1:ec;qb.ColumnWidth=Ob?ec:-1}qb=this.Igh(qb,vb,kb);break;case 957527587:case 2040891415:new e(this.$,vb)}return qb};d.prototype.xZg=function(kb){wa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.IntelligentMetadataTableProactiveSuggestions",
!1)&&Ga.TaskExtensions.Aa(Ka.GetServiceTaskFactory.Ra(this.$.da,426,427,1),function(vb){vb.result.WVd(kb,"ColumnAutoFit")},this.$.la,3)};d.prototype.zc=function(kb,vb,Wa,qb){if(kb=!!Wa&&!!qb&&1===qb.ox)switch(vb.command){case 1391094586:case 146338636:case -445963340:case 745189930:case -706918724:case 1051390410:case 369708605:case 1542466017:case 957527587:case 2040891415:break;default:kb=!1}return kb};d.prototype.Qc=function(){return!1};d.prototype.xui=function(kb){B.ULS.sendTraceTag(537154004,
0,50,"ResizeCommandHandler.LogInstantaneousResize: Resize operation succeeded: {0}. Reason: {1}.",kb.success,Object(zb.c)(kb)?void 0:kb.reason)};d.prototype.Ud=function(kb){return(new R.a(this.$.va)).Ud(kb)};d.prototype.ogh=function(kb,vb,Wa){function qb(){return new l(Ob,vb)}var yb=this,ec=this.$.oa.xa.Pb(),Ob=0===kb;return na.a(this.$.userOperationManager,function(Cb,ab,ya){var ma=yb.$.oa.xa;Cb=za.b(Cb,yb.sHi);var ha={mfi:!Ob,d0b:vb},Z=ma.Na(41,ec);Z.isRow=Ob;Z.autoFitRanges=vb;return ib.g(ma,"AutoFit",
Z,Cb,ab,ya,ha,0)},function(Cb){return new ia.a(135,0,Cb,void 0,qb)},Wa)};d.prototype.Igh=function(kb,vb,Wa){function qb(){return new k(kb)}function yb(ma,ha,Z){ec.$.ly();ka.i(Ob,",",ec.$,!1);var Na=ec.$.oa.xa;ma=za.b(ma,ec.YPi);var eb=Na.Na(41,void 0===ya?null:ya);eb.resizeRowColumnParameters=kb;return ib.g(Na,"ResizeRowsColumns",eb,ma,ha,Z,Wa,0)}var ec=this,Ob=ka.g(kb.SheetMultiRange.Ranges),Cb=vb.command;if(745189930===Cb||-445963340===Cb){B.ULS.shipAssertTag(537154002,0,this.$.activeItemName===
kb.SheetMultiRange.SheetName,"ResizeCommandHandler.DoResize: should do CSE for active sheet only!");var ab=V.g(this.$);Cb=745189930===Cb;ab=this.Fg.Azj(ab,Ob,Cb?kb.RowHeight:kb.ColumnWidth,Cb);this.xui(ab);Object(zb.c)(ab)&&V.g(this.$).si.A0(Wa,sa.BasicTelemetryCalculator.HQ)}var ya=this.$.oa.xa.Pb({n_:!0,GZ:3});return ab&&Object(zb.c)(ab)?wa.EwaSettings.Zb()?na.a(this.$.userOperationManager,yb,function(ma){return new ia.a(136,0,ma,64,qb)},vb):na.a(this.$.userOperationManager,yb,function(ma){return new qa.a(136,
0,ma,void 0,qb)},vb):na.a(this.$.userOperationManager,yb,function(ma){return new ia.a(136,0,ma,void 0,qb)},vb)};Object(u.a)(d,"ResizeCommandHandler",null,[429]);var Yb=db.a;Rk(c,Yb);c.prototype.Ad=function(){var kb=this,vb=Ka.GetServiceTaskFactory.create(this.$.da,18,this.la,this.hb);Ga.TaskExtensions.Aa(vb,function(){kb.jd([new d(kb.$,vb.result)])},this.la,3)};c.ka=function(kb){db.a.Qd(113,new c(kb))};Object(u.a)(c,"ResizeCommandHandlerFactory",db.a,[]);b.d(E,"a",function(){return a})},1372:function(u,
E,b){function a(){Type.registerNamespace("Common.App.OneDriveFilePickerApi");c.main()}function c(){this.fb=null}function d(U){this.Wl=null;this.Og=U;this.aPc=3}function e(U,J,H,K){J=l.call(this,U,J,H,K)||this;J.options.advanced.filter=U.Wa("OneDriveApiV72Filter")||"folder,photo";J.options.advanced.linkType="download";J.options.multiSelect=F.AFrameworkApplication.npe;U.qa("OneDriveApiV72CommandModeEnabled")&&(J.options.commandMode=U.Wa("OneDriveApiV72CommandMode")||"none");U.qa("OneDriveApiV72QosExtraDataEnabled")&&
(J.options.qosExtradata=new k(F.AFrameworkApplication.userSessionId));return J}function k(U){this.olsSessionId=this.value=this.key=null;this.olsSessionId=U}function l(U,J,H,K){J=v.call(this,U,J,H,K)||this;J.dkg=U;J.options={};J.options.advanced={};J.options.action="query";J.options.clientId=J.fa.Wa("OneDriveApiV72ClientId");J.options.advanced.trapFocus=!0;return J}function n(U,J,H,K,N){U=v.call(this,U,J,H,K)||this;U.Dbe=null;U.OSb=null;U.nng=N;U.options={};U.options.clientId=U.fa.Wa("OneDriveApiV7ClientId");
U.options.cancel=Object(z.a)(U,U.Ezc,"toggleHostDivVisibility");return U}function f(U,J,H,K,N,M){J=v.call(this,J,H,K,M)||this;J.xh=null;J.P1=U;J.Nvg=N;return J}function v(U,J,H,K){this.fEa=this.f6=null;this.YPc=this.$Pc=!1;this.yWa=null;this.ib=U;this.sQb=J;this.MDa=H;this.ps=K}function r(){}function y(){var U=w.call(this)||this;U.Rb=0;U.mc(1,CommonUIStrings.l_DialogClose);return U}u=b(0);var m=b(135),w=m.StandardDialog;Rk(y,w);y.prototype.displayError=function(U){this.Iz(U,CommonUIStrings.l_DefaultDialogTitle,
CommonUIStrings.l_OneDriveContactError,null)};y.prototype.O5c=function(U){this.Iz(U,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null,!0)};Object(u.a)(y,"ErrorDialog",m.StandardDialog,[572]);var B=b(14),A=b(162);r.prototype.BVe=function(){B.ULS.sendTraceTag(24134234,352,50,"Returning endpoint for ODC");var U=new A.a;U.setResult("api.onedrive.com");return U.task};Object(u.a)(r,"OneDriveConsumerEndpointHelper",null,[496]);var z=b(84),x=b(52),D=b(392),I=b(236);v.prototype.K3a=
function(){this.yWa||(this.yWa=this.Q9a?I.a.create(this.Q9a,null,null,null,!1):null);return this.yWa};v.prototype.setup=function(U){var J=this;this.fEa=U;this.$Pc||this.YPc?this.$Pc&&this.fEa&&this.fEa(!0):(U=this.K3a())?(this.YPc=!0,U.K7a.continueWith(function(H){J.NOi(H)}),D.a.lia(U)):(B.ULS.sendTraceTag(20509837,352,15,"Failure with OneDrive API download as the onedrive url received is empty."),this.fEa(!1))};v.prototype.Pzd=function(U){B.ULS.sendTraceTag(20509838,352,15,"Failure during OneDrive API download: {0}",
U.exception?U.exception.toString():"No error detail.")};v.prototype.NOi=function(U){this.YPc=!1;if(U.Xf)this.Pzd(U),this.fEa(!1);else try{this.$Pc=!0,B.ULS.sendTraceTag(17909022,352,50,"Initializing OneDrive API"),this.Bkd(),B.ULS.sendTraceTag(17909023,352,50,"OneDrive API is initialized."),this.fEa(!0)}catch(J){B.ULS.sendTraceTag(20555412,352,10,"Failed during OneDrive API init: {0}",J.toString()),this.fEa(!1)}};v.prototype.startPicker=function(U){this.f6=U;this.MDa?B.ULS.sendTraceTag(23881878,216,
50,"In limited edit mode, will not show Picker."):(B.ULS.sendTraceTag(23881877,216,50,"Not in limited edit mode, will show file picker."),this.setup(Object(z.a)(this,this.kyd,"onApiReady")))};v.prototype.kyd=function(U){U?this.ejc():this.hj()};v.prototype.hj=function(){this.ps().displayError(x.a.YTi)};v.prototype.onSuccess=function(U){B.ULS.sendTraceTag(17909057,352,50,"Success Callback called. Calling callback function.");this.f6&&this.f6(!0,U)};v.prototype.dispose=function(){this.yWa&&this.yWa.dispose()};
Mf.Object.defineProperties(v.prototype,{fpe:{configurable:!0,enumerable:!0,get:function(){return this.sQb}},fa:{configurable:!0,enumerable:!0,get:function(){return this.ib}}});Object(u.a)(v,"AOneDriveFilePickerApiManager",null,[76,3]);Rk(f,v);f.prototype.start=function(U,J){this.xh=U;this.startPicker(J)};f.prototype.Bkd=function(){var U={},J={};U=1===this.fpe||2===this.fpe?(U.client_id=this.fa.appSettings.UploadToSkyDriveClientId,U):(J.client_id=this.fa.appSettings.UploadToSkyDriveClientId,J.env=
"INT",J);WL.init(U)};f.prototype.startPicker=function(U){this.f6=U;!this.MDa&&this.P1.zLa?(B.ULS.sendTraceTag(17909025,352,50,"User is signed in. We will show file picker."),this.setup(Object(z.a)(this,this.kyd,"onApiReady"))):(B.ULS.sendTraceTag(17909026,352,50,"User is not signed in. show need to sign in dialog."),this.Nvg())};f.prototype.ejc=function(){try{B.ULS.sendTraceTag(17909027,352,50,"Launching file dialogue"),WL.fileDialog(this.xh).then(Object(z.a)(this,this.onSuccess,"onSuccess"),Object(z.a)(this,
this.e6,"onFailure"))}catch(U){B.ULS.sendTraceTag(17909056,352,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",U,U.stack),this.hj()}};f.prototype.e6=function(U){if(U&&U.error){if("user_canceled"===U.error.code){B.ULS.sendTraceTag(17909058,352,50,"User canceled.");return}B.ULS.sendTraceTag(17909059,352,50,"File Dialog returned with error code:{0}, and error message: {1}",U.error.code,U.error.message)}else B.ULS.sendTraceTag(17909060,352,50,"File Dialog returned with no response");this.f6&&this.f6(!1,
U);this.hj()};Mf.Object.defineProperties(f.prototype,{Q9a:{configurable:!0,enumerable:!0,get:function(){return this.fa.Wa("OneDriveApiUrl")}}});Object(u.a)(f,"OneDriveFilePickerApiManagerV5",v,[]);Rk(n,v);n.prototype.start=function(U,J){var H=this;this.OSb=J;var K=this.nng.BVe();K.continueWith(function(){B.ULS.sendTraceTag(24134241,352,50,"Fetch endpoint task completed, attempting to start OneDrive picker");H.Dbe=K.result;H.startPicker(function(N,M){H.Ezc();U(N,M)})},3);K.continueWith(function(){B.ULS.sendTraceTag(24134242,
352,15,K.exception.message);H.Ezc()},5)};n.prototype.Bkd=function(){var U=this;this.options.success=function(J){var H={};H.data=J;U.onSuccess(H)};this.options.error=function(J){var H={};H.error=J;U.e6(H)};this.options.advanced={};this.options.advanced.linkType="share";this.options.advanced.endpointHint=this.Dbe;this.options.advanced.iframeParentDiv=this.OSb};n.prototype.ejc=function(){try{B.ULS.sendTraceTag(22090007,352,50,"Launching OneDrive file picker dialog"),this.Ezc(),OneDrive.open(this.options)}catch(U){B.ULS.sendTraceTag(22090008,
352,10,"Opening OneDrive file picker threw an exception: {0}",U.message),this.hj()}};n.prototype.e6=function(U){this.f6&&this.f6(!1,U);this.hj()};n.prototype.Ezc=function(){this.OSb.style.visibility="hidden"===this.OSb.style.visibility?"":"hidden"};Mf.Object.defineProperties(n.prototype,{Q9a:{configurable:!0,enumerable:!0,get:function(){return this.fa.Wa("OneDriveApiV72Url")}}});Object(u.a)(n,"OneDriveFilePickerApiManagerV7",v,[]);Rk(l,v);l.prototype.start=function(U,J,H,K){this.options.advanced.iframeParentDiv=
H;this.options.advanced.endpointHint=K;this.options.cancel=J;this.dkg.qa("OneDriveApiV72RecentsViewEnabled")&&(this.options.advanced.navigation={},this.options.advanced.navigation.entryLocation={},this.options.advanced.navigation.entryLocation.oneDrive={},this.options.advanced.navigation.entryLocation.oneDrive.recent={});this.startPicker(U)};l.prototype.startPicker=function(U){this.f6=U;this.MDa?B.ULS.sendTraceTag(24391838,216,50,"In limited edit mode, will not show Picker."):(B.ULS.sendTraceTag(24391837,
216,50,"Not in limited edit mode, will show file picker."),this.setup(Object(z.a)(this,this.kyd,"onApiReady")))};l.prototype.Bkd=function(){var U=this;this.options.success=function(J){var H={};H.data=J;U.onSuccess(H)};this.options.error=function(J){var H={};H.error=J;U.e6(H)}};l.prototype.ejc=function(){try{B.ULS.sendTraceTag(23881879,216,50,"Launching OneDrive file picker dialog"),OneDrive.save(this.options)}catch(U){B.ULS.sendTraceTag(23881880,216,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",
U.message,U.stack),this.hj()}};l.prototype.Pzd=function(U){B.ULS.sendTraceTag(25180160,216,15,"Failure during OneDrive API download: {0}",U.exception?U.exception.toString():"No error detail.");D.a.i$i(this.Q9a);this.yWa=null};l.prototype.hj=function(){this.ps().O5c(x.a.Pij)};l.prototype.e6=function(U){this.f6&&this.f6(!1,U)};Mf.Object.defineProperties(l.prototype,{Q9a:{configurable:!0,enumerable:!0,get:function(){return this.fa.Wa("OneDriveApiV72Url")}}});Object(u.a)(l,"OneDriveFilePickerApiManagerV72",
v,[]);Object(u.a)(k,"IExtraData",null,[]);var F=b(4);Rk(e,l);e.prototype.ejc=function(){try{B.ULS.sendTraceTag(26071182,352,50,"Launching OneDrive file picker dialog with filter: {0}, commandMode: {1}, QosExtraData: {2} officeSessionId: {3}",this.options.advanced.filter,this.options.commandMode,this.options.qosExtradata?this.options.qosExtradata.olsSessionId:"",F.AFrameworkApplication.userSessionId),OneDrive.open(this.options)}catch(U){B.ULS.sendTraceTag(26071183,352,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",
U.message,U.stack),this.hj()}};Mf.Object.defineProperties(e.prototype,{Q9a:{configurable:!0,enumerable:!0,get:function(){return this.fa.Wa("OneDriveApiV72Url")}}});Object(u.a)(e,"OneDriveFilePickerApiOpenManagerV72",l,[]);var G=b(246);d.prototype.BVe=function(){this.Wl=new A.a;B.ULS.sendTraceTag(24134235,352,50,"Sending initial request for OneDrive for Business Endpoint");this.EMd();return this.Wl.task};d.prototype.EMd=function(U){U=void 0===U?null:U;var J=String.format("GetMoreInfoHandler.ashx?{0}",
F.AFrameworkApplication.FHa);this.Og.A9(J,1,null,U,["PersonalFileStorageUrl","X-NewKey"],!1,2,Object(z.a)(this,this.ARh,"getMoreInfoSucceeded"),Object(z.a)(this,this.yRh,"getMoreInfoFailed"),null,void 0,void 0,void 0,void 0,"21")};d.prototype.yRh=function(U){if(U.data.httpStatus===G.a.iGb&&"X-NewKey"in U.data.responseHeaders){B.ULS.sendTraceTag(24134236,352,50,"GetMoreInfo request failed due to bad canary. Updating with new canary and resending");var J={};J["X-Key"]=U.data.responseHeaders["X-NewKey"];
this.EMd(J)}else 0<this.aPc?(B.ULS.sendTraceTag(24134237,352,50,"GetMoreInfo request failed, attmepting again. {0} retries remaining",this.aPc),this.aPc--,this.EMd()):(B.ULS.sendTraceTag(24134238,352,50,"GetMoreInfo request failed, and no more retries remaining. Faulting task"),this.Wl.setException(Error.create("GetMoreInfo request failed and no more retries remain")))};d.prototype.ARh=function(U){"PersonalFileStorageUrl"in U.data.responseHeaders&&""!==U.data.responseHeaders.PersonalFileStorageUrl?
(B.ULS.sendTraceTag(24134239,352,50,"Successfully received an ODB endpoint"),this.Wl.setResult(U.data.responseHeaders.PersonalFileStorageUrl)):(B.ULS.sendTraceTag(24134240,352,50,"GetMoreInfo request was successful but didn't return an ODB endpoint"),this.Wl.setException(Error.create("GetMoreInfo request succeeded but did not have ODB endpoint")))};Object(u.a)(d,"OneDriveForBusinessEndpointHelper",null,[496]);var T=b(254),O=b(623);c.prototype.init=function(){};c.prototype.dispose=function(){};c.prototype.Ph=
function(U){var J=this;this.fb=U;this.fb.register(f,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV5").as("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager").tc().Cc(function(){return new f(O.a.instance,F.AFrameworkApplication.fa,F.AFrameworkApplication.M1a,F.AFrameworkApplication.limitedEdit,F.AFrameworkApplication.e3f,function(){return new y})});F.AFrameworkApplication.Yff?this.fb.register(496,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").tc().Cc(function(){return new r}):
this.fb.register(496,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").tc().Cc(function(){return new d(F.AFrameworkApplication.qd)});this.fb.register(n,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV7").tc().Cc(function(){return new n(F.AFrameworkApplication.fa,F.AFrameworkApplication.M1a,F.AFrameworkApplication.limitedEdit,function(){return new y},J.fb.resolve("Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper"))});this.fb.register(l,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72").tc().Cc(function(){return new l(F.AFrameworkApplication.fa,
F.AFrameworkApplication.M1a,F.AFrameworkApplication.limitedEdit,function(){return new y})});this.fb.register(e,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiOpenManagerV72").tc().Cc(function(){return new e(F.AFrameworkApplication.fa,F.AFrameworkApplication.M1a,F.AFrameworkApplication.limitedEdit,function(){return new y})})};c.main=function(){T.a.instance.Qi(new c)};Mf.Object.defineProperties(c.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.OneDriveFilePickerApi"}}});
Object(u.a)(c,"PackageManager",null,[10,11]);b.d(E,"a",function(){return a})},1378:function(u,E,b){function a(){Type.registerNamespace("Common.App.SaveAsToHost");c.main()}function c(){this.fb=null}function d(P,ka,R,fa,ca,ea,wa,X){this.qm=null;this.zWa=this.fDa=!1;this.mga=this.xh=this.dA=null;this.ib=ka;this.cFa=this.ib.appSettings.SaveAsToHostWebServiceBase;this.H7d=fa;this.Bkb=ca;this.Og=R;this.ps=ea;this.ph=X;this.Re=wa;this.La=P;this.lfa=ka.Wa("SaveAsToHostUploadHandler")||"hostuploadhandler.ashx"}
function e(P,ka,R){this.nga=R;this.HHc=ka;this.ib=P}function k(P,ka,R,fa,ca,ea){this.La=ka;this.ib=P;this.sX=fa;this.nga=ea;this.ps=ca;this.Re=R}function l(P,ka,R,fa,ca,ea){P=I.call(this,P,ka,R,fa,ca,ea)||this;P.Vf=n.Vf;P.ye="FileNameDialog-SaveAsToHost";return P}function n(){}function f(P,ka){this.ib=P;this.La=ka;this.Vhb=this.ib.qa("SaveToHostWithExtraCharsInFileName")}function v(P,ka){var R=A.call(this)||this;R.zWa=!1;R.dA=null;R.La=P;R.Vhb=ka;R.PRa=!1;return R}u=b(0);var r=b(84),y=b(14),m=b(135),
w=b(52),B=b(25),A=m.StandardDialog;Rk(v,A);v.prototype.displayError=function(P,ka,R){this.dA=ka;this.zWa=R;y.ULS.sendTraceTag(8194008,216,50,"Display error with code:{0}, overwriteTarget:{1}.",P,R);P=this.i_c(P);0===P?(this.Rb=6,this.mc(0,CommonUIStrings.l_DialogClose)):(this.Rb=0,this.mc(1,CommonUIStrings.l_DialogClose));0===P&&y.ULS.sendTraceTag(8194009,216,50,"Show standard error dialog.");this.Iz(w.a.Oij,this.Lcd(P),this.fMh(P,ka),Object(r.a)(this,this.MKd,"retryDialogHandler"),!0)};v.prototype.MKd=
function(P){1===P?(y.ULS.sendTraceTag(8194010,216,50,"User click to retry button in error dialog."),this.dA?this.La.$d(B.a.mJb,2,[this.dA,this.zWa]):this.La.processAction(B.a.mJb,2)):y.ULS.sendTraceTag(8194011,216,50,"User cancel the error dialog.")};v.prototype.i_c=function(P){return 0>P||6<P?(y.ULS.sendTraceTag(8194012,216,15,"Unexpected error code {0}.",P),0):P};v.prototype.fMh=function(P,ka){P=this.i_c(P);return this.Vhb?[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameAllowPercentOctothorpe,
CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,String.format(CommonUIStrings.l_OverwriteTargetText,ka),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameDisallowPercentOctothorpe][P]:[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameText,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,String.format(CommonUIStrings.l_OverwriteTargetText,ka),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameText][P]};v.prototype.Lcd=
function(P){P=this.i_c(P);return[CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle,CommonUIStrings.l_EmptyNameTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle][P]};Object(u.a)(v,"ErrorRetryDialog",m.StandardDialog,[713]);f.prototype.create=function(){return new v(this.La,this.Vhb)};Object(u.a)(f,"ErrorRetryDialogFactory",null,[682]);m=b(1253);var z=b(150);Mf.Object.defineProperties(n,
{Vf:{configurable:!0,enumerable:!0,get:function(){return z.a.No(n.qk,CommonUIStrings.l_SaveACopyFileName,CommonUIStrings.l_SaveAsToHostOverwrite)}}});n.qk="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='OverwriteBlock'> <span id='OverwriteBlockSpan' class='WACDialogSpan'><input type='checkbox' id='chkOverwrite' class='WACDialogCheckBox'></input> <label id='lbcOverwrite' class='\"WACDialogInlineLabel\"' for='chkOverwrite'>{1}</label></span> </div>";
Object(u.a)(n,"FileNameDialogHtml",null,[]);var x=b(4),D=b(29),I=m.a;Rk(l,I);l.prototype.YP=function(P,ka){var R=D.a.nq(x.AFrameworkApplication.am.Pm),fa={};ka=(fa.txtFileName=P||R,fa.lblFolderName=CommonUIStrings.l_ToCurrentFolder,fa.chkOverwrite=ka,fa);this.initializeAndShow(CommonUIStrings.L_SaveAs,Object(r.a)(this,this.h9b,"fileNameDialogHandler"),ka);this.bHe(P,R)};Object(u.a)(l,"FileNameDialog",m.a,[711]);k.prototype.create=function(){return new l(this.ib,this.La,this.Re,this.sX,this.ps,this.nga)};
Object(u.a)(k,"FileNameDialogFactory",null,[679]);var F=b(739),G=b(107);e.prototype.Bg=function(){2===x.AFrameworkApplication.ta.Qa.Cj?x.AFrameworkApplication.ub.He(B.a.mJb,G.a.frame,Object(r.a)(this,this.qUf,"saveAsToHostActionDispatcher"),4):x.AFrameworkApplication.ub.Mb(B.a.mJb,G.a.frame,Object(r.a)(this,this.qUf,"saveAsToHostActionDispatcher"))};e.prototype.qUf=function(P,ka,R,fa,ca){return ka.contextId!==G.a.frame||P!==B.a.mJb?2:this.ib.qa("SaveAsToHostBrsIsEnabled")?1===R?F.SessionStatusManager.instance.Dwb||
x.AFrameworkApplication.Y4?8:32:2===R?(y.ULS.sendTraceTag(8194015,216,50,"User clicked on SaveAsToHost button from the backstage."),P=this.HHc.create(),ca&&Object.getType(ca)===Array&&2===ca.length?P.YP(ca[0],!!ca[1]):P.YP(null,!1),32):8:8};Object(u.a)(e,"SaveAsToHostActor",null,[]);var T=b(41),O=b(81),U=b(39),J=b(246),H=b(391),K=b(170),N=b(740),M=b(977);d.prototype.PLb=function(){1!==this.Re.state&&(this.qm=this.Bkb(),this.qm.message=CommonUIStrings.l_CommentProgressTooltip,this.qm.Rb=5,this.qm.Pu=
!1,this.qm.DAa(CommonUIStrings.l_DefaultDialogTitle,null,null))};d.prototype.$R=function(P){P=void 0===P?0:P;1!==this.Re.state&&this.ps.create().displayError(P,D.a.nq(this.dA),this.zWa)};d.prototype.FPa=function(){var P=this.ib.appSettings.BreadcrumbFolderUrl;y.ULS.sendTraceTag(8194016,216,50,"Redirecting to OneDrive for business Folder.");U.a.Ze(P,U.a.jX(3),void 0,"UploadToHostManager.RedirectToFolder")};d.prototype.EPa=function(P){var ka=!1,R=!1;this.ib&&(ka=this.ib.qa("SaveACopyIsEnabledForUiHost"),
R=this.ib.qa("UiHostSupportsDocRebootFeatures"));y.ULS.sendTraceTag(8194017,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1} uiHostSupportsFeature {2}",P,ka,R);if(ka&&R){y.ULS.sendTraceTag(51245197,216,50,"UploadToHostManager.RedirectToEditUrl: Sending DocumentRefresh post message.");var fa={};fa[H.a.zPa]="1";fa[H.a.documentUrl]=P;fa[H.a.reason]=N.a.saveAs;x.AFrameworkApplication.$U().execute(function(ca){ca.uj(K.a.Eta,fa)})}else ka&&!R&&x.AFrameworkApplication.xba?U.a.Ze(P,U.a.jX(4),void 0,
"UploadToHostManager.RedirectToEditUrl"):U.a.Ze(P,U.a.jX(3),void 0,"UploadToHostManager.RedirectToEditUrl")};d.prototype.Nna=function(P,ka,R){R=void 0===R?null:R;y.ULS.sendTraceTag(8194018,216,50,"Starting to upload file");this.H7d&&!this.H7d()&&this.Og&&(this.ph&&(this.mga=this.ph.sc("DialogShown","SaveAsToHostUploadTime")),this.PLb(),this.zWa=ka,this.dA=P,(this.xh=R)&&"true"===this.xh.SkipSaveToHost?this.F8b():this.gQ())};d.prototype.gQ=function(){var P=this;32!==this.La.processAction(B.a.CQa,1)?
(y.ULS.sendTraceTag(18989378,219,15,"The save file change is not supported, this operation may exist data losting."),this.F8b()):this.La.$d(B.a.CQa,2,[function(){y.ULS.sendTraceTag(18989379,219,50,"Call the force save file change successfully.");P.F8b()},function(ka,R){y.ULS.sendTraceTag(18989380,219,15,"The file change is not saved successfully, this operation may lead to data loss.");P.$R(R)}])};d.prototype.kTi=function(P){this.kIa();this.fDa=!1;if(P&&P.data&&P.data.Td){var ka=T.d(P.data.Td);var R=
ka.Lt;if(ka.returnValue)if(R.StatusCode!==J.a.JO&&R.StatusCode!==J.a.prb)y.ULS.sendTraceTag(8194049,216,10,"UploadToHostManager failure. Response data is not JSON."),P={},P.FailureReason=R.StatusCode.toString(),P.ExtraInfo=R.ExtraInfo,this.kda(P),this.$R(parseInt(R.ExtraInfo));else{y.ULS.sendTraceTag(8194050,216,50,"UploadToHost execute success.");this.EJd();try{R.NewDocumentUrl&&""!==R.NewDocumentUrl?this.EPa(R.NewDocumentUrl):this.FPa()}catch(fa){y.ULS.sendTraceTag(37025699,216,15,"Redirect failed with exception: {0}",
fa.toString())}this.QFb()}else R={},y.ULS.sendTraceTag(8194048,216,10,"Failed to deserialize : {0}",(R.ResponseData=M.a.ueb(P.data.Td),R)),P={},this.kda((P.FailureReason="Failed to deserialize response",P)),this.$R()}else y.ULS.sendTraceTag(8194019,216,10,"UploadToHostManager failure. Response data is null"),P={},this.kda((P.FailureReason="null response",P)),this.$R()};d.prototype.jTi=function(P){if(5!==P.data.status&&12!==P.data.status||this.fDa){var ka={};y.ULS.sendTraceTag(8194052,216,10,"UploadToHostManager HTTP failure with code: {0}",
(ka.Status=P.data.status,ka.HttpStatus=P.data.httpStatus,ka));ka={};this.kda((ka.FailureReason=P.data.httpStatus.toString(),ka));this.kIa();this.$R();this.QFb()}else y.ULS.sendTraceTag(8194051,216,10,"UploadToHostManager failure. Retry automatically."),this.fDa=!0,this.xh&&"true"===this.xh.SkipSaveToHost?this.F8b():this.gQ()};d.prototype.kIa=function(){this.qm&&(this.qm.close(),this.qm=null)};d.prototype.QFb=function(){this.mga&&(this.mga.stop(),this.mga=null)};d.prototype.EJd=function(){this.xh&&
"VersionHistory"===this.xh.SaveEntryPoint&&this.La.processAction(B.a.Wsc,2)};d.prototype.kda=function(P){this.xh&&"VersionHistory"===this.xh.SaveEntryPoint&&this.La.$d(B.a.GJd,2,P)};d.prototype.F8b=function(){var P=this.cFa+this.lfa;P=O.a.wl(P,"qs",D.a.$e(x.AFrameworkApplication.Yi));P=O.a.wl(P,"n",D.a.$e((new Date).getTime().toString()));P=O.a.wl(P,"ov",D.a.$e(this.zWa.toString()));P=O.a.wl(P,"fn",D.a.$e(this.dA));this.xh&&this.xh.FileDownloadUrl&&(P=O.a.wl(P,"furl",D.a.$e(this.xh.FileDownloadUrl)));
this.Og.Yl(P,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,Object(r.a)(this,this.kTi,"onUploadFinished"),Object(r.a)(this,this.jTi,"onUploadFailed"),null,void 0,void 0,void 0,void 0,"1")};Object(u.a)(d,"UploadToHostManager",null,[675]);var C=b(254),Q=b(995);c.prototype.init=function(){x.AFrameworkApplication.fa.Su(Object(r.a)(this,this.oB,"onFullAppSettingsReady"))};c.prototype.oB=function(){x.AFrameworkApplication.fa.qa("SaveAsToHostBrsIsEnabled")&&this.fb.resolve("Common.App.SaveAsToHost.SaveAsToHostActor").Bg()};
c.prototype.Ph=function(P){this.fb=P;this.fb.register(f,"Common.App.SaveAsToHost.ErrorRetryDialogFactory").as("Common.App.SaveAsToHost.IErrorRetryDialogFactory").Cc(function(){return new f(x.AFrameworkApplication.fa,x.AFrameworkApplication.ub)}).tc();this.fb.register(d,"Common.App.SaveAsToHost.UploadToHostManager").as("Common.App.SaveAsToHost.IUploadToHostManager").Cc(function(){return new d(x.AFrameworkApplication.ub,x.AFrameworkApplication.fa,x.AFrameworkApplication.qd,function(){return x.AFrameworkApplication.Ag},
function(){return(new Q.a).create()},P.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),x.AFrameworkApplication.ta,x.AFrameworkApplication.ta.pD)}).tc();this.fb.register(k,"Common.App.SaveAsToHost.FileNameDialogFactory").as("Common.App.SaveAsToHost.IFileNameDialogFactory").Cc(function(){return new k(x.AFrameworkApplication.fa,x.AFrameworkApplication.ub,x.AFrameworkApplication.ta,x.AFrameworkApplication.ta.Qa,P.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),P.resolve("Common.App.SaveAsToHost.UploadToHostManager"))}).tc();
this.fb.register(e,"Common.App.SaveAsToHost.SaveAsToHostActor").Cc(function(){return new e(x.AFrameworkApplication.fa,P.resolve("Common.App.SaveAsToHost.FileNameDialogFactory"),P.resolve("Common.App.SaveAsToHost.UploadToHostManager"))}).tc()};c.prototype.dispose=function(){};c.main=function(){C.a.instance.Qi(new c)};Mf.Object.defineProperties(c.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.SaveAsToHost"}}});Object(u.a)(c,"SaveAsToHostPackage",null,[10,11]);b.d(E,
"a",function(){return a})},1379:function(u,E,b){function a(){Type.registerNamespace("Common.App.SaveACopy");c.main()}function c(){this.fb=null}function d(M,C,Q,P,ka,R){C=J.call(this,C,Q,P,ka,R)||this;C.La=M;return C}function e(M,C,Q,P,ka,R,fa){C=O.call(this,C,Q,P,ka,R,fa)||this;C.Png=M;return C}function k(M,C,Q,P){M=T.call(this,M,C,Q,P)||this;M.Ksg=C;return M}function l(M){var C=D.call(this)||this;C.Rb=1;C.mc(1,CommonUIStrings.l_RetryButtonLabel);C.mc(0,CommonUIStrings.l_DialogClose);C.La=M;return C}
function n(M,C,Q){this.La=M;this.sX=C;this.Tlb=Q}function f(M,C,Q,P){var ka=A.call(this)||this;ka.E8=null;ka.BSb=null;ka.La=M;ka.sX=C;ka.Tlb=Q;ka.mc(1,CommonUIStrings.l_SaveButtonLabel);ka.Vf=v.Vf;ka.ye="FileNameDialog-SaveACopy";ka.xh=P;return ka}function v(){}u=b(0);var r=b(84),y=b(14),m=b(150);Mf.Object.defineProperties(v,{Vf:{configurable:!0,enumerable:!0,get:function(){return m.a.No(v.qk,CommonUIStrings.l_SaveACopyFileName)}}});v.qk="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div>";
Object(u.a)(v,"FileNameDialogHtml",null,[]);var w=b(4),B=b(29),A=m.a;Rk(f,A);f.prototype.YP=function(M,C,Q){this.BSb=M;this.E8=Q;M={};C=(M.txtFileName=B.a.nq(w.AFrameworkApplication.am.Pm),M.lblFolderName=String.format(CommonUIStrings.l_DestinationFolder,C),M);this.initializeAndShow(CommonUIStrings.l_SaveToOneDrive,Object(r.a)(this,this.h9b,"fileNameDialogHandler"),C);y.ULS.sendTraceTag(7174148,216,50,"The file name dialog is initialized and shown.");document.getElementById("txtFileName").focus()};
f.prototype.h9b=function(M,C){1!==M?y.ULS.sendTraceTag(7165650,216,50,"User click cancel to cancel upload file in file name dialog."):(M=C.txtFileName.trim(),y.ULS.sendTraceTag(7165651,216,50,"User click save to upload file with new name."),C=B.a.Z3(w.AFrameworkApplication.fileName),M&&""!==M&&""!==C&&(M+=C),this.Tlb.Nna(this.BSb,this.E8,M,this.xh))};Object(u.a)(f,"FileNameDialog",m.a,[712]);n.prototype.create=function(M){return new f(this.La,this.sX,this.Tlb,M)};Object(u.a)(n,"FileNameDialogFactory",
null,[681]);var z=b(135),x=b(25),D=z.StandardDialog;Rk(l,D);l.prototype.displayError=function(M){y.ULS.sendTraceTag(7165652,216,50,"Show error dialog here {0}.",M);this.Iz(M,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,Object(r.a)(this,this.MKd,"retryDialogHandler"))};l.prototype.MKd=function(M){1===M?(y.ULS.sendTraceTag(7165653,216,50,"User click to retry the action."),this.La.processAction(x.a.saveACopy,2)):y.ULS.sendTraceTag(7165654,216,50,"User cancel the error dialog.")};
Object(u.a)(l,"RetryDialog",z.StandardDialog,[680]);z=b(1254);var I=b(1046),F=b(392),G=b(107),T=z.a;Rk(k,T);k.prototype.V6a=function(){return this.ib.qa("SaveACopyBrsIsEnabled")};k.prototype.gVe=function(){return x.a.saveACopy};k.prototype.i1b=function(){F.a.PGd(Object(r.a)(this,this.JUf,"saveToCloudActionDispatcher"));F.a.o7c([new I.a(x.a.saveACopy,G.a.frame,0)],this.Ksg.K3a())};k.prototype.aMf=function(){y.ULS.sendTraceTag(7205456,216,50,"User clicked on SaveAs button from the backstage.")};Object(u.a)(k,
"SaveACopyActor",z.a,[]);z=b(1257);var O=z.a;Rk(e,O);e.prototype.onSuccess=function(M){M&&M.data&&M.data.folders?(y.ULS.sendTraceTag(7165655,216,50,"User selected which folder to upload file to."),this.Png.create(this.xh).YP(M.data.folders[0].id,M.data.folders[0].name,M.data.folders[0].urls.viewInBrowser)):(y.ULS.sendTraceTag(7165656,216,10,"Fail to select folder to upload file."),this.hj())};e.prototype.e6=function(M){M&&M.error&&"user_canceled"===M.error.code&&y.ULS.sendTraceTag(7205457,216,50,
"User cancelled upload to their OneDrive in Save A Copy.");O.prototype.e6.call(this,M)};e.prototype.hj=function(){y.ULS.sendTraceTag(7205458,216,50,"Error occur in Save A Copy Manager.");O.prototype.hj.call(this)};Object(u.a)(e,"SaveACopyManager",z.a,[]);var U=b(1255),J=U.a;Rk(d,J);d.prototype.ppd=function(){return!!this.xh&&!!this.xh.SaveEntryPoint&&"VersionHistory"===this.xh.SaveEntryPoint.toString()};d.prototype.$R=function(){y.ULS.sendTraceTag(7205459,216,50,"Display Error for Save A Copy.");
if(this.ppd()){var M={};this.La.$d(x.a.GJd,2,(M.FailureReason="Unknown",M))}J.prototype.$R.call(this)};d.prototype.FPa=function(){y.ULS.sendTraceTag(7205460,216,50,"Redirecting to OneDrive Folder for Save A Copy.");this.ppd()&&this.La.processAction(x.a.Wsc,2);J.prototype.FPa.call(this)};d.prototype.EPa=function(M){y.ULS.sendTraceTag(7205461,216,50,"Redirecting to edit url {0} for Save A Copy.",M);this.ppd()&&this.La.processAction(x.a.Wsc,2);J.prototype.EPa.call(this,M)};d.prototype.gQ=function(){var M=
this;this.xh&&"true"===this.xh.SkipSaveToHost?J.prototype.gQ.call(this):32!==this.La.processAction(x.a.CQa,1)?(y.ULS.sendTraceTag(8741711,216,15,"The save file change is not supported, this operation may result in data loss"),J.prototype.gQ.call(this)):this.La.$d(x.a.CQa,2,[function(){y.ULS.sendTraceTag(8741712,216,50,"Call the force save file change successfully.");U.a.prototype.gQ.call(M)},function(){y.ULS.sendTraceTag(8741713,216,15,"The file change is not saved successfully, this operation may lead to data loss.");
M.$R()}])};Object(u.a)(d,"SaveACopyUploadToCloudManager",U.a,[]);var H=b(254),K=b(623),N=b(995);c.prototype.init=function(){w.AFrameworkApplication.fa.Su(Object(r.a)(this,this.oB,"onFullAppSettingsReady"))};c.prototype.oB=function(){w.AFrameworkApplication.fa.qa("SaveACopyBrsIsEnabled")&&this.fb.resolve("Common.App.SaveACopy.SaveACopyActor").Bg()};c.prototype.dispose=function(){};c.prototype.Ph=function(M){this.fb=M;this.fb.register(d,"Common.App.SaveACopy.SaveACopyUploadToCloudManager").Cc(function(){return new d(w.AFrameworkApplication.ub,
M.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),function(){return(new N.a).create()},function(){return new l(w.AFrameworkApplication.ub)},w.AFrameworkApplication.ta,w.AFrameworkApplication.ta.pD)}).tc();this.fb.register(n,"Common.App.SaveACopy.FileNameDialogFactory").as("Common.App.SaveACopy.IFileNameDialogFactory").Cc(function(){return new n(w.AFrameworkApplication.ub,w.AFrameworkApplication.ta.Qa,M.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"))}).tc();this.fb.register(k,
"Common.App.SaveACopy.SaveACopyActor").Cc(function(){return new k(M.resolve("Common.App.SaveACopy.SaveACopyManager"),M.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),w.AFrameworkApplication.fa,w.AFrameworkApplication.ta.pD)}).tc();this.fb.register(e,"Common.App.SaveACopy.SaveACopyManager").Cc(function(){return new e(M.resolve("Common.App.SaveACopy.FileNameDialogFactory"),M.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),K.a.instance,M.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"),
w.AFrameworkApplication.fa,w.AFrameworkApplication.M1a,function(){return new l(w.AFrameworkApplication.ub)})}).tc()};c.main=function(){H.a.instance.Qi(new c)};Mf.Object.defineProperties(c.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.SaveACopy"}}});Object(u.a)(c,"PackageManager",null,[10,11]);b.d(E,"a",function(){return a})},1385:function(u,E,b){function a(){r.a.Fa(c.ka);r.a.Fa(k.ka)}function c(C,Q,P,ka){var R=M.call(this)||this;R.activityName=C;R.kM=Q;R.FJ=P;R.$=
ka;R.Eb();return R}function d(C,Q,P){return v.call(this,C,Q,P)||this}function e(C,Q){C=f.call(this,C)||this;C.password=null;C.ghf=Q;C.rg();return C}function k(C,Q,P,ka){var R=K.call(this)||this;R.activityName=C;R.kM=Q;R.FJ=P;R.$=ka;R.Eb();return R}function l(C,Q,P){return v.call(this,C,Q,P)||this}function n(C){var Q=f.call(this,C)||this;Q.HKd=5;Q.D8d=!1;Q.passwordToModify=null;Q.aFf=function(){Q.$.isEditMode&&Q.Tgc&&(J.b().l7c("PasswordToModifyPasswordVerifiedTillInteractive"),Q.$.rl(Q.aFf))};Q.rg();
Q.$.Tk(Q.aFf);return Q}function f(C){var Q=G.call(this,C)||this;Q.zpa=0;Q.L4i=function(P,ka){Q.kab(P,ka)};Q.UYd=function(P,ka){Q.DTa(P,ka)};return Q}function v(C,Q,P){var ka=x.call(this,C,Q)||this;ka.ki=null;ka.dCd=null;ka.GWi=function(R,fa){ka.HFb(R,fa)};ka.FJ=P;return ka}var r=b(10);u=b(0);var y=b(232),m=b(14),w=b(29),B=b(85),A=b(249),z=b(35),x=A.a;Rk(v,x);v.prototype.initialize=function(C){x.prototype.initialize.call(this,C)};v.prototype.execute=function(C){this.ki=C;C=Object(B.a)(4,this.ki.ue);
this.erb(C);return 1};v.prototype.uI=function(C){x.prototype.uI.call(this,C)};v.prototype.erb=function(){var C=this;this.subscribe(this.ki,this.GWi,function(Q){C.dCd.add_disposing(Q)})};v.prototype.HFb=function(C){this.unsubscribe(function(Q){C.remove_disposing(Q)});this.ki.activityState[z.a.f2]=0};Object(u.a)(v,"PasswordProtectedFileActivity",A.a,[]);var D=b(389),I=b(324),F=b(15),G=D.a;Rk(f,G);f.prototype.kab=function(C){this.zpa=C};f.prototype.e3=function(){var C={};C[D.a.description]=F.a.instance.ga(1953);
C[D.a.jma]=F.a.instance.ga(1949);C[D.a.$Ef]=F.a.instance.ga(1971);C[D.a.YEf]=F.a.instance.ga(1972);C[D.a.ZEf]=F.a.instance.ga(1950);C[D.a.dkd]=F.a.instance.ga(1956);C[D.a.Kre]=F.a.instance.ga(1646);C[D.a.hVj]=F.a.instance.Xa(25);C[D.a.Eeg]=this.UYd;return C};f.prototype.Xsa=function(){var C={};C[I.a.Vv]=this.nc;C[D.a.BZa]=this.e3();return C};f.prototype.rg=function(){this.Rb=1;this.initializeAndShow(this.zl,this.L4i,this.Xsa())};Mf.Object.defineProperties(f.prototype,{nc:{configurable:!0,enumerable:!0,
get:function(){return"PasswordDialog"}},Zrb:{configurable:!0,enumerable:!0,get:function(){return this.zpa}},zl:{configurable:!0,enumerable:!0,get:function(){return F.a.instance.ga(1952)}}});Object(u.a)(f,"PasswordProtectedFilePasswordInputDialog",D.a,[]);var T=b(62),O=b(31),U=b(295),J=b(50);Rk(n,f);n.prototype.kab=function(C,Q){f.prototype.kab.call(this,C,Q);m.ULS.sendTraceTag(537154755,0,50,"PasswordProtectedFileModifyActivity.PasswordProtectedFileModifyPasswordInputDialogDisposing: user response: {0}",
C)};n.prototype.DTa=function(C,Q){this.passwordToModify=C;var P={};P.FileModifyPassword=w.a.$e(C);T.N(this.$.oa.xa,P,this.pTi(Q),this.oTi(Q),null,null)};n.prototype.e3=function(){var C=f.prototype.e3.call(this);C[D.a.dkd]=F.a.instance.ga(1957);C[D.a.description]=F.a.instance.Xa(24);return C};n.prototype.rg=function(){J.b().l7c("PasswordToModifyDialogShown");m.ULS.sendTraceTag(557446529,0,50,"PasswordProtectedFileModifyPasswordInputDialog.InitializeAndShowDialog: Initializing dialog.");f.prototype.rg.call(this)};
n.prototype.pTi=function(C){var Q=this;return function(P){O.a.Zg(P.Errors,[-2019873242])&&Q.x6b(Q.Xqb());if(!P||U.a(P))if(0<Q.HKd)Q.BKf(C);else{m.ULS.sendTraceTag(537154754,0,10,"VerifyPasswordToModifyOperation.GenerateOnVerifyPasswordToModifyRequestSuccess: Unexpected error: {0}",O.a.Ec(P.Errors));Q.$.ea.fp(P.Errors);Q.hide();return}Q.D8d=P.Result;Q.Tgc&&(J.b().MSd("UserAction","Password-To-Modify Workbook: Logging StopWatch duration after user enters corect password","PasswordToModifyPasswordVerifiedTillInteractive"),
m.ULS.sendTraceTag(555758470,0,50,"PasswordProtectedFileModifyPasswordInputDialog.OnVerifyPasswordToModifyRequestSuccess: User entered the correct password."));C(Q.Tgc?0:1)}};n.prototype.oTi=function(C){var Q=this;return function(){0<Q.HKd?Q.BKf(C):(m.ULS.sendTraceTag(537154753,0,10,"PasswordProtectedFileModifyInputDialog.OnVerifyPasswordToModifyRequestFailure: VerifyPasswordToModify request failed."),C(3))}};n.prototype.BKf=function(C){--this.HKd;this.DTa(this.passwordToModify,C)};n.prototype.Xqb=
function(){return O.a.Xc(1,0,1645,1646,1,-2019873242,"TooManyWrongPasswordAttemptFileModifyError")};Mf.Object.defineProperties(n.prototype,{Tgc:{configurable:!0,enumerable:!0,get:function(){return this.D8d}},zl:{configurable:!0,enumerable:!0,get:function(){return F.a.instance.ga(1954)}}});Object(u.a)(n,"PasswordProtectedFileModifyPasswordInputDialog",f,[]);var H=b(6);Rk(l,v);l.prototype.erb=function(C){this.dCd=new n(C);v.prototype.erb.call(this,C)};l.prototype.HFb=function(C,Q){var P=C.Zrb,ka=C.Tgc,
R=C.passwordToModify;v.prototype.HFb.call(this,C,Q);this.ki.Jxa([2001366804]);switch(P){case 1:ka?(Q=Object(B.a)(4,this.ki.ue),this.ki.activityState[z.a.Qje]=w.a.$e(R),this.ki.activityState[z.a.WXa]=!0,C.passwordToModify="",this.kh(Q.isEditMode?H.a.Ej:this.kM)):m.ULS.sendTraceTag(537154757,0,50,"PasswordProtectedFileModifyActivity.PasswordProtectedFilePasswordInputDialogDisposing: Unexpected State , Dialog disposed but password not verified.");this.$o();break;case 0:this.ki.activityState[z.a.As]=
!1;this.kh(this.FJ);this.$o();break;default:m.ULS.sendTraceTag(537154756,0,50,"PasswordToModifyFileModifyActivity.OnPasswordInputCommited: unhandled user response '{0}'",P)}};Object(u.a)(l,"PasswordProtectedFileModifyActivity",v,[]);var K=y.a;Rk(k,K);k.prototype.create=function(){this.pb(new l(this.activityName,this.kM,this.FJ))};k.ka=function(C){C.da.Ga(434,new k(H.a.GFb,H.a.oeb,H.a.OGa,C))};Object(u.a)(k,"PasswordProtectedFileModifyActivityFactory",y.a,[]);var N=b(42);Rk(e,f);e.prototype.DTa=function(C,
Q){this.password=C;Q(0)};e.prototype.e3=function(){var C=f.prototype.e3.call(this);this.ghf&&(C[D.a.plh]=1);return C};e.prototype.rg=function(){m.ULS.sendTraceTag(537154722,0,50,"PasswordProtectedFileOpenPasswordInputDialog.InitializeAndShowDialog: Initializing dialog. isWrongPassword={0}",this.ghf);f.prototype.rg.call(this);N.a(this.$).Zne()};Object(u.a)(e,"PasswordProtectedFileOpenPasswordInputDialog",f,[]);Rk(d,v);d.prototype.erb=function(C){var Q=O.a.Zg(this.ki.errors,[1217361942]);this.dCd=new e(C,
Q);C.dfc||C.JGe();v.prototype.erb.call(this,C)};d.prototype.HFb=function(C,Q){var P=C.password;C.password="";var ka=C.Zrb;v.prototype.HFb.call(this,C,Q);this.ki.activityState[z.a.nTc]=w.a.$e(P);this.ki.activityState[z.a.WXa]=!0;this.ki.Jxa([110414285,1217361942]);m.ULS.sendTraceTag(537154752,0,50,"PasswordProtectedFileOpenActivity.PasswordProtectedFileOpenPasswordInputDialogDisposing: user response: {0}",ka);switch(ka){case 1:this.kh(this.kM);this.$o();break;case 0:this.kh(this.FJ),this.$o()}};Object(u.a)(d,
"PasswordProtectedFileOpenActivity",v,[]);var M=y.a;Rk(c,M);c.prototype.create=function(){this.pb(new d(this.activityName,this.kM,this.FJ))};c.ka=function(C){C.da.Ga(386,new c(H.a.Zoc,H.a.Ej,H.a.Dk,C))};Object(u.a)(c,"PasswordProtectedFileOpenActivityFactory",y.a,[]);b.d(E,"a",function(){return a})},1388:function(u,E,b){function a(){Type.registerNamespace("Common.App.SaveToCloudStorage");c.main()}function c(){this.fb=null}function d(J){this.ib=J;this.dFa=J.appSettings.SkyDriveUploadWebServiceBase;
this.dA=J.appSettings.FileName;this.lfa=J.Wa("SkyDriveUploadHandler")||"skydriveuploadhandler.ashx"}function e(J,H,K,N,M,C,Q){this.cFa=J;this.dA=H;this.pVa=K;this.BSb=N;this.xOc=M;this.lfa=C;this.xh=Q}function k(J,H,K){this.La=J;this.P1=H;this.sX=K}function l(J,H,K){var N=D.call(this)||this;N.La=J;N.P1=H;N.sX=K;N.yv=!1;N.Rb=1;N.k7(1);N.mc(1,CommonUIStrings.l_SignIn);N.mc(0,CommonUIStrings.l_SignInToSaveDialogCancelButton);return N}function n(){var J=v.call(this)||this;J.Rb=0;J.mc(1,CommonUIStrings.l_DialogClose);
return J}u=b(0);var f=b(135),v=f.StandardDialog;Rk(n,v);n.prototype.displayError=function(J){this.Iz(J,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,null)};Object(u.a)(n,"ErrorDialog",f.StandardDialog,[680]);var r=b(1257),y=b(1254),m=b(14),w=b(84),B=b(4),A=b(260),z=b(39),x=b(25),D=f.StandardDialog;Rk(l,D);l.prototype.YP=function(){this.P1.hYa(Object(w.a)(this,this.VBf,"onSignIn"));this.ql(CommonUIStrings.l_SignInToSaveDialogTitle,CommonUIStrings.l_SaveToCloudSignInDialog,
0,Object(w.a)(this,this.abi,"inputHandler"))};l.prototype.abi=function(J){0===J?(m.ULS.sendTraceTag(6590598,216,50,"User dismissed SignIn Dialog."),this.hide()):this.y6()};l.prototype.eWg=function(){var J="2";if(this.sX)switch(this.sX.Cj){case 3:J="0";break;case 2:J="3";break;case 1:J="1"}return J};l.prototype.hide=function(){this.P1.QHb(Object(w.a)(this,this.VBf,"onSignIn"));D.prototype.hide.call(this)};l.prototype.y6=function(){var J=new A.QueryStringBuilder("Signin.aspx");J.Ei("prompt","1");J.Ei("cbcxt",
this.eWg());B.AFrameworkApplication.ZXa(J);z.a.Ze(J.toString(),"LoginWindow",void 0,"SignInDialog")};l.prototype.VBf=function(){this.uq&&this.hide();m.ULS.sendTraceTag(7143885,216,50,"User signed in successfully. Calling Savetocloudstorage action handler");this.La.processAction(x.a.saveToCloudStorage,2)};Object(u.a)(l,"SignInDialog",f.StandardDialog,[716]);k.prototype.create=function(){return new l(this.La,this.P1,this.sX)};Object(u.a)(k,"SignInDialogFactory",null,[690]);var I=b(81),F=b(29);e.prototype.execute=
function(J,H){if(!B.AFrameworkApplication.Ag&&B.AFrameworkApplication.qd){var K=this.cFa+this.lfa;K=I.a.wl(K,"fo",F.a.$e(this.BSb));K=I.a.wl(K,"fn",F.a.$e(this.dA));K=I.a.wl(K,"qs",F.a.$e(this.xOc));K=I.a.wl(K,"n",F.a.$e((new Date).getTime().toString()));this.xh&&this.xh.FileDownloadUrl&&(K=I.a.wl(K,"furl",F.a.$e(this.xh.FileDownloadUrl)));this.pVa&&(K=I.a.wl(K,"fnn",F.a.$e(this.pVa)));B.AFrameworkApplication.qd.Yl(K,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,J,H,null)}};Object(u.a)(e,
"SkyDriveUploadCaller",null,[715]);d.prototype.create=function(J,H,K){return new e(this.dFa,this.dA,H,J,B.AFrameworkApplication.Yi,this.lfa,K)};Object(u.a)(d,"SkydriveUploadCallerFactory",null,[689]);var G=b(1255),T=b(254),O=b(623),U=b(995);c.prototype.init=function(){B.AFrameworkApplication.fa.qa("SaveToCloudStorageUIIsEnabled")&&this.fb.resolve("Common.App.SaveToCloudStorage.SaveToCloudStorageActor").Bg()};c.prototype.dispose=function(){};c.prototype.Ph=function(J){this.fb=J;this.fb.register(k,
"Common.App.SaveToCloudStorage.SignInDialogFactory").as("Common.App.SaveToCloudStorage.ISignInDialogFactory").Cc(function(){return new k(B.AFrameworkApplication.ub,O.a.instance,B.AFrameworkApplication.ta.Qa)}).tc();this.fb.register(d,"Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory").as("Common.App.SaveToCloudStorage.ISkydriveUploadCallerFactory").Cc(function(){return new d(B.AFrameworkApplication.fa)}).tc();this.fb.register(y.a,"Common.App.SaveToCloudStorage.SaveToCloudStorageActor").Cc(function(){return new y.a(J.resolve("Common.App.SaveToCloudStorage.SaveToCloudManager"),
J.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),B.AFrameworkApplication.fa,B.AFrameworkApplication.ta.pD)}).tc();this.fb.register(G.a,"Common.App.SaveToCloudStorage.UploadToCloudManager").Cc(function(){return new G.a(J.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),function(){return(new U.a).create()},function(){return new n},B.AFrameworkApplication.ta,B.AFrameworkApplication.ta.pD)}).tc();this.fb.register(r.a,"Common.App.SaveToCloudStorage.SaveToCloudManager").Cc(function(){return new r.a(J.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),
O.a.instance,J.resolve("Common.App.SaveToCloudStorage.UploadToCloudManager"),B.AFrameworkApplication.fa,B.AFrameworkApplication.M1a,function(){return new n})}).tc()};c.main=function(){T.a.instance.Qi(new c)};Mf.Object.defineProperties(c.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.SaveToCloudStorage"}}});Object(u.a)(c,"PackageManager",null,[10,11]);b.d(E,"a",function(){return a})},1396:function(u,E,b){function a(){this.Vib=!!r.AFrameworkApplication.ta&&r.AFrameworkApplication.ta.Qa.Vu}
function c(x,D,I){var F=k.call(this,x,D,I)||this;x={};x=(x.errorMessage=F.fLe,x.errorFileDownloadOffer=F.Xsb,x);D={};x.helpLink=(D.type="AppLinkProps",D.id="helpLink",D.text=F.Gva,D.onExecute=function(G){F.ZNa(G)},D);D=new z.a(!1,!1,!0);D.Rb=1;D.mc(1,F.Ysb);D.ye=F.id;I={};x=(I.id=F.id,I.dialogIcon=F.icon,I.bodyControls=x,I);D.initializeAndShow(F.zl,Object(f.a)(F,F.IFd,"reactOICErrorDialogHandler"),x);return F}function d(x,D,I,F){var G=n.call(this,x,D,I,F)||this;x={};x=(x.errorMessage=G.errorMessage,
x);D={};x.helpLink=(D.type="AppLinkProps",D.id="helpLink",D.text=G.Gva,D.onExecute=function(T){G.ZNa(T)},D);G.Cwc?(x.macOfficePreLinkText=G.Dnf,D={},x.macOfficeLink=(D.type="AppLinkProps",D.id="macOfficeLink",D.text=G.Anf,D.onExecute=function(T){G.$xd(T)},D),x.macOfficePostText=G.Cnf):G.t3b&&(x.errorFileDownloadOffer=G.Xsb);D=new z.a(!1,!1,!0);G.t3b?(D.Rb=1,D.mc(1,G.Ysb)):D.Rb=0;D.ye=G.id;I={};x=(I.id=G.id,I.dialogIcon=G.icon,I.bodyControls=x,I);D.initializeAndShow(G.zl,Object(f.a)(G,G.IFd,"reactOICErrorDialogHandler"),
x);return G}function e(x,D,I){x=k.call(this,x,D,I)||this;x.Ul=null;D=document.createElement("span");D.id="errorMessageText";D.innerText=x.fLe;D.appendChild(document.createElement("br"));D.appendChild(document.createElement("br"));x.Ul=document.createElement("a");x.Ul.href="#";x.Ul.innerText=x.Gva;D.appendChild(x.Ul);B.a.addHandler(x.Ul,"click",Object(f.a)(x,x.ZNa,"oicErrorHelpLinkHandler"));D.appendChild(document.createElement("br"));D.appendChild(document.createElement("br"));I=document.createElement("span");
I.innerText=x.Xsb;D.appendChild(I);I=new A.StandardDialog;I.ye=x.id;I.Rb=1;I.mc(1,x.Ysb);I.ql(x.zl,null,x.icon,Object(f.a)(x,x.ksd,"legacyOICErrorDialogHandler"),D);I.PW("errorMessageText");return x}function k(x,D,I){this.KX=D;this.LX=x;this.vD=I}function l(x,D,I,F){x=n.call(this,x,D,I,F)||this;x.Ul=null;x.qqa=null;D=document.createElement("span");D.id="errorMessageText";D.innerText=x.errorMessage;D.appendChild(document.createElement("br"));D.appendChild(document.createElement("br"));x.Ul=document.createElement("a");
x.Ul.href="#";x.Ul.innerText=x.Gva;D.appendChild(x.Ul);B.a.addHandler(x.Ul,"click",Object(f.a)(x,x.ZNa,"oicErrorHelpLinkHandler"));I=new A.StandardDialog;I.ye=x.id;if(x.Cwc){F=document.createElement("span");var G=document.createElement("span");F.innerText=x.Dnf;G.innerText=x.Cnf;x.qqa=document.createElement("a");x.qqa.href="#";x.qqa.innerText=x.Anf;D.appendChild(document.createElement("br"));D.appendChild(F);D.appendChild(x.qqa);D.appendChild(G);B.a.addHandler(x.qqa,"click",Object(f.a)(x,x.$xd,"oicErrorMacOfferLinkHandler"))}else x.t3b&&
(D.appendChild(document.createElement("br")),D.appendChild(document.createElement("br")),F=document.createElement("span"),F.innerText=x.Xsb,D.appendChild(F));x.t3b?(I.Rb=1,I.mc(1,x.Ysb)):I.Rb=0;I.ql(x.zl,null,x.icon,Object(f.a)(x,x.ksd,"legacyOICErrorDialogHandler"),D);I.PW("errorMessageText");return x}function n(x,D,I,F){this.lMc=null;this.NRb=F;this.KX=x;this.LX=D;this.vD=I;this.Ffe=this.Bnf.vwj;x=CommonUIStrings.l_OICErrorMacOfficeOffer.split("{0}");this.Srg=x[0];this.Rrg=x[1]}u=b(0);var f=b(84),
v=b(14),r=b(4),y=b(52),m=b(442),w=b(83);n.prototype.IFd=function(x){this.EDb(x)};n.prototype.ksd=function(x){this.EDb(x)};n.prototype.EDb=function(x){var D=10;this.LX&&1===x&&(this.LX(this.vD),D=1);this.KX&&this.KX(this.vD);this.DF(D)};n.prototype.ZNa=function(){m.Redirect.showHelp("OICFailure");this.DF(2)};n.prototype.$xd=function(){this.Bnf.ajf();this.DF(4)};n.prototype.DF=function(x){v.ULS.sendTraceTag(18715410,211,10,"Report OICErrorDialog. Dialog cause: {0}, solution: {1}",this.NRb,x);r.AFrameworkApplication.Osc(y.a.PDf,
this.NRb,x)};n.prototype.dispose=function(){this.vD=this.KX=this.LX=null};Mf.Object.defineProperties(n.prototype,{Bnf:{configurable:!0,enumerable:!0,get:function(){return this.lMc||(this.lMc=w.a.instance.resolve("Common.IMacOfficeOffer"))}},id:{configurable:!0,enumerable:!0,get:function(){return"OICErrorDialog"}},errorMessage:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorMessage}},Gva:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorHelpLink}},
Cwc:{configurable:!0,enumerable:!0,get:function(){return this.Ffe}},Dnf:{configurable:!0,enumerable:!0,get:function(){return this.Srg}},Cnf:{configurable:!0,enumerable:!0,get:function(){return this.Rrg}},Anf:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorMacOFficeLink}},icon:{configurable:!0,enumerable:!0,get:function(){return this.Ffe?3:2}},Xsb:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorFileDownloadOffer}},t3b:{configurable:!0,enumerable:!0,
get:function(){return!!this.LX}},Ysb:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}},zl:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_DefaultDialogTitle}}});Object(u.a)(n,"AOICErrorDialog",null,[3]);var B=b(43),A=b(135);Rk(l,n);l.prototype.dispose=function(){this.Ul&&(B.a.removeHandler(this.Ul,"click",Object(f.a)(this,this.ZNa,"oicErrorHelpLinkHandler")),this.Ul=null);this.qqa&&(B.a.removeHandler(this.qqa,"click",Object(f.a)(this,
this.$xd,"oicErrorMacOfferLinkHandler")),this.qqa=null);n.prototype.dispose.call(this)};Object(u.a)(l,"OICErrorDialog",n,[]);k.prototype.IFd=function(x){this.EDb(x)};k.prototype.ksd=function(x){this.EDb(x)};k.prototype.EDb=function(x){var D=10;1===x&&(this.LX(this.vD),D=1);this.KX&&this.KX(this.vD);this.DF(D)};k.prototype.ZNa=function(){m.Redirect.showHelp("OICFailure");this.DF(2)};k.prototype.DF=function(x){r.AFrameworkApplication.Osc(y.a.QDf,3,x)};k.prototype.dispose=function(){this.vD=this.LX=
this.KX=null};Mf.Object.defineProperties(k.prototype,{id:{configurable:!0,enumerable:!0,get:function(){return"OICErrorDialogWithDownload"}},fLe:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorNoOfficeDetected}},Gva:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorHelpLink}},Xsb:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorFileDownloadOffer}},Ysb:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}},
icon:{configurable:!0,enumerable:!0,get:function(){return 2}},zl:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_DefaultDialogTitle}}});Object(u.a)(k,"AOICErrorDialogWithDownload",null,[3]);Rk(e,k);e.prototype.dispose=function(){this.Ul&&(B.a.removeHandler(this.Ul,"click",Object(f.a)(this,this.ZNa,"oicErrorHelpLinkHandler")),this.Ul=null);k.prototype.dispose.call(this)};Object(u.a)(e,"OICErrorDialogWithDownload",k,[]);var z=b(150);Rk(d,n);Object(u.a)(d,"ReactOICErrorDialog",
n,[]);Rk(c,k);Object(u.a)(c,"ReactOICErrorDialogWithDownload",k,[]);b.d(E,"a",function(){return a});a.prototype.H7g=function(x,D,I){this.Vib?new d(x,D,null,I):new l(x,D,null,I)};a.prototype.I7g=function(x,D,I){this.Vib?new c(x,D,I):new e(x,D,I)};a.prototype.J7g=function(x,D,I,F,G){var T=b(1539).ReactOICErrorDialogWithTrial,O=b(1540).OICErrorDialogWithTrial;this.Vib?new T(x,D,I,null,F,G):new O(x,D,I,null,F,G)};Mf.Object.defineProperties(a,{instance:{configurable:!0,enumerable:!0,get:function(){return a.Ma||
(a.Ma=new a)}}});a.Ma=null;Object(u.a)(a,"OICErrorDialogFactory",null,[404])},1410:function(u,E,b){function a(){Type.registerNamespace("Common.App.SharedFilePicker");c.main()}function c(){this.fb=null}function d(m){this.VKa=this.U$a=null;this._initialized=!1;this.hjd=m}u=b(0);var e=b(14),k=b(84),l=b(4),n=b(167),f=b(391),v=b(170),r;(function(m){m[m.myFiles=0]="myFiles";m[m.recent=1]="recent";m[m.currentFolder=2]="currentFolder";m[m.yourPhone=3]="yourPhone"})(r||(r={}));Object(u.b)("SharedFilePickerLandingLocation",
r);d.prototype.I1a=function(m){this._initialized||(m.Tn(v.a.JLf),m.Ml(v.a.JLf,Object(k.a)(this,this.KPi,"onReceivedPickerResponse")),this._initialized=!0)};d.prototype.fdd=function(m){var w=this;return this.VKa=new Promise(function(B,A){var z={};z[f.a.tXi]=m;w.U$a=function(x,D){""===D?(e.ULS.sendTraceTag(572548163,306,50,"Resolving Promise with Picker Data"),B(x)):("Canceled"===D?e.ULS.sendTraceTag(572548164,306,50,D):e.ULS.sendTraceTag(556901065,306,10,D),A(D))};w.hjd.execute(function(x){w.I1a(x);
x.uj(v.a.CUi,z)})})};d.prototype.KPi=function(m){this.U$a(m.Values[f.a.llj],void 0===m.Values[f.a.BCd]||null===m.Values[f.a.BCd]?"":m.Values[f.a.BCd])};d.prototype.Gpd=function(){return l.AFrameworkApplication.fa.qa("UiHostCommonFilePicker")};d.prototype.GCe=function(m,w,B,A,z,x,D){var I=void 0===I?null:I;var F={};F[f.a.Ykj]=m;F[f.a.titleText]=w;F[f.a.xIg]=B;F[f.a.yIg]=A;F[f.a.zIg]=!1;F[f.a.Afh]=!0;F[f.a.Tyh]=z;F[f.a.xXi]=x;F[f.a.wXi]=r[D];n.a("isSharedUXDarkModeOn")&&appChrome.api.isSharedUXDarkModeOn()&&
(F[f.a.yXi]="Dark");I&&(null!=I.qVc&&(F[f.a.qVc]=I.qVc),null!=I.bkd&&(F[f.a.bkd]=I.bkd));return F};Object(u.a)(d,"SharedFilePickerManager",null,[670]);var y=b(254);c.prototype.Ph=function(m){this.fb=m;m.register(d,"Common.App.SharedFilePicker.SharedFilePickerManager").as("Common.App.SharedFilePicker.ISharedFilePicker").tc().Cc(function(){return new d(m.Tb("Postmessage.IHostPostmessenger"))})};c.prototype.init=function(){var m=this;l.AFrameworkApplication.fa.Su(function(){m.Lxb()})};c.prototype.Lxb=
function(){this.fb.resolve("Common.App.SharedFilePicker.ISharedFilePicker")};c.prototype.dispose=function(){};c.main=function(){y.a.instance.Qi(new c)};Mf.Object.defineProperties(c.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.SharedFilePicker"}}});Object(u.a)(c,"SharedFilePickerPackage",null,[10,11]);b.d(E,"a",function(){return a})},1411:function(u,E,b){function a(){k.a.Fa(c.ka)}function c(T){return G.call(this,T)||this}function d(T,O){this.$=T;this.gridView=O}function e(T,
O,U){var J=I.call(this,T)||this;J.smb=0;J.Kyb=!1;J.f1a=null;J.VGe=!1;J.Kqb=!0;J.WSc=null;J.zl=null;J.Kwd=0;J.Lwd=null;J.Jwd=null;J.removeHyperLink=!1;J.cellValue=null;J.location=null;J.O6h=function(H,K){1===H||2===H?(r.ULS.sendTraceTag(555755670,0,50,"HyperLink {0} pressed",1===H?"OK":"Remove"),J.Lwd=K[e.Mri],J.Kwd=K[e.jlj],J.Jwd=K[e.Kfh],2===H&&(J.removeHyperLink=!0),J.commit()):r.ULS.sendTraceTag(537157644,0,50,"HyperLink Cancel pressed")};J.PUj=function(H,K){return 0!==K&&H.length?1===K?J.OXe(f.y(H,
J.ea.va)||J.ABi(H),763):J.OXe(y.a.Pmd(H),765):null};J.selectedRange=O;J.KL=U;J.ea=T.ea;J.sheetName=O.SheetName;J.kLa();J.pn();J.Rb=J.Kyb?9:1;J.mc(1,D.a.instance.ga(4));J.Kyb&&J.mc(2,D.a.instance.ga(766));T={};T=(T[e.Teh]=J.VGe,T[e.Lfh]=J.f1a,T[e.lzg]=J.smb,T[e.mzg]=J.WSc,T[e.d3g]=J.Kqb,T);O={};T=(O[e.Vv]=J.nc,O[e.QUj]=J.PUj,O[e.iOg]=T,O);J.initializeAndShow(J.zl,J.O6h,T);return J}var k=b(10);u=b(0);var l=b(905),n=b(21),f=b(45),v=b(1),r=b(14),y=b(29),m;(function(T){T[T.url=0]="url";T[T.ref=1]="ref";
T[T.mailto=2]="mailto"})(m||(m={}));Object(u.b)("HyperlinkSelectionState",m);var w=b(982),B=b(8),A=b(646),z=b(62),x=b(98),D=b(15),I=w.a;Rk(e,I);e.prototype.uZe=function(T,O){switch(O){case 2:return T.startsWith("mailto:")?T:"mailto:"+T;case 1:return String.format("{0}{1}",B.a.HGf,this.JQh(T));default:return T}};e.prototype.Jy=function(){var T=this,O=this.$;this.location=this.uZe(this.Lwd,this.Kwd);try{this.location=x.a.qh(this.location)}catch(H){r.ULS.sendTraceTag(537157643,0,15,"Decoding link text failed")}r.ULS.sendTraceTag(555755667,
0,50,"Committing {0} link",m[this.Kwd]);this.cellValue=this.Jwd.length?this.Jwd:this.Lwd;O.ly();var U=O.oa.xa.Pb(),J=f.s(this.selectedRange);return function(H,K,N){return z.b(O.oa.xa,J,T.cellValue,T.location,T.removeHyperLink,!1,123,H,K,N,T.KL.range,U)}};e.prototype.Zi=function(){var T=this,O=f.s(this.selectedRange);return function(){return new A.a(O,T.cellValue,T.location)}};e.prototype.xxh=function(){var T=this.KL.cell.V4a;this.KL.cell.Ewb?T&&T.startsWith("mailto:")?(this.smb=2,T=T.substr(7)):this.smb=
0:this.smb=1;return T};e.prototype.kLa=function(){v.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")?this.Kyb=this.KL.Yaa:this.Kyb=!!this.KL.UJa(64)||!!this.KL.UJa(128)};e.prototype.pn=function(){if(this.Kyb){this.f1a=this.KL.text;var T=this.xxh();T&&(this.WSc=T);this.zl=D.a.instance.ga(826);this.Kqb=this.WSc===this.f1a}else this.KL.text?(this.f1a=this.KL.text,this.Kqb=!1):(this.f1a="",this.Kqb=!0),this.smb=0,this.zl=D.a.instance.ga(825);this.KL.ME&&(this.Kqb=!1,this.VGe=!0,v.EwaSettings.isChangeGateEnabled("OfficeVSO:5533269_formulaTextFixInHyperLink")&&
(this.f1a=this.KL.formulaBarText))};e.prototype.ABi=function(T){return this.ea.vb.Jj(T)};e.prototype.OXe=function(T,O){return T?null:D.a.instance.ga(O)};e.prototype.JQh=function(T){var O=f.Z(T,this.ea.va);var U=O.sheetName;var J=O.range;O.returnValue&&J&&(T=f.x(J,U||this.sheetName,!1));return T};Mf.Object.defineProperties(e.prototype,{nc:{configurable:!0,enumerable:!0,get:function(){return"HyperLinkDialog"}},sv:{configurable:!0,enumerable:!0,get:function(){return 526}}});e.QUj="validateLinkValues";
e.iOg="bodyProps";e.Teh="disableDisplayText";e.Lfh="displayTextValue";e.lzg="activeLinkOption";e.mzg="activeLinkValue";e.d3g="copyLinkValueToDisplay";e.Mri="linkValue";e.jlj="selectedLink";e.Kfh="displayText";Object(u.a)(e,"HyperlinkDialog",w.a,[]);var F=b(58);d.prototype.Lc=function(){return!1};d.prototype.zc=function(T,O){return 1===T&&-1583422759===O.command};d.prototype.Qc=function(){return!1};d.prototype.executeCommand=function(){this.uzj();return F.Task.Ua(!0)};d.prototype.uzj=function(){var T=
f.v(this.gridView.ha.sa.Vc,this.$),O=n.e(this.gridView);(!v.EwaSettings.isChangeGateEnabled("OfficeVSO:5639309_CheckedProtectedRangeUnlockStateWhenInsertHyperlink")||this.$.hq([this.gridView.ha.sa.Vc],!0))&&O&&new e(this.$,T,O)};Object(u.a)(d,"ShowHyperlinkCommandHandler",null,[429]);var G=l.a;Rk(c,G);c.prototype.Ad=function(){this.jd([new d(this.$,n.g(this.$))])};c.ka=function(T){l.a.Qd(105,new c(T))};Object(u.a)(c,"ShowHyperlinkCommandHandlerFactory",l.a,[]);b.d(E,"a",function(){return a})},1412:function(u,
E,b){function a(){l.a.Fa(e.ka);l.a.Fa(c.ka)}function c(F){var G=I.call(this)||this;G.$=F;G.Eb();return G}function d(F,G){this.$=F;this.oi=G;this.$.da.Ga(393,this)}function e(F){var G=x.call(this,F)||this;G.qCh=function(T,O,U,J,H){return 1===U?32:T===A.a.CQa&&2===U?(T=G.$.oa.xa.Pb(),r.D(G.$.oa.xa,H[0],H[1],null,null,T),32):8};return G}function k(F,G){this.$=F;this.oi=G}var l=b(10);u=b(0);var n=b(4),f=b(107),v=b(905),r=b(62),y=b(51),m=b(37),w=b(14),B=b(186),A=b(25),z=b(58);k.prototype.Lc=function(){return!1};
k.prototype.executeCommand=function(F,G,T){F=2;switch(G.command){case -309686558:F=this.oi.$d(A.a.saveACopy,2,T);break;case 617689800:F=this.oi.$d(A.a.saveToCloudStorage,2,T);break;case -1244760097:F=this.oi.$d(A.a.saveToSharePoint,2,T)}return 2===F&&G?B.a(G.command):z.Task.Ua(!0)};k.prototype.zc=function(F,G){F=!1;switch(G.command){case -1244760097:case -309686558:case 617689800:F=!0,w.ULS.shipAssertTag(537153984,0,this.$.ika,"Command execute requested for SaveAs operation when data duplication is disallowed.")}return F};
k.prototype.Qc=function(){return!1};Object(u.a)(k,"SaveToHostCommandHandler",null,[429]);var x=v.a;Rk(e,x);e.prototype.Ad=function(){var F=this;m.TaskExtensions.Aa(y.GetServiceTaskFactory.create(this.$.da,155,this.la,this.hb),function(){F.jd([new k(F.$,n.AFrameworkApplication.ub)])},this.la,3);n.AFrameworkApplication.ub.Mb(A.a.CQa,f.a.frame,this.qCh)};e.ka=function(F){v.a.Qd(267,new e(F))};Object(u.a)(e,"SaveToHostCommandHandlerFactory",v.a,[]);var D=b(232);d.prototype.Lc=function(F){switch(F){case -309686558:return 8===
this.oi.processAction(A.a.saveACopy,1,null);case 617689800:return 8===this.oi.$d(A.a.saveToCloudStorage,1,null);case -1244760097:return 8===this.oi.$d(A.a.saveToSharePoint,1,null)}return!1};d.prototype.dispose=function(){this.$=null};Object(u.a)(d,"SaveToHostManager",null,[646,3]);var I=D.a;Rk(c,I);c.prototype.create=function(){this.pb(this.$.da.za(393)||new d(this.$,n.AFrameworkApplication.ub))};c.ka=function(F){F.da.Ga(394,new c(F))};Object(u.a)(c,"SaveToHostManagerFactory",D.a,[]);b.d(E,"a",function(){return a})},
1413:function(u,E,b){function a(){l.a.Fa(function(N){e.ka(N);c.ka(N)})}function c(N,M){var C=K.call(this)||this;C.activityName=N;C.kM=M;C.Eb();return C}function d(N,M,C,Q,P){N=H.call(this,N,M)||this;d.Aud=[-1468309555,611268539,-2087635043,2100961153,810218235,1112506702];d.zud=[-1468309555,-315732528,-399065540,810218235,1531005923,1593924569,1112506702,1220851643];d.vnf=[-1468309555,611268539,-1750576502,61029505];d.unf=[-1468309555,-315732528,1112506702,-238814601,-1750576502,61029505,-1337545025];
N.vxc=C;N.gBj=Q;N.nKj=P;return N}function e(){var N=A.call(this)||this;N.Eb();return N}function k(N,M){return w.call(this,N,M)||this}var l=b(10);u=b(0);var n=b(232),f=b(14),v=b(85),r=b(115),y=b(31),m=b(35),w=r.a;Rk(k,w);k.prototype.execute=function(N){var M=Object(v.a)(4,N.ue);f.ULS.shipAssertTag(537153921,0,y.a.Nnb(N.errors),"SessionReloadActivity.Execute: Only recoverable errors should reach this activity.");M.XH(!0,!0);N.activityState[m.a.pYb]=M.ea.sessionId;N.activityState[m.a.vmb]=!0;N.activityState[m.a.vYb]=
!0;f.ULS.sendTraceTag(537153920,0,50,"SessionReloadActivity.Execute: session is going to reopen from cached state");return 3};Object(u.a)(k,"SessionReloadActivity",r.a,[]);var B=b(6),A=n.a;Rk(e,A);e.prototype.create=function(){this.pb(new k(B.a.bcb,B.a.Ek))};e.ka=function(N){N.da.Ga(142,new e)};Object(u.a)(e,"SessionReloadActivityFactory",n.a,[]);var z=b(54),x=b(280),D=b(110),I=b(47),F=b(44),G=b(34),T=b(1),O=b(46),U=b(252),J=b(116),H=r.a;Rk(d,H);d.prototype.execute=function(N){var M=Object(v.a)(4,
N.ue);N.activityState[m.a.vra]=!0;var C=d.$Wh(N);if(d.pvj(N,C))return d.hyi(N),C=50,0<N.errors.length&&(C=15),f.ULS.sendTraceTag(537153891,0,C,"SessionReloadSilentActivity.ShouldCancelReload: ignore session reload, remaining errors : {0}",y.a.Ec(N.errors)),N.activityState[m.a.vra]=!1,this.kh(B.a.idle),3;switch(C){case 1:case 3:this.Sai(N,C);break;case 2:this.Rai(N);break;case 0:N.activityState[m.a.XXa]=null}f.ULS.sendTraceTag(21837003,0,50,"SessionReloadSilentActivity.Execute: silentReloadType:{0}. activityName:{1}. NextActivityName:{2}. TimeFromLastStatefulResponse:{3}.",
C,this.activityName,this.w_,M.ea.L0);var Q=G.a.wg(N.activityState,J.a.reb);f.ULS.shipAssertTag(40502925,0,!Q||Q&&(1===C||3===C),"triggerSilentReloadAfterTokenRefresh: {0}, silentReloadType: {1}",Q,C);M=M.Nk.reloadCount;return 0!==C&&0<M?(Q=x.a.jva(M,200),f.ULS.sendTraceTag(537153890,0,50,"SessionReloadSilentActivity.Execute: schedule Silent-Type [{0}] retryNum [{1}] delayInMs [{2}] activityName [{3}]",C,M,Q,this.activityName),I.a.instance.create(function(){d.eM(N)},Q,F.a.unj),1):3};d.prototype.Sai=
function(N,M){f.ULS.sendTraceTag(8438495,0,50,"SessionReloadSilentActivity.InitiateSilentReopen: Silent reopen triggered");var C=Object(v.a)(4,N.ue);N.activityState[m.a.vmb]=!0;C.dfc||O.PageLoadTrackingInfo.instance.kj("ReopenOnLoad");!d.isEditMode(N)&&y.a.Nnb(N.errors)&&(f.ULS.sendTraceTag(537153889,0,50,"SessionReloadSilentActivity.ShouldAttemptViewSilentReopen: session is going to reopen from cached state"),N.activityState[m.a.pYb]=C.ea.sessionId,N.activityState[m.a.vYb]=!0);N.Qud();3===M?(C.ea.jg()||
C.ea.KDi(),C.XH(!0,!0),this.kh(this.nKj),N.activityState[m.a.Gje]=C.workbookContext.CalcMode):(T.EwaSettings.isChangeGateEnabled("OfficeVSO:5678588_FixSilentReopenAfterTokenRefresh")&&1===M&&C.XH(!0,!0),N.activityState[m.a.fTc]=!1,this.kh(this.vxc))};d.prototype.Rai=function(N){f.ULS.sendTraceTag(537153888,0,15,"SessionReloadSilentActivity.InitiateSilentRefresh: Silent refresh triggered");N.activityState[m.a.XXa]=null;N.Qud();this.kh(this.gBj);N=Object(v.a)(4,N.ue);N.dfc||(O.PageLoadTrackingInfo.instance.kj("RefreshOnLoad"),
N.wIb())};d.eM=function(N){N.eM()};d.$Wh=function(N){var M=Object(v.a)(4,N.ue),C=M.ea,Q=d.isEditMode(N),P=y.a.Zg(N.errors,Q?d.zud:d.Aud),ka=y.a.Zg(N.errors,Q?d.unf:d.vnf),R=M.IQ,fa=M.Nk.reloadCount,ca=M.ya.MaxConsecutiveSilentReloadAllowed,ea=M.Nk.R5e(),wa=y.a.Ec(N.errors),X=y.a.Ec(N.cza),ja=0<y.a.pM(function(Xa){return!Xa.triggerSilentReopenOnly},N.errors).length,va=P,ua=G.a.wg(N.activityState,J.a.reb);ua&&(va=!0);P={name:"SessionReloadSilentActivity.GetSilentReloadType",editMode:Q,isSilentReopenError:P,
isSilentRefreshError:ka};P.reloadSequenceCount=M.Nk.MPa;P.reloadCount=fa;P.maxReloads=ca;P.stopSilentReloads=ea;P.errorNames=wa;P.processedErrorNames=X;P.isClientDirty=R;P.errorsForSilentReopenOnly=ja;P.triggerSilentReloadAfterTokenRefresh=ua;P.IsReopenDisabled=M.kMa;R=z.a.xc(P);f.ULS.sendTraceTag(21837004,0,50,R);if(!ea){if(va&&(Q?d.gvj(N):d.ivj(N)))return U.a.F0f(N,M)?3:M.kMa?2:1;if(ka&&(Q||!C.pab))return 2}return 0};d.pvj=function(N,M){for(var C=bk(N.errors),Q=C.next();!Q.done;Q=C.next())if(Q=
Q.value,-1337545025===Q.MessageId||-238814601===Q.MessageId)return!1;return y.a.pM(function(P){return!P.triggerSilentReopenOnly},N.errors).length?3!==M:!1};d.hyi=function(N){var M=y.a.pM(function(Q){return!Q.triggerSilentReopenOnly},N.errors);M=bk(M);for(var C=M.next();!C.done;C=M.next())N.bla(C.value)};d.isEditMode=function(N){var M=Object(v.a)(4,N.ue);return M.ea.dc?M.Tu&&!!(M.Cd&64):G.a.wg(N.activityState,m.a.As)};d.ivj=function(N){var M=Object(v.a)(4,N.ue),C=y.a.laa(N.errors,d.Aud);if(D.b(C,function(Q){return Q.ForceVersionUpgrade}))return!1;
N=y.a.Nnb(N.errors);return!M.ea.pab||N?!0:!1};d.gvj=function(N){N=y.a.laa(N.errors,d.zud);return!D.b(N,function(M){return M.ForceVersionUpgrade})};d.Aud=null;d.zud=null;d.vnf=null;d.unf=null;Object(u.a)(d,"SessionReloadSilentActivity",r.a,[]);var K=n.a;Rk(c,K);c.prototype.create=function(){this.pb(new d(this.activityName,this.kM,B.a.Ek,B.a.gj,B.a.sNb))};c.ka=function(N){N.da.Ga(143,new c(B.a.gna,B.a.h0b));N.da.Ga(144,new c(B.a.bvc,B.a.FOa));N.da.Ga(145,new c(B.a.cvc,B.a.iBd));N.da.Ga(154,new c(B.a.ccb,
B.a.AO))};Object(u.a)(c,"SessionReloadSilentActivityFactory",n.a,[]);b.d(E,"a",function(){return a})},1427:function(u,E,b){function a(){k.a.Fa(c.ka)}function c(F,G,T,O){var U=I.call(this)||this;U.activityName=F;U.kM=G;U.FJ=T;U.$=O;U.Eb();return U}function d(F,G,T){var O=D.call(this,F,G)||this;O.ki=null;O.vri=function(U){var J=O.ns.fd,H=Object(f.a)(4,J.ue);var K=U.Zrb;O.unsubscribe(function(C){U.remove_disposing(C)});for(var N=0,M=J.errors.length;N<M;N++)-573864504===J.errors[N].MessageId&&J.bla(J.errors[N]);
switch(K){case 1:H.ea.lAc=!0;n.ULS.sendTraceTag(537155485,0,50,"LegacySharedWorkbookActivity.LegacySharedDialogDisposing: User has selected to turn off the Legacy Shared Workbook setting ");O.kh(H.isEditMode?z.a.sNb:O.bch);O.$o();break;case 2:O.kh(z.a.openInExcelClient);O.$o();break;case 0:J.activityState[x.a.As]=!1,O.kh(O.FJ),O.$o()}};O.bch=G;O.FJ=T;return O}function e(F,G){F=A.call(this,F,G)||this;F.zpa=0;F.pr();return F}var k=b(10);u=b(0);var l=b(232),n=b(14),f=b(85),v=b(249),r=b(330),y=b(31),
m=b(15),w=b(399),B=b(98),A=w.a;Rk(e,A);e.prototype.hO=function(F,G){this.zpa=F;A.prototype.hO.call(this,F,G)};e.prototype.pr=function(){A.prototype.pr.call(this);this.Rb=9;var F=this.BQh();this.mc(1,m.a.instance.ga(1644));this.mc(2,m.a.instance.ga(986));this.ql(m.a.instance.ga(705),B.a.qh(F),this.icon,this.B0)};e.prototype.BQh=function(){return String.format(m.a.instance.ga(706))};Mf.Object.defineProperties(e.prototype,{nc:{configurable:!0,enumerable:!0,get:function(){return"SharedWorkbookDialog"}},
Zrb:{configurable:!0,enumerable:!0,get:function(){return this.zpa}}});Object(u.a)(e,"LegacySharedWorkbookDialog",w.a,[]);var z=b(6),x=b(35),D=v.a;Rk(d,D);d.prototype.initialize=function(F){D.prototype.initialize.call(this,F)};d.prototype.execute=function(F){this.ki=F;this.q5g();return 1};d.prototype.uI=function(F){D.prototype.uI.call(this,F)};d.prototype.q5g=function(){var F=Object(f.a)(4,this.ki.ue),G=y.a.LZa([-573864504]);G[0].HelpDescription=m.a.instance.ga(708);G[0].HelpTopicId=r.a.wri;var T=
new e(F,G[0]);this.subscribe(this.ki,this.vri,function(O){T.add_disposing(O)})};Object(u.a)(d,"LegacySharedWorkbookActivity",v.a,[]);var I=l.a;Rk(c,I);c.prototype.create=function(){this.pb(new d(this.activityName,this.kM,this.FJ))};c.ka=function(F){F.da.Ga(460,new c(z.a.uBb,z.a.oeb,z.a.OGa,F))};Object(u.a)(c,"LegacySharedWorkbookActivityFactory",l.a,[]);b.d(E,"a",function(){return a})},1428:function(u,E,b){function a(){Type.registerNamespace("Common.App.DirectPrint");l.a.instance.Qi(new c)}function c(){this.$3d=
this.fb=null}u=b(0);var d=b(1489),e=b(1490),k=b(4);c.prototype.Ph=function(n){var f=this;this.fb=n;n.register(d.a,"Common.App.DirectPrint.DirectPrintDialogFactory").tc().Cc(function(){return new d.a(k.AFrameworkApplication.ta.aX)});n.register(666,"Common.App.DirectPrint.IDirectPrintManager").tc().Cc(function(){return e.a.create(f.fb)})};c.prototype.init=function(){this.$3d=this.fb.resolve("Common.App.DirectPrint.IDirectPrintManager");this.$3d.start()};c.prototype.dispose=function(){};Mf.Object.defineProperties(c.prototype,
{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.DirectPrint"}}});Object(u.a)(c,"PackageManager",null,[10,11]);var l=b(254);b.d(E,"a",function(){return a})},1461:function(u,E,b){function a(C,Q){var P=M.call(this)||this;P.Pa=new n.a;P.RT=null;P.gHc=[];P.emc=function(){P.$.oa.zLa?P.removeEntry(13):P.Tf(13,null)};P.pya=function(){U.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")&&d.ULS.sendTraceTag(537170243,0,50,"BusinessBar.OnNetworkResumed: removing TransientServerCommunicationFailures BB");
P.removeEntry(21);P.cC(55)&&(d.ULS.sendTraceTag(537170242,0,15,"BusinessBar.OnNetworkResumed: removing NetworkDown BB"),P.removeEntry(55));P.IQf("OnNetworkResumed")};P.di=function(R,fa){R=0;for(var ca=a.lcc().length;R<ca;R++){var ea=a.lcc()[R];P.removeEntry(ea)}fa.context&&0<fa.context.communicationErrorRetryCount&&(d.ULS.sendTraceTag(537170240,0,50,"OnWebMethodSuccess: retry due to previous communication failure succeeded, turning off the TransientServerCommunicationFailures business bar"),P.removeEntry(21));
P.IQf("OnWebMethodSuccess")};P.Jn=function(R,fa){var ca;R=P.nzh(fa.errors);for(var ea=[],wa=0,X=R.length;wa<X;++wa){var ja=R[wa];if(1===ja.Type&&ja.Appearance&32)ea=P.r3h(ja,ea);else if(fa.gnj){d.ULS.sendTraceTag(537170210,0,50,"OnWebMethodError: Server communication failure detected, turning on the TransientServerCommunicationFailures business bar");var va=(null===(ca=fa.context)||void 0===ca?0:ca.stopwatch)?fa.context.stopwatch.qc:-1;5E3>va?d.ULS.sendTraceTag(537170208,0,50,"OnWebMethodError:  communication errors duration is below the min time for notification, skipping raise of business bar (duration = {0}ms).",
va):e.AFrameworkApplication.cgf()||P.UCg(ja,fa.context.methodName)}va=[].concat(ck(a.lcc()));for(var ua=0,Xa=ea.length;ua<Xa;++ua){var aa=ea[ua];P.Tf(aa,ja);Array.remove(va,aa)}ja=0;for(ua=va.length;ja<ua;++ja)P.removeEntry(va[ja])}};P.BEb=function(R,fa){R=0;for(var ca=fa.errors.length;R<ca;++R){var ea=fa.errors[R];e.AFrameworkApplication.cgf()||(U.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")&&d.ULS.sendTraceTag(537170207,0,15,"BusinessBar.OnNetworkDownEvent: adding NetworkDown BB"),
P.Tf(55,ea))}};P.Uc=function(R,fa){P.Fc(R,fa)};P.Fc=function(){var R=P.$.ea;R.dc||R.jg()||(P.pHd(),Array.clear(P.gHc))};P.Yc=function(R,fa){P.$.ea.jg()&&!fa.tV||P.T8e(fa.tV)};P.gFb=function(){var R=P.$.userOperationManager.Zbc();R&&R.operation.flags&1&&P.x2f()};P.Swf=function(){P.x2f()};P.Qf=function(){P.Lwe();P.G2f()};P.oN=function(){if(P.$.g5&&P.$.ea.jg()&&P.$.ea.dc)if(P.$.ea.isEditMode)P.removeEntry(44),P.removeEntry(12),P.removeEntry(29),P.removeEntry(30),P.removeEntry(31),P.removeEntry(32),P.removeEntry(22),
P.removeEntry(56);else{var R=P.$.da.za(331);R&&R.UIa||P.removeEntry(54);P.removeEntry(5)}};P.$=C;P.JYa=Q;P.oLg();e.AFrameworkApplication.qd&&e.AFrameworkApplication.qd.KTc(P);P.TXa=Array(68);for(var ka=0;68>ka;ka++)P.TXa[ka]=null;P.ah=T.EcmaDateClock.instance;P.Whf=P.ah.Jb.getTime();Q&&(Q=C.oa,ka=Q.sf,Q.Ey(P.Jn),Q.Sq(P.di),Q.Rmb(P.emc),Q.hYa(P.emc),U.EwaSettings.isChangeGateEnabled("OfficeVSO:5618594_OfflineModeUXEnabled")||(ka.qFg(P.BEb),ka.$mb(P.pya)),C.ea.Vj(P.Uc),C.ea.zu(P.Qf),C.Tk(P.Yc),C.Bk(P.Fc),
C.ea.o2(P.oN),C.userOperationManager.zr(P.gFb),U.EwaSettings.ma(170)&&C.ea.Jg.get(45)&&e.AFrameworkApplication.fa.qa("SupportsPolicies")||P.J4e(),P.T8e(H.c(C)));C.da.Ga(5,P);return P}function c(C,Q,P){P=void 0===P?null:P;var ka=m.call(this)||this;ka.rGa=C;ka.P5c=Q;ka.data=P;return ka}u=b(0);var d=b(14),e=b(4),k=b(89),l=b(27),n=b(38),f=b(79),v;(function(C){C[C.unableToRefreshLock=0]="unableToRefreshLock";C[C.unableToRefreshLockExpected=1]="unableToRefreshLockExpected";C[C.workbookAlmostTooLarge=2]=
"workbookAlmostTooLarge";C[C.workbookTooLarge=3]="workbookTooLarge";C[C.externalWorkbookLinksDisabled=4]="externalWorkbookLinksDisabled";C[C.externalWorkbookLinksShowError=5]="externalWorkbookLinksShowError";C[C.editAndRefreshDisabledOnBIAHostedFiles=6]="editAndRefreshDisabledOnBIAHostedFiles";C[C.unsupportedFeatures=7]="unsupportedFeatures";C[C.collabDataAndDataStringsLocaleMismatch=8]="collabDataAndDataStringsLocaleMismatch";C[C.collabDataStringsLocaleMismatch=9]="collabDataStringsLocaleMismatch";
C[C.collabDataLocaleMismatch=10]="collabDataLocaleMismatch";C[C.lastGenericStatusError=11]="lastGenericStatusError";C[C.scratchPadWarning=12]="scratchPadWarning";C[C.authenticationLost=13]="authenticationLost";C[C.odfCompatibilityIssues=14]="odfCompatibilityIssues";C[C.pivotChartInteractivityMissingWarning=15]="pivotChartInteractivityMissingWarning";C[C.workbookIsIrmProtected=16]="workbookIsIrmProtected";C[C.biFeatureNotAvailable=17]="biFeatureNotAvailable";C[C.anonymousCreateSaveWarning=18]="anonymousCreateSaveWarning";
C[C.unsupportedInteractiveReportEditing=19]="unsupportedInteractiveReportEditing";C[C.mobileAppCampaignBizBar=20]="mobileAppCampaignBizBar";C[C.transientServerCommunicationFailures=21]="transientServerCommunicationFailures";C[C.editAttemptInReadOnly=22]="editAttemptInReadOnly";C[C.editAttemptInReadOnlyNoEditPermissions=23]="editAttemptInReadOnlyNoEditPermissions";C[C.unsupportedBrowser=24]="unsupportedBrowser";C[C.readOnlyPermissions=25]="readOnlyPermissions";C[C.documentIsIrmProtectedWarning=26]=
"documentIsIrmProtectedWarning";C[C.policyWarningMessage=27]="policyWarningMessage";C[C.workingOnIt=28]="workingOnIt";C[C.passwordProtectedWorkbookLockedForEdit=29]="passwordProtectedWorkbookLockedForEdit";C[C.workbookIsReadOnlyRecommended=30]="workbookIsReadOnlyRecommended";C[C.workbookHasPasswordToModify=31]="workbookHasPasswordToModify";C[C.legacySharedWorkbookEditWarningBB=32]="legacySharedWorkbookEditWarningBB";C[C.legacyConnectionsBB=33]="legacyConnectionsBB";C[C.groupedSlicersBB=34]="groupedSlicersBB";
C[C.thirdPartyAddinDisabled=35]="thirdPartyAddinDisabled";C[C.financeLinkedEntityDisclaimerBar=36]="financeLinkedEntityDisclaimerBar";C[C.wolframDeprecationAlertBar=37]="wolframDeprecationAlertBar";C[C.wacGdprNotice=38]="wacGdprNotice";C[C.automaticSensitivityLabel=39]="automaticSensitivityLabel";C[C.recommendedSensitivityLabel=40]="recommendedSensitivityLabel";C[C.mandatorySensitivityLabel=41]="mandatorySensitivityLabel";C[C.localStorageDisabled=42]="localStorageDisabled";C[C.autoRefreshDisabled=
43]="autoRefreshDisabled";C[C.corruptedFileRepaired=44]="corruptedFileRepaired";C[C.corruptedOdsFileRepaired=45]="corruptedOdsFileRepaired";C[C.minorVersionLimitReached=46]="minorVersionLimitReached";C[C.sensitivityApplicationGenericError=47]="sensitivityApplicationGenericError";C[C.sensitivityApplicationTooLargeFileError=48]="sensitivityApplicationTooLargeFileError";C[C.sensitivityApplicationLabelNotSupportedError=49]="sensitivityApplicationLabelNotSupportedError";C[C.sensitivityApplicationLabelDisabledError=
50]="sensitivityApplicationLabelDisabledError";C[C.sensitivityApplicationMandatoryConflictError=51]="sensitivityApplicationMandatoryConflictError";C[C.sensitivityApplicationMinorVersionLimitReachedError=52]="sensitivityApplicationMinorVersionLimitReachedError";C[C.sensitivityApplicationSetLabelError=53]="sensitivityApplicationSetLabelError";C[C.promptEnableExternalLinks=54]="promptEnableExternalLinks";C[C.networkDown=55]="networkDown";C[C.defaultToViewDueToCogs=56]="defaultToViewDueToCogs";C[C.refreshLinkedEntityErrorBar=
57]="refreshLinkedEntityErrorBar";C[C.promptEnableLinkedEntitiesUntrustedImages=58]="promptEnableLinkedEntitiesUntrustedImages";C[C.canvasHealth=59]="canvasHealth";C[C.novModeDepreciation=60]="novModeDepreciation";C[C.mismatchedFileFormatConverted=61]="mismatchedFileFormatConverted";C[C.optimizeWorkbook=62]="optimizeWorkbook";C[C.novModePostDepreciation=63]="novModePostDepreciation";C[C.officeScriptsRunning=64]="officeScriptsRunning";C[C.powerQueryRefreshDataSourceNotSupported=65]="powerQueryRefreshDataSourceNotSupported";
C[C.readOnlyPivotTable=66]="readOnlyPivotTable";C[C.powerQueryRefreshHostNotSupported=67]="powerQueryRefreshHostNotSupported";C[C.count=68]="count"})(v||(v={}));Object(u.b)("EwaBusinessBarEntryType",v);var r=b(5),y=b(1260),m=Sys.EventArgs;Rk(c,m);Object(u.a)(c,"BusinessBarEntryDisplayChangedEventArgs",Sys.EventArgs,[]);var w=b(1262),B=b(1261),A=b(1264),z=b(1263),x=b(1258),D=b(524),I=b(51),F=b(591),G=b(37),T=b(742),O=b(31),U=b(1),J=b(21),H=b(56),K=b(67),N=b(1047);b.d(E,"a",function(){return a});var M=
f.a;Rk(a,M);a.prototype.J4e=function(){O.a.Uq(this.$.ea.rF)&&this.Jn(this,new D.a(this.$.ea.rF,null,!1,-1,-1,-1,-1,"",-1,"",-1))};a.prototype.vDg=function(C){this.Pa.addHandler("bBarAttachedOrDetached",C)};a.prototype.dispose=function(){if(this.$){var C=this.$,Q=C.oa,P=Q.sf;Q.Bz(this.Jn);Q.Zr(this.di);Q.Xrc(this.emc);Q.QHb(this.emc);P.cIb(this.pya);P.mbj(this.BEb);C.ea.wk(this.Uc);C.ea.Bw(this.Qf);C.rl(this.Yc);C.Ol(this.Fc);C.ea.b0(this.oN);C.userOperationManager.so(this.gFb);J.g(C).Wb.vk(this.Swf)}k.a.Ia(this.RT);
this.$=this.RT=null;M.prototype.dispose.call(this)};a.prototype.Aei=function(C){switch(C){case 4:case 5:case 11:case 54:case 7:case 36:case 37:return!0;case 58:return U.EwaSettings.ma(655);default:return!1}};a.prototype.Tf=function(C,Q,P,ka,R){P=void 0===P?null:P;ka=void 0===ka?null:ka;R=void 0===R?null:R;if(!this.$.isMobileMode||this.Aei(C))this.JYa&&!this.cC(C)&&(U.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")&&d.ULS.sendTraceTag(537170254,0,50,"Adding entry to BB: {0}",
Enum.toString(v,C)),this.TXa[C]=this.ah.Y7,this.RT.OD(C,Q,ka,R),this.Pa.raiseEvent("bBarAttachedOrDetached",new c(C,!0,P))),Q&&32===Q.Appearance&&K.a(this.$).fd.bla(Q)};a.prototype.izj=function(C,Q,P,ka){d.ULS.sendTraceTag(537170253,0,50,"BusinessBar.ShowGdprPrivacyNotice: Called");x.a.initialize(C,Q,P,ka);this.Tf(38,null)};a.prototype.lyj=function(C,Q,P,ka){y.a.initialize(C,Q,P,ka);this.Tf(39,null)};a.prototype.tAj=function(C,Q,P,ka){B.a.initialize(C,Q,P,ka);this.Tf(40,null)};a.prototype.Izj=function(C,
Q,P,ka){w.a.initialize(C,Q,P,ka);this.Tf(41,null)};a.prototype.CAj=function(C,Q,P,ka){z.a.initialize(C,Q,P,ka);this.Tf(52,null)};a.prototype.BAj=function(C,Q,P,ka){A.a.initialize(C,Q,P,ka);this.Tf(53,null)};a.prototype.removeEntry=function(C){this.JYa&&(U.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")&&d.ULS.sendTraceTag(537170251,0,50,"Removing entry from BB: {0}",Enum.toString(v,C)),this.TXa[C]=null,this.RT.removeEntry(C)&&this.Pa.raiseEvent("bBarAttachedOrDetached",new c(C,
!1)))};a.prototype.QLa=function(C){return this.JYa?this.RT.QLa(C):!1};a.prototype.cC=function(C){return this.JYa?this.RT.cC(C):!1};a.prototype.aDb=function(){d.ULS.sendTraceTag(537170248,0,50,"Network disconnect notification received from the app")};a.prototype.qlc=function(){d.ULS.sendTraceTag(537170247,0,50,"Network resumed notification received from the app, turning off the TransientServerCommunicationFailures business bar");this.removeEntry(21)};a.prototype.oLg=function(){var C=b(1352).BusinessBarControl;
if(this.JYa&&!this.RT){J.g(this.$).Wb.Ak(this.Swf);var Q=document.getElementById(this.$.yb+r.a.Xte);this.RT=new C(this.$,Q)}};a.prototype.pHd=function(){this.JYa&&this.RT.pHd()};a.prototype.IQf=function(C){if(U.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")){var Q=this.ah.Y7;if(3E5<=Q-this.Whf){this.Whf=Q;for(var P=0;68>P;P++){var ka=this.TXa[P];ka&&(ka=Q-ka,3E5<=ka&&d.ULS.sendTraceTag(537170241,0,50,"{0}: entry [{1}] was activated but not turned off for {2} Millis",C,Enum.toString(v,
P),ka))}}}};a.prototype.nzh=function(C){for(var Q=[],P=bk(C),ka=P.next();!ka.done;ka=P.next())switch(ka.value.MessageId){case -113742550:ka=[757111532,2113407564,1393475740,1911608588,104919273,-689453604,157762400,-949523941],(this.$.ea.isNamedObjectViewMode||O.a.Zg(C,ka))&&Q.push(-113742550)}return O.a.xF(C,Q)};a.prototype.r3h=function(C,Q){switch(C.MessageId){case 2113407564:for(var P=O.a.LZa([1821390342,-943219229,-502303485,1437034227]),ka=0;ka<P.length;ka++)P[ka].HelpTopicId=C.HelpTopicId,P[ka].HelpDescription=
C.HelpDescription,this.gHc.push(P[ka])}switch(C.MessageId){case -395951567:this.Tf(6,C);break;case 1643490758:this.Tf(4,C);break;case -907264831:this.Tf(5,C);break;case 757111532:case 2113407564:this.Tf(7,C);break;case 2010656511:this.Tf(15,C);break;case 1321660996:this.$.q4c=!0;this.Tf(8,C);break;case 526339737:this.$.q4c=!0;this.Tf(9,C);break;case -407088521:this.Tf(10,C);break;case 1756116017:this.Tf(14,C);break;case -1703455218:this.Tf(17,C);break;case 1393475740:this.Tf(25,C);break;case -949523941:this.Tf(26,
C);break;case 1779381952:this.Tf(43,C);break;case 1421575100:this.Tf(44,C);break;case 613676060:this.Tf(45,C);break;case 1233668252:this.Tf(61,C);break;case 1911608588:C=!!(this.$.Cd&64);!this.$.ea.jg()&&C&&Q.push(29);break;case 1544494907:break;case -655555355:Q.push(this.jqd()?1:0);break;case -1221382671:Q.push(2);break;case 1662282929:Q.push(3);break;case 104919273:this.$.ea.jg()||Q.push(30);break;case -689453604:C=!!(this.$.Cd&64);this.$.ea.U5e=!0;!this.$.ea.jg()&&C&&Q.push(31);break;case 157762400:this.$.ea.vgc=
!0;!this.$.ea.jg()&&this.$.Cd&64&&!this.$.isEditMode&&Q.push(32);break;case -73730134:U.EwaSettings.isChangeGateEnabled("OfficeVSO:6079602_EnableEditingOfFilesWithLegacyConnections")&&!this.$.ea.jg()&&this.$.Cd&64&&Q.push(33);break;case -293349236:Q.push(65);break;case 1580811823:Q.push(67);break;case -37299333:break;case 136737622:Q.push(46);break;case -1780327030:this.Tf(54,C);break;case -113742550:this.Tf(56,C);break;case -260312420:this.$.ea.jg()||Q.push(66);break;default:this.Tf(11,C)}return Q};
a.prototype.x9h=function(){var C=this;if(e.AFrameworkApplication.fa.qa("WildFireExcelBizBar")&&!N.a.Ynd(N.a.Xbd(1))&&(l.a.To||l.a.rh)){var Q=I.GetServiceTaskFactory.create(this.$.da,155,this.$.la,1);G.TaskExtensions.Aa(Q,function(){C.Tf(20,null)},this.la,3)}};a.prototype.S8h=function(C){!C&&F.b(this.$)&&this.Tf(60,null)};a.prototype.T8h=function(C){!C&&F.c(this.$)&&this.Tf(63,null)};a.prototype.T8e=function(C){(!C&&!this.$.printingEnabled||this.$.Jf.get(1))&&this.$.workbookContext.FullDocumentInfo.IrmPolicyDescription&&
(d.ULS.sendTraceTag(537170205,0,50,"BusinessBar.InitBusinessBar: Adding bisinessBar for irm protection."),this.Tf(16,null));this.x9h();this.Lwe();this.G2f();this.S8h(C);this.T8h(C)};a.prototype.Lwe=function(){this.$.workbookContext.Options&32768&&this.Zyj()};a.prototype.Zyj=function(){this.TXa[36]||this.Tf(36,null)};a.prototype.cBj=function(){this.TXa[37]||this.Tf(37,null)};a.prototype.G2f=function(){U.EwaSettings.ma(655)&&this.$.workbookContext.Options&524288&&this.Tf(58,null)};a.prototype.c3f=function(C,
Q){this.Tf(57,C,null,Q)};a.prototype.Ske=function(C,Q){var P=null,ka=null;P=void 0===P?null:P;ka=void 0===ka?null:ka;Q=void 0===Q?null:Q;this.RT.cC(C)?this.RT.ZNb(C,Q):this.Tf(C,null,P,ka,Q)};a.prototype.x2f=function(){this.$.Cd&8&&this.Tf(12,null)};a.prototype.jqd=function(){var C=this.$.da.za(38);return C?C.tokenExpired:!1};a.prototype.UCg=function(C,Q){if(!this.cC(21)&&-1387426400!==C.MessageId){d.ULS.sendTraceTag(537170204,0,50,"BusinessBar: raising the transient communication failures notification.");
var P={};P.FailedMethod=Q;this.Tf(21,C,P)}};a.lcc=function(){return a.moe||(a.moe=[0,1,2,3])};Mf.Object.defineProperties(a.prototype,{S6c:{configurable:!0,enumerable:!0,get:function(){return this.gHc}},domElement:{configurable:!0,enumerable:!0,get:function(){return this.RT?this.RT.domElement:null}}});a.moe=null;Object(u.a)(a,"BusinessBarManager",f.a,[923,3,80])},1478:function(u,E,b){function a(){l.a.Fa(c.ka)}function c(n){var f=k.call(this)||this;f.$=n;f.Eb();return f}u=b(0);var d=b(232),e=b(1461),
k=d.a;Rk(c,k);c.prototype.create=function(){this.pb(this.$.da.za(5)||new e.a(this.$,!this.$.dba))};c.ka=function(n){n.da.Ga(4,new c(n))};Object(u.a)(c,"BusinessBarManagerFactory",d.a,[]);var l=b(10);b.d(E,"a",function(){return a})},1489:function(u,E,b){function a(x){this.aP=x}function c(x,D,I,F){F=void 0===F?null:F;var G=z.call(this)||this;G.Npa=null;G.Vl=null;G.eP=null;G.Om=[];G.RUb=D;G.aP=x;G.kpg=I;G.dWb=F;G.wlb=new A.a("LoadResource","LoadPrintablePdf");return G}u=b(0);var d=b(14),e=b(84),k=b(135),
l=b(4),n=b(13),f=b(96),v=b(43),r=b(183),y=b(1277),m=b(88),w=b(55),B=b(81),A=b(1147),z=k.StandardDialog;Rk(c,z);c.prototype.YP=function(){this.Rb=5;this.width=40;var x=document.createElement("span");x.id=this.$h("DirectPrintHeaderContent");var D=document.createElement("span");D.innerText=CommonUIStrings.l_DirectPrintDialogHeader;Sys.UI.DomElement.addCssClass(D,"DirectPrintHeader");this.eP=document.createElement("iframe");this.eP.name="pdfObjectFrame";this.eP.title=CommonUIStrings.l_DirectPrintDialogIFrame;
this.eP.onload=Object(e.a)(this,this.e0i,"printablePdfLoaded");if(this.dWb&&0<this.dWb.count){var I=B.a.Med(this.RUb,this.dWb),F=B.a.NHd(this.RUb,this.dWb);this.Vl=document.createElement("form");this.Vl.id="printPreviewPostForm";this.Vl.method="POST";this.Vl.target=this.eP.name;this.Vl.action=F;I=bk(I);for(F=I.next();!F.done;F=I.next()){F=F.value;var G=document.createElement("input");G.type="hidden";G.name=F.key;G.value=F.value;this.Vl.appendChild(G)}}else this.eP.setAttribute("src",this.RUb);Sys.UI.DomElement.addCssClass(this.eP,
r.a.ibe);this.kpg?(Sys.UI.DomElement.addCssClass(this.eP,"DirectPrintPdfObjectHidden"),D.innerText=CommonUIStrings.l_DirectPrintDialogSuccessText,m.a.jh(this.eP,m.a.XB,m.a.Wj)):(Sys.UI.DomElement.addCssClass(this.eP,"DirectPrintPdfObject"),this.Om.push(this.eP));x.appendChild(D);x.appendChild(document.createElement("br"));x.appendChild(this.eP);this.Vl&&x.appendChild(this.Vl);x.appendChild(document.createElement("br"));x.appendChild(this.$0g(this.Vl?"#":this.RUb));this.wlb.start();this.ACb(CommonUIStrings.l_AppTitle,
null,null,null,null,x);this.PW(this.$h("DirectPrintHeaderContent"));this.Vl&&this.Vl.submit();this.Z5g();d.ULS.sendTraceTag(4771852,328,50,"Direct Print Dialog launched.")};c.prototype.$0g=function(x){var D=document.createElement("span"),I=document.createElement("span");I.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFHeader;D.appendChild(I);l.AFrameworkApplication.fa&&(2===l.AFrameworkApplication.ta.Qa.Cj&&l.AFrameworkApplication.fa.qa("PPTDisableDirectPrintDialogDownloadPDFLink")||1===
l.AFrameworkApplication.ta.Qa.Cj&&l.AFrameworkApplication.fa.qa("XLODisableDirectPrintDialogOpenPDFLink"))?(x=document.createElement("span"),2===l.AFrameworkApplication.ta.Qa.Cj?x.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLabel:1===l.AFrameworkApplication.ta.Qa.Cj&&(x.innerText=CommonUIStrings.l_InternalError_Directive,d.ULS.sendTraceTag(573691527,328,50,"Hyperlink removed from DirectPrintDialog in XLO.")),this.Npa=x,D.appendChild(document.createElement("br")),D.appendChild(x)):(I=document.createElement("a"),
I.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLink,I.href=x,I.target="_blank",I.id="PrintPDFLink",I.className="AllowBrowserClick",this.Npa=I,D.appendChild(document.createElement("br")),D.appendChild(I),this.Vl&&v.a.addHandler(I,"click",Object(e.a)(this,this.$nc,"onSubmit")),this.aP.ra(n.a.click,this.Npa,Object(e.a)(this,this.pIe,"downloadPDFLinkClicked"),null));this.Om.push(this.Npa);return D};c.prototype.$nc=function(x){this.Vl&&(this.Vl.target="_blank",this.Vl.submit());x.preventDefault()};
c.prototype.Z5g=function(){if(0<this.Om.length){var x=new y.a(this.Om),D=f.FocusManager.instance().sQ();D&&(this.Npa.focus(),D.Ve=x,D.m_=!0)}};c.prototype.pIe=function(){d.ULS.sendTraceTag(4585050,328,50,"Download PDF from Direct Print dialog clicked.");return!1};c.prototype.Ysd=function(){d.ULS.sendTraceTag(21031114,328,50,"Download PDF from Direct Print dialog button clicked")};c.prototype.e0i=function(){d.ULS.sendTraceTag(51426332,328,50,"PDF content loaded successfully");this.wlb&&this.wlb.stop()};
c.prototype.dispose=function(){this.Npa&&(this.aP.Ba(n.a.click,this.Npa,Object(e.a)(this,this.pIe,"downloadPDFLinkClicked")),this.Npa=null);w.a.a0(this.eP);this.eP=null;z.prototype.dispose.call(this)};Object(u.a)(c,"DirectPrintDialog",k.StandardDialog,[698]);b.d(E,"a",function(){return a});a.prototype.lMh=function(x,D,I){return new c(this.aP,x,D,void 0===I?null:I)};Object(u.a)(a,"DirectPrintDialogFactory",null,[667])},1490:function(u,E,b){function a(m,w,B,A,z,x,D,I,F,G){this.uXb=null;this.Umg=m;this.Tjb=
w;this.ZMc=B;this.tqg=A;this.Zqg=z;this.qOc=new e.a(Object(k.a)(this,this.dUh,"getProbeResults"));this.ZUa=x;this.c$d=F;this.owg=D;this.$qg=I;this.grg=G}function c(m,w){this.G6f=m;this.vSa=w}u=b(0);var d=b(14),e=b(615),k=b(84),l=b(1543),n=b(1278);Object(u.a)(c,"DirectPrintProbeResults",null,[]);var f=b(4),v=b(276),r=b(27),y=b(113);b.d(E,"a",function(){return a});a.prototype.start=function(){};a.prototype.e2i=function(){var m=Array(this.pC.uSa.length);if(void 0!==this.Tjb&&null!==this.Tjb)for(var w=
0;w<this.pC.uSa.length;w++)m[w]=this.pC.uSa[w]in this.Tjb&&this.tqg(this.Tjb[this.pC.uSa[w]]);return m};a.prototype.f2i=function(){for(var m=Array(this.pC.vSa.length),w=!(void 0===this.ZMc||null===this.ZMc),B=0;B<this.pC.vSa.length;B++){var A=this.pC.vSa[B];m[B]=w&&A in this.ZMc?!0:this.Zqg(A)}return m};a.prototype.SXh=function(){for(var m=this.e2i(),w=Array(m.length),B=0;B<m.length;B++)w[B]=m[B]?this.Axh(this.Tjb[this.pC.uSa[B]]):null;return w};a.prototype.Axh=function(m){if(void 0===m||null===m)return null;
m=m.enabledPlugin;return void 0===m||null===m?null:m.name};a.prototype.dUh=function(){for(var m=this.SXh(),w=this.f2i(),B={},A={},z=0;z<this.pC.uSa.length;z++)B[this.pC.uSa[z]]=m[z];for(m=0;m<this.pC.vSa.length;m++)A[this.pC.vSa[m]]=w[m];return new c(B,A)};a.prototype.Sxj=function(){return this.grg||!this.pC.isEnabled||f.AFrameworkApplication.isUnifiedHostMode?!1:this.QFj()};a.prototype.Swc=function(){if(null!=this.uXb)return this.uXb;var m=a.Dbf(this.pC);return this.uXb=this.pC.Ebf&&m||this.Yei()};
a.prototype.Yei=function(){return r.a.Uo&&this.pC.$ei&&r.a.kxe>=this.pC.WWg?!0:!1};a.prototype.QFj=function(){if(!this.$qg(this.pC))return!1;var m=y.a.pgd(this.qOc.value.G6f);m=bk(m);for(var w=m.next();!w.done;w=m.next())if(w=w.value,void 0!==w&&null!==w)return!0;m=y.a.pgd(this.qOc.value.vSa);m=bk(m);for(w=m.next();!w.done;w=m.next())if(w.value)return!0;return!1};a.prototype.q4h=function(){var m=y.a.pgd(this.qOc.value.G6f);m=bk(m);for(var w=m.next();!w.done;w=m.next())if(v.a.contains(this.pC.H7h,
w.value))return!0;return!1};a.prototype.Z2f=function(m){var w=void 0===w?!1:w;var B=void 0===B?null:B;f.AFrameworkApplication.ta&&f.AFrameworkApplication.fa.qa("DirectPrintDialogAsStandardDialogIsEnabled")?this.c$d(m,B):this.Sxj()?this.Bfh(m,this.q4h()&&!w,B):this.c$d(m,B)};a.prototype.Bfh=function(m,w,B){B=void 0===B?null:B;var A=this.owg.sc("UserAction","OpenDirectPrintDialog");this.ZUa.lMh(m,w,B).YP();A.stop()};a.igf=function(m){try{return new ActiveXObject(m),!0}catch(w){d.ULS.sendTraceTag(4535642,
328,100,"Failed to instantiate {0} as an ActiveX control.",m)}return!1};a.Fbf=function(m){return void 0===m||null===m?!1:!(void 0===m.enabledPlugin||null===m.enabledPlugin)};a.create=function(m){var w=new n.a(f.AFrameworkApplication.fa.appSettings),B=null;try{B=window.navigator.mimeTypes}catch(G){d.ULS.sendTraceTag(573923532,328,15,"Failed to get Window.Navigator.mimeTypes")}var A=null;try{A=window.navigator.plugins}catch(G){d.ULS.sendTraceTag(573923533,328,15,"Failed to get Window.Navigator.plugins")}var z=
a.Fbf,x=a.igf;m=m.resolve("Common.App.DirectPrint.DirectPrintDialogFactory");var D=f.AFrameworkApplication.ta.pD,I=a.jgf,F=!!f.AFrameworkApplication.ta&&f.AFrameworkApplication.ta.Qa.Vu&&!f.AFrameworkApplication.fa.qa("PrintDialogFallbackLinkEnabled");return new a(w,B,A,z,x,m,D,I,function(G,T){return new l.a(G,!1,T,!0,F)},f.AFrameworkApplication.PLa)};a.jgf=function(m){return r.a.Uo||r.a.Yt&&m.qii||m.Ebf&&a.Dbf(m)?!0:!1};a.Dbf=function(m){var w=r.a.Bsb;if(w){var B=w.split(".");if(2===B.length)return w=
parseInt(B[0]),B=parseInt(B[1]),w>m.Evd||w===m.Evd&&B>=m.fpf}return!1};Mf.Object.defineProperties(a.prototype,{pC:{configurable:!0,enumerable:!0,get:function(){return this.Umg}}});Object(u.a)(a,"DirectPrintManager",null,[666])},1494:function(u,E,b){function a(y,m,w,B,A,z){this.xNc=null;this._id=y;this.eOc=m;this.Rog=void 0===A?null:A;this.Pib=B;this.Zkb=void 0===z?null:z;this.$oa=null;this.CXa=w;this.xlb=c.instance.DXh(m,y)}function c(){this.kEc=new n.a;this.iEc=new n.a;this.hEc=new n.a;this.kPg(this.kEc);
this.jPg(this.iEc);this.iPg(this.hEc);this.lJc=new n.a;this.kJc=new n.a;this.jJc=new n.a;this.HRg(this.lJc);this.GRg(this.kJc);this.FRg(this.jJc);this.zFc=new n.a;this.DPg(this.zFc);this.tFa(this.zFc);this.tFa(this.hEc);this.tFa(this.iEc);this.tFa(this.kEc);this.tFa(this.kJc);this.tFa(this.lJc);this.tFa(this.jJc)}u=b(0);var d=b(14),e=b(84),k=b(1062),l=b(1047),n=b(1405);c.prototype.DXh=function(y,m){switch(y){case 1:return this.W_h(m);case 2:return this.zHh(m)}return l.a.Qwc?this.zFc:null};c.prototype.kPg=
function(y){y.add("Headline",CommonUIStrings.l_WildFireWordBizBarHeadline);y.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);y.add("CallToAction",CommonUIStrings.l_WildFireWordBizBarAndroidCallToAction)};c.prototype.jPg=function(y){y.add("Headline",CommonUIStrings.l_WildFirePPTBizBarHeadline);y.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);y.add("CallToAction",CommonUIStrings.l_WildFirePPTBizBarAndroidCallToAction)};c.prototype.iPg=function(y){y.add("Headline",
CommonUIStrings.l_WildFireExcelBizBarHeadline);y.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);y.add("CallToAction",CommonUIStrings.l_WildFireExcelBizBarAndroidCallToAction)};c.prototype.HRg=function(y){y.add("Headline",CommonUIStrings.l_WildFireWordBizBarHeadline);y.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);y.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);y.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);
y.add("CallToAction",CommonUIStrings.l_WildFireWordBizBarIPadCallToAction);y.add("OverlayBig","Get the Word app");y.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");y.add("OverlaySmallSplit1","Discover Word");y.add("OverlaySmallSplit2","designed for the iPad.");y.add("SkipButton","Skip for now")};c.prototype.DPg=function(y){y.add("Headline","Get the Office Online extension for Chrome");y.add("UseAppButton","Get the extension");y.add("CallToAction","The quickest way to view, edit, and share Office files in Chrome.")};
c.prototype.GRg=function(y){y.add("Headline",CommonUIStrings.l_WildFirePPTBizBarHeadline);y.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);y.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);y.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);y.add("CallToAction",CommonUIStrings.l_WildFirePPTBizBarIPadCallToAction);y.add("OverlayBig","Get the PowerPoint app");y.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");
y.add("OverlaySmallSplit1","Discover PowerPoint");y.add("OverlaySmallSplit2","designed for the iPad.");y.add("SkipButton","Skip for now")};c.prototype.FRg=function(y){y.add("Headline",CommonUIStrings.l_WildFireExcelBizBarHeadline);y.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);y.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);y.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);y.add("CallToAction",CommonUIStrings.l_WildFireExcelBizBarIPadCallToAction)};
c.prototype.tFa=function(y){y.add("Corporation","Microsoft Corporation")};c.prototype.W_h=function(y){switch(y){case 3:return this.lJc;case 2:return this.kJc;case 1:return this.jJc}return null};c.prototype.zHh=function(y){switch(y){case 3:return this.kEc;case 2:return this.iEc;case 1:return this.hEc}return null};Mf.Object.defineProperties(c,{instance:{configurable:!0,enumerable:!0,get:function(){c.Ma||(c.Ma=new c);return c.Ma}}});c.Ma=null;Object(u.a)(c,"WildFireStringFactory",null,[]);var f=b(4),
v=b(39),r=b(27);b.d(E,"a",function(){return a});a.prototype.s2c=function(){this.$oa=new k.a(this.title,this.message,null);this.$oa.addButton(this.fue,Object(e.a)(this,this.vtf,"onButtonOneClick"),"");this.CXa&&this.$oa.dCg(this.hue,Object(e.a)(this,this.ytf,"onButtonTwoClick"));this.$oa.u$=Object(e.a)(this,this.jHe,"dismissBar");this.$oa.image=3;this.$oa.id=16;this.$oa.closeable=!0};a.prototype.vtf=function(){this.CXa?this.Dbi():this.GTj()};a.prototype.ytf=function(){this.CXa&&this.cUi()};a.prototype.Dbi=
function(){d.ULS.sendTraceTag(17932829,306,50,"Install App Button of BusinessBar Clicked");this.Pib&&this.Zkb&&this.Zkb();l.a.mMf(this._id,this.eOc)};a.prototype.cUi=function(){this.openUrl&&(d.ULS.sendTraceTag(17932830,306,50,"Open App Button of BusinessBar Clicked"),this.Pib&&this.Zkb&&this.Zkb(),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(l.a.ppe(this._id),this.openUrl,0,!1))};a.prototype.GTj=function(){l.a.Qwc?this.ORg():(d.ULS.sendTraceTag(17109255,306,50,"AppBusinessBarNav"),
l.a.AOd("BizBarClicked"),1!==this.eOc&&2!==this.eOc||l.a.mYg(this.openUrl,this.Pib,this._id,this.Zkb))};a.prototype.ORg=function(){this.Pib?d.ULS.sendTraceTag(17571974,323,50,"ChromeExtBannerClicked"):d.ULS.sendTraceTag(17571975,301,50,"ChromeExtBannerClicked");v.a.PU(f.AFrameworkApplication.fa.appSettings.WildFireChromeExtensionUrl.toString())};a.prototype.ifh=function(){this.Pib?d.ULS.sendTraceTag(17571976,323,50,"ChromeExtBannerDismissed"):d.ULS.sendTraceTag(17571977,301,50,"ChromeExtBannerDismissed");
l.a.AOd(l.a.ixe)};a.prototype.jHe=function(){l.a.Qwc?this.ifh():(l.a.AOd(l.a.Xbd(this._id)),d.ULS.sendTraceTag(17109256,306,50,"AppBusinessBarDismissed"))};a.H4b=function(){var y=f.AFrameworkApplication.ta.Qa,m=new a(y.Cj,l.a.jcc(),8<r.a.W4a,1===y.lca,function(){return y.qx},y.jUf());d.ULS.sendTraceTag(9208407,306,50,"AppBusinessBarDisplayed");return m};Mf.Object.defineProperties(a.prototype,{title:{configurable:!0,enumerable:!0,get:function(){return this.xlb.na("Headline")}},message:{configurable:!0,
enumerable:!0,get:function(){return this.xlb.na("CallToAction")}},PTj:{configurable:!0,enumerable:!0,get:function(){return this.CXa}},fue:{configurable:!0,enumerable:!0,get:function(){return this.CXa?this.xlb.na("InstallButton"):this.xlb.na("UseAppButton")}},hue:{configurable:!0,enumerable:!0,get:function(){return this.CXa?this.xlb.na("OpenAppButton"):""}},KRg:{configurable:!0,enumerable:!0,get:function(){return this.$oa}},openUrl:{configurable:!0,enumerable:!0,get:function(){this.xNc||(this.xNc=
this.Rog());return this.xNc}}});Object(u.a)(a,"WildFireBusinessBar",null,[])},1538:function(u,E,b){function a(r,y,m,w,B,A){y=void 0===y?!0:y;m=void 0===m?!1:m;w=void 0===w?null:w;B=void 0===B?null:B;A=void 0===A?!1:A;var z=v.call(this)||this;z.IX=null;z.Vl=null;z.uVa=null;z.vVa=null;var x=z.TUd?z.TUd:CommonUIStrings.l_DefaultDialogTitle;a.exb=A;z.URb=w||new d.a(r,!0);z.URb.xre(z);var D=[],I=[];a.mu&&(z.$Uc&&z.$Uc.forEach(function(O){Array.add(D,O)}),z.Hne&&z.Hne.forEach(function(O){Array.add(I,O)}));
y?m?z.Nff?(z.Rb=12,z.mc(1,z.buttonText),z.mc(2,CommonUIStrings.l_ShareLink),z.mc(3,CommonUIStrings.l_DialogClose)):(z.Rb=4,z.mc(1,z.buttonText),z.mc(2,CommonUIStrings.l_DialogClose)):(z.Rb=6,z.mc(0,CommonUIStrings.l_DialogClose)):z.Rb=5;A=document.createElement("span");z.K3c&&(A.className=z.K3c);w=document.createElement("a");w.innerText=z.ojc;w.href=r;w.target="_blank";w.id=z.njc;w.className=e.AFrame.ooe;var F=!f.a.HC&&!!B&&0<B.count;if(F){var G=n.a.Med(r,B);B=n.a.NHd(r,B);w.href="#";w.target="_self";
z.Vl=document.createElement("form");z.Vl.id="printPreviewPostForm1";z.Vl.method="post";z.Vl.target="_blank";z.Vl.action=B;B=bk(G);for(G=B.next();!G.done;G=B.next()){G=G.value;var T=document.createElement("input");T.type="hidden";T.name=G.key;T.value=G.value;z.Vl.appendChild(T)}}else z.Vl=null;z.Vl||a.exb?a.exb||(r={},Array.add(I,(r.type="AppLinkProps",r.id=z.njc,r.text=z.ojc,r.onExecute=function(){z.IKf()},r))):(B={},G={},Array.add(I,(G.type="AppLinkProps",G.id=z.njc,G.text=z.ojc,G.handler=(B.href=
F?"#":r,B.target=F?"_self":"_blank",B),G)));z.HNa&&(Array.add(D,z.HNa),z.Nff&&Array.add(D,CommonUIStrings.l_AdditionalText));m?(r=document.createElement("span"),r.innerText=z.HNa.replace("{0}",""),A.appendChild(r)):z.Xof?(r=document.createElement("span"),r.id=z.$h("message"),F=document.createElement("span"),B=document.createElement("span"),G=z.HNa.split("{0}"),F.innerText=G[0],B.innerText=G[1],r.appendChild(F),r.appendChild(w),r.appendChild(B),A.appendChild(r)):(r=document.createElement("span"),r.innerText=
z.HNa,A.appendChild(r),A.appendChild(document.createElement("br")),A.appendChild(document.createElement("br")),A.appendChild(w),a.exb||Array.add(D,"{0}"));z.Vl&&A.appendChild(z.Vl);a.mu&&(z.F7a&&(z.qBb?z.tke(z.F7a,z.qBb):(Array.add(D,"{0}"),r={},Array.add(I,(r.type="AppLinkProps",r.id="LearnMoreLinkId",r.text=z.F7a,r.onExecute=function(){z.hjc()},r)))),z.wra(D,I));z.ACb(x,null,z.b8e,null,Object(c.a)(z,z.Uv,"dialogHandler"),a.mu?null:A);z.PW(z.$h("message"));!a.mu&&z.qBb&&z.F7a&&(x=document.createElement("div"),
x.className="WACDialogLearnMoreLinkContainer",z.IX=document.createElement("a"),z.IX.innerText=z.F7a,z.IX.href=z.qBb,z.IX.target="_blank",z.IX.id=z.$h("LearnMoreLinkId"),z.IX.className=e.AFrame.ooe,x.appendChild(z.IX),y?z.Db.insertBefore(x,z.Db.lastChild):z.Db.appendChild(x),z.PW(String.format("{0} {1}",z.$h("message"),z.$h("LearnMoreLinkId"))));z.Ehb=w;m?z.kI(z.HB):z.kI(z.Ehb);z.Fkf();k.AFrameworkApplication.ta.aX.ra(l.a.click,z.Ehb,Object(c.a)(z,z.nIe,"downloadLinkClicked"),null);z.IX&&k.AFrameworkApplication.ta.aX.ra(l.a.click,
z.IX,Object(c.a)(z,z.hjc,"learnMoreLinkClicked"),null);z.TRb=!1;return z}b.d(E,"a",function(){return a});u=b(0);var c=b(84);E=b(135);var d=b(1266),e=b(273),k=b(4),l=b(13),n=b(81),f=b(27),v=E.StandardDialog;Rk(a,v);a.prototype.BWc=function(){this.Vl&&(this.uVa||(this.uVa=Object(c.a)(this,this.iFi,"onActionButtonClicked"),this.xy.ra(l.a.click,this.HB,this.uVa)),this.vVa||(this.vVa=Object(c.a)(this,this.jFi,"onActionButtonKeyUp"),this.Xd.ra(l.a.Gd,this.HB,this.vVa)));v.prototype.BWc.call(this)};a.prototype.iFi=
function(r){this.kQe(r);return!0};a.prototype.jFi=function(r){return this.Ohf(r,Object(c.a)(this,this.kQe,"executeDismissActionButtonFromArgs"))};a.prototype.kQe=function(r){this.Vl&&this.Vl.submit();this.gua(r.zb)};a.prototype.Ysd=function(){};a.prototype.nIe=function(){this.Hkf();this.Vl?this.Vl.submit():this.URb.V5c();return!0};a.prototype.hjc=function(){return!1};a.prototype.dispose=function(){this.URb.dispose();this.Ehb&&(k.AFrameworkApplication.ta.aX.Ba(l.a.click,this.Ehb,Object(c.a)(this,this.nIe,
"downloadLinkClicked")),this.Ehb=null);this.IX&&(k.AFrameworkApplication.ta.aX.Ba(l.a.click,this.IX,Object(c.a)(this,this.hjc,"learnMoreLinkClicked")),this.IX=null);this.xy&&this.uVa&&(this.xy.Ba(l.a.click,this.HB,this.uVa),this.uVa=null);this.Xd&&this.vVa&&(this.Xd.Ba(l.a.Gd,this.HB,this.vVa),this.vVa=null);v.prototype.dispose.call(this)};a.prototype.IKf=function(){this.Vl&&(document.body.appendChild(this.Vl),this.Vl.submit(),document.body.removeChild(this.Vl))};a.prototype.Uv=function(r){1===r&&
(this.Ysd(),this.Vl?a.mu&&this.IKf():this.URb.V5c());this.dispose()};Mf.Object.defineProperties(a.prototype,{b8e:{configurable:!0,enumerable:!0,get:function(){return null}},TUd:{configurable:!0,enumerable:!0,get:function(){return null}},HNa:{configurable:!0,enumerable:!0,get:function(){return null}},qBb:{configurable:!0,enumerable:!0,get:function(){return null}},F7a:{configurable:!0,enumerable:!0,get:function(){return null}},Xof:{configurable:!0,enumerable:!0,get:function(){return!1}},buttonText:{configurable:!0,
enumerable:!0,get:function(){return CommonUIStrings.l_Open}},K3c:{configurable:!0,enumerable:!0,get:function(){return null}},$Uc:{configurable:!0,enumerable:!0,get:function(){return null}},Hne:{configurable:!0,enumerable:!0,get:function(){return null}},Nff:{configurable:!0,enumerable:!0,get:function(){return!1}}});Mf.Object.defineProperties(a,{mu:{configurable:!0,enumerable:!0,get:function(){return k.AFrameworkApplication.ta.Qa.Vu&&k.AFrameworkApplication.ta.Qa.Sef}},exb:{configurable:!0,enumerable:!0,
get:function(){return a.D6d},set:function(r){a.D6d=r}}});a.D6d=!1;Object(u.a)(a,"ADialogWithLinkToResource",E.StandardDialog,[])},1539:function(u,E,b){function a(l,n,f,v,r,y){var m=k.call(this,l,n,f,v,r,y)||this;l={};n=(l.errorMessage=m.eLe,l.offerString=m.Trf,l);l=new e.a(!1,!1,!0);m.y2f?(l.Rb=1,f={},n.helpLink=(f.type="AppLinkProps",f.id="helpLink",f.text=m.Gva,f.onExecute=function(){d.Redirect.showHelp(m.B6e)},f)):(l.Rb=4,l.mc(2,m.V7e));l.mc(1,m.OXb);l.ye=m.id;f={};n=(f.id=m.id,f.dialogIcon=m.icon,
f.bodyControls=n,f);l.initializeAndShow(m.zl,Object(c.a)(m,m.A4i,"reactOICErrorDialogWithTrialHandler"),n);return m}b.r(E);b.d(E,"ReactOICErrorDialogWithTrial",function(){return a});u=b(0);var c=b(84);E=b(1268);var d=b(442),e=b(150),k=E.a;Rk(a,k);Object(u.a)(a,"ReactOICErrorDialogWithTrial",E.a,[])},1540:function(u,E,b){function a(k,l,n,f,v,r){k=e.call(this,k,l,n,f,v,r)||this;l=document.createElement("span");l.innerText=k.eLe;l.appendChild(document.createElement("br"));l.appendChild(document.createElement("br"));
n=document.createElement("span");n.innerText=k.Trf;l.appendChild(n);n=new d.StandardDialog;k.y2f?(n.Rb=1,n.Cke(k.Gva,k.B6e)):(n.Rb=4,n.mc(2,k.V7e));n.mc(1,k.OXb);n.ye=k.id;n.ql(k.zl,null,k.icon,Object(c.a)(k,k.qri,"legacyOICErrorDialogWithTrialHandler"),l);return k}b.r(E);b.d(E,"OICErrorDialogWithTrial",function(){return a});u=b(0);var c=b(84);E=b(1268);var d=b(135),e=E.a;Rk(a,e);Object(u.a)(a,"OICErrorDialogWithTrial",E.a,[])},1541:function(u,E,b){function a(){return c.call(this)||this}b.r(E);b.d(E,
"CheckRoamingRightsRequest",function(){return a});u=b(0);b=b(1269);var c=b.a;Rk(a,c);a.prototype.Kvb=function(){return 2};a.prototype.Eaa=function(){return 1};Object(u.a)(a,"CheckRoamingRightsRequest",b.a,[])},1542:function(u,E,b){function a(){return c.call(this)||this}b.r(E);b.d(E,"GetRoamingLauncherRequest",function(){return a});u=b(0);b=b(1269);var c=b.a;Rk(a,c);a.prototype.Kvb=function(){return 0};a.prototype.Eaa=function(){return 2};Object(u.a)(a,"GetRoamingLauncherRequest",b.a,[])},1543:function(u,
E,b){function a(r,y,m,w,B){m=void 0===m?null:m;w=void 0===w?!0:w;B=void 0===B?!1:B;y=v.call(this,r,!0,!(a.uTa&&w),new e.a(r,y),m,B)||this;a.uTa=a.uTa&&w;if(a.uTa){w=document.createElement("iframe");B=null;var A=y.weh;w.name="pdfObjectFrame";w.id="pdfObjectIFrame";if(m&&0<m.count){var z=n.a.Med(r,m);r=n.a.NHd(r,m);B=document.createElement("form");B.id="printPreviewPostForm";B.method="POST";B.target=w.name;B.action=r;r=bk(z);for(m=r.next();!m.done;m=r.next())m=m.value,z=document.createElement("input"),
z.type="hidden",z.name=m.key,z.value=m.value,B.appendChild(z)}else w.src=r;A.appendChild(w);B&&(A.appendChild(B),B.submit());Sys.UI.DomElement.addCssClass(w,"DirectPrintPdfObjectHidden");l.a.jh(w,l.a.XB,l.a.Wj)}return y}b.d(E,"a",function(){return a});u=b(0);var c=b(14),d=b(1538),e=b(1266),k=b(4),l=b(88),n=b(81),f=b(27),v=d.a;Rk(a,v);a.prototype.Fkf=function(){c.ULS.sendTraceTag(7690390,324,50,"Legacy print dialog displayed")};a.prototype.Hkf=function(){k.AFrameworkApplication.Hm.Hxb(9540);c.ULS.sendTraceTag(7690391,
324,50,"Legacy print dialog clicked")};a.prototype.Ysd=function(){c.ULS.sendTraceTag(19462215,324,50,"Legacy print dialog button clicked")};Mf.Object.defineProperties(a.prototype,{b8e:{configurable:!0,enumerable:!0,get:function(){return"Print_32x32x32"}},TUd:{configurable:!0,enumerable:!0,get:function(){return a.uTa?CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint:null}},HNa:{configurable:!0,enumerable:!0,get:function(){return a.uTa?null:CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint}},$Uc:{configurable:!0,
enumerable:!0,get:function(){var r=[];Array.add(r,CommonUIStrings.l_PrintDialogCanCloseDocument);if(d.a.exb){var y=CommonUIStrings.l_DirectPrintDialogFallbackSuggestion;""!==k.AFrameworkApplication.ta.Qa.JEe&&(y=k.AFrameworkApplication.ta.Qa.JEe);Array.add(r,y)}return a.uTa?r:null}},ojc:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_DirectPrintDialogDownloadPDFLink}},njc:{configurable:!0,enumerable:!0,get:function(){return"PrintPDFLink"}},buttonText:{configurable:!0,enumerable:!0,
get:function(){return CommonUIStrings.l_PrintDialogOpenPDF}},K3c:{configurable:!0,enumerable:!0,get:function(){return k.AFrameworkApplication.BGe?"UIFontDialogTextLarge":null}}});Mf.Object.defineProperties(a,{uTa:{configurable:!0,enumerable:!0,get:function(){return!!k.AFrameworkApplication.ta&&k.AFrameworkApplication.ta.Qa.Vu&&k.AFrameworkApplication.fa.qa("DirectPrintDialogAsStandardDialogIsEnabled")&&!(f.a.HC||f.a.Yt||f.a.Nf||f.a.nMa)&&!k.AFrameworkApplication.isUnifiedHostMode&&k.AFrameworkApplication.fa.qa("ShouldHostDefaultToNativeBrowserPrintExperience")},
set:function(){}}});Object(u.a)(a,"PrintDialogWithLinkToPdf",d.a,[])},1560:function(u,E,b){function a(f){this.xFc=!1;this.SWa=a.vec;this.jPc=this.kNc=0;this.platform=null;this.Jug=f;this.Qhe=this.kPc=!1}function c(){this.state=this.callback=null;this.hnd=!1}function d(){this.classId=0}u=b(0);var e=b(84),k=b(41);d.$Ha=function(f){try{return k.a(f)}catch(v){}return null};Object(u.a)(d,"ARoamingAppsResponse",null,[]);Object(u.a)(c,"GetRoamingAppsLauncherContext",null,[]);var l=b(4),n=b(108);b.d(E,"a",
function(){return a});a.prototype.JWg=function(){l.AFrameworkApplication.Pgc&&this.roamingAppsAreEnabled&&!this.kPc&&!this.xFc&&(this.jPc=1,this.xFc=!0,this.xfj(),this.hQe())};a.prototype.xfj=function(){this.SWa=a.vec;this.kNc=0};a.prototype.getRoamingAppsLauncher=function(f,v,r){this.$Tj?(f=new c,f.callback=v,f.state=r,f.hnd=!0,this.mQe(f)):v(!1,"",r)};a.prototype.hQe=function(){var f=new (b(1541).CheckRoamingRightsRequest);f.RoamingApp=this.jPc;f.BaseDocQuerySignature=l.AFrameworkApplication.Yi;
f.execute(Object(e.a)(this,this.LWg,"checkUserRoamingRightsSucceeded"),Object(e.a)(this,this.KWg,"checkUserRoamingRightsFailed"),null)};a.prototype.LWg=function(f){l.AFrameworkApplication.Ag||((f=d.$Ha(f.data.Td))?this.COd(f.HasRights):this.COd(!1))};a.prototype.KWg=function(){if(!l.AFrameworkApplication.Ag)if(this.kNc>=a.Myi)this.COd(!1);else{var f=new n.a(2,1,this.SWa,Object(e.a)(this,this.retryCheckUserRoamingRights,"retryCheckUserRoamingRights"),59);l.AFrameworkApplication.yi.Dg(f);this.kNc++;
this.SWa*=a.Sgj;this.SWa>a.rof&&(this.SWa=a.rof)}};a.prototype.COd=function(f){this.Qhe=f;this.kPc=!0;this.xFc=!1};a.prototype.retryCheckUserRoamingRights=function(){this.hQe()};a.prototype.mQe=function(f){var v=new (b(1542).GetRoamingLauncherRequest);v.RoamingApp=this.jPc;v.BaseDocQuerySignature=l.AFrameworkApplication.Yi;v.execute(Object(e.a)(this,this.HVh,"getRoamingAppsLauncherSucceeded"),Object(e.a)(this,this.GVh,"getRoamingAppsLauncherFailed"),f)};a.prototype.HVh=function(f){if(!l.AFrameworkApplication.Ag){var v=
d.$Ha(f.data.Td);f=f.data.state;v?(this.platform=v.Platform,f.callback(!0,v.Launcher,f.state)):f.callback(!1,"",f.state)}};a.prototype.GVh=function(f){if(!l.AFrameworkApplication.Ag){var v=f.data.state;5===f.data.status&&v.hnd?(v.hnd=!1,this.mQe(v)):v.callback(!1,"",v.state)}};Mf.Object.defineProperties(a.prototype,{roamingAppsAreEnabled:{configurable:!0,enumerable:!0,get:function(){return this.Jug}},$Tj:{configurable:!0,enumerable:!0,get:function(){return this.roamingAppsAreEnabled&&this.kPc?this.Qhe:
!1}}});Mf.Object.defineProperties(a,{instance:{configurable:!0,enumerable:!0,get:function(){return a.SB||(a.SB=new a(l.AFrameworkApplication.IKg))}}});a.vec=1E3;a.Sgj=5;a.rof=12E5;a.Myi=5;a.SB=null;Object(u.a)(a,"RoamingAppsManager",null,[])},1633:function(u,E,b){function a(Ja){var Lb=Ae.call(this)||this;Lb.$=Ja;Lb.Eb();return Lb}function c(Ja){this.stopwatch=this.i_b=this.ezc=this.kUd=null;this.E7f=0;this.$=Ja;(this.bWc=Td.EwaSettings.isChangeGateEnabled("OfficeVSO:5782706_NSVTC"))||Ja.da.Ga(322,
this)}function d(Ja){this.Wge=0;this.F7f=Ja}function e(Ja,Lb,mc,xc,hd,Cd,dc){this.title=Ja;this.body=Lb;this.S_i=mc;this.primaryButtonAction=xc;this.secondaryButtonAction=Cd;this.PVf=hd;this.targetObject=dc}function k(Ja){var Lb=lb.call(this)||this;Lb.$=Ja;Lb.Eb();return Lb}function l(Ja){this.$=Ja;Ja.da.Ga(309,this)}function n(Ja){var Lb=Ya.call(this,Ja)||this;Lb.Ko=null;Lb.stopwatch=null;Lb.IBi=function(mc){if(1===mc)Lb.$.Ka.Kb(new xe.a(-2050946363,Ke.a.Cb,2,8,null)).continueWith(function(hd){Lb.Ko.setResult(!lf.a(hd)&&
hd.result)}),mc="Yes";else{var xc=2===mc;Lb.Ko.setResult(xc);mc=2===mc?"No":"Close";xc&&Lb.H_i()}Lb.Oui(mc);Lb.hide()};return Lb}function f(){}function v(Ja){return Zd.call(this,Ja)||this}function r(Ja){this.oi=Ja}function y(Ja){return le.call(this,Ja)||this}function m(Ja,Lb,mc){var xc=Od.call(this)||this;xc.bve=!1;xc.ave=!1;xc.rGi=function(){xc.bve=!0;xc.c2f()};xc.$=Ja;xc.Va=Lb;xc.OJ=mc;zd.a(xc.$).LGd(new Pd.a(Hd.a.dbg,Hd.a.idle,m.yVg),new rd.a(Hd.a.wye,Hd.a.u_,null,Hd.a.AO,Hd.a.idle));return xc}
function w(Ja){var Lb=Mc.call(this,Ja,Wd.a.instance.ga(1252))||this;Lb.textBox=null;Lb.JQa=null;Lb.hTa=null;Lb.ZCf=function(){var mc=Lb.$;Lb.It();var xc=new B(mc,1255,1256,1257,function(hd,Cd,dc){var Ec=mc.oa.xa.Pb(),gb=mc.oa.xa;Ec=gb.Na(1,Ec);return Ac.g(gb,"UnshareForm",Ec,hd,Cd,dc,null,0)},16);xc.initialize();xc.gf()};return Lb}function B(Ja,Lb,mc,xc,hd,Cd){Cd=void 0===Cd?0:Cd;Ja=bc.call(this,Ja,Wd.a.instance.ga(Lb),!1)||this;Ja.message=mc;Ja.aFi=xc;Ja.yZd=hd;Ja.operationFlags=Cd;return Ja}function A(Ja,
Lb,mc){var xc=I.call(this,Ja,new Sys.UI.Point(A.qch,A.Tbh),Wd.a.instance.ga(Lb?1250:1249))||this;xc.u0a=null;xc.uKc=!1;xc.hoc=function(hd){function Cd(Bb,qc,Nc){return Da.m(dc.oa.xa,xb.b(Bb,xc.aRi),qc,Nc,Ec)}var dc=xc.$,Ec=new z;Ec.kH=hd.Values[x.kH];var gb=!1;switch(hd.MessageId){case x.W_f:xc.It();gb=!0;Ec.fDd=1334518759;break;case x.view:xc.fBa=Wd.a.instance.ga(1250);xc.adg(!0);break;case x.oye:xc.It(),gb=!0}Td.EwaSettings.Zb()?(hd=new Ic.a(140,0,Cd),hd.flags=gb?16:80):(hd=gb?new Ic.a(140,0,Cd):
new nc.a(140,0,Cd),hd.flags=16);dc.userOperationManager.Sb(hd,xc.Ed)};xc.ZIi=function(){var hd=xc.$;hd.ya.SurveyRedirectUrl?(xc.It(),hd.Fd(1305810481,0,8,null)):(xc.fBa=Wd.a.instance.ga(1249),xc.adg(!1))};xc.oRi=function(){var hd=xc.$;xc.It();hd.Fd(1334518759,0,8,null)};xc.rmc=function(hd){var Cd=xc.$;xc.It();hd.MessageId===x.yye&&Cd.ea.Fad()};xc.GPi=function(){xc.uKc=!0;xc.raiseEvent(A.lsd)};xc.aRi=function(hd,Cd){if(!hb.a(hd)){hd=xc.$;if(Cd.kH){var dc=hd.ea.va;if(dc.contains(Cd.kH.SheetName))xc.$mc(Cd);
else{var Ec=null;Ec=function(){dc.Ima(Ec);xc.$mc(Cd)};dc.Ega(Ec)}}1461300262!==Cd.fDd&&hd.Fd(Cd.fDd,0,8,null)}};xc.H8d=Lb;xc.Ed=mc;return xc}function z(){this.kH=null;this.fDd=1461300262}function x(){}function D(Ja){Ja=I.call(this,Ja,new Sys.UI.Point(960,680),Wd.a.instance.ga(1245))||this;Ja.name=Yd.a.IJe;return Ja}function I(Ja,Lb,mc,xc){var hd=ad.call(this,Ja,mc,2,void 0===xc?null:xc)||this;hd.gJc=null;hd.onResize=function(){var Cd=hd.yPh();hd.YKa.setAttribute("width",Cd.x.toString());hd.YKa.setAttribute("height",
Cd.y.toString());hd.rQj(Cd);hd.Ezd()};hd.KFe=Lb;hd.$.sA(hd.onResize);hd.wdc();return hd}function F(Ja){return ve.call(this,Ja)||this}function G(Ja){this.$=Ja}function T(Ja,Lb,mc,xc,hd,Cd,dc,Ec){Ec=Ja.Na(9,void 0===Ec?null:Ec);Ec.sheetName=Lb;Ec.directionRtl=mc;return Ac.g(Ja,"ChangeSheetDirection",Ec,xc,hd,Cd,dc,0)}function O(Ja,Lb,mc,xc,hd,Cd,dc,Ec){Ec=Ja.Na(9,void 0===Ec?null:Ec);Ec.sheetName=Lb;Ec.show=mc;return Ac.g(Ja,"ShowHeadings",Ec,xc,hd,Cd,dc,0)}function U(Ja,Lb,mc,xc,hd,Cd,dc,Ec){Ec=Ja.Na(9,
void 0===Ec?null:Ec);Ec.sheetName=Lb;Ec.show=mc;return Ac.g(Ja,"ShowGridlines",Ec,xc,hd,Cd,dc,0)}function J(Ja,Lb){this.sheetName=null;this.value=!1;this.sheetName=Ja;this.value=Lb}function H(Ja){return uc.call(this,Ja)||this}function K(Ja,Lb){this.oi=Lb;this.$=Ja}function N(Ja){var Lb=wb.call(this)||this;Lb.$=Ja;Lb.Eb();return Lb}function M(Ja){return Rc.call(this,Ja)||this}function C(Ja){this.ao="Excel";this.$=Ja;this.QU=Va.a.current}function Q(Ja,Lb,mc,xc,hd,Cd,dc){dc=Ja.Na(9,void 0===dc?null:
dc);dc.sheetName=Lb;dc.confirmationChoice=!0;return Ac.g(Ja,"DeleteSheet",dc,mc,xc,hd,Cd,0)}function P(){}function ka(Ja){var Lb=ac.call(this)||this;Lb.g_d=null;Lb.i_d=0;Lb.yQb=null;Lb._state=0;Lb.moveNext=function(){try{for(Lb._state=1;1===Lb._state;)Lb.wWa=Lb.wWa()}catch(mc){Lb.dispose(),Lb.nAa(mc),Lb._state=3}};Lb.qt=Ja;Lb.wWa=Lb.VCc;Lb.moveNext();return Lb}function R(){}function fa(Ja){return Mb.call(this,Ja)||this}function ca(Ja){this.oi=Ja}function ea(){}function wa(){}function X(Ja,Lb,mc,xc){this.$hb=
Ja;this.xqa=Lb;this.G1=mc;this.Fog=xc}function ja(Ja,Lb,mc,xc,hd,Cd,dc){var Ec=this;this.yo=null;this.Oee=!1;this.Ppa=this.J1d=0;this.psg=Ja;this.vWa=Lb;this.qUb=mc;this.$hb=xc;this.xqa=hd;this.G1=Cd;this.pDa=new Ga.a(function(){return new qa.a(dc.value,Object(da.a)(Ec,Ec.uvb,"getMoreInfoEventReceived"))})}function va(Ja,Lb,mc,xc,hd,Cd,dc,Ec){var gb=this;this.fFc=null;this.hSc=!0;this.JQb="";this.nxg=0;this.eWa=null;this.xLc=3;this.ib=Ec;this.G1=Ja;this.Xi=Lb;this.Qng=mc;this.Tkg=xc;this.Skg=hd;this.pDa=
new Ga.a(function(){return new qa.a(Cd.value,null)});this.Gog=new Ga.a(function(){return new qa.a(dc.value,Object(da.a)(gb,gb.hBi,"mruEventResultReceived"))});this.ib.qa("WacInTabOpenMRUIsEnabledForUiHost");this.ib.qa("UiHostSupportsDocRebootFeatures")}function ua(){return kb.call(this)||this}function Xa(Ja,Lb,mc,xc,hd,Cd){var dc=this;this.kRc=this.yo=this.KQb=null;this.BWb=this.vQc=!1;this.aae=0;this.jQc=this.DKc=!1;this.G1=Ja;this.$hb=Lb;this.pDa=new Ga.a(function(){return new qa.a(mc.value,Object(da.a)(dc,
dc.uvb,"getMoreInfoEventReceived"))});this.isg=xc;this.xqa=hd;this.Evg=Cd;this.mlb=this.Nwc;2===this.pK.gca&&(this.jQc=!0)}function aa(){this.folderName=this.folderUrl=this.hostName=this.hostUrl=null}function ba(){}function oa(){}b.r(E);var ra=b(1252),db=b(0),Ka=b(254);oa.prototype.Ph=function(){};oa.prototype.init=function(){};oa.prototype.dispose=function(){};oa.main=function(){Ka.a.instance.Qi(new oa)};Mf.Object.defineProperties(oa.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.DialogWithLinkToResource"}}});
Object(db.a)(oa,"CommonAppDialogWithLinkToResourcePackage",null,[10,11]);var Ga=b(615),xa=b(14),da=b(84),qa=b(1019),na=b(29),ia=b(132);ba.Vjh=function(Ja){return ba.Rte("New",Ja)};ba.Wjh=function(Ja){return ba.Rte("Open",Ja)};ba.Cte=function(Ja,Lb){return ba.jha("LoadingMenuSection",ba.Nsi,Ja,ba.Uob("lblLoading",Lb))};ba.Vob=function(Ja,Lb,mc,xc){return ba.jha("MessageMenuSection",ba.Jpf,Lb,ba.Uob("lblMessage",Ja,void 0===mc?null:mc,void 0===xc?null:xc))};ba.wQg=function(Ja){return ba.Cte(Ja,CommonUIStrings.l_VoicedLoadingText)};
ba.xQg=function(Ja,Lb){return ba.Vob(CommonUIStrings.l_NewCreationLocationMessage,Ja.mi,Lb.pR,Lb.Rna)};ba.vQg=function(Ja,Lb){return ba.Vob(String.format(CommonUIStrings.l_NewProvisioningStorageMessage,Lb.Rna,"\n\n"),Ja.mi)};ba.Ete=function(Ja){return ba.Vob(CommonUIStrings.l_NewGenericErrorMessage,Ja.mi)};ba.tQg=function(Ja,Lb,mc){return ba.jha("menuNewBlank",ba.X4h,mc?Ja.mi:null,ba.Pob(Ja.m6e,Ja.n6e,Ja.o6e,null,Ja.Oja,Ja.uxb,Lb,"blank"))};ba.sRg=function(){return ba.Uob("lblTemplatesLoading",CommonUIStrings.l_VoicedLoadingText)};
ba.Ote=function(){return ba.Uob("lblTemplatesError",CommonUIStrings.l_NewTemplateErrorMessage)};ba.tRg=function(Ja,Lb){return ba.jha("menuNewTemplates",Ja,null,Lb)};ba.rQg=function(Ja,Lb){return ba.jha("menuNewMoreTemplates",ba.BTe,null,ba.Pob("menuNewMoreTemplatesButton",CommonUIStrings.l_NewMoreTemplates,CommonUIStrings.l_NewMoreTemplates,null,null,null,Ja,Lb))};ba.vPg=function(Ja,Lb,mc){var xc="";mc&&Lb&&(xc=ba.jha("BrowseMoreMenuSection",ba.BTe,null,ba.Pob("btnBrowseMore",Lb,Lb,null,null,null,
Ja||"1959943459",mc)));return xc};ba.Uob=function(Ja,Lb,mc,xc){mc=void 0===mc?null:mc;var hd=xc=void 0===xc?null:xc;Lb&&0<Lb.length&&(hd=ba.Eqf.kpc(Lb).trimEnd(),hd=0<=hd.indexOf("{0}")?String.format(hd,xc):String.format("{0} {1}",hd,xc));mc=mc&&xc?String.format('\r\n\t\t\t\t\tInnerLink="{0}"\r\n\t\t\t\t\tInnerLinkText="{1}"\r\n\t\t\t\t\tInnerLinkTitle="{2}"',na.a.af(mc),na.a.af(xc),na.a.af(hd)):"";return String.format('\r\n\t\t\t\t<Label\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\t{2}/>',
na.a.af(Ja||""),ba.Eqf.kpc(na.a.af(Lb||"")),mc)};ba.Pob=function(Ja,Lb,mc,xc,hd,Cd,dc,Ec){return String.format('\r\n\t\t\t\t<Button\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\tDescription="{2}"\r\n\t\t\t\t\tImage{3}Class="{4}"\r\n\t\t\t\t\tImage{3}="{5}"\r\n\t\t\t\t\tCommand="{6}"\r\n\t\t\t\t\tMenuItemId="{7}"/>',na.a.af(Ja||""),na.a.af(Lb||""),na.a.af(mc||""),xc||"32by32",na.a.af(hd||""),na.a.af(Cd||""),dc,na.a.af(Ec||""))};ba.Rte=function(Ja,Lb){return String.format('\r\n\t\t\t\t<Menu Id="menuJewel{0}">{1}\r\n\t\t\t\t</Menu>',
Ja,Lb)};ba.jha=function(Ja,Lb,mc,xc){mc=mc?String.format('Title="{0}"',na.a.af(mc)):"";return String.format('\r\n\t\t\t\t<MenuSection\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tDisplayMode="{1}"\r\n\t\t\t\t\t{2}\r\n\t\t\t\t\tShowMenuSectionSeparator="false">\r\n\t\t\t\t\t<Controls>{3}\r\n\t\t\t\t\t</Controls>\r\n\t\t\t\t</MenuSection>',na.a.af(Ja||""),na.a.af(Lb||""),mc,xc)};ba.Jpf="MenuMru";ba.Nsi="MenuLoading";ba.X4h="MenuHeader";ba.BTe="MenuFooter";ba.Eqf=ia.a.ux("\n","&#10;");Object(db.a)(ba,"NewAndOpenXmlUtilities",
null,[]);var ta=b(4),za=b(99),sa=b(167);Object(db.a)(aa,"HostInformation",null,[]);var V=b(108),Ia=b(39),Ha=b(391),ob=b(170),ib=b(740),La=b(640),zb=b(107),Fb=b(25);Xa.prototype.Bg=function(){var Ja=this.pK.E8a;Ja.Mb(Fb.a.newDocument,zb.a.frame,Object(da.a)(this,this.newDocument,"newDocument"));Ja.He(Fb.a.Cpc,zb.a.frame,Object(da.a)(this,this.Cpc,"populateNewMenu"),96)};Xa.prototype.newDocument=function(Ja,Lb,mc,xc,hd){return 1===mc?32:2===mc&&hd&&hd.MenuItemId&&hd.SourceControlId?this.m0a(hd.MenuItemId,
hd.SourceControlId):8};Xa.prototype.m0a=function(Ja,Lb){var mc=this.tlc.e3c;if(null===mc)return 8;var xc=ta.AFrameworkApplication.fa.qa("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");if(ta.AFrameworkApplication.Dka&&xc){xa.ULS.sendTraceTag(51455198,202,50,"CreateNewActor.CreateNewDocument: Sending CreateNewDocument post message.");var hd={};hd[Ha.a.T7f]=Ja;hd[Ha.a.nP]=this.nP;hd[Ha.a.lcid]=ta.AFrameworkApplication.lcid.toString();hd[Ha.a.reason]=ib.a.createNew;ta.AFrameworkApplication.$U().execute(function(Cd){Cd.uj(ob.a.m0a,
hd)})}else xc=(new Date).getTime(),Lb=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&or=wacFileNew&bid={6}&Canary={7}&{8}",mc,na.a.$e(this.rla),na.a.$e(Ja),na.a.$e(this.nP),na.a.$e(ta.AFrameworkApplication.lcid.toString()),na.a.$e(xc.toString()),na.a.$e(Lb),na.a.$e(ta.AFrameworkApplication.canary),ta.AFrameworkApplication.Yi),(mc=ta.AFrameworkApplication.fa.Wa("ScenarioId"))&&""!==mc&&(Lb+="&wdscenarioid="+na.a.$e(mc)),Lb+="&"+ta.AFrameworkApplication.Nbc(),
ta.AFrameworkApplication.Bwa&&(Lb+="&"+ta.AFrameworkApplication.ebc()),(mc=this.yo?this.yo.pR:null)&&(Lb+="&DestinationUrl="+na.a.$e(mc)),Ia.a.Ze(Lb,"_blank",void 0,"CreateNewDocument");2===this.pK.gca&&(Lb={},xa.ULS.sendTraceTag(24700384,202,50,"CreateNewDocument from New Menu {0}",(Lb.AppType=La.a[this.pK.gca],Lb.Template=Ja,Lb)));return 32};Xa.prototype.Uvi=function(Ja){var Lb=Number.MAX_VALUE,mc=Number.MIN_VALUE,xc=window.performance;if(xc&&"undefined"!==typeof xc.getEntriesByName){for(var hd=
0;hd<Ja.length;hd++){var Cd=xc.getEntriesByName(Ja[hd]);Cd&&0<Cd.length&&(Cd=Cd[0],Lb=Math.min(parseInt(String(Cd.fetchStart)),Lb),mc=Math.max(parseInt(String(Cd.responseEnd)),mc))}mc>Lb&&(Ja={},xa.ULS.sendTraceTag(5849601,202,50,"Total time to download template thumbnails {0}",(Ja.TotalElapsedMs=mc-Lb,Ja.MinFetchStart=Lb,Ja.MaxResponseEnd=mc,Ja)))}};Xa.prototype.Cpc=function(Ja,Lb,mc,xc,hd){if(1===mc)return this.jQc&&(ta.AFrameworkApplication.$M("Microsoft.Office.Server.Powerpoint.Web.IPptMoreThemesInNewMenuSettings"),
this.jQc=!1),32;2!==mc||this.DKc||(this.aae=(new Date).getTime(),Ja={},xa.ULS.sendTraceTag(5849602,202,50,"File New menu flyout opened by user {0}",(Ja.ShouldShowTemplates=this.Nwc,Ja.CachedNewMenuXmlExists=!!this.KQb,Ja.ShouldCallGetMoreInfo=this.pK.supportsGetMoreInfoForPersonalStorage,Ja)));return this.IYi(hd)};Xa.prototype.IYi=function(Ja){Ja&&(this.KQb?Ja.PopulationXML=this.KQb:(this.pK.supportsGetMoreInfoForPersonalStorage&&!this.yo&&this.BCi.uZ("Opened New menu",!0),Ja.PopulationXML=this.qGh(this.getTemplateListJson())));
return 32};Xa.prototype.Xef=function(){return!this.pK.supportsGetMoreInfoForPersonalStorage||!!this.yo&&3===this.yo.state&&!!this.yo.Rna&&!!this.yo.pR};Xa.prototype.Lki=function(){return ta.AFrameworkApplication.ta&&ta.AFrameworkApplication.ta.Qa.XZ?!0:this.Xef()};Xa.prototype.getTemplateListJson=function(){var Ja=this;if(!this.Nwc||!this.Lki())return null;if(this.mlb&&!this.BWb){var Lb="9",mc=ta.AFrameworkApplication.fa.appSettings;"NumberOfTemplatesInBackstage"in mc&&(Lb=mc.NumberOfTemplatesInBackstage);
var xc=this.nP;"TemplateCollectionId"in mc&&(xc=mc.TemplateCollectionId);Lb=String.format(this.pK.IV+"TemplateServiceProxy.ashx?lcid={0}&apps={1}&show={2}",na.a.$e(ta.AFrameworkApplication.lcid.toString()),na.a.$e(xc),Lb);Boolean.parse(mc.AppendOriginQueryParam||"false")&&(Lb+="&org=backstage");Lb+="&"+ta.AFrameworkApplication.Nbc();ta.AFrameworkApplication.Bwa&&(Lb+="&"+ta.AFrameworkApplication.ebc());this.pK.bDb.Yl(Lb,1,null,null,!1,2,function(hd){Ja.pK.Xba("CreateNewActor.GetTemplateListJson",
hd.data);Ja.zHj(hd.data.Td)},function(hd){Ja.pK.Xba("CreateNewActor.GetTemplateListJson",hd.data);Ja.yHj()},null,void 0,void 0,void 0,void 0,"5");this.mlb=!1}return this.kRc};Xa.prototype.zHj=function(Ja){this.kRc=Ja;this.mlb=!1;this.lHb();if(ta.AFrameworkApplication.ta&&ta.AFrameworkApplication.ta.Qa.XZ&&sa.c()){Ja=ta.AFrameworkApplication.fa.qa("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");var Lb=ta.AFrameworkApplication.Dka;appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson(this.kRc,
!0,Ja&&Lb))}};Xa.prototype.yHj=function(){this.BWb=this.mlb=!0;this.lHb();ta.AFrameworkApplication.ta&&ta.AFrameworkApplication.ta.Qa.XZ&&sa.c()&&appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson("",!1,!1));za.Health.instance.recordQosError("TemplateServiceReturnedFailure",["TemplateServiceFailed"],!1,!0,!0,!1,null)};Xa.prototype.AYh=function(Ja){for(var Lb=0,mc=0;mc<Ja.length;mc++)if("ST"===Ja[mc].ImageType){Lb=mc;break}var xc=Ja.length?Ja[Lb]:null;Ja=xc?xc.Url||"":"";var hd,Cd=mc=
Lb=!1;if(xc&&(hd=xc.AspectRatio))hd=parseFloat(hd),1>hd?Lb=!0:1.5<hd?mc=!0:1===hd&&(Cd=!0);else switch(hd={},xa.ULS.sendTraceTag(5849603,202,10,"Thumbnail aspect ratio missing {0}",(hd.Url=Ja,hd)),this.pK.gca){case 3:Lb=!0;break;case 2:mc=!0;break;case 5:Cd=!0}return{returnValue:Ja,B7h:Lb?"95by123":mc?"123by69":Cd?"100by100":"123by95"}};Xa.prototype.qGh=function(Ja){var Lb=this.uQg(Ja,this.tlc,this.tlc.sGa||"1056925771");Ja=Lb.returnValue;if(Lb.mwc){this.KQb=Ja;Lb=(new Date).getTime()-this.aae;var mc=
{};xa.ULS.sendTraceTag(5849604,202,50,"New menu rendering completed by GenerateXMLFromJSON {0}",(mc.ElapsedMsSinceMenuOpened=Lb,mc))}return Ja};Xa.prototype.uvb=function(Ja,Lb){xa.ULS.sendTraceTag(590964757,202,50,"GetMoreInfoEventReceived");this.yo||3!==Ja.state?2===Ja.state&&(xa.ULS.sendTraceTag(590964759,202,50,"GetMoreInfoResult was bad, need to retry"),this.vQc=!0,this.lHb()):(this.yo=Ja,Lb||this.lHb(),ta.AFrameworkApplication.ta&&ta.AFrameworkApplication.ta.Qa.XZ&&sa.c()&&sa.d("setFileMenuHostInformation")&&
(Ja=Object.assign(new aa,{hostUrl:this.yo.pR,hostName:this.yo.Rna,folderUrl:ta.AFrameworkApplication.breadcrumbFolderUrl,folderName:ta.AFrameworkApplication.breadcrumbFolderName}),xa.ULS.sendTraceTag(590964758,202,50,"Sending HostInformation to FileMenu"),appChrome.api.dispatch(appChrome.actions.setFileMenuHostInformation(Ja))))};Xa.prototype.uQg=function(Ja,Lb,mc){var xc=!1;var hd=this.Xef(),Cd="";if(this.pK.supportsGetMoreInfoForPersonalStorage)if(this.vQc)Cd=ba.Ete(Lb),this.vQc=!1,xa.ULS.sendTraceTag(5849605,
202,10,"Rendering File>New with error message due to GetMoreInfo request failure");else if(this.yo)if(hd)Cd=ba.xQg(Lb,this.yo);else if(this.yo.Obi)xc=!0,this.mlb=!1,Cd=ba.vQg(Lb,this.yo),xa.ULS.sendTraceTag(5849607,202,50,"Rendering File>New with personal storage instantiation message");else{xc=!0;Cd=ba.Ete(Lb);var dc={};xa.ULS.sendTraceTag(5849608,202,10,"Rendering File>New with error message due to GetMoreInfo invalid response. {0}",(dc.PersonalFileStorageUrlIsSet=!!this.yo.pR,dc.StorageServiceDisplayNameIsSet=
!!this.yo.Rna,dc))}else Cd=ba.wQg(Lb.mi),xa.ULS.sendTraceTag(5849606,202,50,"Rendering File>New with loading spinner");hd&&(hd=Cd,Lb=ba.tQg(Lb,mc,!Cd),Ja=this.rRg(Ja,mc),xc=Ja.mwc,Cd=hd+(Lb+Ja.returnValue));return{returnValue:ba.Vjh(Cd),mwc:xc}};Xa.prototype.rRg=function(Ja,Lb){var mc=!1;if(!this.Nwc)return mc=!0,xa.ULS.sendTraceTag(5849609,202,50,"Rendering File>New without template buttons due to BRS"),{returnValue:"",mwc:mc};var xc="",hd="",Cd="MenuTemplate";if(this.BWb)xc=ba.Ote(),this.BWb=!1,
xa.ULS.sendTraceTag(5849610,202,10,"Rendering File>New with template error message");else if(Ja){try{var dc=Sys.Serialization.JavaScriptSerializer.deserialize(Ja,!0);xc=this.qRg(dc,Lb);xa.ULS.sendTraceTag(5849612,202,50,"Rendering File>New with template buttons");ta.AFrameworkApplication.Fqf&&"OneDrive"===this.rla&&(hd=ba.rQg(this.CCi,ta.AFrameworkApplication.Fqf))}catch(Ec){Lb={},xa.ULS.sendTraceTag(5849613,202,10,"Failed to parse JSON response from template service {0}",(Lb.JsonToConvert=Ja,Lb)),
xc=ba.Ote()}mc=!0}else Cd="MenuLoading",xc=ba.sRg(),xa.ULS.sendTraceTag(5849611,202,50,"Rendering File>New with template loading spinner");return{returnValue:ba.tRg(Cd,xc)+hd,mwc:mc}};Xa.prototype.qRg=function(Ja,Lb){for(var mc=this,xc="",hd=[],Cd=0;Cd<Ja.length;Cd++){var dc=Ja[Cd],Ec="";if(dc){var gb=dc.Title,Bb=dc.AssetId,qc=dc.Thumbnails;Bb&&gb&&qc&&(dc=void 0,Ec=this.AYh(qc),dc=Ec.B7h,Ec=Ec.returnValue,xc+=ba.Pob("jbtnNewTemplate"+Cd,gb,null,dc,null,Ec,Lb,Bb))}hd[Cd]=Ec}Ja=new V.a(4,1,5E3,function(){mc.Uvi(hd)},
106);this.pK.rlc.Dg(Ja);return xc};Xa.prototype.lHb=function(){this.DKc=!0;this.pK.xqf.Lw(this.tlc.Stb);this.DKc=!1};Mf.Object.defineProperties(Xa.prototype,{nP:{configurable:!0,enumerable:!0,get:function(){switch(this.pK.gca){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}},pK:{configurable:!0,enumerable:!0,get:function(){return this.G1.value}},tlc:{configurable:!0,enumerable:!0,get:function(){return this.$hb.value}},BCi:{configurable:!0,
enumerable:!0,get:function(){return this.pDa.value}},CCi:{configurable:!0,enumerable:!0,get:function(){return this.isg.value}},rla:{configurable:!0,enumerable:!0,get:function(){return this.xqa.value}},Nwc:{configurable:!0,enumerable:!0,get:function(){return this.Evg.value}}});Object(db.a)(Xa,"CreateNewActor",null,[]);var Yb=b(1537),kb=Yb.a;Rk(ua,kb);ua.prototype.qle=function(){this.tT(0,CommonUIStrings.l_OpenMenuEmptyMruMessage);this.tT(1,CommonUIStrings.l_OpenMenuServerErrorMessage);this.tT(2,CommonUIStrings.l_Open);
this.tT(3,CommonUIStrings.l_OpenMenuRecentDocuments);this.tT(4,CommonUIStrings.l_OpenMenuMoreOnHost);this.tT(5,CommonUIStrings.l_VoicedLoadingText)};ua.yUi=function(Ja){return ua.instance.ga(Ja)};Mf.Object.defineProperties(ua,{instance:{configurable:!0,enumerable:!0,get:function(){return ua.Ma||(ua.Ma=new ua)}}});ua.Ma=null;Object(db.a)(ua,"MruActorIntlHelper",Yb.a,[]);var vb;(function(Ja){Ja[Ja.success=0]="success";Ja[Ja.failure=1]="failure";Ja[Ja.spinner=2]="spinner";Ja[Ja.none=3]="none"})(vb||
(vb={}));Object(db.b)("DisplayState",vb);var Wa=b(41);va.prototype.hBi=function(Ja,Lb){this.eWa=Ja;Lb||this.EMf()};va.prototype.k8i=function(){this.rw.E8a.He(Fb.a.Bpc,zb.a.frame,Object(da.a)(this,this.Bpc,"populateMruMenu"),96)};va.prototype.Bpc=function(Ja,Lb,mc,xc,hd){return 1!==mc&&hd?this.FYi(hd):32};va.prototype.FYi=function(Ja){this.Akh();this.zkh();Ja.PopulationXML=ba.Wjh(this.JQb+this.fFc);return 32};va.prototype.Akh=function(){var Ja=3,Lb=!1;if(this.JQb&&this.nxg===this.eWa.jJj)Ja={},xa.ULS.sendTraceTag(5849627,
202,50,"Open menu MRU entries to XML conversion not required {0}",(Ja.CacheRefresh="Not Dirty",Ja)),Ja=this.xLc;else{var mc={};xa.ULS.sendTraceTag(5849628,202,50,"Open menu MRU entries to XML conversion started {0}",(mc.CacheRefresh="Starting",mc));mc=this.rw.aw();this.eWa=this.gBi.uZ("File Open opened",!0);if(this.JQb&&2!==this.xLc&&3!==this.eWa.state)Lb=!0;else{Ja=this.qWh(this.eWa);ta.AFrameworkApplication.ta&&ta.AFrameworkApplication.ta.Qa.XZ&&sa.c()&&Ja&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(Ja,
!0));var xc=this.rGh(this.eWa);Ja=xc.tCi;this.JQb=xc.returnValue}mc=this.rw.aw()-mc;xc={};xa.ULS.sendTraceTag(5849629,202,50,"Open menu MRU entries to XML conversion ended {0}",(xc.CacheRefresh="Complete",xc.ElapsedMs=mc,xc))}2!==Ja&&(mc={},mc=(mc.DisplayState=vb[Ja],mc),1!==Ja&&(mc.IsStale=Lb),xa.ULS.sendTraceTag(5849630,202,50,"MRU section display state {0}",mc));this.xLc=Ja};va.prototype.qWh=function(Ja){try{var Lb=Wa.c(Ja.Yvd)}catch(mc){Lb=null,xa.ULS.sendTraceTag(0,202,10,"MruActor.Serialize: Exception thrown from JsonSerializer.Serialize Exception: {0}",
mc)}return Lb};va.prototype.zkh=function(){if(this.hSc){xa.ULS.sendTraceTag(5849632,202,50,"Open menu Browse More Link creation necessary.");var Ja=this.nxi();this.hSc=Ja.kWj;this.fFc=Ja.returnValue}else xa.ULS.sendTraceTag(5849631,202,50,"Open menu Browse More Link creation not required.");Ja={};xa.ULS.sendTraceTag(5849633,202,50,"Browse More link display state {0}",(Ja.WaitingOnLinkInfo=this.hSc,Ja.NotDisplayingLink=!this.fFc,Ja))};va.prototype.rGh=function(Ja){if(1===Ja.state||0===Ja.state){Ja=
{};xa.ULS.sendTraceTag(5849635,202,50,"Open menu XML built {0}",(Ja.Display="Spinner",Ja));Ja=2;var Lb=ba.Cte(this.xja(2),this.xja(5))}else 3===Ja.state&&Ja.Yvd?(Lb=this.sQg(Ja.Yvd),Ja=0):(Ja={},xa.ULS.sendTraceTag(5849634,202,50,"Open menu XML built {0}",(Ja.Display="Server Error",Ja)),Lb=ba.Vob(this.xja(1),this.xja(2)),Ja=1);return{returnValue:Lb,tCi:Ja}};va.prototype.sQg=function(Ja){var Lb=this.wCb.sGa||"2155708348";if(Ja.length){var mc=ba.Uob("lblRecentDocuments",this.xja(3));for(var xc=0,hd=
0;hd<Ja.length;hd++){var Cd=Ja[hd];"FileName"in Cd&&"DocumentUrl"in Cd&&"Path"in Cd&&(mc+=ba.Pob("MruButton"+hd,Cd.FileName.toString(),Cd.Path.toString(),null,this.wCb.Oja,this.wCb.uxb,Lb,Cd.DocumentUrl.toString()),Cd.IsPinned&&xc++)}mc=ba.jha("RecentDocumentsMenuSection",ba.Jpf,this.xja(2),mc);Lb={};xa.ULS.sendTraceTag(5849665,202,50,"Open menu XML built {0}",(Lb.Display="MRU List",Lb.TotalDocuments=Ja.length,Lb.NumPinnedDocuments=xc,Lb))}else mc=ba.Vob(this.xja(0),this.xja(2)),Ja={},xa.ULS.sendTraceTag(5849664,
202,50,"Open menu XML built {0}",(Ja.Display="Empty MRU",Ja));return mc};va.prototype.nxi=function(){var Ja=!0;var Lb=this.OOg,mc=this.NOg;if(Lb&&mc||!this.rw.supportsGetMoreInfoForPersonalStorage)Ja=!1;else{var xc=this.mbc.uZ("File Open",!1);3===xc.state&&(Lb=xc.pR,mc=xc.Rna,Ja=!1)}mc=mc?String.format(this.xja(4),mc):null;return{returnValue:ba.vPg(this.wCb.sGa,mc,Lb),kWj:Ja}};va.prototype.EMf=function(){this.rw.xqf.Lw(this.wCb.Stb)};Mf.Object.defineProperties(va.prototype,{rw:{configurable:!0,enumerable:!0,
get:function(){return this.G1.value}},xja:{configurable:!0,enumerable:!0,get:function(){return this.Xi.value}},wCb:{configurable:!0,enumerable:!0,get:function(){return this.Qng.value}},OOg:{configurable:!0,enumerable:!0,get:function(){return this.Tkg.value}},NOg:{configurable:!0,enumerable:!0,get:function(){return this.Skg.value}},mbc:{configurable:!0,enumerable:!0,get:function(){return this.pDa.value}},gBi:{configurable:!0,enumerable:!0,get:function(){return this.Gog.value}}});Object(db.a)(va,"MruRenderer",
null,[]);var qb=b(246),yb=b(977);ja.prototype.m0a=function(){!this.yo&&this.Hwd.supportsGetMoreInfoForPersonalStorage?this.mbc.uZ("NewDocumentFromStream",!0):this.createNewDocumentFromStream()};ja.prototype.uvb=function(Ja){if(!this.yo&&3===Ja.state)this.yo=Ja;else if(2===Ja.state){this.Oee?xa.ULS.sendTraceTag(24904471,202,10,"After second try GetMoreResult still fail."):(this.mbc.uZ("NewDocumentFromStream",!0),this.Oee=!0);return}this.createNewDocumentFromStream()};ja.prototype.createNewDocumentFromStream=
function(){this.J1d=(new Date).getTime();var Ja=this.Hyh.e3c;if(null===Ja)this.vWa(null);else{var Lb=this.qUb.menuItemId,mc=this.qUb.OF,xc=this.qUb.hFj,hd=this.qUb.Myh;this.Ppa="streamBase64"===xc?hd.length/1024:0;xa.ULS.sendTraceTag(35156358,202,50,"FileType:{0}, FileSize:{1}",this.nP,this.Ppa);var Cd=(new Date).getTime();Ja=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&bid={6}&Canary={7}&{8}&sa={9}",Ja,na.a.$e(this.rla),na.a.$e(Lb),na.a.$e(this.nP),na.a.$e(ta.AFrameworkApplication.lcid.toString()),
na.a.$e(Cd.toString()),na.a.$e(mc),na.a.$e(ta.AFrameworkApplication.canary),ta.AFrameworkApplication.Yi,na.a.$e(xc));Ja+="&"+ta.AFrameworkApplication.Nbc();ta.AFrameworkApplication.Bwa&&(Ja+="&"+ta.AFrameworkApplication.ebc());(Lb=this.yo?this.yo.pR:null)&&(Ja+="&DestinationUrl="+na.a.$e(Lb));this.Hwd.bDb.Yl(Ja,2,hd,{"Content-Type":"application/json; charset=utf-8"},!0,2,Object(da.a)(this,this.wCi,"newDocumentFromStreamSuccessHandler"),Object(da.a)(this,this.vCi,"newDocumentFromStreamFailureHandler"),
null,void 0,void 0,void 0,void 0,"31")}};ja.prototype.wCi=function(Ja){if(Ja&&Ja.data&&Ja.data.Td){var Lb=Wa.d(Ja.data.Td);var mc=Lb.Lt;Lb.returnValue?mc.StatusCode!==qb.a.JO&&mc.StatusCode!==qb.a.prb?(xa.ULS.sendTraceTag(24904475,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: StatusCode: {2}",this.nP,this.Ppa,mc.StatusCode),this.vWa(null)):mc.NewDocumentUrl&&""!==mc.NewDocumentUrl?(Ja=(new Date).getTime()-this.J1d,xa.ULS.sendTraceTag(35156359,202,50,"FileType:{0}, FileSize:{1}, TimeConsumed:{2}",
this.nP,this.Ppa,Ja),this.psg(mc.NewDocumentUrl)):(xa.ULS.sendTraceTag(24904476,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data do not have NewDocumentUrl.",this.nP,this.Ppa),this.vWa(null)):(mc={},xa.ULS.sendTraceTag(24904474,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Failed to deserialize: {2}",this.nP,this.Ppa,(mc.ResponseData=yb.a.ueb(Ja.data.Td),mc)),this.vWa(null))}else xa.ULS.sendTraceTag(24904473,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data is null",
this.nP,this.Ppa),this.vWa(null)};ja.prototype.vCi=function(Ja){Ja&&Ja.data&&xa.ULS.sendTraceTag(24904477,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: ErrorStatus: {2}",this.nP,this.Ppa,Ja.data.status);this.vWa(null)};Mf.Object.defineProperties(ja.prototype,{nP:{configurable:!0,enumerable:!0,get:function(){switch(this.Hwd.gca){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}},Hyh:{configurable:!0,enumerable:!0,
get:function(){return this.$hb.value}},rla:{configurable:!0,enumerable:!0,get:function(){return this.xqa.value}},Hwd:{configurable:!0,enumerable:!0,get:function(){return this.G1.value}},mbc:{configurable:!0,enumerable:!0,get:function(){return this.pDa.value}}});Object(db.a)(ja,"NewDocumentFromStreamOperation",null,[]);X.prototype.create=function(Ja,Lb,mc){return new ja(Ja,Lb,mc,this.$hb,this.xqa,this.G1,this.Fog)};Object(db.a)(X,"NewDocumentFromStreamOperationFactory",null,[956]);var ec=b(83),Ob=
b(567),Cb=b(58);wa.prototype.Ph=function(Ja){Ja.register(X,"Common.App.NewAndOpen.UX.NewDocumentFromStreamOperationFactory").as("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory").tc().Cc(function(){return new X(new Ga.a(function(){return ta.AFrameworkApplication.ta.Qa.ddd()}),new Ga.a(function(){return ta.AFrameworkApplication.rla}),new Ga.a(function(){return Ja.mh("Common.INewAndOpenCommonHelpers")}),new Ga.a(function(){return Ja.mh("Common.IEventEmitter<Common.IGetMoreInfoResult>")}))})};
wa.prototype.init=function(){var Ja=this;ta.AFrameworkApplication.fa.Su(function(){Ja.Lxb()})};wa.prototype.Lxb=function(){var Ja=Ob.a.Jq(ec.a.instance.Tb("Common.INewAndOpenCommonHelpers")),Lb=Ob.a.Jq(ec.a.instance.Tb("Common.IEventEmitter<Common.IGetMoreInfoResult>"));ta.AFrameworkApplication.rla&&Cb.Task.WAA.call(null,Ja,Lb).continueWith(function(){var xc=new Xa(new Ga.a(function(){return Ja.result}),new Ga.a(function(){return ta.AFrameworkApplication.ta.Qa.ddd()}),new Ga.a(function(){return Lb.result}),
new Ga.a(function(){return ta.AFrameworkApplication.ta.Qa.edd().sGa||"1959943459"}),new Ga.a(function(){return ta.AFrameworkApplication.rla}),new Ga.a(function(){return ta.AFrameworkApplication.tji}));xc.Bg();xc.lHb()});if(ta.AFrameworkApplication.dLf){var mc=Ob.a.Jq(ec.a.instance.Tb("Common.IEventEmitter<Common.IMruResult>"));Cb.Task.WAA.call(null,Ja,Lb,mc).continueWith(function(){var xc=new va(new Ga.a(function(){return Ja.result}),new Ga.a(function(){return ua.yUi}),new Ga.a(function(){return ta.AFrameworkApplication.ta.Qa.edd()}),
new Ga.a(function(){return ta.AFrameworkApplication.xUi}),new Ga.a(function(){return ta.AFrameworkApplication.wUi}),new Ga.a(function(){return Lb.result}),new Ga.a(function(){return mc.result}),ta.AFrameworkApplication.fa);xc.k8i();xc.EMf()})}};wa.prototype.dispose=function(){};Mf.Object.defineProperties(wa.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.NewAndOpen.UX"}}});Object(db.a)(wa,"UXPackageManager",null,[10,11,3]);var ab=b(1372),ya=b(1378),ma=b(1354),ha=b(1388),
Z=b(1379),Na=b(1410),eb=b(1494),cb=b(1047),Ua=b(27);ea.prototype.$je=function(Ja){var Lb=!1;Ja&&(Ja.s2c(),Ja.KRg&&(Lb=!1));return Lb};ea.prototype.C4g=function(){var Ja=ta.AFrameworkApplication.ta.Qa;Ja=new eb.a(Ja.Cj,cb.a.jcc(),!1,1===Ja.lca);this.$je(Ja)&&xa.ULS.sendTraceTag(17571982,306,50,"ChromeExtBannerDisplayed")};ea.prototype.H4b=function(Ja,Lb,mc,xc,hd,Cd){Ja=new eb.a(Ja,mc,xc,Lb,hd,Cd);this.$je(Ja)&&xa.ULS.sendTraceTag(9208407,306,50,"AppBusinessBarDisplayed")};ea.prototype.H$g=function(){var Ja=
ta.AFrameworkApplication.ta.Qa,Lb=ta.AFrameworkApplication.fa,mc=Ja.Cj,xc=1===Ja.lca;if(Lb.qa(cb.a.j_h(mc))){var hd=cb.a.jcc(),Cd=8<Ua.a.W4a;if(2!==mc||2!==hd||!xc){Lb=Lb.qa(cb.a.k_h(mc));var dc=Ja.jUf(),Ec=function(){return Ja.qx};Lb&&!cb.a.Ynd(cb.a.Xbd(mc))&&this.H4b(mc,xc,hd,Cd,Ec,dc)}}};ea.prototype.init=function(){var Ja=ta.AFrameworkApplication.fa,Lb=Ja.qa("WildFireChromeExtensionEnabled");Ja=Ja.qa("WildFireChromeExtensionBar")&&Lb;cb.a.Qwc&&Ja&&!cb.a.Ynd(cb.a.ixe)?this.C4g():(document.body&&
cb.a.sxj&&this.H$g(),ta.AFrameworkApplication.ub.Mb(Fb.a.csd,zb.a.frame,Object(da.a)(this,this.csd,"launchWildFireBusinessBar")))};ea.prototype.csd=function(Ja,Lb,mc,xc,hd){if(1===mc)return 32;if(!hd)return 8;this.H4b(hd.app,hd.mode,hd.platform,hd.useTwoButton,null,null);return 32};ea.prototype.dispose=function(){};ea.prototype.Ph=function(){};ea.main=function(){Ka.a.instance.Qi(new ea)};Mf.Object.defineProperties(ea.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.WildFire"}}});
Object(db.a)(ea,"PackageManager",null,[10,11]);var pa=b(1478);b(1265);var Qa=b(10),Db=b(905),Kb=b(51),Ab=b(37),ub=b(186);ca.prototype.Lc=function(){return!1};ca.prototype.executeCommand=function(Ja,Lb,mc){return 2!==this.oi.$d(Fb.a.newDocument,2,mc)?Cb.Task.Ua(!0):ub.a(Lb.command)};ca.prototype.zc=function(Ja,Lb){return 1056925771===Lb.command};ca.prototype.Qc=function(Ja,Lb,mc){Ja=!0;switch(Lb){case "PopulateNewMenu":this.oi&&this.oi.$d(Fb.a.Cpc,2,mc);break;default:Ja=!1}return Ja};Object(db.a)(ca,
"CreateNewCommandHandler",null,[429]);var Mb=Db.a;Rk(fa,Mb);fa.prototype.Ad=function(){var Ja=this,Lb=Kb.GetServiceTaskFactory.create(this.$.da,155,this.la,this.hb),mc=Kb.GetServiceTaskFactory.create(this.$.da,165,this.la,this.hb);Ab.TaskExtensions.Aa(Ab.TaskExtensions.Vd([Lb,mc],this.la),function(){Ja.jd([new ca(ta.AFrameworkApplication.ub)])},this.la,3)};fa.ka=function(Ja){Db.a.Qd(87,new fa(Ja))};Object(db.a)(fa,"CreateNewCommandHandlerFactory",Db.a,[]);var Aa=b(1369),Za=b(1267),Zb=b(1411),jb=b(559),
Vb=b(103),Ic=b(177),Rb=b(11),kc=b(22),xb=b(294),Va=b(1198);R.create="Create";R.activate="Activate";R.close="Close";R.remove="Delete";R.duplicate="Duplicate";Object(db.a)(R,"Actions",null,[]);var tb=b(31),fb=b(42),ac=Cb.Task;Rk(ka,ac);ka.prototype.VCc=function(){this.g_d=tb.a.Xc(3,2,0,1647,0,-1244327602,"MsFormDeleteConfirmation");this.yQb=fb.a(this.qt.$).hj(this.g_d).G();this.yQb.isCompleted||(this._state=2,this.yQb.b9a(this.moveNext));return this.xgg};ka.prototype.xgg=function(){this.i_d=this.yQb.uZ();
0===this.i_d&&(this.qt.$.workbookContext.Options=Rb.HelperMethods.bO(!1,this.qt.$.workbookContext.Options,2048),this.qt.deleteMsFormMetaDataSheet());this._state=3;this.kKb(!0)};ka.prototype.dispose=function(){};Object(db.a)(ka,"$$sm_Microsoft$Office$Excel$WebUI$Client$MsForm$MsFormCommandHandler$DeleteMsForm",Cb.Task,[3]);P.action="Action";P.eBh="FlexPane";P.d$b="formId";P.id="id";P.title="Title";P.fPb="XlWorkbookId";P.dDh="Fragment";P.host="Host";P.lKj="TopView";P.b2="auth_pvr";Object(db.a)(P,"Parameters",
null,[]);var Ac=b(62);C.prototype.Lc=function(Ja,Lb){switch(Lb){case -105284469:return!Vb.i(this.$.mg)||this.hasMsForm;case -1219864912:case 1674421386:case -1128532220:case 2023601781:return!this.hasMsForm}return!1};C.prototype.executeCommand=function(Ja,Lb){Ja=Ab.TaskExtensions.jk();Lb=Lb.command;switch(Lb){case -105284469:this.insertMsForm();break;case -1219864912:this.previewMsForm();break;case -1128532220:this.editMsForm();break;case 1674421386:this.sendMsForm();break;case 2023601781:Ja=this.deleteMsForm();
break;default:Ja=ub.a(Lb)}return Ja};C.prototype.zc=function(Ja,Lb){if(!this.$.ea.Jg.get(61))return!1;Ja=!1;switch(Lb.command){case -105284469:Ja=Vb.i(this.$.mg)&&!this.hasMsForm;break;case -1219864912:case 1674421386:case -1128532220:case 2023601781:Ja=this.hasMsForm}return Ja};C.prototype.Qc=function(){return!1};C.prototype.insertMsForm=function(){var Ja=na.a.nq(this.$.workbookContext.FullDocumentInfo.BreadcrumbDocName),Lb={},mc={};Lb[P.action]=R.create;Lb[P.b2]=this.b2;mc[P.action]=R.create;mc[P.fPb]=
encodeURIComponent(this.aPb);mc[P.host]=this.ao;mc[P.title]=encodeURIComponent(Ja);this.nCb(Lb,mc);this.$.workbookContext.Options=Rb.HelperMethods.bO(!1,this.$.workbookContext.Options,2048)};C.prototype.editMsForm=function(){var Ja={},Lb={};Ja[P.b2]=this.b2;Lb[P.d$b]=this.flc;Lb[P.fPb]=encodeURIComponent(this.aPb);Lb[P.host]=this.ao;this.nCb(Ja,Lb)};C.prototype.previewMsForm=function(){var Ja={},Lb={};Ja[P.b2]=this.b2;Lb[P.d$b]=this.flc;Lb[P.fPb]=encodeURIComponent(this.aPb);Lb[P.host]=this.ao;Lb[P.lKj]=
"Preview";this.nCb(Ja,Lb)};C.prototype.sendMsForm=function(){var Ja={},Lb={};Ja[P.b2]=this.b2;Lb[P.d$b]=this.flc;Lb[P.eBh]="SendForm";Lb[P.fPb]=encodeURIComponent(this.aPb);Lb[P.host]=this.ao;this.nCb(Ja,Lb)};C.prototype.deleteMsForm=function(){return new ka(this)};C.prototype.deleteMsFormMetaDataSheet=function(){var Ja=this;this.$.userOperationManager.Ot(new Ic.a(158,0,function(Lb,mc,xc){return Q(Ja.$.oa.mw,Ja.QU.Ytb,xb.b(Lb,function(){Ja.Rch()}),mc,xc,null)}))};C.prototype.Rch=function(){var Ja=
{},Lb={};Ja[P.action]=R.remove;Ja[P.b2]=this.b2;Lb[P.action]=R.remove;Lb[P.host]=this.ao;Lb[P.d$b]=encodeURIComponent(this.flc);Lb[P.fPb]=encodeURIComponent(this.aPb);this.nCb(Ja,Lb)};C.prototype.nCb=function(Ja,Lb){var mc=this.$.ya.MsFormBaseUrl+"/Pages/DesignPage.aspx",xc="",hd="";if(Lb){for(var Cd in Lb){var dc=Cd,Ec=Lb[Cd];hd+=hd.length?"&":"";hd+=dc+"="+Ec}Ja||(Ja={});Ja[P.dDh]=encodeURIComponent(hd)}if(Ja)for(var gb in Ja)Lb=gb,hd=Ja[gb],xc+=xc.length?"&":"?",xc+=Lb+"="+hd;window.open(mc+xc,
"_blank")};Mf.Object.defineProperties(C.prototype,{hasMsForm:{configurable:!0,enumerable:!0,get:function(){return Vb.c(this.$.mg)}},flc:{configurable:!0,enumerable:!0,get:function(){return this.$.workbookContext.MsFormId}},aPb:{configurable:!0,enumerable:!0,get:function(){return this.$.workbookContext.MsFormDocUrl}},b2:{configurable:!0,enumerable:!0,get:function(){return kc.a.contains(this.$.Iv.DocumentHostInfo.FileSource,"onedrive",!0)?"MSA":"OrgId"}}});Object(db.a)(C,"MsFormCommandHandler",null,
[429]);var Rc=Db.a;Rk(M,Rc);M.prototype.Ad=function(){var Ja=this,Lb=Kb.GetServiceTaskFactory.create(this.$.da,203,this.la,this.hb);Ab.TaskExtensions.Aa(Ab.TaskExtensions.Vd([Lb],this.la),function(){Ja.jd([new C(Ja.$)])},this.la,3)};M.ka=function(Ja){Ja.ea.Jg.get(61)&&Db.a.Qd(215,new M(Ja))};Object(db.a)(M,"MsFormCommandHandlerFactory",Db.a,[]);var Fc=b(232),wb=Fc.a;Rk(N,wb);N.prototype.create=function(){var Ja=this;Ab.TaskExtensions.Aa(Kb.GetServiceTaskFactory.create(this.$.da,164,this.la,this.hb),
function(){Ja.pb(new wa)},this.la,3)};Object(db.a)(N,"NewAndOpenUXFactory",Fc.a,[]);K.prototype.executeCommand=function(Ja,Lb,mc){Ja=2;switch(Lb.command){case Fb.a.openUrlInNewTab:Ja=this.oi.$d(Fb.a.openUrlInNewTab,2,mc);break;case Fb.a.EOa:Ja=this.oi.$d(Fb.a.EOa,2,mc)}return 2!==Ja?Cb.Task.Ua(!0):ub.a(Lb.command)};K.prototype.zc=function(Ja,Lb){return Lb.command===Fb.a.openUrlInNewTab||Lb.command===Fb.a.EOa};K.prototype.Qc=function(Ja,Lb,mc){return"PopulateMruMenu"===Lb?(this.oi.$d(Fb.a.Bpc,2,mc),
!0):!1};K.prototype.Lc=function(){return!1};Object(db.a)(K,"OpenFromMruCommandHandler",null,[429]);var uc=Db.a;Rk(H,uc);H.prototype.Ad=function(){var Ja=this,Lb=Kb.GetServiceTaskFactory.create(this.$.da,155,this.la,this.hb),mc=Kb.GetServiceTaskFactory.create(this.$.da,165,this.la,this.hb);Ab.TaskExtensions.Aa(Ab.TaskExtensions.Vd([Lb,mc],this.la),function(){Ja.jd([new K(Ja.$,ta.AFrameworkApplication.ub)])},this.la,3)};H.ka=function(Ja){Db.a.Qd(88,new H(Ja))};Object(db.a)(H,"OpenFromMruCommandHandlerFactory",
Db.a,[]);var Pb=b(1346),sc=b(1385),nb=b(1427),pc=b(1270),Dc=b(1365),oc=b(1271),Gc=b(1272),ld=b(1370),gd=b(1412),Cc=b(1413),kd=b(85),Fd=b(388),rb=b(101),Kd=b(21),Qd=b(390);J.prototype.getSheetName=function(){return this.sheetName};J.prototype.getValue=function(){return this.value};Object(db.a)(J,"MacroRecorderSheetOptionToggledPayload",null,[438]);G.prototype.Lc=function(){return!1};G.prototype.executeCommand=function(Ja,Lb){function mc(){return new J(xc.SheetName,Bb)}var xc={};this.$.Lj(xc);Ja=Lb.command;
var hd=Object(kd.a)(rb.a,this.$.va.getItemByName(xc.SheetName));if(!hd)return ub.a(Ja);switch(Ja){case 705559150:case -1411193626:var Cd=16;var dc=!hd.hideGridLines;var Ec=U;var gb=183;var Bb=hd.hideGridLines;break;case -2052321504:case 515737500:Cd=4;dc=!hd.headersVisible;Ec=O;gb=184;Bb=!hd.headersVisible;break;case -1478455630:Cd=2;dc=!hd.displayRtl;Ec=T;gb=185;Bb=!hd.displayRtl;Kd.g(this.$).Ea.FPj(dc);break;default:return ub.a(Ja)}hd.Dpb(Cd,dc);var qc=this.$.oa.xa;return Fd.a(this.$.userOperationManager,
function(Nc,nd,Vd){return Ec(qc,xc.SheetName,Bb,xb.b(Nc,function(oe){G.WEb(oe,hd,Cd,dc)}),xb.a(nd,function(){G.hEb(hd,Cd,dc)}),Vd,null)},function(Nc){return new Ic.a(gb,0,Nc,void 0,mc)},Lb)};G.prototype.zc=function(Ja,Lb){Ja=!1;switch(Lb.command){case -1411193626:case 515737500:case -1478455630:Ja=!0;break;case 705559150:case -2052321504:Ja=Qd.a(this.$)}return Ja};G.prototype.Qc=function(){return!1};G.WEb=function(Ja,Lb,mc,xc){tb.a.Uq(Ja.Errors)&&Lb.Dpb(mc,!xc)};G.hEb=function(Ja,Lb,mc){Ja.Dpb(Lb,
!mc)};Object(db.a)(G,"SheetOptionsToggleCommandHandler",null,[429]);var ve=Db.a;Rk(F,ve);F.prototype.Ad=function(){this.jd([new G(this.$)])};F.ka=function(Ja){Db.a.Qd(100,new F(Ja))};Object(db.a)(F,"SheetOptionsToggleCommandHandlerFactory",Db.a,[]);var Be=b(178),Ie=b(207),se=b(154),Se=b(64),Le=b(59),rf=b(216),af=b(649),xe=b(91),Td=b(1),Bc=b(258),qd=b(218),Jd=b(12),ad=qd.a;Rk(I,ad);I.prototype.initialize=function(){var Ja=this.$.yb+"iframeDialog_frame",Lb=this.$.yb+"iframeDialog";var mc=String.format('<iframe id="{0}" frameborder="0" scrolling="auto" src="{1}">\r\n</iframe>',
Ja,this.rYe(Lb));this.Gb.style.margin=Rb.HelperMethods.jc(0);this.Gb.style.marginBottom=Rb.HelperMethods.jc(-2);this.Gb.innerHTML=mc;this.gJc=document.getElementById(Ja);this.domElement.id=Lb;this.onResize(null,Sys.EventArgs.Empty);ad.prototype.initialize.call(this)};I.prototype.dispose=function(){this.$&&this.$.gD(this.onResize);ad.prototype.dispose.call(this)};I.prototype.setFocus=function(){Jd.DOMElementExtensions.setFocus(this.YKa)};I.prototype.onHide=function(){this.YKa.contentWindow.close();
Jd.DOMElementExtensions.ff(this.YKa);this.gJc=null;ad.prototype.onHide.call(this)};I.prototype.rQj=function(Ja){var Lb=this.domElement.style;Lb.width=Rb.HelperMethods.jc(Ja.x);Lb.marginLeft=Rb.HelperMethods.jc(-Ja.x/2)};I.prototype.yPh=function(){var Ja=Jd.DOMElementExtensions.getBounds(document.body);return new Sys.UI.Point(Math.min(Math.floor(.9*Ja.width),this.KFe.x),Math.min(Math.floor(.9*Ja.height),this.KFe.y))};Mf.Object.defineProperties(I.prototype,{YKa:{configurable:!0,enumerable:!0,get:function(){return this.gJc}}});
Object(db.a)(I,"IFrameDialog",qd.a,[]);var Yd=b(5),pe=b(78),Wd=b(15);Rk(D,I);D.prototype.rYe=function(Ja){var Lb=new Sys.StringBuilder(this.$.ya.EmbedConfiguratorUrl);rf.a.Pg(Lb,Yd.a.Mmh,Ja);pe.a(this.$.ya,34)&&rf.a.Pg(Lb,Yd.a.LLe,"1");pe.a(this.$.ya,35)&&rf.a.Pg(Lb,Yd.a.MLe,"1");return Lb.toString()};D.prototype.onShow=function(){xa.ULS.sendTraceTag(537151690,0,50,"EmbeddingDialog.OnShow: the dialog is being shown");I.prototype.onShow.call(this)};Mf.Object.defineProperties(D.prototype,{nc:{configurable:!0,
enumerable:!0,get:function(){return"EmbeddingDialog"}}});Object(db.a)(D,"EmbeddingDialog",I,[]);var bf=b(1442),ke=b(89),cf=b(81),Pe=b(1030);x.W_f="FrameDialog_ShareFromEdit";x.view="FrameDialog_View";x.oye="FrameDialog_CloseAndRefresh";x.muj="FrameDialog_ShareFromView";x.edit="FrameDialog_Edit";x.C6i="FrameDialog_RefreshGrid";x.RYg="FrameDialog_CloseMe";x.yye="FrameDialog_CloseMeError";x.ready="FrameDialog_Ready";x.$Xi="FrameDialog_PleaseClose";x.kH="GotoRange";Object(db.a)(x,"PostMessageConstants",
null,[]);var nc=b(564),Da=b(255),Sb=b(121),hb=b(295),Xb=b(95);Object(db.a)(z,"SessionUpdateContext",null,[]);Rk(A,I);A.prototype.aFg=function(Ja){this.addHandler(A.lsd,Ja)};A.prototype.Yaj=function(Ja){this.removeHandler(A.lsd,Ja)};A.prototype.dispose=function(){ke.a.Ia(this.u0a);this.u0a=null;I.prototype.dispose.call(this)};A.prototype.initialize=function(){I.prototype.initialize.call(this);var Ja=cf.a.Oaa(this.$.ya.FormLightBoxUrl),Lb=this.u0a=new bf.a(this.YKa.contentWindow,Ja);Lb.isEnabled()&&
Lb.rFa(Ja)&&(this.zma(x.W_f,this.hoc),this.zma(x.view,this.hoc),this.zma(x.oye,this.hoc),this.zma(x.muj,this.oRi),this.zma(x.edit,this.ZIi),this.zma(x.C6i,this.hoc),this.zma(x.ready,this.GPi),this.zma(x.RYg,this.rmc),this.zma(x.yye,this.rmc))};A.prototype.close=function(Ja){Ja===this.closeAction&&this.sdf&&this.u0a.send(new Pe.a(x.$Xi))||I.prototype.close.call(this,Ja)};A.prototype.rYe=function(){return this.ECe(this.hhc)};A.prototype.ECe=function(Ja){var Lb=this.$.ya,mc=new Sys.StringBuilder(Lb.FormLightBoxUrl);
rf.a.Pg(mc,Yd.a.MCh,this.$.ea.sessionId);rf.a.Pg(mc,Yd.a.KCh,Ja?Yd.a.LCh:Yd.a.JCh);Sb.a.RYa(mc,Lb);return mc.toString()};A.prototype.adg=function(Ja){this.uKc=!1;this.YKa.src=this.ECe(Ja);this.H8d=Ja};A.prototype.zma=function(Ja,Lb){this.u0a.Tn(Ja);this.u0a.Ml(Ja,Lb)};A.prototype.$mc=function(Ja){var Lb=this.$.ea.va.getItemByName(Ja.kH.SheetName);Lb&&0===Lb.qy&&Kd.g(this.$).gg(Ja.kH,null,null,null,20,Xb.a.uCh)};Mf.Object.defineProperties(A.prototype,{nc:{configurable:!0,enumerable:!0,get:function(){return"FormDialog"}},
sdf:{configurable:!0,enumerable:!0,get:function(){return this.uKc}},hhc:{configurable:!0,enumerable:!0,get:function(){return this.H8d}}});A.qch=900;A.Tbh=1200;A.lsd="lightBoxReady";Object(db.a)(A,"FormDialog",I,[475]);var jc;(function(Ja){Ja[Ja.comment=10]="comment";Ja[Ja.range=12]="range";Ja[Ja.table=13]="table";Ja[Ja.chart=14]="chart"})(jc||(jc={}));Object(db.b)("NavigationType",jc);var Wc=b(1079),fd=b(118),Tc=b(19),td=b(621),Tb=b(1152),Fa=b(296),Qb=b(939),cc=b(53),bc=Qb.a;Rk(B,bc);B.prototype.initialize=
function(){var Ja="<div class='"+fd.a.Cn+"'>\r\n\t<div class='"+fd.a.aMe+"'>\r\n\t\t<div class='"+Tc.a.fye+"'>\r\n\t\t\t<img src='{0}' class='"+Tc.a.VOe+"' alt='{1}' />\r\n\t\t</div>\r\n\t</div>\r\n\t<div class='"+fd.a.eMe+"'>\r\n\t\t<p>{2}</p>\r\n\t</div>\r\n</div>";Ja=String.format(Ja,cc.a.Se(13),Wd.a.instance.ga(25),Wd.a.instance.ga(this.message));this.Gb.innerHTML=Ja;this.addButton(0,this.aFi);this.addButton(1);bc.prototype.initialize.call(this)};B.prototype.Jy=function(){return this.yZd};Mf.Object.defineProperties(B.prototype,
{nc:{configurable:!0,enumerable:!0,get:function(){return"WebMethodConfirmationDialog"}},sv:{configurable:!0,enumerable:!0,get:function(){return 1005}},Fsa:{configurable:!0,enumerable:!0,get:function(){return this.operationFlags}}});Object(db.a)(B,"WebMethodConfirmationDialog",Qb.a,[]);var Mc=Wc.a;Rk(w,Mc);w.prototype.dispose=function(){this.hTa&&this.hTa.dda(this.ZCf);ke.a.oc([this.textBox,this.JQa,this.hTa]);this.hTa=this.JQa=this.textBox=null;Mc.prototype.dispose.call(this)};w.prototype.initialize=
function(){var Ja="<div class='"+fd.a.Cn+"'>\r\n\t<span>{0}</span>\r\n</div>\r\n<div class='"+fd.a.U1a+"'>\r\n\t<input type='text' id='{1}' class='"+fd.a.vC+"' aria-live='polite' aria-atomic='true'/>\r\n\t<br />\r\n\t<a href='#' id='{2}' class='{3}'>{4}</a>\r\n</div>";Ja=String.format(Ja,Wd.a.instance.ga(1253),"sfd_input","sfd_unshare",Tc.a.Gp,Wd.a.instance.ga(1254));this.Gb.innerHTML=Ja;this.textBox=new Fa.a(this.getElementById("sfd_input"));this.JQa=new Tb.a(this.textBox.domElement);this.hTa=td.a.create(this.getElementById("sfd_unshare"));
this.hTa.p2(this.ZCf);this.textBox.text=Wd.a.instance.ga(739);this.textBox.enabled=!1;this.textBox.readOnly=!Ua.a.rh;this.addButton(1,10);Mc.prototype.initialize.call(this)};w.prototype.hha=function(){var Ja=this;return function(Lb,mc,xc){var hd=Ja.$.oa.xa.Pb(),Cd=Ja.$.oa.xa;Lb=Ja.cja(Lb);mc=Ja.Caa(mc);hd=Cd.Na(1,hd);return Ac.g(Cd,"ShareForm",hd,Lb,mc,xc,null,0)}};w.prototype.Xx=function(Ja,Lb,mc){this.textBox.text=Ja.Result;this.textBox.enabled=!0;Jd.DOMElementExtensions.setVisible(this.hTa.domElement,
!0);Mc.prototype.Xx.call(this,Ja,Lb,mc)};w.prototype.setFocus=function(){if(this.textBox&&this.textBox.enabled)try{this.textBox.focus();return}catch(Ja){}Mc.prototype.setFocus.call(this)};Mf.Object.defineProperties(w.prototype,{nc:{configurable:!0,enumerable:!0,get:function(){return"ShareFormDialog"}}});Object(db.a)(w,"ShareFormDialog",Wc.a,[]);var rd=b(252),Hd=b(6),ic=b(82),Jc=b(261),zd=b(67),sd=b(719),Pd=b(145),De=b(459),lc=b(187),Pc=b(266),md=b(16),bd=b(260),Od=Ie.a;Rk(m,Od);m.prototype.Lc=function(Ja,
Lb){Ja=this.$.workbookContext.FullDocumentInfo;switch(Lb){case 353606613:case -1099009678:case 192430811:return!Td.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)||this.$.ea.isNamedObjectViewMode||this.$.isMobileMode;case 869186573:return Lb=Pc.a()&&this.$.ea.Jg.get(5),!Ja.FileSharingUrl&&!Lb;case -1570751769:case 1986648902:return 131072!==(this.$.mQ&131072);case 330035228:return!(this.G2a(!0)&&this.KCc);case -509039657:return!(this.G2a()&&this.KCc);case 1334518759:return!(this.G2a()&&
this.KCc&&this.lve())}return!1};m.prototype.executeCommand=function(Ja,Lb,mc){Ja=this.$.workbookContext.FullDocumentInfo;var xc=Fb.a.workflow,hd=Ab.TaskExtensions.jk(),Cd=Lb.command;if(Cd===xc||-266099===Cd)return this.T3h(Lb,xc,Ja);switch(Cd){case 1986648902:this.k_f();break;case -1570751769:this.A1h(Lb);break;case 869186573:Lb=Fb.a.luj;hd=ta.AFrameworkApplication.fa.qa("ShareMenuIsEnabled");xc=null;(Td.EwaSettings.ma(556)||hd)&&mc&&"CopyLink"===mc.SourceControlId?(xc={},xc[Ha.a.VKb]="copy",Lb=Fb.a.V_f):
hd&&mc&&"ManageAccess"===mc.SourceControlId?(xc={},xc[Ha.a.VKb]="manageAccess",Lb=Fb.a.nuj):mc&&"LinkToComment"===mc.SourceControlId&&(xc={},xc[Ha.a.VKb]="copy",xc[Ha.a.XOd]=mc.navId,Lb=Fb.a.V_f);hd=this.j3f(Ja,xc);lc.c(Lb);break;case -1099009678:hd=this.WOd(12,Ja);break;case 192430811:hd=this.WOd(13,Ja);break;case 353606613:hd=this.WOd(14,Ja);break;case -59906385:case 1197060601:this.g3h(Lb,Ja);break;case 1305810481:this.r4e(!1,Lb);break;case 330035228:this.r4e(!0,Lb);break;case -509039657:this.deleteForm();
break;case 1334518759:Lb.Jyb=!0;this.shareForm();break;case 710925581:Le.a.qg.owc("710925581")&&(hd=Ab.TaskExtensions.Aa(this.OJ.value,function(dc){dc.result.uj(ob.a.conversation,{})},this.la,3));break;case 327119921:this.o1h();break;default:hd=ub.a(Cd)}return hd};m.prototype.zc=function(Ja,Lb){Ja=!1;Lb=Lb.command;if(Lb===Fb.a.workflow)return!0;switch(Lb){case 1986648902:case -1570751769:case 869186573:case -59906385:case 1197060601:case 1305810481:case 330035228:case -509039657:case 1334518759:case -266099:case 710925581:case 327119921:Ja=
!0;break;case 353606613:case -1099009678:case 192430811:Ja=Td.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)&&!this.$.ea.isNamedObjectViewMode}return Ja};m.prototype.Qc=function(Ja,Lb,mc){if("PopulateFormMenu"===Lb){Lb=this.KCc?this.lve()?m.Owh:m.Pwh:m.ACi;Ja=this.Va.Bc();for(var xc=0;xc<Lb.length;xc++)Ja.buttons.push(this.Va.nb(Lb[xc]));Lb=this.Va.jq("Forms.Flyout");Lb.pc.push(Ja);mc.MenuItems=Lb.$D();return!0}return!1};m.prototype.T3h=function(Ja,Lb,mc){return this.zLd&&
Ja.command===Lb?(this.xLd(Ja,-266099),Ab.TaskExtensions.Saa()):Ab.TaskExtensions.Aa(this.OJ.value,function(xc){af.a(xc.result,ob.a.workflow,null,mc.WorkflowPostMessage)||Rb.HelperMethods.Ze(mc.WorkflowUrl,"_blank",void 0,"SocialSharingCommandHandler.WorkflowUrl")},this.la,3)};m.prototype.lve=function(){return!!this.$.workbookContext.FullDocumentInfo.ShareFormCommandUrl||this.$.ea.Jg.get(26)};m.prototype.o1h=function(){var Ja=Be.a.create().toString();xa.ULS.sendTraceTag(528581128,306,50,"Calling share to teams deeplink with ID: "+
Ja);var Lb=this.$.frame,mc=Lb.B8a,xc=this.$,hd=new bd.QueryStringBuilder(ta.AFrameworkApplication.fa.Wa("TeamsMeetingShareEndpoint"));hd.Ei("deeplinkId",Ja);hd.Ei("lm","deeplink");Ja=hd.Ei;var Cd={};var dc=new bd.QueryStringBuilder(ta.AFrameworkApplication.fa.Wa("TeamsAppSharingUrl"));dc.Ei("auth","2");dc.Ei("flight","officeunihost");dc.Ei("source","TEAMS-ELECTRON.meetingStage.deeplink");var Ec={};Ec.fileType=na.a.Z3(xc.workbookContext.FullDocumentInfo.WorkbookPath).substring(1);Ec.objectUrl=xc.workbookContext.FullDocumentInfo.WorkbookPath;
Ec.baseUrl=xc.workbookContext.FullDocumentInfo.BreadcrumbBrandUrl;xc=xc.workbookContext.WorkbookFileVersionId;for(var gb=decodeURIComponent(xc);xc!=gb;)xc=gb,gb=decodeURIComponent(xc);0>xc.indexOf("{")||0>xc.indexOf("}")?(xa.ULS.sendTraceTag(528250338,306,15,"Decoded fileId does not match expected format. Decoded id: "+xc),xc=""):xc=xc.substring(xc.indexOf("{")+1,xc.indexOf("}")).toLowerCase();Ec.fileId=xc;Ec=Wa.c(Wa.c(Ec));dc.Ei("subEntityId",Ec.substring(1,Ec.length-1));Cd.appSharingUrl=dc.toString();
Cd.appId=ta.AFrameworkApplication.fa.Wa("TeamsAppId");Cd=JSON.stringify(Cd);Ja.call(hd,"appContext",Cd);mc.call(Lb,hd.toString(),!0)};m.prototype.A1h=function(Ja){this.zLd?this.xLd(Ja,1986648902):this.k_f()};m.prototype.r4e=function(Ja,Lb){!Ja&&this.$.ya.SurveyRedirectUrl?this.m1i():(Ja=new A(this.$,Ja,Lb),Ja.initialize(),Ja.gf())};m.prototype.g3h=function(Ja,Lb){var mc=this;this.zLd&&1197060601===Ja.command?this.xLd(Ja,-59906385):Ab.TaskExtensions.Aa(this.OJ.value,function(xc){xc=xc.result;xc&&af.a(xc,
ob.a.replyWithChanges,null,mc.$.ea.Jg.get(8))||(xc=new Sys.StringBuilder(Lb.ReplyWithChangesUrl),rf.a.Pg(xc,De.e,De.d),se.a.ntw(xc.toString(),mc.$))},this.la,3)};m.prototype.xLd=function(Ja,Lb){var mc=this,xc=zd.a(this.$).fd.activityState,hd=new xe.a(Lb,Ja.method,Ja.mode,Ja.Le,Ja.tabName);fb.a(this.$).Zs(new Bc.a(Hd.a.Zy,5,function(){xc[Jc.a.Oq]=Hd.a.kUf;xc[sd.a.bTc]=hd;mc.$.Nk.Dy("SocialSharingSaveBeforeCommand");mc.$.Nk.ble(hd.command)}))};m.prototype.k_f=function(){var Ja=this,Lb=this.$.ya.DocumentHostInfo;
Lb.HostEmbeddedViewUrl||this.bve?this.c2f():this.$.Jf.get(53)&&Ab.TaskExtensions.Aa(this.OJ.value,function(mc){Ja.hNj(mc.result)||se.a.ntw(Lb.FileEmbedCommandUrl,Ja.$)},this.la,3)};m.prototype.hNj=function(Ja){return Ja.isEnabled()&&(this.ave||(this.ave=Ja.Ml(ob.a.$ue,this.rGi)))?Ja.uj(ob.a.wyh,null):!1};m.prototype.c2f=function(){if(Ua.a.Wo)se.a.ntw(this.$.ya.EmbedConfiguratorUrl,this.$);else{var Ja=new D(this.$);Ja.initialize();Ja.gf()}};m.prototype.deleteForm=function(){var Ja=this.$,Lb=new B(Ja,
1258,1259,1251,function(mc,xc,hd){var Cd=Ja.oa.xa.Pb(),dc=Ja.oa.xa;Cd=dc.Na(9,Cd);Cd.surveyId=null;return Ac.g(dc,"DeleteSurvey",Cd,mc,xc,hd,null,0)});Lb.initialize();Lb.gf()};m.prototype.shareForm=function(){var Ja=this,Lb=this.$.workbookContext.FullDocumentInfo;if(this.$.ea.Jg.get(26)){var mc=new w(this.$);mc.initialize();mc.gf()}else Ab.TaskExtensions.Aa(this.OJ.value,function(xc){var hd={};af.a(xc.result,ob.a.shareForm,(hd[Ha.a.hGj]=Ja.$.workbookContext.SurveyTitle,hd),Ja.$.ea.Jg.get(10))||se.a.ntw(Lb.ShareFormCommandUrl,
Ja.$)},this.la,3)};m.prototype.m1i=function(){var Ja=this.$;Ja.ya.SurveyRedirectUrl.replace(RegExp("&startupdialog=[formedit|formpreview]","gi"),"");var Lb=new Sys.StringBuilder(Ja.ya.SurveyRedirectUrl);rf.a.Pg(Lb,"startupDialog","FormEdit");var mc=zd.a(this.$),xc=mc.fd.activityState;xc[ic.a.e2]=Lb.toString();xc[ic.a.LL]=ic.a.swd;this.$.Nk.Dy("SocialSharingEnvironmentChange");fb.a(Ja).Zs(new Bc.a(Hd.a.Zy,5,function(){var hd=tb.a.Xc(3,2,1303,1304,1305,554412057,"FossEnvironmentUnsupported");mc.fd.yt([hd]);
xc[Jc.a.Oq]=Hd.a.dbg}))};m.prototype.G2a=function(Ja){return(this.$.ea.isEditMode||(void 0===Ja?!1:Ja))&&this.$.ea.Jg.get(25)&&Pc.a()};m.prototype.JWh=function(Ja){var Lb=void 0===Lb?null:Lb;var mc=Kd.g(this.$).ha;var xc=this.$.va.pa?Se.d(this.$.va.pa):null;if(!xc)return xa.ULS.sendTraceTag(537151649,0,10,"SocialSharingCommandHandler.GetSharingDetail: Unable to find current sheet id for navType: {0}.",jc[Ja]),null;14===Ja?Lb=this.hWh(mc):12===Ja?(Lb=mc.Xha,Lb=kc.a.contains(Lb,"!",!0)?Lb.split("!")[1]:
Lb):13===Ja&&(mc=mc.sa.selectedRanges,mc[0]&&(mc=Kd.g(this.$).Ab.dk(mc[0])))&&(Lb=mc.Ai);if(!Lb)return xa.ULS.sendTraceTag(537151648,0,10,"SocialSharingCommandHandler.GetSharingDetail: Unable to find the selected range reference or object id for navType: {0}",jc[Ja]),null;mc={};mc[Ha.a.VKb]="copy";mc[Ha.a.XOd]=this.YMh(Ja,Lb,xc);xa.ULS.sendTraceTag(537151647,0,50,"SocialSharingCommandHandler.GetSharingDetail: Send Section_Sharing post message with navType: {0} and sectionNameOrId: {1} and SheetId: {2}",
jc[Ja],Lb,xc);return mc};m.prototype.hWh=function(Ja){if(Ja.Oa.O4&&(Ja=Ja.Oa.Yb.floatingObject)&&0===Ja.type){var Lb=Ja.id.split(".");if(1<Lb.length)return Lb[1];xa.ULS.sendTraceTag(537151646,0,10,"SocialSharingCommandHandler.GetSelectedFloatingObjectXluid: Invalid floating object id =  {0}",Ja.id)}return null};m.prototype.YMh=function(Ja,Lb,mc){Ja=btoa(Ja+"_"+Lb+"_"+mc);Ja=Ja.replace(RegExp("\\+","g"),"-");Ja=Ja.replace(RegExp("\\/","g"),"_");return Ja=Ja.replace(RegExp("\\=+$","g"),"")};m.prototype.j3f=
function(Ja,Lb){var mc=this;return Ab.TaskExtensions.Aa(this.OJ.value,function(xc){af.a(xc.result,ob.a.sharing,Lb,mc.$.ea.Jg.get(5))?xa.ULS.sendTraceTag(537151644,0,50,"SocialSharingCommandHandler.ShowShareDialog: Send UI_Sharing post message with mode: {0}",Lb?Lb[Ha.a.VKb]:""):Rb.HelperMethods.Ze(Ja.FileSharingUrl,"_blank",void 0,"SocialSharingCommandHandler.FileSharingUrl")},this.la,3)};m.prototype.WOd=function(Ja,Lb){if(!Td.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",
!1)||this.$.isMobileMode)return null;var mc=this.JWh(Ja);if(mc)return xa.ULS.sendTraceTag(520737606,0,50,"SocialSharingCommandHandler.ShareExcelSection: Calling share dialog with nav id={0}",mc[Ha.a.XOd]),this.j3f(Lb,mc);xa.ULS.sendTraceTag(537151643,0,10,"SocialSharingCommandHandler.ShareExcelSection: Unable to get the sharing details for navType: {0}",jc[Ja]);return null};Mf.Object.defineProperties(m.prototype,{KCc:{configurable:!0,enumerable:!0,get:function(){return Vb.b(this.$.mg)}},zLd:{configurable:!0,
enumerable:!0,get:function(){return this.$.isEditMode&&(this.$.ea.kih||this.$.IQ)}}});m.ACi=[103];m.Owh=[107,104,105,106];m.Pwh=[104,105];m.yVg=[new md.a(Hd.a.wye,554412057,0,0,1306),new md.a(Hd.a.idle,554412057,0,1)];Object(db.a)(m,"SocialSharingCommandHandler",Ie.a,[429]);var le=Db.a;Rk(y,le);y.prototype.Ad=function(){var Ja=this,Lb=new Ga.a(function(){return Kb.GetServiceTaskFactory.create(Ja.$.da,137,Ja.la,Ja.hb)});Ab.TaskExtensions.Aa(Kb.GetServiceTaskFactory.create(this.$.da,102,this.la,this.hb),
function(mc){Ja.jd([new m(Ja.$,mc.result,Lb)])},this.la,3)};y.ka=function(Ja){Db.a.Qd(114,new y(Ja))};Object(db.a)(y,"SocialSharingCommandHandlerFactory",Db.a,[]);var dd=b(1355);r.prototype.executeCommand=function(Ja,Lb,mc){return 2!==this.oi.$d(Fb.a.tryOfficeThroughTellMe,2,mc)?Cb.Task.Ua(!0):ub.a(Lb.command)};r.prototype.zc=function(Ja,Lb){return 215809929===Lb.command};r.prototype.Qc=function(){return!1};r.prototype.Lc=function(){return!1};Object(db.a)(r,"TryOfficeThroughTellMeCommandHandler",
null,[429]);var Zd=Db.a;Rk(v,Zd);v.prototype.Ad=function(){this.jd([new r(ta.AFrameworkApplication.ub)])};v.ka=function(Ja){Db.a.Qd(207,new v(Ja))};Object(db.a)(v,"TryOfficeThroughTellMeCommandHandlerFactory",Db.a,[]);var je=b(162),Ke=b(76),lf=b(159),nf=b(324),me=b(150),$e=b(180);f.xM=function(){return me.a.No(f.qk,$e.a.Xa(434))};f.qk="<div class='namedsheetview_teaching_dialog_control' id='IconAndDescriptionRow'> <div class='namedsheetview_teaching_dialog_description_label' id='IconAndDescriptionRow'> <div class='namedsheetview_teaching_dialog_textarea' id='TextArea'> <label id='TeachingDescriptionId' class='WACDialogLabel' >{0}</label> </div> </div> </div>";
Object(db.a)(f,"NamedSheetViewTeachingDialogHtml",null,[]);var we=b(50),Ya=nf.a;Rk(n,Ya);n.prototype.rg=function(){this.Rb=4;this.stopwatch=this.$.Fb.sc("UserAction",this.nc);var Ja=Wd.a.instance.ga(1888);this.Vf=f.xM();this.Ko=new je.a;this.initializeAndShow(Ja,this.IBi,{});return this.Ko.task};n.prototype.hv=function(Ja){Ya.prototype.hv.call(this,Ja);this.mc(1,Wd.a.instance.ga(1890));this.mc(2,Wd.a.instance.Xa(447))};n.prototype.H_i=function(){this.$.ea.mlc=!1};n.prototype.Oui=function(Ja){var Lb=
{};Lb.a=this.$.ya.UserSessionId;Lb.b="NamedSheetViewTeachingDialogClose";Lb.c=Ja;Lb.e=!0;this.stopwatch&&(this.stopwatch.stop(),Lb.d=this.stopwatch.qc);we.b().Ce(53,Lb,!0)};Mf.Object.defineProperties(n.prototype,{nc:{configurable:!0,enumerable:!0,get:function(){return"ShowNamedSheetViewTeachingDialog"}}});Object(db.a)(n,"NamedSheetViewTeachingDialog",nf.a,[]);var h=b(163);l.prototype.BAa=function(){if(this.cxj()){if(Td.EwaSettings.ma(580)){this.$.va.pa.Md.oQd=!0;var Ja=new je.a;this.$.Ka.Kb(new xe.a(-2050946363,
Ke.a.Cb,2,0,null)).continueWith(function(Lb){Ja.setResult(!lf.a(Lb)&&Lb.result)});return Ja.task}return(new n(this.$)).rg()}return Cb.Task.Ua(!0)};l.prototype.cxj=function(){var Ja=this.$.va.pa;return this.$.ea.M8a&&this.$.ea.mlc&&!Ja.Md.Qx&&this.$.ea.nM&&!h.f(this.$)};Object(db.a)(l,"NamedSheetViewPublic",null,[922]);var lb=Fc.a;Rk(k,lb);k.prototype.create=function(){this.pb(this.$.da.za(309)||new l(this.$))};k.ka=function(Ja){Ja.da.Ga(310,new k(Ja))};Object(db.a)(k,"NamedSheetViewPublicFactory",
Fc.a,[]);var Ub=b(7),zc=b(202),vc=b(1536),ud=b(1070),Gd=b(628);Object(db.a)(e,"NamedSheetViewTeachingCalloutContent",null,[]);Mf.Object.defineProperties(d.prototype,{C7f:{configurable:!0,enumerable:!0,get:function(){return this.Wge}},u1i:{configurable:!0,enumerable:!0,get:function(){return this.C7f<this.F7f.count?this.F7f.na(this.Wge++):null}}});Object(db.a)(d,"NamedSheetViewTeachingCalloutList",null,[]);var od=b(1276);c.prototype.q9h=function(Ja){var Lb=this;this.E7f=Ja;var mc=Object(Ub.a)(new zc.a,
{});c.Zgi(Ja)?(mc.add(new e(Wd.a.instance.Xa(436),Wd.a.instance.Xa(437),Wd.a.instance.ga(1918),function(){Lb.HH(2,"Continue");Lb.yJ(!0)},Wd.a.instance.ga(1919),function(){Lb.yJ();Lb.HH(1,"ExitGuide")},od.a())),1===Ja&&mc.add(new e(Wd.a.instance.ga(1920),Wd.a.instance.Xa(439),Wd.a.instance.ga(1918),function(){Lb.HH(2,"FirstEnterTempViewContinueSecond");Lb.yJ(!0)},Wd.a.instance.ga(1919),function(){Lb.yJ();Lb.HH(1,"FirstEnterTempViewExitGuideSecond")},od.a())),mc.add(new e(Wd.a.instance.Xa(440),Wd.a.instance.Xa(441),
Wd.a.instance.ga(1918),function(){Lb.HH(2,"FirstEnterExitCalloutContinue");Lb.yJ(!0)},Wd.a.instance.ga(1919),function(){Lb.yJ();Lb.HH(1,"FirstEnterExitCalloutGuide")},c.WZe())),mc.add(new e(Wd.a.instance.ga(1921),Wd.a.instance.Xa(438),Wd.a.instance.ga(1922),function(){Lb.K2f();Lb.yJ();Lb.HH(1,"LearnMore")},Wd.a.instance.ga(1923),function(){Lb.yJ();Lb.HH(1,"Done")},c.VZe()))):2===Ja?mc.add(new e(Wd.a.instance.ga(1920),Wd.a.instance.Xa(439),Wd.a.instance.ga(1917),function(){Lb.yJ();Lb.HH(1,"EnterTempViewAfterPersistedView")},
null,null,od.a())):3===Ja&&(mc.add(new e(Wd.a.instance.Xa(436),Wd.a.instance.ga(1929),Wd.a.instance.ga(1918),function(){Lb.HH(2,"AutoOptInExitCalloutContinue");Lb.yJ(!0)},Wd.a.instance.ga(1919),function(){Lb.yJ();Lb.HH(1,"AutoOptInExitGuide")},c.WZe())),mc.add(new e(Wd.a.instance.ga(1920),Wd.a.instance.Xa(439),Wd.a.instance.ga(1918),function(){Lb.HH(2,"Continue");Lb.yJ(!0)},Wd.a.instance.ga(1919),function(){Lb.yJ();Lb.HH(1,"ExitGuide")},od.a())),mc.add(new e(Wd.a.instance.ga(1921),Wd.a.instance.Xa(438),
Wd.a.instance.ga(1922),function(){Lb.K2f();Lb.yJ();Lb.HH(1,"LearnMore")},Wd.a.instance.ga(1923),function(){Lb.yJ();Lb.HH(1,"Done")},c.VZe())));this.kUd=new d(mc)};c.prototype.K2f=function(){var Ja=new xe.a(-859308420,Ke.a.Cb,this.$.Jc,9,null),Lb={};Lb=(Lb[Ke.a.Uf]="HelpID=SheetViews",Lb.InputMethod=Ke.a.Cb,Lb[Ke.a.Nc]=Yd.a.CQ,Lb.ShouldCanvasTakeFocus=!0,Lb);this.$.Ka.Kb(Ja,Lb)};c.prototype.show=function(Ja){this.q9h(Ja);this.cdb()};c.prototype.Oqj=function(Ja){this.i_b=Ja};c.prototype.cdb=function(){var Ja=
this,Lb=this.kUd.u1i;if(Lb){var mc=Object(Ub.a)(new vc.a,{label:Lb.S_i,onExecute:Lb.primaryButtonAction}),xc=null;Lb.PVf&&(xc=Object(Ub.a)(new vc.a,{label:Lb.PVf,onExecute:Lb.secondaryButtonAction}));Lb=Object(Ub.a)(new ud.a,{target:Lb.targetObject,content:Lb.body,title:Lb.title,showCloseIcon:!0,primaryButtonProps:mc,secondaryButtonProps:xc,useTeachingStyles:!0});Lb=this.i_b.callout(Lb);mc=Object(Ub.a)(new Gd.a,{onShow:function(){Ja.HH(0)}});this.ezc=this.i_b.addNotification(Lb,mc);this.bWc||(this.$.Kpd=
!0)}};c.prototype.dismiss=function(){this.yJ();this.HH(1,"DismissedByOthers")};c.prototype.yJ=function(Ja){Ja=void 0===Ja?!1:Ja;this.ezc&&(this.bWc||(this.$.Kpd=!1),this.i_b.removeNotification(this.ezc),this.ezc=null);Ja&&this.cdb()};c.prototype.HH=function(Ja,Lb){var mc={};mc.a=this.$.ya.UserSessionId;mc.b=this.E7f;mc.c=this.kUd.C7f;mc.d=Ja;mc.e=void 0===Lb?null:Lb;0===Ja?this.stopwatch=this.$.Fb.sc("UserAction","ShowNamedSheetViewTeachingCallout"):(this.stopwatch&&(this.stopwatch.stop(),mc.f=this.stopwatch.qc,
this.stopwatch=null),2===Ja&&(this.stopwatch=this.$.Fb.sc("UserAction","ShowNamedSheetViewTeachingCalloutNext")));we.b().Ce(52,mc,!0)};c.VZe=function(){return document.getElementById("m_excelWebRenderer_ewaCtl_columnHeadersDiv")};c.WZe=function(){return document.querySelector("[data-unique-id=Ribbon-NamedSheetViewExit]")};c.Zgi=function(Ja){return 0===Ja||1===Ja};Object(db.a)(c,"NamedSheetViewTeachingCallout",null,[921]);var Ae=Fc.a;Rk(a,Ae);a.prototype.create=function(){var Ja=this.$.da.za(322);
Ja||(Ja=new c(this.$),Td.EwaSettings.isChangeGateEnabled("OfficeVSO:5782706_NSVTC")&&this.$.da.Ga(322,Ja));this.pb(Ja)};a.ka=function(Ja){Ja.da.Ga(323,new a(Ja))};Object(db.a)(a,"NamedSheetViewTeachingCalloutFactory",Fc.a,[]);var Ne=b(1428),gf=b(1341);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.BusinessBar");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.HyperLink");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.MsForm");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.PresentMode");
Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Print");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Resize");Type.registerNamespace("_Ewa");Object(ra.a)();Type.registerNamespace("CADWLTR");oa.main();Type.registerNamespace("Common.App.NewAndOpen.UX");Ka.a.instance.Qi(new wa);Object(ab.a)();Type.registerNamespace("Common");Type.registerNamespace("Common.App.OpenInClient");Object(ya.a)();Object(ma.a)();Object(ha.a)();Object(Z.a)();Object(Na.a)();Type.registerNamespace("Common.App.WildFire");
ea.main();Object(pa.a)();Qa.a.Fa(fa.ka);Object(Aa.a)();Object(Za.a)();Object(Zb.a)();jb.a.ti(".MsformCalloutContent{color:#fff;font-size:13pt;line-height:1;padding-right:5px;margin-bottom:12px;margin-top:-6px;padding-left:10px;width:90%}.MsFormCalloutOuter{background-color:#107c41;z-index:1030}");(function(){Qa.a.Fa(function(Ja){M.ka(Ja)})})();(function(){Qa.a.Fa(function(Ja){Ja.da.Ga(165,new N(Ja))})})();Qa.a.Fa(H.ka);Object(Pb.a)();Object(sc.a)();Object(nb.a)();Object(pc.a)();Object(Dc.a)();Object(oc.a)();
Object(Gc.a)();Object(ld.a)();Object(gd.a)();Object(Cc.a)();Qa.a.Fa(F.ka);Qa.a.Fa(y.ka);Object(dd.a)();Qa.a.Fa(v.ka);(function(){Qa.a.Fa(function(Ja){k.ka(Ja);a.ka(Ja)})})();Object(Ne.a)();Object(gf.a)()},919:function(u,E,b){function a(O,U){var J=T.call(this,document.createElement("div"))||this;J.Oy=null;J.uS=null;J.i8=null;J.Sba=null;J.y2b=null;J.Sie=null;J.Boe=null;J.wjf=null;J.N4a=!1;J.Ou=!1;J.xZ=!1;J.Cva=!1;J.jHi=function(H){J.PC(H)};J.pHi=function(H){13===H.keyCode&&J.PC(H)};J.cyd=function(H){J.lo(H.lb);
return!0};J.jyd=function(H){J.y_(H.lb);return!0};J.dnc=function(H){J.Sla(H.lb?H.lb:0);return!0};J.kHi=function(H){J.PC(H.Ca);return!0};J.yig=function(H){H=void 0===H?null:H;J.lo(H.inputMethod?H.inputMethod:0);return!0};J.zig=function(H){H=void 0===H?null:H;J.y_(H.inputMethod?H.inputMethod:0);return!0};J.f1=O;J.uC=U;J.XWc=U.rGa.toString();J.title=U.title;J.message=U.message;J.set_visibilityMode(1);return J}b.d(E,"a",function(){return a});u=b(0);var c=b(7),d=b(14),e=b(89),k=b(233),l=b(13),n=b(109),
f=b(204),v=b(86);E=b(244);var r=b(1259),y=b(19),m=b(5),w=b(334),B=b(53),A=b(12),z=b(69),x=b(15),D=b(21),I=b(98),F=b(1108),G=b(1),T=E.a;Rk(a,T);a.prototype.dispose=function(){e.a.oc([this.y2b,this.uS,this.i8]);this.Ou&&this.uS&&(k.a.instance.Ba(l.a.click,this.uS.domElement,this.cyd),n.KeyInputManager.instance.pv(this.domElement,this.Sie));this.xZ&&this.i8&&(k.a.instance.Ba(l.a.click,this.i8.domElement,this.jyd),n.KeyInputManager.instance.pv(this.domElement,this.Boe));this.Cva&&this.Sba&&(k.a.instance.Ba(l.a.click,
this.Sba,this.dnc),n.KeyInputManager.instance.pv(this.domElement,this.wjf));this.Sba=this.Oy=this.f1=this.i8=this.uS=null;T.prototype.dispose.call(this)};a.prototype.update=function(){};a.prototype.KPj=function(){this.rDe(!0)};a.prototype.s2c=function(){this.rDe(!1)};a.prototype.G8g=function(){var O=this;this.message=I.a.qh(this.message);this.title=I.a.qh(this.title);f.UISurfaces.med().then(function(U){U.initializeMessageBarInStore();var J=Object(c.a)(new F.a,{messageTitle:O.title,message:O.message,
isMultiline:!1,messageBarType:O.uC.MRg,closeable:!O.N4a,dismissButtonAriaLabel:x.a.instance.ga(10),onDismiss:O.kHi});if(O.Cva){var H={};J.linkProps=(H.type="AppLinkProps",H.text=O.linkText,H.onExecute=O.dnc,H)}O.Ou&&(H={},J.firstActionButtonProps=(H.type="AppButtonProps",H.label=O.actionButton,H.onExecute=O.yig,H));O.xZ&&(H={},J.secondActionButtonProps=(H.type="AppButtonProps",H.label=O.WFa,H.onExecute=O.zig,H));U.createNewMessageBar(O.domElement,J);return null},function(U){d.ULS.sendTraceTag(524075914,
0,10,"Business Bar could not be initialized",U);return null});this.domElement.tabIndex=0;this.businessBar.domElement.appendChild(this.domElement)};a.prototype.sDe=function(O){var U="<div class='"+r.a.amh+"' id='{0}'><div class='"+r.a.Zlh+"'><a class='"+r.a.gmh+"' title='{1}'><span class='"+y.a.w2b+" "+r.a.cmh+"' id='{2}'>";this.Jk.length&&(U+="<img class='{3}' src='{4}'/>");U+="</span></a><span class='"+r.a.fmh+"' id='{5}'>{6}</span><span class='"+r.a.emh+"' id='message'>{7}</span><a id='link' href='#' class='"+
r.a.dmh+"'>{8}</a><span class='"+r.a.ELe+"'><button type='button' id='action' class='"+r.a.DLe+"'>{9}</button></span><span class='"+r.a.ELe+"'><button type='button' id='altAction' class='"+r.a.DLe+"'>{10}</button></span></div><a class='"+r.a.bmh+"' tabindex='0' role='button'><span id='close' class='"+y.a.IA+"'><img class='"+y.a.O8c+"' src='{11}' alt='{12}' title='{12}' role='button'/></span></a></div>";O||(this.domElement.tabIndex=0,this.businessBar.domElement.appendChild(this.domElement));var J=
this.businessBar.$.yb;O=J+"ewaBusinessBarEntryBody"+this.XWc;var H=J+"ewaBusinessBarEntryTitle"+this.XWc;J=J+"ewaBusinessBarEntryIcon"+this.XWc;this.domElement.className=r.a.$lh;this.domElement.innerHTML=String.format(U,O,this.alt,J,this.Jk,B.a.Se(0),H,this.title,this.message,this.linkText,this.actionButton,this.WFa,B.a.Se(13),x.a.instance.ga(792));A.DOMElementExtensions.gu(this.domElement,m.a.Qra,H,O);this.Sba=$get("link",this.domElement);A.DOMElementExtensions.setVisible(this.Sba,this.Cva);this.Cva&&
(k.a.instance.ra(l.a.click,this.Sba,this.dnc),this.wjf=n.KeyInputManager.instance.Xr(this.Sba,this.dnc,v.a.Oh,v.a.X0));this.uS=new w.a(A.DOMElementExtensions.getElementById(this.domElement,"action"));this.uS.isVisible=this.Ou;this.i8=new w.a(A.DOMElementExtensions.getElementById(this.domElement,"altAction"));this.i8.isVisible=this.xZ;this.Ou&&(k.a.instance.ra(l.a.click,this.uS.domElement,this.cyd),this.Sie=n.KeyInputManager.instance.Xr(this.uS.domElement,this.cyd,v.a.Oh,v.a.X0),this.xZ&&(k.a.instance.ra(l.a.click,
this.i8.domElement,this.jyd),this.Boe=n.KeyInputManager.instance.Xr(this.uS.domElement,this.jyd,v.a.Oh,v.a.X0)));this.Oy=$get("close",this.domElement);this.y2b=this.je.Sd(this.Oy);this.y2b.ka("click",this.jHi);this.y2b.ka("keydown",this.pHi);A.DOMElementExtensions.setVisible(this.Oy,!this.N4a)};a.prototype.rDe=function(O){64==this.uC.rGa?this.sDe(O):G.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactBusinessBar",!1)?this.G8g():this.sDe(O)};a.prototype.lo=function(){d.ULS.sendTraceTag(21517968,
0,50,"BusinessBar [{0}]: BusinessBarEntry.OnActionClick() for EntryName {1}",this.uC.hash,this.uC.J7c);D.g(this.businessBar.$).wo(!0)};a.prototype.y_=function(){d.ULS.sendTraceTag(537170257,0,50,"BusinessBar [{0}]: BusinessBarEntry.OnAltActionClick()",this.uC.hash);D.g(this.businessBar.$).wo(!0)};a.prototype.Sla=function(){d.ULS.sendTraceTag(537170256,0,50,"BusinessBar [{0}]: BusinessBarEntry.OnLinkClick()",this.uC.hash);D.g(this.businessBar.$).wo(!0)};a.prototype.PC=function(O){d.ULS.sendTraceTag(21517971,
0,50,"BusinessBar [{0}]: BusinessBarEntry.OnCloseClick() for EntryName {1}",this.uC.hash,this.uC.J7c);this.set_visible(!1);this.businessBar.removeEntry(this.NRg);z.g(O)};Mf.Object.defineProperties(a.prototype,{NRg:{configurable:!0,enumerable:!0,get:function(){return this.uC.rGa}},businessBar:{configurable:!0,enumerable:!0,get:function(){return this.f1}},actionButton:{configurable:!0,enumerable:!0,get:function(){return this.uC?this.uC.actionButton:""}},WFa:{configurable:!0,enumerable:!0,get:function(){return this.uC?
this.uC.WFa:""}},linkText:{configurable:!0,enumerable:!0,get:function(){return this.uC?this.uC.link:""}},Jk:{configurable:!0,enumerable:!0,get:function(){return this.uC?this.uC.Jk:""}},alt:{configurable:!0,enumerable:!0,get:function(){return this.uC?this.uC.alt:""}}});Object(u.a)(a,"BusinessBarEntry",E.a,[])},994:function(u,E,b){function a(N,M,C,Q){var P=K.call(this)||this;P.tF=null;P.eD=null;P.YV=null;P.ww=null;P.yGb=null;P.vK=null;P.vjc=null;P.FBb=null;P.EBb=!1;P.twa=!0;P.dpc=null;P.ewaAccessibilityManager=
null;P.jEd=null;P.iEd=null;P.mEd=null;P.Cmd=!1;P.wxf=function(){r.ULS.sendTraceTag(537154206,0,50,"PrintPreviewPane:OnIframeContentChange API invoked with loadPdfCalled: {0}",P.EBb);P.EBb&&(P.W5h(),P.vK.style.visibility="visible",P.vjc?P.vjc.stop():r.ULS.sendTraceTag(537154205,0,10,"PrintPreviewPane:OnIframeContentChange - loadPdfStopwatchForIframe is null."),P.raiseEvent(a.qDb,new f(1)),P.GNd(),P.EBb=!1)};P.$=N;P.dD=M;P.s8g();P.useMSPdfViewer=C;P.isUniversalPrintEnabled=Q;return P}function c(){this.msPdfViewerFileUrl=
null;this.useMSPdfViewer=!1;this.onPdfLoad=null}function d(){this.logger=this.printSettingsTaskPaneCallbacks=this.selectedPrintSettingsValues=this.colorOptions=this.marginDetailedOptions=this.marginOptions=this.scalingOptions=this.paperSizeOptions=this.orientationOptions=this.whatToPrintOptions=null;this.isViewMode=this.shouldDisableCurrentSelection=!1;this.dataCultureTag=this.isMetricMeasurementUnit=this.isUniversalPrintFlowEnabled=null}function e(){this.msPdfKitWasmUrl=this.msPdfKitJSUrl=this.pdfViewerWorkerUrl=
null}function k(N){this.kg=N}function l(N){this.kg=N}function n(N){this.kg=N}function f(N){var M=F.call(this)||this;M.$_i=N;return M}b.r(E);u=b(0);var v=b(7),r=b(14),y=b(4);b(27);var m=b(410),w=b(38),B=b(51),A=b(12),z=b(129),x=b(1),D=b(15),I=b(21),F=Sys.EventArgs;Rk(f,F);Object(u.a)(f,"PrintPreviewPaneOperationStatusEventArgs",Sys.EventArgs,[]);var G=b(272),T=b(253);n.prototype.Lh=function(){G.a(this.kg.$).DM(this.Yd)||G.a(this.kg.$).Lh(this)};n.prototype.R7=function(){G.a(this.kg.$).DM(this.Yd)&&
G.a(this.kg.$).Az(this)};n.prototype.$g=function(N){return A.DOMElementExtensions.nf(this.ic,N)};n.prototype.ej=function(){this.kg.$.frame.xe.Gj(this.kg.$.frame.xe.uE)};n.prototype.Aj=function(){};n.prototype.Sf=function(N,M){return M?!1:(this.kg.enterPrintPreviewHeaderFocusTrapZone(),!0)};Mf.Object.defineProperties(n.prototype,{Yd:{configurable:!0,enumerable:!0,get:function(){return T.a.SHf}},ic:{configurable:!0,enumerable:!0,get:function(){var N=b(994).PrintPreviewPane;return document.getElementById(N.Y_i)}},
canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return!0}}});Object(u.a)(n,"PrintPreviewHeaderKeyboardAccessibleSection",null,[448]);l.prototype.Lh=function(){G.a(this.kg.$).DM(this.Yd)||G.a(this.kg.$).Lh(this)};l.prototype.R7=function(){G.a(this.kg.$).DM(this.Yd)&&G.a(this.kg.$).Az(this)};l.prototype.$g=function(N){return A.DOMElementExtensions.nf(this.ic,N)};l.prototype.ej=function(){this.kg.$.frame.xe.Gj(this.kg.$.frame.xe.uE)};l.prototype.Aj=function(){};l.prototype.Sf=function(N,
M){return M?!1:(this.kg.useMSPdfViewer?(N=document.getElementById(b(994).PrintPreviewPane.fCd))&&A.DOMElementExtensions.setFocus(N,!0):A.DOMElementExtensions.setFocus(this.kg.vK),!0)};Mf.Object.defineProperties(l.prototype,{Yd:{configurable:!0,enumerable:!0,get:function(){return T.a.THf}},ic:{configurable:!0,enumerable:!0,get:function(){var N=b(994).PrintPreviewPane;return this.kg.useMSPdfViewer?document.getElementById(b(994).PrintPreviewPane.fCd):document.getElementById(N.lFf)}},canReceiveFocus:{configurable:!0,
enumerable:!0,get:function(){return!0}}});Object(u.a)(l,"PrintPreviewKeyboardAccessibleSection",null,[448]);k.prototype.Lh=function(){G.a(this.kg.$).DM(this.Yd)||G.a(this.kg.$).Lh(this)};k.prototype.R7=function(){G.a(this.kg.$).DM(this.Yd)&&G.a(this.kg.$).Az(this)};k.prototype.$g=function(N){return A.DOMElementExtensions.nf(this.ic,N)};k.prototype.ej=function(){this.kg.$.frame.xe.Gj(this.kg.$.frame.xe.uE)};k.prototype.Aj=function(){};k.prototype.Sf=function(N,M){return M?!1:(this.kg.enterPrintSettingsTaskPaneFocusTrapZone(),
!0)};Mf.Object.defineProperties(k.prototype,{Yd:{configurable:!0,enumerable:!0,get:function(){return T.a.WHf}},ic:{configurable:!0,enumerable:!0,get:function(){var N=b(994).PrintPreviewPane;return document.getElementById(N.lEd)}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return!0}}});Object(u.a)(k,"PrintSettingsTaskPaneKeyboardAccessibleSection",null,[448]);Object(u.a)(e,"MSPdfViewerFileUrl",null,[]);Object(u.a)(d,"PrintSettingsTaskPaneProps",null,[]);Object(u.a)(c,"ViewerPaneProps",
null,[]);var O=b(1279),U=b(397),J=b(5),H=b(1280);b.d(E,"PrintPreviewPane",function(){return a});var K=w.a;Rk(a,K);a.prototype.rFg=function(N){this.addHandler(a.qDb,N)};a.prototype.nbj=function(N){this.removeHandler(a.qDb,N)};a.prototype.kAj=function(){this.n8g()};a.prototype.lAj=function(){var N=this.$.Fb.sc("UserAction","createSettingsPaneStopwatch"),M=document.getElementById(a.lEd);this.t8g();var C=this.u8g();this.eD.createPrintSettingsTaskPane(M,C);N.stop();this.EBb=!1;if(this.isUniversalPrintEnabled&&
this.ww){N="A4";switch(C.selectedPrintSettingsValues.selectedPaperSize){case 8:N="A3";break;case 9:N="A4";break;case 11:N="A5";break;case 12:N="JIS B4";break;case 13:N="JIS B5";break;case 5:N="North America Legal";break;case 1:N="North America Letter";break;case 6:N="North America Invoice";break;case 7:N="North America Executive";break;case 3:N="North America Ledger"}this.tF.setDocumentSettings({mediaSize:N,orientation:2===C.selectedPrintSettingsValues.selectedOrientation?"landscape":"portrait",colorMode:1===
C.selectedPrintSettingsValues.selectedColor?"color":"blackAndWhite"})}this.XGd()};a.prototype.setPageRangeSettings=function(N,M,C,Q,P){this.eD&&(this.eD.setPageRangeSettings(N,M,C,Q,P),this.tZf(String.format(D.a.instance.mb(200),Q,P,N)))};a.prototype.M5h=function(){this.ww&&(this.ww.style.display="none")};a.prototype.cgh=function(){this.dispose();this.WWd();this.DNj();this.tF&&this.tF.closePrintPreviewPane();this.YV=this.eD=this.tF=this.ww=null};a.prototype.tsi=function(N){r.ULS.sendTraceTag(575534018,
0,50,"PrintPreviewPane: LoadPdf invoked.");this.hidePreviewError();this.useMSPdfViewer?((this.FBb=this.$.Fb.sc("UserAction","pdfLoadTimeStopwatchForMsPdfViewer"))||r.ULS.sendTraceTag(537154210,0,10,"PrintPreviewPane:LoadPdf - loadPdfStopwatchForMsPdfViewer is null."),this.YV.renderPdf(N)):this.vK&&((this.vjc=this.$.Fb.sc("UserAction","loadPdfStopwatch"))||r.ULS.sendTraceTag(537154209,0,10,"PrintPreviewPane:LoadPdf - loadPdfStopwatchForIframe is null."),this.EBb=!0,this.vK.src&&this.vK.src===N?this.wxf(null):
this.vK.src=N);if(this.isUniversalPrintEnabled&&this.ww){var M=U.b(this.$.workbookContext);this.tF.setFileUrl(N,M)}};a.prototype.onPdfLoad=function(){this.FBb?(r.ULS.sendTraceTag(537154208,0,50,"PrintPreviewPane:onPdfLoad - Rendering time : {0} ms, isFirstTimeLoad: {1}",this.FBb.qc,this.twa),this.FBb.stop()):r.ULS.sendTraceTag(537154207,0,10,"PrintPreviewPane:onPdfLoad - loadPdfStopwatchForMsPdfViewer is null.");this.raiseEvent(a.qDb,new f(1));this.hideWaitCursor();this.GNd()};a.prototype.printPdf=
function(){A.DOMElementExtensions.setFocus(this.vK);this.vK.contentWindow.print()};a.prototype.aBj=function(){this.showSpinner();this.showWaitCursor();this.tZf("")};a.prototype.W5h=function(){this.hideSpinner();this.hideWaitCursor()};a.prototype.Iz=function(N,M,C){this.ww&&this.YV&&(this.Cmd=!1,this.YV.showErrorDetails(M,N,void 0===C?null:C),this.dD.I5a=!0,this.vK&&(this.vK.src=""),this.disablePrintButton(),this.hideWaitCursor(),a.Uji(M)&&(this.Cmd=!0,this.WOi()))};a.prototype.hidePreviewError=function(){this.dD.I5a=
!1;this.YV.hidePreviewError();this.enablePrintButton()};a.prototype.Ufh=function(){(this.yGb=document.getElementById(a.UHf))&&this.yGb.parentNode&&this.yGb.parentNode.removeChild(this.yGb)};a.prototype.hideErrorMessageForPrintOptions=function(){this.eD&&this.eD.hideErrorMessageForPrintOptions()};a.prototype.showErrorMessageForPrintOptions=function(N){this.eD&&this.eD.showErrorMessageForPrintOptions(N)};a.prototype.showSpinner=function(){this.dD.I5a||x.EwaSettings.isChangeGateEnabled("OfficeVSO:5547045_ShowLoadingIconOnSettingsChange")&&
this.Cmd?this.hidePreviewError():this.vK&&(this.vK.style.visibility="hidden");this.YV&&this.YV.showSpinner()};a.prototype.hideSpinner=function(){this.YV&&this.YV.hideSpinner()};a.prototype.enablePrintButton=function(){this.eD&&this.eD.enablePrintButton();this.isUniversalPrintEnabled&&this.ww&&this.tF.updatePrintButtonEnableDisableState(!0)};a.prototype.disablePrintButton=function(){this.eD&&this.eD.disablePrintButton();this.isUniversalPrintEnabled&&this.ww&&this.tF.updatePrintButtonEnableDisableState(!1)};
a.prototype.showWaitCursor=function(){this.eD&&this.eD.showWaitCursor();this.isUniversalPrintEnabled&&this.ww&&this.tF.updatePrintButtonEnableDisableState(!1)};a.prototype.hideWaitCursor=function(){this.eD&&this.eD.hideWaitCursor();this.isUniversalPrintEnabled&&this.ww&&this.tF.updatePrintButtonEnableDisableState(!0)};a.prototype.q8g=function(){if(this.ww)r.ULS.sendTraceTag(591927430,0,10,"PrintPreviewerPane:CreatePrintPreviewerContainer - printPreviewerContainer should be null");else if(this.ww=
document.createElement("div"),this.ww.id=a.UHf,this.ww.classList.add(a.a0i),this.$.Tq.insertBefore(this.ww,this.$.Tq.firstChild),y.AFrameworkApplication.ta&&y.AFrameworkApplication.ta.Qa.Of){var N=document.getElementById(J.a.$Fa);N&&(this.ww.style.top=N.clientHeight+"px",this.ww.style.height="calc(100% - "+N.clientHeight+"px)")}};a.prototype.enterPrintPreviewHeaderFocusTrapZone=function(){this.tF.enterPrintPreviewHeaderFocusTrapZone()};a.prototype.enterPrintSettingsTaskPaneFocusTrapZone=function(){this.tF.enterPrintSettingsTaskPaneFocusTrapZone()};
a.prototype.MYi=function(){var N=this;this.$.da.Za(15,function(M){N.ewaAccessibilityManager=M;N.ewaAccessibilityManager.mode=3})};a.prototype.s8g=function(){this.mEd=new k(this);this.jEd=new l(this);this.iEd=new n(this)};a.prototype.XGd=function(){this.mEd.Lh();this.jEd.Lh();this.iEd.Lh();this.MYi()};a.prototype.WWd=function(){this.mEd.R7();this.jEd.R7();this.iEd.R7();I.g(this.$).s0();this.ewaAccessibilityManager&&(this.ewaAccessibilityManager.mode=0)};a.prototype.ON=function(){this.dpc=z.a.instance.Sd(this.vK);
this.dpc.ka("load",this.wxf)};a.prototype.DNj=function(){this.dpc&&this.vK&&this.dpc.detach("load")};a.prototype.GNd=function(){this.isUniversalPrintEnabled?this.zYf(a.Z_i,a.FCi):this.zYf(a.lEd,a.OHf)};a.prototype.zYf=function(N,M){this.twa&&(N=document.getElementById(N))&&(M=A.DOMElementExtensions.getElementById(N,M))&&(this.twa=!1,M.focus())};a.prototype.WOi=function(){this.dD.I5a=!1;this.enablePrintButton();this.GNd()};a.prototype.n8g=function(){var N=this;if(x.EwaSettings.isChangeGateEnabled("OfficeVSO:6068952_FixJSCrahInPrintPreview")){var M=
B.GetServiceTaskFactory.Ra(this.$.da,283,284,0).result.tn;M.loadScript("excel-print-preview-sprite").then(function(){M.loadScript("printPreviewer").then(function(){M.loadScript("excelPrintPreviewer").then(function(){N.ADe()})},function(){r.ULS.sendTraceTag(525358669,0,10,"PrintPreviewPane.createPreviewerPanes: Failed to load printPreviewer script required for excelPrintPreviewer.")})},function(){r.ULS.sendTraceTag(525358668,0,10,"PrintPreviewPane.createPreviewerPanes: Failed to load excelPrintPreviewSprite script required for excelPrintPreviewer.")})}else B.GetServiceTaskFactory.Ra(this.$.da,
283,284,0).result.tn.loadScript("excelPrintPreviewer").then(function(){N.ADe()})};a.prototype.ADe=function(){var N=this,M=this.$.Fb.sc("UserAction","createEmptyPreviewerStopwatch");this.q8g();this.r8g();this.isUniversalPrintEnabled?this.tF.createEmptyPrintPreviewPaneAsync(this.ww,this.zDe()).then(function(){M.stop();N.gAe();N.tF.updatePrintButtonEnableDisableState(!1)}):(this.tF.createEmptyPrintPreviewPane(this.ww,this.zDe()),M.stop(),this.gAe())};a.prototype.gAe=function(){var N=this.$.Fb.sc("UserAction",
"createPdfPreviewPaneStopwatch"),M=document.getElementById(a.fCd);this.useMSPdfViewer&&(M.tabIndex=0);this.a8g();this.$7g(M);N.stop();this.raiseEvent(a.qDb,new f(0))};a.prototype.r8g=function(){this.tF||(this.tF=printPreviewer.PrintPreviewPaneControllerFactoryGlobal.createPrintPreviewPaneController());this.tF||r.ULS.sendTraceTag(537154203,0,10,"PrintPreviewerPane:CreatePrintPreviewerController - printPreviewerController should not be null")};a.prototype.t8g=function(){this.eD||(this.eD=excelPrintPreviewer.PrintUIControllerFactoryGlobal.createPrintSettingsTaskPaneController());
this.eD||r.ULS.sendTraceTag(537154202,0,10,"PrintPreviewerPane:CreatePrintSettingsPaneController - printSettingsPaneController should not be null")};a.prototype.a8g=function(){this.YV||(this.YV=excelPrintPreviewer.PrintUIControllerFactoryGlobal.createPrintPreviewController());this.YV||r.ULS.sendTraceTag(537154201,0,10,"PrintPreviewerPane:CreatePdfPreviewPaneController - pdfPreviewerPaneController should not be null")};a.prototype.$7g=function(N){this.YV.createPrintPreviewPane(N,this.E$g());this.useMSPdfViewer||
(this.vK=A.DOMElementExtensions.getElementById(this.ww,a.lFf),this.vK.title=D.a.instance.ga(1193),this.ON())};a.prototype.u8g=function(){var N="en-US";var M=this.$.ya.IsMetricMeasurementUnit;this.$.ya.DataCultureTag?N=this.$.ya.DataCultureTag:r.ULS.sendTraceTag(536994563,0,50,"PrintPreviewerPane:createPrintSettingsProps - DataCultureTag in ewaControl.bootstrapContext is nullable");return Object(v.a)(new d,{whatToPrintOptions:this.dD.Zu.whatToPrintOptions,orientationOptions:this.dD.Zu.orientationOptions,
paperSizeOptions:this.dD.Zu.paperSizeOptions,scalingOptions:this.dD.Zu.scalingOptions,marginDetailedOptions:this.dD.dRh(),selectedPrintSettingsValues:this.dD.aUh(),printSettingsTaskPaneCallbacks:this.dD.ZTh(),logger:new m.a,shouldDisableCurrentSelection:this.dD.rwc(),isViewMode:!this.$.isEditMode,isMetricMeasurementUnit:M,dataCultureTag:N,isUniversalPrintFlowEnabled:this.isUniversalPrintEnabled})};a.prototype.zDe=function(){return this.isUniversalPrintEnabled?this.dD.XTh():Object(v.a)(new O.a,{backActionButtonText:D.a.instance.ga(1191),
printPreviewPaneCallbacks:this.dD.a0e(),logger:new m.a,disableTellMeControl:!0})};a.prototype.E$g=function(){var N=this;return this.useMSPdfViewer?Object(v.a)(new c,{useMSPdfViewer:!0,msPdfViewerFileUrl:this.o7g(),onPdfLoad:function(){N.onPdfLoad()}}):Object(v.a)(new c,{useMSPdfViewer:!1})};a.prototype.o7g=function(){return Object(v.a)(new e,{pdfViewerWorkerUrl:this.$.ya.PrintPreviewerPdfViewerWorkerUrl,msPdfKitJSUrl:this.$.ya.PrintPreviewerMSPdfKitJsUrl,msPdfKitWasmUrl:this.$.ya.PrintPreviewerMSPdfKitWasmUrl})};
a.prototype.tZf=function(N){this.ww&&this.tF.setAdditionalHeaderText(N)};a.Uji=function(N){return 3===N||2===N};a.UHf="PrintPreviewerContainer";a.lEd="printSettingsTaskPaneId";a.fCd="previewId";a.lFf="printpreviewiframe";a.Y_i="printPreviewHeaderId";a.OHf="printButton";a.Z_i="printPreviewPaneId";a.FCi="printButtonId";a.a0i=H.a.ww;a.qDb="pppnosu";Object(u.a)(a,"PrintPreviewPane",w.a,[719])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.kmhv.js.map/1887b957f7ce260b1331caa911772faa/EwaDS.kmhv.js.map