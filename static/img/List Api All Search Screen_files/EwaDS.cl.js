(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[7],{1015:function(u,E,b){function a(ia,ta,za,sa,V,Ia,Ha,ob,ib,La,zb,Fb){this.MQc=!1;this.j1=null;this.pG=new ca.a;this.Zgb=1;this.TO=null;this.ut=!1;this.tLc=(new Date(0)).getTime();this.Rfe=0;this._clientId=ia;this.lXb=ta;this.sL=0;this.ph=sa;this.bGc=ob;this.Vug=Ha;this.tjg=ib;this.Zlg=V;this.bpa=Ia;this.Rl=za;this.qp=La;this.he=zb;this.Og=Fb;this.Vvg=1>100*Math.random()}function c(ia){return ia?ia.charAt(0).toLocaleUpperCase()+
ia.substring(1,ia.length):ia}function d(ia,ta,za){return String.format("ClientID={0}, App={1}, ClientType={2}, SessionId={3}",ia,c(na[za]),c("browser"),ta)}function e(ia,ta,za,sa,V,Ia,Ha,ob,ib,La,zb,Fb){ib=void 0===ib?null:ib;La=void 0===La?null:La;zb=void 0===zb?null:zb;Fb=void 0===Fb?null:Fb;var Yb=T.createInstance(ea.AFrameworkApplication.fa),kb=ea.AFrameworkApplication.buildVersion?ea.AFrameworkApplication.buildVersion:"1.0",vb=d(ia,ta,Ha,kb),Wa=Yb.kYg?b(1522).RealtimeChannelMetrics.createInstance(vb):
new H,qb=va.a.create(V);Yb.rtcJsClientFrequentlyLogsMetrics&&qb.QDj(Yb.dij);var yb="";yb=ib&&""!==ib?ib:"/rtc2/";qb.oSe=wa.a.yM(yb);var ec=yb+"signalr";ib=yb+"findsession";var Ob=U.M6h;yb=new l;zb=zb||Xa.a.getInstance();P.ULS.shipAssertTag(556867617,500,Yb.JTf<=b(1015).RealtimeChannel.lof,"Client attempting to override max payload size beyond absolute limit");var Cb=Math.min(Yb.JTf,b(1015).RealtimeChannel.lof);qb.kof=Cb;qb=new r(Yb,new k(yb),ia,vb,function(ab){return new O(ab.createHubProxy(Ob))},
ob,zb,Wa,qb,Cb);La||(La=b(1386).FindSessionStrategy.createInstance(ta,V,ib,ob,kb,Ha,ia,vb,zb,Ia,sa,Fb));La.z9b=Yb.z9b;ta=new K(vb);za=za?za.split(","):null;ia=new (b(1015).RealtimeChannel)(ia,za,vb,ob,function(){return $.hubConnection(ec)},La,qb,ta,zb,Wa,Yb,V);ia.init();return ia}function k(ia){var ta=this;this.he=null;this.Sw=!1;this.$a=new da.a;this.wMc=new ca.a;this.vMc=new ca.a;this.tRc=ia;this.AVa=this.tRc.ZCe(function(za){return za.send()},"GlobalMaxOustandingThrottler");this.AVa.EZb(function(){ta.$a.raiseEvent("TMUDM")})}
function l(){}function n(ia,ta){ia=v.call(this,ia,void 0===ta?"":ta)||this;ia.r8a=0;ia.hjb=(new Date(0)).getTime();ia.currentTime=function(){return(new Date).getTime()};return ia}function f(ia,ta){ia=v.call(this,ia,void 0===ta?"":ta)||this;ia.cBa=0;ia.l8a=0;ia.$a=new da.a;ia.VVa=!1;ia.sRc=0;ia.gRb=0;ia.tRb=0;ia.wUb=0;ia.fXb=[];ia.clearTimeout=f.M4c;return ia}function v(ia,ta){this.Ghb=this.Llb=0;this.vKc=!1;this.tXa=this.cXb=null;this.WVa=!1;this.afe=ia;this.q8f=void 0===ta?"":ta;this.setTimeout=
v.Z4c;this.SEa=this.Llb=this.Ghb=0}function r(ia,ta,za,sa,V,Ia,Ha,ob,ib,La){Ha=G.call(this,Ha)||this;Ha.xr=null;Ha.x$d=!1;Ha.$O=0;Ha.VNc=new ba.a;Ha.nrg=r.LKh();Ha.HNc=ea.AFrameworkApplication.fa.Wa("OwningFeatureCrewForRtcNotificationKpis");Ha.he=ia;Ha.Xae=0;Ha.Yae=0;Ha.Mlb=ta;Ha.Mlb.EZb(Object(ka.a)(Ha,Ha.QSi,"onTooManyUndeliveredMessages"));Ha._clientId=za;Ha.Jtg=V;Ha.Yg.dGg(Object(ka.a)(Ha,Ha.OPi,"onRefreshProxyRequired"));Ha.Yg.bGg(Object(ka.a)(Ha,Ha.LPi,"onRefreshAllPersistentStateRequest"));
Ha.Yg.uGg(Object(ka.a)(Ha,Ha.zda,"sendUpdateNotification"));Ha.Yg.OEg(Object(ka.a)(Ha,Ha.UMi,"onInternalPresenceUpdated"));Ha.Yg.PEg(Object(ka.a)(Ha,Ha.VMi,"onInternalUpdateNotificationReceived"));Ha.Yg.NEg(Object(ka.a)(Ha,Ha.TMi,"onInternalPersistentStateUpdated"));Ha.Yg.MEg(Object(ka.a)(Ha,Ha.RMi,"onInternalPersistentStateCleared"));Ha.Yg.tGg(Object(ka.a)(Ha,Ha.IMd,"sendPersistentState"));Ha.Yg.QGg(Object(ka.a)(Ha,Ha.Jeb,"updateClientInfo"));Ha.ph=Ia;Ha.Rl=sa;Ha.qp=ob;Ha.KB=ib;Ha.Fjb=La;Ha.rUa=
Object(aa.a)(String,ea.AFrameworkApplication.Ob.Application)||"";return Ha}function y(){this.kpiName=null;this.kpiType=0;this.blockFutureEmissionDurationInMs=this.optionalProperties=null}function m(){this.isForAlertableKpi=this.extendedProperties=null}function w(){this.vetoPillar=this.crewAlias=this.featureName=this.topLevelKpiName=null}function B(){this.NQc=this.rp=null}function A(ia,ta,za,sa){var V=db.call(this)||this;V.lJd=ia;V.reconnectDelay=ta;V.reason=za;V.yMd=sa;return V}function z(){this.fae=
new x;this.dae=new x}function x(){this.L1d=this.aGc=!1;this.callback=null}function D(ia,ta){this.evg=ia;this.$O=void 0===ta?"":ta}function I(){this.Presence=null;this.TimeStamp=0}function F(){}function G(ia){this.Mlb=null;this.sda=0;this.TIa=!1;this.Yg=ia;this.Yg.Dga(Object(ka.a)(this,this.MV,"onConnectionStateChanged"))}function T(){this.DEc=this.b1d=!1;this.BEc=0;this.IFc=this.lQc=this.kQc=this.ZDc=!1;this.KHc=0;this.see=!1;this.ree=this.qee=0;this.rPc=!1;this.wPc=this.uPc=this.xPc=this.sPc=0;this.vPc=
!1}function O(ia){this.xr=ia}function U(){}function J(){}function H(){this.TLf=this.jGd;this.WLf=this.mGd;this.VLf=this.lGd;this.$Lf=this.oGd;this.ZLf=this.nGd;this.uGd=this.vGd;this.rGd=this.sGd;this.DPa=this.pGd;this.gHb=this.qGd;this.ULf=this.kGd;this.aDb=this.Fwd;this.qlc=this.Gwd}function K(ia){this.o9=!1;this.uXa=0;this.cGc=!1;this.setTimeout=K.Z4c;this.clearTimeout=K.M4c;this.fwi=Object(ka.a)(this,this.wvi,"logRtcConnectingUsageStatement");this.Rl=ia}function N(ia,ta){this.data=ia;this.timeStamp=
ta}function M(ia,ta,za){this.W8=null;this.iMc=this.RPc=0;this.he=ta;this.gae=za;this.ilb=!1;this.Yg=ia;this.Yg.tYa(Object(ka.a)(this,this.v5i,"receiveMessage"))}function C(ia){this.messageId=ia;this.Dmj=(new Date).getTime();this.Qrd=new ja.a}function Q(ia,ta){this.status=ia;this.y7a=ta}b.r(E);u=b(0);var P=b(14),ka=b(84),R=b(162),fa=b(1189),ca=b(100),ea=b(4);Object(u.a)(Q,"UserStatusInfo",null,[]);var wa=b(81),X=b(635),ja=b(202);Object(u.a)(C,"MessageLatencyDetails",null,[]);M.prototype.start=function(){if(this.gae&&
!this.ilb){var ia=this.he.KTf;this.iMc=this.he.HTf;ia<=this.iMc?(P.ULS.sendTraceTag(570975114,500,15,"LogMetrics cannot be started because configuration values are incorrect. RtcSendTelemetryMessageIntervalInMS({0}) should be greater than RtcLogClientMessageMetricsTimeOutInMs({1})",this.he.KTf,this.he.HTf),this.gae=!1):(this.ilb=!0,this.RPc=window.setInterval(Object(ka.a)(this,this.uj,"sendMessage"),ia))}};M.prototype.uj=function(){var ia=this;if(this.ilb){var ta=X.a.create().toString();this.W8=new C(ta);
this.Yg.qFd(16,ta,!1,new R.a);window.setTimeout(function(){ia.Kui(ta)},this.iMc)}};M.prototype.Kui=function(ia){this.W8&&this.W8.messageId===ia&&(0<this.W8.Qrd.count?(ia=this.W8.Qrd.toArray().join(","),P.ULS.sendTraceTag(571339719,500,15,"ClientMessageLatencies:[{0}]",ia)):P.ULS.sendTraceTag(562312150,500,50,"No client message latencies recorded"),this.W8=null)};M.prototype.stop=function(){this.RPc&&(window.clearInterval(this.RPc),this.ilb=!1)};M.prototype.v5i=function(ia,ta){16===ta.type?this.Yg.qFd(17,
ta.T7,!1,new R.a):17===ta.type&&this.ilb&&ta.T7&&this.H0i(ta.T7)};M.prototype.H0i=function(ia){ia&&this.W8&&ia.toString()===this.W8.messageId&&(ia=(new Date).getTime()-this.W8.Dmj,this.W8.Qrd.add(ia))};M.Eed=function(ia,ta,za){return M.instance||(M.Ma=new M(ia,ta,za))};Mf.Object.defineProperties(M,{instance:{configurable:!0,enumerable:!0,get:function(){return M.Ma}}});M.Ma=null;Object(u.a)(M,"ClientToClientMessageTelemetry",null,[]);var va=b(1148),ua=b(1085);Object(u.a)(N,"PresenceData",null,[]);
K.prototype.BHi=function(){var ia=this;this.o9||(this.uXa=this.setTimeout(function(){ia.o9=!1;ia.vlf()},8E3),this.o9=!0,this.cGc=!1)};K.prototype.BIi=function(){this.cM()};K.prototype.ZRi=function(){this.vlf()};K.prototype.vlf=function(){this.cM();this.cGc||(this.cGc=!0,this.fwi())};K.prototype.wvi=function(){P.ULS.sendTraceTag(4539720,500,50,"Usage statement for the Rtc_ConnectedEver KPI for [{0}]",this.Rl)};K.prototype.cM=function(){this.o9&&this.clearTimeout(this.uXa);this.uXa=0;this.o9=!1};K.Z4c=
function(ia,ta){return window.setTimeout(ia,ta)};K.M4c=function(ia){window.clearTimeout(ia)};Object(u.a)(K,"ConnectedUsageKpiLogger",null,[122]);H.prototype.jGd=function(){};H.prototype.mGd=function(){};H.prototype.lGd=function(){};H.prototype.oGd=function(){};H.prototype.nGd=function(){};H.prototype.sGd=function(){};H.prototype.qGd=function(){};H.prototype.pGd=function(){};H.prototype.vGd=function(){};H.prototype.kGd=function(){};H.prototype.Fwd=function(){};H.prototype.Gwd=function(){};Object(u.a)(H,
"NoopRealtimeChannelMetrics",null,[79,80]);J.bOb="presenceUpdated";J.updateNotification="updateNotification";J.CFf="persistentStateCleared";J.updatePersistentState="persistentStateUpdated";Object(u.a)(J,"RtcClientMethodNames",null,[]);U.M6h="realtimeChannelHub";U.bOb="UpdatePresence";U.zda="SendUpdateNotification";U.ucd="GetCompletePersistentStateWithMetadata";U.updatePersistentState="UpdatePersistentState";U.Jeb="UpdateClientInfo";Object(u.a)(U,"RtcHubMethodNames",null,[]);O.prototype.g8i=function(ia){this.xr.on(J.bOb,
ia)};O.prototype.H8i=function(ia){this.xr.on(J.updateNotification,ia)};O.prototype.e8i=function(ia){this.xr.on(J.updatePersistentState,ia)};O.prototype.d8i=function(ia){this.xr.on(J.CFf,ia)};O.prototype.IOj=function(ia){this.xr.off(J.bOb,ia)};O.prototype.QOj=function(ia){this.xr.off(J.updateNotification,ia)};O.prototype.HOj=function(ia){this.xr.off(J.updatePersistentState,ia)};O.prototype.GOj=function(ia){this.xr.off(J.CFf,ia)};O.prototype.bOb=function(ia){return this.xr.invoke(U.bOb,ia)};O.prototype.Jeb=
function(ia){return this.xr.invoke(U.Jeb,ia)};O.prototype.zda=function(ia,ta){return this.xr.invoke(U.zda,ia,ta)};O.prototype.ucd=function(ia){return this.xr.invoke(U.ucd,ia)};O.prototype.updatePersistentState=function(ia,ta){return this.xr.invoke(U.updatePersistentState,ia,ta)};Object(u.a)(O,"RealtimeChannelProxy",null,[119,120,121]);T.createInstance=function(ia){var ta=b(1015).RealtimeChannel;return ia?Object.assign(new T,{b1d:ia.qa("AwayStatusManagerIsEnabled"),DEc:ia.qa("AwayStatusOneMinuteTimeoutIsEnabled"),
BEc:ia.kd("AwayCoauthorThresholdMs",9E5),ZDc:ia.qa("RtcAllowCrossDomainAccessEnabled"),kQc:ia.qa("ShouldLogOnContentNotification"),lQc:ia.qa("ShouldLogOnHostSubscriptionNotification"),IFc:ia.qa("RtcClientMetricsEnabled"),KHc:ia.kd("RtcFindSessionRequestTimeoutInMS",6E4),see:ia.qa("RtcJsClientFrequentlyLogsMetrics"),qee:ia.kd("RtcJsClientFrequentMetricsLatencyThresholdInMS",1E3),ree:ia.kd("RtcJsClientFrequentMetricsLogIntervalInMS",3E5),rPc:ia.qa("RtcClientMessageTelemetryEnabled"),sPc:ia.kd("RtcClientMessageTelemetrySampleSize",
5),xPc:ia.kd("RtcSendTelemetryMessageIntervalInMS",3E5),uPc:ia.kd("RtcLogClientMessageMetricsTimeOutInMs",2E4),wPc:ia.kd("RtcMaxPayloadSizeInCharactersOverride",ta.Yud),vPc:ia.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RTCLogSignalrHeartBeatMessages",!1)}):Object.assign(new T,{b1d:!1,DEc:!1,BEc:9E5,ZDc:!1,kQc:!1,lQc:!0,IFc:!1,KHc:9E4,rPc:!1,sPc:5,xPc:3E5,uPc:2E4,wPc:ta.Yud,vPc:!1})};Mf.Object.defineProperties(T.prototype,{VMg:{configurable:!0,enumerable:!0,get:function(){return this.DEc}},
UMg:{configurable:!0,enumerable:!0,get:function(){return this.BEc}},uIg:{configurable:!0,enumerable:!0,get:function(){return this.ZDc}},mwj:{configurable:!0,enumerable:!0,get:function(){return this.kQc}},nwj:{configurable:!0,enumerable:!0,get:function(){return this.lQc}},kYg:{configurable:!0,enumerable:!0,get:function(){return this.IFc}},z9b:{configurable:!0,enumerable:!0,get:function(){return this.KHc}},rtcJsClientFrequentlyLogsMetrics:{configurable:!0,enumerable:!0,get:function(){return this.see}},
FTf:{configurable:!0,enumerable:!0,get:function(){return this.qee}},dij:{configurable:!0,enumerable:!0,get:function(){return this.ree}},rtcClientMessageTelemetryEnabled:{configurable:!0,enumerable:!0,get:function(){return this.rPc}},Zhj:{configurable:!0,enumerable:!0,get:function(){return this.sPc}},KTf:{configurable:!0,enumerable:!0,get:function(){return this.xPc}},HTf:{configurable:!0,enumerable:!0,get:function(){return this.uPc}},JTf:{configurable:!0,enumerable:!0,get:function(){return this.wPc}},
ITf:{configurable:!0,enumerable:!0,get:function(){return this.vPc}}});Object(u.a)(T,"RealtimeChannelSettings",null,[118]);var Xa=b(1362),aa=b(85),ba=b(395);G.prototype.MV=function(ia,ta){this.sda=ta.newState};G.prototype.QSi=function(){P.ULS.sendTraceTag(18637070,500,15,"Too many undelivered messages. Restarting RTC connection.");this.Yg.Bqc()};G.prototype.r9h=function(ia){this.Mlb.init(ia)};Object(u.a)(G,"ARtcMessageHandler",null,[]);var oa=b(99);F.getInstance=function(ia){try{return healthSmall.HealthFactoryGlobal.getExtendedHealthInstance(oa.Health.instance,
ia)}catch(ta){return P.ULS.gk(521457890,383,10,ta,"Failed to initialize extendedHealth"),null}};Object(u.a)(F,"ExtendedHealth",null,[]);Object(u.a)(I,"PresenceDataEntryForClients",null,[]);var ra=b(113);D.prototype.send=function(){return this.evg()};Mf.Object.defineProperties(D.prototype,{messageId:{configurable:!0,enumerable:!0,get:function(){return this.$O}}});Object(u.a)(D,"MessageHandler",null,[98]);x.prototype.b9a=function(ia){this.callback=ia;this.K9f()};x.prototype.Qnf=function(ia){this.aGc||
(this.aGc=!0,this.Wlg=ia,this.K9f())};x.prototype.K9f=function(){this.aGc&&this.callback&&!this.L1d&&(this.L1d=!0,this.callback(this.Wlg))};Object(u.a)(x,"CompletionTask",null,[]);z.prototype.knc=function(ia){this.fae.b9a(ia)};z.prototype.jnc=function(ia){this.dae.b9a(ia)};z.prototype.oCb=function(ia){this.fae.Qnf(ia)};z.prototype.Ixa=function(ia){this.dae.Qnf(ia)};z.prototype.Sud=function(){this.oCb(2);this.Ixa(2)};Object(u.a)(z,"MessageStatus",null,[97]);var db=Sys.EventArgs;Rk(A,db);Object(u.a)(A,
"RefreshConnectionReconnectArgs",Sys.EventArgs,[]);var Ka=b(1190);B.prototype.start=function(){this.rp=new Date};B.prototype.stop=function(){this.NQc=new Date};Mf.Object.defineProperties(B.prototype,{qc:{configurable:!0,enumerable:!0,get:function(){return this.rp?this.NQc?this.NQc.getTime()-this.rp.getTime():(new Date).getTime()-this.rp.getTime():0}}});Object(u.a)(B,"SimpleStopwatch",null,[]);var Ga=b(1191),xa;(function(ia){ia[ia.contentUpdate=0]="contentUpdate";ia[ia.editorsTableUpdate=1]="editorsTableUpdate";
ia[ia.fileNameUpdate=2]="fileNameUpdate";ia[ia.wetContentUpdate=3]="wetContentUpdate";ia[ia.persistedContentUpdate=4]="persistedContentUpdate";ia[ia.clientRtcReconnectRequest=5]="clientRtcReconnectRequest";ia[ia.replicationTelemetry=6]="replicationTelemetry";ia[ia.lockUpdate=7]="lockUpdate";ia[ia.collabServiceContentUpdate=8]="collabServiceContentUpdate";ia[ia.trackChangeSettingUpdate=9]="trackChangeSettingUpdate";ia[ia.saveTargetUpdate=10]="saveTargetUpdate";ia[ia.uploadToOcsUpdate=11]="uploadToOcsUpdate";
ia[ia.labelUpdate=12]="labelUpdate";ia[ia.hostNotificationSubscriptionStatus=13]="hostNotificationSubscriptionStatus";ia[ia.subscribeOrExtend=14]="subscribeOrExtend";ia[ia.elapsedBootTelemetry=15]="elapsedBootTelemetry";ia[ia.clientToClientTelemetryMessage=16]="clientToClientTelemetryMessage";ia[ia.clientToClientResponseMessage=17]="clientToClientResponseMessage";ia[ia.verifyNotificationPipeline=18]="verifyNotificationPipeline";ia[ia.hostNotificationHeartbeat=19]="hostNotificationHeartbeat";ia[ia.secondaryMetadataUpdate=
20]="secondaryMetadataUpdate";ia[ia.last=21]="last"})(xa||(xa={}));Object(u.b)("UpdateNotificationType",xa);Object(u.a)(w,"FeatureUsageAndHealthConfig",null,[]);Object(u.a)(m,"IKpiUsageOptionalProperties",null,[]);Object(u.a)(y,"KpiUsageParams",null,[]);Rk(r,G);r.prototype.OPi=function(ia,ta){this.xr=this.Jtg(ta.hubConnection);this.Mlb.reset();this.xr.g8i(Object(ka.a)(this,this.Ula,"onPresenceUpdated"));this.xr.e8i(Object(ka.a)(this,this.Bnc,"onPersistentStateUpdated"));this.xr.d8i(Object(ka.a)(this,
this.kAd,"onPersistentStateCleared"));this.xr.H8i(Object(ka.a)(this,this.wca,"onUpdateNotificationReceived"))};r.prototype.MV=function(ia,ta){this.sda=ta.newState;2===ta.newState&&this.qmj()};r.prototype.qmj=function(){for(var ia=bk(this.VNc),ta=ia.next();!ta.done;ta=ia.next())ta=ta.value,this.zda(null,new Ka.a(ta.key,ta.value,!1,new R.a));this.VNc=new ba.a};r.prototype.LPi=function(ia,ta){ta.C_c();for(ia=0;3>ia;++ia)this.amj(ia,ta)};r.prototype.amj=function(ia,ta){var za=this;try{this.xr.ucd(ia).done(function(sa){ta.lfb(ta.p1c,
"GetCompletePresenceSuccess")&&(ta.S0g.ZRi(),P.ULS.sendTraceTag(3249540,500,50,"Successfully retrieved complete session state for [{0}]",za.Rl),za.Yg.t3i(),za.aPi(ia,sa),za.Yg.V2i(sa),ta.vQe.kb(ia)&&za.Yg.gKf(ia,ta.vQe.na(ia),new R.a))}).fail(function(sa){var V=b(932).RtcUtils;ta.lfb(ta.p1c,"GetCompletePresenceFail")&&(P.ULS.sendTraceTag(3249541,500,15,"Failed to retrieve complete session state : {0} for [{1}]",V.Q8a(sa),za.Rl),za.Yg.Bqc())}).always(function(){ta.stopwatch&&ta.stopwatch.stop()})}catch(sa){P.ULS.sendTraceTag(595132428,
500,10,"Exception thrown while calling hub method GetCompletePersistentStateWithMetadata. Promise not even created. Current event token: {0}, Exception message: {1}",ta.p1c,sa.message)}};r.prototype.IMd=function(ia,ta){var za=this,sa=b(932).RtcUtils;ia=ta.presence;var V=ta.aoa;this.KB.Kx(1,0);try{var Ia=sa.g_c(ia,this.Fjb)}catch(ob){this.KB.Kx(1,3);P.ULS.sendTraceTag(574407636,500,10,"Exception thrown while trying to serialize presence. Exception message: {0}",ob.message);V.setException(ob);return}sa=
new ca.a;sa.ia(this._clientId,Object.assign(new I,{Presence:ia,TimeStamp:(new Date).getTime()}));this.Yg.oKf(ta.type,sa);if(2!==this.sda)this.qp.DPa(),this.KB.Kx(1,2),V.setResult(null);else{var Ha=this.$O.toString();++this.$O;ia=new D(function(){return za.smj(ta.type,Ia,Ha)},Ha);ia=this.p8f(0,ta.type).add(ia);ia.knc(function(ob){2===ob&&za.KB.Kx(1,6);V.setResult(null)});ia.jnc(function(){})}};r.prototype.smj=function(ia,ta,za){var sa=this,V=null,Ia=new B,Ha=new z;P.ULS.sendTraceTag(3249501,500,50,
"Sending presence update for [{0}]",this.Rl);if(2!==this.sda)return this.qp.DPa(),this.KB.Kx(1,2),P.ULS.sendTraceTag(7934171,500,15,"Connection is lost - unable to send the message for [{0}]",this.Rl),Ha.Sud(),Ha;this.ph&&20>this.Xae&&(V=this.ph.sc("WebServiceCall","Send Presence Message"),this.Xae++);Ia.start();Ha.oCb(1);try{this.xr.updatePersistentState(ia,ta).done(function(){sa.qp.rGd();sa.KB.Kx(1,1);P.ULS.sendTraceTag(3249502,500,50,"Successfully delivered presence update message [{0}] for [{1}]",
za,sa.Rl);Ha.Ixa(1);Ia&&(Ia.stop(),Ia.qc>sa.he.FTf?sa.KB.Kx(1,4):sa.KB.Kx(1,5))}).fail(function(ob){var ib=b(932).RtcUtils;sa.TIa||(sa.qp.DPa(),sa.KB.Kx(1,3),P.ULS.sendTraceTag(3249503,500,15,"Server failed to process the presence update message [{0}]: [{1}] for [{2}]",za,ib.Q8a(ob),sa.Rl));Ha.Ixa(2)}).always(function(){V&&V.stop()})}catch(ob){P.ULS.sendTraceTag(593072906,500,15,"Exception when invoking hub method UpdatePersistentState, error: {1}",ob.message),this.KB.Kx(1,3),Ha.Ixa(2)}return Ha};
r.prototype.Jeb=function(ia,ta){var za=this;ia=b(932).RtcUtils;var sa=ta.jYg,V=ta.aoa;try{var Ia=ia.g_c(sa,this.Fjb)}catch(Ha){P.ULS.sendTraceTag(544318999,500,10,"Exception thrown while trying to serialize clientInfo. Exception message: {0}",Ha.message);V.setException(Ha);return}try{this.xr.Jeb(Ia).done(function(){P.ULS.sendTraceTag(544319E3,500,50,"Successfully delivered clientInfo.")}).fail(function(Ha){var ob=b(932).RtcUtils;za.TIa||P.ULS.sendTraceTag(544319001,500,15,"Server failed to process udpate clientInfo: {0}.",
ob.Q8a(Ha));V.setResult(null)})}catch(Ha){P.ULS.sendTraceTag(544319002,500,15,"Exception when invoking hub method UpdateClientInfo: error: {0}",Ha.message),V.setResult(null)}};r.prototype.zda=function(ia,ta){var za=this;ia=b(932).RtcUtils;var sa=ta.type,V=ta.T7,Ia=ta.$ch,Ha=ta.aoa;this.KB.Kx(0,0);try{var ob=ia.g_c(V,this.Fjb)}catch(La){this.KB.Kx(0,3);P.ULS.sendTraceTag(574407637,500,10,"Exception thrown while trying to serialize updateHint. Exception message: {0}",La.message);Ha.setException(La);
return}if(2!==this.sda)Ia?this.VNc.ia(sa,V):(this.qp.DPa(),this.KB.Kx(0,2)),Ha.setResult(null);else{var ib=this.$O.toString();++this.$O;ta=new D(function(){return za.Nmj(sa,ob,ib)},ib);ta=this.p8f(1,sa).add(ta);ta.knc(function(La){2===La&&za.KB.Kx(0,6);Ha.setResult(null)});ta.jnc(function(){})}};r.prototype.Nmj=function(ia,ta,za){var sa=this,V=null,Ia=new B,Ha=new z;P.ULS.sendTraceTag(3249505,500,50,"Sending update notification for [{0}]",this.Rl);if(2!==this.sda)return this.qp.DPa(),this.KB.Kx(0,
2),P.ULS.sendTraceTag(7934172,500,15,"Connection is lost - unable to send the message for [{0}]",this.Rl),Ha.Sud(),Ha;this.ph&&3===ia&&20>this.Yae&&(V=this.ph.sc("WebServiceCall","Send WetContent Update"),this.Yae++);Ia.start();Ha.oCb(1);this.xr.zda(ia,ta).done(function(){sa.qp.rGd();sa.KB.Kx(0,1);P.ULS.sendTraceTag(3249506,500,50,"Successfully delivered update notification message [{0}] for [{1}]",za,sa.Rl);Ha.Ixa(1);Ia&&(Ia.stop(),Ia.qc>sa.he.FTf?sa.KB.Kx(0,4):sa.KB.Kx(0,5))}).fail(function(ob){var ib=
b(932).RtcUtils;sa.TIa||(sa.qp.DPa(),sa.KB.Kx(0,3),P.ULS.sendTraceTag(3249507,500,15,"Server failed to process the update notification message [{0}] : [{1}] for [{2}]",za,ib.Q8a(ob),sa.Rl));Ha.Ixa(2)}).always(function(){V&&V.stop()});return Ha};r.prototype.qv=function(){this.xr.IOj(Object(ka.a)(this,this.Ula,"onPresenceUpdated"));this.xr.HOj(Object(ka.a)(this,this.Bnc,"onPersistentStateUpdated"));this.xr.GOj(Object(ka.a)(this,this.kAd,"onPersistentStateCleared"));this.xr.QOj(Object(ka.a)(this,this.wca,
"onUpdateNotificationReceived"))};r.prototype.UMi=function(ia,ta){this.Ula(ta.yO,ta.p3)};r.prototype.Ula=function(ia){this.qp.gHb();this.Bnc(0,ia)};r.prototype.TMi=function(ia,ta){this.Bnc(ta.type,ta.yO)};r.prototype.aPi=function(ia,ta){var za={},sa;for(sa in ta)za[sa]=ta[sa].Presence;this.xzf(ia,za,ta)};r.prototype.Bnc=function(ia,ta){this.qp.gHb();this.xzf(ia,ta)};r.prototype.xzf=function(ia,ta,za){za=void 0===za?null:za;var sa=b(932).RtcUtils;if(P.ULS.Gda(500,100))for(var V in ta);delete ta[this._clientId];
if(!ra.a.isEmpty(ta)){for(var Ia in ta)V=Ia,ta[V]=sa.deserialize(ta[Ia],"Presence",V,!1,this.Fjb);sa=new ca.a;Ia=(new Date).getTime();for(var Ha in ta){V=ta[Ha];var ob=Ha;if(za){var ib=za[ob];ib.Presence=V}else ib=Object.assign(new I,{Presence:V,TimeStamp:Ia});sa.ia(ob,ib)}this.Yg.oKf(ia,sa);switch(ia){case 0:this.x$d||(P.ULS.sendTraceTag(4539734,500,50,"Raising first presence update notification for [{0}]",this.Rl),this.x$d=!0,ea.AFrameworkApplication.Lf&&ea.AFrameworkApplication.Lf.Yxi());this.Yg.ZJf(ta,
[]);break;default:this.Yg.n3i(ia,ta)}}};r.prototype.RMi=function(ia,ta){this.kAd(ta.Y_c)};r.prototype.kAd=function(ia){this.qp.gHb();if(P.ULS.Gda(500,100))for(var ta=0;ta<ia.length;++ta);ia.length&&(this.Yg.I3i(ia),this.Yg.m3i(ia),this.Yg.ZJf({},ia))};r.prototype.VMi=function(ia,ta){this.wca(ta.type,ta.T7)};r.prototype.wca=function(ia,ta){ta=void 0===ta?null:ta;this.he.mwj&&0===ia&&P.ULS.sendTraceTag(40128990,500,50,"Received ContentUpdate notification from the server");if(0===ia&&this.HNc&&0<this.HNc.length){var za=
Object.assign(new w,{topLevelKpiName:"ContentUpdateNotificationReceived",featureName:"RtcNotification",crewAlias:this.HNc,vetoPillar:"RealTimeCoauth"});(za=F.getInstance(za))&&za.logKpiUsage(this.nrg)}this.he.nwj&&13===ia&&P.ULS.sendTraceTag(575221780,500,50,String.format("Received HostSubscription notification from the server : {0}",ta||"<none>"));this.qp.gHb();5===ia?(ta=(ia=this.pWi(ta))?String.format("Received client reconnection request from the server. Reason: {0}, Backoff time: {1} ",ia.reason,
ia.reconnectDelay):"Received client reconnection request from the server without params.",P.ULS.sendTraceTag(18637071,500,50,ta),this.Yg.Bqc(ia)):(ta=b(932).RtcUtils.deserialize(ta,String.format("UpdateNotification-{0}",xa[ia]),null,!1,this.Fjb),this.Yg.H3i(ia,ta))};r.prototype.pWi=function(ia){try{if(!ia||""===ia)return null;var ta=JSON.parse(ia);return new A(ta[Ga.a.kLd],ta[Ga.a.Yhj],ta[Ga.a.$hj],ta[Ga.a.yMd])}catch(za){return P.ULS.sendTraceTag(593844380,500,15,"Error when parsing reconnect hint: {0}",
za.message),null}};r.prototype.p8f=function(ia,ta){return this.Mlb.wYh(this.xYh(ia,ta))};r.prototype.xYh=function(ia,ta){return ia+","+ta};r.LKh=function(){var ia=new Map;ia.set("SkipAria","True");ia=Object.assign(new m,{extendedProperties:ia});return Object.assign(new y,{kpiName:"ContentUpdateNotificationReceived",kpiType:0,optionalProperties:ia,blockFutureEmissionDurationInMs:3E5})};Object(u.a)(r,"RtcMessageHandler",G,[]);var da=b(97);v.prototype.tGd=function(){0<this.SEa&&0<this.Ghb&&P.ULS.sendTraceTag(36545635,
500,50,"Throttler [{0}] dropped [{1}] messages out of [{2}]",this.q8f,this.Ghb,this.SEa);0<this.SEa&&0<this.Llb&&P.ULS.sendTraceTag(36545634,500,50,"Throttler [{0}] throttled [{1}] messages out of [{2}]",this.q8f,this.Llb,this.SEa)};v.prototype.Tvc=function(ia,ta){this.Llb++;this.Vpb(!0);this.vKc=!0;this.cXb=ia;this.tXa=ta};v.prototype.Vpb=function(ia){this.vKc=!1;this.tXa&&ia&&(this.Ghb++,this.tXa.Sud());this.tXa=this.cXb=null};v.Z4c=function(ia,ta){return window.setTimeout(ia,ta)};Mf.Object.defineProperties(v.prototype,
{g6a:{configurable:!0,enumerable:!0,get:function(){return this.vKc}}});Object(u.a)(v,"ThrottlerBase",null,[]);Rk(f,v);f.prototype.add=function(ia){this.WVa||this.init(f.LFe,f.FFe);this.SEa++;var ta=new z;this.g6a?this.Tvc(ia,ta):this.wUb<this.l8a?this.RJb(ia,ta):(this.Tvc(ia,ta),this.VVa=!1);return ta};f.prototype.RJb=function(ia,ta){var za=this;ia=this.afe(ia);var sa=this.setTimeout(Object(ka.a)(this,this.YNi,"onMessageWaitTimeExpired"),this.cBa);++this.wUb;Array.add(this.fXb,sa);var V=this.gRb;
ia.knc(function(Ia){ta.oCb(Ia)});ia.jnc(function(Ia){za.gRb===V&&(za.XNi(V,sa),ta.Ixa(Ia))})};f.prototype.XNi=function(ia,ta){this.gRb===ia&&(--this.wUb,this.clearTimeout(ta),Array.remove(this.fXb,ta),this.g6a&&this.Bmj())};f.prototype.Bmj=function(){this.g6a&&!this.VVa&&(this.sRc=this.setTimeout(Object(ka.a)(this,this.Cmj,"sendThrottledMessageFromTimer"),0),this.VVa=!0)};f.prototype.Cmj=function(){this.VVa=!1;if(this.g6a){var ia=this.cXb,ta=this.tXa;this.Vpb(!1);this.RJb(ia,ta)}};f.prototype.YNi=
function(){++this.tRb;this.tRb>Math.floor(this.l8a/2)&&(this.tRb=-1E9,this.$a.raiseEvent("TMUDM"))};f.prototype.EZb=function(ia){this.$a.addHandler("TMUDM",ia)};f.prototype.reset=function(){this.SEa=this.Llb=this.Ghb=this.tRb=0;++this.gRb;for(var ia=bk(this.fXb),ta=ia.next();!ta.done;ta=ia.next())this.clearTimeout(ta.value);this.wUb=0;this.fXb=[];this.Vpb(!0);this.VVa&&(this.clearTimeout(this.sRc),this.sRc=0,this.VVa=!1)};f.prototype.init=function(ia,ta){this.WVa||(this.cBa=ia,this.l8a=ta,this.WVa=
!0)};f.createInstance=function(ia,ta){return new f(ia,void 0===ta?"":ta)};f.M4c=function(ia){window.clearTimeout(ia)};f.LFe=15E3;f.FFe=5;Object(u.a)(f,"MaxOutstandingThrottler",v,[101,96]);Rk(n,v);n.prototype.init=function(ia){this.WVa||(this.r8a=ia,this.WVa=!0)};n.prototype.add=function(ia){this.WVa||this.init(n.wFe);this.SEa++;var ta=this.currentTime(),za=new z;this.hjb>ta&&(this.hjb=ta);this.g6a?(this.Vpb(!0),this.Tvc(ia,za)):this.hjb+this.r8a<=ta?this.RJb(ia,za):(this.Tvc(ia,za),this.setTimeout(Object(ka.a)(this,
this.Amj,"sendThrottledMessage"),this.hjb+this.r8a-ta));return za};n.prototype.Amj=function(){if(this.g6a){var ia=this.cXb,ta=this.tXa;this.Vpb(!1);this.RJb(ia,ta)}};n.prototype.RJb=function(ia,ta){this.hjb=this.currentTime();ia=this.afe(ia);ia.knc(function(za){ta.oCb(za)});ia.jnc(function(za){ta.Ixa(za)})};n.createInstance=function(ia,ta){return new n(ia,void 0===ta?"":ta)};n.wFe=200;Object(u.a)(n,"MaxRateThrottler",v,[95,96]);l.prototype.ZCe=function(ia,ta){return f.createInstance(ia,void 0===ta?
"":ta)};l.prototype.e7g=function(ia,ta){return n.createInstance(ia,void 0===ta?"":ta)};Object(u.a)(l,"ThrottlerFactory",null,[81]);var qa=b(1192);k.prototype.init=function(ia){this.Sw||(this.he=ia,this.AVa.init(this.he.cBa,this.he.a0h),this.Sw=!0)};k.prototype.wYh=function(ia){var ta=this;this.Sw||this.init(new qa.a(n.wFe,f.LFe,f.FFe,k.Qyi));if(!function(){var Ia=ta.wMc.yc(ia);V=Ia.value;return Ia}().returnValue){if(!function(){var Ia=ta.vMc.yc(ia);sa=Ia.value;return Ia}().returnValue){var za="MaxOutstandingThrottler-"+
ia;var sa=this.tRc.ZCe(Object(ka.a)(this.AVa,this.AVa.add,"add"),za);sa.init(this.he.cBa,this.he.Pyi);sa.EZb(function(){ta.$a.raiseEvent("TMUDM")});this.vMc.add(ia,sa)}za="MaxRateThrottler-"+ia;var V=this.tRc.e7g(Object(ka.a)(sa,sa.add,"add"),za);V.init(this.he.Jzi);this.wMc.add(ia,V)}return V};k.prototype.reset=function(){for(var ia=bk(this.wMc),ta=ia.next();!ta.done;ta=ia.next())ta.value.value.tGd();ia=bk(this.vMc);for(ta=ia.next();!ta.done;ta=ia.next())ta=ta.value,ta.value.tGd(),ta.value.reset();
this.AVa.tGd();this.AVa.reset()};k.prototype.EZb=function(ia){this.$a.addHandler("TMUDM",ia)};k.Qyi=1E3;Object(u.a)(k,"ThrottlerManager",null,[82]);var na;(function(ia){ia[ia.unspecified=0]="unspecified";ia[ia.word=1]="word";ia[ia.excel=2]="excel";ia[ia.powerPoint=3]="powerPoint";ia[ia.test=4]="test";ia[ia.wacFrontEnd=5]="wacFrontEnd";ia[ia.oneNote=6]="oneNote";ia[ia.visio=7]="visio";ia[ia.officeMobile=8]="officeMobile";ia[ia.cosmosDBChangefeed=9]="cosmosDBChangefeed";ia[ia.last=10]="last"})(na||
(na={}));Object(u.b)("RtcClientAppName",na);b.d(E,"RealtimeChannel",function(){return a});a.prototype.init=function(){var ia=this;this.Yg.cGg(Object(ka.a)(this,this.r6b,"disconnectAndCreateNewConnection"));this.Yg.SGg(Object(ka.a)(this,this.dTi,"onUpdatePersistentStateRequestReceivedInternal"));this.Yg.RGg(Object(ka.a)(this,this.cTi,"onUpdatePersistentStateClearedRequestReceived"));this.Og.KTc(this.qp);ea.AFrameworkApplication.tMb(function(){ia.qp.uGd();va.a.instance&&va.a.instance.ltd()});this.gDe();
this.$eh();this.Yg.wGg(Object(ka.a)(this,this.eQj,"updateConnectionQueryString"))};a.prototype.$eh=function(){try{var ia=$.signalR;if(!ia)throw Error.invalidOperation("Failed to retrieve Signalr object");var ta=ia.version;if(!ta)throw Error.invalidOperation("Signalr object is missing version information");if("2.1.1"===ta){var za=ia.transports;if(!za)throw Error.invalidOperation("Failed to retrieve transports object");var sa=za.longPolling;if(!sa)throw Error.invalidOperation("Failed to retrieve longPolling object");
if(!sa.supportsKeepAlive)throw Error.invalidOperation("LongPolling object does not have a field called supportsKeepAlive");sa.supportsKeepAlive=this.E9g()}}catch(V){P.ULS.sendTraceTag(6432339,500,15,"Failed to disable longPolling KeepAlives: {0}",V.message)}};a.prototype.E9g=function(){return function(){return!1}};a.prototype.gDe=function(){var ia=this,ta=++this.Zgb;this.tLc=(new Date(0)).getTime();this.TO=this.Zlg();this.Yg.r3i(this.TO);this.TO.stateChanged(function(za){ia.DHi(za,ta)});this.TO.connectionSlow(Object(ka.a)(this,
this.ORi,"onSlowConnection"));this.TO.error(Object(ka.a)(this,this.DRi,"onSignalRError"));this.TO.log=Object(ka.a)(this,this.ERi,"onSignalRLog")};a.prototype.lfb=function(ia,ta){return ia!==this.Zgb?(P.ULS.sendTraceTag(4309017,500,50,"ConnectionToken verification failed for {0}",ta),!1):!0};a.prototype.connect=function(){2!==this.sL&&1!==this.sL&&(P.ULS.sendTraceTag(4539721,500,50,"Starting a new RTC connection for client [{0}]",this.Rl),this.bGc.BHi(),ua.a.instance.SDj(),this.MV(1,this.sL),this.I4f())};
a.prototype.I4f=function(){var ia=this.Zgb;this.MQc=!1;this.qp.TLf();this.bpa.KVh(Object(ka.a)(this,this.N0g,"connectSignalrConnection"),Object(ka.a)(this,this.Nvf,"onFailureToConnect"),Object(ka.a)(this.Oza,this.Oza.r9h,"initThrottlerManager"),Object(ka.a)(this,this.lfb,"verifyConnectionToken"),ia)};a.prototype.Nvf=function(ia){ia=void 0===ia?null:ia;this.qp.VLf();var ta=null;!ia||"documentsessiondeleted"!==(ta=ia.toLowerCase())&&"documentsessionexpired"!==ta?this.r6b():(P.ULS.sendTraceTag(41788292,
500,15,"In RealtimeChannel method OnFailureToConnect: Disconnect was called for [{0}], due to non-retriable RtcErrorCode:{1}",this.Rl,ia),this.disconnect())};a.prototype.r6b=function(ia,ta){ta=void 0===ta?null:ta;P.ULS.sendTraceTag(4309018,500,50,"Disconnecting the connection [{0}]",this.j1);ia=(ia=2===this.sL||1===this.sL)&&!this.Oza.TIa;var za=!0,sa=0;ta&&Object.getType(ta)!==Object.getType(Sys.EventArgs.Empty)&&ta.lJd&&""!==ta.lJd&&(ia=!0,this.bpa.Trj(ta.lJd),za=ta.yMd,sa=ta.reconnectDelay);ia&&
this.MV(1,this.sL);++this.Zgb;this.Oza.qv();this.QEj(za);this.bpa.agh();this.gDe();ia&&window.setTimeout(Object(ka.a)(this,this.I4f,"startConnecting"),Math.min(sa,3E4))};a.prototype.eQj=function(){var ia=this.bpa.$Xe();var ta=ia.correlationId;this.TO.qs=ia.returnValue;P.ULS.sendTraceTag(40768457,500,50,"Connection parameters refresh finished for client [{0}], CorrelationId:{1}",this.Rl,ta)};a.prototype.N0g=function(ia){var ta=this;this.tLc=(new Date).getTime();var za=null;this.TO.qs=function(){var V=
ta.bpa.$Xe();za=V.correlationId;return V}().returnValue;this.he.uIg&&(this.TO.url=ia,va.a.instance&&(va.a.instance.oAe=wa.a.yM(ia)));var sa=null;this.ph&&(sa=this.ph.sc("WebServiceCall","ConnectToServer"));P.ULS.sendTraceTag(3290048,500,50,"Connecting to server for client [{0}]",this.Rl);ia={};this.lXb&&(ia.transport=1===this.lXb.length?this.lXb[0]:this.lXb);ia.pingInterval=null;ua.a.instance.fHb(1,0);ia.waitForPageLoad=!1;this.TO.start(ia,null).done(function(V){ta.qp.WLf();ua.a.instance.fHb(1,1,
!0);P.ULS.sendTraceTag(3457857,500,50,"Successfully connected to server using connection [{0}], CorrelationId:{1}",V.id,za)}).fail(function(V){P.ULS.sendTraceTag(3457858,500,15,"Failed to connect to server : connection string: {0}, CorrelationId:{1},  ClientDetails: [{2}]",ta.bpa.gC,za,ta.Rl);ta.Nvf();ta.qp.ULf(V);ua.a.instance.fHb(1,1,!1);var Ia={};ta.Yg.dKf(0,(Ia.CorrelationId=za,Ia.ErrorDetails=V,Ia.ConnectionState=fa.a[ta.sL],Ia))}).always(function(){sa&&sa.stop();va.a.instance&&(va.a.instance.uHc=
!1)})};a.prototype.disconnect=function(){0===this.sL?P.ULS.sendTraceTag(36545632,500,50,"Disconnect for [{0}] was called but the channel is already Disconnected",this.Rl):(this.qp.ZLf(),va.a.instance&&(va.a.instance.uHc=!0),P.ULS.sendTraceTag(36545633,500,50,"Starting explicit disconnect for [{0}]",this.Rl),this.Oza.TIa=!0,this.bGc.BIi(),this.MV(0,this.sL),this.r6b(),this.Oza.TIa=!1)};a.prototype.QEj=function(ia){function ta(){if(za.MQc)P.ULS.sendTraceTag(591692192,500,15,"Stop connection was called twice, possibly on the same connection.");
else try{za.MQc=!0,V.stop(!0,ia)}catch(Ha){P.ULS.sendTraceTag(591692191,500,15,"Stopping connection failed: {0}",Ha.message)}}var za=this,sa=this.nTg(),V=this.TO,Ia=this.j1;0<sa?(P.ULS.sendTraceTag(4309020,500,50,"Waiting to stop connection [{0}]: [{1}] ms.",Ia,sa),window.setTimeout(ta,sa)):(P.ULS.sendTraceTag(36804372,500,50,"Stopping connection [{0}].",Ia),ta())};a.prototype.nTg=function(){var ia=0;0===this.TO.state&&(ia=this.tLc+a.fWj-(new Date).getTime(),0>ia&&(ia=0));return ia};a.prototype.Dga=
function(ia){this.Yg.Dga(ia)};a.prototype.Gma=function(ia){this.Yg.Gma(ia)};a.prototype.GWf=function(ia){this.IMd(0,ia)};a.prototype.IMd=function(ia,ta){var za=new R.a;this.Yg.gKf(ia,ta,za);return za.task};a.prototype.CFa=function(ia){this.Yg.CFa(ia)};a.prototype.Cza=function(ia){this.Yg.Cza(ia)};a.prototype.cwb=function(ia){return this.CZh(ia)};a.prototype.Qbd=function(){return this.pHh()};a.prototype.pHh=function(){for(var ia={},ta=bk(this.pG),za=ta.next();!za.done;za=ta.next())za=za.value,za.value.kb(0)&&
(ia[za.key]=za.value.na(0).data);return ia};a.prototype.CZh=function(ia){return this.pG.kb(ia)&&this.pG.na(ia).kb(0)?this.pG.na(ia).na(0).data:null};a.prototype.dTi=function(ia,ta){ia=bk(ta.xTj);for(var za=ia.next();!za.done;za=ia.next()){za=za.value;this.pG.kb(za.key)||this.pG.ia(za.key,new ba.a);var sa=za.value;this.pG.na(za.key).ia(ta.type,new N(sa.Presence,new Date(sa.TimeStamp)));za.key===this._clientId&&0===ta.type&&this.Yg.f3i(sa.Presence)}};a.prototype.cTi=function(ia,ta){ia=bk(ta.Y_c);for(ta=
ia.next();!ta.done;ta=ia.next())this.pG.remove(ta.value)};a.prototype.oHh=function(){var ia=new ba.a;if(!this.pG.kb(this._clientId))return ia;for(var ta=bk(this.pG.na(this._clientId)),za=ta.next();!za.done;za=ta.next())za=za.value,ia.ia(za.key,za.value.data);return ia};a.prototype.zda=function(ia,ta,za){ta=void 0===ta?null:ta;za=void 0===za?!1:za;var sa=new R.a;this.Yg.qFd(ia,ta,za,sa);return sa.task};a.prototype.tYa=function(ia){this.Yg.tYa(ia)};a.prototype.lIb=function(ia){this.Yg.lIb(ia)};a.prototype.qva=
function(ia){var ta=this,za,sa;return function(){var V=ta.pG.yc(ia);za=V.value;return V}().returnValue&&function(){var V=za.yc(0);sa=V.value;return V}().returnValue?new Q(this.GZh(sa),sa.timeStamp):null};a.prototype.uHh=function(){for(var ia={},ta={},za=bk(this.pG),sa=za.next();!sa.done;ta={Ifb:ta.Ifb,aDc:ta.aDc},sa=za.next())ta.Ifb=sa.value,ta.aDc=void 0,function(V){return function(){var Ia=V.Ifb.value.yc(0);V.aDc=Ia.value;return Ia}}(ta)().returnValue&&(ia[ta.Ifb.key]=this.qva(ta.Ifb.key));return ia};
a.prototype.Jeb=function(ia){var ta=new R.a;this.Yg.G3i(ia,ta);return ta.task};a.prototype.dispose=function(){this.ut||(this.Oza.qv(),this.Og.X9i(this.qp),this.qp.uGd(),va.a.instance&&va.a.instance.ltd(),this.ut=!0)};a.prototype.DHi=function(ia,ta){this.lfb(ta,"StateChangedSignalR")&&this.MV(this.dBe(ia.newState),this.dBe(ia.oldState))};a.prototype.MV=function(ia,ta){if((1!==this.sL||0!==ta||1!==ia)&&this.sL!==ta){var za=String.format.apply(null,["Unexpected connection state change : Current state is '{0}' while the event indicates ('{1}'->'{2}') transition"].concat([this.sL,
ta,ia]));P.ULS.sendTraceTag(3290053,500,10,za)}if(this.sL!==ia){switch(ia){case 2:va.a.instance&&va.a.instance.ayi();this.j1=this.TO.id;P.ULS.sendTraceTag(3249539,500,50,"Established connection [{0}] for client [{1}]",this.j1,this.Rl);this.Zvi(this.TO);P.ULS.sendTraceTag(4298369,500,50,"Retrieving complete session state");za=null;this.ph&&(za=this.ph.sc("WebServiceCall","Receive First Presence"));var sa=this.Zgb;this.Yg.q3i(Object(ka.a)(this,this.lfb,"verifyConnectionToken"),sa,this.bGc,Object(ka.a)(this,
this.C_c,"clearExistingPersistentState"),this.oHh(),za);this.he.rtcClientMessageTelemetryEnabled&&M.Eed(this.Yg,this.he,100*Math.random()<=this.he.Zhj).start();break;case 1:2===ta&&P.ULS.sendTraceTag(4298644,500,50,"Lost connection [{0}] to the server ...trying to re-establish it",this.j1);break;case 0:if(M.instance&&M.instance.stop(),this.Oza.TIa)P.ULS.sendTraceTag(3249543,500,50,"Connection [{0}] has been explicitly closed",this.j1);else{1===ta&&(P.ULS.sendTraceTag(7672737,500,50,"Signalr detected an unexpected disconnect event while attempting to re-establish connection [{0}]. Kicking off global reconnect logic ...",
this.j1),this.qp.$Lf());2===ta&&P.ULS.sendTraceTag(36574532,500,50,"Signalr detected a disconnect event triggered by a period of client inactivity for connection [{0}]. Kicking off global reconnect logic ...",this.j1);this.r6b();return}}this.sL=ia;this.Yg.D2i(ia,ta)}};a.prototype.Zvi=function(ia){if(ia&&ia.transport&&ia.transport.name){ia=ia.transport.name;var ta=ia.toLowerCase();"websockets"===ta?P.ULS.sendTraceTag(4290723,500,50,"Transport name - {0} for [{1}]",ia,this.Rl):"serversentevents"===
ta?P.ULS.sendTraceTag(4290752,500,50,"Transport name - {0} for [{1}]",ia,this.Rl):"foreverframe"===ta?P.ULS.sendTraceTag(4290753,500,50,"Transport name - {0} for [{1}]",ia,this.Rl):"longpolling"===ta?P.ULS.sendTraceTag(4290754,500,50,"Transport name - {0} for [{1}]",ia,this.Rl):"mocktransport"!==ta&&P.ULS.sendTraceTag(4290755,500,15,"Unknown transport protocol encountered - '{0}'",ia)}else P.ULS.sendTraceTag(4290722,500,10,"Transport protocol name is missing")};a.prototype.ORi=function(){if(this.he.ITf){var ia=
wa.a.$A(this.d8a,"mid");P.ULS.sendTraceTag(3249544,500,15,"Detected that the connection [{0}] is slow for target machine [{1}]",this.j1,ia)}else P.ULS.sendTraceTag(522716053,500,50,"Detected that the connection [{0}] is slow",this.j1)};a.prototype.DRi=function(){P.ULS.sendTraceTag(3249545,600,15,"SignalR ERROR for connection [{0}];",this.j1)};a.prototype.ERi=function(ia){ia=b(932).RtcUtils.Q8a(ia);if(this.he.ITf&&ia.startsWith("Keep alive timed out.")){var ta=wa.a.$A(this.d8a,"mid");P.ULS.sendTraceTag(522716054,
500,15,"SignalR lib: {0}. Target Machine: {1}",ia,ta)}else this.fBj&&2E3>this.Rfe&&!ia.startsWith("Invok")&&!ia.startsWith("Trigger")&&(P.ULS.sendTraceTag(578950464,500,50,"SignalR lib: {0}",ia),this.Rfe++)};a.prototype.C_c=function(){var ia=[],ta=this.pG.yc(this._clientId);var za=ta.value;ta.returnValue&&this.pG.remove(this._clientId);var sa=bk(this.pG.keys);for(ta=sa.next();!ta.done;ta=sa.next())Array.add(ia,ta.value);sa=bk(ia);for(ta=sa.next();!ta.done;ta=sa.next())this.pG.remove(ta.value);za&&
this.pG.ia(this._clientId,za);this.Yg.a3i(ia)};a.prototype.dBe=function(ia){switch(ia){case 0:return 1;case 2:return 1;case 1:return 2;case 4:return 0;default:throw Error.argumentOutOfRange("state",ia,"Unknown SignalR state");}};a.prototype.GZh=function(ia){return ia&&ia.timeStamp?(new Date).getTime()-ia.timeStamp.getTime()>(this.he.VMg?6E4:this.he.UMg)?2:1:1};a.createInstance=function(ia,ta,za,sa,V,Ia,Ha,ob,ib,La,zb,Fb,Yb){return e(ia,ta,za,void 0===Yb?null:Yb,sa,V,Ia,Ha,void 0===ob?null:ob,void 0===
ib?null:ib,void 0===La?null:La,void 0===Fb?null:Fb,void 0===zb?null:zb)};Mf.Object.defineProperties(a.prototype,{d8a:{configurable:!0,enumerable:!0,get:function(){return this.bpa.d8a},set:function(ia){this.bpa.d8a=ia}},Oza:{configurable:!0,enumerable:!0,get:function(){return this.Vug}},Yg:{configurable:!0,enumerable:!0,get:function(){return this.tjg}},connectionState:{configurable:!0,enumerable:!0,get:function(){return this.sL}},clientId:{configurable:!0,enumerable:!0,get:function(){return this._clientId}},
fBj:{configurable:!0,enumerable:!0,get:function(){return this.Vvg}}});a.lof=31E3;a.Yud=8E3;a.fWj=15E3;Object(u.a)(a,"RealtimeChannel",null,[17,18])},1085:function(u,E,b){function a(){this.xge=!1;this.nOc=null;this.f3d=0;this.JHc=this.kEe();this.fRb=this.kEe();this.FCa=this.xVa=0;this.aw=function(){return new Date}}b.d(E,"a",function(){return a});u=b(0);a.prototype.kEe=function(){for(var c=Array(6),d=0;d<c.length;d++)c[d]=0;return c};a.prototype.NNh=function(){return this.JHc.toString()};a.prototype.CKh=
function(){return this.fRb.toString()};a.prototype.SDj=function(){this.nOc=this.aw()};a.prototype.fHb=function(c,d,e){if(!this.JFj){if(void 0===e?0:e)this.xge=!0;e=this.aw();0===c&&5<this.xVa||1===c&&5<this.FCa||(this.f3d<c?(1===this.xVa%2&&(this.JHc[this.xVa]=-1,this.xVa++),this.f3d=c,1===d&&(this.fRb[this.FCa]=-1,this.FCa++),this.fRb[this.FCa]=this.gTd(e),this.FCa++):0===c?(this.JHc[this.xVa]=this.gTd(e),this.xVa++):(this.fRb[this.FCa]=this.gTd(e),this.FCa++))}};a.prototype.gTd=function(c){var d=
c.getTime()-this.nOc.getTime();this.nOc=c;return d};Mf.Object.defineProperties(a.prototype,{JFj:{configurable:!0,enumerable:!0,get:function(){return this.xge}}});Mf.Object.defineProperties(a,{instance:{configurable:!0,enumerable:!0,get:function(){a.Ma||(a.Ma=new a);return a.Ma},set:function(c){a.Ma=c}}});a.Ma=null;Object(u.a)(a,"LatencyMetrics",null,[])},1148:function(u,E,b){function a(f){this.oAe=this.oSe=null;this.kof=this.gUe=0;this.qp=null;this.D$d=this.hMc=0;this.Og=f;this.S$h();this.uHc=this.z5d=
this.EMc=!1;this.bMc=0}u=b(0);var c=b(14),d=b(84),e=b(113),k;(function(f){f[f.SendNotification=0]="SendNotification";f[f.SendPersistentState=1]="SendPersistentState";f[f.FindSession=2]="FindSession";f[f.Last=3]="Last"})(k||(k={}));Object(u.b)("ApiType",k);var l;(function(f){f[f.AttemptCount=0]="AttemptCount";f[f.SuccessCount=1]="SuccessCount";f[f.DropCount=2]="DropCount";f[f.FailedCount=3]="FailedCount";f[f.LatencyOverThresholdCount=4]="LatencyOverThresholdCount";f[f.LatencyUnderThresholdCount=5]=
"LatencyUnderThresholdCount";f[f.ThrottledCount=6]="ThrottledCount";f[f.Last=7]="Last"})(l||(l={}));Object(u.b)("EventCountType",l);var n=b(1085);b.d(E,"a",function(){return a});a.prototype.QDj=function(f){this.D$d=f;window.setInterval(Object(d.a)(this,this.ltd,"logMetricsBatchAndReset"),f);this.hMc=(new Date).getTime()};a.prototype.Kx=function(f,v){this.lvj(f)&&!this.z5d||this.axh||!window.navigator.onLine||this.Og.k6a||(this.qp[f][v]++,this.EMc=!0)};a.prototype.S$h=function(){this.qp=Array(3);for(var f=
0;3>f;f++){this.qp[f]=Array(7);for(var v=0;7>v;v++)this.qp[f][v]=0}};a.prototype.pQg=function(){for(var f={},v=0;3>v;v++)for(var r=0;7>r;r++)this.Oni(v,r)&&(f[k[v]+l[r]]=this.qp[v][r]);f.FSDomain=this.oSe;f.ConnectionDomain=this.oAe;f.FSRetryInterval=this.gUe;f.MaxPayloadSize=this.kof;f.LogNumber=this.bMc;1===this.bMc&&(f.FSLatencies=n.a.instance.NNh(),f.ConLatencies=n.a.instance.CKh());return f};a.prototype.Oni=function(f,v){return 2===f&&3!==v&&0!==v?!1:!0};a.prototype.lvj=function(f){return 2===
f?!1:!0};a.prototype.ltd=function(){if(this.EMc){this.bMc++;if((new Date).getTime()-this.hMc<5E3+this.D$d){var f=e.a.toJSON(this.pQg());c.ULS.sendTraceTag(50644352,500,15,f)}this.hMc=(new Date).getTime();for(f=0;3>f;f++)for(var v=0;7>v;v++)this.qp[f][v]=0;this.EMc=!1}};a.prototype.ayi=function(){this.z5d=!0};a.create=function(f){a.instance||(a.Ma=new a(f));return a.instance};Mf.Object.defineProperties(a.prototype,{axh:{configurable:!0,enumerable:!0,get:function(){return this.uHc}}});Mf.Object.defineProperties(a,
{instance:{configurable:!0,enumerable:!0,get:function(){return a.Ma}}});a.Ma=null;Object(u.a)(a,"FrequentLoggingMetrics",null,[45])},1190:function(u,E,b){function a(d,e,k,l){var n=c.call(this)||this;n.type=d;n.T7=e;n.$ch=k;n.aoa=l;return n}b.d(E,"a",function(){return a});u=b(0);var c=Sys.EventArgs;Rk(a,c);Object(u.a)(a,"SendUpdateNotificationEventArgs",Sys.EventArgs,[])},1191:function(u,E,b){function a(){}b.d(E,"a",function(){return a});u=b(0);a.kLd="rr";a.$hj="rd";a.Yhj="rbp";a.yMd="sa";Object(u.a)(a,
"RtcReconnectParams",null,[])},1192:function(u,E,b){function a(c,d,e,k){this.Jzi=c;this.cBa=d;this.Pyi=e;this.a0h=k}b.d(E,"a",function(){return a});u=b(0);Object(u.a)(a,"ThrottlerManagerSettings",null,[])},1362:function(u,E,b){function a(){this.$a=new P.a}function c(ka,R){var fa=Q.call(this)||this;fa.type=ka;fa.xTj=R;return fa}function d(ka){var R=C.call(this)||this;R.Y_c=ka;return R}function e(ka,R){var fa=M.call(this)||this;fa.AZj=ka;fa.n_j=R;return fa}function k(ka,R,fa){var ca=K.call(this)||this;
ca.type=ka;ca.presence=R;ca.aoa=fa;return ca}function l(ka,R){var fa=H.call(this)||this;fa.MZj=ka;fa.errorMessage=R;return fa}function n(ka){var R=J.call(this)||this;R.hubConnection=ka;return R}function f(ka,R,fa,ca,ea,wa){var X=U.call(this)||this;X.lfb=ka;X.p1c=R;X.S0g=fa;X.vQe=ea;X.C_c=ca;X.stopwatch=wa;return X}function v(ka){var R=O.call(this)||this;R.Q_j=ka;return R}function r(ka,R){R=void 0===R?null:R;var fa=T.call(this)||this;fa.UB=ka;fa.Hxg=R;return fa}function y(ka,R){var fa=F.call(this)||
this;fa.type=ka;fa.yO=R;return fa}function m(ka){var R=I.call(this)||this;R.Y_c=ka;return R}function w(ka){var R=D.call(this)||this;R.presence=ka;return R}function B(ka,R){var fa=x.call(this)||this;fa.jYg=ka;fa.aoa=R;return fa}function A(ka,R){var fa=z.call(this)||this;fa.newState=ka;fa.oldState=R;return fa}u=b(0);var z=Sys.EventArgs;Rk(A,z);Object(u.a)(A,"ChangedConnectionStateEventArgs",Sys.EventArgs,[]);var x=Sys.EventArgs;Rk(B,x);Object(u.a)(B,"ClientInfoEventArgs",Sys.EventArgs,[]);var D=Sys.EventArgs;
Rk(w,D);Object(u.a)(w,"MyPresenceUpdatedEventArgs",Sys.EventArgs,[]);var I=Sys.EventArgs;Rk(m,I);Object(u.a)(m,"PersistentStateClearedEventArgs",Sys.EventArgs,[]);var F=Sys.EventArgs;Rk(y,F);Object(u.a)(y,"PersistentStateUpdateEventArgs",Sys.EventArgs,[]);var G=b(1523),T=Sys.EventArgs;Rk(r,T);Mf.Object.defineProperties(r.prototype,{type:{configurable:!0,enumerable:!0,get:function(){return this.UB}},T7:{configurable:!0,enumerable:!0,get:function(){return this.Hxg}}});Object(u.a)(r,"UpdateNotificationEventArgs",
Sys.EventArgs,[]);var O=Sys.EventArgs;Rk(v,O);Object(u.a)(v,"GotCompletePersistentStateWithMetadataEventArgs",Sys.EventArgs,[]);var U=Sys.EventArgs;Rk(f,U);Object(u.a)(f,"RefreshAllPersistentStateEventArgs",Sys.EventArgs,[]);var J=Sys.EventArgs;Rk(n,J);Object(u.a)(n,"RefreshProxyEventArgs",Sys.EventArgs,[]);var H=Sys.EventArgs;Rk(l,H);Object(u.a)(l,"RtcConnectFailedEventArgs",Sys.EventArgs,[]);var K=Sys.EventArgs;Rk(k,K);Object(u.a)(k,"SendPersistentStateEventArgs",Sys.EventArgs,[]);var N=b(1190),
M=Sys.EventArgs;Rk(e,M);Object(u.a)(e,"SessionPropertiesChangedEventArgs",Sys.EventArgs,[]);var C=Sys.EventArgs;Rk(d,C);Object(u.a)(d,"UpdatePersistentStateClearedRequestEventArgs",Sys.EventArgs,[]);var Q=Sys.EventArgs;Rk(c,Q);Object(u.a)(c,"UpdatePersistentStateRequestEventArgs",Sys.EventArgs,[]);var P=b(97);b.d(E,"a",function(){return a});a.prototype.D2i=function(ka,R){this.$a.raiseEvent("CSC",new A(ka,R))};a.prototype.r3i=function(ka){this.$a.raiseEvent("RP",new n(ka))};a.prototype.Bqc=function(ka){this.$a.raiseEvent("RC",
ka)};a.prototype.t3i=function(){this.$a.raiseEvent("RMID")};a.prototype.q3i=function(ka,R,fa,ca,ea,wa){this.$a.raiseEvent("RPS",new f(ka,R,fa,ca,ea,wa))};a.prototype.oKf=function(ka,R){this.$a.raiseEvent("UPSR",new c(ka,R))};a.prototype.ZJf=function(ka,R){this.$a.raiseEvent("PU",new G.a(ka,R))};a.prototype.f3i=function(ka){this.$a.raiseEvent("MPU",new w(ka))};a.prototype.qFd=function(ka,R,fa,ca){this.$a.raiseEvent("SUN",new N.a(ka,R,fa,ca))};a.prototype.H3i=function(ka,R){this.$a.raiseEvent("UNR",
new r(ka,R))};a.prototype.gKf=function(ka,R,fa){this.$a.raiseEvent("SP",new k(ka,R,fa))};a.prototype.n3i=function(ka,R){this.$a.raiseEvent("PSU",new y(ka,R))};a.prototype.m3i=function(ka){this.$a.raiseEvent("PSC",new m(ka))};a.prototype.a3i=function(ka){this.$a.raiseEvent("IPSC",new m(ka))};a.prototype.I3i=function(ka){this.$a.raiseEvent("UPSC",new d(ka))};a.prototype.x3i=function(ka,R){this.$a.raiseEvent("SPC",new e(ka,R))};a.prototype.dKf=function(ka,R){this.$a.raiseEvent("RCF",new l(ka,R))};a.prototype.V2i=
function(ka){this.$a.raiseEvent("CPSWM",new v(ka))};a.prototype.G3i=function(ka,R){this.$a.raiseEvent("UCI",new B(ka,R))};a.prototype.Dga=function(ka){this.$a.addHandler("CSC",ka)};a.prototype.Gma=function(ka){this.$a.removeHandler("CSC",ka)};a.prototype.dGg=function(ka){this.$a.addHandler("RP",ka)};a.prototype.cGg=function(ka){this.$a.addHandler("RC",ka)};a.prototype.hGg=function(ka){this.$a.addHandler("RMID",ka)};a.prototype.bGg=function(ka){this.$a.addHandler("RPS",ka)};a.prototype.SGg=function(ka){this.$a.addHandler("UPSR",
ka)};a.prototype.CFa=function(ka){this.$a.addHandler("PU",ka)};a.prototype.Cza=function(ka){this.$a.removeHandler("PU",ka)};a.prototype.OEg=function(ka){this.$a.addHandler("IPU",ka)};a.prototype.QGg=function(ka){this.$a.addHandler("UCI",ka)};a.prototype.uGg=function(ka){this.$a.addHandler("SUN",ka)};a.prototype.PEg=function(ka){this.$a.addHandler("IUNR",ka)};a.prototype.tYa=function(ka){this.$a.addHandler("UNR",ka)};a.prototype.lIb=function(ka){this.$a.removeHandler("UNR",ka)};a.prototype.NEg=function(ka){this.$a.addHandler("IPSU",
ka)};a.prototype.MEg=function(ka){this.$a.addHandler("IPSC",ka)};a.prototype.RGg=function(ka){this.$a.addHandler("UPSC",ka)};a.prototype.tGg=function(ka){this.$a.addHandler("SP",ka)};a.prototype.wGg=function(ka){this.$a.addHandler("SPC",ka)};a.getInstance=function(){return a.Ma||(a.Ma=new a)};a.Ma=null;Object(u.a)(a,"RtcEventHub",null,[117])},1386:function(u,E,b){function a(H,K,N,M,C,Q,P,ka,R,fa,ca,ea,wa){var X=this;wa=void 0===wa?null:wa;this.C9d=(new Date(0)).getTime();this.J$d=0;this.ZTb=!1;this.ffe=
null;this.DGd=36E5;this.UUa=a.k9e;this.Thb=0;this.hQa=null;this.sda=0;this.Hbb=this.pAe=null;this.wug=[f.Czb,f.errorMessage,f.G3f,f.gC,f.H6,f.k3e,f.l8a,f.cBa,f.r8a];this.vug=[f.Czb,f.errorMessage];this.gC=this.d8a=null;this.v5d=new k(ca?ca:function(){return w.AFrameworkApplication.Yi},C,Q,P,H,K);this.Egb=ea;this.ph=M;this.Og=K;this.Xng=N;this.Rl=ka;this.Yg=R;this.cib=wa;this.w5d=!1;this.z9b=9E4;fa&&fa.execute(function(ja){ja.qZb(function(){v.ULS.sendTraceTag(40768456,500,50,"Connection parameters refresh requested for client [{0}]",
X.Rl);X.v5d.JMf()})});2>=100*Math.random()&&(this.DGd=3E5);G.a.instance&&(G.a.instance.gUe=this.DGd)}function c(){}function d(){}function e(){}function k(H,K,N,M,C,Q){this.rEa=null;var P=b(1386).FindSessionStrategy;this.Ptg=H;H=String.format("{0}={1}",l.clientId,I.a.$e(M));H=String.format("{0}&{1}={2}",H,l.userSessionId,I.a.$e(C));H=String.format("{0}&{1}={2}",H,l.STj,I.a.$e(N.toString()));H=String.format("{0}&{1}={2}",H,l.userType,I.a.$e("1"));H=String.format("{0}&{1}={2}",H,l.lUj,I.a.$e(K));H=String.format("{0}&{1}={2}",
H,l.nYg,I.a.$e(P.lYg));(K=k.WHh(N,Q))&&(H=String.format("{0}&{1}",H,K));this.amg=H}function l(){}function n(){this.l3e=this.iof=this.jof=this.oof=0;this.zhc=!1;this.correlationId=this.gC=this.H6=this.q1c=this.errorMessage=null}function f(){}b.r(E);u=b(0);var v=b(14),r=b(84),y=b(202),m=b(1189);f.r8a="throttling_messageDelay";f.Czb="enabled";f.cBa="throttling_timeToWaitForResponse";f.l8a="throttling_maxNumberOfOutstandingMessages";f.k3e="throttling_globalMaxNumberOfOutstandingMessages";f.errorMessage=
"errorMessage";f.G3f="url";f.H6="queryString";f.gC="connectionString";Object(u.a)(f,"RtcFindSessionOutputFieldNameConstants",null,[]);var w=b(4),B=b(81),A=b(39),z=b(496),x=b(897),D=b(113),I=b(29),F=b(178);Mf.Object.defineProperties(n.prototype,{W_g:{configurable:!0,enumerable:!0,get:function(){return this.q1c+"?"+this.H6}}});Object(u.a)(n,"FindSessionResponse",null,[]);l.clientId="ClientId";l.STj="UserApp";l.userSessionId="usid";l.userType="UserType";l.lUj="UserVersion";l.rqc="qs";l.nYg="clientProtocol";
l.NCi="NoAuth";Object(u.a)(l,"RtcFindSessionInputQueryParamConstants",null,[]);k.prototype.JMf=function(){this.rEa=this.Ptg()};k.prototype.obd=function(){this.rEa&&""!==this.rEa||(this.JMf(),v.ULS.sendTraceTag(575784194,500,this.rEa&&""!==this.rEa?50:15,"Query signature delegate called for refresh returned: {0} ",this.rEa));var H=String.format("{0}={1}",l.rqc,I.a.$e(this.rEa));return String.format("{0}&{1}",H,this.amg)};k.WHh=function(H,K){return 4===H?String.format("{0}={1}",l.NCi,"1"):K?K.KZh():
null};Object(u.a)(k,"FindSessionQueryStringGenerator",null,[]);var G=b(1148),T=b(1085),O=b(932),U=b(1192);e.rAh="FSType";Object(u.a)(e,"RtcFindSessionRequestHeaders",null,[]);d.c5i="polling";Object(u.a)(d,"RtcFindSessionTypes",null,[]);var J=b(1191);c.ZUj="RTC-TokenProofkey";c.goi="RTC-IsWacJsBootFsRequest";Object(u.a)(c,"RtcRequestHeaders",null,[]);b.d(E,"FindSessionStrategy",function(){return a});a.prototype.Trj=function(H){this.Hbb=H};a.prototype.init=function(){this.Yg.hGg(Object(r.a)(this,this.lfj,
"resetGetMachineIdDelay"));this.Yg.Dga(Object(r.a)(this,this.MV,"onConnectionStateChanged"))};a.prototype.MV=function(H,K){this.sda=K.newState;2===K.newState&&(this.Thb=0)};a.prototype.$Xe=function(){var H=this.hQa.correlationId;return{returnValue:String.format("{0}&{1}={2}",this.hQa.H6,a.vBe,I.a.$e(H)),correlationId:H}};a.prototype.KVh=function(H,K,N,M,C){var Q=this;this.Zlj(function(){M(C,"GetMachineIdSuccess")&&(v.ULS.sendTraceTag(17956951,500,50,"Successfully retrieved Rtc MachineId [{0}] for [{1}]",
Q.gC,Q.Rl),H(Q.ffe),N(Q.yYh()))},function(P){M(C,"GetMachineIdFailure")&&(v.ULS.sendTraceTag(4060129,500,15,"Failed to retrieve Rtc MachineId for [{0}]",Q.Rl),K(P))},M,C)};a.prototype.agh=function(){this.Mxe();this.W7h()};a.prototype.Zlj=function(H,K,N,M){var C=this;v.ULS.sendTraceTag(17956952,500,50,"Retrieving Rtc MachineId from server. Getting from last findsession, connectionString is [{0}]",this.gC);if(this.gC)H();else{var Q=this.$Sg();window.setTimeout(function(){C.sendFindSessionRequestToServerInternal(H,
K,N,M)},Q)}};a.prototype.sendFindSessionRequestToServerInternal=function(H,K,N,M){var C=this;N(M,"RequestMachineId")&&(this.C9d=(new Date).getTime(),N=A.a.me(),this.aYe(function(Q){var P=A.a.me();C.REf(Q);C.aOd();H();Q=A.a.me()-P;v.ULS.sendTraceTag(577356039,345,50,"SFSRTS Success - TimeElapsed: {0}",Q)},function(Q){var P=A.a.me();C.Mxe();G.a.instance&&G.a.instance.Kx(2,3);K(Q);Q=A.a.me()-P;v.ULS.sendTraceTag(577356040,345,50,"SFSRTS Failure - TimeElapsed: {0}",Q)},!1),N=A.a.me()-N,v.ULS.sendTraceTag(577599296,
345,50,"SFSRTS - TimeElapsed: {0}",N))};a.prototype.W7h=function(){this.UUa+=a.bRh;this.UUa=Math.min(this.UUa,a.Byi)};a.prototype.$Sg=function(){var H=(new Date).getTime();H=this.C9d+this.UUa-H;0>H&&(H=0);return H};a.prototype.REf=function(H){try{this.hQa=H,this.d8a=H.W_g,this.gC=H.gC,this.pAe=H.H6,this.ffe=H.q1c}catch(K){v.ULS.sendTraceTag(17956953,500,10,"FindSession response contains invalid fields. Exception {0}, is thrown",K.toString())}};a.prototype.Mxe=function(){this.gC=null;this.Nxe()};a.prototype.aOd=
function(){this.Nxe();this.ZTb=!0;this.J$d=window.setTimeout(Object(r.a)(this,this.F6i,"refreshMachineId"),this.DGd)};a.prototype.Nxe=function(){this.ZTb&&(window.clearTimeout(this.J$d),this.ZTb=!1)};a.prototype.F6i=function(){var H=this;this.ZTb=!1;this.aYe(function(K){var N=H.pAe!==K.H6,M=H.gC!==K.gC,C=H.gC;H.REf(K);0!==H.sda&&(M?(v.ULS.sendTraceTag(17956955,500,15,"Recycling RTC connection due to RTC machine id change. old={0}, new={1}",C||"null",K.gC),H.Yg.Bqc()):(H.Yg.x3i(N,M),H.aOd()))},function(){G.a.instance&&
G.a.instance.Kx(2,3);H.aOd()},!0)};a.prototype.lfj=function(){this.UUa=a.k9e};a.prototype.yYh=function(){return new U.a(this.hQa.oof,this.hQa.jof,this.hQa.iof,this.hQa.l3e)};a.prototype.dLj=function(H){if(Object.getType(H)!==Object)return null;for(var K in H);return this.S5g(H)};a.prototype.S5g=function(H){if(!(f.Czb in H))return null;for(var K=H[f.Czb],N=bk(K?this.wug:this.vug),M=N.next();!M.done;M=N.next())if(!(M.value in H))return null;N=Object.assign(new n,{zhc:H[f.Czb],errorMessage:H[f.errorMessage],
correlationId:F.a.create().toString()});K&&(N.q1c=H[f.G3f],N.H6=H[f.H6],N.gC=H[f.gC],N.l3e=H[f.k3e],N.iof=H[f.l8a],N.jof=H[f.cBa],N.oof=H[f.r8a]);return N};a.prototype.ONh=function(H,K){var N=this;v.ULS.sendTraceTag(50448152,500,50,"Using FindSessionUtils find session response");this.cib.pAh.continueWith(function(){N.cib.pAh.result?(v.ULS.sendTraceTag(50448153,500,50,"FindSessionUtils find Session resulted in success"),H(N.cib.qAh)):(v.ULS.sendTraceTag(50448154,500,15,"FindSessionUtils find Session resulted in error"),
K(N.cib.qAh))})};a.prototype.KRf=function(H,K,N,M,C){var Q=this;C=void 0===C?!1:C;return function(P){T.a.instance.fHb(0,1);H&&H.stop();Q.Hbb=null;Q.Egb=null;Q.ulf(P.data,!0,K);var ka=O.RtcUtils.deserialize(P.data.Td,"FindSession",null);if(ka)if(ka=Q.dLj(ka)){if(ka.zhc&&ka.H6&&ka.gC){v.ULS.sendTraceTag(4317446,500,50,"Successfully retrieved MachineId from server for [{0}]",Q.Rl);Q.Oti(P.data);N(ka);return}K.FindSessionFailureReason="FindSessionInvalidResponse";K.IsRtcEnabled=ka.zhc;K.IsQueryStringEmpty=
!ka.H6;K.IsConnectionStringEmpty=!ka.gC;v.ULS.sendTraceTag(4290720,500,15,"Response did not contain valid MachineId [ConnectionUrl and/or QueryString] for [{0}]; IsRtcEnabled:{1}; IsQueryStringEmpty:{2}; IsConnectionStringEmpty:{3}",Q.Rl,ka.zhc,!ka.H6,!ka.gC)}else K.FindSessionFailureReason="FindSessionTranslateServerResponseFailed",v.ULS.sendTraceTag(8745097,500,15,"Could not translate server response to findSession response for [{0}]",Q.Rl);else K.FindSessionFailureReason="FindSessionDeserializeServerResponseFailed",
v.ULS.sendTraceTag(7372827,500,10,"Could not deserialize response data for [{0}]",Q.Rl);Q.eKf(K,C);M(null)}};a.prototype.DRf=function(H,K,N,M){var C=this;M=void 0===M?!1:M;return function(Q){T.a.instance.fHb(0,1);H&&H.stop();C.Hbb=null;C.Egb=null;C.ulf(Q.data,!1,K);var P=null,ka="unknown",R="unknown";Q.data&&((ka=Q.data.responseHeaders)&&a.dJb in ka&&(P=ka[a.dJb].toString()),ka=x.a[Q.data.status],R=Q.data.httpStatus.toString());K.FindSessionFailureReason="FindSessionRequestFailed";K.HttpErrorCode=
R;K.HttpErrorStatus=ka;K[a.dJb]=P;v.ULS.sendTraceTag(4290721,500,15,"Request for MachineId failed with Status='{0}'; HttpStatus='{1}' for [{2}]; RtcErrorCode='{3}'. Polling: '{4}' '",ka,R,C.Rl,P,M);C.eKf(K,M);N(R)}};a.prototype.aYe=function(H,K,N){var M=this;N=void 0===N?!1:N;var C=null;v.ULS.sendTraceTag(4317445,500,50,"Getting MachineId from server for [{0}]",this.Rl);var Q={},P=this.v5d.obd();Q[z.a.GY]=F.a.create().toString();this.Hbb&&""!==this.Hbb?P=String.format("{0}&{1}={2}",P,J.a.kLd,this.Hbb):
this.Egb&&""!==this.Egb&&(P=String.format("{0}&{1}={2}",P,J.a.kLd,this.Egb),Q[c.ZUj]="True",Q[c.goi]="True");P=this.Xng+"?"+P;N&&(Q[e.rAh]=d.c5i);var ka={};ka.IsNetworkOfflineBeforeSendRequest=this.Og.k6a;ka.HasAvailableConnectionsBeforeSendRequest=this.Og.q5e;ka.MaxConnectionsAllowed=this.Og.wkc;ka.IsRefreshMachineId=N;this.cib&&!this.w5d?(this.ONh(this.KRf(null,ka,H,K,N),this.DRf(null,ka,K,N)),this.w5d=!0):(this.ph&&(C=this.ph.sc("WebServiceCall","GetMachineIdFromTheServer")),G.a.instance&&G.a.instance.Kx(2,
0),0>this.Og.A9(P,1,null,Q,[a.P3b,a.dJb,a.zDb,a.jLd,a.Npf,a.Yrf,a.Xrf],!1,1,this.KRf(C,ka,H,K,N),this.DRf(C,ka,K,N),null,null,!1,null,this.z9b,"3",null,!0)&&(5<this.Thb&&200>this.Thb&&v.ULS.sendTraceTag(578166985,500,15,"FindSession request not scheduled due to expired token. Manually triggered failure callback {0} times.",this.Thb),window.setTimeout(function(){M.Thb++;K("-1")},1E3)))};a.prototype.ulf=function(H,K,N){N||(N={});N.IsNetworkOfflineAfterRequestComplete=this.Og.k6a;N.IsRequestSucceeded=
K;H&&(N.EnqueueTime=H.E7b,N.InvokedTime=H.XE,N.CompletedTime=H.Z2,H.responseHeaders&&(a.P3b in H.responseHeaders&&(N.CorrelationId=H.responseHeaders[a.P3b]),a.zDb in H.responseHeaders&&(N[a.zDb]=H.responseHeaders[a.zDb])));v.ULS.sendTraceTag(38633565,500,K?50:15,O.RtcUtils.Q8a(N))};a.prototype.eKf=function(H,K){H||(H={});H.ConnectionState=m.a[this.sda];K||this.Yg.dKf(1,H)};a.prototype.Oti=function(H){try{var K=!1,N=!1,M=H.responseHeaders,C=B.a.yM(H.request.get_url());if(M&&a.jLd in M){var Q=M[a.jLd].toString().toLocaleLowerCase();
N="true"===Q;K="false"===Q}M=!1;var P=0<=C.toLocaleLowerCase().indexOf("collab");N&&!P?M=!0:K&&P&&(M=!0);if(M){K={HostName:C};K.Status=x.a[H.status];K.HttpStatus=H.httpStatus.toString();var ka=H.request.get_headers(),R;for(R in ka){var fa=ka[R];(N=R)&&0<N.length&&(C=0,fa&&(C=fa.toString().length),K["r_"+N]=C)}if(H.responseHeaders){var ca=new y.a;ca.add(a.P3b);ca.add(a.zDb);ca.add(a.dJb);ca.add(a.Yrf);ca.add(a.Xrf);ca.add(a.Npf);a.$Bg(K,H.responseHeaders,ca)}a.OBg(H.request.get_url(),K);var ea=D.a.toJSON(K);
v.ULS.sendTraceTag(559437006,500,15,ea)}}catch(wa){v.ULS.sendTraceTag(559437007,500,10,"DomainLandingIncorretDC exception[{0}]",wa.toString())}};a.createInstance=function(H,K,N,M,C,Q,P,ka,R,fa,ca,ea){return a.L6g(H,K,N,M,C,Q,P,ka,R,fa,ca,void 0===ea?null:ea)};a.L6g=function(H,K,N,M,C,Q,P,ka,R,fa,ca,ea){ea=void 0===ea?null:ea;H=H||F.a.create().toString();H=new a(H,K,N,M,C,Q,P,ka,R,fa,null,ca,ea);H.init();return H};a.$Bg=function(H,K,N){N=bk(N);for(var M=N.next();!M.done;M=N.next())M=M.value,M in K&&
(H[M]=K[M])};a.OBg=function(H,K){if(H){var N=H.indexOf("?");if(-1!==N)for(H=H.substr(N+1).split("&"),N=0;N<H.length;++N){var M=H[N].split("=");if(2===M.length){var C=M[0];if(C&&0<C.length){var Q=0;if(M=M[1])Q=M.length;K["q_"+C]=Q}}}}};a.bRh=3E3;a.Byi=3E5;a.lYg="1.0";a.k9e=1E3;a.P3b="X-CorrelationId";a.vBe="corrid";a.dJb="RtcErrorCode";a.zDb="X-OfficeCluster";a.jLd="X-NewEnv";a.Npf="X-MSEdge-Ref";a.Xrf="X-OFFICEFD";a.Yrf="X-OfficeFE";Object(u.a)(a,"FindSessionStrategy",null,[78])},1522:function(u,
E,b){function a(){this.ebe=this.fbe=this.gbe=this.cbe=this.bbe=this.dbe=this.Yjb=this.iNc=0;this.wSb=this.ILc=this.jjb=this.BLc=this.CLc=this.sLc=this.gqa=this.gjb=this.aWa=this.rLc=this.uSb=this.qVa=null;this.rMc=this.Ejb=this.dfe=this.n2d=0;this.hae=!1;this.TLf=this.jGd;this.WLf=this.mGd;this.VLf=this.lGd;this.$Lf=this.oGd;this.ZLf=this.nGd;this.uGd=this.vGd;this.rGd=this.sGd;this.DPa=this.pGd;this.gHb=this.qGd;this.ULf=this.kGd;this.aDb=this.Fwd;this.qlc=this.Gwd}b.r(E);b.d(E,"RealtimeChannelMetrics",
function(){return a});u=b(0);var c=b(14),d=b(246),e=b(113),k=b(932);a.prototype.jGd=function(){this.iNc++;this.rLc=new Date;this.qVa||(this.qVa=new Date)};a.prototype.mGd=function(){this.Yjb++;this.gqa=new Date;this.uSb||(this.uSb=this.gqa);this.jjb=this.gqa;this.g0g()};a.prototype.lGd=function(){this.dbe++;this.sLc=new Date};a.prototype.oGd=function(){this.bbe++;this.aWa=new Date};a.prototype.nGd=function(){this.cbe++;this.gjb=new Date};a.prototype.sGd=function(){this.CLc=new Date;this.gbe++};a.prototype.qGd=
function(){this.wSb||(this.wSb=new Date);this.fbe++};a.prototype.pGd=function(){this.BLc=new Date;this.ebe++};a.prototype.vGd=function(){!this.hae&&this.iNc&&(c.ULS.sendTraceTag(39321871,500,15,e.a.toJSON(this.qZg())),this.hae=!0)};a.prototype.kGd=function(l){var n=k.RtcUtils.vxh(l);l=n.Q7e;var f=n.S7e;n=n.exception;if(l&&l!==d.a.JO){var v={};c.ULS.sendTraceTag(40157596,500,15,e.a.toJSON((v.HttpErrorCode=l,v.HttpErrorStatus=f,v.Exception=n,v)));d.a.Paf(l)&&this.n2d++;d.a.Hff(l)&&this.dfe++}};a.prototype.Fwd=
function(){this.ILc=new Date};a.prototype.Gwd=function(){this.aWa=this.jjb=new Date};a.prototype.qZg=function(){var l={};return l.numberOfConnectionAttempts=this.iNc,l.numberOfSuccessfulConnections=this.Yjb,l.numberOfFailedConnections=this.dbe,l.numberOfDisconnectedConnections=this.bbe,l.numberOfExplicitDisconnectedConnections=this.cbe,l.numberOfSentMessages=this.gbe,l.numberOfReceivedMessages=this.fbe,l.numberOfLostMessages=this.ebe,l.firstConnectionAttempt=this.qVa?this.qVa:null,l.firstMessageReceived=
this.wSb?this.wSb:null,l.firstConnectionSuccess=this.uSb?this.uSb:null,l.lastConnectionAttempt=this.rLc?this.rLc:null,l.lastConnectionSuccess=this.gqa?this.gqa:null,l.lastConnectionFailure=this.sLc?this.sLc:null,l.lastMessageSent=this.CLc?this.CLc:null,l.lastMessageLost=this.BLc?this.BLc:null,l.lastDisconnect=this.aWa?this.aWa:null,l.lastExplicitDisconnect=this.gjb?this.gjb:null,l.lastTimeOnline=this.jjb?this.jjb:null,l.lastTimeOffline=this.ILc?this.ILc:null,l.maxDisconnectedTimeMs=this.Ejb,l.maxExplicitDisconnectedTimeMs=
this.rMc,l.clientConnectionErrors=this.n2d,l.serverConnectionErrors=this.dfe,l};a.prototype.g0g=function(){this.qVa&&1===this.Yjb&&(this.Ejb=Math.max(this.Ejb,this.gqa.getTime()-this.qVa.getTime()));this.aWa&&1<this.Yjb&&(this.Ejb=Math.max(this.Ejb,this.gqa.getTime()-this.aWa.getTime()));this.gjb&&1<this.Yjb&&(this.rMc=Math.max(this.rMc,this.gqa.getTime()-this.gjb.getTime()))};a.createInstance=function(l){a.Ma||(a.Ma=new a,c.ULS.sendTraceTag(39321870,500,50,"RealtimeChannelMetrics initialized for client {0}",
l));return a.Ma};a.Ma=null;Object(u.a)(a,"RealtimeChannelMetrics",null,[79,80])},1523:function(u,E,b){function a(d,e){var k=c.call(this)||this;k.yO=d;k.p3=e;return k}b.d(E,"a",function(){return a});u=b(0);var c=Sys.EventArgs;Rk(a,c);Object(u.a)(a,"PresenceUpdatedEventArgs",Sys.EventArgs,[])},1631:function(u,E,b){function a(Ya){this.$=Ya}function c(Ya,h,lb,Ub,zc){var vc=$e.call(this)||this;vc.rj=null;vc.jxd=!1;vc.fjd=null;vc.currentUserId=null;vc.I9d=null;vc.oAd=function(ud,Gd){if(Gd.yO){ud=Gd.yO;
for(var od in ud)(ud=od)&&ud!==vc.currentUserId&&!vc.v_a.has(ud)&&vc.wbc(ud).PRj()}};vc.VH=function(){vc.bMf()};vc.wca=function(ud,Gd){vc.jxd=!0;var od=Object(vb.a)(Object,Gd.T7);if(1===Gd.type)if(ud=Za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EditorsTableNotification",!1),null===od||void 0===od?0:od[Rc.a.y6h]){if(!ud||!Object(vb.a)(String,od[Rc.a.x7e]))return;ud=vc.TAe(Object(vb.a)(String,od[Rc.a.x7e]));Object(vb.a)(String,od[Rc.a.y7e])===Rc.a.w6h?(ud=[ud],ud[0]===vc.currentUserId||
vc.v_a.has(ud[0])||vc.wbc(ud[0]).MRj(),vc.kQd(ud)&&vc.oTa(ud,null)):Object(vb.a)(String,od[Rc.a.y7e])===Rc.a.x6h&&ud!==vc.currentUserId&&vc.oTa(null,null)}else{Gd=Array.isArray(Gd.T7)?Gd.T7:null;!Gd&&od&&(Gd=Array.isArray(od[Rc.a.$Ie])?od[Rc.a.$Ie]:null);if(Gd&&ud)for(var Ae=bk(Gd),Ne=Ae.next();!Ne.done;Ne=Ae.next())Ne=Ne.value,Ne===vc.currentUserId||vc.v_a.has(Ne)||vc.wbc(Ne).ORj();Za.EwaSettings.isChangeGateEnabled("OfficeVSO:5930962_ProcessPeerNotificationAsFallback")?Gd&&!vc.kQd(Gd)||vc.oTa(Gd,
null):Gd&&(ud||!vc.kQd(Gd))||vc.oTa(Gd,null);return}if(od)if(0===Gd.type){var gf;(function(){var hd=vc.Pnb(od);gf=hd.KLf;return hd})().returnValue?(vc.mya(od),Rc.a.Ue in od&&(vc.$.ea.gX(od[Rc.a.Ue],"ContentRefreshManager.OnUpdateNotificationReceived"),vc.qbg())):Yb.ULS.sendTraceTag(22905367,0,50,"RTC ContentUpdate session identifier mismatch. Received: {0}. Expected: {1}. Ignoring this update.",gf,vc.$.ea.i7)}else{if(3===Gd.type){if(!(Rc.a.CTf in od)){Yb.ULS.sendTraceTag(537154117,13,10,"RTC WetContentUpdate does not specify a type. Ignoring this update.");
return}Gd=od[Rc.a.CTf];Gd===Rc.a.gij?vc.k3h(od):Gd!==Rc.a.eij&&Gd!==Rc.a.iij&&Gd!==Rc.a.jij&&Gd!==Rc.a.hij&&Gd!==Rc.a.fij&&Yb.ULS.sendTraceTag(537154081,13,50,"RTC WetContentUpdate of unknown type {0}. Ignoring this update.",Gd);return}if(4===Gd.type){ud=!1;Rc.a.zFf in od&&(ud=od[Rc.a.zFf]);if(vc.Pnb(od).returnValue)return;vc.$.ea.jfi()&&vc.j_c();if(vc.$.ea.X6a&&ud)return;Ae=od[Rc.a.mXi];vc.$.ea.dc&&Ae&&vc.lXi.vFf(new e(Ae,ud,vc.Ptf))}else if(8===Gd.type){if(vc.u$i)return;var Ja=0,Lb=od[Rc.a.cij],
mc=od[Rc.a.aij],xc=od[Rc.a.bij];Rc.a.DTf in od&&(Ja=od[Rc.a.DTf]);vc.$.ea.dc&&Lb&&(ud=Object(Rb.a)(new n,{OcsSessionId:Lb,ClientId:mc&&Za.EwaSettings.isChangeGateEnabled("OfficeVSO:5544917_HookUpRevisionTrackerOnXLO")?mc:"",SeqNum:xc,XrevidSaved:Ja}),Ae=Array(1),Ae[0]=ud,B(vc.$.oa.xa,Ae,vc.Ptf,function(){Yb.ULS.sendTraceTag(537154080,0,10,"BatchCheckCollabServiceContent failed. OcsSessionId: {0}, ClientId: {1}, SeqNum: {2}, XrevidSaved: {3}",Lb,mc,xc,Ja)},null,null))}}2===Gd.type?od&&vc.Pnb(od).returnValue||
(Yb.ULS.sendTraceTag(537154079,0,50,"RTC : FileNameUpdate received. Now invoking CheckWorkbookFileNameUpdate web method"),w(vc.$.oa.xa,null,null,null,null)):12!==Gd.type||od&&vc.Pnb(od).returnValue||vc.raiseEvent("LabelUpdateEventKey")};vc.Ptf=function(ud){var Gd=ud.Errors;wb.a.Uq(Gd)?(Gd=wb.a.xF(Gd,[1552731907],"ContentRefreshManager"),wb.a.Oga(Gd)||vc.$.ea.fp(Gd)):(Gd=ud.StateId+1,ud.Result&&vc.$.ea.Ue<Gd&&vc.$.ea.gX(Rc.a.Ee,"ContentRefreshManager.OnCheckForUpdateSuccess"))};vc.di=function(){vc.Xhj&&
vc.jxd&&vc.$.ea.o7b&&vc.qbg()};vc.wuf=function(){vc.jxd=!1;vc.$.ea.hna=500;vc.I9d=Qd.a.Ta.Jb};vc.$Db=function(ud,Gd){vc.DSd(Gd.rj)};vc.$=Ya;vc.kn=h;vc.$.oa.Sq(vc.di);vc.kn.ZYb(vc.$Db);vc.kn.Yle(vc.wuf);vc.zZj=lb;vc.lXi=Ub;vc.jSj=zc;vc.UKa={};vc.v_a=new Set;vc.kn.q_a();Za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EditorsTableNotification",!1)&&(vc.currentUserId=vc.$.workbookContext.ClientId,vc.bMf(),vc.$.ea.Fga(vc.VH));vc.u$i=Za.EwaSettings.isChangeGateEnabled("OfficeVSO:6195367_RemoveWebRequestsForCollabServiceContentUpdates");
return vc}function d(Ya,h,lb){this.GFc={};this.HFc={};this.kt=lb;this.q_b(Ya,this.GFc);this.q_b(h,this.HFc)}function e(Ya,h,lb){this.Lah=Ya;this.hmc=h;this.kt=lb}function k(Ya,h,lb,Ub){this.RBc=this.Opc=this.epc=this.Rdc=0;this.p8d=this.haf=!1;this.clientId=Ya;this.oah=h;this.$=Ub;this.Xvi=Wd.a.me()+lb}function l(Ya,h,lb,Ub,zc){var vc=me.call(this)||this;vc.Ai=Ya;vc.Pmj=h;vc.Omj=lb;vc.i7=Ub;vc.RZg=zc;return vc}function n(){}function f(Ya){var h=Ke.call(this)||this;h.Ge=null;h.mergeSuspensionManager=
null;h.Iwa=!1;h.kCd=null;h.Bd=!1;h.yyc=!1;h.wyc=!1;h.xyc=!1;h.$Eb=function(lb,Ub){h.Iwa!==Ub.Iwa&&(h.Iwa=Ub.Iwa,h.kCd=h.Iwa?null:Qd.a.Ta.Jb)};h.Yc=function(){h.$.Tu&&h.AFj()};h.Uc=function(lb,Ub){Ub.dc||h.Yq(lb,Ub)};h.Yq=function(){if(0<h.Mza.length||0<h.Pda.count)Yb.ULS.sendTraceTag(537154128,13,15,"Dropping {0} revisionGeneratedNotifications and {1} stateDownloadedNotifications.",h.Mza.length,h.Pda.count),h.Mza=[],h.Pda=new je.a;h.fob.cancel();h.Xag();h.aXd();h.aPj()};h.nAf=function(lb,Ub){h.yFj();
h.zFj();lb=new r;lb.Xluid=Ub.Ai;lb.NotificationReceivedOn=Qd.a.Ta.Jb.toISOString();lb.CurrentPresenceUserCount=h.$.ea.Bm.length;lb.OurCollabModeIsUsingOcs=h.$.ea.X6a;lb.SenderCollabMode=Ub.Pmj;lb.SenderClientType=Ub.Omj;lb.SessionSiteIdentifier=Ub.i7;lb.CommandTimeInMs=Ub.RZg;Yb.ULS.sendTraceTag(537154127,13,50,"ContentLatencyTracker.OnRemoteRevisionGenerated: RevisionGeneratedNotification: {0}",JSON.stringify(lb));h.Mza.push(lb)};h.xi=function(){h.OBe(h.$.ea.Ue,"OnBlockCacheConsistent")};h.rAf=function(lb,
Ub){(lb=Object(vb.a)(784,Ub.Fe))&&h.OBe(lb.lJ,"OnRenderedContent")};h.DTj=function(){if(!h.$.ea.dc)Yb.ULS.sendTraceTag(537154122,13,15,"ContentLatencyTracker.UploadLatencyTelemetryPeriodically: session isn't active");else if(h.Mza.length||h.Pda.count){var lb=null;0<h.Mza.length&&(lb=h.Mza,h.Mza=[]);var Ub=null;if(0<h.Pda.count){Ub=Array(h.Pda.count);for(var zc=0,vc=bk(h.Pda.values),ud=vc.next();!ud.done;ud=vc.next())ud=ud.value,Ub[zc++]=ud;h.Pda=new je.a}Yb.ULS.sendTraceTag(537154120,13,100,"ContentLatencyTracker.UploadLatencyTelemetryPeriodically: Uploading {0} revisionGeneratedNotifications and {1} stateDownloadedNotifications.",
lb?lb.length:0,Ub?Ub.length:0);zc=h.$.oa.xa;vc=h.lTi;ud=zc.Na(1,null);ud.GenerateNotifications=lb;ud.DownloadNotifications=Ub;uc.g(zc,"UploadLatencyTelemetry",ud,vc,null,null,null,128)}};h.lTi=function(lb){lb.Result&&0<lb.Result&&h.Rud()};h.$=Ya;h.Ea=Ie.g(h.$).Ea;h.viewport=Ie.g(h.$).view;h.contentRefreshManager=h.$.da.za(292);h.sf=h.$.sf;h.Mza=[];h.Pda=new je.a;h.fob=rb.a.instance.nE(h.DTj,3E4,Kd.a.v1g,!1,!1);h.$.Tk(h.Yc);h.$.ea.Vj(h.Uc);h.$.ea.KUc(h.Yq);h.$.da.Za(291,function(lb){h.Ge=lb});h.$.da.Za(343,
function(lb){h.Bd||(h.mergeSuspensionManager=lb,h.mergeSuspensionManager.DZb(h.$Eb),h.mergeSuspensionManager.MGb())});Yb.ULS.sendTraceTag(537154131,13,50,"ContentLatencyTracker initialized");h.Yc(h.$,null);return h}function v(){}function r(){}function y(Ya){this.$=Ya}function m(Ya){this.$=Ya}function w(Ya,h,lb,Ub,zc,vc){vc=Ya.Na(1,void 0===vc?null:vc);return uc.g(Ya,"CheckWorkbookFileNameUpdate",vc,h,lb,Ub,zc,0)}function B(Ya,h,lb,Ub,zc,vc,ud){ud=Ya.Na(1,void 0===ud?null:ud);ud.updateInfo=h;return uc.g(Ya,
"BatchCheckCollabServiceContent",ud,lb,Ub,zc,vc,516)}function A(Ya,h,lb){var Ub=Zd.call(this)||this;Ub.xDd=null;Ub.ePa=null;Ub.IEb=function(zc,vc){if(vc.yO){zc=[];var ud=[],Gd=Ie.g(Ub.$).ha,od=!(2===Gd.Pe||128===Gd.Pe);Gd=od?Pb.k(Gd.sa.selectedRanges,Ub.$):Gd.Oa.Yb.floatingObject;vc=vc.yO;for(var Ae in vc)Ub.presenceView.zGe(Gd,od,zc,ud,Ae);Ae=bk(Ub.JHa);for(vc=Ae.next();!vc.done;vc=Ae.next())vc=vc.value,Array.contains(zc,vc)||Array.contains(ud,vc)||Ub.presenceView.zGe(Gd,od,zc,ud,vc.UserID);Ub.JHa=
[];Array.addRange(Ub.JHa,zc);Array.addRange(Ub.JHa,ud);Ub.xDd&&(Dc.a.Ia(Ub.ePa),Ub.ePa=null,Ub.xDd=null);var Ne=A.Lte(zc,ud);Ub.ePa=new dd.a;Ub.xDd=Mb.TaskExtensions.Aa(Ob.Task.delay(1),function(){Ub.ariaLiveNotifier.mab(Ne,le.a.aZa)},Ub.ePa.token,3)}};Ub.$=h;Ub.ariaLiveNotifier=Ya;Ub.presenceView=lb;Ub.JHa=[];lb.BFa(Ub.IEb);Ub.$.da.Ga(231,Ub);return Ub}function z(Ya){var h=bd.call(this)||this;h.manager=null;h.$=Ya;h.Eb();return h}function x(Ya,h){var lb=md.call(this)||this;lb.rj=null;lb.fieldManagerPane=
null;lb.q_=null;lb.XMb=null;lb.j8f=null;lb.messageId=0;lb.JWf=!1;lb.ap=function(){lb.$&&lb.CMd(0,!1)};lb.Dh=function(){lb.uUd?lb.XMb(!1):(lb.kc.PresenceType=1,lb.raiseEvent(x.p0),lb.sendPresenceToService(!1))};lb.Af=function(){lb.uUd?lb.j8f(!1):(lb.Wbb(!1),lb.zMd())};lb.Hmc=function(){lb.ha.Oa.Yb?lb.CMd(1,!1):lb.KMd(0,!1)};lb.Ula=function(Ub,zc){lb.raiseEvent(x.vDd,zc)};lb.Rc=function(){lb.KMd(Ie.g(lb.$).isEditing?1:0,!1)};lb.Uc=function(Ub,zc){De.a(zc)&&(lb.Jqa={})};lb.AEb=function(){lb.rWf()};lb.oDf=
function(Ub,zc){if(zc&&zc.methodName in x.npc){Ub=!1;switch(x.npc[zc.methodName]){case 0:zc=zc.parameters.cell;break;case 1:zc=zc.parameters.parameters.Location;break;case 2:zc=Pb.v(lb.ha.sa.activeRange,lb.$);Ub=!0;break;default:return}zc.LastColumn=zc.FirstColumn;zc.LastRow=zc.FirstRow;zc.NamedObjectName=null;lb.kc.SelectedRange=[zc];lb.kc.PresenceType=0;if(Ub){zc=[];Ub=bk(lb.$.vb.ORh());for(var vc=Ub.next();!vc.done;vc=Ub.next()){vc=vc.value;var ud={};ud.ObjectType=lb.Paa(vc.type);ud.ObjectPresenceType=
1;ud.ObjectId=vc.Ai;zc.push(ud)}lb.kc.Object=zc}else zc=Ka(zc,lb.$,1),Ub=null,zc&&(Ub={},Ub.ObjectType=lb.Paa(zc.type),Ub.ObjectPresenceType=0,Ub.ObjectId=zc.Ai),lb.kc.Object=[Ub];lb.raiseEvent(x.p0);lb.sendPresenceToService(!1)}};lb.Jn=function(Ub,zc){zc.context.methodName in x.npc&&(lb.kc.Object=[null],lb.Wbb(!1))};lb.di=function(Ub,zc){zc.context.methodName in x.npc&&(lb.kc.Object=[null],lb.Wbb(!1))};lb.Yc=function(Ub,zc){zc.VM||(lb.Jqa={},Za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SendPresenterDetailsForExcelLive",
!1)&&lb.$.ya.IsMeetingLiveSession&&lb.$.ya.IsMeetingPresenter&&(lb.kc.MeetingInfo=lb.ied()),lb.$.Tu?lb.Q4a():lb.LNb())};lb.Fc=function(){lb.zMd()};lb.Vgf=function(){lb.rWf();lb.Prf.qz()};lb.$=Ya;lb.ha=Ie.g(lb.$).ha;lb.PNa=h;lb.Iff=Za.EwaSettings.xl();lb.$.Tk(lb.Yc);lb.$.Bk(lb.Fc);lb.Jqa={};lb.DWa=new tb.a(null,null,null,null);lb.bAa={};lb.bAa.b=0;lb.bAa.c=0;lb.Prf=new D(lb.$);Za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SendPresenterDetailsForExcelLive",!1)&&lb.$.ya.IsMeetingLiveSession&&
lb.$.ya.IsMeetingPresenter&&(lb.kc.MeetingInfo=lb.ied());lb.uUd=Za.EwaSettings.tb();lb.uUd&&(lb.XMb=lc.a(function(Ub){lb.kc.PresenceType=1;lb.raiseEvent(x.p0);lb.sendPresenceToService(Ub)},40,lb.$.la,"SelectionPresenceManager.SendPresenceToService",!0),lb.j8f=lc.a(function(Ub){lb.Wbb(Ub);lb.zMd()},40,lb.$.la,"SelectionPresenceManager.SendCurrentPresence",!0));lb.JWf=Za.EwaSettings.isChangeGateEnabled("OfficeVSO:6331623_ProcessShapeFOPresence");return lb}function D(Ya){var h=Pc.call(this)||this;h.statusBarManager=
null;h.$=Ya;h.$.da.Za(29,function(lb){h.statusBarManager=lb;lb.gJ(h)});return h}function I(Ya,h,lb,Ub,zc){zc=void 0===zc?null:zc;var vc=sd.call(this)||this;vc.wu={};vc.T3b=0;vc.S3b=0;vc.Crb=null;vc.Prd=null;vc.Pkf=3E4;vc.Fhd=!1;vc.LPd=!0;vc.tDd=null;vc.svf=function(){var ud=vc.hma,Gd;for(Gd in ud)ud=Gd,vc.Uke(ud)?(vc.Ijc(ud,!0),delete vc.o$a[ud],delete vc.hma[ud]):Yb.ULS.sendTraceTag(537154377,0,50,"PresenceView.OnEcsUserListChanged: pending userId=[{0}] still not updated",ud)};vc.HAd=function(ud,
Gd){ud={};ud.UpdatedCount=Gd.yO?Object.keys(Gd.yO).length:0;ud.DisconnectedCount=Gd.p3?Gd.p3.length:0;ud.Location="canvas";Cc.b(vc.$).yd(gd.a.CDd,ud);ud=null;vc.$.Fb&&(ud=vc.$.Fb.Kg("ModelUpdate","PresenceRendering"),ud.start());var od={};if(Gd.yO){if(Za.EwaSettings.isChangeGateEnabled("OfficeVSO:5140517_PresenceBootBreakDownMetrics")){var Ae=(new Date).getTime();Mb.TaskExtensions.Aa(ub.GetServiceTaskFactory.Ra(vc.$.da,435,436,1),function(Cd){Cd.result.bvi(Ae)},vc.$.la,3)}vc.Htb||(vc.ttd(!0),vc.Htb=
!0);var Ne=Gd.yO;for(xc in Ne){var gf=Ne[xc],Ja=xc;vc.ckd[Ja]=Qd.a.Ta.Jb;if(!Hd.h(vc.$)||null==gf.NavigationState)if(vc.$ye(Ja,new Date),vc.HHg(gf),Ja!==vc.Crb){var Lb=vc.wu[Ja];Lb||(vc.Uke(Ja)?vc.Ijc(Ja,!0):(Ja in vc.hma?Yb.ULS.sendTraceTag(537154376,0,50,"PresenceView.OnSelectionPresenceChanged: userId=[{0}] already pending update",Ja):(vc.o$a[Ja]=Qd.a.Ta.Jb,od[Ja]=1),vc.hma[Ja]=!0,Lb=vc.dTh(Ja),vc.wu[Ja]=vc.gEe(Lb)),Lb=vc.wu[Ja]);Lb&&(Lb.kc=gf,gf.SelectedRange&&1<gf.SelectedRange.length?vc.T3b++:
vc.S3b++,vc.COf(Ja),vc.s_a(Lb))}}if(Za.EwaSettings.isChangeGateEnabled("OfficeVSO:5140517_PresenceBootBreakDownMetrics")&&vc.$.ea&&vc.$.ea.J4a){var mc=(new Date).getTime();Mb.TaskExtensions.Aa(ub.GetServiceTaskFactory.Ra(vc.$.da,435,436,1),function(Cd){Cd.result.cvi(mc)},vc.$.la,3)}}if(Gd.p3){var xc=0;for(Ne=Gd.p3.length;xc<Ne;xc++)Ja=Gd.p3[xc],vc.E5c[Ja]=Qd.a.Ta.Jb,vc.sOf(Ja,!0)}if(Gd.p3&&0<Gd.p3.length||0<zd.a(od).length||0<zd.a(vc.hma).length)xc=[],Array.addRange(xc,zd.a(od)),Array.addRange(xc,
zd.a(vc.hma)),(od=vc.$.da.za(292))&&od.oTa(xc,Gd.p3);ud&&ud.stop();vc.Fhd=!1;ud=vc.wu;for(var hd in ud)if(0===Object(vb.a)(X,ud[hd]).kc.CollabMode){vc.Fhd=!0;break}vc.raiseEvent("pcek",Gd)};vc.QBa=function(ud,Gd){Gd&&vc.$.Tu&&(Gd.unb.HasAnyNonOcsCoauthor=vc.Fhd)};vc.AEb=function(){var ud=new Fd.a({},null),Gd=vc.FBa,od;for(od in Gd){var Ae=od,Ne=Gd[od].kc;Ne.SelectedRange=Ne.SelectedRangeRaw;ud.yO[Ae]=Ne}vc.HAd(vc,ud)};vc.Rc=function(){vc.W4e()};vc.ewi=function(){vc.Prd&&ve.a(Qd.a.Ta,vc.Prd)<vc.Pkf||
(vc.Prd=Qd.a.Ta.Jb,vc.Tsd(),vc.dti(),vc.Nti(),vc.Htb||vc.ttd(!1))};vc.vya=function(){vc.W4e();var ud=vc.wu,Gd;for(Gd in ud)vc.s_a(ud[Gd])};vc.Fc=function(){vc.Tsd();vc.Htb||vc.ttd(!1);vc.Htb=!1};vc.Lzf=function(){var ud=vc.wu,Gd;for(Gd in ud)ud[Gd].dispose();vc.wu={};vc.vxe();vc.o$a={};vc.XNc={};Array.clear(vc.Nx);vc.gxc()};vc.$Db=function(ud,Gd){vc.DSd(Gd.rj)};vc.E5c={};vc.ckd={};vc.o$a={};vc.XNc={};vc.$=Ya;vc.PNa=Ub;vc.kn=h;vc.Zee=lb;H.rLb=!0;H.Cna=!0;vc.Q4a();vc.vw=new J(Ya);vc.$.va&&vc.$.va.If(vc.vya);
vc.kn.ZYb(vc.$Db);Ya.oa&&vc.$.oa.Gga(vc.QBa);vc.Nx=[];vc.kn.q_a();Ya.da.Ga(25,vc);vc.Htb=!1;vc.$.Bk(vc.Fc);vc.vWc=rb.a.instance.nE(vc.ewi,vc.Pkf/2,Kd.a.x_i,!0,!1);vc.uDd=zc;return vc}function F(Ya,h,lb){var Ub=X.call(this)||this;Ub.UG=new jc.a(!0);Ub.f2c=0;Ub.g2c=0;Ub.countFloatingObjects=0;Ub.CEd=!1;Ub.Aq=function(){Ub.KNd()};Ub.vya=function(){Ub.KNd()};Ub.Oz=new ja(Ya);Ub.F_f(Ya);Ub.vw=lb;Ub.NOd([]);Ub.$=h;Ub.$.va.If(Ub.vya);Ie.g(Ub.$).iP(Ub.Aq);Ub.CEd=Za.EwaSettings.isChangeGateEnabled("OfficeVSO:6331623_ProcessShapeFOPresence");
return Ub}function G(Ya,h,lb){var Ub=ic.call(this,h,Ie.g(h),!0,!1,Ya.User.UserID)||this;Ub.ez=[];Ub.l0d=48;Ub.MLb=!1;Ub.Fgc=!1;Ub.JEb=function(){Yb.ULS.sendTraceTag(521143967,0,50,"PresenceHighlight:onPresenterDetailsSaved called for User:\n      "+Ub.hn.User.UserID+", Logging presenter information: "+Ub.Ivb());Ub.hn.User.UserID===Ub.Ivb()&&(Ub.ez.forEach(function(zc){Ub.KHe(zc)}),Ub.ez=[])};G.$_a||(G.$_a={});Ub.hn=Ya;Ub.du=new O(Ub.gridView,Ub.hn.User.UserID,Ub.hn.User.UserName,Ub.hn.UserColor,Ub,
lb,Ub.$,Ub.hn.IsAnonymous);Ub.Bnd=Hd.i(Ub.$);Ub.fki=Za.EwaSettings.isChangeGateEnabled("OfficeVSO:6191577_PresenterPresenceOnTop");Ub.zmd=Hd.a(Ub.$);Ub.Pbf=Ub.Bnd||Ub.zmd;Ub.JEb=Ub.JEb.bind(Ub);Ub.Pbf&&Ub.Tri();return Ub}function T(Ya,h,lb){this.Sg=this.objectId=this.jDa=null;this.hn=Ya;this.$=h;this.vw=lb;this.du=new O(Ie.g(this.$),this.hn.User.UserID,this.hn.User.UserName,this.hn.UserColor,null,lb,this.$,this.hn.IsAnonymous)}function O(Ya,h,lb,Ub,zc,vc,ud,Gd){var od=Qb.call(this)||this;od.gb=null;
od.pz={};od.kje=0;od.ura=null;od.Sg=null;od.Dqa=0;od.pEb=function(Ae){od.ura&&od.ura!==Ae||(od.ura=null,od.u4(!1));od.raiseEvent("hidePresenceTooltip")};od.TEb=function(Ae){od.ura&&od.ura!==Ae||(od.ura=null,od.Dna(!0,!1));od.raiseEvent("showPresenceTooltip")};od.SEb=function(Ae){od.ura||od.raiseEvent("showFullPresenceTooltip");od.ura=Ae};od.IEb=function(){od.u4(!1);od.raiseEvent("presenceChanged")};Gd=lb===Be.a.instance.mb(87)||Gd;od.hOc=new tb.a(h,lb,Ub,new oc.a,null,null,null,null,Gd);od.gridView=
Ya;od.NRc=h;od.highlight=zc;od.vw=vc;od.$=ud;return od}function U(Ya,h,lb,Ub,zc){var vc=Fa.call(this)||this;vc.Nx=[];vc.SZa=null;vc.visible=!1;vc.eBb=null;vc.dob=null;vc.sua=!1;vc.lhe=null;vc.TAj=function(){Dc.a.Ia(vc.dob);vc.dob=null;vc.visible&&(vc.YLa()?vc.raiseEvent("showPresenceTooltip"):vc.u4(!0))};vc.Mzd=function(ud){vc.Mab(ud)};vc.rz=function(){vc.tbg()};vc.nF=function(){vc.tbg()};vc.domElement=Ya;vc.gridView=h;vc.NRc=Ya.id;vc.Dqa=Ub;vc.$=zc;vc.Chc=!1;vc.k7e();vc.hOc=lb;vc.Sg=null;vc.Uw={};
vc.Uw.FirstColumn=0;vc.Uw.FirstRow=0;vc.Uw.LastColumn=0;vc.Uw.LastRow=0;return vc}function J(Ya){var h=this;this.Dhc=!1;this.aD=this.yoa=this.BDd=null;this.pEb=function(lb){var Ub=h.Qaa(lb.ty);Ub&&h.Rrc(Ub,lb.Vya.clientId,lb.ty)};this.TEb=function(lb){h.ry(!1,lb)};this.SEb=function(lb){h.ry(!0,lb)};this.rz=function(){h.idg()};this.nF=function(){h.idg()};this.vya=function(){h.Yqb();h.clearCache()};this.WZh=function(lb){lb=Xb.DOMElementExtensions.getBounds(lb.element);lb=new Sb.a(lb.x,lb.y,lb.width,
lb.height);for(var Ub=bk(K.oKa()),zc=Ub.next();!zc.done;zc=Ub.next())if(zc=h.gridView.Cf(zc.value),zc=Xb.DOMElementExtensions.getBoundingClientRect(zc.domElement),(new Sb.a(zc.x,zc.y,zc.width,zc.height)).xd(lb))return zc;return null};this.kTj=function(){var lb=h.pz,Ub;for(Ub in lb){var zc=lb[Ub];if(zc){var vc=zc.YLa(),ud=h.Qaa(zc.ty),Gd=vc?h.Z_e(zc.Ppc,zc.paneType,zc.range):null;if(Gd!==ud){ud&&h.Rrc(ud,zc.Vya.clientId,zc.ty);if(!H.Cna)break;Gd&&vc&&(Gd.gYa(zc.Vya),h.ATa[zc.ty]=Gd,zc.sMb(Gd),h.j5e(Gd,
zc))}else h.j5e(ud,zc)}}};this.Z7e=Da.a.csh;this.Qva=20;this.gridView=Ie.g(Ya);this.$=Ya;this.lGb={};this.ATa={};this.pz={};this.zTa={};this.$.va&&this.$.va.If(this.vya);this.Yqb()}function H(){}function K(Ya,h,lb){var Ub=Tc.call(this)||this;Ub.Pya=null;Ub.uGf=null;Ub.PLd=!1;Ub.rz=function(){Ub.Yid()};Ub.nF=function(){Ub.Yid()};Ub.gridView=Ya;Ub.rtl=Ya.rtl;Ub.Xnd=!1;Ub.Eh=new jc.a(!0);for(var zc=0;4>zc;zc++)if(Ub.gridView.eb.Uod(lb,K.oKa()[zc])||1===K.oKa()[zc]){var vc=h.N4g(),ud=Ya.Cf(K.oKa()[zc]).domElement;
ud.insertBefore(vc.element,ud.firstChild);Ub.Eh.add(Enum.toString(fd,K.oKa()[zc]),vc)}return Ub}function N(Ya,h,lb){if(!h)return null;Ya=Ya.Bq;return new Sys.UI.Point(h.x+Ya.x*(lb?1:-1),h.y+Ya.y*(lb?1:-1))}function M(Ya){this.he=Ya;this.he.eYa(10,ke.a.instance);this.he.eYa(9,Pe.a.instance);this.he.eYa(6,20);this.he.eYa(13,cf.a.instance);this.he.eYa(17,!1)}function C(Ya,h,lb){Ya=ea.call(this,Ya)||this;Ya.kDa=!1;Ya.aTb=!1;Ya.O8=!1;Ya.NWa=!1;Ya.oA=[];Ya.USb={};Ya.he=lb;Ya.Vi=lb.get(8,!1);Ya.F6d=lb.get(15,
!1);Ya.Mmg=lb.get(12,0);Ya.dsa=lb.get(6,0);Ya.GWb=h;Ya.gie=lb.get(16);Ya.XHc=lb.get(17,!1);Ya.VYj=lb.get(19,!1);Ya.Atg=lb.get(20,!1);Ya.NTb=0;Ya.wtg=new P(Ya.Vi,Ya.XHc);Ya.bgb=Ya.pXe();Ya.UNc=!1;Ya.Gea=[];Ya.Fib=[];Ya.element.id=C.VEh();Ya.element.className=ea.j9g(Ya.Vi);Ya.Trb&&(Ya.zIndex=Ya.Trb);Ya.rtl=Ya.Vi;Ya.woj(h);Ya.gfa=Ya.createElement("div");Ya.gfa.className="prFlyoutContainer";Ya.element.appendChild(Ya.gfa);Ya.xL=[];Ya.Tpa=new Q(Ya.IJ,Ya.element,Ya.dsa,4,6,32,Ya.Vi);Ya.iA=lb.get(9);Ya.iA.ra(qd.a.pointerDown,
Ya.Tpa.element,Object(Fb.a)(Ya,Ya.m9a,"onHitTarget"));Ya.iA.ra(qd.a.pointerOver,Ya.Tpa.element,Object(Fb.a)(Ya,Ya.m9a,"onHitTarget"));Ya.iA.ra(qd.a.pointerOut,Ya.Tpa.element,Object(Fb.a)(Ya,Ya.m9a,"onHitTarget"));return Ya}function Q(Ya,h,lb,Ub,zc,vc,ud){this.xL=Ya;this._parent=h;this.z2d=lb;this.Ilg=Ub;this.Cpg=zc;this.qXa=vc;this.ZI=ud;this._element=document.createElement("div");this.element.className="prTouchTarget"}function P(Ya,h){this.Vi=void 0===Ya?!1:Ya;this.XHc=void 0===h?!1:h}function ka(Ya,
h,lb,Ub){this.offsetTop=Ya;this.offsetLeft=h;this.Oeg=void 0===lb?2:lb;this.o7e=void 0===Ub?4:Ub}function R(Ya,h){var lb=ea.call(this,Ya)||this;lb.ni=null;lb.iA=null;lb.jGc=null;lb.uJc=null;lb.AFc=null;lb.Mpa=null;lb.Mhe=null;lb.ZI=h.get(8,!1);lb.xhb=h.get(6,0);lb.Mxg=h.get(15,!1);lb.he=h;lb.e5d=0;lb.element=Ya;lb.element.className=R.LBh;lb.rG=document.createElement("span");lb.element.appendChild(lb.rG);lb.gng=fa.ELh(h.get(6,0));lb.av(h);lb._state=5;return lb}function fa(){}function ca(Ya,h){var lb=
xe.call(this)||this;lb.type=Ya;lb.atb=h;return lb}function ea(Ya){var h=af.call(this)||this;h._element=null;h.element=Ya;return h}function wa(){this.VO={}}function X(){var Ya=Le.call(this)||this;Ya.Oz=null;Ya.Nce=null;Ya.Pce=null;return Ya}function ja(Ya){var h=Se.call(this)||this;h.Rhe=Ya;h.Jqa=null;h.mOc=null;return h}function va(Ya){var h=kd.call(this)||this;h.$=Ya;h.Eb();return h}function ua(Ya){var h=this;this.gHf=this.yDd=this.iHf=this.eHf=this.nFf=this.hLd=this.ETf=this.MTf=this.LTf=!1;this.zDd=
this.mCd=this.bJb=this.eJb=this.Otc=this.lLd=0;this.pff=!1;this.zwd=this.gpb=0;this.Ihc=!1;this.Uc=function(){h.Ihc=!0;h.$.ea.wk(h.Uc)};this.$=Ya;Na.a.tP&&(this.zwd=window.performance.timing.navigationStart);this.zwd||Yb.ULS.sendTraceTag(537154379,0,15,"Navigation start time is zero");this.$.ea.Vj(this.Uc)}function Xa(){var Ya=ld.call(this)||this;Ya.kBe=null;Ya.Eb();return Ya}function aa(){}function ba(){}function oa(Ya){var h=this;this.Pa=new kc.a;this.Edg=this.disposed=!1;this.fFb=function(){Yb.ULS.sendTraceTag(537154381,
0,50,"PeopleInfoProvider.OnUserListUpdated fired");h.Pa.raiseEvent("UU",h)};this.$=Ya;this.$.ea.Fga(this.fFb);this.Edg=Za.EwaSettings.isChangeGateEnabled("OfficeVSO:6220406_UseIsAnonymousForNewPresenceUser")}function ra(Ya){var h=pc.call(this)||this;h.manager=null;h.$=Ya;h.Eb();return h}function db(Ya){var h=nb.call(this)||this;h.Osa=null;h.g0a=null;h.xta=!1;h.ICc=!1;h.Qf=function(){var lb=h.$.ea.ho;if(null===lb||void 0===lb?0:lb.SheetChanges){lb=bk(lb.SheetChanges);for(var Ub=lb.next();!Ub.done;Ub=
lb.next())if(Ub=Ub.value,2===Ub.Type){if(h.Osa)for(var zc=bk(h.Osa),vc=zc.next();!vc.done;vc=zc.next())vc=vc.value,vc.Range.SheetName===Ub.Name&&(vc.Range.SheetName=Ub.NewName);if(h.g0a)for(zc=bk(h.g0a),vc=zc.next();!vc.done;vc=zc.next())vc=vc.value,vc.Range.SheetName===Ub.Name&&(vc.Range.SheetName=Ub.NewName)}}};h.Twf=function(){Yb.ULS.sendTraceTag(537154395,0,50,"NamedSheetViewConversionManager.OnGridLoaded");h.ICc=!1;h.umc(h,Sys.EventArgs.Empty)};h.Fc=function(){Yb.ULS.sendTraceTag(537154394,0,
50,"NamedSheetViewConversionManager.OnWorkbookClosing");h.ICc=!0};h.umc=function(){Yb.ULS.sendTraceTag(50620166,0,50,"NamedSheetViewConversionManager.OnConversionOutdatedEvent: triggered with version [{0}]",h.$.ea.Txa);if(!h.$.isEditMode||!h.$.ea.dc||h.$.ea.G4a||h.ICc||h.$.ea.Txa===Rc.a.K5b)Yb.ULS.sendTraceTag(537154393,0,50,"NamedSheetViewConversionManager.OnConversionOutdatedEvent: Request skipped [Edit Mode: {0}] [IsSessionActive: {1}] [HasRaisedSessionEnded: {2}] [WorkbookClosed: {3}]",h.$.isEditMode,
h.$.ea.dc,h.$.ea.G4a,h.ICc);else{h.Osa=null;h.g0a=null;var lb=h.$.oa.xa.Pb(),Ub=h.$.oa.xa,zc=h.dLi,vc=h.cLi,ud=Ub.Na(1,null);uc.g(Ub,"GetNamedSheetViewConversion",ud,zc,vc,null,lb,132)}};h.dLi=function(lb){if(wb.a.Uq(lb.Errors)){h.xta=!0;var Ub=[-1100324317,-1857233882];wb.a.Zg(lb.Errors,Ub)&&Yb.ULS.sendTraceTag(537154392,0,10,"NamedSheetViewConversionManager.OnGetNamedSheetViewConversionSuccess Errors: [{0}]",wb.a.Ec(lb.Errors));lb=wb.a.xF(lb.Errors,Ub,"NamedSheetViewConversionManager:OnGetNamedSheetViewConversionSuccess");
h.$.ea.fp(lb)}else h.xta=!1,lb=lb.Result,h.$.ea.Txa=lb.ConversionVersion,h.y0i(lb.NamedSheetViewConversionEntries),h.F2i()};h.cLi=function(lb){h.xta=!0;lb=Fc.a.Mf(lb.data);Yb.ULS.sendTraceTag(537154391,0,10,"NamedSheetViewConversionManager.OnGetNamedSheetViewConversionFailure: Errors: [{0}].",wb.a.Ec(lb))};h.$=Ya;Yb.ULS.shipAssertTag(537154397,0,!!h.$.ea,"NamedSheetViewConversionManager ctor: EwaControl.SessionStateManager should not be null");h.$.Bk(h.Fc);h.$.ea.uT(h.Twf);h.$.ea.oFg(h.umc);h.$.ea.zu(h.Qf);
h.$.ea.Xt&&h.umc(h,Sys.EventArgs.Empty);return h}function Ka(Ya,h,lb){if(!h||!h.vb)return null;for(var Ub=0;Ub<h.vb.count;Ub++){var zc=h.vb.getItem(Ub);if(zc&&zc.type===lb&&zc.usedRange&&zc.usedRange.contains(Pb.D(Ya))&&sc.a.equals(zc.sheetName,Ya.SheetName,!0))return zc}return null}function Ga(Ya,h){return!!Ya&&!!h&&Ya.SheetName===h.SheetName&&(!!Ya.NamedObjectName&&Ya.NamedObjectName===h.NamedObjectName||!Ya.NamedObjectName&&!h.NamedObjectName&&Pb.D(Ya).xd(Pb.D(h)))}function xa(){}function da(Ya,
h,lb,Ub,zc,vc,ud,Gd,od){od=void 0===od?!1:od;this.Uoa=null;this.RHc=!0;this.gOc=this.BEa=this.CEc=null;this.$a=new kc.a;this.msg=Ya;this.vee=h;this.Oce=lb;this.Mce=Ub;this.c1d=vc;da.ae=zc;this.Gtg=ud;this.yqa=Gd;this.gug=od;Ob.Task.WAA(h,lb).continueWith(Object(Fb.a)(this,this.U8h,"initOnTaskReady"))}function qa(Ya){var h=Vb.call(this)||this;h.j3b=null;h.NTf=null;h.K1=null;h.N7d=!1;h.MV=function(lb,Ub){if(2===Ub.newState){if(h.rj){if(Za.EwaSettings.isChangeGateEnabled("OfficeVSO:5140517_PresenceBootBreakDownMetrics")){var zc=
(new Date).getTime();Mb.TaskExtensions.Aa(ub.GetServiceTaskFactory.Ra(h.$.da,435,436,1),function(vc){vc.result.vvi(zc)},h.$.la,3)}h.raiseEvent("connectionCompleted",new na(h.rj),Ub)}else Yb.ULS.sendTraceTag(537167630,0,15,"RealTimeChannelController.OnConnectionStateChanged: new state is connected and this.RealTimeChannel is null");h.j3b=Ub}else if(2===Ub.oldState||0===Ub.newState)h.j3b=null,h.raiseEvent("connectionLostEventKey")};h.noc=function(){if(h.rj){var lb=Object(vb.a)(17,h.rj);lb&&(Yb.ULS.sendTraceTag(537167629,
0,50,"RealTimeChannelController.OnWorkbookClosed: disconnecting from RTC"),lb.disconnect(),lb.Gma(h.MV))}h.K1=null};h.$=Ya;h.$.Bk(h.noc);h.$.ea.KUc(h.noc);Ya.da.Za(38,function(lb){lb.Xme(h.noc)});return h}function na(Ya){var h=Ab.call(this)||this;h.rj=Ya;return h}function ia(){}function ta(Ya,h,lb,Ub,zc,vc,ud,Gd,od){ud=void 0===ud?null:ud;Gd=void 0===Gd?null:Gd;od=void 0===od?null:od;this.cde={};this.NFc={};this.g9d=new Cb.a;this.Iib=this.Tw=this.RVb=null;this.fge=this.ege=0;this.bFa=new ya.a(function(){return ud.zM("PresenceBootLatencyThreshold",
1E4)});this.NCa=new ya.a(function(){return ud.zM("PresenceBootLatencyCutoffThreshold",6E4)});this.eyg=new ya.a(function(){return ud.zM("PresenceLightupLatencyThreshold",2E3)});this.ymg=new ya.a(function(){return ud.zM("PresenceLightupLatencyCutoffThreshold",1E4)});this.vtg=Ub;this.w2d=Ya;this.uee=h;this.Hqa=lb;this.Uh=zc;this.uWa=Gd;this.sCa=vc;this.zd=od;this.q1d=!1;this.init()}function za(Ya,h,lb){this.V1d=this.u2d=this.PQb=this.$Qb=this.oUa=0;this._id=Ya;this.bFa=h;this.NCa=lb;this.rUa=Object(vb.a)(String,
Wa.AFrameworkApplication.Ob.Application)||""}function sa(Ya,h,lb,Ub,zc,vc,ud,Gd,od){this.kfe=!1;this._id=Ya;this.rp=h;this.wL=lb;this.TMc=Ub;this.rRc=zc;this.bFa=vc;this.NCa=ud;this.zlg=Gd;this.sCa=od;this.rUa=Object(vb.a)(String,Wa.AFrameworkApplication.Ob.Application)||""}function V(){this.ct=this.vt=this.d=0}function Ia(){this.id=null;this.d=this.tp=this.mp=this.st=this.et=0;this.ct=null;this.vc=!1}function Ha(Ya,h,lb,Ub){this.Ifa=null;this.bHc=this.SMc=!1;this.qkb=Ya;this.bRc=h;this.ib=lb;this.uWa=
Ub}function ob(Ya){this.Tw=null;this.aRb={};this.XUb={};this.Hib=null;this.Hqa=Ya}function ib(Ya,h,lb,Ub,zc,vc,ud,Gd,od){this.oce=this.x2d=this.Tw=null;this.kUa=Ya;this.JWb=new kb.a;this.ib=lb;this.OFc=h;this.sUa=Ub;this.Uh=zc;this.ZNc=vc;this.Hqa=ud;this.hkg=Gd;this.t6d=this.q6d=!1;this.dXb=0;this.v2d=1;this.sCa=od;this.Vhe=this.ib.qa("PeoplesWellExtraButtonInfoIsEnabled");this.rUa=Object(vb.a)(String,Wa.AFrameworkApplication.Ob.Application)||""}function La(Ya,h){this.Ifa=null;this.qkb=Ya;this.stg=
h}b.r(E);var zb=b(0),Fb=b(84);La.prototype.init=function(){var Ya=this;this.qkb.continueWith(function(){Ya.Ifa=Ya.qkb.result;Ya.Ifa.uYa(Object(Fb.a)(Ya,Ya.qF,"onUsersUpdated"))})};La.prototype.qF=function(){La.Pqe(this.Ifa.Gua())&&(this.Ifa.xsc(Object(Fb.a)(this,this.qF,"onUsersUpdated")),this.stg.IsRealCoauthSession=!0)};La.Pqe=function(Ya){var h,lb=null;Ya=bk(Ya);for(h=Ya.next();!h.done;h=Ya.next())if(h=h.value)if(h=h.isAnonymous||!h.email?h.clientId:h.email.toUpperCase(),!lb)lb=h;else if(lb!==
h)return!0;return!1};Object(zb.a)(La,"CoauthTelemetry",null,[846]);var Yb=b(14),kb=b(162),vb=b(85),Wa=b(4),qb;(function(Ya){Ya[Ya.badStatePreventedTelemetry=0]="badStatePreventedTelemetry";Ya[Ya.notImplemented=1]="notImplemented";Ya[Ya.renderHandled=2]="renderHandled";Ya[Ya.renderHandledWithVeto=3]="renderHandledWithVeto"})(qb||(qb={}));Object(zb.b)("CoauthorGalleryTelemetryEndResult",qb);var yb=b(99),ec=b(113),Ob=b(58);ib.prototype.init=function(){var Ya=this;Ob.Task.WAA.call(null,this.Hqa,this.OFc,
this.ZNc).continueWith(function(){Ya.Tw=Ya.Hqa.result;Ya.x2d=Ya.OFc.result;Ya.oce=Ya.ZNc.result;Ob.Task.WAA.call(null,Ya.OFc.result.p0c,Ya.ZNc.result.wzc).continueWith(function(){Ya.v2d=Ya.x2d.p0c.result;Ya.dXb=Ya.oce.wzc.result;Ya.Tw.uYa(Object(Fb.a)(Ya,Ya.koc,"onUsersUpdatedEventListener"));Ya.Tw.Gua().length&&Ya.qF()})})};ib.prototype.koc=function(){this.qF()};ib.prototype.qF=function(){this.hkg(this.Tw.Gua())?(this.Tw.xsc(Object(Fb.a)(this,this.koc,"onUsersUpdatedEventListener")),this.CJi(this.q6d)):
this.JWb.Jw(1);this.q6d=!0};ib.prototype.CJi=function(Ya){var h=this;this.t6d?this.i5f.continueWith(function(){Yb.ULS.sendTraceTag(42062996,325,15,"We already attempted to log a render of coauthor gallery: {0}",qb[h.i5f.result])}):(this.t6d=!0,this.X0i(0===this.v2d&&!Ya))};ib.prototype.X0i=function(Ya){Ya?this.sUa.ak(4,Object(Fb.a)(this,this.Kzd,"onInteractiveReady")):this.JWb.Jw(1)};ib.prototype.Kzd=function(){var Ya=this.Uh.eH("AppInitStatus_interactivityReady");Yb.ULS.shipAssertTag(42259235,325,
!!this.dXb);var h=this.dXb-Ya;Ya={InteractiveTime:Ya};Ya.ReactRenderComplete=this.dXb;Ya.HadTabSwitch=this.sCa();Ya.IsModernGallery=this.Vhe;Yb.ULS.sendTraceTag(594883104,325,50,ec.a.toJSON(Ya));this.Vhe?(Yb.ULS.sendTraceTag(42062997,325,15,h.toString()),this.JWb.Jw(this.vVj(h)?3:2)):Yb.ULS.sendTraceTag(594883103,325,15,h.toString())};ib.prototype.vVj=function(Ya){var h=Ya>this.ib.kd("CoauthorGalleryTimeToRenderDurationMs",1E4),lb="Word"===this.rUa;if(this.sCa())return Yb.ULS.sendTraceTag(50455714,
325,50,h.toString()),!1;lb&&yb.Health.instance.recordKpiUsage("CoauthGalleryExperienceDegraded",0,"wordcollabrel",null);h&&(lb&&yb.Health.instance.recordKpiFailure("CoauthGalleryExperienceDegraded","CoauthorGalleryTimeToRenderDurationIsTooLong",!1,!0,null),Yb.ULS.sendTraceTag(42062998,325,15,Ya.toString()));return h};Mf.Object.defineProperties(ib.prototype,{i5f:{configurable:!0,enumerable:!0,get:function(){return this.JWb.task}}});Object(zb.a)(ib,"CoauthorGalleryTelemetry",null,[844]);ob.prototype.Cbc=
function(Ya){var h=this,lb=new kb.a;this.init().continueWith(function(){Ya in h.aRb?lb.Jw(h.aRb[Ya]):h.XUb[Ya]=lb});return lb.task};ob.prototype.init=function(){var Ya=this;if(this.Hib)return this.Hib.task;this.Hib=new kb.a;this.Hqa.continueWith(function(){Ya.Tw=Ya.Hqa.result;Ya.Tw.uYa(Object(Fb.a)(Ya,Ya.qF,"onUsersUpdated"));Ya.Fcg();Ya.Hib.setResult(null)});return this.Hib.task};ob.prototype.Fcg=function(){var Ya=this.Tw.Gua();Ya.sort(Object(Fb.a)(this,this.O_g,"comparePresenceUsers"));this.aRb=
{};for(var h=0;h<Ya.length&&Ya[h]&&Ya[h].Jka;h++)this.KBg(this.aRb,Ya[h].clientId,h)};ob.prototype.KBg=function(Ya,h,lb){Ya[h]=lb;h in this.XUb&&(this.XUb[h].Jw(lb),delete this.XUb[h])};ob.prototype.qF=function(){this.Fcg()};ob.prototype.O_g=function(Ya,h){return Ya.Jka>h.Jka?1:Ya.Jka<h.Jka?-1:0};Object(zb.a)(ob,"CoauthorPositionFinder",null,[843]);var Cb=b(202),ab=b(276);Ha.prototype.init=function(){var Ya=this;this.qkb.continueWith(function(){Ya.Ifa=Ya.qkb.result;Ya.Ifa.uYa(Object(Fb.a)(Ya,Ya.qF,
"onUsersUpdated"))})};Ha.prototype.qF=function(){this.pZg(this.Ifa.Gua());!this.SMc||this.IEe&&!this.bHc||this.Ifa.xsc(Object(Fb.a)(this,this.qF,"onUsersUpdated"))};Ha.prototype.pZg=function(Ya){for(var h=new Cb.a,lb=0,Ub=bk(Ya),zc=Ub.next();!zc.done;zc=Ub.next())if((zc=zc.value)&&zc.isAnonymous){Wa.AFrameworkApplication.Pjc("70eb6120;2gfeb930");if(this.IEe&&!this.bHc)if(h.contains(zc.userName)){var vc=this.YYh(Ya);Yb.ULS.sendTraceTag(526394833,302,50,"Duplicate guest friendly name detected among {0} total guest coauthors",
vc);this.bHc=!0}else h.add(zc.userName);zc.clientId===this.uWa||this.SMc||(lb++,2<=lb&&this.Nui())}};Ha.prototype.Nui=function(){var Ya=this;Yb.ULS.sendTraceTag(525112603,302,50,"Multiple guests simultaneously coauthoring");this.SMc=!0;this.S0h&&this.bRc&&this.bRc.continueWith(function(){window.setTimeout(function(){Ya.bRc.result.logActivity("MultipleGuestsCoauthoring",null)},15E3)})};Ha.prototype.YYh=function(Ya){return ab.a.fh(Ya)?0:ab.a.HZd(Ya,function(h){return h.isAnonymous}).length};Mf.Object.defineProperties(Ha.prototype,
{IEe:{configurable:!0,enumerable:!0,get:function(){return this.ib.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IsCustomAnonymousNameEnabled",!1)}},S0h:{configurable:!0,enumerable:!0,get:function(){return this.ib.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GuestCoauthFloodgateEnabled",!1)}}});Object(zb.a)(Ha,"GuestCoauthTelemetry",null,[]);var ya=b(615);Object(zb.a)(Ia,"PL",null,[]);var ma=b(41);V.PWf=function(Ya,h,lb){var Ub=new V;Ub.d=Ya;Ub.vt=h;Ub.ct=lb;return ma.c(Ub)};Object(zb.a)(V,
"VD",null,[]);var ha=b(190);sa.prototype.veto=function(Ya){var h=this;Ob.Task.WAA(this.TMc,this.rRc).continueWith(function(){if(h.TMc.result<=h.rRc.result)Ya.Jw(!1);else{var lb=h.wL-h.rp,Ub=new Ia;Ub.id=h._id;Ub.et=h.wL;Ub.st=h.rp;Ub.d=h.wL-h.rp;Ub.mp=h.TMc.result;Ub.tp=h.rRc.result;Ub.ct=h.VJh(h.zlg);Ub.vc=h.sCa();var zc=ma.c(Ub),vc="Word"===h.rUa;Yb.ULS.sendTraceTag(42078597,302,15,zc);if(vc){var ud=new Map;ud.set("data",zc);yb.Health.instance.recordKpiUsage("PresenceExperienceDegraded",0,"wordcollabrel",
ud)}lb>h.bFa.value&&!h.kfe&&!Ub.vc&&(h.kfe=!0,Ya.Jw(!0),Ub=Object.assign(new ha.a,{inStaging:!0,extendedProperties:new Map}),Ub.extendedProperties.set("data",zc),vc&&yb.Health.instance.recordKpiFailure("PresenceExperienceDegraded","PresenceRenderDurationIsTooLong",!1,!0,Ub),lb<h.NCa.value&&Yb.ULS.sendTraceTag(42078598,302,15,V.PWf(lb,h.bFa.value,h.NCa.value)));Ya.task.isCompleted||Ya.Jw(!1)}})};sa.prototype.VJh=function(Ya){switch(Ya){case 2:return"NonWac";case 0:return"Unknown";case 1:return"Wac";
default:return"Unknown"}};Object(zb.a)(sa,"PresenceLatencyActivityLogger",null,[]);za.prototype.e_c=function(){!this.Oye&&this.oUa&&this.$Qb&&(this.u2d=this.veto(this.$Qb,"CoauthGalleryLightupDurationTooLong"));!this.Tve&&this.oUa&&this.PQb&&(this.V1d=this.veto(this.PQb,"CanvasPresenceLightupDurationTooLong"))};za.prototype.veto=function(Ya,h){var lb=Ya-this.oUa,Ub=new Ia;Ub.id=this._id;Ub.et=Ya;Ub.st=this.oUa;Ub.d=lb;var zc=ma.c(Ub);Ya="Word"===this.rUa;Ub="CanvasPresenceLightupDurationTooLong"===
h?"PresenceExperienceDegraded":"CoauthGalleryExperienceDegraded";"CanvasPresenceLightupDurationTooLong"===h?Yb.ULS.sendTraceTag(572289499,302,15,zc):Yb.ULS.sendTraceTag(571524118,302,15,zc);if(Ya){var vc=new Map;vc.set("data",zc);yb.Health.instance.recordKpiUsage(Ub,0,"wordcollabrel",vc)}return lb>this.bFa.value?(vc=Object.assign(new ha.a,{inStaging:!0,extendedProperties:new Map}),vc.extendedProperties.set("data",zc),zc=lb<this.NCa.value,vc.extendedProperties.set("cash",zc?"true":"false"),Ya&&yb.Health.instance.recordKpiFailure(Ub,
h,!1,!0,vc),Yb.ULS.sendTraceTag(572289500,302,15,V.PWf(lb,this.bFa.value,this.NCa.value)),zc?2:1):3};Mf.Object.defineProperties(za.prototype,{NHg:{configurable:!0,enumerable:!0,get:function(){return this.oUa},set:function(Ya){this.oUa=Ya;this.e_c()}},hZg:{configurable:!0,enumerable:!0,get:function(){return this.$Qb},set:function(Ya){this.$Qb=Ya;this.e_c()}},zUg:{configurable:!0,enumerable:!0,get:function(){return this.PQb},set:function(Ya){this.PQb=Ya;this.e_c()}},Oye:{configurable:!0,enumerable:!0,
get:function(){return 0!==this.u2d}},Tve:{configurable:!0,enumerable:!0,get:function(){return 0!==this.V1d}}});Object(zb.a)(za,"PresenceLightupLatencyLogger",null,[]);var Z=b(57),Na=b(333);ta.prototype.hkh=function(Ya,h,lb){var Ub=this;lb=void 0===lb?null:lb;var zc=void 0===zc?0:zc;lb&&(Yb.ULS.shipAssertTag(42274970,302,!this.uWa||this.uWa===lb,"_myClientId is already set and you are trying to update it to something different"),this.uWa=lb);var vc=new kb.a;this.init().continueWith(function(){Ub.jPi(Ya);
Ub.ikh(vc,Ya,h,zc)})};ta.prototype.init=function(){var Ya=this;if(this.Iib)return this.Iib.task;this.Iib=new kb.a;this.sCa()&&Yb.ULS.sendTraceTag(50951700,302,15,"TabSwitched Session");this.w2d.continueWith(function(){var h=Ya.w2d.result,lb=h.p0c,Ub=h.IAi;Ub.continueWith(function(){lb.continueWith(function(){Ya.zd&&Ya.zd.addQosPillar("RealTimeCoauth");Ya.hEj(lb.result,Ub.result);Ya.Iib.setResult(null)})})});this.uee.continueWith(function(){Ya.RVb=Ya.uee.result;Ya.RVb.Dga(Object(Fb.a)(Ya,Ya.oQi,"onRtcConnection"));
Ya.RVb.tYa(Object(Fb.a)(Ya,Ya.qHi,"onCoauthorBootReceived"))});this.Hqa.continueWith(function(){Ya.Tw=Ya.Hqa.result;Ya.Tw.uYa(Object(Fb.a)(Ya,Ya.koc,"onUsersUpdatedEventListener"));0<Ya.Tw.Gua().length&&Ya.qF()});return this.Iib.task};ta.prototype.vWe=function(){return this.Uh.Lsa(Z.a.xTa)?this.Uh.eH(Z.a.xTa):Na.a.tP?window.performance.timing.fetchStart:-1};ta.prototype.oQi=function(Ya,h){this.q1d||2!==h.newState||(Ya=Date.now()-this.vWe(),h={},h.clientId=this.Zpf,h.bootTime=Ya,this.q1d=!0,this.RVb.zda(15,
h))};ta.prototype.qHi=function(Ya,h){if(15===h.type){Ya=Date.now();h=h.T7;var lb=h.bootTime;this.ced(h.clientId).NHg=Ya-lb}};ta.prototype.koc=function(){this.qF()};ta.prototype.qF=function(){var Ya=Date.now(),h=this.Tw.Gua(),lb=new Cb.a;h=bk(h);for(var Ub=h.next();!Ub.done;Ub=h.next())Ub=Ub.value,this.g9d.contains(Ub.clientId)||(this.g9d.add(Ub.clientId),lb.add(Ub.clientId));if(0<lb.count)for(lb=bk(lb),h=lb.next();!h.done;h=lb.next())h=this.ced(h.value),h.Oye||(h.hZg=Ya)};ta.prototype.jPi=function(Ya){Ya=
this.ced(Ya);Ya.Tve||(Ya.zUg=Date.now())};ta.prototype.ced=function(Ya){return Ya in this.NFc?this.NFc[Ya]:this.NFc[Ya]=new za(Ya,this.eyg,this.ymg)};ta.prototype.hEj=function(Ya,h){h=void 0===h?0:h;this.ege=Ya;this.fge=h?h:(new Date).getTime()};ta.prototype.ikh=function(Ya,h,lb,Ub){lb=lb?lb.getTime():(new Date).getTime();h in this.cde?Ya.Nz():(Ub=new sa(h,this.qXh(),lb,this.Cbc(this.Zpf),this.Cbc(h),this.bFa,this.NCa,Ub,this.sCa),this.cde[h]=Ub,Ub.veto(Ya))};ta.prototype.qXh=function(){return 1===
this.ege?this.fge:this.vWe()};ta.prototype.Cbc=function(Ya){return this.vtg.Cbc(Ya)};Mf.Object.defineProperties(ta.prototype,{Zpf:{configurable:!0,enumerable:!0,get:function(){return this.uWa||"{"+Wa.AFrameworkApplication.userSessionId+"}"}}});Object(zb.a)(ta,"PresenceBootTelemetry",null,[845]);var eb=b(142),cb=b(254),Ua=b(229),pa=b(83),Qa=b(567);ia.prototype.Ph=function(Ya){var h=this;Ya.register(La,"Common.App.CoauthTelemetry.CoauthTelemetry").as("Common.App.CoauthTelemetry.ICoauthTelemetry").tc().Cc(function(){return new La(Qa.a.Jq(Ya.Tb("Common.IPeopleInfoProvider")),
Wa.AFrameworkApplication.Lf)});Ya.register(ib,"Common.App.CoauthTelemetry.CoauthorGalleryTelemetry").as("Common.ICoauthorGalleryTelemetry").tc().Cc(function(){return new ib(Wa.AFrameworkApplication.ub,Qa.a.Jq(Ya.Tb("Common.ICoauthoringTelemeryInfoProvider")),Wa.AFrameworkApplication.fa,eb.a.get_instance(),Ua.a.instance,Qa.a.Jq(Ya.Tb("Common.IPeoplesWell")),Qa.a.Jq(Ya.Tb("Common.IPeopleInfoProvider")),La.Pqe,function(){return h.ute()})});Ya.register(ta,"Common.App.CoauthTelemetry.PresenceBootTelemetry").as("Common.App.CoauthTelemetry.IPresenceBootTelemetry").tc().Cc(function(){return new ta(Qa.a.Jq(Ya.Tb("Common.ICoauthoringTelemeryInfoProvider")),
Qa.a.Jq(Ya.Tb("Common.IRealtimeChannelBasic")),Qa.a.Jq(Ya.Tb("Common.IPeopleInfoProvider")),Ya.resolve("Common.App.CoauthTelemetry.ICoauthorPositionFinder"),Ua.a.instance,function(){return h.ute()},Wa.AFrameworkApplication.fa,null,yb.Health.instance)});Ya.register(ob,"Common.App.CoauthTelemetry.CoauthorPositionFinder").as("Common.App.CoauthTelemetry.ICoauthorPositionFinder").tc().Cc(function(){return new ob(Qa.a.Jq(Ya.Tb("Common.IPeopleInfoProvider")))});Ya.register(Ha,"Common.App.CoauthTelemetry.GuestCoauthTelemetry").tc().Cc(function(){return new Ha(Qa.a.Jq(Ya.Tb("Common.IPeopleInfoProvider")),
Qa.a.Jq(Ya.Tb("Common.ISystemInitiatedFeedback")),Wa.AFrameworkApplication.fa,"{"+Wa.AFrameworkApplication.userSessionId+"}")})};ia.prototype.init=function(){Wa.AFrameworkApplication.fa.Su(function(){pa.a.instance.resolve("Common.App.CoauthTelemetry.CoauthTelemetry").init();pa.a.instance.resolve("Common.App.CoauthTelemetry.GuestCoauthTelemetry").init();Wa.AFrameworkApplication.fa.qa("CoauthorGalleryTelemetryIsEnabled")&&pa.a.instance.resolve("Common.ICoauthorGalleryTelemetry").init();Wa.AFrameworkApplication.fa.qa("CashTelemetryIsEnabled")&&
(pa.a.instance.resolve("Common.App.CoauthTelemetry.IPresenceBootTelemetry"),pa.a.instance.resolve("Common.App.CoauthTelemetry.ICoauthorPositionFinder"))})};ia.prototype.dispose=function(){};ia.prototype.ute=function(){return Na.a.tP&&Ua.a.instance.Lsa(Z.a.uOb)?0<Ua.a.instance.eH(Z.a.uOb)[Z.a.ffg]:!1};ia.main=function(){cb.a.instance.Qi(new ia)};Mf.Object.defineProperties(ia.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.CoauthTelemetry"}}});Object(zb.a)(ia,"CoauthTelemetryPackage",
null,[10,11]);var Db=b(1015),Kb=b(38),Ab=Sys.EventArgs;Rk(na,Ab);Object(zb.a)(na,"ConnectionCompletedEventArgs",Sys.EventArgs,[]);var ub=b(51),Mb=b(37),Aa=b(53),Za=b(1),Zb=b(50),jb=b(1362),Vb=Kb.a;Rk(qa,Vb);qa.prototype.ZYb=function(Ya){this.addHandler("connectionCompleted",Ya)};qa.prototype.fId=function(Ya){this.removeHandler("connectionCompleted",Ya)};qa.prototype.GUc=function(Ya){this.addHandler("rtcInitialized",Ya)};qa.prototype.gIb=function(Ya){this.removeHandler("rtcInitialized",Ya)};qa.prototype.Yle=
function(Ya){this.addHandler("connectionLostEventKey",Ya)};qa.prototype.ZOf=function(Ya){this.removeHandler("connectionLostEventKey",Ya)};qa.prototype.dispose=function(){this.rj&&this.rj.Gma(this.MV);this.$&&this.$.Ol(this.noc);this.K1=this.$=null;Vb.prototype.dispose.call(this)};qa.prototype.GDe=function(Ya){Mb.TaskExtensions.Aa(this.K0e().task,function(h){Ya(h.result)},this.la)};qa.prototype.nAe=function(Ya,h){this.N7d=h;this.FNi(Ya)};qa.prototype.q_a=function(){this.rj&&(this.raiseEvent("rtcInitialized"),
2===this.rj.connectionState&&this.j3b&&this.raiseEvent("connectionCompleted",new na(this.rj),this.j3b))};qa.prototype.ysi=function(){Yb.ULS.sendTraceTag(537167633,0,50,"RealTimeChannelController.OnLoadRealTimeChannelSlice");if(Za.EwaSettings.isChangeGateEnabled("OfficeVSO:5856505_RtcDownloadBreakDownMetrics")){var Ya=(new Date).getTime();Mb.TaskExtensions.Aa(ub.GetServiceTaskFactory.Ra(this.$.da,435,436,1),function(Ub){Ub.result.yvi(Ya)},this.$.la,3)}var h=[];h.push(Aa.a.current.Ro(65));h.push(Aa.a.current.Ro(66));
h=Aa.a.Bsd(h,this.$.la);var lb=Aa.a.loadScript(10,0,1);return Ob.Task.oL(h,lb)};qa.prototype.FNi=function(Ya){var h=this,lb=this.ysi();Mb.TaskExtensions.Aa(lb,function(){Yb.ULS.sendTraceTag(537167632,0,50,"RealTimeChannelController.OnLoadRealTimeChannelSlice Before RealtimeChannel create. RealtimeChannel = null: {0}",void 0===Db.RealtimeChannel||null===Db.RealtimeChannel);if(Za.EwaSettings.isChangeGateEnabled("OfficeVSO:5140517_PresenceBootBreakDownMetrics")){var Ub=(new Date).getTime();Mb.TaskExtensions.Aa(ub.GetServiceTaskFactory.Ra(h.$.da,
435,436,1),function(ud){ud.result.zvi(Ub)},h.$.la,3)}h.K1=Db.RealtimeChannel.createInstance(Ya,h.$.ya.UserSessionId,Wa.AFrameworkApplication.OTf,Wa.AFrameworkApplication.qd,null,2,Zb.b().L2e(),h.$.workbookContext.RtcEndpointUrl,void 0,new jb.a,void 0,void 0,h.$.workbookContext.RtcBootToken);Yb.ULS.sendTraceTag(571770432,0,50,"RealTimeChannelController.OnLoadRealTimeChannelSlice RealtimeChannel created");Za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EditorsTableNotification",!1)&&(pa.a.instance.register(Db.RealtimeChannel,
"AppRealtimeChannel.RealtimeChannel").as("Common.IRealtimeChannelBasic").as("AppRealtimeChannel.IRealtimeChannel").tc().Cc(function(){return h.rj}),pa.a.instance.resolve("Common.IRealtimeChannelBasic"));h.K0e().setResult(h.rj);if(Za.EwaSettings.isChangeGateEnabled("OfficeVSO:5140517_PresenceBootBreakDownMetrics")){var zc=(new Date).getTime();Mb.TaskExtensions.Aa(ub.GetServiceTaskFactory.Ra(h.$.da,435,436,1),function(ud){ud.result.xvi(h.fmd,zc)},h.$.la,3)}h.raiseEvent("rtcInitialized");Yb.ULS.sendTraceTag(571770403,
0,50,"RealTimeChannelController.OnLoadRealTimeChannelSlice raise RealTimeChannelInitializedEventKey");var vc=Object(vb.a)(17,h.rj);vc&&(Yb.ULS.sendTraceTag(571770402,0,50,"RealTimeChannelController.OnLoadRealTimeChannelSlice attach changed handler"),vc.Dga(h.MV),vc.connect())},this.la,3)};qa.prototype.K0e=function(){return this.NTf||(this.NTf=new kb.a)};qa.ka=function(Ya){Ya.da.Ga(26,new qa(Ya))};Mf.Object.defineProperties(qa.prototype,{rj:{configurable:!0,enumerable:!0,get:function(){return this.K1}},
fmd:{configurable:!0,enumerable:!0,get:function(){return this.N7d}}});Object(zb.a)(qa,"RealTimeChannelController",Kb.a,[5,6]);var Ic=b(10),Rb=b(7),kc=b(97),xb=b(108),Va=b(25);da.prototype.qKf=function(){this.$a.raiseEvent("u",null,this)};da.prototype.U8h=function(){this.vee.result&&this.Oce.result&&(this.BEa=this.vee.result,this.gOc=this.Oce.result,this.BEa.CFa(Object(Fb.a)(this,this.Ula,"onPresenceUpdated")),this.CEc=new xb.a(2,2,this.c1d,Object(Fb.a)(this,this.BPj,"updateAwayClientsTask"),88),da.ae.Dg(this.CEc))};
da.prototype.Ula=function(Ya,h){(this.RHc||this.y5i(h.yO))&&da.ae.Pma(this.CEc,0)};da.prototype.y5i=function(Ya){for(var h in Ya){var lb=this.Mce.$_e({key:h,value:Ya[h]});if(lb&&lb.clientId&&(lb=lb.clientId.toLowerCase(),(lb=this.Uoa[lb]||this.Uoa[lb.toUpperCase()])&&2===lb.status))return!0}return!1};da.prototype.BPj=function(Ya){var h=this.BEa.uHh();if(h){var lb=new Date,Ub=!1;if(this.RHc){this.Uoa=h;this.RHc=!1;h=this.Uoa;for(var zc in h){var vc=zc,ud=h[zc];ud.y7a<lb&&(lb=ud.y7a);2===ud.status&&
(Ub=!0,this.gOc.EOf(vc))}Ub&&this.qKf();da.ae.Pma(Ya,this.d_e(lb))}else{ud=new Cb.a;zc=!1;var Gd=this.Uoa;for(vc in Gd)if(Gd=vc,Gd in this.Uoa&&this.msg.clientId!==Gd){var od=this.Uoa[Gd],Ae=h[Gd];if(od&&Ae){od=od.status;var Ne=Ae.status;2===od&&1===Ne?(ud.add(Gd),Yb.ULS.sendTraceTag(38052609,392,50,Gd+" returned from away")):1===od&&2===Ne&&(zc=Ub=!0,this.gOc.EOf(Gd),Yb.ULS.sendTraceTag(38052610,392,50,Gd+" went away"));1===Ne&&Ae.y7a<lb&&(lb=Ae.y7a)}}this.Uoa=h;da.ae.Pma(Ya,this.d_e(lb));(0<ud.count||
Ub)&&this.qKf();0<ud.count&&!this.gug?(Ya=this.aKh(ud),this.zJj(Ya)):Ya=new Cb.a;(zc||0<Ya.count)&&this.Gtg(Va.a.o0c,2)}}};da.prototype.zJj=function(Ya){if(Ya.count){Ya=bk(Ya);for(var h=Ya.next();!h.done;h=Ya.next())h=this.yqa.J$(String.format(CommonUIStrings.l_EditorsToastArriving,h.value),!1),h.image=5,h.Qja="CoAuth_AuthorStatus_16x16x32",this.yqa.OD(h)}};da.prototype.aKh=function(Ya){var h=this.BEa.Qbd(),lb=new Cb.a,Ub;for(Ub in h){var zc={key:Ub,value:h[Ub]};if(Ya.contains(zc.key)){var vc=this.Mce.$_e(zc);
vc&&(lb.add(vc.userName),Ya.remove(zc.key))}}lb.count||Yb.ULS.sendTraceTag(38052611,392,10,"There were no coauthor names found");return lb};da.prototype.d_e=function(Ya){var h=new Date;return Math.max(Ya.getTime()+this.c1d-h.getTime(),0)};da.ae=null;Object(zb.a)(da,"AwayManager",null,[]);var tb=b(1524),fb=b(104),ac=b(304),Ac=b(232);Object(zb.a)(xa,"NamedSheetViewConversionEntry",null,[]);var Rc=b(8),Fc=b(121),wb=b(31),uc=b(62),Pb=b(45),sc=b(22),nb=Kb.a;Rk(db,nb);db.prototype.Kme=function(Ya){this.addHandler("SVCU",
Ya)};db.prototype.DPf=function(Ya){this.removeHandler("SVCU",Ya)};db.prototype.dispose=function(){this.g0a=this.Osa=null;this.$&&this.$.Ol(this.Fc);this.$.ea&&(this.$.ea.xR(this.Twf),this.$.ea.kbj(this.umc),this.$.ea.Bw(this.Qf));this.$=null;nb.prototype.dispose.call(this)};db.prototype.y2g=function(Ya){return this.xta?null:this.bBe(Ya,this.g0a,"ConvertPresencePublicToPrivate")};db.prototype.x2g=function(Ya){return this.xta?null:this.bBe(Ya,this.Osa,"ConvertPresencePrivateToPublic")};db.prototype.y0i=
function(Ya){Ya?(this.Dbh(Ya),this.Osa=Ya,this.g0a=this.N6g(this.Osa)):Yb.ULS.sendTraceTag(537154396,0,10,"NamedSheetViewConversionManager.ProcessConversionEntries: conversionEntries can be empty but not null")};db.prototype.F2i=function(){Yb.ULS.sendTraceTag(537154390,0,50,"NamedSheetViewConversionManager.RaiseConversionUpdatedEvent: new version is update on client from server");this.raiseEvent("SVCU")};db.prototype.bBe=function(Ya,h,lb){if(!h||!h.length)return Yb.ULS.sendTraceTag(537154389,0,50,
"NamedSheetViewConversionManager.{0}: skipping convert due to {1} ConversionEntries. ",lb,h?"empty":"null"),Ya;lb=bk(Ya);for(var Ub=lb.next();!Ub.done;Ub=lb.next()){Ub=Ub.value;for(var zc=bk(h),vc=zc.next();!vc.done;vc=zc.next())if(vc=vc.value,vc.IsRow&&Ga(vc.Range,Ub)&&!(Ub.FirstRow<=vc.Range.FirstRow&&Ub.LastRow>=vc.Range.LastRow)){var ud={};ud.SheetName=Ub.SheetName;ud.FirstRow=ud.LastRow=Ub.FirstRow;ud.FirstColumn=ud.LastColumn=Ub.FirstColumn;Ga(vc.Range,ud)?(ud=Ub.FirstRow-vc.Range.FirstRow,
0>ud||ud>=vc.ConversionMap.length?Yb.ULS.sendTraceTag(537154388,0,10,"NamedSheetViewConversionManager.ConvertRanges: invalid mapIndex after adjust. Index: [{0}], ConversionMap.Length: {1}",ud,vc.ConversionMap.length):(ud=vc.ConversionMap[ud]-ud,Ub.FirstRow+=ud,Ub.LastRow=Ub.FirstRow,Ub.LastColumn=Math.min(Ub.LastColumn,vc.Range.LastColumn))):Ub.FirstRow<vc.Range.FirstRow&&Ub.LastRow>=vc.Range.FirstRow?Ub.LastRow=vc.Range.FirstRow-1:Ub.LastColumn>=vc.Range.FirstColumn&&(Ub.LastColumn=vc.Range.FirstColumn-
1)}if(0>Ub.FirstRow||Ub.FirstRow>Rc.a.Tx)Ub.FirstRow=Math.max(Math.min(Ub.FirstRow,Rc.a.Tx),0);if(0>Ub.LastRow||Ub.LastRow>Rc.a.Tx)Ub.LastRow=Math.max(Math.min(Ub.LastRow,Rc.a.Tx),0);if(0>Ub.FirstColumn||Ub.FirstColumn>Rc.a.Wu)Ub.FirstColumn=Math.max(Math.min(Ub.FirstColumn,Rc.a.Wu),0);if(0>Ub.LastColumn||Ub.LastColumn>Rc.a.Wu)Ub.LastColumn=Math.max(Math.min(Ub.LastColumn,Rc.a.Wu),0)}return Ya};db.prototype.N6g=function(Ya){if(!Ya||!Ya.length)return Yb.ULS.sendTraceTag(537154387,0,50,"NamedSheetViewConversionManager.CreateInverseConversionEntries: skip creating inverse due to {0} ConversionEntries. ",
this.Osa?"empty":"null"),Ya;for(var h=Array(Ya.length),lb=0;lb<Ya.length;++lb){var Ub=new xa;Ub.Range=Ya[lb].Range;Ub.IsRow=Ya[lb].IsRow;Ub.ConversionMap=Array(Ya[lb].ConversionMap.length);Ub.IsRow||(this.xta=!0,Yb.ULS.sendTraceTag(537154386,0,10,"NamedSheetViewConversionManager.CreateInverseConversionEntries: adjusting presence against column sort map is NYI."));for(var zc=0;zc<Ya[lb].ConversionMap.length;++zc)Ub.ConversionMap[Ya[lb].ConversionMap[zc]]=zc;h[Ya.length-lb-1]=Ub}return h};db.prototype.Dbh=
function(Ya){if(Ya&&Ya.length){Ya=bk(Ya);for(var h=Ya.next();!h.done;h=Ya.next()){h=h.value;this.Cbh(h);var lb=h.IsRow?h.Range.LastRow-h.Range.FirstRow+1:h.Range.LastColumn-h.Range.FirstColumn+1;h.ConversionMap.length!==lb&&(Yb.ULS.shipAssertTag(537154385,0,!1,"NamedSheetViewConversionManager.DecompressEntries: decompressed conversion map doesn't match expected size - Expected: [{0}] | Actual: [{1}]",lb,h.ConversionMap.length),this.xta=!0)}}};db.prototype.Cbh=function(Ya){var h=Ya.ConversionMap;if(h&&
h.length)if(0>h[0])Yb.ULS.shipAssertTag(537154384,0,!1,"NamedSheetViewConversionManager.DecompressConversionMap: conversionMap starts with a negative number"),this.xta=!0;else{for(var lb=[],Ub=0;Ub<h.length;++Ub)if(0>h[Ub])for(var zc=h[Ub-1],vc=-1*h[Ub],ud=1;ud<=vc;++ud)lb.push(zc+ud);else lb.push(h[Ub]);Ya.ConversionMap=lb}};Object(zb.a)(db,"NamedSheetViewConversionManager",Kb.a,[876,3]);var pc=Ac.a;Rk(ra,pc);ra.prototype.create=function(){this.pb(this.manager||(this.manager=new db(this.$)))};Object(zb.a)(ra,
"NamedSheetViewConversionManagerFactory",Ac.a,[]);var Dc=b(89),oc=b(1193);oa.prototype.dispose=function(){this.disposed||(this.$&&this.$.ea&&this.$.ea.hda(this.fFb),Dc.a.oc([this.Pa]),this.$=this.Pa=null,this.disposed=!0)};oa.prototype.uYa=function(Ya){this.Pa.addHandler("UU",Ya)};oa.prototype.xsc=function(Ya){this.Pa.removeHandler("UU",Ya)};oa.prototype.Gua=function(){for(var Ya=[],h=bk(this.$.ea.Bm),lb=h.next();!lb.done;lb=h.next())Ya.push(this.LTh(lb.value));Yb.ULS.sendTraceTag(537154383,0,50,
"PeopleInfoProvider.GetAllUsers: Count: [{0}]",Ya.length);return Ya};oa.prototype.LTh=function(Ya){return new tb.a(Ya.User.UserID,Ya.User.UserName,Ya.UserColor,new oc.a(1),null,Ya.UserEmail,void 0,void 0,this.Edg?Ya.IsAnonymous:void 0,void 0,void 0,Ya.JoinCoauthTime)};Object(zb.a)(oa,"PeopleInfoProvider",null,[224,3]);var Gc=b(735);ba.prototype.OD=function(){Yb.ULS.sendTraceTag(537154380,0,50,"PresenceBootstrapper.AddNotificationBarEntry: User state changed from inactive to active")};ba.prototype.removeEntry=
function(){};ba.prototype.J$=function(Ya,h){return new Gc.a(Ya,h)};ba.prototype.dispose=function(){};Mf.Object.defineProperties(ba.prototype,{isVisible:{configurable:!0,enumerable:!0,get:function(){return!1}}});Mf.Object.defineProperties(ba,{instance:{configurable:!0,enumerable:!0,get:function(){ba.Ma||(ba.Ma=new ba);return ba.Ma}}});ba.Ma=null;Object(zb.a)(ba,"NoOpNotificationBar",null,[287,3]);aa.prototype.$_e=function(Ya){var h=Ya.key;Ya=Ya.value;if(!Ya)return null;var lb=Ya.SupportsChat?4:0;return Object(Rb.a)(new tb.a,
{clientId:h,d_c:Ya.ChatThreadId,c_c:Ya.ChatThreadDiscoveryUri,Dxb:Ya.InChat,email:Ya.Cid,capabilities:new oc.a(lb)})};Object(zb.a)(aa,"PresenceConverter",null,[877]);var ld=Ac.a;Rk(Xa,ld);Xa.prototype.create=function(){this.pb(this.kBe||(this.kBe=new aa))};Xa.ka=function(Ya){Ya.da.Ga(159,new Xa)};Object(zb.a)(Xa,"PresenceConverterFactory",Ac.a,[]);var gd=b(133),Cc=b(134);ua.prototype.yvi=function(Ya){this.LTf||(this.lLd=Ya,this.LTf=!0)};ua.prototype.zvi=function(Ya){this.MTf||(this.Otc=Ya,this.MTf=
!0)};ua.prototype.xvi=function(Ya,h){this.ETf||(this.eJb=h,this.pff=Ya,this.ETf=!0)};ua.prototype.vvi=function(Ya){this.hLd||(this.bJb=Ya,this.hLd=!0)};ua.prototype.bvi=function(Ya){!this.yDd&&this.hLd&&(this.zDd=Ya,this.yDd=!0)};ua.prototype.Zui=function(Ya){this.nFf||(this.mCd=Ya,this.nFf=!0)};ua.prototype.avi=function(Ya){if(!this.eHf&&this.Nga&&!this.Ihc){this.eHf=!0;var h=this.tcd();h.RtcIntializeToPeopleWellServiceCreate=this.mCd-this.eJb;h.PeopleWellServiceCreateToPresenceGalleryRender=Ya-
this.mCd;h.PresenceGalleryRenderTotalTime=Ya-this.Nga;Cc.b(this.$).yd(gd.a.fHf,h,void 0,!0)}};ua.prototype.dvi=function(Ya){if(!this.iHf&&this.Nga&&!this.Ihc){this.iHf=!0;var h=this.tcd();h.RtcIntializeToRtcConnect=this.bJb-this.eJb;h.RtcConnectToPresenceSent=Ya-this.bJb;h.PresenceSentTotalTime=Ya-this.Nga;Cc.b(this.$).yd(gd.a.jHf,h,void 0,!0)}};ua.prototype.cvi=function(Ya){if(!this.gHf&&this.yDd&&this.Nga&&!this.Ihc){this.gHf=!0;var h=this.tcd();h.RtcIntializeToRtcConnect=this.bJb-this.eJb;h.RtcConnectToPresenceRenderInitiate=
this.zDd-this.bJb;h.PresenceRenderInitiateToPresenceRenderFinish=Ya-this.zDd;h.PresenceRenderTotalTime=Ya-this.Nga;Cc.b(this.$).yd(gd.a.hHf,h,void 0,!0)}};ua.prototype.dispose=function(){this.$=null};ua.prototype.tcd=function(){var Ya={};Ya.CoAuthorCountsOnBoot=this.$.ea.Bm.length;Ya.RtcConnectedLaterInSession=this.pff;Ya.BrowserVisibilityChanged=this.bPg();Ya.AppInteractiveAbsTime=this.Nga;Ya.NavigationStartTime=this.zwd;Ya.AppInteractiveToRtcSliceDownloadInitialize=this.lLd-this.Nga;Ya.RtcSliceDownloadInitializeToRtcSliceLoad=
this.Otc-this.lLd;Ya.AppInteractiveToRtcSliceLoad=this.Otc-this.Nga;Ya.RtcSliceLoadToRtcInitialize=this.eJb-this.Otc;return Ya};ua.prototype.bPg=function(){return Na.a.tP&&Ua.a.instance.Lsa(Z.a.uOb)?0<Ua.a.instance.eH(Z.a.uOb)[Z.a.ffg]:!1};Mf.Object.defineProperties(ua.prototype,{Nga:{configurable:!0,enumerable:!0,get:function(){if(this.gpb)return this.gpb;Ua.a.instance.Lsa("AppInitStatus_interactivityReady")&&(this.gpb=Ua.a.instance.eH("AppInitStatus_interactivityReady"));this.gpb||Yb.ULS.sendTraceTag(537154378,
0,15,"App interactive time is zero");return this.gpb}}});Object(zb.a)(ua,"PresenceTelemetry",null,[875,3]);var kd=Ac.a;Rk(va,kd);va.prototype.create=function(){this.pb(this.$.da.za(435)||this.$.da.Ga(435,new ua(this.$)))};va.ka=function(Ya){Ya.da.Ga(436,new va(Ya))};Object(zb.a)(va,"PresenceTelemetryFactory",Ac.a,[]);var Fd=b(1523),rb=b(47),Kd=b(44),Qd=b(28),ve=b(119),Be=b(15),Ie=b(21),se=b(79),Se=Kb.a;Rk(ja,Se);ja.prototype.dispose=function(){this.raiseEvent("userPresenceChanged");this.raiseEvent("userLeft");
this.mOc=this.Jqa=this.Rhe=null;Se.prototype.dispose.call(this)};Mf.Object.defineProperties(ja.prototype,{zOb:{configurable:!0,enumerable:!0,get:function(){return this.Rhe}},kc:{configurable:!0,enumerable:!0,get:function(){return this.Jqa||{}},set:function(Ya){this.mOc=this.Jqa;this.Jqa=Ya;this.raiseEvent("userPresenceChanged")}},aEd:{configurable:!0,enumerable:!0,get:function(){return this.mOc}}});Object(zb.a)(ja,"UserPresence",Kb.a,[]);var Le=se.a;Rk(X,Le);X.prototype.NOd=function(Ya){this.Nce=
Ya};X.prototype.F_f=function(Ya){this.Pce=Ya};X.prototype.s_a=function(){};X.prototype.S3a=function(){return null};X.prototype.ldd=function(){return null};X.prototype.t3f=function(){};X.prototype.u3f=function(){};X.prototype.Ccg=function(){};X.prototype.dxc=function(){};X.prototype.ydc=function(){};X.bSj=function(Ya,h){var lb=Ya.Oz.kc;Dc.a.oc(Ya.gy);Dc.a.oc([Ya.Oz]);Ya.Oz=null;Ya.Oz=new ja(h);Ya.NOd([]);Ya.F_f(h);Ya.kc=lb};Mf.Object.defineProperties(X.prototype,{gy:{configurable:!0,enumerable:!0,
get:function(){return this.Nce}},hn:{configurable:!0,enumerable:!0,get:function(){return this.Pce}},kc:{configurable:!0,enumerable:!0,get:function(){return this.Oz.kc},set:function(Ya){this.Oz.kc=Ya}}});Object(zb.a)(X,"IUserGridPresence",se.a,[]);var rf;(function(Ya){Ya[Ya.multipleBrowsersImageClassName=0]="multipleBrowsersImageClassName";Ya[Ya.peopleImageClassName=1]="peopleImageClassName";Ya[Ya.peopleImageClusterPath=4]="peopleImageClusterPath";Ya[Ya.multipleBrowserImageClusterPath=5]="multipleBrowserImageClusterPath";
Ya[Ya.imageDimension=6]="imageDimension";Ya[Ya.rtl=8]="rtl";Ya[Ya.pointerInputManager=9]="pointerInputManager";Ya[Ya.clickInputManager=10]="clickInputManager";Ya[Ya.vertical=11]="vertical";Ya[Ya.zIndex=12]="zIndex";Ya[Ya.contextMenuInputManager=13]="contextMenuInputManager";Ya[Ya.imageDomElement=14]="imageDomElement";Ya[Ya.useIdleTooltip=15]="useIdleTooltip";Ya[Ya.viewportBoundsCallback=16]="viewportBoundsCallback";Ya[Ya.flipHorizontalDirection=17]="flipHorizontalDirection";Ya[Ya.fixRemoveFadeOutElementCrash=
18]="fixRemoveFadeOutElementCrash";Ya[Ya.ignoreEventOnExpandedTooltip=19]="ignoreEventOnExpandedTooltip";Ya[Ya.ipWidthAdjustForFlyout=20]="ipWidthAdjustForFlyout"})(rf||(rf={}));Object(zb.b)("PresenceTooltipSettingKeys",rf);wa.prototype.get=function(Ya,h){Ya=rf[Ya];return"number"===typeof(void 0===h?null:h)?(h=this.VO[Ya])?Number.parseInvariant(h.toString()):0:this.VO[Ya]};wa.prototype.add=function(Ya,h){this.VO[rf[Ya]]=h};wa.prototype.eYa=function(Ya,h){rf[Ya]in this.VO||(this.VO[rf[Ya]]=h)};wa.prototype.remove=
function(Ya){delete this.VO[rf[Ya]]};Object(zb.a)(wa,"PresenceTooltipSettings",null,[]);var af=kc.a;Rk(ea,af);ea.prototype.dispose=function(){this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element);this.element=null;af.prototype.dispose.call(this)};ea.prototype.createElement=function(Ya){return this.element.ownerDocument.createElement(Ya)};ea.prototype.kyc=function(){return!0};ea.j9g=function(Ya){return"prControl"+(Ya?"Rtl":"")};Mf.Object.defineProperties(ea.prototype,
{element:{configurable:!0,enumerable:!0,get:function(){return this._element},set:function(Ya){this._element=Ya}},visible:{configurable:!0,enumerable:!0,get:function(){return"visible"===this.element.style.visibility},set:function(Ya){this.element.style.visibility=Ya?"visible":"hidden"}},rtl:{configurable:!0,enumerable:!0,get:function(){return"rtl"===this.element.dir.toLowerCase()},set:function(Ya){this.element.dir=Ya?"rtl":"ltr"}},zIndex:{configurable:!0,enumerable:!0,get:function(){return this.element.style.zIndex},
set:function(Ya){this.element.style.zIndex=String(Ya)}}});Object(zb.a)(ea,"BasePresenceControl",kc.a,[3,391]);var xe=Sys.EventArgs;Rk(ca,xe);ca.aka="InteractivityChanged";Object(zb.a)(ca,"InteractivityChangedEventArgs",Sys.EventArgs,[]);fa.ELh=function(Ya){return fa.FLh(Ya)};fa.FLh=function(Ya){var h=document.createElementNS(fa.YZd,"svg");h.setAttribute("viewBox",String.format(fa.zah,fa.Reg,fa.Qeg));h.appendChild(fa.TXh(Ya));return h};fa.TXh=function(Ya){var h=fa.Reg/Ya,lb=2*h,Ub=fa.Qeg/2;Ya=(Ya-
12-8)*h/2;var zc=document.createElementNS(fa.YZd,"g");Sys.UI.DomElement.addCssClass(zc,fa.yah);for(var vc=1;3>=vc;vc++)zc.appendChild(fa.SJh(vc,lb,Ya+(6*vc-2)*h,Ub));return zc};fa.SJh=function(Ya,h,lb,Ub){var zc=document.createElementNS(fa.YZd,"circle");Sys.UI.DomElement.addCssClass(zc,String.format("{0}-{1}",fa.XWg,Ya));zc.setAttribute("cx",String.format("{0}",lb));zc.setAttribute("cy",String.format("{0}",Ub));zc.setAttribute("r",String.format("{0}",h));return zc};fa.YZd="http://www.w3.org/2000/svg";
fa.yah="prDancingDots";fa.XWg="prAnimateCircle";fa.zah="0 0 {0} {1}";fa.Qeg=40;fa.Reg=120;Object(zb.a)(fa,"ModernPresenceTooltipDancingDots",null,[]);var Td=b(120),Bc=b(158),qd=b(13),Jd=b(88),ad=b(123),Yd=b(55),pe=b(29);Rk(R,ea);R.prototype.rUc=function(Ya){this.addHandler(ca.aka,Ya)};R.prototype.isc=function(Ya){this.removeHandler(ca.aka,Ya)};R.prototype.dispose=function(){this.element&&(this.ni.Ba(qd.a.click,this.element,Object(Fb.a)(this,this.$c,"onClick")),this.ni.Ba(qd.a.$j,this.element,Object(Fb.a)(this,
this.kyc,"stopPropagationAndPreventDefaultBehavior")),this.iA.Ba(qd.a.pointerDown,this.element,Object(Fb.a)(this,this.onPointerDown,"onPointerDown")),this.iA.Ba(qd.a.pointerOut,this.element,Object(Fb.a)(this,this.uN,"onPointerOut")),this.iA.Ba(qd.a.pointerOver,this.element,Object(Fb.a)(this,this.ow,"onPointerOver")),this.jGc.Ba(this.element,Object(Fb.a)(this,this.kyc,"stopPropagationAndPreventDefaultBehavior")));ea.prototype.dispose.call(this)};R.prototype.av=function(Ya){this.ni=Ya.get(10);this.ni.ra(qd.a.click,
this.element,Object(Fb.a)(this,this.$c,"onClick"));this.ni.ra(qd.a.$j,this.element,Object(Fb.a)(this,this.kyc,"stopPropagationAndPreventDefaultBehavior"));this.iA=Ya.get(9);this.iA.ra(qd.a.pointerOver,this.element,Object(Fb.a)(this,this.ow,"onPointerOver"));this.iA.ra(qd.a.pointerOut,this.element,Object(Fb.a)(this,this.uN,"onPointerOut"));this.iA.ra(qd.a.pointerDown,this.element,Object(Fb.a)(this,this.onPointerDown,"onPointerDown"));this.jGc=Ya.get(13);this.jGc.ra(this.element,Object(Fb.a)(this,this.kyc,
"stopPropagationAndPreventDefaultBehavior"))};R.prototype.hide=function(Ya,h,lb){Ya=void 0===Ya?null:Ya;h=void 0===h?0:h;lb=void 0===lb?0:lb;this.Mxg&&Ya?this.vzj(Ya,h,lb):(3===this.state&&this.aOf(),this.visible=!1,this._state=5)};R.prototype.vzj=function(Ya,h,lb){this.show(Ya,h,15,4,void 0,void 0===lb?0:lb)};R.prototype.a2f=function(Ya,h,lb,Ub,zc,vc){this.show(Ya,h,20,(void 0===lb?0:lb)?2:(void 0===Ub?0:Ub)?1:0,void 0===zc?!1:zc,void 0===vc?0:vc)};R.prototype.Uyj=function(Ya,h,lb,Ub,zc){this.show(Ya,
h,lb+20,3,void 0===Ub?!1:Ub,void 0===zc?0:zc)};R.prototype.show=function(Ya,h,lb,Ub,zc,vc){Ub=void 0===Ub?3:Ub;vc=void 0===vc?0:vc;!Ya||Ub===this.state&&this.F4h(h,lb)||(this.dAg(Ub,void 0===zc?!1:zc,vc),this.gYa(Ya,Ub,vc),this._state=Ub,4===vc||0===vc&&!this.ZI?this.element.style.left=h+"px":this.element.style.right=h+"px",this.element.style.top=lb+"px",this.visible=!0)};R.prototype.gYa=function(Ya,h,lb){this.Mhe=Ya;Yd.a.Ppb(this.rG);ad.a.XXg(this.rG);this.rG.id="fly_"+Ya.clientId;this.rG.style.backgroundColor=
Ya.color;4!==h?(this.rG.style.height=this.xhb+"px",this.rG.style.lineHeight=this.xhb+"px",ad.a.oRa(this.rG,"border-radius",this.xhb+"px")):4===lb||0===lb&&!this.ZI?this.rG.style.left="0px":this.rG.style.right="0px";2!==h&&(4===h?Yd.a.uvc(this.rG,""):1===h?this.rG.appendChild(this.gng):(this.rG.setAttribute("dir","auto"),lb=pe.a.JPh(Ya.userName),(!Ya.isAnonymous||Wa.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IsCustomAnonymousNameEnabled",!1))&&lb||0!==h?(Ya=Ya.userName,
0===h&&(Ya=lb,ad.a.oRa(this.rG,"text-align","center")),Yd.a.uvc(this.rG,Ya)):(this.uJc||(this.uJc=this.d4g()),this.rG.appendChild(this.uJc),ad.a.oRa(this.rG,"text-align","start"))))};R.prototype.$c=function(Ya){if(0===this.state)return this.raiseEvent(ca.aka,new ca(1,Ya)),!0;3===this.state&&Yb.ULS.sendTraceTag(50436114,302,50,"User clicked on presence pill.");return!1};R.prototype.uN=function(Ya){3===this.state&&this.raiseEvent(ca.aka,new ca(3,Ya));return!1};R.prototype.ow=function(Ya){3!==Ya.lb&&
this.raiseEvent(ca.aka,new ca(2,Ya));return!1};R.prototype.onPointerDown=function(Ya){if(3!==Ya.lb)return!0;this.raiseEvent(ca.aka,new ca(4,Ya));return!1};R.prototype.d4g=function(){var Ya=document.createElement("img");Ya.src=Td.a.Gsa("doughperson_white_glyph.svg");Ya.setAttribute("Unselectable","on");Jd.a.jh(Ya,Jd.a.Hd,Jd.a.Gs);return Bc.createClusteredImageFromClusterWithImageClass(this.xhb,this.xhb,null,null,R.OBh,"",!1,"",this.element.ownerDocument,Ya)};R.prototype.dAg=function(Ya,h,lb){h=void 0===
h?!1:h;lb=void 0===lb?0:lb;if(!this.syb(this.state)||!this.syb(Ya))switch(Sys.UI.DomElement.removeCssClass(this.element,this.AFc),this.state){case 4:3===Ya?this.xga(R.gad,R.lTe):this.syb(Ya)&&this.xga(R.ead,R.lTe);break;case 3:4===Ya?this.xga(R.jad,R.kTe):this.syb(Ya)&&(h&&this.aOf(),this.xga(R.ead,R.kTe,h?R.NBh:""));break;case 0:case 1:case 2:4===Ya?this.xga(R.jad,R.had):3===Ya&&(h&&this.BAg(),this.xga(R.gad,R.had,h?R.mTe:"",3===lb?R.RBh:R.PBh));break;default:4===Ya?this.xga(R.jad):3===Ya?this.xga(R.gad):
this.syb(Ya)&&this.xga(R.ead)}};R.prototype.xga=function(Ya){for(var h=[],lb=0;lb<arguments.length;++lb)h[lb-0]=arguments[lb];this.AFc=h.join(" ");Sys.UI.DomElement.addCssClass(this.element,this.AFc)};R.prototype.BAg=function(){var Ya=this;this.e5d=window.setTimeout(function(){Ya.element&&(Ya.Mpa=Ya.element.cloneNode(!0),Ya.element.parentNode.appendChild(Ya.Mpa),Ya.element.style.zIndex="2",Ya.Mpa.style.zIndex="1")},300)};R.prototype.aOf=function(){var Ya=this;window.clearTimeout(this.e5d);this.Mpa&&
(Sys.UI.DomElement.removeCssClass(this.Mpa,R.had+" "+R.mTe),Sys.UI.DomElement.addCssClass(this.Mpa,R.MBh),Ob.Task.delay(300).continueWith(function(){Ya.element&&Ya.element.parentNode===Ya.Mpa.parentNode&&Ya.element.parentNode.removeChild(Ya.Mpa)}),ad.a.MHb(this.element,"z-index"))};R.prototype.syb=function(Ya){return 0===Ya||1===Ya||2===Ya};R.prototype.F4h=function(Ya,h){var lb=ad.a.YC(this.element.style.top);return ad.a.YC(this.element.style.left)===Ya&&lb===h};R.prototype.TJd=function(Ya){3===Ya&&
ad.a.O2(this.element,"left")?(Ya=ad.a.YC(this.element.style.left),ad.a.MHb(this.element,"left"),this.element.style.right=-1*Ya+"px"):4===Ya&&ad.a.O2(this.element,"right")&&(Ya=ad.a.YC(this.element.style.right),ad.a.MHb(this.element,"right"),this.element.style.left=-1*Ya+"px")};Mf.Object.defineProperties(R.prototype,{user:{configurable:!0,enumerable:!0,get:function(){return this.Mhe}},state:{configurable:!0,enumerable:!0,get:function(){return this._state}}});R.LBh="prModernFlyout UIFont";R.jad="flyoutIdle";
R.gad="flyoutExpanded";R.ead="flyoutCollapsed";R.lTe="flyoutFromIdle";R.kTe="flyoutFromExpanded";R.had="flyoutFromCollapsed";R.mTe="flyoutStacked";R.NBh="flyoutFromStacked";R.MBh="flyoutFadeOut";R.OBh="cui-img-cont-float cui-img-20by20";R.PBh="flyoutLtrDir";R.RBh="flyoutRtlDir";Object(zb.a)(R,"ModernPresenceTooltipFlyoutControl",ea,[]);Object(zb.a)(ka,"FlyoutsPositioningInfo",null,[]);var Wd=b(39);P.prototype.vQh=function(Ya,h,lb,Ub,zc){var vc=zc.y,ud=zc.height,Gd=this.KIh(Ub),od=Gd+h,Ae=Ya*lb+2*
(Ya-1);lb=null;1===Ya||this.NTg(Gd,Ae,vc,ud)?Ya=new ka(0,0,2):(Ya=this.U$c(od,Ae,vc,ud),Ya.offsetTop-=Gd);this.XHc?lb=new ka(0,0,void 0,this.Vi?4:3):(Ub=this.JIh(Ub,zc),Gd=Math.max(0,zc.x),zc=zc.width,h=Ub+h,this.OTg(Ub,Gd,zc)?lb=new ka(0,0,void 0,this.Vi?3:4):this.PTg(h,Gd)&&(lb=new ka(0,0,void 0,this.Vi?4:3)),lb||(lb=this.$Ah(Ub,h,Gd,zc)));return new ka(Ya.offsetTop,lb.offsetLeft,Ya.Oeg,lb.o7e)};P.prototype.KIh=function(Ya){return Wd.a.IIh(Ya)};P.prototype.JIh=function(Ya,h){return this.Vi?h.width-
Wd.a.HIh(Ya):Wd.a.GIh(Ya)};P.prototype.NTg=function(Ya,h,lb,Ub){return Ya+h<=lb+Ub};P.prototype.U$c=function(Ya,h,lb,Ub){var zc=1,vc=Math.max(lb,Ya-h);h>Ya-lb&&(zc=2,vc=h<Ub?Ub-h:lb);return new ka(vc,0,zc)};P.prototype.OTg=function(Ya,h,lb){return Ya+150<=h+lb};P.prototype.PTg=function(Ya,h){return 150<=Ya-h};P.prototype.$Ah=function(Ya,h,lb,Ub){Ub-h>=Ya-lb?Ya=4:(h=Ya,Ya=3);return new ka(0,h,void 0,Ya)};Object(zb.a)(P,"ModernPresenceTooltipPositioner",null,[]);Q.prototype.update=function(Ya,h){if(3!==
Ya)if(5!==Ya&&this.xL&&this.xL.length){if(4===Ya){var lb=this.Cpg;var Ub=(this.qXa-lb)/2;this.element.style.height=this.qXa+"px";this.element.style.width=this.qXa+"px";Ya=ad.a.YC(this.xL[0].element.style.top);h=ad.a.YC(this.ZI?this.xL[0].element.style.right:this.xL[0].element.style.left)}else lb=this.z2d,Ub=(this.qXa-lb)/2,this.element.style.height=this.qXa+"px",this.element.style.width=this.cKh()+2*Ub+"px",Ya=ad.a.YC(this.xL[this.xL.length-1].element.style.top),h=this.lTg(this.xL[this.xL.length-
1].element,lb,h);ad.a.oRa(this.element,"border-radius",this.qXa+"px");this.element.style.top=Ya-Ub-lb+"px";this.ZI?this.element.style.right=h-Ub+"px":this.element.style.left=h-Ub+"px";this.element.parentNode||this._parent.insertBefore(this.element,this._parent.firstChild)}else this.element.parentNode&&this.element.parentNode.removeChild(this.element)};Q.prototype.lTg=function(Ya,h,lb){return this.ZI&&!lb?ad.a.YC(Ya.style.right):this.ZI||lb?this.ZI&&lb?-ad.a.YC(Ya.style.left)-h:-ad.a.YC(Ya.style.right)-
h:ad.a.YC(Ya.style.left)};Q.prototype.cKh=function(){return this.xL&&this.xL.length?this.z2d+Math.min(this.xL.length-1,2)*this.Ilg:0};Mf.Object.defineProperties(Q.prototype,{element:{configurable:!0,enumerable:!0,get:function(){return this._element}}});Object(zb.a)(Q,"ModernPresenceTooltipTarget",null,[]);var bf=b(167);Rk(C,ea);C.prototype.rUc=function(Ya){this.addHandler(ca.aka,Ya)};C.prototype.isc=function(Ya){this.removeHandler(ca.aka,Ya)};C.prototype.dispose=function(){if(this.Rbf)this.UNc=!0;
else{if(this.IJ)for(var Ya=bk(this.IJ),h=Ya.next();!h.done;h=Ya.next())h=h.value,h.isc(Object(Fb.a)(this,this.p9a,"onInteractivityChanged")),Dc.a.Ia(h);this.xL=null;this.iA.Ba(qd.a.pointerDown,this.Tpa.element,Object(Fb.a)(this,this.m9a,"onHitTarget"));this.iA.Ba(qd.a.pointerOver,this.Tpa.element,Object(Fb.a)(this,this.m9a,"onHitTarget"));this.iA.Ba(qd.a.pointerOut,this.Tpa.element,Object(Fb.a)(this,this.m9a,"onHitTarget"));ea.prototype.dispose.call(this)}};C.prototype.UW=function(){this.RGa();this.visible=
!0};C.prototype.Jda=function(){this.visible=!0;this.zQe();this.kDa=!0};C.prototype.hide=function(){this.qOf();this.E6e();this.Tpa.update(this.iBa,this.NWa)};C.prototype.gYa=function(Ya){var h=this.iBa,lb=this.kDa;Ya.clientId||(Ya.clientId=(C.q7d++).toString());if(Ya.clientId in this.USb){var Ub=this.Ctb(Ya.clientId);if(0<=Ub){Ub=this.oA[Ub];if(Ub.color===Ya.color&&Ub.userName===Ya.userName)return;this.Mab(Ya.clientId)}}this.hide();Ub=new R(this.createElement("div"),this.he);Ub.rUc(Object(Fb.a)(this,
this.p9a,"onInteractivityChanged"));this.gfa.insertBefore(Ub.element,this.gfa.firstChild);this.USb[Ya.clientId]=Ub;Array.add(this.oA,Ya);Array.add(this.IJ,Ub);this.hdg(h,lb);this.visible=!0};C.prototype.Mab=function(Ya){if(this.Rbf)Array.add(this.Fib,Ya);else{var h=this.iBa,lb=this.kDa;this.hide();this.DOf(Ya);this.hdg(h,lb)}};C.prototype.w8a=function(Ya){var h=this.Ctb(Ya);if(!(0>=h)){var lb=this.oA[h];Ya=this.USb[Ya];Array.removeAt(this.oA,h);Array.insert(this.oA,0,lb);Array.removeAt(this.IJ,h);
Array.insert(this.IJ,0,Ya);this.gfa.removeChild(Ya.element);this.gfa.appendChild(Ya.element);this.RGa()}};C.prototype.hdg=function(Ya,h){0>=this.oA.length?this.hide():3===Ya&&h?this.Jda():this.UW()};C.prototype.MKb=function(Ya,h){h?this.Bzg(Ya):this.HNf(Ya)};C.prototype.nna=function(Ya){Ya!==this.aTb&&(this.aTb=Ya,this.pOd(Ya))};C.prototype.position=function(Ya,h){this.element.style.top=h+"px";this.element.style.left=Ya+"px"};C.prototype.RGa=function(Ya){if(void 0===Ya||!Ya||this.O8){this.aTb&&this.pOd(!0);
var h=Math.min(3,this.Nia)-1;Ya=0;var lb=1,Ub=0;this.NWa&&(Ya=this.bgb,lb=-1,Ub=-this.dsa);for(var zc=this.Nia-1;zc>h;zc--)this.IJ[zc].a2f(this.oA[zc],-4*h*lb+Ub,!0,!1,!0,Ya);for(;0<=h;h--)this.IJ[h].a2f(this.oA[h],-4*h*lb+Ub,0<h,Array.contains(this.Gea,this.oA[h].clientId),h!==this.NTb,Ya);this.NTb=0;this.Tpa.update(0,this.NWa);this.zIndex=this.Trb;this.kDa=!1;this.qOf(0);this.UNc&&this.dispose()}};C.prototype.zQe=function(){this.aTb&&this.pOd(!1);this.zIndex=this.Trb+1;var Ya=this.wqj();var h=Ya.offsetX;
var lb=Ya.offsetY;Ya=Ya.n7e;for(var Ub=0;Ub<this.Nia;Ub++)this.IJ[Ub].Uyj(this.oA[Ub],h,lb+(this.dsa+2)*Ub,Ub!==this.NTb,Ya)};C.prototype.E6e=function(){var Ya=0,h=0;this.NWa&&(Ya=this.bgb,h=-6);for(var lb=0;lb<this.Nia;lb++)this.IJ[lb].hide(this.oA[lb],h,Ya);this.zIndex=this.Trb;this.visible=this.kDa=!1;this.UNc&&this.dispose()};C.prototype.t0c=function(Ya){var h=this;(Ya=void 0===Ya?0:Ya)?(this.O8=!0,Ob.Task.delay(Ya).continueWith(function(){h.F6d?h.X5h():h.RGa(!0);h.O8=!1})):this.F6d?this.hide():
this.RGa()};C.prototype.X5h=function(){this.O8&&this.hide()};C.prototype.RNg=function(){if(Wa.AFrameworkApplication.ta&&Wa.AFrameworkApplication.ta.Qa.lz&&bf.c()){var Ya=appChrome.selectors.getShyState();return Ya.isActive&&0!==Ya.state}return!1};C.prototype.p9a=function(Ya,h){var lb=this;Ya=this.iBa;this.RNg()||2!==h.type&&(4!==h.type||3===Ya)?4===h.type&&3===Ya?(this.O8&&(this.O8=!1),this.t0c()):3!==h.type||3!==Ya||this.kDa||(1<this.Nia?(this.O8=!0,Ob.Task.delay(250).continueWith(function(){lb.RGa(!0);
lb.O8=!1})):this.t0c()):(this.O8&&(this.O8=!1),3!==Ya&&(this.zQe(),3===h.atb.lb&&this.t0c(2E3)));this.raiseEvent(ca.aka,h)};C.prototype.m9a=function(Ya){3===Ya.lb?this.p9a(this,new ca(4,Ya)):Ya.eventName===qd.a.pointerOver?this.p9a(this,new ca(2,Ya)):Ya.eventName===qd.a.pointerOut&&this.p9a(this,new ca(3,Ya));return!1};C.prototype.woj=function(Ya){this.element.style.width=Ya+"px";this.element.style.height=this.dsa+"px"};C.prototype.DOf=function(Ya){this.HNf(Ya);Ya=this.Ctb(Ya);if(!(0>Ya)){var h=this.oA[Ya];
Array.removeAt(this.oA,Ya);delete this.USb[h.clientId];h=this.IJ[Ya];this.gfa.removeChild(h.element);this.he.get(18,!1)&&h.isc(Object(Fb.a)(this,this.p9a,"onInteractivityChanged"));Array.removeAt(this.IJ,Ya);h.dispose()}};C.prototype.qOf=function(Ya){Ya=void 0===Ya?5:Ya;if(this.Fib.length){this.visible&&this.E6e();for(var h=0;h<this.Fib.length;h++)this.DOf(this.Fib[h]);Array.clear(this.Fib);0>=this.oA.length||5===Ya?this.hide():0===Ya&&this.UW()}};C.prototype.Ctb=function(Ya){for(var h=0;h<this.oA.length;h++)if(this.oA[h].clientId===
Ya)return h;return-1};C.prototype.Bzg=function(Ya){if(-1===this.Ctb(Ya))Yb.ULS.sendTraceTag(41706451,302,15,"Cannot set active editor because client id is invalid");else{if(Array.contains(this.Gea,Ya)){if(this.oA[0].clientId===Ya)return;Array.remove(this.Gea,Ya)}Array.add(this.Gea,Ya);this.w8a(Ya);1!==this.iBa&&this.RGa()}};C.prototype.HNf=function(Ya){-1===this.Ctb(Ya)?Yb.ULS.sendTraceTag(41706452,302,50,"Cannot remove active editor because client id is invalid"):Array.contains(this.Gea,Ya)&&(Array.remove(this.Gea,
Ya),this.oA[0].clientId===Ya&&0<this.Gea.length&&this.w8a(this.Gea[this.Gea.length-1]),this.oA[0].clientId===Ya&&1===this.iBa&&this.RGa())};C.prototype.pOd=function(Ya){Ya?Sys.UI.DomElement.addCssClass(this.gfa,"prBackgroundSelection"):Sys.UI.DomElement.removeCssClass(this.gfa,"prBackgroundSelection")};C.prototype.wqj=function(){var Ya;var h=Ya=0;var lb=this.bgb;if(this.gie){var Ub=this.gie(this);if(!Ub)return{offsetX:Ya,offsetY:h,n7e:lb};var zc=4===this.iBa;lb=this.wtg.vQh(this.Nia,zc?6:this.dsa,
this.dsa,this.element,Ub);h=lb.offsetTop;this.NTb=this.GPh(lb.Oeg,lb.offsetTop);lb=lb.o7e;lb!==this.bgb&&(this.TJd(lb),this.element.dir=3===lb?"rtl":"ltr",this.bgb=lb);lb!==this.pXe()?(Ya=this.Atg?-2:zc?-6:-this.dsa,this.NWa=!0):this.NWa=!1}return{offsetX:Ya,offsetY:h,n7e:lb}};C.prototype.GPh=function(Ya,h){if(1===Ya)return this.Nia-1;Ya=Math.abs(h);return 0<Ya?Ya/(this.dsa+2):0};C.prototype.TJd=function(Ya){for(var h=0;h<this.Nia;h++)this.IJ[h].TJd(Ya)};C.prototype.pXe=function(){return this.Vi?
3:4};C.VEh=function(){return String.format("{0}-{1}","presencetooltip",C.q7d++)};Mf.Object.defineProperties(C.prototype,{Qpc:{configurable:!0,enumerable:!0,get:function(){return ab.a.clone(this.oA)}},IJ:{configurable:!0,enumerable:!0,get:function(){return this.xL}},Trb:{configurable:!0,enumerable:!0,get:function(){return this.Mmg}},Nia:{configurable:!0,enumerable:!0,get:function(){return this.IJ?this.IJ.length:0}},iBa:{configurable:!0,enumerable:!0,get:function(){return 0<this.Nia?this.IJ[0].state:
5}},Rbf:{configurable:!0,enumerable:!0,get:function(){return 3===this.iBa&&!this.kDa}}});C.q7d=0;Object(zb.a)(C,"ModernPresenceTooltipControl",ea,[389,3]);var ke=b(233),cf=b(367),Pe=b(245);M.prototype.N4g=function(){var Ya=document.createElement("div");this.he.eYa(15,!1);return new C(Ya,20,this.he)};Object(zb.a)(M,"ModernPresenceTooltipFactory",null,[390]);var nc=b(264),Da=b(19),Sb=b(60),hb=b(179),Xb=b(12),jc=b(34),Wc=b(359),fd;(function(Ya){Ya[Ya.none=0]="none";Ya[Ya.master=1]="master";Ya[Ya.fixed=
2]="fixed";Ya[Ya.horizontal=3]="horizontal";Ya[Ya.vertical=4]="vertical";Ya[Ya.first=1]="first";Ya[Ya.last=4]="last"})(fd||(fd={}));Object(zb.b)("PaneType",fd);var Tc=Kb.a;Rk(K,Tc);K.prototype.rUc=function(Ya){this.addHandler("interactivityChanged",Ya)};K.prototype.isc=function(Ya){this.removeHandler("interactivityChanged",Ya)};K.prototype.dispose=function(){if(0<this.Eh.count){this.hide();var Ya=this.Eh.Zt,h;for(h in Ya)Ya[h].dispose()}this.gridView=null;this.Eh.clear();Tc.prototype.dispose.call(this)};
K.prototype.orj=function(Ya){this.uGf=Ya};K.prototype.UW=function(){var Ya=this.Eh.Zt,h;for(h in Ya)Ya[h].UW()};K.prototype.Jda=function(){this.Yid();var Ya=this.Eh.Zt,h;for(h in Ya)Ya[h].Jda()};K.prototype.hide=function(){this.gTa();var Ya=this.Eh.Zt,h;for(h in Ya)Ya[h].hide()};K.prototype.gYa=function(Ya){var h=this.Eh.Zt,lb;for(lb in h)h[lb].gYa(Ya)};K.prototype.w8a=function(Ya){var h=this.Eh.Zt,lb;for(lb in h)h[lb].w8a(Ya)};K.prototype.Mab=function(Ya){var h=this.Eh.Zt,lb;for(lb in h)h[lb].Mab(Ya)};
K.prototype.MKb=function(Ya,h){var lb=this.Eh.Zt,Ub;for(Ub in lb)lb[Ub].MKb(Ya,h)};K.prototype.nna=function(Ya){this.Xnd!==Ya&&(this.Xnd=Ya,Ya=jc.a.yc(this.Eh.Zt,Enum.toString(fd,K.oKa()[0])),this.Pya&&Ya&&(Ya=Xb.DOMElementExtensions.getWidth(Ya.element)/2,this.position(this.Xnd?this.Pya.x+14+Ya:this.Pya.x-14-Ya,this.Pya.y)))};K.prototype.position=function(Ya,h){var lb=this.Eh.Zt,Ub;for(Ub in lb){var zc=lb[Ub],vc=Enum.parse(fd,Ub);vc=this.gridView.Cf(vc);var ud=N(vc,new Sys.UI.Point(Ya,h),!1);this.Pya=
new Sys.UI.Point(Ya,h);0>ud.x&&(ud.x+=vc.domElement.scrollLeft);Xb.DOMElementExtensions.updatePosition(zc.element,ud.x,ud.y,!1,this.rtl)}};K.prototype.Yid=function(){this.Pya&&(this.position(this.Pya.x,this.Pya.y),this.PLd||(this.PLd=!0,this.gridView.Ea.uG(this.rz),this.gridView.Ea.Ds(this.rz),this.gridView.view.Es(this.nF)))};K.prototype.gTa=function(){this.PLd&&(this.gridView.Ea.YH(this.rz),this.gridView.Ea.Dq(this.rz),this.gridView.view.Fq(this.nF))};K.oKa=function(){return K.L9||(K.L9=[1,3,2,
4])};Mf.Object.defineProperties(K.prototype,{element:{configurable:!0,enumerable:!0,get:function(){return null}},Qpc:{configurable:!0,enumerable:!0,get:function(){var Ya=jc.a.yc(this.Eh.Zt,Enum.toString(fd,K.oKa()[0]));return Ya?Ya.Qpc:null}},hZi:{configurable:!0,enumerable:!0,get:function(){return this.uGf}}});K.L9=null;Object(zb.a)(K,"PaneInvariantTooltip",Kb.a,[389,3]);H.rLb=!1;H.Cna=!1;Object(zb.a)(H,"PresenceViewSettings",null,[]);J.prototype.dispose=function(){this.gTa();this.clearCache();this.$&&
this.$.va&&this.$.va.vg(this.vya);this.gridView=null};J.prototype.gTa=function(){this.Dhc&&(this.gridView.Ea.YH(this.rz),this.gridView.Ea.Dq(this.rz),this.gridView.view.Fq(this.nF),this.Dhc=!1)};J.prototype.aOj=function(Ya){var h=this.pz[Ya],lb=this.Qaa(Ya);h&&this.$Nf(h);lb&&this.Rrc(lb,h.Vya.clientId,h.ty);delete this.ATa[Ya];delete this.pz[Ya];delete this.zTa[Ya]};J.prototype.fYd=function(Ya){var h=Ya.ty;this.pz[h]||(this.Q4a(Ya),this.pz[h]=Ya)};J.prototype.OXd=function(Ya){this.aD=Ya;this.kPi(Ya)};
J.prototype.nTj=function(Ya){var h=Ya.ty,lb=this.Z_e(Ya.Ppc,Ya.paneType,Ya.range),Ub=this.Qaa(h);lb&&lb!==Ub&&(Ya.sMb(lb),this.ATa[h]=lb,this.pz[h]=Ya,this.zTa[h]&&lb.nna(this.zTa[h]));Ub!==lb&&Ub&&this.Rrc(Ub,Ya.Vya.clientId,Ya.ty);!this.Dhc&&this.gridView&&(this.gridView.Ea.uG(this.rz),this.gridView.Ea.Ds(this.rz),this.gridView.view.Es(this.nF),this.Dhc=!0)};J.prototype.Rrc=function(Ya,h,lb){Ya.Mab(h);Za.EwaSettings.isChangeGateEnabled("OfficeVSO:3663630_ModernPresenceUxPerf")&&this.Qaa(lb)===Ya&&
delete this.ATa[lb];Ya.Qpc&&Ya.Qpc.length||((h=Ya.hZi)&&delete this.lGb[h],Za.EwaSettings.isChangeGateEnabled("OfficeVSO:3663630_ModernPresenceUxPerf")||this.Qaa(lb)===Ya&&delete this.ATa[lb],Ya.dispose())};J.prototype.$Nf=function(Ya){Ya&&(Ya.lId(this.pEb),Ya.MId(this.TEb),Ya.LId(this.SEb),Ya.sMb(null))};J.prototype.Q4a=function(Ya){Ya.pUc(this.pEb);Ya.OUc(this.TEb);Ya.NUc(this.SEb)};J.prototype.ry=function(Ya,h){if(H.Cna){h.sua||this.fYd(h);this.nTj(h);var lb=this.Qaa(h.ty);lb&&(lb.gYa(h.Vya),this.aD===
h.ty&&lb.w8a(h.ty),h.YLa()?Ya?lb.Jda():lb.UW():lb.hide())}};J.prototype.kPi=function(Ya){var h=this.Qaa(Ya);nc.a(function(){null===h||void 0===h?void 0:h.w8a(Ya)},this.$.la)};J.prototype.Qaa=function(Ya){return this.ATa[Ya]};J.prototype.Z_e=function(Ya,h,lb){if(!Ya)return null;Ya=this.Qdd(Ya,h,lb);var Ub=this.gridView.Cf(h).Bq;h=J.BTh(Ya,h,Ub).toString();Ub=jc.a.yc(this.lGb,h);Ub||(Ub=new K(this.gridView,this.BDd,lb),Ub.position(Ya.x,Ya.y),Ub.orj(h),this.lGb[h]=Ub);return Ub};J.prototype.Qdd=function(Ya,
h,lb){var Ub=this.gridView.Cf(h).fn,zc=this.gridView.Cf(h).Bq;h=Wc.a.AM(h,Ub.topLeft);var vc=Math.max(zc.x,Ya.x-this.Qva/2-2);vc=Math.min(Math.max(h.x+zc.x,vc),h.x+zc.x+Ub.width-this.Qva);Ya=Math.max(zc.y,Ya.y-this.Qva/2+1);Za.EwaSettings.isChangeGateEnabled("OfficeVSO:5703071_toolTipOnRightForFirstRow")&&(h.y+zc.y>Ya||this.aKj(lb))&&(vc=Math.min(vc+this.Qva/4,h.x+zc.x+Ub.width-this.Qva));Ya=Math.min(Math.max(h.y+zc.y,Ya),h.y+zc.y+Ub.height-this.Qva);return new Sys.UI.Point(vc,Ya)};J.prototype.clearCache=
function(){var Ya=this.pz,h;for(h in Ya)this.$Nf(Ya[h]);Ya=this.lGb;for(var lb in Ya)Ya[lb].dispose();this.ATa={};this.pz={};this.lGb={};this.zTa={};Dc.a.Ia(this.yoa);this.yoa=null};J.prototype.Yqb=function(){var Ya=new wa;Ya.add(0,Da.a.H8c);Ya.add(1,this.Z7e);Ya.add(12,49);Ya.add(6,this.Qva);this.gridView&&(Ya.add(4,Aa.a.Se(3)),Ya.add(5,Aa.a.Se(3)),Ya.add(8,this.gridView.rtl));Ya.add(18,!0);this.BDd=new M(Ya);Ya.add(16,this.WZh)};J.prototype.iSj=function(Ya){var h=new wa;h.add(0,Da.a.H8c);h.add(1,
this.Z7e);h.add(12,Number.parseInvariant(Ya.toString()));h.add(6,this.Qva);this.gridView&&(h.add(4,Aa.a.Se(3)),h.add(5,Aa.a.Se(3)),h.add(8,this.gridView.rtl));this.BDd=new M(h)};J.prototype.sTj=function(Ya){this.iSj(Ya)};J.prototype.idg=function(){H.Cna&&(this.yoa=hb.AsyncMethodContext.Ms(this.kTj,100,Kd.a.w_i,this.yoa))};J.prototype.j5e=function(Ya,h){H.Cna&&(this.zTa[h.ty]&&Ya.nna(this.zTa[h.ty]),h.YLa()?h.Dna(!0,!0):h.Dna(!1,!0))};J.prototype.nna=function(Ya,h){this.zTa[Ya]=h;(Ya=this.Qaa(Ya))&&
Ya.nna(h)};J.prototype.MKb=function(Ya,h){var lb=this.Qaa(Ya);lb&&lb.MKb(Ya,h)};J.BTh=function(Ya,h,lb){return Ya.x.toString()+"-"+Ya.y.toString()+"-"+h.toString()+"-"+lb.x.toString()+"-"+lb.y.toString()};J.prototype.aKj=function(Ya){var h;Ya=Ie.g(this.$).Ea.Eua(Ya.topRight);return null===(h=null===Ya||void 0===Ya?void 0:Ya[0])||void 0===h?void 0:h.Ava};Object(zb.a)(J,"PresenceTooltipManager",null,[3]);var td=b(105),Tb=b(117),Fa=Kb.a;Rk(U,Fa);U.prototype.pUc=function(Ya){this.addHandler("hidePresenceTooltip",
Ya)};U.prototype.lId=function(Ya){this.removeHandler("hidePresenceTooltip",Ya)};U.prototype.OUc=function(Ya){this.addHandler("showPresenceTooltip",Ya)};U.prototype.MId=function(Ya){this.removeHandler("showPresenceTooltip",Ya)};U.prototype.NUc=function(Ya){this.addHandler("showFullPresenceTooltip",Ya)};U.prototype.LId=function(Ya){this.removeHandler("showFullPresenceTooltip",Ya)};U.prototype.BFa=function(Ya){this.addHandler("presenceChanged",Ya)};U.prototype.Bza=function(Ya){this.removeHandler("presenceChanged",
Ya)};U.prototype.dispose=function(){this.raiseEvent("hidePresenceTooltip");this.raiseEvent("presenceChanged");this.Uxe();this.gTa();Dc.a.Ia(this.dob);this.lhe=this.domElement=this.gridView=null;Fa.prototype.dispose.call(this)};U.prototype.JRd=function(Ya,h){var lb=!!Ya&&!Pb.D(Ya).equals(Pb.D(this.Uw)),Ub=!!h&&(!this.Sg||this.Sg.get_id()!==h.get_id());if(lb||Ub)this.raiseEvent("presenceChanged"),this.Uxe(),this.sua=!1,this.Uw=Ya,this.Sg=h,this.eBb=null};U.prototype.u4=function(Ya){this.visible=this.sua=
!1;Ya&&this.raiseEvent("hidePresenceTooltip")};U.prototype.zga=function(Ya){this.Nx.push(Ya);this.k7e();Ya.BFa(this.Mzd)};U.prototype.Dna=function(Ya,h){Ya?(this.visible=!0,h&&(this.dob=hb.AsyncMethodContext.Ms(this.TAj,this.$.ya.ShowTooltipDelayInMs,Kd.a.eKj,this.dob))):this.u4(h)};U.prototype.sMb=function(Ya){this.lhe=Ya};U.prototype.Heb=function(){if(this.domElement&&this.visible){this.SZa=Xb.DOMElementExtensions.getBoundingClientRect(this.domElement);var Ya=Math.floor(this.SZa.x);this.SZa.x=Ya===
this.SZa.x?Ya:Ya+1;this.SZa.y=Math.floor(this.SZa.y)}};U.prototype.YLa=function(){if(!this.Uw)return!1;if(Za.EwaSettings.ma(683)){var Ya=this.JTh();return Ya?this.gridView.Aki(Ya,this.paneType):!1}Ya=this.gridView.Cf(this.paneType).fn;var h=this.gridView.fg(this.range,this.paneType);return Ya.xd(h)};U.prototype.JTh=function(){if(this.range.isSingle){var Ya=this.gridView.Ea.Zua(this.range,this.$.activeItemName);return Ya?(Ya=Ya.Kr(this.range))?Ya.EE:null:null}return this.range};U.prototype.Uxe=function(){for(var Ya=
0,h=this.Nx.length;Ya<h;Ya++)this.Nx[Ya].Bza(this.Mzd);Array.clear(this.Nx);this.gTa()};U.prototype.k7e=function(){!this.Chc&&1<=this.Nx.length&&(this.Chc=!0,this.gridView.Ea.uG(this.rz),this.gridView.Ea.Ds(this.rz),this.gridView.view.Es(this.nF))};U.prototype.gTa=function(){this.Chc&&!this.Nx.length&&(this.Chc=!1,this.gridView&&(this.gridView.Ea.YH(this.rz),this.gridView.Ea.Dq(this.rz),this.gridView.view.Fq(this.nF)))};U.prototype.Mab=function(Ya){Ya.Bza(this.Mzd);Array.remove(this.Nx,Ya);this.gTa()};
U.prototype.tbg=function(){this.Heb();for(var Ya=0,h=this.Nx.length;Ya<h;Ya++)this.Nx[Ya].Heb()};Mf.Object.defineProperties(U.prototype,{ty:{configurable:!0,enumerable:!0,get:function(){return this.NRc}},Vya:{configurable:!0,enumerable:!0,get:function(){return this.hOc}},paneType:{configurable:!0,enumerable:!0,get:function(){return this.Dqa}},Ppc:{configurable:!0,enumerable:!0,get:function(){if(!this.domElement)return null;var Ya=this.gridView.Cf(this.paneType).fn,h=this.gridView.rtl,lb=this.domElement.offsetWidth;
if(!this.Sg&&4>=lb){if(this.Uw){lb=this.gridView.Ug;var Ub=this.Uw.FirstRow;h=h?this.Uw.FirstColumn:this.Uw.LastColumn;if(lb&&!(Ub>=lb.top&&Ub<=lb.bottom&&h>=lb.left&&h<=lb.right))return Ub=Ub<=lb.top?Ya.y:Ya.y+(Ub>=lb.bottom?Ya.height:Ya.height/2),h=h<=lb.left?Ya.x:Ya.x+(h>=lb.right?Ya.width:Ya.width/2),this.eBb=new Sys.UI.Point(h,Ub)}return this.eBb}if(this.Sg){Ya=this.domElement.offsetTop-2;Ub=parseInt(this.domElement.style.left,10);var zc=0;h&&(zc=parseInt(this.domElement.parentNode.style.width,
10)-lb-Ub,zc-=this.gridView.LR.DMa&&this.gridView.LR.Bqd?Tb.a.ev:0);return this.eBb=new Sys.UI.Point((h?zc:Ub)+lb+4,Ya)}return this.eBb=new Sys.UI.Point(parseInt(h?this.domElement.style.right:this.domElement.style.left,10)+lb,this.domElement.offsetTop)}},range:{configurable:!0,enumerable:!0,get:function(){return Pb.D(this.Uw)}}});Object(zb.a)(U,"TooltipNotificationUnit",Kb.a,[895,3]);var Qb=Kb.a;Rk(O,Qb);O.prototype.pUc=function(Ya){this.addHandler("hidePresenceTooltip",Ya)};O.prototype.lId=function(Ya){this.removeHandler("hidePresenceTooltip",
Ya)};O.prototype.OUc=function(Ya){this.addHandler("showPresenceTooltip",Ya)};O.prototype.MId=function(Ya){this.removeHandler("showPresenceTooltip",Ya)};O.prototype.NUc=function(Ya){this.addHandler("showFullPresenceTooltip",Ya)};O.prototype.LId=function(Ya){this.removeHandler("showFullPresenceTooltip",Ya)};O.prototype.BFa=function(Ya){this.addHandler("presenceChanged",Ya)};O.prototype.Bza=function(Ya){this.removeHandler("presenceChanged",Ya)};O.prototype.dispose=function(){this.raiseEvent("hidePresenceTooltip");
this.raiseEvent("presenceChanged");this.vw&&this.vw.aOj(this.ty);var Ya=this.pz,h;for(h in Ya){var lb=Ya[h];lb.lId(this.pEb);lb.MId(this.TEb);lb.LId(this.SEb);lb.Bza(this.IEb);lb.dispose()}this.vw=this.gb=this.highlight=this.gridView=this.pz=null;Qb.prototype.dispose.call(this)};O.prototype.E3f=function(Ya,h,lb){lb=void 0===lb?null:lb;Ya?(this.gb=Pb.D(Ya),this.Dqa=this.gridView.eb.dj(this.gb.topRight)):lb?(this.Sg=lb,this.Dqa=lb.ag.paneType):this.Dqa=1;this.kje=h;this.eva(this.paneType);this.JRd(Ya,
lb)};O.prototype.JRd=function(Ya,h){var lb=this.pz,Ub;for(Ub in lb)lb[Ub].JRd(Ya,h)};O.prototype.u4=function(Ya){this.eva(this.paneType).u4(Ya);Ya=this.pz;for(var h in Ya)Ya[h].u4(!1)};O.prototype.Xke=function(Ya){var h=this.pz,lb;for(lb in h){var Ub=h[lb];Ub.zga(Ya.eva(Ub.paneType))}};O.prototype.zga=function(Ya){this.eva(Ya.paneType).zga(Ya)};O.prototype.YLa=function(){var Ya=this.eva(this.paneType).YLa(),h=this.pz,lb;for(lb in h)Ya=h[lb].YLa()||Ya;return Ya};O.prototype.Dna=function(Ya,h){this.vw.fYd(this);
this.eva(this.paneType).Dna(Ya,h);h=this.pz;for(var lb in h)h[lb].Dna(Ya,!1)};O.prototype.sMb=function(Ya){var h=this.pz,lb;for(lb in h)h[lb].sMb(Ya)};O.prototype.Heb=function(){var Ya=this.pz,h;for(h in Ya)Ya[h].Heb();this.vw.fYd(this)};O.prototype.eva=function(Ya){return this.JSh(Ya,this.kje)};O.prototype.OXd=function(Ya){this.vw.OXd(Ya)};O.prototype.JSh=function(Ya,h){var lb=this.highlight?this.highlight.cw(h,Ya).mf:this.Sg?this.Sg.get_element():null;h=O.mZh(h,Ya);var Ub=jc.a.yc(this.pz,h);Ub||
(Ub=new U(lb,this.gridView,this.Vya,Ya,this.$),this.pz[h]=Ub,Ub.pUc(this.pEb),Ub.OUc(this.TEb),Ub.NUc(this.SEb),Ub.BFa(this.IEb));return Ub};O.mZh=function(Ya,h){return Ya.toString()+h.toString()};Mf.Object.defineProperties(O.prototype,{ty:{configurable:!0,enumerable:!0,get:function(){return this.NRc}},Vya:{configurable:!0,enumerable:!0,get:function(){return this.hOc}},paneType:{configurable:!0,enumerable:!0,get:function(){return this.Dqa}},range:{configurable:!0,enumerable:!0,get:function(){return this.gb}},
Ppc:{configurable:!0,enumerable:!0,get:function(){return this.gb||this.Sg?N(this.gridView.Cf(this.paneType),this.eva(this.paneType).Ppc,!0):null}},sua:{configurable:!0,enumerable:!0,get:function(){return this.eva(this.paneType).sua},set:function(Ya){var h=this.pz,lb;for(lb in h)h[lb].sua=Ya}}});Object(zb.a)(O,"PaneInvariantTooltipNotificationUnit",Kb.a,[895,3]);T.prototype.dispose=function(){this.gxb();Dc.a.Ia(this.du);this.objectId=this.$=this.hn=this.Sg=null};T.prototype.zga=function(Ya){this.du.Xke(Ya.du)};
T.prototype.gxb=function(){this.Sg&&this.hn&&this.hn.User&&(this.Sg.SAc(!1,this.hn.User.UserID,null),this.du.u4(!0))};T.prototype.ILb=function(){H.rLb&&this.Sg&&this.hn&&this.hn.User&&(this.Sg.SAc(!0,this.hn.User.UserID,this.hn.UserColor),this.du.Heb())};T.prototype.ry=function(Ya){H.Cna&&(this.du.sua=Ya,this.du.Dna(Ya,!0))};T.prototype.RLb=function(Ya,h){this.du.E3f(null,0===h?48:49,Ya)};Mf.Object.defineProperties(T.prototype,{Sg:{configurable:!0,enumerable:!0,get:function(){return this.jDa},set:function(Ya){this.jDa=
Ya;!this.jDa||Za.EwaSettings.isChangeGateEnabled("OfficeVSO:6032771_PresenceToolTipZIndexCheck")&&!this.jDa.wy||this.vw.sTj(this.jDa.wy)}}});Object(zb.a)(T,"FloatingObjectPresenceHighlight",null,[864,3]);var cc=b(722),bc=b(71),Mc=b(11),rd=b(259),Hd=b(163),ic=cc.a;Rk(G,ic);G.prototype.dispose=function(){var Ya;Dc.a.Ia(this.du);ic.prototype.dispose.call(this);var h=G.$_a,lb;for(lb in h){var Ub=lb,zc=h[lb];zc&&!zc.children.length&&(Xb.DOMElementExtensions.ff(zc),G.$_a[Ub]=null)}null===(Ya=G.excelLiveManager)||
void 0===Ya?void 0:Ya.CId(this.JEb);this.ez=null};G.prototype.zga=function(Ya){this.du.Xke(Ya.du)};G.prototype.ry=function(Ya){H.Cna&&(this.Fgc||(this.du.sua=Ya,this.du.Dna(Ya,!0)),this.MLb=Ya&&this.Fgc)};G.prototype.RLb=function(Ya,h){this.du.E3f(Ya,0===h?48:49);this.MLb=!1};G.prototype.ILb=function(Ya){H.rLb&&(this.du.Dna(!0,!0),this.l0d=Ya,this.qn([Ya]))};G.prototype.gxb=function(Ya){this.u4();this.eh(Ya)};G.prototype.UDe=function(Ya,h,lb){lb.className=bc.a.Ith;lb.style.borderColor=this.hn.UserColor;
this.zmd&&lb.classList.add(bc.a.oPe);var Ub=document.createElement("div");48!==Ya&&49!==Ya&&(Ub.style.backgroundColor=this.hn.UserColor);lb.appendChild(Ub);Ub.className=[bc.a.Kth,bc.a.Jth][Ya-48];Ya=jc.a.yc(G.$_a,h.toString());if(!Ya){var zc=this.gridView.Cf(h).domElement;Ya=document.createElement("div");zc.insertBefore(Ya,zc.firstChild);G.$_a[h.toString()]=Ya}Ya.appendChild(lb);this.Pbf&&this.hgh(Ub)};G.prototype.dxb=function(){};G.prototype.LYf=function(Ya,h,lb,Ub){var zc=this.zHg(Ub,Ya,h);rd.c(lb,
this.gridView.rtl,Mc.HelperMethods.jc(zc.x));lb.width=Mc.HelperMethods.jc(zc.width);lb.top=Mc.HelperMethods.jc(zc.y);lb.height=Mc.HelperMethods.jc(zc.height);h=h.mf;lb=h.parentNode;49===Ya?G.aGd(lb,h,!1):48===Ya&&(zc=this.cw(49),Ub.equals(zc.Aic)?G.aGd(lb,h,!1):G.aGd(lb,h,!0));this.rZi(Ya)};G.prototype.l1f=function(){return!1};G.prototype.zHg=function(Ya,h,lb){var Ub=Ya.y+this.dvb(lb,!1);lb=Ya.x+this.dvb(lb,!0)+Tb.a.Cbd(lb.mf.parentNode.parentNode,this.gridView.rtl);var zc=Ya.width;Ya=Ya.height+1;
1>lb&&-1<=lb&&48===h&&(zc-=1-lb,lb=1);1>Ub&&-1<=Ub&&48===h&&(Ya-=1-Ub,Ub=1);zc=Math.max(0,zc-1);Ya=Math.max(0,Ya-2);return new Sb.a(lb,Ub,zc,Ya)};G.prototype.rZi=function(Ya){this.du.Heb();this.l0d=Ya;this.Fgc=!1;this.MLb&&this.ry(!0);this.MLb=!1};G.prototype.u4=function(){this.Fgc||(this.du.u4(!0),this.MLb=!1)};G.aGd=function(Ya,h,lb){lb?h!==Ya.firstChild&&(Ya.removeChild(h),Ya.insertBefore(h,Ya.firstChild)):h!==Ya.lastChild&&(Ya.removeChild(h),Ya.appendChild(h))};G.prototype.hgh=function(Ya){var h;
(null===(h=G.excelLiveManager)||void 0===h?0:h.ROa.aD)?(Yb.ULS.sendTraceTag(521143968,0,50,"PresenceHighlight:Distinct presenter presence called for User:"+this.hn.User.UserID+", Logging presenter information: "+this.Ivb()),this.hn.User.UserID===this.Ivb()&&this.KHe(Ya)):this.ez.push(Ya)};G.prototype.KHe=function(Ya){this.zmd&&this.w9i(Ya);this.Bnd&&this.d6h(Ya);this.Bnd&&this.fki&&this.lSj(Ya)};G.prototype.Tri=function(){var Ya=this;G.excelLiveManager?G.excelLiveManager.xZb(this.JEb):this.$.da.Za(473,
function(h){G.excelLiveManager=h;G.excelLiveManager.xZb(Ya.JEb)})};G.prototype.d6h=function(Ya){var h=this;nc.a(function(){Ya.style.backgroundColor=h.hn.UserColor;Ya.classList.add(bc.a.Pth);Yb.ULS.sendTraceTag(520648066,0,50,"PresenceHighlight:Highlighting presence for User: "+h.hn.User.UserID+", Logging presenter information: "+h.Ivb())},this.$.la)};G.prototype.w9i=function(Ya){nc.a(function(){Ya.parentElement.classList.remove(bc.a.oPe)},this.$.la)};G.prototype.lSj=function(Ya){this.du.OXd(G.excelLiveManager.ROa.aD);
nc.a(function(){Ya.parentElement.classList.add(bc.a.Oth)},this.$.la)};G.prototype.Ivb=function(){return G.excelLiveManager.ROa.aD};G.$_a=null;Object(zb.a)(G,"PresenceHighlight",cc.a,[]);Rk(F,X);F.prototype.dxc=function(){for(var Ya=1===this.kc.PresenceType?49:48,h=0;h<this.gy.length;h++)this.gy[h].ILb(Ya);for(Ya=0;Ya<this.UG.count;Ya++)this.UG.Wf(Ya).ILb()};F.prototype.ydc=function(){for(var Ya=1===this.kc.PresenceType?49:48,h=0;h<this.gy.length;h++)this.gy[h].gxb([Ya]);for(Ya=0;Ya<this.UG.count;Ya++)this.UG.Wf(Ya).gxb()};
F.prototype.dispose=function(){this.$&&(this.$.va&&this.$.va.vg(this.vya),Ie.g(this.$).EK(this.Aq));this.EHe();Dc.a.oc(this.gy);Dc.a.oc([this.Oz]);this.Oz=this.$=null;this.NOd(null);this.UG=null;X.prototype.dispose.call(this)};F.prototype.EHe=function(){if(this.UG){for(var Ya=0;Ya<this.UG.count;Ya++)this.UG.Wf(Ya).dispose();this.UG.clear()}};F.prototype.s_a=function(Ya){1===this.kc.Version?this.uWg(Ya):this.vWg(Ya)};F.prototype.uWg=function(Ya){if(Ya.kc.SelectedRange&&this.kc.SelectedRange)for(var h=
this.kc.SelectedRange.length,lb=Ya.kc.SelectedRange.length,Ub=0;Ub<h;Ub++)for(var zc=0;zc<lb;zc++)if(Ga(this.kc.SelectedRange[Ub],Ya.kc.SelectedRange[zc])){this.gy[Ub].zga(Ya.S3a(zc));return}};F.prototype.vWg=function(Ya){var h,lb=0,Ub=0;if(this.kc&&this.kc.Object&&(null===(h=Ya.kc)||void 0===h?0:h.Object)){h=this.kc.Object.length;for(var zc=Ya.kc.Object.length,vc=0;vc<h;vc++)if(this.kc.Object[vc]&&this.zfd(this.kc.Object[vc])){lb++;for(var ud=0;ud<zc;ud++)if(Ya.kc.Object[ud]&&this.zfd(Ya.kc.Object[ud])&&
(Ub++,this.cWc(this.kc.Object[vc],Ya.kc.Object[ud]))){var Gd=this.S3a(lb),od=Ya.S3a(Ub);if(Gd&&od){Gd.zga(od);return}}}else if(this.kc.Object[vc]&&Ya.kc.Object[vc]&&(0===this.kc.Object[vc].ObjectType||2===this.kc.Object[vc].ObjectType))for(ud=0;ud<zc;ud++)if(Ya.kc.Object[ud]&&(0===Ya.kc.Object[vc].ObjectType||2===Ya.kc.Object[vc].ObjectType)&&this.kc.Object[vc].ObjectId===Ya.kc.Object[ud].ObjectId&&(Gd=this.ldd(this.kc.Object[vc].ObjectId),od=Ya.ldd(this.kc.Object[vc].ObjectId),Gd&&od)){Gd.zga(od);
return}}if(Ya.kc.SelectedRange&&this.kc.SelectedRange)for(h=this.kc.SelectedRange.length,zc=Ya.kc.SelectedRange.length,vc=0;vc<h;vc++)for(ud=0;ud<zc;ud++)if(Ga(this.kc.SelectedRange[vc],Ya.kc.SelectedRange[ud])&&(Gd=this.S3a(lb+vc),od=Ya.S3a(Ub+ud),Gd&&od)){Gd.zga(od);return}};F.prototype.cWc=function(Ya,h){return!!Ya&&!!h&&h.ObjectType===Ya.ObjectType&&(1===Ya.ObjectType||3===Ya.ObjectType)&&!Ya.ObjectId.localeCompare(h.ObjectId)};F.prototype.S3a=function(Ya){return 0<=Ya&&this.gy.length>Ya?this.gy[Ya]:
null};F.prototype.t3f=function(Ya){for(var h=0,lb=this.gy.length;h<lb;h++)this.gy[h].ry(Ya)};F.prototype.ldd=function(Ya){return Ya&&this.UG.kb(Ya)?this.UG.getItem(Ya):null};F.prototype.u3f=function(Ya,h){h=void 0===h?null:h;if(Ya)(Ya=this.UG.getItem(h))&&Ya.ry(!0);else for(Ya=0;Ya<this.UG.count;Ya++)(h=this.UG.Wf(Ya))&&h.ry(!1)};F.prototype.Ccg=function(Ya){X.bSj(this,Ya)};F.prototype.i3c=function(Ya,h){if(Ya<h)return this.gy[Ya];if(!this.hn||!this.$||!this.vw)return null;Ya=new G(this.hn,this.$,
this.vw);this.gy.push(Ya);return Ya};F.prototype.Vpj=function(){for(var Ya=this.gy.length,h=this.kc.SelectedRange?this.kc.SelectedRange.length:0,lb=this.$.va.pa,Ub=0;Ub<h;Ub++){var zc=this.i3c(Ub,Ya);zc&&this.kc.SelectedRange[Ub]&&(this.kc.SelectedRange[Ub].NamedObjectName?zc.eh([49,48]):(zc.RLb(this.kc.SelectedRange[Ub],this.kc.PresenceType),F.NXd(this.kc.PresenceType,zc,this.kc.SelectedRange[Ub],lb,this.hn,this.vw)))}for(h=this.Oz&&this.Oz.aEd&&this.Oz.aEd.PresenceType!==this.Oz.kc.PresenceType?
0:h;h<Ya;h++)this.gy[h].eh([1===this.Oz.aEd.PresenceType?49:48])};F.prototype.zfd=function(Ya){return(null===Ya||void 0===Ya?0:Ya.ObjectId)&&(1===this.UZe(Ya.ObjectType)||2===this.UZe(Ya.ObjectType))&&(Ya=this.$.vb.qed(Ya.ObjectId))?Pb.w(Ya):null};F.prototype.Wpj=function(){for(var Ya=this.gy.length,h=this.$.va.pa,lb=this.kc.SelectedRange?this.kc.SelectedRange.length:0,Ub=this.kc.Object?this.kc.Object.length:0,zc=0;zc<Ya;zc++)this.gy[zc].eh([49,48]);this.BXg();for(var vc=this.g2c=this.f2c=zc=0;vc<
Ub;vc++){var ud=this.kc.Object[vc],Gd=this.zfd(ud);if(Gd){var od=this.i3c(zc,Ya);1===ud.ObjectType?this.f2c++:3===ud.ObjectType&&this.g2c++;zc++;od.RLb(Gd,ud.ObjectPresenceType);F.NXd(ud.ObjectPresenceType,od,Gd,h,this.hn,this.vw)}}for(Ub=0;Ub<lb;Ub++)this.kc&&this.kc.SelectedRange&&(vc=this.kc.SelectedRange[Ub],vc.NamedObjectName||(ud=!!h&&vc.SheetName===h.name,Gd=!!Ka(vc,this.$,1),ud&&Gd||(ud=this.i3c(zc+Ub,Ya),ud.RLb(vc,this.kc.PresenceType),F.NXd(this.kc.PresenceType,ud,vc,h,this.hn,this.vw))));
0<(this.countFloatingObjects=this.iXf())&&Yb.ULS.sendTraceTag(537154370,0,50,'{{"SetAllFloatingObjectPresenceHighlights":"Success"}')};F.prototype.BXg=function(){this.iXf();this.EHe()};F.prototype.iXf=function(){var Ya=0;if(this.kc&&this.kc.Object)for(var h=0;h<this.kc.Object.length;h++)this.JQj(this.kc.Object[h])&&Ya++;return Ya};F.prototype.R7g=function(Ya,h){if(this.UG.kb(h))return h=this.UG.getItem(h),h.Sg=Ya,h;if(!this.hn||!this.$||!this.vw)return null;var lb=new T(this.hn,this.$,this.vw);lb.Sg=
Ya;this.UG.add(h,lb);return lb};F.prototype.JQj=function(Ya){var h=!1;if((null===Ya||void 0===Ya?0:Ya.ObjectId)&&(0===Ya.ObjectType||2===Ya.ObjectType||this.CEd&&5===Ya.ObjectType))try{var lb=this.aOh(Ya);if(lb){var Ub=this.R7g(lb,Ya.ObjectId);Ub.RLb(lb,Ya.ObjectPresenceType);5!==Ya.ObjectType&&Ub.ILb();h=!0}}catch(zc){throw Yb.ULS.sendTraceTag(537154369,0,10,'{{"UpdatedFloatingObjectPresence":"Fail","Exception":"{0}"}',zc.stack),zc;}return h};F.prototype.aOh=function(Ya){if(!Ya)return null;var h=
null;this.CEd?-1!=Ya.ObjectType&&(h=td.a(this.$).Vua(Ya.ObjectId)):2===Ya.ObjectType?h=td.a(this.$).Vua(Ya.ObjectId):0===Ya.ObjectType&&(Ya=this.$.vb.qed(Ya.ObjectId),null===Ya||void 0===Ya?0:Ya.dLa)&&(h=td.a(this.$).LPh(Ya.dLa));return h};F.prototype.KNd=function(){try{1===this.kc.Version?(this.Vpj(),Yb.ULS.sendTraceTag(537154368,0,50,'{{"SetGridHighlightPass":"V1"}')):(this.Wpj(),Yb.ULS.sendTraceTag(537154339,0,50,'{{"FloatingObjects":"{0}","PivotTables":"{1}","QueryTables":"{2}"}',this.countFloatingObjects,
this.f2c,this.g2c))}catch(Ya){throw Yb.ULS.sendTraceTag(537154338,0,10,'{{"SetGridHighlight Exception":"{0}"}',Ya.stack),Ya;}};F.prototype.UZe=function(Ya){switch(Ya){case 0:return 0;case 1:return 1;case 3:return 2;case 2:return 9;default:return-1}};F.NXd=function(Ya,h,lb,Ub,zc,vc){var ud=1===Ya?49:48;Ub&&lb&&Ub.name===lb.SheetName?(h.Ti(Pb.D(lb),[ud]),h.ILb(ud),Yb.ULS.shipAssertTag(537154337,0,h.du.ty===zc.User.UserID,"UserID and UnitID should match"),vc.MKb(h.du.ty,1===Ya)):h.gxb([ud])};Mf.Object.defineProperties(F.prototype,
{kc:{configurable:!0,enumerable:!0,get:function(){return this.Oz.kc},set:function(Ya){this.Oz.kc=Ya;this.KNd()}}});Object(zb.a)(F,"UserGridPresence",X,[]);var Jc=b(46),zd=b(1003),sd=Kb.a;Rk(I,sd);I.prototype.BFa=function(Ya){this.addHandler("pcek",Ya)};I.prototype.Bza=function(Ya){this.removeHandler("pcek",Ya)};I.prototype.EOf=function(Ya){this.FBa[Ya]&&this.sOf(Ya,!1)};I.prototype.DSd=function(Ya){this.Crb&&this.Crb!==Ya.clientId&&(this.LPd=!1);!Za.EwaSettings.isChangeGateEnabled("OfficeVSO:5657706_CorrectPresenceBootTelemetry")||
this.$.ea.J4a&&Jc.PageLoadTrackingInfo.instance.wnj||(this.LPd=!1);this.QK.Q0g(Ya);this.Crb=Ya.clientId};I.prototype.SPh=function(Ya,h){var lb=[];var Ub=[];var zc=this.FBa,vc;for(vc in zc){var ud=zc[vc];if(h){var Gd=Pb.k(Ya,this.$);this.z2e(Gd,lb,Ub,ud)}else this.y2e(Ya,lb,Ub,ud)}return{Rbi:lb,rih:Ub}};I.prototype.zGe=function(Ya,h,lb,Ub,zc){(zc=this.FBa[zc])&&(h?this.z2e(Ya,lb,Ub,zc):this.y2e(Ya,lb,Ub,zc))};I.prototype.d_h=function(){var Ya=[],h=this.FBa,lb;for(lb in h){var Ub=h[lb],zc=Ub.kc.SelectedRange;
if(void 0!==zc&&null!==zc&&Za.EwaSettings.isChangeGateEnabled("OfficeVSO:5280212_Guard_PresenceState.SelectedRange")){zc=bk(zc);for(var vc=zc.next();!vc.done;vc=zc.next()){vc=vc.value;var ud=Pb.D(vc),Gd=Ie.g(this.$).ha.sa.W3;if(this.$.va.pa.sheetName===vc.SheetName&&ud.right===Gd.right&&ud.top===Gd.top){Ub=Ub.hn;Ub=new tb.a(Ub.User.UserID,Ub.User.UserName,Ub.UserColor,new oc.a(1),null,Ub.UserEmail,void 0,void 0,void 0,void 0,void 0,Ub.JoinCoauthTime);Ya.push(Ub);break}}}}return Ya};I.prototype.dxc=
function(){H.rLb=!0;H.Cna=!0;var Ya=this.wu,h;for(h in Ya)Ya[h].dxc()};I.prototype.ydc=function(){H.rLb=!1;H.Cna=!1;var Ya=this.wu,h;for(h in Ya)Ya[h].ydc()};I.prototype.dispose=function(){this.LNb();this.$&&(this.$.va&&this.$.va.vg(this.vya),this.$.oa&&this.$.oa.Jma(this.QBa),this.$.Ol(this.Fc));this.kn&&this.kn.fId(this.$Db);this.vWc&&(this.vWc.dispose(),this.vWc=null);if(this.wu){var Ya=this.wu,h;for(h in Ya)Ya[h].dispose()}Dc.a.oc([this.QK,this.vw]);this.vxe();this.wu=this.$=this.Zee=null;Array.clear(this.Nx);
sd.prototype.dispose.call(this)};I.prototype.LNb=function(){this.QK&&(this.QK.Bza(this.HAd),this.QK.kaj(this.svf),this.QK.Jbj(this.Lzf),this.QK.gda(this.Rc));this.PNa.DPf(this.AEb)};I.prototype.gEe=function(Ya){return new F(Ya,this.$,this.vw)};I.prototype.Uke=function(Ya){var h=this.$.ea.kgd(Ya);if(h)if(Ya in this.wu)this.wu[Ya].Ccg(h);else{var lb=this.gEe(h);this.wu[Ya]=lb;this.s_a(lb)}return!!h};I.prototype.z2e=function(Ya,h,lb,Ub){if(Ya){Ya=bk(Ya);for(var zc=Ya.next();!zc.done;zc=Ya.next()){if(zc=
zc.value){var vc=Ka(zc,this.$,1);if(vc&&I.mgd(vc.Ai,h,lb,Ub))break;if((vc=Ka(zc,this.$,2))&&I.mgd(vc.Ai,h,lb,Ub))break}if(Ub.kc.SelectedRange){vc=bk(Ub.kc.SelectedRange);for(var ud=vc.next();!ud.done;ud=vc.next())if((ud=ud.value)&&zc&&Ga(zc,ud)){Array.add(1===Ub.kc.PresenceType?lb:h,Ub.Oz.zOb.User);return}}}}};I.prototype.y2e=function(Ya,h,lb,Ub){Ya&&I.mgd(this.gOh(Ya),h,lb,Ub)};I.prototype.HHg=function(Ya){Ya.SelectedRange&&(Ya.SelectedRangeRaw=this.Ibh(Ya.SelectedRange),Ya.SelectedRange=this.PNa.y2g(Ya.SelectedRange))};
I.prototype.Ibh=function(Ya){for(var h=Array(Ya.length),lb=0;lb<Ya.length;lb++){var Ub=lb,zc=Ya[lb],vc={};vc.SheetName=zc.SheetName;vc.FirstColumn=zc.FirstColumn;vc.FirstRow=zc.FirstRow;vc.LastRow=zc.LastRow;vc.LastColumn=zc.LastColumn;vc.NamedObjectName=zc.NamedObjectName;h[Ub]=vc}return h};I.prototype.gOh=function(Ya){if(Ya)switch(Ya.type){case 0:return(Ya=this.$.vb.TZe(Ya.id))?Ya.Ai:null;case 2:return Ya.Ai}return null};I.prototype.Q4a=function(){this.QK.BFa(this.HAd);this.QK.YFg(this.Lzf);this.QK.cEg(this.svf);
this.QK.r2(this.Rc);this.PNa.Kme(this.AEb)};I.prototype.klf=function(Ya,h,lb,Ub){var zc={};zc.a=this.$.ya.UserSessionId;zc.b=Ya;zc.c=lb?"PendingUserRemoved":"Non-PendingUserRemoved";zc.d=Ub?"Disconnected":"Inactivity";zc.e=h;Zb.b().Ce(22,zc,!0)};I.prototype.sOf=function(Ya,h){Ya in this.wu&&(this.COf(Ya),this.wu[Ya].dispose(),delete this.wu[Ya],Yb.ULS.sendTraceTag(537154375,0,50,"PresenceView.RemovePresenceForUser: userId=[{0}] removed due to inactivity",Ya),this.klf(Ya,Qd.a.Ta.Jb,!1,h));Ya in this.hma&&
(this.Ijc(Ya,!1),delete this.o$a[Ya],delete this.hma[Ya],Yb.ULS.sendTraceTag(537154374,0,50,"PresenceView.RemovePresenceForUser: Pending userId=[{0}] removed due to inactivity",Ya),this.klf(Ya,Qd.a.Ta.Jb,!0,h))};I.prototype.COf=function(Ya){for(var h=this.Nx.length-1;0<=h;h--)if(this.Nx[h].User.UserID===Ya){Array.removeAt(this.Nx,h);for(var lb=bk(this.wu[Ya].gy),Ub=lb.next();!Ub.done;Ub=lb.next())this.vw.nna(Ub.value.du.ty,!1);this.gxc()}};I.prototype.Nti=function(){if(this.S3b||this.T3b)this.$.Fd(-70383382,
-1,0,null),Yb.ULS.sendTraceTag(537154373,0,50,"PresenceView.LogDiscontinuousCountPresenceData: Discontinuous Presence Received with count= [{0}], Continuous Presence Received with count= [{1}]",this.T3b,this.S3b);this.T3b=this.S3b=0};I.prototype.vxe=function(){this.Tsd();this.XNc=this.o$a=null};I.prototype.Tsd=function(){var Ya=this.hma,h;for(h in Ya)this.Ijc(h,!1)};I.prototype.dti=function(){var Ya=this.E5c,h;for(h in Ya)this.Ukf(h,!0,Ya[h]);Ya=this.ckd;for(var lb in Ya)this.Ukf(lb,!1,Ya[lb]);this.E5c=
{};this.ckd={}};I.prototype.Ijc=function(Ya,h){if(this.$.Tu&&this.$.ea.dc){var lb={};lb.a=this.$.ya.UserSessionId;lb.b=Ya;lb.c=h;lb.e=!1;lb.d=-1;lb.f=Qd.a.Ta.Jb;this.$.ea&&(lb.e=this.$.ea.nM);if(Ya=this.o$a[Ya])lb.d=ve.a(Qd.a.Ta,Ya);Zb.b().Ce(20,lb,!0)}};I.prototype.ttd=function(Ya){if(this.$.Tu){var h={e:-1,f:-1,c:!1,d:!1};h.b=Ya;h.a=this.$.ya.UserSessionId;this.$.ea&&(h.c=this.$.ea.J4a,h.d=this.$.ea.nM,h.e=this.$.ea.Bm.length,this.$.ea.UBa&&(h.f=ve.a(Qd.a.Ta,this.$.ea.gXj)));Zb.b().Ce(21,h,!0)}};
I.prototype.Ukf=function(Ya,h,lb){if(this.$.Tu){var Ub={};Ub.a=this.$.ya.UserSessionId;Ub.b=Ya;Ub.c=h;Ub.d=lb;Zb.b().Ce(19,Ub,!0)}};I.prototype.W4e=function(){var Ya=[],h=this.wu,lb;for(lb in h){var Ub=h[lb];if(this.QK.jWf(Ub.kc)){this.Gle(Ya,Ub);Array.remove(this.Nx,Ub.Oz.zOb);if(1===this.QK.kc.PresenceType){var zc={};zc.a=1===Ub.kc.PresenceType?"Editing":"Non-Editing";zc.b=this.$.ya.UserSessionId;zc.c=Qd.a.Ta.Jb;Zb.b().Ce(18,zc)}zc=bk(Ub.gy);for(Ub=zc.next();!Ub.done;Ub=zc.next())this.vw.nna(Ub.value.du.ty,
!0)}else for(zc=bk(Ub.gy),Ub=zc.next();!Ub.done;Ub=zc.next())this.vw.nna(Ub.value.du.ty,!1)}Array.clear(this.Nx);this.Nx=Ya;this.gxc()};I.prototype.Gle=function(Ya,h){var lb=h.Oz.zOb;if(0===h.kc.PresenceType){h=Ya.length;var Ub;for(Ub=0;Ub<h&&0===this.wu[Ya[Ub].User.UserID].kc.PresenceType;Ub++);Array.insert(Ya,Ub,lb)}else Ya.push(lb)};I.prototype.s_a=function(Ya){this.QK.jWf(Ya.kc)&&(this.Gle(this.Nx,Ya),this.gxc());var h=Ya.Oz.zOb.User.UserID,lb=this.wu,Ub;for(Ub in lb){var zc=lb[Ub];Ub!==h&&Ya.s_a(zc)}};
I.prototype.gxc=function(){0<this.Nx.length&&this.UAj()};I.prototype.UAj=function(){for(var Ya=0,h=this.Nx.length;Ya<h;Ya++){var lb=this.wu[this.Nx[Ya].User.UserID];if(lb)if(this.QK.wKf(lb.kc)){lb.t3f(!0);lb=bk(lb.gy);for(var Ub=lb.next();!Ub.done;Ub=lb.next())this.vw.nna(Ub.value.du.ty,!0)}else(Ub=this.QK.cZe(lb.kc))&&lb.u3f(!0,Ub)}};I.prototype.dTh=function(Ya){var h={User:{}};h.User.UserID=Ya;h.User.UserName=Be.a.instance.mb(87);h.UserColor="#AAAAAA";return h};I.prototype.$ye=function(Ya,h){var lb=
this;this.LPd&&this.uDd&&(Ya&&h?this.tDd?this.tDd.hkh(Ya,h,this.Crb):this.uDd.continueWith(function(){lb.tDd=lb.uDd.result;lb.$ye(Ya,h)}):Yb.ULS.sendTraceTag(537154372,0,15,"userId: [{0}], endTime: [{1}]",Ya,h))};I.mgd=function(Ya,h,lb,Ub){if(!Ub||!Ub.kc||!Ub.kc.Object)return!1;for(var zc=bk(Ub.kc.Object),vc=zc.next();!vc.done;vc=zc.next())if(vc=vc.value,Ya&&vc&&vc.ObjectId&&!vc.ObjectId.localeCompare(Ya))return Array.add(1===vc.ObjectPresenceType?lb:h,Ub.Oz.zOb.User),!0;return!1};Mf.Object.defineProperties(I.prototype,
{QK:{configurable:!0,enumerable:!0,get:function(){return this.Zee}},FBa:{configurable:!0,enumerable:!0,get:function(){return this.wu}},hma:{configurable:!0,enumerable:!0,get:function(){return this.XNc}}});Object(zb.a)(I,"PresenceView",Kb.a,[785,786]);var Pd=b(214),De=b(235),lc=b(329),Pc=Kb.a;Rk(D,Pc);D.prototype.gq=function(Ya){this.addHandler("OSC",Ya)};D.prototype.Eq=function(Ya){this.removeHandler("OSC",Ya)};D.prototype.qz=function(){this.raiseEvent("OSC")};D.prototype.Ir=function(Ya,h){if("QueryOcsConnectionStatus"===
Ya)h.Value=this.$.ea.X6a?Be.a.instance.ga(916):Be.a.instance.ga(917);else return!1;return!0};D.prototype.an=function(){return!0};D.prototype.dispose=function(){this.statusBarManager&&(this.statusBarManager.wF(this),this.statusBarManager=null);this.$=null;Pc.prototype.dispose.call(this)};Object(zb.a)(D,"OcsStatusBarManager",Kb.a,[3,472,303]);var md=Kb.a;Rk(x,md);x.prototype.ied=function(){this.q_||(this.q_={},this.q_.IsPresenter=this.$.ya.IsMeetingPresenter,this.q_.MeetingId=this.$.ya.MeetingId);this.q_.MessageId=
++this.messageId;Yb.ULS.sendTraceTag(524940883,0,50,"SelectionPresenceManager::getMeetingInfo: Sending presence with messageId: "+this.messageId);return this.q_};x.prototype.BFa=function(Ya){this.addHandler(x.vDd,Ya)};x.prototype.Bza=function(Ya){this.removeHandler(x.vDd,Ya)};x.prototype.cEg=function(Ya){this.$.ea.Fga(Ya)};x.prototype.kaj=function(Ya){this.$.ea.hda(Ya)};x.prototype.r2=function(Ya){this.addHandler(x.p0,Ya)};x.prototype.gda=function(Ya){this.removeHandler(x.p0,Ya)};x.prototype.YFg=
function(Ya){this.addHandler(x.wDd,Ya)};x.prototype.Jbj=function(Ya){this.removeHandler(x.wDd,Ya)};x.prototype.dispose=function(){this.$&&(this.LNb(),this.$.rl(this.Yc),this.$.Ol(this.Fc));this.rj&&this.rj.Cza(this.Ula);Dc.a.Ia(this.Prf);this.$=this.rj=this.q_=null;md.prototype.dispose.call(this)};x.prototype.Q0g=function(Ya){this.rj?this.rj.Cza(this.Ula):this.Q4a();(this.rj=Ya)?(this.rj.CFa(this.Ula),this.Wbb(!0)):this.LNb()};x.prototype.Q4a=function(){var Ya=this;this.ha.vG(this.Rc);Ie.g(this.$).QD(this.ap);
var h=Ie.g(this.$).Wb;h.tm(this.Af);h.Ak(this.Dh);this.$.ea.Vj(this.Uc);this.$.ea.wme(this.Vgf);this.PNa.Kme(this.AEb);h=this.$.oa.xa;h.DFa(this.oDf);h.Sq(this.di);h.Ey(this.Jn);this.Iff?this.$.da.Za(16,function(lb){lb.mme(Ya.Hmc);lb.lme(Ya.Af)}):(h=ub.GetServiceTaskFactory.Ra(this.$.da,16,74,1),Mb.TaskExtensions.Aa(h,function(lb){Ya.fieldManagerPane=lb.result;Ya.fieldManagerPane.mme(Ya.Hmc);Ya.fieldManagerPane.lme(Ya.Af)},Pd.a.none,3))};x.prototype.LNb=function(){var Ya=this;this.ha.zF(this.Rc);
Ie.g(this.$).yF(this.ap);var h=Ie.g(this.$).Wb;h.Nl(this.Af);h.vk(this.Dh);this.$.ea.wk(this.Uc);this.$.ea.sPf(this.Vgf);this.PNa.DPf(this.AEb);this.$.oa.xa.WPa(this.oDf);this.$.oa.xa.Zr(this.di);this.$.oa.xa.Bz(this.Jn);this.Iff?this.$.da.Za(16,function(lb){lb.jPf(Ya.Hmc);lb.iPf(Ya.Af)}):this.fieldManagerPane&&(this.fieldManagerPane.jPf(this.Hmc),this.fieldManagerPane.iPf(this.Af));this.raiseEvent(x.wDd)};x.prototype.jWf=function(Ya){return this.wKf(Ya)||!!this.cZe(Ya)};x.prototype.wKf=function(Ya){if(2===
this.kc.Version&&this.kc.Object&&2===Ya.Version&&Ya.Object&&0<this.kc.Object.length&&0<Ya.Object.length)for(var h=this.kc.Object.length,lb=Ya.Object.length,Ub=0;Ub<h;Ub++)for(var zc=0;zc<lb;zc++)if(this.cWc(this.kc.Object[Ub],Ya.Object[zc]))return!0;if(this.kc.SelectedRange&&Ya.SelectedRange)for(h=this.kc.SelectedRange.length,lb=Ya.SelectedRange.length,Ub=0;Ub<h;Ub++)for(zc=0;zc<lb;zc++)if(x.GKg(this.kc.SelectedRange[Ub],Ya.SelectedRange[zc]))return!0;return!1};x.prototype.cZe=function(Ya){if(2===
this.kc.Version&&this.kc.Object&&2===Ya.Version&&Ya.Object&&0<this.kc.Object.length&&0<Ya.Object.length)for(var h=this.kc.Object.length,lb=Ya.Object.length,Ub=0;Ub<h;Ub++)for(var zc=0;zc<lb;zc++)if(x.AEi(this.kc.Object[Ub],Ya.Object[zc]))return this.kc.Object[Ub].ObjectId;return null};x.prototype.cWc=function(Ya,h){return!!Ya&&!!h&&Ya.ObjectType===h.ObjectType&&(1===Ya.ObjectType||3===Ya.ObjectType)&&!!Ya.ObjectId&&!!h.ObjectId&&!Ya.ObjectId.localeCompare(h.ObjectId)};x.prototype.rWf=function(){this.Wbb(!1)};
x.prototype.Wbb=function(Ya){this.ha.Oa.Yb?this.CMd(0,Ya):this.KMd(Ie.g(this.$).Wb.isEditing?1:0,Ya)};x.prototype.CMd=function(Ya,h){var lb={};this.$.Lj(lb);var Ub=this.ha.Oa.Yb;if(Ub){var zc=Ub.floatingObject;lb.FirstColumn=-1;lb.FirstRow=-1;lb.LastColumn=-1;lb.LastRow=-1;lb.NamedObjectName=zc?zc.Gg():null;this.kc.SelectedRange=[lb];this.kc.PresenceType=0;lb=null;if(this.JWf){if(null===zc||void 0===zc?0:zc.id)lb={ObjectType:this.KTh(zc.type),ObjectPresenceType:Ya,DialogType:0,ObjectId:Ub.Ai}}else if(zc)switch(zc.type){case 0:if(Ub=
this.$.vb.TZe(zc.id))lb={},lb.ObjectType=this.Paa(0),lb.ObjectPresenceType=Ya,lb.ObjectId=Ub.Ai;break;case 2:zc.id&&(lb={},lb.ObjectType=this.Paa(9),lb.ObjectPresenceType=Ya,lb.ObjectId=zc.Ai)}this.kc.Object=[lb]}this.raiseEvent(x.p0);this.sendPresenceToService(h)};x.prototype.KMd=function(Ya,h){if(!Ie.g(this.$).isEditing&&!Ie.g(this.$).ui){var lb=this.$.Fb.Kg("ModelUpdate","SendRangePresence");lb.start();var Ub=Pb.k(this.ha.sa.selectedRanges,this.$);this.kc.SelectedRange=this.PNa.x2g(Ub);this.kc.Object=
[];Ub=bk(Ub);for(var zc=Ub.next();!zc.done;zc=Ub.next())if(zc=Ka(zc.value,this.$,1)){var vc={};vc.ObjectType=this.Paa(zc.type);vc.ObjectPresenceType=0;vc.ObjectId=zc.Ai;this.kc.Object.push(vc)}this.kc.PresenceType=Ya;this.raiseEvent(x.p0);this.kc.SelectedRange||this.kc.Object?this.sendPresenceToService(h):Yb.ULS.sendTraceTag(537154371,0,50,"SelectionPresenceManager.SendRangePresence: skip sending range presence since selected range/object are both null.  UserId: [{0}]",this.rj.clientId);lb.stop()}};
x.prototype.sendPresenceToService=function(Ya){if(this.$.ea.o7b||!this.$.ea.i3b||Ya)if(this.amIAlone||++this.bAa.b,this.rj){this.kc.Version=2;this.kc.ClientType=1;this.kc.ChatThreadId=this.DWa.d_c;this.kc.ChatThreadDiscoveryUri=this.DWa.c_c;this.kc.InChat=this.DWa.Dxb;this.kc.Cid=this.DWa.email;this.kc.SupportsChat=!!this.DWa.capabilities&&this.DWa.capabilities.BKa(4);this.kc.CollabMode=this.$.ea.X6a?2:0;this.kc.OcsCapable=this.$.ea.ocsCapable;this.$.ya.IsMeetingLiveSession&&this.$.ya.IsMeetingPresenter&&
Za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SendPresenterDetailsForExcelLive",!1)&&(this.kc.MeetingInfo=this.ied());this.rj.GWf(this.kc);if(Za.EwaSettings.isChangeGateEnabled("OfficeVSO:5140517_PresenceBootBreakDownMetrics")&&this.$.ea&&this.$.ea.J4a){var h=(new Date).getTime();Mb.TaskExtensions.Aa(ub.GetServiceTaskFactory.Ra(this.$.da,435,436,1),function(lb){lb.result.dvi(h)},this.$.la,3)}this.amIAlone||++this.bAa.c}};x.prototype.zMd=function(){this.$.Tu&&(this.bAa.a=this.$.ya.UserSessionId,
Zb.b().Ce(26,this.bAa,!0));this.bAa.b=0;this.bAa.c=0};x.prototype.KTh=function(Ya){switch(Ya){case 0:return 0;case 2:return 2;case 5:return 5;default:return-1}};x.prototype.Paa=function(Ya){switch(Ya){case 0:return 0;case 1:return 1;case 2:return 3;case 9:return 2;default:return-1}};x.AEi=function(Ya,h){return!!Ya&&!!Ya.ObjectId&&!!h&&!!h.ObjectId&&(0===Ya.ObjectType||2===Ya.ObjectType)&&Ya.ObjectType===h.ObjectType&&!Ya.ObjectId.localeCompare(h.ObjectId)};x.GKg=function(Ya,h){return!Ya.NamedObjectName&&
Ga(Ya,h)};Mf.Object.defineProperties(x.prototype,{kc:{configurable:!0,enumerable:!0,get:function(){return this.Jqa}},amIAlone:{configurable:!0,enumerable:!0,get:function(){return!this.$.ea||this.$.ea.amIAlone}}});Mf.Object.defineProperties(x,{npc:{configurable:!0,enumerable:!0,get:function(){var Ya={};return x.Ace||(x.Ace=(Ya.ApplyFilter=1,Ya.ApplyPivot=0,Ya.ApplyPivotSort=0,Ya.ApplyPivotSortByValue=1,Ya.ApplyWellKnownPivotFilter=0,Ya.RemovePivotFilter=0,Ya.SetCustomFilter=1,Ya.SetTop10Filter=1,Ya.TogglePivotDrill=
0,Ya.RefreshAll=2,Ya))}}});x.vDd="presenceChanged";x.wDd="presenceDisabled";x.p0="selectionChanged";x.Ace=null;Object(zb.a)(x,"SelectionPresenceManager",Kb.a,[813,3,814]);var bd=Ac.a;Rk(z,bd);z.prototype.create=function(){var Ya=this;this.manager?this.pb(this.manager):Mb.TaskExtensions.Aa(ub.GetServiceTaskFactory.create(this.$.da,28,this.la,this.hb),function(h){Ya.pb(Ya.manager||(Ya.manager=new x(Ya.$,h.result)))},this.la,3)};Object(zb.a)(z,"SelectionPresenceManagerFactory",Ac.a,[]);var Od=b(1458),
le=b(5),dd=b(197),Zd=se.a;Rk(A,Zd);A.prototype.dZe=function(Ya,h){this.JHa=[];h=this.presenceView.SPh(Ya,h);Ya=h.Rbi;h=h.rih;Array.addRange(this.JHa,Ya);Array.addRange(this.JHa,h);return A.Lte(Ya,h)};A.prototype.dispose=function(){this.presenceView.Bza(this.IEb);this.ePa&&(Dc.a.Ia(this.ePa),this.ePa=null);Zd.prototype.dispose.call(this)};A.Lte=function(Ya,h){if(!Ya.length&&!h.length)return"";if(h.length){if(1===h.length)return Ya=Be.a.instance.mb(83),String.format(Ya,h[0].UserName);Ya=Be.a.instance.mb(84);
return String.format(Ya,h.length)}if(1===Ya.length)return h=Be.a.instance.mb(85),String.format(h,Ya[0].UserName);h=Be.a.instance.mb(86);return String.format(h,Ya.length)};Object(zb.a)(A,"PresenceReadoutHandlerService",se.a,[789]);m.prototype.Gbd=function(Ya){return Ya};m.prototype.tCd=function(Ya){for(var h=Array(Ya.MGa.count),lb=0,Ub=bk(Ya.MGa.values),zc=Ub.next();!zc.done;zc=Ub.next())h[lb]=zc.value,lb++;return B(this.$.oa.xa,h,Ya.kt,Ya.naa,null,null)};m.prototype.nVc=function(Ya,h){if(!h)return Ya;
if(!Ya)return Yb.ULS.shipAssertTag(537154136,0,!!Ya,"CheckCollabServiceActionAggregationPerformer.AggregateActionParameters: Received null newActionParameters"),h;Yb.ULS.shipAssertTag(537154135,0,1===Ya.MGa.count,"CheckCollabServiceActionAggregationPerformer.AggregateActionParameters: newActionParameters has unexpected number of entries");for(var lb={},Ub=bk(Ya.MGa),zc=Ub.next();!zc.done;lb={GO:lb.GO,Fea:lb.Fea},zc=Ub.next())lb.GO=zc.value,lb.Fea=void 0,function(vc){return function(){var ud=h.MGa.yc(vc.GO.key);
vc.Fea=ud.value;return ud}}(lb)().returnValue?lb.Fea.OcsSessionId!==lb.GO.value.OcsSessionId?(Yb.ULS.sendTraceTag(537154134,0,15,"CheckCollabServiceActionAggregationPerformer.AggregateActionParameters: Found nonidentical OcsSessionIds. new SeqNum: {0}, aggregated SeqNum: {1}",lb.GO.value.SeqNum,lb.Fea.SeqNum),h.MGa.ia(lb.GO.key,lb.GO.value.SeqNum<lb.Fea.SeqNum?lb.GO.value:lb.Fea),h.kt=lb.GO.value.SeqNum<lb.Fea.SeqNum?Ya.kt:h.kt):(lb.GO.value.SeqNum>lb.Fea.SeqNum&&h.MGa.ia(lb.GO.key,lb.GO.value),h.kt=
Ya.kt):(h.MGa.add(lb.GO.key,lb.GO.value),h.kt=Ya.kt);return h};Object(zb.a)(m,"CheckCollabServiceActionAggregationPerformer",null,[781,782]);y.prototype.Gbd=function(Ya){return Ya};y.prototype.tCd=function(Ya){var h=this.$.oa.xa,lb=Ya.Lah,Ub=Ya.hmc;Ya=Ya.kt;var zc=h.Na(1,null);zc.Id=lb;zc.OnBehalfOfOcs=Ub;return uc.g(h,"CheckPersistedContentUpdate",zc,Ya,null,null,null,516)};y.prototype.nVc=function(Ya,h){if(!h)return Ya;if(!Ya)return Yb.ULS.shipAssertTag(537154133,0,!1,"CheckPersistedActionAggregationPerformer.AggregateActionParameters: Received null newActionParameters"),
h;Ya.hmc=h.hmc&&Ya.hmc;return Ya};Object(zb.a)(y,"CheckPersistedActionAggregationPerformer",null,[781,782]);Object(zb.a)(r,"RevisionGeneratedNotification",null,[]);Object(zb.a)(v,"StateDownloadedNotification",null,[]);var je=b(171),Ke=se.a;Rk(f,Ke);f.prototype.dispose=function(){this.Bd=!0;this.fob&&(this.fob.dispose(),this.fob=null);this.contentRefreshManager&&(this.Xag(),this.contentRefreshManager=null);this.Ea&&(this.aXd(),this.Ea=null);this.viewport&&(this.aXd(),this.viewport=null);this.sf&&(this.sf=
null);this.$&&(this.$.rl(this.Yc),this.$.ea.wk(this.Uc),this.$.ea.OPf(this.Yq),this.$=null);this.mergeSuspensionManager&&(this.mergeSuspensionManager.wsc(this.$Eb),this.mergeSuspensionManager=null);Ke.prototype.dispose.call(this)};f.prototype.AFj=function(){this.yyc||(this.contentRefreshManager.fGg(this.nAf),this.yyc=!0,this.fob.Hq())};f.prototype.Xag=function(){this.yyc&&(this.contentRefreshManager.Pbj(this.nAf),this.yyc=!1)};f.prototype.yFj=function(){this.wyc||(this.Ea.hx(this.xi),this.wyc=!0)};
f.prototype.aXd=function(){this.wyc&&(this.Ea.dv(this.xi),this.wyc=!1)};f.prototype.zFj=function(){this.xyc||(this.viewport.gGg(this.rAf),this.xyc=!0)};f.prototype.aPj=function(){this.xyc&&(this.viewport.Sbj(this.rAf),this.xyc=!1)};f.prototype.OBe=function(Ya,h){if(Ya!==Rc.a.Ee&&!this.Pda.kb(Ya)){var lb=Qd.a.Ta.Jb.toISOString();lb=Object(Rb.a)(new v,{StateId:Ya,DownloadedOn:lb,IsHidden:this.Ge?this.Ge.Ni:"visible"!==window.document.visibilityState,DocumentLastUnhidden:this.Ge&&this.Ge.Eic?this.Ge.Eic.toISOString():
null,LastLostRtcConnection:this.contentRefreshManager&&this.contentRefreshManager.qif?this.contentRefreshManager.qif.toISOString():null,LastOffline:this.sf&&this.sf.jxa?this.sf.jxa.toISOString():null});this.mergeSuspensionManager&&(lb.IsPendingMergeBlockedByClient=this.Iwa,this.kCd&&(lb.PendingMergeBlockedByClientLastEnded=this.kCd.toISOString()));Yb.ULS.sendTraceTag(537154124,13,50,"ContentLatencyTracker.CreateAndAddstateDownloadedNotifications: {0} - StateDownloadedNotification: {1}",h,JSON.stringify(lb));
this.Pda.add(Ya,lb)}};f.prototype.Rud=function(){Wa.AFrameworkApplication.Lf&&Wa.AFrameworkApplication.Lf.Rud()};Object(zb.a)(f,"ContentLatencyTracker",se.a,[]);var lf=b(1086);Object(zb.a)(n,"UpdateInfo",null,[]);var nf=b(1087),me=Sys.EventArgs;Rk(l,me);Object(zb.a)(l,"RevisionGeneratedEventArgs",Sys.EventArgs,[]);k.prototype.PRj=function(){this.Opc||(this.Opc=Wd.a.me(),this.PBb())};k.prototype.MRj=function(){this.Rdc||(this.Rdc=Wd.a.me(),this.PBb())};k.prototype.ORj=function(){this.epc||(this.epc=
Wd.a.me(),this.PBb())};k.prototype.QRj=function(Ya){this.RBc||(this.RBc=Wd.a.me(),this.haf=Ya,this.PBb())};k.prototype.PBb=function(Ya){Ya=void 0===Ya?0:Ya;this.ydf||(Ya&&Ya>this.Xvi?this.sxa(!0):this.Opc&&this.epc&&this.Rdc&&this.RBc&&this.sxa(!1))};k.prototype.dispose=function(){this.$=null};k.prototype.sxa=function(Ya){var h={};h.CoAuthorsCount=this.$.ea.Bm.length;h.HostNotificationTime=this.Rdc;h.PeerNotificationTime=this.epc;h.PresenceNotificationTime=this.Opc;h.UserFetchTime=this.RBc;h.IsAlreadyFetchedFromServer=
this.haf;h.IsTimeout=Ya;h.ClientId=this.clientId;h.CurrentUserClientId=this.oah;Yb.ULS.sendTraceTag(541388879,0,50,"Host Notification Latency Entry: {0}",h);this.p8d=!0};Mf.Object.defineProperties(k.prototype,{ydf:{configurable:!0,enumerable:!0,get:function(){return this.p8d}}});Object(zb.a)(k,"HostNotificationLatencyEntry",null,[3]);Object(zb.a)(e,"PersistedContentUpdateActionParameters",null,[]);d.prototype.eOj=function(Ya){this.q_b(Ya.V_c,this.GFc);this.q_b(Ya.W_c,this.HFc)};d.prototype.q_b=function(Ya,
h){if(Ya){Ya=bk(Ya);for(var lb=Ya.next();!lb.done;lb=Ya.next())h[lb.value]=!0}};Mf.Object.defineProperties(d.prototype,{V_c:{configurable:!0,enumerable:!0,get:function(){return zd.a(this.GFc)}},W_c:{configurable:!0,enumerable:!0,get:function(){return zd.a(this.HFc)}},tcf:{configurable:!0,enumerable:!0,get:function(){return!this.V_c.length&&!this.W_c.length}}});Object(zb.a)(d,"UpdatePresenceUsersActionParameters",null,[]);var $e=Kb.a;Rk(c,$e);c.prototype.fGg=function(Ya){this.addHandler("ekcrmrrg",
Ya)};c.prototype.Pbj=function(Ya){this.removeHandler("ekcrmrrg",Ya)};c.prototype.sYa=function(Ya){this.addHandler("ekcrmmcu",Ya)};c.prototype.Wab=function(Ya){this.removeHandler("ekcrmmcu",Ya)};c.prototype.YEg=function(Ya){this.addHandler("LabelUpdateEventKey",Ya)};c.prototype.Vaj=function(Ya){this.removeHandler("LabelUpdateEventKey",Ya)};c.prototype.oTa=function(Ya,h){this.$.ea.dc&&(Yb.ULS.sendTraceTag(537154119,0,50,"ContentRefreshManager.UpdatePresenceUsers: clientIdsToAdd=[{0}] clientIdsToRemove=[{1}]",
Ya?Ya.join(","):"null",h?h.join(","):"null"),this.jSj.vFf(new d(Ya,h,null)))};c.prototype.dispose=function(){this.rj&&(this.rj.lIb(this.wca),this.rj.Cza(this.oAd));this.$&&(this.$.oa.Zr(this.di),this.$.ea.hda(this.VH));this.kn&&(this.kn.fId(this.$Db),this.kn.ZOf(this.wuf));this.$=this.rj=this.v_a=this.UKa=null;$e.prototype.dispose.call(this)};c.prototype.DSd=function(Ya){this.rj&&(this.rj.lIb(this.wca),this.rj.Cza(this.oAd));this.rj=Object(vb.a)(17,Ya);this.rj.tYa(this.wca);Za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EditorsTableNotification",
!1)&&this.rj.CFa(this.oAd);this.currentUserId=this.rj.clientId};c.prototype.bMf=function(){for(var Ya=!this.rj,h=bk(this.$.ea.Bm),lb=h.next();!lb.done;lb=h.next())(lb=lb.value.User.UserID)&&lb!==this.currentUserId&&!this.v_a.has(lb)&&this.wbc(lb).QRj(Ya)};c.prototype.k3h=function(Ya){if(Rc.a.BTf in Ya&&Rc.a.ATf in Ya&&Rc.a.zTf in Ya){var h=Ya[Rc.a.zTf];1!==h||Rc.a.i7 in Ya&&Rc.a.Ntc in Ya||Yb.ULS.sendTraceTag(537154076,13,10,"RTC WetContentUpdate was sent from ECS and is missing some expected fields. Has SessionSiteIdentifier: {0}, Has UserOperationTimeInMs: {1}.",
Rc.a.i7 in Ya,Rc.a.Ntc in Ya);var lb=this.Pnb(Ya);var Ub=lb.KLf;lb.returnValue||(Ya=new l(Ya[Rc.a.BTf],Ya[Rc.a.ATf],h,Ub,Rc.a.Ntc in Ya?Ya[Rc.a.Ntc]:0),this.raiseEvent("ekcrmrrg",Ya,this))}else Yb.ULS.sendTraceTag(537154077,13,10,"RTC WetContentUpdate is missing some critical fields. Ignoring this update.")};c.prototype.Pnb=function(Ya){Ya=Rc.a.i7 in Ya?Ya[Rc.a.i7]:null;return{returnValue:this.$.ea.i7===Ya,KLf:Ya}};c.prototype.qbg=function(){this.$.ea.hna=Math.max(c.ZMg,this.$.ea.hna)};c.prototype.kQd=
function(Ya){Ya=bk(Ya);for(var h=Ya.next();!h.done;h=Ya.next())if(!this.$.ea.kgd(h.value))return!0;return!1};c.prototype.j_c=function(){this.$.Fd(1562177611,-1,0,null)};c.prototype.mya=function(Ya){Rc.a.Tof in Ya&&Rc.a.Uof in Ya&&Rc.a.Vof in Ya&&(Ya=Object(Rb.a)(new lf.a,{Pending:Ya[Rc.a.Uof],Current:Ya[Rc.a.Tof],SuspensionStartTimestamp:Ya[Rc.a.Vof]}),this.raiseEvent("ekcrmmcu",new nf.a(Ya),this))};c.prototype.wbc=function(Ya){Ya=this.TAe(Ya);if(!this.UKa[Ya]){var h=new k(Ya,this.currentUserId,4E4,
this.$);this.UKa[Ya]=h}this.gVf();return Object(vb.a)(k,this.UKa[Ya])};c.prototype.TAe=function(Ya){if(!Ya)return Ya;var h=Ya.toLocaleLowerCase();h.startsWith("{")||(h="{"+Ya+"}");return h};c.prototype.gVf=function(){var Ya=this;this.fjd||ec.a.isEmpty(this.UKa)||!Za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EditorsTableNotification",!1)||(this.fjd=Ob.Task.delay(2E4).continueWith(function(){Ya.v6h()}))};c.prototype.v6h=function(){var Ya=[],h=Wd.a.me(),lb=this.UKa,Ub;for(Ub in lb){var zc=
Ub,vc=Object(vb.a)(k,lb[Ub]);vc.PBb(h);vc.ydf&&(vc.dispose(),Ya.push(zc))}Ya=bk(Ya);for(h=Ya.next();!h.done;h=Ya.next())h=h.value,delete this.UKa[h],this.v_a.add(h);this.fjd=null;this.gVf()};Mf.Object.defineProperties(c.prototype,{qif:{configurable:!0,enumerable:!0,get:function(){return this.I9d}},Xhj:{configurable:!0,enumerable:!0,get:function(){return!!this.rj&&2===this.rj.connectionState}}});c.ZMg=3E4;Object(zb.a)(c,"ContentRefreshManager",Kb.a,[783]);var we=b(63);a.prototype.Gbd=function(Ya){return Ya+
5E3};a.prototype.tCd=function(Ya){var h=this;return this.$.ea.dc?Mb.TaskExtensions.ts(Mb.TaskExtensions.ts(Ob.Task.delay(0),function(){var lb=h.$.oa.xa,Ub=Ya.V_c,zc=Ya.W_c,vc=Ya.kt,ud=lb.Na(1,null);ud.clientIdsToAdd=Ub;ud.clientIdsToRemove=zc;return uc.g(lb,"UpdatePresenceUsers",ud,vc,null,null,null,0)},Pd.a.none,0,we.a.current),function(){return Ob.Task.delay(5E3)},Pd.a.none,0,we.a.current):Ob.Task.Ua(!0)};a.prototype.nVc=function(Ya,h){if(!h)return Ya;if(!Ya)return Yb.ULS.shipAssertTag(537154073,
0,!1,"UpdatePresenceUsersActionAggregationPerformer.AggregateActionParameters: Received null newActionParameter"),h;if(h.tcf)return h;if(Ya.tcf)return Ya;h.eOj(Ya);return h};Object(zb.a)(a,"UpdatePresenceUsersActionAggregationPerformer",null,[781,782]);Type.registerNamespace("_Ewa");Type.registerNamespace("Common.App.CoauthTelemetry");ia.main();Type.registerNamespace("Common.App.CollabControls");Type.registerNamespace("Common.App.Presence");Type.registerNamespace("RealtimePresenceUI");Ic.a.Fa(qa.ka);
(function(){Ic.a.Fa(function(Ya){Za.EwaSettings.isChangeGateEnabled("OfficeVSO:5140517_PresenceBootBreakDownMetrics")&&va.ka(Ya);var h=Ya.da;h.Ga(28,new ra(Ya));h.Ga(158,new z(Ya));Ic.a.Fa(Xa.ka);var lb=ub.GetServiceTaskFactory.create(Ya.da,158,h.la,1),Ub=ub.GetServiceTaskFactory.create(Ya.da,28,h.la,1);Mb.TaskExtensions.Aa(Mb.TaskExtensions.Vd([lb,Ub],h.la),function(){var zc=new kb.a,vc=h.za(26);vc.GDe(Object(Fb.a)(zc,zc.setResult,"setResult"));var ud=new I(Ya,vc,lb.result,Ub.result,Qa.a.Jq(pa.a.instance.Tb("Common.App.CoauthTelemetry.IPresenceBootTelemetry")));
ac.a.getInstance(Ya.da).add(ud);h.Ga(159,new Xa);Mb.TaskExtensions.Aa(ub.GetServiceTaskFactory.create(h,159,h.la,1),function(Gd){var od=new kb.a;od.setResult(ud);new da(Object(Rb.a)(new tb.a,{clientId:Ya.workbookContext.ClientId}),zc.task,od.task,Gd.result,fb.a.instance,Wa.AFrameworkApplication.fa.qa("AwayStatusOneMinuteTimeoutIsEnabled")?6E4:Wa.AFrameworkApplication.fa.kd("AwayCoauthorThresholdMs",9E5),Object(Fb.a)(Wa.AFrameworkApplication.ub,Wa.AFrameworkApplication.ub.processAction,"processAction"),
ba.instance)},h.la)},h.la,3);pa.a.instance.register(766,"Microsoft.Office.Excel.WebUI.Client.ISessionStateManager").as("Common.ICoauthoringTelemeryInfoProvider").tc().Cc(function(){return Ya.ea});pa.a.instance.resolve("Common.ICoauthoringTelemeryInfoProvider");pa.a.instance.register(oa,"Microsoft.Office.Excel.WebUI.Client.Presence.PeopleInfoProvider").as("Common.IPeopleInfoProvider").tc().Cc(function(){return new oa(Ya)});pa.a.instance.resolve("Common.IPeopleInfoProvider")})})();Ic.a.Fa(Od.a.ka);
Ic.a.Fa(function(Ya){var h=Ya.da,lb=ub.GetServiceTaskFactory.Ra(Ya.da,211,212,1);h.Za(25,function(Ub){Mb.TaskExtensions.Aa(lb,function(zc){h.za(231)||new A(zc.result,Ya,Ub)},h.la,3)})});(function(){Ic.a.Fa(function(Ya){Mb.TaskExtensions.Aa(ub.GetServiceTaskFactory.Ra(Ya.da,12,477,0),function(h){var lb=new m(Ya),Ub=Ya.da.za(291);lb=h.result.k2c(lb,lb,Ub,"collabService");var zc=new y(Ya);Ub=h.result.k2c(zc,zc,Ub,"persisted");zc=new a(Ya);h=h.result.k2c(zc,zc,null,"updatePresence");Ya.da.Ga(292,new c(Ya,
Ya.da.za(26),lb,Ub,h));ac.a.getInstance(Ya.da).add(new f(Ya));ac.a.getInstance(Ya.da).add(lb);ac.a.getInstance(Ya.da).add(Ub)},Ya.la)})})()},932:function(u,E,b){function a(){}b.r(E);b.d(E,"RtcUtils",function(){return a});u=b(0);var c=b(14),d=b(1015),e=b(41);a.g_c=function(k,l){l=void 0===l?d.RealtimeChannel.Yud:l;try{var n=e.c(k)}catch(f){throw k=String.format("Failed to JSON-serialize payload : {0}",f),c.ULS.sendTraceTag(18637072,500,10,k),Error.argument("payload",k);}if(n.length>l)throw k=String.format("Payload exceeds maximum length: {0} > {1}.",
n.length,l),c.ULS.sendTraceTag(18637074,500,10,k),Error.argument("payload",k);return n};a.deserialize=function(k,l,n){if(!k)return null;if(Object.getType(k)!==String){var f=String.format("Failed to deserialize [{0}] - object is not of type [String] and is instead of type [{1}]. ExtraInfo: [{2}].",l,Object.getType(k).getName(),n);c.ULS.sendTraceTag(18637075,500,10,f);return null}f=null;try{f=e.a(k)}catch(v){k=String.format("Failed to deserialize [{0}]. Exception deserializing the object : [{1}]. ExtraInfo: [{2}].",
l,v,n),c.ULS.sendTraceTag(18637077,500,10,k)}return f};a.Q8a=function(k){if(!k)return"";if("string"===typeof k)return k.toString();try{return e.c(k)}catch(l){return k.toString()}};a.vxh=function(k){var l;var n=0;var f=l=null;if(!k)return{Q7e:n,S7e:l,exception:f};try{var v=k.source;v&&Object.getType(v)===String&&(f=v);var r=k.context;r&&(k=r,n=k.status?k.status:0,l=k.statusText?k.statusText:null)}catch(y){}return{Q7e:n,S7e:l,exception:f}};Object(u.a)(a,"RtcUtils",null,[])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.cl.js.map/e7b89614b50c08718c1eea47dafdafff/EwaDS.cl.js.map