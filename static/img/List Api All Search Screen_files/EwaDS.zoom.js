(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[27],{1331:function(u,E,b){function a(){c.a.ti(".ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:vertical:start:decrement{background:linear-gradient(120deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(240deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(0deg,#b1b1b1 30%,rgba(0,0,0,0) 31%);background-color:#757778}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:vertical:end:increment{background:linear-gradient(300deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(60deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(180deg,#b1b1b1 30%,rgba(0,0,0,0) 31%);background-color:#757778}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:horizontal:start:decrement{background:linear-gradient(30deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(150deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(270deg,#b1b1b1 30%,rgba(0,0,0,0) 31%);background-color:#757778}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:horizontal:end:increment{background:linear-gradient(210deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(330deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(90deg,#b1b1b1 30%,rgba(0,0,0,0) 31%);background-color:#757778}.ewa-scrollbars-enabled .ewr-namedsheetview .ewa-scrollbars.ewa-scrollbarszoomvar::-webkit-scrollbar-button:start:decrement,.ewa-scrollbars-enabled .ewr-namedsheetview .ewa-scrollbars.ewa-scrollbarszoomvar::-webkit-scrollbar-button:end:increment,.ewa-scrollbars-enabled .ewr-namedsheetview .ewa-scrollbars.ewa-scrollbarszoomvar::-webkit-scrollbar-thumb{width:calc(16px/var(--zoom-level,1));height:calc(16px/var(--zoom-level,1));border:solid calc(1px/var(--zoom-level,1)) #363636;background-color:#b1b1b1}@media screen and (-ms-high-contrast:active){.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar{background-color:Window;border:1px solid WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-thumb{background-color:WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-corner{background-color:Window}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:vertical:start:decrement{-ms-high-contrast-adjust:none;background:linear-gradient(120deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(240deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(0deg,WindowText 30%,rgba(0,0,0,0) 31%);background-color:Window;border:1px solid WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:vertical:end:increment{-ms-high-contrast-adjust:none;background:linear-gradient(300deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(60deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(180deg,WindowText 30%,rgba(0,0,0,0) 31%);background-color:Window;border:1px solid WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:horizontal:start:decrement{-ms-high-contrast-adjust:none;background:linear-gradient(30deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(150deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(270deg,WindowText 30%,rgba(0,0,0,0) 31%);background-color:Window;border:1px solid WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:horizontal:end:increment{-ms-high-contrast-adjust:none;background:linear-gradient(210deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(330deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(90deg,WindowText 30%,rgba(0,0,0,0) 31%);background-color:Window;border:1px solid WindowText}}")}
b.d(E,"a",function(){return a});var c=b(559)},1653:function(u,E,b){function a(ba){var oa=aa.call(this)||this;oa.$=ba;oa.Eb();return oa}function c(ba){var oa=ua.call(this,ba)||this;oa.dBb=null;oa.ixa=null;oa.zoomEventManager=null;oa.iBb=-1;oa.fcf=!1;oa.Rc=function(){oa.iBb=-1};r.ULS.sendTraceTag(537149785,0,50,"AppZoom feature is Enabled.");oa.wfb=new d(ba);oa.AXi()&&(r.ULS.sendTraceTag(537149784,0,50,"ZoomManager.ZoomManager Attaching pinch to zoom events"),oa.ALg());oa.N8i();return oa}function d(ba){var oa=
va.call(this)||this;oa.statusBarManager=null;oa.aUe=!1;oa.$=ba;oa.$.da.Za(29,function(ra){oa.statusBarManager=ra;ra.gJ(oa)});return oa}function e(){return X.call(this)||this}function k(ba){this.i5a=this.xec=0;this.K1b=null;this.kcf=!1;this.$=ba;this.kcf=ba.jic}function l(ba){return D.call(this,ba)||this}function n(ba){this.$=ba}b.r(E);var f=b(10);u=b(0);var v=b(905),r=b(14),y=b(1033),m=b(8),w=b(76),B=b(186),A=b(390),z=b(33),x=b(58);n.prototype.Lc=function(){return!1};n.prototype.executeCommand=function(ba,
oa,ra){var db=!1;ba=oa.command;var Ka=z.a(this.$);11!==oa.Le&&7!==oa.Le&&6!==oa.Le&&2!==oa.Le&&14!==oa.Le&&15!==oa.Le&&16!==oa.Le&&r.ULS.sendTraceTag(537149787,0,15,"ZoomCommandHandler.ExecuteCommand - unsupported zoom origin {0}",oa.Le);var Ga=6===oa.Le;switch(oa.command){case -1365094462:case -1441674458:Ka.UCc(Math.floor(10*Ka.zoom)/10+.1,Ga);db=!0;break;case 1056010365:case 1664364901:Ka.UCc(Math.ceil(10*Ka.zoom)/10-.1,Ga);db=!0;break;case 346087880:Ka.UCc(m.a.x_,Ga);db=!0;break;case -1918142559:case 1517993347:w.a.Nc in
ra?(ra=parseFloat(ra[w.a.Nc]),ra!==Ka.zoom&&Ka.TCc(ra,1517993347===oa.command),db=!0):r.ULS.shipAssertTag(537149786,0,!1,"ZoomCommandHandler.ExecuteCommand - no MenuItemIdKey");break;case -2096586688:case -581733362:oa=parseFloat(ra[y.a.Value]);isNaN(oa)||Ka.TCc(oa/100,!0);db=!0;break;case 1409187195:Ka.zoomFitToScreen();db=!0;break;case -1836771825:Ka.zoomFitToScreenUndo(),db=!0}return db?x.Task.Ua(!0):B.a(ba)};n.prototype.zc=function(ba,oa){switch(oa.command){case -1441674458:case 1664364901:case -1918142559:case 346087880:case 1517993347:case -581733362:case 1409187195:case -1836771825:return z.a(this.$).mX();
case -1365094462:case 1056010365:case -2096586688:return A.a(this.$);default:return!1}};n.prototype.Qc=function(){return!1};Object(u.a)(n,"ZoomCommandHandler",null,[429]);var D=v.a;Rk(l,D);l.prototype.Ad=function(){this.jd([new n(this.$)])};l.ka=function(ba){v.a.Qd(370,new l(ba))};Object(u.a)(l,"ZoomCommandHandlerFactory",v.a,[]);E=b(232);var I=b(89),F=b(27),G=b(83),T=b(607),O=b(48),U=b(5),J=b(168),H=b(64),K=b(305),N=b(133),M=b(45),C=b(36),Q=b(12),P=b(11),ka=b(105),R=b(95),fa=b(21),ca=b(319),ea=b(134);
k.prototype.Ehi=function(){return fa.g(this.$).isEditing?(r.ULS.sendTraceTag(537149795,0,50,"PinchToZoomAdapter.IsGesturePossible A cell is being edited -> don't allow pinch"),!1):this.$.ob.mz?(r.ULS.sendTraceTag(537149794,0,50,"PinchToZoomAdapter.IsGesturePossible A modal dialog is opened -> don't allow pinch"),!1):!0};k.prototype.iKi=function(ba){this.K1b=new Sys.UI.Point(Math.round(ba.Dua.center.x),Math.round(ba.Dua.center.y));this.xec=z.a(this.$).zoom;this.i5a=ba.Dua.scale;var oa={};oa=(oa.InitialZoom=
this.xec,oa.Location="canvas",oa.InputMethod=ba.lb,oa);ea.b(this.$).yd(N.a.zXi,oa);r.ULS.sendTraceTag(537149793,0,50,"PinchToZoomAdapter.OnGestureStart starting gesture. center ({0},{1}), initial zoom {2}, initial scale {3}",this.K1b.x,this.K1b.y,this.xec,this.i5a);this.i8a(ba,"onGestureStart");return!0};k.prototype.hKi=function(ba){if(!this.i5a)return r.ULS.shipAssertTag(537149792,0,!1,"PinchToZoomAdapter:OnGestureEvent initialPinchScale should never be 0"),this.i8a(ba,"OnGestureEvent"),!0;if(!isFinite(this.i5a))return r.ULS.sendTraceTag(537149791,
0,15,"PinchToZoomAdapter:OnGestureEvent initialPinchScale should never be infinite. initialPinchScale={0}",this.i5a),this.i8a(ba,"OnGestureEvent"),!0;var oa=ba.Dua.scale/this.i5a*this.xec;z.a(this.$).ngg(oa,this.K1b);r.ULS.sendTraceTag(537149790,0,50,"PinchToZoomAdapter.OnGestureEvent processing gesture. New zoom {0}. Current scale {1}",oa,ba.Dua.scale);this.i8a(ba,"OnGestureEvent");return!0};k.prototype.gKi=function(ba){z.a(this.$).ogg();r.ULS.sendTraceTag(537149789,0,50,"PinchToZoomAdapter.OnGestureEnd end of gesture");
this.i8a(ba,"OnGestureEnd")};k.prototype.fKi=function(ba){r.ULS.sendTraceTag(537149788,0,50,"PinchToZoomAdapter.OnGestureCancel gesture canceled");this.i8a(ba,"OnGestureCancel")};k.prototype.i8a=function(ba,oa){var ra,db,Ka;this.kcf&&(r.ULS.sendTraceTag(536990857,0,50,"PinchToZoomAdapter.markGestureEventAsHandled - Invoked from {0},        eventArgs non-null: {1}, gestureData non-null: {2},        srcEvent non-null: {3}",oa,isNullOrUndefined(ba),isNullOrUndefined(null===ba||void 0===ba?void 0:ba.Dua),
isNullOrUndefined(null===(ra=null===ba||void 0===ba?void 0:ba.Dua)||void 0===ra?void 0:ra.srcEvent)),null===(Ka=null===(db=null===ba||void 0===ba?void 0:ba.Dua)||void 0===db?void 0:db.srcEvent)||void 0===Ka?void 0:Ka.preventDefault())};Object(u.a)(k,"PinchToZoomAdapter",null,[537]);var wa=b(38),X=wa.a;Rk(e,X);e.prototype.zne=function(ba){this.addHandler("ZCIEK",ba)};e.prototype.ZPf=function(ba){this.removeHandler("ZCIEK",ba)};e.prototype.yne=function(ba){this.addHandler("ZCUIK",ba)};e.prototype.YPf=
function(ba){this.removeHandler("ZCUIK",ba)};e.prototype.bHg=function(ba){this.addHandler("ZCEK",ba)};e.prototype.Dcj=function(ba){this.removeHandler("ZCEK",ba)};e.prototype.L3i=function(){this.raiseEvent("ZCIEK")};e.prototype.K3i=function(){this.raiseEvent("ZCUIK")};e.prototype.M3i=function(){this.raiseEvent("ZCEK")};Object(u.a)(e,"ZoomEventManager",wa.a,[536]);var ja=b(22),va=wa.a;Rk(d,va);d.prototype.gq=function(ba){this.addHandler("Zoom",ba)};d.prototype.Eq=function(ba){this.removeHandler("Zoom",
ba)};d.prototype.qz=function(){this.an("QueryZoomStatus")&&this.raiseEvent("Zoom")};d.prototype.Ir=function(ba,oa){return"QueryZoomStatus"!==ba?!1:this.X2h(oa)};d.prototype.an=function(){return z.a(this.$).mX()};d.prototype.dispose=function(){this.statusBarManager&&(this.statusBarManager.wF(this),this.statusBarManager=null);this.$=null;va.prototype.dispose.call(this)};d.prototype.R2e=function(ba){ba=this.q_h(ba);if(!ba)return null;ba=ba.getElementsByClassName("cui-ctl-mediumlabel");return 1!==ba.length?
(r.ULS.shipAssertTag(537149764,0,!1,"ZoomStatusBarManager.GetZoomUIElement Cannot find zoom label element"),null):ba[0]};d.prototype.X2h=function(ba){if(!this.$)return!1;var oa=z.a(this.$).hPb,ra=this.R2e("HandleQueryZoomStatusCommand");ra?ja.a.equals(ba.LabelText.toString(),oa,!1)||(ra.innerText="",this.ZYf(ba,oa)):this.ZYf(ba,oa);return!0};d.prototype.ZYf=function(ba,oa){ba.LabelText=oa};d.prototype.q_h=function(ba){var oa=Q.DOMElementExtensions.getElementById(this.$.domElement,"m_excelWebRenderer_ewaCtl_zoomLevel-Medium14");
if(!oa)return oa=(oa=this.$.ea.hc)?oa.inEmbedView:!1,F.a.Wo||oa||r.ULS.sendTraceTag(537149763,0,15,"ZoomStatusBarManager.GetZoomBaseElement Cannot find zoom label. Called from {0}",ba),null;this.aUe||(this.aUe=!0,r.ULS.sendTraceTag(537149762,0,50,"ZoomManager.GetZoomBaseElement - Zoom label was found first time. Called from {0}",ba));return oa};Object(u.a)(d,"ZoomStatusBarManager",wa.a,[3,472,303]);var ua=T.a;Rk(c,ua);c.prototype.dispose=function(){this.wfb&&(I.a.Ia(this.wfb),this.wfb=null);this.zoomEventManager&&
(this.$.da.tU(419),this.zoomEventManager=null);this.fcf&&this.beh();ua.prototype.dispose.call(this)};c.prototype.mX=function(){return!0};c.prototype.ngg=function(ba,oa){ba=this.rua(ba);if(fa.g(this.$).rtl){var ra=Math.round(Q.DOMElementExtensions.getBounds(this.$.tf).width*z.a(this.$).zoom);this.dBb=new Sys.UI.Point(ra-oa.x,oa.y)}else this.dBb=oa;this.lAa(ba,!1,"ZoomWithPinch")};c.prototype.SCc=function(){return!0};c.prototype.RCc=function(ba,oa){var ra=F.a.isMac?.07:.15;ba=this.zoom+(ba?ra:-ra);
ba=this.rua(ba);fa.g(this.$).rtl?(ra=Math.round(Q.DOMElementExtensions.getBounds(this.$.tf).width*z.a(this.$).zoom),this.ixa=new Sys.UI.Point(ra-oa.x,oa.y)):this.ixa=oa;oa=this.zoom;this.lAa(ba,!0,"ZoomWithMouse");ra={};oa=(ra.InitialZoom=oa,ra.FinalZoom=ba,ra.Location="canvas",ra);ea.b(this.$).yd(N.a.KXj,oa)};c.prototype.ogg=function(){this.dBb=null};c.prototype.TCc=function(ba,oa){this.lAa(this.rua(ba),!1,oa?"ZoomWithDropDownFromRibbon":"ZoomWithDropDown")};c.prototype.pgg=function(ba){isNaN(ba)?
r.ULS.sendTraceTag(537149783,0,15,"ZoomManager.ZoomToSelectionForFollowAlongInExcelLive: Invalid zoom value was provided"):this.lAa(this.rua(ba),!1,"ZoomToLevelInExcelLive")};c.prototype.qgg=function(ba){this.lAa(this.rua(ba),!1,"ZoomWithActionPen")};c.prototype.UCc=function(ba,oa){this.lAa(this.rua(ba),!0,oa?"ZoomWithShortcuts":"ZoomWithButtons")};c.prototype.P0e=function(ba,oa){var ra=fa.g(this.$).rtl,db=bk(this.Ked(ra));ra=db.next().value;db=db.next().value;var Ka=bk(this.tgd(ba,db)),Ga=Ka.next().value;
Ka=Ka.next().value;return this.ixa?(ba=this.sed(this.ixa,ba,oa,db,ra,"ZoomWithMouse"),this.ixa=null,ba):this.dBb?this.sed(this.dBb,ba,oa,db,ra,"ZoomWithPinch"):fa.g(this.$).ha.Oa.O4?this.JXj(ba,oa,db,ra,Ga,Ka,fa.g(this.$).rtl):this.LXj(ba,oa,db,ra,Ga,Ka,fa.g(this.$).rtl)};c.prototype.CVf=function(ba,oa,ra){ba?(r.ULS.sendTraceTag(537149782,0,50,"Zoom To: ({0} {1}) (new top-left) from zoom:{2} to zoom:{3}",ba.x,ba.y,oa,ra),ba=new O.a(ba.x,ba.y),ra=fa.g(this.$).rtl,ra=bk(this.Ked(ra)),ra.next(),ra=ra.next().value,
ra=bk(this.tgd(oa,ra)),oa=ra.next().value,ra=ra.next().value,fa.g(this.$).$ne(ba,oa,ra,R.a.oqe)):r.ULS.sendTraceTag(537149781,0,50,"Zooming top-left: from zoom:{0} to zoom:{1}",oa,ra)};c.prototype.zoomFitToScreen=function(){var ba=this.zoom,oa=fa.g(this.$).rtl,ra=bk(this.Ked(oa)),db=ra.next().value,Ka=ra.next().value,Ga=bk(this.tgd(ba,Ka));ra=Ga.next().value;var xa=Ga.next().value;(oa=(Ga=fa.g(this.$).ha.Oa.O4)?this.hYe(this.W9a,ra,xa,!1):this.X0e(this.W9a,Ka,db,ra,xa,oa,!1))?(oa=Math.min(ra/(oa.width+
100),xa/(oa.height+100)),oa=this.dBh(oa),this.lAa(oa,!0,"ZoomWithFitToScreen"),Ga?fa.g(this.$).ha.Oa.usa(fa.g(this.$).ha.Oa.Yb,!1):(oa=M.v(fa.g(this.$).ha.sa.activeRange,this.$),fa.g(this.$).gg(oa,null,null,null,3,R.a.jgg)),this.iBb=ba,this.fcf||this.xLg()):r.ULS.sendTraceTag(537149780,0,15,"ZoomManager.ZoomFitToScreen: Bounds found to be null with FloatingObjectSelected: {0}",Ga)};c.prototype.zoomFitToScreenUndo=function(){this.lAa(this.iBb,!1,"ZoomWithFitToScreen")};c.prototype.wQd=function(){return-1!==
this.iBb};c.prototype.xLg=function(){var ba=fa.g(this.$);ba&&(ba.ha.vG(this.Rc),ba.QD(this.Rc))};c.prototype.beh=function(){var ba=fa.g(this.$);ba&&(ba.ha.zF(this.Rc),ba.yF(this.Rc))};c.prototype.dBh=function(ba){ba=Math.min(ba,m.a.hzi);ba=Math.max(ba,m.a.$zi);return Math.round(100*ba)/100};c.prototype.lAa=function(ba,oa,ra){if(this.PCc()){var db=fa.g(this.$).view.visibleArea.toString();ba=this.rua(ba);var Ka=H.d(this.$.va.pa);Ka||(Ka=T.a.Tqf);fa.g(this.$).si.y7(5,ca.a.OCc,ra);fa.g(this.$).si.dla(ca.a.OCc,
this.$.ea.Ue);r.ULS.sendTraceTag(537149779,0,50,"ZoomManager.SetNewZoomLevel Setting zoom {0} to sheet {1} origin {2} prevZoom {3}",ba,Ka,ra,this.zoom);this.gtj(Ka,ba);this.zoomEventManager.M3i();this.vLj(ra);this.FLj(oa);this.iBb=-1;A.b(this.$,ra);r.ULS.sendTraceTag(537149778,0,50,"ZoomManager.SetNewZoomLevel OldGridVisibleArea: {0}, NewGridVisibleArea: {1}, IsShyRibbonActive: {2}",db,fa.g(this.$).view.visibleArea.toString(),this.$.Bka)}};c.prototype.EKh=function(ba){return(ba=P.HelperMethods.zC(this.$.tf,
this.$.domElement,ba))?ba:new Sys.UI.Point(0,0)};c.prototype.Ked=function(ba){var oa=this.EKh(ba);ba=this.oPh(oa,ba);return[oa,ba]};c.prototype.tgd=function(ba,oa){var ra=Q.DOMElementExtensions.getBounds(this.$.tf);return[Math.round((ra.width-oa.x)*ba),Math.round((ra.height-oa.y)*ba)]};c.prototype.oPh=function(ba,oa){oa=P.HelperMethods.zC(fa.g(this.$).domElement,this.$.domElement,oa);return oa?(ba=new Sys.UI.Point(Math.round(oa.x-ba.x),Math.round(oa.y-ba.y)),ba):new Sys.UI.Point(0,0)};c.prototype.LXj=
function(ba,oa,ra,db,Ka,Ga,xa){return(xa=this.X0e(ba,ra,db,Ka,Ga,xa))?this.T_e(xa,ba,oa,ra,db,Ka,Ga):null};c.prototype.X0e=function(ba,oa,ra,db,Ka,Ga,xa){xa=void 0===xa?!0:xa;var da=M.F(fa.g(this.$).ha.sa.selectedRanges);if(xa&&(da=da.ze(M.F(fa.g(this.$).icc())),!da))return r.ULS.sendTraceTag(537149777,0,50,"ZoomManager.GetSelectedRangeBounds No range inside the viewport is selected."),null;var qa=fa.g(this.$).Ub(da.topLeft);da=fa.g(this.$).Ub(da.bottomRight);if(!qa||!da)return r.ULS.sendTraceTag(537149776,
0,15,"ZoomManager.GetSelectedRangeBounds Cannot get cells for top-left or bottom-right of the selected range. Will zoom top-left"),null;ba=qa.cell.WJ===da.cell.WJ&&qa.cell.VJ===da.cell.VJ?this.xJh(ba,da,oa,ra,db,Ga):this.gZh(ba,qa,da,oa,ra,db,Ga);return ba?xa?this.USe(ba,db,Ka):ba:(r.ULS.sendTraceTag(537149775,0,15,"ZoomManager.GetSelectedRangeBounds got null bounds"),null)};c.prototype.USe=function(ba,oa,ra){if(0>ba.x||ba.x>oa)ba.x=0;if(0>ba.y||ba.y>ra)ba.y=0;ba.x+ba.width>oa&&(ba.width=oa-ba.x);
ba.y+ba.height>ra&&(ba.height=ra-ba.y);return ba};c.prototype.gZh=function(ba,oa,ra,db,Ka,Ga,xa){oa=fa.g(this.$).getCellBounds(oa.cell);if(!oa)return null;var da=fa.g(this.$).getCellBounds(ra.cell);if(!da)return null;var qa=Ka.x;xa&&(qa=0,oa.x=Math.round(Ga/ba)-oa.x-Math.round(oa.width),da.x=Math.round(Ga/ba)-da.x-Math.round(da.width));ba=new Sys.UI.Bounds(Math.round((oa.x-db.x)*ba)-qa,Math.round((oa.y-db.y)*ba-Ka.y),Math.round((da.x+da.width-oa.x)*ba),Math.round((da.y+da.height-oa.y)*ba));r.ULS.sendTraceTag(537149774,
0,50,"ZoomManager.GetTwoCellsBoundsWithZoom - a range with more than 1 cell was selected. Will zoom to range: (t:{0}, b:{1}, r:{2}, l:{3}) in bounds ({4}, {5}, {6}, {7})",ra.cell.getRange().top,ra.cell.getRange().bottom,ra.cell.getRange().right,ra.cell.getRange().left,ba.x,ba.y,ba.width,ba.height);return ba};c.prototype.xJh=function(ba,oa,ra,db,Ka,Ga){var xa=fa.g(this.$).getCellBounds(oa.cell);if(!xa)return null;var da=db.x;Ga&&(da=0,xa.x=Math.round(Ka/ba)-xa.x-Math.round(xa.width));ba=new Sys.UI.Bounds(Math.round((xa.x-
ra.x)*ba)-da,Math.round((xa.y-ra.y)*ba-db.y),Math.round(xa.width*ba),Math.round(xa.height*ba));r.ULS.sendTraceTag(537149773,0,50,"ZoomManager.GetCellBoundsWithZoom - single cell was selected. Will zoom to cell: (t:{0}, l:{1}) in bounds ({2}, {3}, {4}, {5})",oa.cell.getRange().top,oa.cell.getRange().left,ba.x,ba.y,ba.width,ba.height);return ba};c.prototype.JXj=function(ba,oa,ra,db,Ka,Ga){var xa=this.hYe(ba,Ka,Ga);return xa?this.T_e(xa,ba,oa,ra,db,Ka,Ga):null};c.prototype.T_e=function(ba,oa,ra,db,Ka,
Ga,xa){ba=new Sys.UI.Point(this.s0e(Ga,ba.x,ba.width),this.s0e(xa,ba.y,ba.height));return this.sed(ba,oa,ra,db,Ka)};c.prototype.s0e=function(ba,oa,ra){return ba===ra?(r.ULS.sendTraceTag(537149772,0,50,"ZoomManager.GetRelativePointCoordinate returning size/2 since the bounds are the same as the grid bounds"),ba/2):ba*oa/(ba-ra)};c.prototype.hYe=function(ba,oa,ra,db){db=void 0===db?!0:db;var Ka=fa.g(this.$).ha.Oa.Yb.domElement,Ga=P.HelperMethods.zC(Ka,fa.g(this.$).domElement,fa.g(this.$).rtl);if(!Ga)return r.ULS.sendTraceTag(537149771,
0,50,"ZoomManager.GetFloatingObjectBounds got null for floatingObjectPointOnGrid"),null;var xa=fa.g(this.$).dwb();Ga=new Sys.UI.Point(Math.round((Ga.x-xa.topLeft.x)*ba),Math.round((Ga.y-xa.topLeft.y)*ba));ba=new Sys.UI.Bounds(Ga.x,Ga.y,Math.round(Ka.offsetWidth*ba),Math.round(Ka.offsetHeight*ba));return db?this.USe(ba,oa,ra):ba};c.prototype.rrf=function(){this.wfb.qz()};c.prototype.NDi=function(ba){"ZoomToLevelInExcelLive"===ba?this.zoomEventManager.L3i():this.zoomEventManager.K3i()};c.prototype.N8i=
function(){this.zoomEventManager=this.$.da.Ga(419,new e)};c.prototype.sed=function(ba,oa,ra,db,Ka,Ga){Ga=void 0===Ga?"":Ga;var xa=fa.g(this.$).rtl?0:Ka.x;Ka="ZoomWithPinch"===Ga||"ZoomWithMouse"===Ga?new Sys.UI.Point(ba.x-xa-Math.round(db.x*oa),ba.y-Ka.y-Math.round(db.y*oa)):ba;Ka=new Sys.UI.Point(Math.round(Ka.x/oa),Math.round(Ka.y/oa));r.ULS.shipAssertTag(537149770,0,!!oa,"Original zoom level must be different than 0");xa=ra/oa;Ka=new Sys.UI.Point(Math.round(Ka.x*(1-1/xa)),Math.round(Ka.y*(1-1/
xa)));"ZoomWithMouse"===Ga||"ZoomWithPinch"===Ga?(Ka.x+=Math.round((db.x-fa.g(this.$).gI)*(xa-1)),Ka.y+=Math.round((db.y-fa.g(this.$).rJ)*(xa-1))):(xa=Math.round(db.x*(ra-oa)),0<xa&&Ka.x>xa&&(Ka.x+=xa),oa=Math.round(db.y*(ra-oa)),0<oa&&Ka.y>oa&&(Ka.y+=oa));"ZoomWithMouse"===Ga&&(ba.x||(Ka.x=0),ba.y||(Ka.y=0));ba=fa.g(this.$).dwb();return new Sys.UI.Point(Ka.x+ba.topLeft.x,Ka.y+ba.topLeft.y)};c.prototype.ALg=function(){var ba=this,oa=[];G.a.instance.Tb("Common.IGestureInputManager").execute(function(ra){0===
ra.POh()&&ra.y7i(document.body,new k(ba.$),oa)})};c.prototype.AXi=function(){return this.PCc()&&(F.a.Uo&&F.a.GLa(67)||this.$.jic)};c.prototype.gtj=function(ba,oa){A.a(this.$)?this.setZoomLevel(ba,oa,this.b_d,m.a.kHf):this.setZoomLevel(ba,oa,this.zoomPerSheetId,this.W9a)};c.prototype.setZoomLevel=function(ba,oa,ra,db){ra.remove(ba);oa!==db&&ra.add(ba,oa)};c.prototype.vLj=function(ba){this.OZf();this.$.hza(K.a.oZ("TriggerImmediateZoomOperations"));this.tTj();this.NDi(ba)};c.prototype.tTj=function(){this.jli()?
this.$.hf():this.wfb.qz();var ba=this.wfb.R2e("UpdateZoomStatusBar");ba&&(ba.innerText=this.hPb)};c.prototype.jli=function(){var ba=J.a(this.$);return ba?ba.Ql.wB===(C.a.Nwa(this.$)?U.a.Jqc:this.$.yb+U.a.fTf):!1};c.prototype.FLj=function(ba){fa.g(this.$).IXj(ba);this.LHg()};c.prototype.LHg=function(){var ba=ka.a(this.$);if(ba)for(var oa=bk(fa.g(this.$).Ea.FE()),ra=oa.next();!ra.done;ra=oa.next())if(ra=ra.value,!ra)r.ULS.sendTraceTag(537149768,0,15,"ZoomManager.AdjustSlicersToZoom - Cannot zoom slicers - cacheItem is null");
else{if(ra.sk&&(ra=ra.Ii))for(var db=0;db<ra.count;db++)if(2===ra.Wf(db).type){var Ka=ba.oq(ra.Wf(db).Gg());Ka?(Ka.iea(!1),r.ULS.sendTraceTag(537149766,0,50,"ZoomManager.AdjustSlicersToZoom - Slicer zoomed to zoom {0}",this.zoom)):r.ULS.sendTraceTag(537149767,0,50,"ZoomManager.AdjustSlicersToZoom - Cannot zoom slicers - control is null")}}else r.ULS.sendTraceTag(537149769,0,15,"ZoomManager.AdjustSlicersToZoom - Cannot zoom slicers - floatingObjectManager is null")};Object(u.a)(c,"ZoomManager",T.a,
[]);var Xa=b(1),aa=E.a;Rk(a,aa);a.prototype.create=function(){var ba=new c(this.$);this.vTj(ba);Xa.EwaSettings.isChangeGateEnabled("OfficeVSO:6143820_MoveServiceRegistrationFromFAM")&&this.$.da.Ga(368,ba);this.pb(ba)};a.prototype.vTj=function(ba){var oa=z.a(this.$);if(oa){var ra=oa.ygd("ZoomManagerFactory.UpdateZoomPerSheetIdFromExistingManager");ba.GOd(ra);ba.duc(oa.FAc)}else r.ULS.shipAssertTag(537149765,0,!0,"ZoomManagerFactory.UpdateZoomPerSheetIdFromExistingManager existingZoomManager is missing (expected to find here a DefaultZoomManager to pass zoom-per-sheet state from)")};
a.ka=function(ba){ba.da.Ga(369,new a(ba))};Object(u.a)(a,"ZoomManagerFactory",E.a,[]);b=b(1331);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Zoom");Type.registerNamespace("_Ewa");(function(){f.a.Fa(function(ba){a.ka(ba);l.ka(ba)})})();Object(b.a)()}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.zoom.js.map/a70a2492d7b19a9dda54c5b8d4ad0553/EwaDS.zoom.js.map