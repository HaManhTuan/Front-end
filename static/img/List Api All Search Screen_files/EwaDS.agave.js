/*
 The buffer module from node.js, for the browser.

 @author   Feross Aboukhadijeh <http://feross.org>
 @license  MIT
 ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[8],{1020:function(u,E,b){function a(d,e,k){this.fQb=d;this.zjg=e;this.Ajg=k}function c(){this.title=this.id=this.tabs=null}u=b(0);Object(u.a)(c,"AddInDataTransferObject",null,[]);b.d(E,"a",function(){return a});a.T2a=function(d){return(d=d.QV)?Object.assign(new c,{tabs:d.Bs.toArray(),id:d.TAg,title:d.UAg}):null};Mf.Object.defineProperties(a.prototype,{Bs:{configurable:!0,enumerable:!0,get:function(){return this.fQb}},TAg:{configurable:!0,
enumerable:!0,get:function(){return this.zjg}},UAg:{configurable:!0,enumerable:!0,get:function(){return this.Ajg}}});Object(u.a)(a,"OneLineRibbonExtensibility",null,[])},1057:function(u,E,b){function a(G,T,O){O=void 0===O?null:O;this.RDc=new r.a;var U=new f.a;T&&U.add(T.bxi);O&&U.addRange(O);this.Lm=G;this.sxg=U}function c(G,T,O,U){this.bT=new f.a;this.kG=new f.a;this.ipa=null;this.Jkb=new f.a;this.O9d=Promise.resolve(null);this.Ofe=!1;this.FVb=T;this.nmg=G;this.rge=O;this.Ejg=U}function d(){var G=
e.call(this)||this;G.errorCode=0;return G}function e(){this.MQb=new f.a;this.O9=this.N9=!1;this.eoa=this.authChallenge=null;this.startTime=this.retryCount=0;this.Fne=null}function k(){this.token=null;this.expiresOn=0;this.Wga=this.authChallenge=null}function l(){this.accessToken=null}function n(){this.startTime=0;this.callback=null}b.r(E);u=b(0);var f=b(202),v=b(14),r=b(100);Object(u.a)(n,"SSOCallbackInfo",null,[]);Object(u.a)(l,"AccessTokenInformation",null,[123]);var y=b(1171);Object(u.a)(k,"CachedTokenInfo",
null,[]);Mf.Object.defineProperties(e.prototype,{callbacks:{configurable:!0,enumerable:!0,get:function(){return this.MQb}}});Object(u.a)(e,"SSORequestInfo",null,[]);Rk(d,e);Object(u.a)(d,"SSOFailedRequestInfo",e,[]);var m=b(4);c.prototype.Qwj=function(G){if(this.ipa&&this.ipa.authChallenge===G.authChallenge){if(Date.now()/1E3+c.Ayi>this.ipa.expiresOn)return this.ipa=null,!1;G=new y.a;G.token=this.ipa.token;G.expiresOn=this.ipa.expiresOn;G.Wga=this.ipa.Wga;G.MSa=!0;G.bwb=0;this.twb(G);return!0}return!1};
c.prototype.yvj=function(G){for(var T=0;T<this.kG.count;T++)if(this.kG.na(T).authChallenge===G.authChallenge&&this.kG.na(T).eoa===G.eoa){var O=void 0;(O=this.kG.na(T)).retryCount=O.retryCount+1;G.retryCount=this.kG.na(T).retryCount;if(this.kG.na(T).retryCount<c.Yyi||!this.kG.na(T).N9&&G.N9||!this.kG.na(T).O9&&G.O9){if(!this.kG.na(T).N9&&G.N9||!this.kG.na(T).O9&&G.O9)G.retryCount=0;this.kG.removeAt(T);break}G=new y.a;G.errorCode=this.kG.na(T).errorCode;this.twb(G);return!0}return!1};c.prototype.KCg=
function(G,T){for(var O=0;O<this.kG.count;O++)if(this.kG.na(O).eoa===G.eoa&&this.kG.na(O).authChallenge===G.authChallenge)return;this.kG.add(Object.assign(new d,{N9:G.N9,O9:G.O9,authChallenge:G.authChallenge,eoa:G.eoa,errorCode:T,retryCount:G.retryCount}))};c.prototype.Dbd=function(G,T,O,U,J,H){var K=this,N=b(1057).AppsForOfficeSingleSignOnManager;""===O&&(O=null);if(this.Ofe)N.D5(H,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,null,null);else{for(var M=null,C=bk(this.bT),Q=C.next();!Q.done;Q=
C.next())if(Q=Q.value,Q.N9===G&&Q.O9===T&&Q.authChallenge===O&&Q.eoa===J){M=Q;break}M||(M=Object.assign(new e,{N9:G,O9:T,authChallenge:O,Fne:U,eoa:J,retryCount:0,startTime:N.aw()}),this.bT.add(M));M.retryCount=0;M.callbacks.add(H);this.O9d=this.O9d.then(function(){var P=b(1057).AppsForOfficeSingleSignOnManager;if(0<K.bT.count){var ka=K.bT.na(0);if(K.Qwj(ka)||K.yvj(ka))return null;for(var R=0;R<K.Jkb.count;)K.Jkb.na(R)+c.gIj<P.aw()?K.Jkb.removeAt(R):R++;if(K.Jkb.count>=c.Tyi||K.bT.count>=c.xyi)return ka=
new y.a,ka.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOCallThrottled,K.twb(ka),null;var fa=null;m.AFrameworkApplication.ta&&(P=m.AFrameworkApplication.ta.pD)&&(fa=P.sc("ComponentAttach",K.nmg+c.pwg));return ka.eoa.Ryg(K.resource,ka.N9,ka.O9,ka.authChallenge,K.Ejg,ka.Fne).then(function(ca){fa&&fa.stop();K.twb(ca)},function(){fa&&fa.stop();var ca=new y.a;ca.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;K.twb(ca)})}return null})}};c.prototype.twb=function(G){var T=b(1057).AppsForOfficeSingleSignOnManager;
try{if(this.bT.count){var O=this.bT.na(0);this.bT.removeAt(0);var U=null;G.errorCode||(U=new l,U.accessToken=G.token);G.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl&&G.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant&&G.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError&&G.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError||this.KCg(O,G.errorCode);var J={};null!=G.bwb&&(J.getTokenSilentTime=G.bwb.toString());null!=G.agd&&
(J.getTokenPopupTime=G.agd.toString());null!=G.Mdd&&(J.getIDTokenTime=G.Mdd.toString());null!=G.MSa&&(J.tokenCached=G.MSa.toString());G.mUd&&(J.detailedError=G.mUd);G.Wga&&(J.authLibrary=G.Wga);O.retryCount&&(J.retryCount=O.retryCount);for(var H=bk(O.callbacks),K=H.next();!K.done;K=H.next())T.D5(K.value,G.errorCode,U,J);null!=G.MSa&&G.MSa||this.Jkb.add(O.startTime);if(!G.errorCode)for(null!=G.expiresOn&&(this.ipa=Object.assign(new k,{token:G.token,expiresOn:G.expiresOn,authChallenge:O.authChallenge,
Wga:G.Wga})),this.kG.clear(),H=0;H<this.bT.count;)if(this.bT.na(H).authChallenge===O.authChallenge){var N=bk(this.bT.na(H).callbacks);for(K=N.next();!K.done;K=N.next())T.D5(K.value,G.errorCode,U,J);this.bT.removeAt(H)}else H++}}catch(M){v.ULS.sendTraceTag(21628945,344,10,"ReceivedAccessTokenHandler: exception message: {0}",M.message)}};c.prototype.shutdown=function(){this.Ofe=!0;this.bT.clear()};Mf.Object.defineProperties(c.prototype,{resource:{configurable:!0,enumerable:!0,get:function(){return this.FVb}}});
c.gIj=6E4;c.Tyi=6;c.xyi=6;c.Yyi=3;c.Ayi=300;c.pwg="GetAccessToken";Object(u.a)(c,"SSOCallbackManager",null,[]);var w=b(931),B=b(943),A=b(124),z=b(81),x=b(27),D=b(29),I=b(153),F=b(355);b.d(E,"AppsForOfficeSingleSignOnManager",function(){return a});a.prototype.Ebd=function(G,T,O,U,J,H,K,N,M,C){C=Object.assign(new n,{startTime:a.aw(),callback:C});try{var Q=!!O&&""!==O,P=C.startTime,ka=this.getOsfControl(G),R=ka.getStoreType()||"",fa=ka.getOwnerAddinStoreType()||"",ca=ka.getSolutionId()||"",ea=ka.getVersion()||
"";R=R.toLowerCase();fa=fa.toLowerCase();ca=ca.toLowerCase();var wa=z.a.Ldd(T)||"",X=z.a.Ldd(ka.getIframeUrl())||"",ja=wa.toLowerCase()===X.toLowerCase();wa=R;"inmemory"===R&&(wa=fa);var va=Telemetry.PrivacyRules.GetPrivacyCompliantId(ca,wa,ka.getAssetId(),null,null,ka.getStoreId());ka={};var ua=(ka.callInstanceId=P.toString(),ka.controlAssetId=va,ka.controlVersion=ea,ka.storeType=R,ka.ownerStoreType=fa,ka.allowConsentPrompt=U.toString(),ka.forMSGraphAccess=J.toString(),ka.allowSignInPrompt=H.toString(),
ka.hasAddinAuthChallenge=Q.toString(),ka.securityOriginEqualsSourceLocation=ja.toString(),ka.singleSignOnEnabled=K.toString(),ka.accountTypeFilter=N||"",ka);v.ULS.sendTraceTag(51401115,344,50,"{0}",ua);I.a.sendTelemetryEvent(Object.assign(new F.a,{name:"Office.Online.Extensibility.SSO.GetAccessTokenV2Start",dataFields:A.a.Uk(ua)}));P=!0;var Xa=m.AFrameworkApplication.fa.Wa("HostAuthType");switch(N){case "aad":P="aad"===Xa;break;case "msa":P="msa"===Xa;break;default:P=!N||"noFilter"===N}if(P){N=null;
if(K)for(var aa=bk(this.sxg),ba=aa.next();!ba.done;ba=aa.next()){var oa=ba.value;if(oa.Agi(ca)){N=oa;break}}N?this.isSSOAddin(G)?(K=!0,"omex"===wa&&(K=!1),"spapp"===wa||"spcatalog"===wa?(v.ULS.sendTraceTag(594043737,344,10,"GetAccessToken: SharePoint catalog add-ins not supported."),a.D5(C,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)):J&&!K?(v.ULS.sendTraceTag(51234570,344,10,"GetAccessToken: Store add-ins do not support tokens for graph access."),a.D5(C,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,
null,null)):(J&&"exchange"===wa&&(U=!1),this.Dbd(G,T,O,wa,U,H,M,N,C))):(v.ULS.sendTraceTag(22402395,344,10,"GetAccessToken: current Addin is not a SSO Addin."),a.D5(C,OSF.DDA.ErrorCodeManager.errorCodes.ooeNotSSOAgave,null,null)):a.D5(C,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)}else a.D5(C,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedUserIdentity,null,null)}catch(ra){this.Fjc(),v.ULS.sendTraceTag(22402397,344,10,"GetAccessToken: action failed. Exception message: {0}",
ra.message),a.D5(C,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,null,null)}};a.prototype.getAccessToken=function(G,T,O,U){this.Ebd(G,O[w.a.WUc]||null,O[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AuthChallenge]||null,O[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowConsentPrompt]||!1,O[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.ForMSGraphAccess]||!1,O[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowSignInPrompt]||!1,T,O[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AccountTypeFilter]||
null,O[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AddinTrustId]||null,U)};a.prototype.Dbd=function(G,T,O,U,J,H,K,N,M){this.RDc.kb(G)?U=this.RDc.na(G):(U=new c(G,this.getWebApplicationResource(G).split(",")[0],U,this.getDefaultDisplayName(G)),this.RDc.add(G,U));var C=U.resource;G=a.rVh(C,this.getWebApplicationId(G));var Q=OfficeExt.WACUtils.getHostSecure(T);G&&Q?G.toLowerCase()===Q.toLowerCase()?U.Dbd(J,H,O,K,N,M):(a.sNa('SSO Resource "'+C+'" cannot be used from "'+T+'" origin due to domain mismatch.'),
v.ULS.sendTraceTag(22402396,344,10,"GetAccessToken: current Addin's host does not match its Web Application's resource."),a.D5(M,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,null,null)):(G||v.ULS.sendTraceTag(594118746,344,10,"Invalid resource URL for SSO."),Q||v.ULS.sendTraceTag(594118745,344,10,"Invalid page URL for SSO."),a.D5(M,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,null,null))};a.prototype.Fjc=function(){var G={};v.ULS.sendTraceTag(39068820,344,50,"Browser information: {0}",
(G.UserAgent=window.navigator.userAgent,G))};a.prototype.getOsfControl=function(G){return this.Lm.getOsfControl(G)};a.prototype.isSSOAddin=function(G){return this.getOsfControl(G).getManifest().isSSOAddin()};a.prototype.getWebApplicationId=function(G){return this.getOsfControl(G).getManifest().getWebApplicationId()};a.prototype.getWebApplicationResource=function(G){return this.getOsfControl(G).getManifest().getWebApplicationResource()};a.prototype.getDefaultDisplayName=function(G){return this.getOsfControl(G).getManifest().getDefaultDisplayName()};
a.bXh=function(){try{var G={};x.a.Wwa&&B.a.lxb&&(G.UiHostSupportsAuthTokenAddinList=a.ISe);G.UiHostSupportsAuthToken=B.a.lxb;return G}catch(T){v.ULS.sendTraceTag(561860814,344,10,"GetSingleSignOnRuntimeSettings: exception message: {0}",T.message)}return null};a.getInstance=function(G,T,O){a.Ma||(a.Ma=new a(G,void 0===O?null:O));return a.Ma};a.sNa=function(G){window.console.warn&&window.console.warn(G)};a.rVh=function(G,T){if(!G)return"";T||(T="");var O=G.toLowerCase(),U=T.toLowerCase();RegExp("^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$").test(U)||
(a.sNa('SSO App Id "'+T+'" is not a valid format. It will be rejected from store submission.'),v.ULS.sendTraceTag(590962907,344,10,"App id does not match a GUID."));O.endsWith(U)||(a.sNa('SSO Resource "'+G+'" does not end with App Id "'+T+'". It will be rejected from store submission.'),v.ULS.sendTraceTag(590962908,344,10,"Resource does not end with app id."));if(!O.startsWith("https://")&&!O.startsWith("api://"))return a.sNa('SSO Resource "'+G+'" must be https:// or api:// protocol.'),v.ULS.sendTraceTag(590962909,
344,10,"Resource not using https or api protocol."),"";for(T=0;T<G.length;T++){U=G.charAt(T);var J=D.a.charCodeAt(G,T);if(33>J||126<J||"&"===U||"?"===U||"#"===U||"%"===U||"\\"===U)return a.sNa('SSO Resource "'+G+'" contains an invalid character "'+U+'".'),v.ULS.sendTraceTag(590962910,344,10,"Invalid character '"+U+"' in resource URI."),""}if(0<=G.indexOf("::"))return a.sNa('SSO Resource "'+G+'" contains an invalid string "::".'),v.ULS.sendTraceTag(590962911,344,10,":: in resource URI."),"";if(120<
G.length)return a.sNa('SSO Resource "'+G+'" is '+G.length+" characters and exceeds the max length of 120 characters."),v.ULS.sendTraceTag(590962912,344,10,"Length of resource: "+G.length+"."),"";O.startsWith("api://")&&(O="https://"+O.substring(6,O.length));return 8===O.length?"":OfficeExt.WACUtils.getHostSecure(O)||""};a.D5=function(G,T,O,U){var J=G.startTime,H=0;0<J&&(H=a.aw()-J);var K={};J=(K.callInstanceId=J.toString(),K.callDuration=H.toString(),K.errorCode=T.toString(),K);if(U)for(var N in U)J[N]=
U[N];v.ULS.sendTraceTag(51401116,344,50,"{0}",J);I.a.sendTelemetryEvent(Object.assign(new F.a,{name:"Office.Online.Extensibility.SSO.GetAccessTokenV2End",dataFields:A.a.Uk(J)}));G.callback(T,O)};a.aw=function(){try{if(window.performance&&window.performance.now)return window.performance.now()}catch(G){}return Date.now()};a.ISe="wa200000047 wa104381973 42de5e8d-cfa0-459d-813d-cf777d47ada0 97d94c7b-54e5-4098-8dbb-b486b6c1f049 wa104381526 d98404ac-f9e2-4292-8cb6-eec349559ae5".split(" ");a.Ma=null;Object(u.a)(a,
"AppsForOfficeSingleSignOnManager",null,[94])},1072:function(u,E,b){function a(){var d={};this.$Pe=(d.tabhome="Ribbon.Home",d.tabinsert="Ribbon.Insert",d.tabdata="Ribbon.Data",d.tabreview="Ribbon.Review",d.tabview="Ribbon.View",d);d={};this.ZPe=(d.tabpagelayoutexcel=["Ribbon.PageLayoutExcel",c.a.instance.ga(1613),c.a.instance.ga(1617)],d.tabformulas=["Ribbon.Formulas",c.a.instance.ga(1614),c.a.instance.ga(1618)],d.tabdeveloper=["Ribbon.Developer",c.a.instance.ga(1615),c.a.instance.ga(1619)],d.tabaddins=
["Ribbon.AddIns",c.a.instance.ga(1616),c.a.instance.ga(1620)],d);this.D8b=null}b.d(E,"a",function(){return a});u=b(0);var c=b(15);a.prototype.kRh=function(){if(!this.D8b){this.D8b={};for(var d=bk(Object.keys(this.$Pe)),e=d.next();!e.done;e=d.next())e=e.value,this.D8b[e]=this.$Pe[e];d=bk(Object.keys(this.ZPe));for(e=d.next();!e.done;e=d.next())e=e.value,this.D8b[e]=this.ZPe[e][0]}};Mf.Object.defineProperties(a.prototype,{Lha:{configurable:!0,enumerable:!0,get:function(){return"SourceControlId"}},LM:{configurable:!0,
enumerable:!0,get:function(){return"Workbook"}},formFactor:{configurable:!0,enumerable:!0,get:function(){return"DesktopFormFactor"}}});Object(u.a)(a,"AddinCommandsStringProvider",null,[892])},1074:function(u,E,b){function a(){this.iLa=0;this.lha=this.buttonText=this.description=this.title=this.id=null;this.errorCode=0;this.Gdc=!1;this.i8e=this.bia=null}b.d(E,"a",function(){return a});u=b(0);Object(u.a)(a,"AddInCommandsNotificationParameters",null,[])},1144:function(u,E,b){function a(){}function c(){}
function d(J,H,K,N,M,C){J=e.call(this,J,H,K,N,M,void 0===C?null:C)||this;J.tUb=null;return J}function e(J,H,K,N,M,C){J=k.call(this,J,K,M.aX,void 0===C?null:C)||this;J.nae=0;J.$0=J.pRh(N);J.xXa=H;J.Re=M;J.hJj=7;J.gl=J.xXa.ownerDocument.createElement("div");J.gl.className="ModalCalloutControlOverlay";J.gl.tabIndex=0;J.xXa.insertBefore(J.gl,J.xXa.firstChild);return J}function k(J,H,K,N){var M=y.call(this,document.createElement("div"))||this;M.Cqa=null;M.dpa=null;M.mG=null;M.hG=null;M.Pw=null;M.zS=null;
M.BS=null;M.Spa=!1;M.vib=!1;M.vp=null;M.content=null;M.$0=0;M.nse=null;M.MT=0;M.TBf=null;M.Oge=J;M.ece=H;M.aP=K;M.AY=N;M.ng=H.ownerDocument;M.Oib=!1;M.Pu=!1;M.eid=!1;return M}u=b(0);var l=b(14),n=b(84),f=b(158),v=b(13),r=b(88),y=Sys.UI.Control;Rk(k,y);k.prototype.show=function(){this.Oib||(this.B5g(),this.Vn(),this.ece.appendChild(this.UV),this.UV.style.display="Block",this.tsj(),this.Oib=!0,this.TBf&&this.TBf())};k.prototype.dismiss=function(){this.Oib&&(this.W0a(),this.ece.removeChild(this.UV),
this.Oib=!1,this.AY&&this.AY())};k.prototype.dispose=function(){this.dismiss();this.zS=this.Pw=this.hG=this.dpa=this.mG=this.Cqa=null;Sys.Component.prototype.dispose.call(this)};k.prototype.$h=function(J){return this.get_element().id+J};k.prototype.B5g=function(){this.mG=this.ng.createElement("div");this.mG.id=this.$h("WACCalloutHeader");this.mG.className="WACCalloutHeader";this.Pu&&this.dke();this.eid&&this.vle();this.hG=this.ng.createElement("div");this.hG.id=this.$h("WACCalloutContent");this.hG.className=
"WACCalloutContent";this.hG.style.width=190<this.$0?this.$0-26+"px":"164px";this.hG.appendChild(this.content);this.UV.appendChild(this.n0b);this.UV.appendChild(this.mG);this.UV.appendChild(this.hG)};k.prototype.dke=function(){this.Pw=this.ng.createElement("a");this.Pw.className="WACCalloutCloseAnchor";this.Pw.id=this.$h("WACCalloutCloseAnchor");this.Pw.href="#";this.mG.appendChild(this.Pw);var J=f.createClusteredImage(16,16,"ClosePaneGlyph_16x16x32","WACCalloutCloseIcon",!0,CommonUIStrings.l_DialogClose);
this.Pw.appendChild(J)};k.prototype.vle=function(){this.zS=this.ng.createElement("div");this.zS.className="WACCalloutTitle UIFontBold";this.zS.style.width=190<this.$0?this.$0-30+"px":"160px";this.zS.id=this.$h("WACCalloutTitle");this.zS.innerText=this.title;this.mG.contains(this.Pw)?this.mG.insertBefore(this.zS,this.Pw):this.mG.appendChild(this.zS)};k.prototype.tsj=function(){var J=this.Oge;if(1===this.MT){var H=this.nse.y+16;var K=-16}else 2===this.MT||3===this.MT||0===this.MT?(H=J.y+J.height+15,
K=-15):(H=J.y-this.UV.clientHeight-15-2,K=this.UV.clientHeight-1);this.UV.style.top=H+"px";this.n0b.style.top=K+"px";1===this.MT?(J=this.nse.x-16,this.UV.style.left="50%",this.UV.style.marginLeft=-this.$0/2+"px",H=Sys.UI.DomElement.getBounds(this.UV),this.n0b.style.left=J-H.x+"px"):(H=J.x+this.Oge.width/2,2===this.MT||5===this.MT?(J=20,H-=36):0===this.MT||4===this.MT?(J=this.$0/2-16,H-=this.$0/2):(J=this.$0-20-32,H=H-this.$0+36),this.UV.style.left=H+"px",this.n0b.style.left=J+"px")};k.prototype.Vn=
function(){this.Pu&&!this.BS&&(this.BS=Object(n.a)(this,this.u$,"closeHandler"),this.aP.ra(v.a.click,this.Pw,this.BS,null))};k.prototype.W0a=function(){this.Pu&&this.BS&&(this.aP.Ba(v.a.click,this.Pw,this.BS),this.BS=null)};k.prototype.u$=function(){this.dismiss();return!0};Mf.Object.defineProperties(k.prototype,{UV:{configurable:!0,enumerable:!0,get:function(){this.Cqa||(this.Cqa=this.ng.createElement("div"),this.Cqa.id=this.$h("WACCalloutOuter"),this.Cqa.className="WACCalloutOuter",this.Cqa.setAttribute(r.a.Hd,
r.a.ZYa),this.Cqa.style.width=this.$0+"px");return this.Cqa}},n0b:{configurable:!0,enumerable:!0,get:function(){if(!this.dpa){this.dpa=this.ng.createElement("div");this.dpa.id=this.$h("WACCalloutBeakContainer");this.dpa.className="WACCalloutBeakContainer";var J="CalloutBeakTopFilled_32x16x32";if(5===this.MT||6===this.MT||4===this.MT)J="CalloutBeakBottomFilled_32x16x32";J=f.createClusteredImage(32,16,J,"WACCalloutBeak",!0,"");this.dpa.appendChild(J)}return this.dpa},set:function(J){this.dpa=J}},MLa:{configurable:!0,
enumerable:!0,get:function(){return this.Oib}},title:{configurable:!0,enumerable:!0,get:function(){return this.vp},set:function(J){this.vp!==J&&(this.vp=J,this.zS&&(this.zS.innerText=this.vp))}},Pu:{configurable:!0,enumerable:!0,get:function(){return this.Spa},set:function(J){this.Spa!==J&&(this.Spa=J,this.mG&&(this.mG.contains(this.Pw)&&!this.Spa?this.mG.removeChild(this.Pw):!this.mG.contains(this.Pw)&&this.Spa&&this.dke()))}},eid:{configurable:!0,enumerable:!0,get:function(){return this.vib},set:function(J){this.vib!==
J&&(this.vib=J,this.mG&&(this.mG.contains(this.zS)&&!this.vib?this.mG.removeChild(this.zS):!this.mG.contains(this.zS)&&this.vib&&this.vle()))}}});Object(u.a)(k,"Callout",Sys.UI.Control,[252]);Rk(e,k);e.prototype.show=function(){this.MLa||(this.Re.Lpc(),this.Re.sP(!1),this.gl.style.zIndex=String(this.Re.c2),k.prototype.show.call(this),this.Pi(),this.nae=window.setTimeout(Object(n.a)(this,this.dismiss,"dismiss"),1E3*this.hJj))};e.prototype.dismiss=function(){this.MLa&&(this.Re.oM(!1),this.Tj(),this.xXa&&
this.xXa.contains(this.gl)&&this.xXa.removeChild(this.gl),k.prototype.dismiss.call(this),window.clearTimeout(this.nae))};e.prototype.Pi=function(){this.Re.Dra(Object(n.a)(this,this.dismiss,"dismiss"));this.Re.sy.ra(v.a.click,this.gl,Object(n.a)(this,this.$c,"onClick"))};e.prototype.Tj=function(){this.Re.Yab(Object(n.a)(this,this.dismiss,"dismiss"));this.Re.sy.Ba(v.a.click,this.gl,Object(n.a)(this,this.$c,"onClick"))};e.prototype.$c=function(){this.dismiss();return!0};e.prototype.pRh=function(J){var H=
0;switch(J){case 0:H=190;break;case 1:H=250;break;case 2:H=300;break;case 3:H=360}return H};Object(u.a)(e,"ModalCallout",k,[]);var m=b(628),w=b(204);Rk(d,e);d.prototype.show=function(){var J=this;if(!this.MLa){var H=Object.assign(new m.a,{onShow:function(){e.prototype.show.call(J)}});w.UISurfaces.wQ().then(function(K){var N=K.externalNotification();J.tUb=K.addNotification(N,H);return null},function(K){l.ULS.sendTraceTag(593352345,383,15,"Failed to GetNotificationsAPIAsync: {0}",K);return null})}};
d.prototype.dismiss=function(){var J=this;this.MLa&&this.tUb&&(w.UISurfaces.wQ().then(function(H){H.removeNotification(J.tUb);return J.tUb=null},function(H){l.ULS.sendTraceTag(593352344,383,15,"Failed to GetNotificationsAPIAsync: {0}",H);return null}),e.prototype.dismiss.call(this))};Object(u.a)(d,"ReactManagedModalCallout",e,[]);var B=b(4);c.k7g=function(J,H,K){var N=void 0===N?null:N;return B.AFrameworkApplication.ta.Qa.RQ?new d(J,H,K,3,B.AFrameworkApplication.ta,N):new e(J,H,K,3,B.AFrameworkApplication.ta,
N)};Object(u.a)(c,"ModalCalloutControlFactory",null,[]);var A=b(52),z=b(1070),x=b(643),D=b(1071),I=b(135),F=b(55),G=b(39),T=b(83),O=b(1020),U=b(906);b.d(E,"a",function(){return a});a.RBe=function(J,H,K,N){a.RI&&a.RI.MLa&&a.RI.dismiss();a.RI=c.k7g(H,J,J);a.RI.content=K;U.b(N)||(a.RI.title=N,a.RI.eid=!0);J=new Sys.UI.Bounds(0,0,F.a.gcc(),F.a.fcc());a.RI.MT=a.nJh(J,H,a.RI.$0);a.RI.show();a.K_b&&a.K_b.sendNotification(K.innerText,!0)};a.o2c=function(J,H,K,N){N=void 0===N?null:N;w.UISurfaces.wQ().then(function(M){var C=
null;a.Gkb&&(M.removeNotification(a.Gkb),a.Gkb=null);var Q=M.callout(Object.assign(new z.a,{target:J,title:H,content:K,showCloseIcon:!0,hasDynamicSizing:!0,jumpToCalloutTargetButtonEnabled:!0,calloutProps:Object.assign(new D.a,{onDismiss:function(){M.removeNotification(C)},directionalHint:null!=N?N:null})})),P=Object.assign(new m.a,{expirationOptions:Object.assign(new x.a,{displayTimeoutSeconds:7,onExpire:function(){M.removeNotification(a.Gkb)}})});C=a.Gkb=M.addNotification(Q,P);return null},function(M){l.ULS.sendTraceTag(593352342,
383,15,"Failed to GetNotificationsAPIAsync: {0}",M);return null})};a.EQd=function(J,H){H=void 0===H?null:H;a.RI&&a.RI.MLa&&a.RI.dismiss();var K=new I.StandardDialog;K.PRa=!1;K.Rb=0;K.Iz(A.a.iqi,CommonUIStrings.l_DialogError,U.b(J)?a.tXe():J,H)};a.GQd=function(J){a.RI&&a.RI.MLa&&a.RI.dismiss();l.ULS.sendTraceTag(17425951,220,10,String.format("AddinCommandsActivationError : error code {0}.",J.errorCode));var H=U.b(J.description)?a.tXe():J.description,K=new I.StandardDialog,N=null;J.lha?(K.Rb=1,K.mc(1,
J.buttonText),K.k7(1)):K.Rb=0;N=function(M){1===M?J.lha():J.bia&&J.bia()};K.PRa=!1;0===J.iLa?K.Iz(J.errorCode,J.title?J.title:CommonUIStrings.l_DialogError,H,N):1===J.iLa?K.XW(J.title?J.title:CommonUIStrings.l_DialogWarning,H,N):K.zAa(J.title?J.title:CommonUIStrings.l_DialogInfo,H,N)};a.nJh=function(J,H,K){var N=4,M=J.x+J.width-H.x-H.width;H.x-J.x+H.width/2<=K/2?N=5:M+H.width/2<=K/2&&(N=6);return N};a.syj=function(J,H,K,N){N=void 0===N?!1:N;(H=O.a.T2a(H))&&appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn&&
appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(H,function(M){M&&(N||a.o2c(M,K,J,5))})};a.tyj=function(J,H,K){K=void 0===K?!1:K;a.syj(H.startedNode?H.startedNode.description:String.format(CommonUIStrings.l_NewAddInLoadedContent,J),H,H.startedNode?H.startedNode.title:String.format(CommonUIStrings.l_NewAddInLoadedTitle,J),K)};a.ryj=function(J,H,K,N){if(a.Hdg)J=String.format(CommonUIStrings.l_ErrorLoadingAddInsContentOuterString,String.format(CommonUIStrings.l_ErrorLoadingAddInsContentInnerString,
K,N,CommonUIStrings.l_InsertionDialogRefresh)),a.o2c(H,J,CommonUIStrings.l_ErrorLoadingAddInsTitle,1);else{H=G.a.Po(H);var M=CommonUIStrings.l_ErrorLoadingAddInsContentOuterString.split("{0}"),C=document.createElement("span");C.innerText=M[0];var Q=document.createElement("span");Q.innerText=String.format(CommonUIStrings.l_ErrorLoadingAddInsContentInnerString,K,N,CommonUIStrings.l_InsertionDialogRefresh);Q.className="UIFontBold";K=document.createElement("span");K.innerText=M[1];N=document.createElement("div");
Sys.UI.DomElement.addCssClass(N,"ModalCalloutControl");N.appendChild(C);N.appendChild(Q);N.appendChild(K);a.RBe(J,H,N,CommonUIStrings.l_ErrorLoadingAddInsTitle)}};a.Jzj=function(J,H){var K=CommonUIStrings.l_InstallingCustomFunctionsErrorCalloutMsg,N=CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg;a.Hdg?a.o2c(H,K,N):(H=G.a.Po(H),a.RBe(J,H,a.vRg(N),K))};a.vRg=function(J){var H=document.createElement("div");Sys.UI.DomElement.addCssClass(H,"ModalCalloutControl");H.innerText=J;return H};a.tXe=
function(){return CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive};Mf.Object.defineProperties(a,{K_b:{configurable:!0,enumerable:!0,get:function(){return a.Mea||(a.Mea=T.a.instance.mh("Common.Utils.IAriaNotifier"))}},Hdg:{configurable:!0,enumerable:!0,get:function(){return B.AFrameworkApplication.ta.Qa.vi&&B.AFrameworkApplication.ta.Qa.RQ}}});a.RI=null;a.Gkb=null;a.Mea=null;Object(u.a)(a,"AddInCommandsNotificationFactory",null,[])},1154:function(u,E,b){function a(w,B,
A,z,x){this.Ww=w;this.GI=A;this.n1=z;this.Jd=x;this.bhb=this.GI.Qh;this.zy=this.bhb.getOsfControl(B);this.Urg=this.zy.getManifest()}function c(w,B,A,z){this._id=w;this.Ww=B;this.n1=A;this.Jd=z}function d(w,B,A,z){this.bA=!1;this._id=w;this.Ww=B;this.n1=A;this.Jd=z}b.r(E);u=b(0);var e=b(14),k=b(1666),l=b(153),n=b(124),f=b(931),v=b(945),r=b(355);d.prototype.setEnabled=function(){};d.prototype._OnAccess=function(){};d.prototype.getTypeName=function(){return"Microsoft.DynamicRibbon.RibbonButton"};d.prototype.invokePropertyGet=
function(w){switch(w){case 3:return this.enabled;case 2:return this.id;case 4:return this.label}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(w);};d.prototype.invokePropertyGetAsync=function(w){w=this.invokePropertyGet(w);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(w)};d.prototype.invokePropertySet=function(w,B){switch(w){case 3:this.enabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(B,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(w);
};d.prototype.invokePropertySetAsync=function(w,B){this.invokePropertySet(w,B);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};d.prototype.invokeMethod=function(w,B){switch(w){case 5:return this.epj(B);case 1:return this.eCa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(w);};d.prototype.invokeMethodAsync=function(w,B){w=this.invokeMethod(w,B);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(w)};d.prototype.epj=function(w){w=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(w,
0,"boolean");this.setEnabled(w);return null};d.prototype.eCa=function(){this._OnAccess();return null};Mf.Object.defineProperties(d.prototype,{enabled:{configurable:!0,enumerable:!0,get:function(){return this.bA},set:function(w){var B=b(1154).DynamicRibbon,A=this.Jd.OwnerAddinStoreType,z=this.Jd.PrimaryMarketplace.MarketplaceRef,x=this.Jd.AssetMarketplace?this.Jd.AssetMarketplace.SolutionId:null,D=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Ww,A,null,null,null,z),I={};A=(I.addinSolutionId=D,
I.ownerAddinSolutionId=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Jd.OwnerAddinSolutionId,A,x,null,null,z),I.ownerAddinStoreType=A,I.ribbonControlType="Button",I.toggle=w,I);l.a.sendTelemetryEvent(Object.assign(new r.a,{name:B.fzc+"ControlUpdate",dataFields:n.a.Uk(A)}));this.bA=w;w={};D=(w.DynamicAddinCommandsMethodDispatchId=1,w.SolutionId=this.Ww,w.PrivacyCompliantSolutionId=D,w.SourceControlId=this.id,w.MethodData=this.bA,w);this.n1.SJ(-1014260128,D)}},id:{configurable:!0,enumerable:!0,
get:function(){return this._id}},label:{configurable:!0,enumerable:!0,get:function(){return null}}});Object(u.a)(d,"RibbonButton",null,[]);c.prototype.setVisibility=function(w){var B=b(1154).DynamicRibbon,A=this.Jd.OwnerAddinStoreType,z=this.Jd.PrimaryMarketplace.MarketplaceRef,x=this.Jd.AssetMarketplace?this.Jd.AssetMarketplace.SolutionId:null,D=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Ww,A,x,null,null,z),I={};z=(I.addinSolutionId=D,I.ownerAddinSolutionId=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Jd.OwnerAddinSolutionId,
A,x,null,null,z),I.ownerAddinStoreType=A,I.ribbonControlType="Tab",I.toggle=w,I);l.a.sendTelemetryEvent(Object.assign(new r.a,{name:B.fzc+"ControlUpdate",dataFields:n.a.Uk(z)}));B={};w=(B.DynamicAddinCommandsMethodDispatchId=2,B.SolutionId=this.Ww,B.PrivacyCompliantSolutionId=D,B.StoreType=A,B.SourceControlId=this.id,B.MethodData=w,B);this.n1.SJ(-1014260128,w)};c.prototype._OnAccess=function(){};c.prototype.getTypeName=function(){return"Microsoft.DynamicRibbon.RibbonTab"};c.prototype.invokePropertyGet=
function(w){switch(w){case 2:return this.id}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(w);};c.prototype.invokePropertyGetAsync=function(w){w=this.invokePropertyGet(w);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(w)};c.prototype.invokePropertySet=function(w){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(w);};c.prototype.invokePropertySetAsync=function(w,B){this.invokePropertySet(w,B);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};
c.prototype.invokeMethod=function(w,B){switch(w){case 3:return this.Ysj(B);case 1:return this.eCa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(w);};c.prototype.invokeMethodAsync=function(w,B){w=this.invokeMethod(w,B);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(w)};c.prototype.Ysj=function(w){w=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(w,0,"boolean");this.setVisibility(w);return null};c.prototype.eCa=function(){this._OnAccess();return null};
Mf.Object.defineProperties(c.prototype,{id:{configurable:!0,enumerable:!0,get:function(){return this._id}}});Object(u.a)(c,"RibbonTab",null,[]);var y=b(1172),m=b(180);b.d(E,"DynamicRibbon",function(){return a});a.prototype.executeRequestCreate=function(w){try{var B=this.Jd.OwnerAddinStoreType,A=this.Jd.PrimaryMarketplace.MarketplaceRef,z=this.Jd.AssetMarketplace?this.Jd.AssetMarketplace.SolutionId:null,x=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Ww,B,z,null,null,A),D={},I=(D.addinSolutionId=
x,D.ownerAddinSolutionId=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Jd.OwnerAddinSolutionId,B,z,null,null,A),D.ownerAddinStoreType=this.Jd.OwnerAddinStoreType,D.ribbonControlType="Ribbon",D);l.a.sendTelemetryEvent(Object.assign(new r.a,{name:a.fzc+"ExecuteRequestCreate",dataFields:n.a.Uk(I)}));var F=m.a.Th(w);w={};B={};B[f.a.rIa]=this.zy;B[f.a.sIa]=F;B[f.a.v6c]=this.Jd;w[f.a.zsb]=3;w[f.a.C3]=this.Ww;w[f.a.j7b]=x;w[f.a.B3]=B;this.n1.SJ(-1014260128,w);var G=a.B$b("ExecuteRequestCreate",!0,"");
e.ULS.sendTraceTag(538572826,0,50,G)}catch(T){x=a.B$b("ExecuteRequestCreate",!1,T.toString()),e.ULS.sendTraceTag(538572825,0,50,x)}return null};a.prototype.executeRequestUpdate=function(w){try{var B=this.Jd.OwnerAddinStoreType,A=this.Jd.PrimaryMarketplace.MarketplaceRef,z=this.Jd.AssetMarketplace?this.Jd.AssetMarketplace.SolutionId:null,x=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Ww,B,z,null,null,A),D={},I=(D.addinSolutionId=x,D.ownerAddinSolutionId=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Jd.OwnerAddinSolutionId,
B,z,null,null,A),D.ownerAddinStoreType=this.Jd.OwnerAddinStoreType,D.ribbonControlType="Ribbon",D);l.a.sendTelemetryEvent(Object.assign(new r.a,{name:a.fzc+"ExecuteRequestUpdate",dataFields:n.a.Uk(I)}));var F=m.a.Th(w);w={};B={};B[f.a.rIa]=this.zy;B[f.a.sIa]=F;B[f.a.v6c]=this.Jd;w[f.a.zsb]=3;w[f.a.C3]=this.Ww;w[f.a.j7b]=x;w[f.a.B3]=B;this.n1.SJ(-1014260128,w);var G=a.B$b("ExecuteRequestUpdate",!0,"");e.ULS.sendTraceTag(538572824,0,50,G)}catch(T){x=a.B$b("ExecuteRequestUpdate",!1,T.toString()),e.ULS.sendTraceTag(538572823,
0,50,x)}return null};a.prototype.getButton=function(w){var B=null;if(!this.Bbf())return this.TBe();if(w&&0<w.length){if(!this.bxe(w))return this.lCe(w);B=new d(w,this.Ww,this.n1,this.Jd)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(B)};a.prototype.getTab=function(w){var B=null;if(!this.Bbf())return this.TBe();if(this.zy.getOwnerAddinControlRecreated())return this.z6g();if(w&&0<w.length){if(!this.bxe(w))return this.lCe(w);B=new c(w,this.Ww,this.n1,this.Jd)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(B)};
a.prototype._OnAccess=function(){};a.prototype.getTypeName=function(){return"Microsoft.DynamicRibbon.DynamicRibbon"};a.prototype.invokePropertyGet=function(w){switch(w){case 4:return this.buttons}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(w);};a.prototype.invokePropertyGetAsync=function(w){w=this.invokePropertyGet(w);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(w)};a.prototype.invokePropertySet=function(w){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(w);
};a.prototype.invokePropertySetAsync=function(w,B){this.invokePropertySet(w,B);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};a.prototype.invokeMethod=function(w){switch(w){case 1:return this.eCa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(w);};a.prototype.invokeMethodAsync=function(w,B){switch(w){case 7:return this.Gwh(B);case 6:return this.Hwh(B);case 3:return this.TIh(B);case 5:return this.XXh(B)}w=this.invokeMethod(w,B);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(w)};
a.prototype.Gwh=function(w){w=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(w,0,"string");return this.executeRequestCreate(w)};a.prototype.Hwh=function(w){w=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(w,0,"string");return this.executeRequestUpdate(w)};a.prototype.TIh=function(w){w=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(w,0,"string");return this.getButton(w)};a.prototype.XXh=function(w){w=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(w,0,"string");
return this.getTab(w)};a.prototype.eCa=function(){this._OnAccess();return null};a.prototype.lCe=function(w){return y.a(v.a.d2g,m.a.ga(1746)+w)};a.prototype.TBe=function(){return y.a(v.a.bhj,m.a.ga(1742))};a.prototype.z6g=function(){return y.a(v.a.hostRestartNeeded,m.a.ga(1747))};a.prototype.Bbf=function(){var w=this.zy.getSharedRuntimeId();w=!!w&&0<w.length;e.ULS.sendTraceTag(538572822,0,15,String.format("IsDynamicRibbonApiAvailable check. hasSharedRuntimeId:{0}.",w));return w};a.prototype.bxe=function(w){var B=
this.Urg.getRibbonExtensionControlMap();return w in B||this.mWg(w)};a.prototype.mWg=function(w){var B=this.oAh();if(B){B=bk(B.RIe.tabs);for(var A=B.next();!A.done;A=B.next()){A=A.value;if(A.id===w)return!0;A=bk(A.groups);for(var z=A.next();!z.done;z=A.next()){z=bk(z.value.controls);for(var x=z.next();!x.done;x=z.next()){x=x.value;if(x.id===w)return!0;if("Menu"===x.type){x=bk(x.items);for(var D=x.next();!D.done;D=x.next())if(D.value.id===w)return!0}}}}}return!1};a.prototype.oAh=function(){return k.a.getInstance().Eia(this.Jd.PrimaryMarketplace.MarketplaceType,
this.Jd.PrimaryMarketplace.SolutionId,1)};a.B$b=function(w,B,A){var z={};z.methodName="DynamicRibbon."+w;z.result=B?"Succeeded":"Failed";z.message=A;return m.a.xc(z)};Mf.Object.defineProperties(a.prototype,{buttons:{configurable:!0,enumerable:!0,get:function(){return null}}});a.fzc="Office.Online.Extensibility.Ribbon.";Object(u.a)(a,"DynamicRibbon",null,[])},1167:function(u,E,b){function a(){this.focusOnIframeWhenLoaded=!1;this.width=0;this.aeb=this.s4=this.Jk=null;this.isFirstPartyOptOutAppContextOptmization=
!1}b.d(E,"a",function(){return a});u=b(0);a.key="InsertAgaveClientSideParametersKey";Object(u.a)(a,"InsertAgaveClientSideParameters",null,[])},1168:function(u,E,b){function a(){}b.d(E,"a",function(){return a});u=b(0);a.P8b="extId";a.Xze="ComponentType";a.aHa="ComponentId";a.ijd="HostProps";a.Eya="OptionalProps";Object(u.a)(a,"ActionPropertyNames",null,[])},1170:function(u,E,b){function a(c,d){var e=!1;c&&(c=d.osfControl,(d=c.getManifest())&&d.getSharedRuntimeForCustomFunctions("Workbook")&&!c.getIsUpgrading()&&
(e=!0));return e}b.d(E,"a",function(){return a})},1171:function(u,E,b){function a(){this.token=null;this.errorCode=0;this.expiresOn=this.Wga=this.MSa=this.Mdd=this.agd=this.bwb=this.mUd=null}b.d(E,"a",function(){return a});u=b(0);Object(u.a)(a,"AppsForOfficeOauthResult",null,[])},1172:function(u,E,b){function a(c,d){return OfficeExtension.WacRuntime.Utility.createPromise(function(e,k){k(OfficeExtension.WacRuntime.Utility.createRichApiException(c,d))})}b.d(E,"a",function(){return a})},1345:function(u,
E,b){function a(){Zb.a.Fa(function(jb){M.ka(jb);c.ka(jb)})}function c(jb){var Vb=Za.call(this)||this;Vb.$=jb;Vb.Eb();return Vb}function d(jb,Vb){var Ic=e.call(this)||this;Ic.$=jb;Ic.l1a=new DOMParser;Ic.cache=new yb.a;Ic.indexedDB=Vb;Vb.zf()&&Ic.indexedDB.initialize("Scripts","OfficeScriptingCache");Ic.Jwb=!1;Ic.Qp=new B([],function(Rb){e.FCj(Rb)});Ic.Dj=new B([],function(Rb){e.Mxc(Rb)});Ic.uB=new B([],function(Rb){e.Mxc(Rb)});Ic.$s=new B([],function(){});Ic.OMb=new B([],function(Rb){e.Mxc(Rb)});
return Ic}function e(){this.$s=null;this.Jwb=this.$Gb=this.nW=this.nab=this.VFd=this.hLf=this.TFd=this.oab=this.gdc=!1;this.OMb=this.uB=this.Dj=this.Qp=null}function k(jb,Vb,Ic,Rb){var kc=this;this.I6a=!1;this.U8a=function(){kc.d1f()?(kc.KGf(),Qa.g(kc.$).Ea.ZHd(kc.U8a)):kc.I6a&&Qa.g(kc.$).Ea.ZHd(kc.U8a)};this.THi=function(xb,Va){Object.getType(Va)===String&&Va.toString().endsWith(X.a.Lvb(kc.$))&&(kc.I6a=!1)};this.$=jb;this.Yga=Vb;this.Bu=Ic;this.businessBarManager=Rb;this.Vtj()}function l(jb,Vb,Ic,
Rb,kc,xb,Va,tb,fb){var ac=this;this.tA=null;this.cache=new yb.a;this.ywa=!1;this.RFa={};this.$=jb;this.hPc=Ic;this.indexedDB=Rb;this.tob=kc;this.Bu=xb;this.Yga=Va;this.Ie=tb;this.YB=fb;this.KMg=new A(this,jb);this.Opg=ua.a.Ta.Jb;this.M5f="";Rb.zf()&&(this.ywa=!0,this.indexedDB.initialize("Scripts","OfficeScriptingCache"));jb=!0;if(vb.a.ste){this.cache.zf()&&!X.a.pta&&(Vb=this.Ie.gJh(X.a.R$b(this.$)),Vb.isSuccess&&(jb=va.getElapsedSeconds(Vb.timeStamp,ua.a.Ta.Jb),this.Bu.Sx=new r(!0,!0),this.tA=new r(Vb.value,
!0),jb=this.tA.value?604800<jb:86400<jb,this.Lwb=this.JRa(!0)));this.gHh();if("undefined"!==typeof makerstorage&&this.Zgf)if(this.M5f=F(this.$),U(this.$))G(this.$,"localstorageToken"),this.Bu.Sx=new r(!0,!0),this.tA=new r(!0,!0),this.Lwb=this.JRa(!0);else if((Vb=X.a.ged())&&makerstorage.setStorageEnvironmentOverride(Vb),jb||X.a.pta)try{this.$.tcb("automateTab",!0),this.Lwb=X.a.pta?this.Bu.n_c().then(function(){return ac.Yga.svb()}).then(function(){return ac.JRa(!1)}).catch(function(){return ac.JRa(!1)}):
this.Bu.n_c().then(function(){return ac.Yga.svb()}).then(function(Ac){return ac.Z3h(Ac)}).then(function(){return ac.JRa(!1)}).catch(function(){return ac.JRa(!1)})}catch(Ac){Q.ULS.sendTraceTag(537170314,0,15,"AutomateCommandManager: Something went wrong while trying to check the tab state.  Exception: {0}",Ac.message),this.Lwb=Promise.resolve(!1),this.$.tcb("automateTab",!1)}V.EwaSettings.isChangeGateEnabled("OfficeVSO:5925531_useHasShownAutomateTabPromise")&&this.Lwb?this.Lwb.then(function(Ac){ac.nJd(Ac);
ac.Ie.kYh()}):this.nJd(!1)}else Q.ULS.sendTraceTag(537170315,0,15,"IsOfficeScriptingEnabled: Turning off office scripting since fetch api is not supported by current browser."),this.nJd(!1)}function n(jb,Vb,Ic,Rb,kc,xb){this.actionName=jb;this.shapeId=Vb;this.scriptLink=Ic;this.clickId=Rb;this.Cba=kc;this.buttonText=xb}function f(jb,Vb,Ic,Rb){this.ijd=jb;this.cxh=Vb;this.Eya=Ic;this.aHa=Rb}function v(){this.Sx=null;return this}function r(jb,Vb,Ic,Rb,kc){this.value=jb;this.isSuccess=Vb;this.timeStamp=
void 0===Ic?null:Ic;this.errorCode=void 0===Rb?"":Rb;this.errorMessage=void 0===kc?"":kc}function y(){this.Sx=null}function m(jb,Vb){this.eW=null;this.$=jb;this.Ie=Vb;return this}function w(jb){this.H$=Ha.b(jb)||{};this.shareId=this.shareId||null}function B(jb,Vb){this.scripts=jb;this.o4f=Vb}function A(jb,Vb){this.automateCommandManager=jb;this.$=Vb}function z(jb){return sa.a.ud(jb)?xa.a.UMe:xa.a.TMe}function x(jb){return sa.a.ud(jb)?jb.isChromeRtl?xa.a.pqh:xa.a.oqh:xa.a.X1a}function D(jb){jb=jb.oa.xa.Na(1);
jb.request={HttpMethod:"Get",PathAndQuery:"customXmlParts/byNamespace(namespaceUri=@v)/onlyItem/xml?@v='http://schemas.microsoft.com/office/extensibility/maker/v1.0'",RequestHeaders:null,RequestBody:"",RequestFlags:256};return jb}function I(jb,Vb,Ic,Rb,kc){function xb(){function Rc(Fc,wb,uc){return za.g(tb.xa,"ExecuteRichApiRequest",Rb,Ia.b(Fc,Vb),Ia.a(wb,Ic),uc,null,0)}if(Va.gHa()||0<tb.xa.N3||0<tb.Fk.N3)return!1;fb&&Va.so(fb);ac&&tb.Zr(ac);Ac&&tb.Bz(Ac);V.EwaSettings.Zb()?Va.Ot(new ta.a(507,0,Rc,
80)):Va.Ot(new ia.a(507,0,Rc,16));return!0}var Va=jb.userOperationManager,tb=jb.oa,fb=null,ac=null,Ac=null;xb()||(fb=function(){xb()},ac=function(){xb()},Ac=function(){xb()},Va.zr(fb),tb.Sq(ac),tb.Ey(Ac));return kc.task}function F(jb){if(U(jb))return V.EwaSettings.getBooleanFeatureGate(X.a.skc,!1)?"makerservicelocal":"localstorage";jb=X.a.ged();return X.a.D1e(jb)}function G(jb,Vb){U(jb)&&(V.EwaSettings.getBooleanFeatureGate(X.a.skc,!1)||makerstorage.useLocalStorage(!0),makerstorage.setStorageEnvironmentOverride("local"));
makerstorage.setSessionId(jb.ya.UserSessionId);makerstorage.setUserAccessInfo(new J(Vb,null));makerstorage.setFlightValue(makerstorage.restApiVersionFlightKey,"1")}function T(){return V.EwaSettings.getBooleanFeatureGate(X.a.Cuj,!1)}function O(jb,Vb){Vb.WacTaskPaneInfra=sa.a.ud(jb);Vb.TaskpanelessRFB=V.EwaSettings.getBooleanFeatureGate(X.a.B7f,!1);Vb.OfficeScriptsAutomateTask=X.a.isf;Vb.DeferAdminCheck=X.a.pta;Vb.SharedScriptsButton=T()}function U(jb){return"TestHost"===jb.ya.DocumentHostInfo.HostTier}
function J(jb,Vb){this.currentUserMlapiToken=this.currentUserToken=null;this.currentUserToken=jb;this.currentUserMlapiToken=Vb}function H(){this.eW=null}function K(jb,Vb,Ic){var Rb,kc;this.$=jb;this.oAuthManager=Vb;this.Bu=Ic;this.oob=new N;this.Qre=null!==(kc=null===(Rb=this.oAuthManager)||void 0===Rb?void 0:Rb.w5a())&&void 0!==kc?kc:!1}function N(){this.token=null;this.timeStamp=0}function M(jb){return ca.call(this,jb)||this}function C(jb,Vb){this.automateCommandManager=jb;this.$=Vb}u=b(0);var Q=
b(14),P=b(905),ka=b(76),R=b(37);C.prototype.Lc=function(){return!1};C.prototype.executeCommand=function(jb,Vb,Ic){jb=R.TaskExtensions.jk();Vb=Vb.command;switch(Vb){case 1845457202:case -1342227603:case -45542983:case 1904816141:case 1606046412:case 1043696663:case 971811139:case -2126202430:case 1623358083:this.$.Fd(2045014907,-1,0,null),this.automateCommandManager.Rqi(Vb,1904816141===Vb?Ic[ka.a.Nc].toString():null)}return jb};C.prototype.zc=function(jb,Vb){jb=!1;switch(Vb.command){case 1845457202:case -45542983:case -1342227603:case 971811139:case -2126202430:case 1623358083:case 1904816141:case 1043696663:case 1606046412:jb=
this.$.Aba}return jb};C.prototype.Qc=function(jb,Vb,Ic){return"PopulateAutomateGalleryMenu"===Vb&&this.$.Aba?(this.automateCommandManager.Qc(Vb,Ic),!0):!1};Object(u.a)(C,"AutomateCommandHandler",null,[429]);var fa=b(493),ca=P.a;Rk(M,ca);M.prototype.Ad=function(){var jb=this;fa.a(this.$,374,375,this.hb,function(){var Vb=jb.$.da.za(352);Vb?jb.jd([new C(Vb,jb.$)]):Q.ULS.sendTraceTag(537170316,0,15,"AutomateCommandManager should already been initialized before AutomateCommandHandler.")})};M.ka=function(jb){jb.da.Ga(308,
new M(jb))};Object(u.a)(M,"AutomateCommandHandlerFactory",P.a,[]);P=b(232);var ea=b(7),wa=b(4);Object(u.a)(N,"AuthContext",null,[]);var X=b(934),ja=b(133),va=b(111),ua=b(28),Xa=b(1024),aa=b(187),ba=b(80);K.prototype.getAuthContext=function(){return this.oob};K.prototype.svb=function(){function jb(xb,Va){return(new Promise(function(tb){window.setTimeout(function(){tb(xb)},Va)})).then(function(tb){Rb.push(Object(ea.a)(new ba.a,{name:"Error"+kc,string:tb.ErrorMessage}));Rb.push(Object(ea.a)(new ba.a,
{name:"ErrorCode"+kc,string:tb.ErrorCode}));kc++;return Vb.r$f()})}var Vb=this,Ic=ua.a.Ta.Jb,Rb=[];if(this.oAuthManager)Rb.push(Object(ea.a)(new ba.a,{name:"IsAuthSupported",bool:this.Qre}));else return this.X8b(Rb,Ic,"need_OAuthManager","No OAuthManager");if(!this.Bu.Sx||!this.Bu.Sx.value)return this.X8b(Rb,Ic,"need_license","No License");if(wa.AFrameworkApplication.fa.qa("IsAnonymousUser"))return this.X8b(Rb,Ic,"need_user","Anonymous User");if(33E5>Date.now()-this.oob.timeStamp)return Rb.push(Object(ea.a)(new ba.a,
{name:"UsedCachedToken",bool:!0})),aa.a(ja.a.Vxd,!0,0,Rb),Promise.resolve(Object(ea.a)(new Xa.a,{IsSuccess:!0,Token:this.oob.token}));Rb.push(Object(ea.a)(new ba.a,{name:"UsedCachedToken",bool:!1}));var kc=1;return this.r$f().catch(function(xb){return jb(xb,200)}).catch(function(xb){return jb(xb,400)}).then(function(xb){xb.IsSuccess?(Vb.oob.token=xb.Token,Vb.oob.timeStamp=Date.now()):(Rb.push(Object(ea.a)(new ba.a,{name:"Error"+kc,string:xb.ErrorMessage})),Rb.push(Object(ea.a)(new ba.a,{name:"ErrorCode"+
kc,string:xb.ErrorCode})));Rb.push(Object(ea.a)(new ba.a,{name:"Attempts",int64:kc}));Rb.push(Object(ea.a)(new ba.a,{name:"Error",string:xb.ErrorMessage}));Rb.push(Object(ea.a)(new ba.a,{name:"ErrorCode",string:xb.ErrorCode}));aa.a(ja.a.Vxd,xb.IsSuccess,va.getElapsedMilliseconds(Ic,ua.a.Ta.Jb),Rb);return Promise.resolve(xb)}).catch(function(xb){Rb.push(Object(ea.a)(new ba.a,{name:"Error"+kc,string:xb.ErrorMessage}));Rb.push(Object(ea.a)(new ba.a,{name:"ErrorCode"+kc,string:xb.ErrorCode}));Rb.push(Object(ea.a)(new ba.a,
{name:"Attempts",int64:kc}));return Vb.X8b(Rb,Ic,xb.ErrorCode,xb.ErrorMessage)})};K.prototype.X8b=function(jb,Vb,Ic,Rb){jb.push(Object(ea.a)(new ba.a,{name:"Error",string:Rb}));jb.push(Object(ea.a)(new ba.a,{name:"ErrorCode",string:Ic}));aa.a(ja.a.Vxd,!1,va.getElapsedMilliseconds(Vb,ua.a.Ta.Jb),jb);return Promise.resolve(Object(ea.a)(new Xa.a,{IsSuccess:!1,ErrorMessage:Rb,ErrorCode:Ic}))};K.prototype.r$f=function(){var jb=this,Vb=X.a.IYh(),Ic=0;Vb=this.oAuthManager.xO("Maker",Vb).then(function(Rb){if(Rb)return!Rb.IsSuccess&&
jb.Owj(Rb)?Promise.reject(Rb):Promise.resolve(Rb);Rb=Object(ea.a)(new Xa.a,{IsSuccess:!1,ErrorMessage:"Missing result object",ErrorCode:"need_result"});return Promise.reject(Rb)}).catch(function(Rb){var kc=new Xa.a;Object.getType(Rb)===Object.getType(kc)?kc=Rb:(kc.ErrorMessage=Rb.toString(),kc.ErrorCode="exception");return Promise.reject(kc)});return Promise.race([Vb,new Promise(function(Rb,kc){Ic=window.setTimeout(function(){kc(Object(ea.a)(new Xa.a,{IsSuccess:!1,ErrorCode:"Timeout",ErrorMessage:"Timed out waiting auth token promise"}))},
2E4)})]).then(function(Rb){window.clearTimeout(Ic);return Rb})};K.prototype.Owj=function(jb){return"interaction_required"===jb.ErrorCode||"InitFailed"===jb.ErrorCode||"invalid_resource"===jb.ErrorCode||"login_required"===jb.ErrorCode&&jb.ErrorMessage.startsWith("AADSTS500341")?!1:!0};Object(u.a)(K,"AutomateCommandAuth",null,[860]);var oa=b(1025);Object(u.a)(H,"AutomateCommandGalleryBase",null,[]);var ra=b(393),db=b(29),Ka=b(622),Ga=b(1594),xa=b(19),da=b(53),qa=b(15);b(322);var na=b(653);Object(u.a)(J,
"UserInfo",null,[]);var ia=b(564),ta=b(177),za=b(62),sa=b(36),V=b(1),Ia=b(294);A.prototype.SFh=function(jb){var Vb=this.automateCommandManager.Va.jq().$D();if(!T()){var Ic=A.hU(jb,qa.a.instance.ga(2109));this.WTc(Ic,X.a.xSi,this.automateCommandManager.Dj,X.a.dEi,qa.a.instance.ga(2105),this.automateCommandManager.Va);Vb.MenuSectionList.push(Ic)}Ic=A.hU(jb,qa.a.instance.ga(2110));this.WTc(Ic,X.a.sBi,X.a.P5?this.automateCommandManager.$s.sSe(this.automateCommandManager.Dj):this.automateCommandManager.Qp.sSe(this.automateCommandManager.Dj),
X.a.Frf,qa.a.instance.ga(2106),this.automateCommandManager.Va);Vb.MenuSectionList.push(Ic);Ic=A.hU(jb,qa.a.instance.ga(2111));this.WTc(Ic,X.a.Iij,this.automateCommandManager.uB,X.a.Frf,"",this.automateCommandManager.Va);Vb.MenuSectionList.push(Ic);Ic=Object(ea.a)(new ra.a,{Id:X.a.joe,ExternalId:X.a.joe,Command:"1606046412",LabelText:qa.a.instance.ga(2102),Alt:qa.a.instance.ga(2103),Image16by16:da.a.Se(16),Image16by16Class:xa.a.sNe,Visible:!0});jb=A.hU(jb,null);jb.ControlsId="myScriptsSection.Controls";
if(T()){var Rb=Object(ea.a)(new ra.a,{Id:X.a.X_f,ExternalId:X.a.X_f,Command:"1043696663",LabelText:qa.a.instance.ga(2112),Alt:qa.a.instance.ga(2112),ExternalImageId:"PeopleSharedIcon_16",Visible:!0});jb.ControlList.push(Rb)}jb.ControlList.push(Ic);Vb.MenuSectionList.push(jb);return Vb};A.prototype.WTc=function(jb,Vb,Ic,Rb,kc,xb){if(Ic&&0<Ic.length){Vb=xb.lC(Vb,1,"Size150by20").K0b();kc={};xb={};xb.root=A.o0a(320,30);xb.flexContainer={display:"flex",height:"100%",flexWrap:"nowrap",justifyContent:"left",
alignItems:"left",lineHeight:"normal"};xb.label={margin:"0px 3px"};kc.galleryButtonInExpanded=xb;Vb.GalleryStyle=kc;for(kc=0;kc<Ic.length&&kc<Rb;kc++)xb=Ic.f4(kc),Vb.GalleryItems.push(A.K2c(xb.id,xb));jb.ControlList.push(Vb)}else Ic=Object(ea.a)(new na.a,{Id:Vb,ExternalId:Vb,LabelText:kc}),jb.ControlsId=Ic.Id+".Controls",jb.ControlList.push(Ic)};A.OEh=function(jb){if(jb){var Vb=String.format(X.a.Zai,jb.isShared?X.a.uLj:X.a.$jj,da.a.Se(16));jb=String.format(X.a.$ai,db.a.zg(jb.name));return String.format(X.a.Yai,
Vb,jb)}return""};A.hU=function(jb,Vb){return Object(ea.a)(new Ka.a,{Id:jb,Title:Vb,MenuSectionTitleFocusable:!0,ShowMenuSectionTitleBackground:!0,ShowMenuSectionTitleIcon:!0,ControlList:[]})};A.K2c=function(jb,Vb){var Ic=X.a.sLj,Rb=X.a.Yjj,kc=X.a.tLj,xb=X.a.Zjj;return Vb?A.KCe(Vb.shareId||Vb.id,Vb.name,Vb.isShared&&!T()?Ic:Rb,jb,jb,Vb.isShared&&!T()?kc:xb):A.KCe("","","",jb,jb)};A.KCe=function(jb,Vb,Ic,Rb,kc,xb){Rb=void 0===Rb?null:Rb;kc=void 0===kc?null:kc;xb=void 0===xb?null:xb;var Va=void 0===
Va?null:Va;var tb={},fb={};tb.root=A.o0a(20,20);fb.root=A.o0a(20,20);return Object(ea.a)(new Ga.a,{Id:jb,ExternalId:Rb||jb,MenuItemId:kc||jb,Command:"1904816141",Icon:Ic,Image:da.a.Se(16),ImageClass:xb,LabelText:Vb,FullIconStyle:tb,PreviewIconStyle:fb,Alt:Va||Vb})};A.o0a=function(jb,Vb){var Ic={};Ic.width=jb;Ic["min-width"]=jb;Ic.height=Vb;return Ic};Object(u.a)(A,"AutomateCommandRenderer",null,[]);B.prototype.fKa=function(jb){for(var Vb=0;Vb<this.scripts.length;Vb++)if(this.scripts[Vb].id===jb||
this.scripts[Vb].shareId===jb)return Vb;return-1};B.prototype.sort=function(){this.o4f(this.scripts)};B.prototype.Cs=function(jb){return-1===this.fKa(jb.id)?(this.scripts.push(jb),!0):!1};B.prototype.VTc=function(jb){return-1===this.fKa(jb.id)?(this.scripts=[jb].concat(this.scripts),!0):!1};B.prototype.XAi=function(jb){jb=this.fKa(jb.id);if(-1!==jb){for(var Vb=this.scripts[jb].C_a();0<jb;)this.scripts[jb]=this.scripts[jb-1],jb--;this.scripts[0]=Vb}};B.prototype.Veb=function(jb){var Vb=this.fKa(jb.id);
if(-1!==Vb){var Ic=this.scripts[Vb].shareId;this.scripts[Vb]=jb;this.scripts[Vb].shareId=Ic}};B.prototype.Vdf=function(jb){var Vb=this.fKa(jb.id);return-1!==Vb?jb.name===this.scripts[Vb].name:!1};B.prototype.S0a=function(jb){jb=this.fKa(jb);return-1!==jb?(this.scripts.splice(jb,1),!0):!1};B.prototype.clear=function(){this.scripts=[]};B.prototype.getScripts=function(){return this.scripts};B.prototype.gH=function(jb){jb=this.fKa(jb);return-1!==jb?this.scripts[jb]:null};B.prototype.f4=function(jb){return 0<=
jb&&this.length>jb?this.scripts[jb]:null};B.prototype.sSe=function(jb){for(var Vb=new B([],this.o4f),Ic=0;Ic<this.scripts.length;Ic++){var Rb=this.scripts[Ic];jb.gH(Rb.id)||Vb.Cs(Rb)}return Vb};B.prototype.beb=function(){for(var jb=[],Vb=bk(this.scripts),Ic=Vb.next();!Ic.done;Ic=Vb.next())jb.push(Ic.value.UUd());return jb};Mf.Object.defineProperties(B.prototype,{length:{configurable:!0,enumerable:!0,get:function(){return this.scripts.length}}});Object(u.a)(B,"ScriptCollection",null,[]);var Ha=b(198);
w.prototype.C_a=function(){return new w(this.H$)};w.prototype.UUd=function(){return this.H$};Mf.Object.defineProperties(w.prototype,{id:{configurable:!0,enumerable:!0,get:function(){return this.H$.id}},shareId:{configurable:!0,enumerable:!0,get:function(){return this.H$.shareId},set:function(jb){this.H$.shareId=jb||null}},name:{configurable:!0,enumerable:!0,get:function(){return this.H$.name}},bFe:{configurable:!0,enumerable:!0,get:function(){return this.H$.dateLastPublished}},body:{configurable:!0,
enumerable:!0,get:function(){return this.H$.body}},description:{configurable:!0,enumerable:!0,get:function(){return this.H$.description}},cbf:{configurable:!0,enumerable:!0,get:function(){return this.H$.isCreator}},isShared:{configurable:!0,enumerable:!0,get:function(){return!!this.shareId&&0<this.shareId.length}}});Object(u.a)(w,"ScriptCore",null,[]);var ob=b(41);Rk(m,H);m.prototype.qfd=function(jb){switch(jb){case "1":case "2":case "3":case "4":case "5":case "6":return this.eW.f4(parseInt(jb,10)-
1);default:return this.Ie.$s.gH(jb)||this.Ie.Qp.gH(jb)||this.Ie.Dj.gH(jb)||this.Ie.uB.gH(jb)}};m.prototype.Add=function(jb,Vb){var Ic=null;if(this.Ie.F4a)switch(jb){case "1":case "2":case "3":case "4":case "5":case "6":Ic=this.eW.f4(parseInt(jb,10)-1);break;default:Ic=this.eW.gH(jb)}sa.a.isReactRibbonEnabled()?Vb[oa.a.GalleryButtonProps]=A.K2c(jb,Ic):Vb[oa.a.InnerHTML]=A.OEh(Ic);Vb[oa.a.Alt]=Ic?Ic.name:""};m.prototype.JN=function(jb){this.eW=this.eGd();this.$.hf();var Vb=[];Vb.push(Object(ea.a)(new ba.a,
{name:"Operation",string:jb}));Vb.push(Object(ea.a)(new ba.a,{name:"HasReadRecentCachedScripts",bool:this.Ie.gdc}));Vb.push(Object(ea.a)(new ba.a,{name:"ReadScriptsDone",bool:this.Ie.$hd}));Vb.push(Object(ea.a)(new ba.a,{name:"ReadSamplesScriptsDone",bool:this.Ie.$Gb}));Vb.push(Object(ea.a)(new ba.a,{name:"SamplesScriptCount",int64:this.Ie.uB.length}));Vb.push(Object(ea.a)(new ba.a,{name:"ReadRecentScriptsDone",bool:this.Ie.oab}));Vb.push(Object(ea.a)(new ba.a,{name:"RecentScriptCount",int64:this.Ie.$s.length}));
Vb.push(Object(ea.a)(new ba.a,{name:"ReadWorkbookScriptsDone",bool:this.Ie.nW}));Vb.push(Object(ea.a)(new ba.a,{name:"WorkbookScriptCount",int64:this.Ie.Dj.length}));aa.a(ja.a.hsf,!0,0,Vb)};m.prototype.thd=function(jb){var Vb=!1,Ic="",Rb=new w(jb.scriptMetadata),kc={Operation:"HandleRefreshRibbonGallery"};kc.RefreshOperation=jb.operationName;switch(jb.operationName){case X.a.IMf:jb=this.shd(Rb);Ic=jb.message;Vb=jb.returnValue;break;case X.a.GMf:jb=this.qhd(Rb);Ic=jb.message;Vb=jb.returnValue;break;
case X.a.FMf:jb=this.phd(Rb);Ic=jb.message;Vb=jb.returnValue;break;case X.a.HMf:jb=this.rhd(Rb);Ic=jb.message;Vb=jb.returnValue;break;case X.a.G6i:jb=this.a3h(Rb),Ic=jb.message,Vb=jb.returnValue}(kc.GalleryUpdated=Vb)?(Q.ULS.sendTraceTag(537170322,0,50,"AutomateCommandGallery: Calling UpdateToolbarsAndRibbons. Message: {0}",Ic),this.JN("RefreshGallery")):Q.ULS.sendTraceTag(537170321,0,15,"AutomateCommandGallery: Something went wrong while trying to refresh ribbon gallery.  Message: {0}",Ic);kc.Message=
Ic;Q.ULS.sendTraceTag(537170320,0,50,ob.c(kc))};m.prototype.eGd=function(){for(var jb=new B([],function(){}),Vb=this.Ie.Dj?this.Ie.Dj.length:0,Ic=this.Ie.$s?this.Ie.$s.length:0,Rb=this.Ie.uB?this.Ie.uB.length:0,kc=0,xb=X.a.yHf,Va=0;Va<xb;Va++)if(Va<Vb)jb.Cs(this.Ie.Dj.f4(Va));else if(Va-Vb+kc<Ic){var tb=this.Ie.$s.f4(Va-Vb+kc);this.Ie.Dj.gH(tb.id)?(kc++,Va--):jb.Cs(tb)}else Va-Vb-Ic+kc<Rb&&jb.Cs(this.Ie.uB.f4(Va-Vb+kc-Ic));return jb};m.prototype.shd=function(jb){if(this.Ie.$s.VTc(jb))var Vb="";else{Vb=
"";var Ic=jb.C_a();this.Ie.Dj.Veb(Ic);this.Ie.Dj.sort();this.Ie.$s.Veb(jb)}return{returnValue:!0,message:Vb}};m.prototype.qhd=function(jb){this.Ie.Dj.S0a(jb.id);return this.Ie.$s.S0a(jb.id)?{returnValue:!0,message:""}:{returnValue:!1,message:"Deleting a script but script could not be found in recent script collection."}};m.prototype.phd=function(jb){var Vb=jb.C_a();Vb.shareId=null;this.Ie.$s.VTc(Vb);return this.Ie.Dj.Cs(jb)?(this.Ie.Dj.sort(),{returnValue:!0,message:""}):{returnValue:!1,message:"Could not attach a script that is already attached."}};
m.prototype.rhd=function(jb){return this.Ie.Dj.S0a(jb.id)?{returnValue:!0,message:""}:{returnValue:!1,message:"Detaching a script but the script could not be found in the collection."}};m.prototype.a3h=function(jb){var Vb=jb.C_a(),Ic=!1;this.Ie.Dj.Vdf(Vb)&&(this.Ie.Dj.Veb(Vb),this.Ie.Dj.sort(),Ic=!0);this.Ie.$s.VTc(jb)?Ic=!0:this.Ie.$s.Vdf(jb)&&(this.Ie.$s.Veb(jb),this.Ie.$s.XAi(jb),Ic=!0);return{returnValue:Ic,message:""}};Object(u.a)(m,"AutomateCommandGallery",H,[]);var ib=b(83);Object(u.a)(y,"AutomateCommandLicensingBase",
null,[]);Object(u.a)(r,"BoolResultWrapper",null,[]);Rk(v,y);v.prototype.n_c=function(){var jb=this,Vb=ua.a.Ta.Jb,Ic=[];return new Promise(function(Rb){ib.a.instance.Tb("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(kc){kc.isFeatureEnabled("ExcelOfficeScripting",!1).then(function(xb){Ic.push(Object(ea.a)(new ba.a,{name:"IsLicensed",bool:xb}));aa.a(ja.a.dsf,!0,va.getElapsedMilliseconds(Vb,ua.a.Ta.Jb),Ic);jb.Sx=new r(xb,!0);Rb(xb)}).catch(function(xb){Ic.push(Object(ea.a)(new ba.a,
{name:"IsLicensed",bool:!1}));Ic.push(Object(ea.a)(new ba.a,{name:"Error",string:xb.toString()}));Ic.push(Object(ea.a)(new ba.a,{name:"ErrorCode",string:"exception"}));aa.a(ja.a.dsf,!1,va.getElapsedMilliseconds(Vb,ua.a.Ta.Jb),Ic);jb.Sx=new r(!1,!1,void 0,"exception",xb.toString());Rb(!1)})})})};Object(u.a)(v,"AutomateCommandLicensing",y,[]);var La=b(1507),zb=b(1505),Fb=b(1504),Yb=b(1506),kb=b(1595),vb=b(27),Wa=b(178),qb=b(635),yb=b(323),ec=b(5);Object(u.a)(f,"LaunchSDXParams",null,[]);Object(u.a)(n,
"RunfromButtonParameters",null,[]);var Ob=b(168),Cb=b(54),ab=b(998),ya=b(50),ma=b(46),ha=b(167);l.prototype.JRa=function(jb){var Vb=wa.AFrameworkApplication.fa.qa("IsO365CommercialHost"),Ic="",Rb="",kc=!1,xb,Va=(xb=this.Bu.Sx&&this.Bu.Sx.isSuccess)&&this.Bu.Sx.value;xb=X.a.pta?xb:!(Va&&(!this.tA||!this.tA.isSuccess));this.Bu.Sx&&!this.Bu.Sx.isSuccess?(Rb=this.Bu.Sx.errorCode,Ic=this.Bu.Sx.errorMessage):this.tA&&!this.tA.isSuccess&&(Rb=this.tA.errorCode,Ic=this.tA.errorMessage);Va=[];Va.push(Object(ea.a)(new ba.a,
{name:"IsScriptingEnabled",bool:this.Cba}));Va.push(Object(ea.a)(new ba.a,{name:"IsValidHost",bool:Vb}));Va.push(Object(ea.a)(new ba.a,{name:"IsUserLicensed",bool:this.Bu.Sx?this.Bu.Sx.value:!1}));X.a.pta||Va.push(Object(ea.a)(new ba.a,{name:"IsAdminSwitchOn",bool:this.tA?this.tA.value:!1}));Va.push(Object(ea.a)(new ba.a,{name:"ShowTab",bool:this.Cba}));X.a.pta||Va.push(Object(ea.a)(new ba.a,{name:"ServiceChecked",bool:!jb}));this.Cba?sa.a.Nwa(this.$)&&(jb=Ob.a(this.$),(null===jb||void 0===jb?0:jb.Ql)?
(Va.push(Object(ea.a)(new ba.a,{name:"RibbonType",string:"React"})),jb.Ql.yAj(ec.a.WGb),jb.Ql.mOd(["AutomateAutomateTask"],!X.a.isf),V.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",!1)&&!V.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",!1)&&(kc=!0)):(Rb="ribbon_manager_error",Ic="The RibbonManager or RibbonUser is null")):this.O5h();Va.push(Object(ea.a)(new ba.a,{name:"Error",string:Ic}));Va.push(Object(ea.a)(new ba.a,
{name:"ErrorCode",string:Rb}));aa.a(ja.a.SEi,xb,va.getElapsedMilliseconds(this.initTime,ua.a.Ta.Jb),Va);this.$.tcb("automateTab",!1);return Promise.resolve(kc)};l.prototype.Qc=function(jb,Vb){if(!Vb)return!1;Vb.MenuItems=this.KMg.SFh(Vb.MenuId);return!0};l.prototype.oYi=function(){var jb=this;this.ywa&&(X.a.P5?this.Ie.iLf(this.YB).continueWith(function(Vb){Vb.result&&jb.YB.JN(X.a.BPa)}):this.Ie.i5i(this.YB));U(this.$)?this.O0e(Object(ea.a)(new Xa.a,{IsSuccess:!0,Token:"FakeToken"})):this.Yga.svb().then(function(Vb){jb.O0e(Vb)})};
l.prototype.Add=function(jb,Vb,Ic){if(X.a.P5)this.YB.Add(jb,Vb,Ic);else{Ic=null;if(this.Ie.F4a)switch(jb){case "1":case "2":case "3":case "4":case "5":case "6":Ic=this.YB.eW.f4(parseInt(jb,10)-1);break;default:Ic=this.YB.eW.gH(jb)}Vb[oa.a.GalleryButtonProps]=A.K2c(jb,Ic);Vb[oa.a.Alt]=Ic?Ic.name:""}};l.prototype.thd=function(jb){if(X.a.P5)this.YB.thd(jb);else{var Vb=!1,Ic="",Rb=new w(jb.scriptMetadata),kc={Operation:"HandleRefreshRibbonGallery"};kc.RefreshOperation=jb.operationName;switch(jb.operationName){case X.a.IMf:jb=
this.shd(Rb);Ic=jb.message;Vb=jb.returnValue;break;case X.a.GMf:jb=this.qhd(Rb);Ic=jb.message;Vb=jb.returnValue;break;case X.a.FMf:jb=this.phd(Rb);Ic=jb.message;Vb=jb.returnValue;break;case X.a.HMf:jb=this.rhd(Rb),Ic=jb.message,Vb=jb.returnValue}(kc.GalleryUpdated=Vb)?(Q.ULS.sendTraceTag(537170313,0,50,"AutomateCommandManager: Calling UpdateToolbarsAndRibbons. Message: {0}",Ic),this.JN("RefreshGallery")):Q.ULS.sendTraceTag(537170312,0,15,"AutomateCommandManager: Something went wrong while trying to refresh ribbon gallery.  Message: {0}",
Ic);kc.Message=Ic;Q.ULS.sendTraceTag(537170311,0,50,ob.c(kc))}};l.prototype.v3h=function(jb,Vb,Ic,Rb){if(V.EwaSettings.isChangeGateEnabled("OfficeVSO:6254340_ExitCellEditModeOnRFBClick")||this.$.hq(null,!1,1023))jb=new n(X.a.TTf,jb,Vb,Ic,this.Cba,Rb),this.tob.swb(jb)};l.prototype.Z4e=function(jb,Vb,Ic){jb=new n(X.a.FVj,jb,Vb,Ic,this.Cba);this.tob.swb(jb)};l.prototype.c1h=function(jb){this.tob.Ugd(X.a.NAj,jb)};l.prototype.b1h=function(jb){this.tob.Ugd(X.a.i1g,jb)};l.prototype.d1h=function(jb){this.tob.Ugd(X.a.OEj,
jb)};l.prototype.Rqi=function(jb,Vb){var Ic=ya.b().ei(jb),Rb=[];Rb.push(Object(ea.a)(new ba.a,{name:"SessionId",string:this.$.ya.UserSessionId}));Rb.push(Object(ea.a)(new ba.a,{name:"MenuItemId",string:Vb}));Rb.push(Object(ea.a)(new ba.a,{name:"WorkbookScriptCount",int64:this.Dj.length}));Rb.push(Object(ea.a)(new ba.a,{name:"PublishedScriptCount",int64:this.Qp.length}));Rb.push(Object(ea.a)(new ba.a,{name:"RecentScriptCount",int64:this.$s.length}));Rb.push(Object(ea.a)(new ba.a,{name:"Command",string:Ic}));
Vb=this.ZVh(jb,Vb);if(Ic=this.wQh(jb,Ic,Vb))Rb.push(Object(ea.a)(new ba.a,{name:X.a.s$,string:Ic.Eya.kq[X.a.s$]})),La.a.instance.XMa(Ic.cxh,"Taskpane",Ic.aHa,Ic.ijd,Ic.Eya),1904816141===jb&&(Rb.push(Object(ea.a)(new ba.a,{name:"ScriptId",string:Vb.id})),Rb.push(Object(ea.a)(new ba.a,{name:"ShareId",string:Vb.shareId})),Rb.push(Object(ea.a)(new ba.a,{name:"IsPreviewGallery",bool:!!this.YB.eW.gH(Vb.id)})),Rb.push(Object(ea.a)(new ba.a,{name:"IsOwner",bool:Vb.cbf||!!this.Qp.gH(Vb.id)})),this.$.hf());
aa.a(ja.a.PEi,void 0,void 0,Rb)};l.prototype.wQh=function(jb,Vb,Ic){var Rb=null,kc=X.a.ju,xb=new zb.a(X.a.v7e,X.a.ITe,X.a.locale),Va=new Fb.a(X.a.solutionId,OSF.StoreType.Sdx,OSF.StoreType.Sdx,X.a.XLd),tb=new Yb.a;tb.kq.AdminPolicyForFeedback=ob.c(this.RFa);tb.kq.DocumentHostInfo=Cb.a.xc(this.$.ya.DocumentHostInfo);tb.kq.CodeEditorUrl=X.a.t3a(this.$);tb.kq.MakerTestService=V.EwaSettings.getBooleanFeatureGate(X.a.skc,!1);tb.kq[X.a.kTf]=X.a.b3a(this.$);tb.kq.StorageModePreference=this.M5f||"";tb.kq.Source=
"Ribbon";tb.kq[X.a.A7f]=Cb.a.xc(kc);tb.kq[X.a.Jse]=this.$.csf?"true":"false";tb.kq[X.a.s$]=Wa.a.create().toString();var fb=x(this.$),ac=z(this.$);tb.optionalProperties.HeaderCssClass=fb;tb.optionalProperties.TitleCssClass=ac;tb.kq[X.a.q6e]=fb;tb.kq[X.a.J8f]=ac;fb={};fb.ribbonCommand=Vb;fb[X.a.K5f]=this.Yga.getAuthContext();fb[X.a.W$a]=this.Ie.hLf?this.Qp.beb():null;fb[X.a.ePb]=this.Ie.VFd?this.Dj.beb():null;X.a.P5&&(fb[X.a.BPa]=this.Ie.TFd?this.$s.beb():null);tb.kq[X.a.C$e]=Cb.a.xc(fb);Vb={};O(this.$,
Vb);tb.kq[X.a.WSe]=Cb.a.xc(Vb);switch(jb){case -45542983:tb.kq.Script="";tb.kq.Destination="Editor";tb.kq.IsOwner=!0;tb.optionalProperties[kb.a.Qk]=qa.a.instance.ga(2098);tb.optionalProperties[kb.a.taskPaneWidth]=kc;tb.optionalProperties[kb.a.sourceLocationOverrideResourceId]=X.a.t3a(this.$);Rb=X.a.F2b;break;case -1342227603:tb.optionalProperties[kb.a.Qk]=qa.a.instance.ga(2100);tb.optionalProperties[kb.a.taskPaneWidth]=kc;tb.optionalProperties[kb.a.sourceLocationOverrideResourceId]=X.a.Y_e(this.$);
break;case 971811139:case 1606046412:tb.kq.Script="";tb.kq.Destination="BackStage";tb.kq.IsOwner=!0;tb.optionalProperties[kb.a.Qk]=qa.a.instance.ga(2098);tb.optionalProperties[kb.a.taskPaneWidth]=kc;tb.optionalProperties[kb.a.sourceLocationOverrideResourceId]=X.a.t3a(this.$);Rb=X.a.F2b;break;case 1043696663:tb.kq.Script="";tb.kq.Destination="BackStage_Workbook";tb.optionalProperties[kb.a.Qk]=qa.a.instance.ga(2098);tb.optionalProperties[kb.a.taskPaneWidth]=kc;tb.optionalProperties[kb.a.sourceLocationOverrideResourceId]=
X.a.t3a(this.$);Rb=X.a.F2b;break;case 1845457202:tb.optionalProperties[kb.a.Qk]=qa.a.instance.ga(2099);tb.optionalProperties[kb.a.taskPaneWidth]=kc;tb.optionalProperties[kb.a.sourceLocationOverrideResourceId]=X.a.o0e(this.$);Rb=X.a.dkj;break;case -2126202430:case 1623358083:case 1904816141:if(Ic)tb.kq.Script=Cb.a.xc(Ic.UUd()),tb.kq.Destination="Details",tb.kq.IsOwner=Ic.cbf||!!this.Qp.gH(Ic.id),tb.optionalProperties[kb.a.Qk]=qa.a.instance.ga(2098),tb.optionalProperties[kb.a.taskPaneWidth]=kc,tb.optionalProperties[kb.a.sourceLocationOverrideResourceId]=
X.a.t3a(this.$),Rb=X.a.F2b;else return null;break;default:return null}return new f(xb,Va,tb,Rb)};l.prototype.ZVh=function(jb,Vb){switch(jb){case -2126202430:jb=this.Ie.OMb.gH(X.a.N7f);break;case 1623358083:jb=this.Ie.OMb.gH(X.a.O7f);break;default:jb=Vb?this.qfd(Vb):null}return jb};l.prototype.gHh=function(){var jb=this;ib.a.instance.Tb("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").execute(function(Vb){jb.RFa.FeedbackEnabled=!0;jb.RFa.ScreenshotEnabled=!0;jb.RFa.EmailEnabled=!0;
Vb.KJ("Enabled").then(function(Ic){jb.RFa.FeedbackEnabled=Ic},function(){});Vb.KJ("IncludeScreenshot").then(function(Ic){jb.RFa.ScreenshotEnabled=Ic},function(){});Vb.KJ("IncludeEmail").then(function(Ic){jb.RFa.EmailEnabled=Ic},function(){})})};l.prototype.Z3h=function(jb){var Vb=this,Ic=ua.a.Ta.Jb,Rb=[];if(!jb||!jb.IsSuccess){var kc=jb?jb.ErrorCode:"need_token";jb=jb?jb.ErrorMessage:"No Access Token";Rb.push(Object(ea.a)(new ba.a,{name:"ServiceChecked",bool:!1}));Rb.push(Object(ea.a)(new ba.a,{name:"Error",
string:jb}));Rb.push(Object(ea.a)(new ba.a,{name:"ErrorCode",string:kc}));aa.a(ja.a.Txd,!1,va.getElapsedMilliseconds(Ic,ua.a.Ta.Jb),Rb);this.tA=new r(!1,!1,void 0,kc,jb);return Promise.resolve(!1)}Rb.push(Object(ea.a)(new ba.a,{name:"ServiceChecked",bool:!0}));G(this.$,jb.Token);return makerstorage.getUserPermissions(this.$.ya.UserSessionId).then(function(xb){Vb.tA=new r(xb.OfficeScriptingEnabled,!0);Vb.Ie.zSg(X.a.R$b(Vb.$),xb.OfficeScriptingEnabled);Rb.push(Object(ea.a)(new ba.a,{name:"IsEnabled",
bool:Vb.tA.value}));aa.a(ja.a.Txd,!0,va.getElapsedMilliseconds(Ic,ua.a.Ta.Jb),Rb);return Promise.resolve(Vb.tA.value)}).catch(function(xb){Object.getType(xb)===makerstorage.StorageServiceError?(Rb.push(Object(ea.a)(new ba.a,{name:"Error",string:xb.message})),Rb.push(Object(ea.a)(new ba.a,{name:"ErrorCode",string:String.format("makerstorage_{0}_{1}",xb.errorCode.toString(),xb.status.toString())}))):(Rb.push(Object(ea.a)(new ba.a,{name:"Error",string:xb.toString()})),Rb.push(Object(ea.a)(new ba.a,{name:"ErrorCode",
string:"exception"})));aa.a(ja.a.Txd,!1,va.getElapsedMilliseconds(Ic,ua.a.Ta.Jb),Rb);Vb.tA=new r(!1,!1,void 0,"exception",xb.toString());return Promise.resolve(!1)})};l.prototype.O0e=function(jb){var Vb=this;this.Ie.TVh(this.YB);X.a.P5?this.Ie.MUh(jb,this.YB,this.cache):this.jUh(jb);T()||this.Ie.h5i(function(Ic){Vb.Ie.HWh(Ic,jb,Vb.YB)},this.YB)};l.prototype.jUh=function(jb){var Vb=this,Ic=ua.a.Ta.Jb,Rb=[];if(jb&&jb.IsSuccess){G(this.$,jb.Token);var kc=qb.a.create().toString();Rb.push(Object(ea.a)(new ba.a,
{name:"CorrelationId",string:kc}));makerstorage.getScripts(kc).then(function(xb){Rb.push(Object(ea.a)(new ba.a,{name:"HasReadCachedScripts",bool:Vb.Ie.Jwb}));Vb.Qp.clear();xb=bk(xb);for(var Va=xb.next();!Va.done;Va=xb.next())Vb.Qp.Cs(new w(Va.value));Vb.Qp.sort();Vb.Ie.hLf=!0;Vb.Ie.nab=!0;Vb.ywa&&(xb=Cb.a.xc(Vb.Qp.beb()),Vb.indexedDB.Mbb(new ab.a(X.a.W$a,xb)));Rb.push(Object(ea.a)(new ba.a,{name:"ScriptCount",int64:Vb.Qp.length}));aa.a(ja.a.DDb,!0,va.getElapsedMilliseconds(Ic,ua.a.Ta.Jb),Rb);Vb.JN(X.a.W$a)}).catch(function(xb){Object.getType(xb)===
makerstorage.StorageServiceError?(Rb.push(Object(ea.a)(new ba.a,{name:"Error",string:xb.message})),Rb.push(Object(ea.a)(new ba.a,{name:"ErrorCode",string:String.format("makerstorage_{0}_{1}",xb.errorCode.toString(),xb.status.toString())})),17===xb.errorCode&&Vb.cache.EHd(X.a.R$b(Vb.$))):(Rb.push(Object(ea.a)(new ba.a,{name:"Error",string:xb.toString()})),Rb.push(Object(ea.a)(new ba.a,{name:"ErrorCode",string:"exception"})));aa.a(ja.a.DDb,!1,va.getElapsedMilliseconds(Ic,ua.a.Ta.Jb),Rb);Vb.Ie.nab=!0;
Vb.JN(X.a.W$a)})}else kc=jb?jb.ErrorCode:"need_token",jb=jb?jb.ErrorMessage:"No Access Token",Rb.push(Object(ea.a)(new ba.a,{name:"ServiceChecked",bool:!1})),Rb.push(Object(ea.a)(new ba.a,{name:"Error",string:jb})),Rb.push(Object(ea.a)(new ba.a,{name:"ErrorCode",string:kc})),aa.a(ja.a.DDb,!1,va.getElapsedMilliseconds(Ic,ua.a.Ta.Jb),Rb),this.Ie.nab=!0,this.JN(X.a.W$a)};l.prototype.qfd=function(jb){if(X.a.P5)return this.YB.qfd(jb);switch(jb){case "1":case "2":case "3":case "4":case "5":case "6":return this.YB.eW.f4(parseInt(jb,
10)-1);default:return this.Qp.gH(jb)||this.Dj.gH(jb)||this.uB.gH(jb)}};l.prototype.shd=function(jb){if(this.Qp.Cs(jb)){this.Qp.sort();var Vb=""}else{Vb="";var Ic=jb.C_a();this.Dj.Veb(Ic);this.Dj.sort();this.Qp.Veb(jb);this.Qp.sort()}return{returnValue:!0,message:Vb}};l.prototype.qhd=function(jb){this.Dj.S0a(jb.id);return this.Qp.S0a(jb.id)?{returnValue:!0,message:""}:{returnValue:!1,message:"Deleting a script but script could not be found in published collection."}};l.prototype.phd=function(jb){var Vb=
jb.C_a();Vb.shareId=null;this.Qp.Cs(Vb)&&this.Qp.sort();return this.Dj.Cs(jb)?(this.Dj.sort(),{returnValue:!0,message:""}):{returnValue:!1,message:"Could not attach a script that is already attached."}};l.prototype.rhd=function(jb){return this.Dj.S0a(jb.id)?{returnValue:!0,message:""}:{returnValue:!1,message:"Detaching a script but the script could not be found in the collection."}};l.prototype.JN=function(jb){if(X.a.P5)this.YB.JN(jb);else{this.eGd();this.$.hf();var Vb=[];Vb.push(Object(ea.a)(new ba.a,
{name:"Operation",string:jb}));Vb.push(Object(ea.a)(new ba.a,{name:"HasReadCachedScripts",bool:this.Ie.Jwb}));Vb.push(Object(ea.a)(new ba.a,{name:"ReadScriptsDone",bool:this.Ie.$hd}));Vb.push(Object(ea.a)(new ba.a,{name:"ReadSamplesScriptsDone",bool:this.Ie.$Gb}));Vb.push(Object(ea.a)(new ba.a,{name:"SamplesScriptCount",int64:this.uB.length}));Vb.push(Object(ea.a)(new ba.a,{name:"ReadPublishedScriptsDone",bool:this.Ie.nab}));Vb.push(Object(ea.a)(new ba.a,{name:"PublishedScriptCount",int64:this.Qp.length}));
Vb.push(Object(ea.a)(new ba.a,{name:"ReadWorkbookScriptsDone",bool:this.Ie.nW}));Vb.push(Object(ea.a)(new ba.a,{name:"WorkbookScriptCount",int64:this.Dj.length}));aa.a(ja.a.hsf,!0,0,Vb)}};l.prototype.eGd=function(){this.YB.eW=new B([],function(){});for(var jb=this.Dj?this.Dj.length:0,Vb=this.Qp?this.Qp.length:0,Ic=this.uB?this.uB.length:0,Rb=0,kc=X.a.yHf,xb=0;xb<kc;xb++)if(xb<jb)this.YB.eW.Cs(this.Dj.f4(xb));else if(xb-jb+Rb<Vb){var Va=this.Qp.f4(xb-jb+Rb);this.Dj.gH(Va.id)?(Rb++,xb--):this.YB.eW.Cs(Va)}else xb-
jb-Vb+Rb<Ic&&this.YB.eW.Cs(this.uB.f4(xb-jb+Rb-Vb))};l.prototype.nJd=function(jb){V.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",!1)&&!V.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",!1)&&(jb?(ma.PageLoadTrackingInfo.instance.U6(ec.a.UN,["automateTab"]),ma.PageLoadTrackingInfo.instance.wW(ec.a.UN,["automateTab"]),ma.PageLoadTrackingInfo.instance.vW(ec.a.UN,["automateTab"])):ma.PageLoadTrackingInfo.instance.jda(ec.a.UN,
["automateTab"]))};l.prototype.O5h=function(){V.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CacheAutomateVisibility",!1)&&ha.c()&&appChrome.api.dispatch(appChrome.actions.deactivateRibbonTab(ec.a.WGb))};Mf.Object.defineProperties(l.prototype,{Qp:{configurable:!0,enumerable:!0,get:function(){return this.Ie.Qp}},Dj:{configurable:!0,enumerable:!0,get:function(){return T()?new B([],function(){}):this.Ie.Dj}},uB:{configurable:!0,enumerable:!0,get:function(){return this.Ie.uB}},$s:{configurable:!0,
enumerable:!0,get:function(){return this.Ie.$s}},Va:{configurable:!0,enumerable:!0,get:function(){return this.hPc}},F4a:{configurable:!0,enumerable:!0,get:function(){return this.Ie.F4a}},initTime:{configurable:!0,enumerable:!0,get:function(){return this.Opg}},Cba:{configurable:!0,enumerable:!0,get:function(){var jb=!!this.Bu.Sx&&this.Bu.Sx.isSuccess&&this.Bu.Sx.value,Vb=!!this.tA&&!this.tA.isSuccess,Ic=!!this.tA&&this.Bu.Sx.isSuccess&&this.tA.value;Vb=X.a.pta||Ic||Vb&&!vb.a.Aka(11);return this.Zgf&&
jb&&Vb}},Zgf:{configurable:!0,enumerable:!0,get:function(){var jb="TestHost"===this.$.ya.DocumentHostInfo.HostTier,Vb=wa.AFrameworkApplication.fa.Wa("UserPrincipalName");Vb=!wa.AFrameworkApplication.fa.qa("IsAnonymousUser")&&!!Vb&&!Vb.includes("ext#")&&!Vb.includes("guest#");return!vb.a.rka&&(jb||this.Yga.Qre&&Vb)}}});Object(u.a)(l,"AutomateCommandManager",null,[778]);var Z=b(1562),Na=b(1509),eb=b(257),cb=b(1167),Ua=b(51),pa=b(105),Qa=b(21),Db=b(1169);k.prototype.swb=function(jb){if(jb.Cba){var Vb=
[];Vb.push(Object(ea.a)(new ba.a,{name:"isSharedRuntimeInstanceInitialized",bool:this.I6a}));Vb.push(Object(ea.a)(new ba.a,{name:"actionName",string:jb.actionName}));Vb.push(Object(ea.a)(new ba.a,{name:X.a.s$,string:jb.clickId.toString()}));this.I6a?this.oWf(jb):this.N1h(jb);aa.a(ja.a.QEi,void 0,void 0,Vb)}};k.prototype.Ugd=function(jb,Vb){var Ic={};Ic[X.a.s$]=Vb;this.GMd(jb,Ic)};k.prototype.Vtj=function(){this.d1f()?this.KGf():Qa.g(this.$).Ea.Nle(this.U8a)};k.prototype.d1f=function(){if(this.I6a||
U(this.$))return!1;var jb=pa.a(this.$);return Qa.g(this.$).Ea.$Zb&&jb.Zdi()};k.prototype.KGf=function(){var jb=this;this.Bu.Sx?this.Bu.Sx.value&&this.Yga.svb():this.Bu.n_c().then(function(Vb){Vb&&jb.Yga.svb()});aa.a(ja.a.LEi)};k.prototype.imj=function(){var jb=Wa.a.create().toString(),Vb={};O(this.$,Vb);var Ic={};Ic[X.a.K5f]=this.Yga.getAuthContext();var Rb={};Rb[X.a.WSe]=Cb.a.xc(Vb);Rb[X.a.C$e]=Cb.a.xc(Ic);Rb[X.a.Ngh]=Cb.a.xc(this.$.ya.DocumentHostInfo);Rb[X.a.VEj]=F(this.$);Rb[X.a.A7f]=Cb.a.xc(X.a.ju);
Rb[X.a.Jse]=this.$.csf?"true":"false";Rb[X.a.kTf]=X.a.b3a(this.$);Rb[X.a.q6e]=x(this.$);Rb[X.a.J8f]=z(this.$);Rb[X.a.s$]=jb;Vb=[];Vb.push(Object(ea.a)(new ba.a,{name:X.a.s$,string:jb}));aa.a(ja.a.OEi,void 0,void 0,Vb);this.GMd(X.a.E9h,Rb)};k.prototype.N1h=function(jb){var Vb=this;this.oyj(jb);U(this.$)&&G(this.$,"localstorage");R.TaskExtensions.Aa(Ua.GetServiceTaskFactory.Ra(this.$.da,374,375,1),function(Ic){Vb.zsi(Ic.result).continueWith(function(){Vb.hmj(jb)});Vb.I6a=!0},this.$.la,3)};k.prototype.zsi=
function(jb){var Vb={};Vb.SolutionId=X.a.solutionId;Vb.Version=X.a.XLd;Vb.StoreType=OSF.StoreType.Sdx;Vb.StoreId=OSF.StoreType.Sdx;Vb.AssetId=X.a.solutionId;Vb.AssetStoreId=OSF.StoreType.Sdx;Vb.TargetType=1;Vb.SharedRuntimeId=X.a.Lvb(this.$);Vb.SourceLocationOverrideResourceId=X.a.Lvb(this.$);Vb.IsToBePersisted=!1;var Ic=new Z.a;Ic.Qk=qa.a.instance.ga(2122);Ic.taskPaneWidth=X.a.ju;var Rb=new cb.a;Rb.aeb=z(this.$);Rb.s4=x(this.$);return jb.ILd(Vb,Ic,void 0,void 0,Rb)};k.prototype.hmj=function(jb){this.imj();
eb.a(this.$)&&eb.a(this.$).dme(this.THi);this.oWf(jb)};k.prototype.oWf=function(jb){var Vb={};Vb[X.a.sij]=jb.shapeId;Vb[X.a.rij]=jb.scriptLink;Vb[X.a.s$]=jb.clickId.toString();Vb[X.a.qij]=jb.buttonText;this.GMd(jb.actionName,Vb)};k.prototype.GMd=function(jb,Vb){var Ic=new Fb.a(X.a.solutionId,OSF.StoreType.Sdx,OSF.StoreType.Sdx,X.a.XLd),Rb=new zb.a(X.a.v7e,X.a.ITe,this.$.ya.UICultureTag),kc=new Yb.a;kc.optionalProperties[kb.a.Qk]=qa.a.instance.ga(2122);kc.optionalProperties[kb.a.sourceLocationOverrideResourceId]=
X.a.Lvb(this.$);kc.optionalProperties[kb.a.ESc]=Vb;kc.optionalProperties[kb.a.taskPaneWidth]=X.a.ju;La.a.instance.XMa(Ic,Na.a.action,jb,Rb,kc)};k.prototype.oyj=function(jb){V.EwaSettings.getBooleanFeatureGate(X.a.B7f,!1)&&jb.actionName===X.a.TTf&&(jb=new Db.a(jb.scriptLink,"initializing",jb.clickId.toString(),jb.buttonText),this.businessBarManager.Ske(64,jb))};Object(u.a)(k,"AutomateCommandRunFromButton",null,[777]);var Kb=b(162),Ab=b(22);e.FCj=function(jb){jb.sort(function(Vb,Ic){return Ic.bFe-Vb.bFe})};
e.Mxc=function(jb){jb.sort(function(Vb,Ic){return Ab.a.compare(Vb.name,Ic.name,!0)})};e.wXh=function(jb){var Vb;var Ic=Vb=null;if(jb){var Rb=jb.indexOf(":");if(-1!==Rb)return Vb=jb.substr(0,Rb),Ic=jb.substr(Rb+1),{returnValue:!0,L5f:Vb,shareId:Ic}}return{returnValue:!1,L5f:Vb,shareId:Ic}};e.sWh=function(jb,Vb){var Ic={};Ic[X.a.Wfg]=encodeURIComponent(jb.workbookContext.WorkbookFileName);Ic[X.a.uVf]=Vb.beb();return ob.c(Ic)};e.lLf=function(jb,Vb){return R.TaskExtensions.F$(Vb.C3a(X.a.ePb),function(Ic){Ic=
Ic.result;if(""!==Ic){Ic=ob.b(Ic);var Rb=Ic[X.a.uVf];if(Ic[X.a.Wfg]===encodeURIComponent(jb.workbookContext.WorkbookFileName)){Ic=new B([],function(xb){e.Mxc(xb)});Rb=bk(Rb);for(var kc=Rb.next();!kc.done;kc=Rb.next())Ic.Cs(new w(kc.value));Ic.sort();return Ic}}},jb.la,3)};Mf.Object.defineProperties(e.prototype,{F4a:{configurable:!0,enumerable:!0,get:function(){var jb=X.a.P5?this.gdc:this.Jwb;return this.$Gb||jb||this.$hd}},$hd:{configurable:!0,enumerable:!0,get:function(){return(X.a.P5?this.oab:this.nab)&&
this.nW&&this.$Gb}}});Object(u.a)(e,"AutomateCommandStorageBase",null,[]);var ub=b(121),Mb=b(100);Rk(d,e);d.prototype.zSg=function(jb,Vb){if(this.cache.zf()){var Ic={};Ic.TimeStamp=ua.a.Ta.Jb;Ic.IsEnabled=Vb;this.cache.SNd(jb,Cb.a.xc(Ic))}};d.prototype.gJh=function(jb){var Vb=!1,Ic=!1,Rb=null;this.cache.zf()&&(jb=ob.b(this.cache.nvb(jb)))&&(Ic=jb.IsEnabled,Rb=new Date(jb.TimeStamp),Vb=!0);return new r(Ic,Vb,Rb)};d.prototype.iLf=function(jb){var Vb=this,Ic=ua.a.Ta.Jb,Rb=[];return R.TaskExtensions.F$(this.indexedDB.C3a(X.a.BPa),
function(kc){var xb=!Vb.oab||!Vb.$s.length;kc=kc.result;Rb.push(Object(ea.a)(new ba.a,{name:"ExistingScriptCount",int64:Vb.$s.length}));if(""!==kc&&(kc=ob.b(kc),Rb.push(Object(ea.a)(new ba.a,{name:"CachedScriptCount",int64:kc.length})),xb)){for(var Va=bk(kc),tb=Va.next();!tb.done;tb=Va.next())Vb.$s.Cs(new w(tb.value));Vb.gdc=!0;Vb.TFd=0<kc.length;aa.a(ja.a.fsf,xb,va.getElapsedMilliseconds(Ic,ua.a.Ta.Jb),Rb);Vb.CGd(jb);return!0}aa.a(ja.a.fsf,xb,va.getElapsedMilliseconds(Ic,ua.a.Ta.Jb),Rb);return!1},
this.$.la,3)};d.prototype.i5i=function(jb){V.EwaSettings.getBooleanFeatureGate(X.a.WWc,!1)&&!T()&&this.o5i(jb);X.a.P5?this.iLf(jb):this.g5i(jb)};d.prototype.MUh=function(jb,Vb,Ic){var Rb=this,kc=ua.a.Ta.Jb,xb=[];if(jb&&jb.IsSuccess){G(this.$,jb.Token);var Va=qb.a.create().toString();xb.push(Object(ea.a)(new ba.a,{name:"CorrelationId",string:Va}));makerstorage.getRecentScripts(Va).then(function(tb){xb.push(Object(ea.a)(new ba.a,{name:"HasReadCachedScripts",bool:Rb.gdc}));Rb.$s.clear();tb=bk(tb);for(var fb=
tb.next();!fb.done;fb=tb.next())Rb.$s.Cs(new w(fb.value));Rb.TFd=!0;Rb.oab=!0;Rb.indexedDB.zf()&&(tb=Cb.a.xc(Rb.$s.beb()),Rb.indexedDB.Mbb(new ab.a(X.a.BPa,tb)));xb.push(Object(ea.a)(new ba.a,{name:"ScriptCount",int64:Rb.$s.length}));aa.a(ja.a.DDb,!0,va.getElapsedMilliseconds(kc,ua.a.Ta.Jb),xb);Vb.JN(X.a.BPa)}).catch(function(tb){Object.getType(tb)===makerstorage.StorageServiceError?(xb.push(Object(ea.a)(new ba.a,{name:"Error",string:tb.message})),xb.push(Object(ea.a)(new ba.a,{name:"ErrorCode",string:String.format("makerstorage_{0}_{1}",
tb.errorCode.toString(),tb.status.toString())})),17===tb.errorCode&&Ic.EHd(X.a.R$b(Rb.$))):(xb.push(Object(ea.a)(new ba.a,{name:"Error",string:tb.toString()})),xb.push(Object(ea.a)(new ba.a,{name:"ErrorCode",string:"exception"})));aa.a(ja.a.MEi,!1,va.getElapsedMilliseconds(kc,ua.a.Ta.Jb),xb);Rb.oab=!0;Vb.JN(X.a.BPa)})}else Va=jb?jb.ErrorCode:"need_token",jb=jb?jb.ErrorMessage:"No Access Token",xb.push(Object(ea.a)(new ba.a,{name:"ServiceChecked",bool:!1})),xb.push(Object(ea.a)(new ba.a,{name:"Error",
string:jb})),xb.push(Object(ea.a)(new ba.a,{name:"ErrorCode",string:Va})),aa.a(ja.a.DDb,!1,va.getElapsedMilliseconds(kc,ua.a.Ta.Jb),xb),this.oab=!0,Vb.JN(X.a.BPa)};d.prototype.h5i=function(jb,Vb){var Ic=this,Rb=new Kb.a,kc=D(this.$);I(this.$,function(xb){if((xb=xb.Result)&&200===xb.ResponseStatusCode)xb=xb.ResponseBody.join(""),xb=JSON.parse(xb),jb(Ic.rWi(xb.value)),Rb.setResult(!0);else{xb=xb?"RichApi_"+xb.ResponseStatusCode:"RichApiError";var Va=[];Va.push(Object(ea.a)(new ba.a,{name:"Error",string:"Failed to read shared script ids from document"}));
Va.push(Object(ea.a)(new ba.a,{name:"ErrorCode",string:xb}));Ic.nW=!0;Ic.r_a(Vb,ua.a.Ta.Jb,0,Va);Rb.setResult(!1)}},function(xb){xb=ub.a.Mf(xb.data);Q.ULS.sendTraceTag(537170309,0,15,"REST API failed to fetch the CustomXmlPart for Automate Gallery.");var Va=[];Va.push(Object(ea.a)(new ba.a,{name:"Error",string:"Failure using rich api: "+xb}));Va.push(Object(ea.a)(new ba.a,{name:"ErrorCode",string:"RichApiFailure"}));Ic.nW=!0;Ic.r_a(Vb,ua.a.Ta.Jb,0,Va);Rb.setResult(!1)},kc,Rb)};d.prototype.HWh=function(jb,
Vb,Ic){var Rb=this,kc=ua.a.Ta.Jb,xb=0,Va=0;this.nW=xb===jb.count;var tb=[];tb.push(Object(ea.a)(new ba.a,{name:"ScriptIds",int64:jb.count}));if(jb.count)if(Vb&&Vb.IsSuccess){G(this.$,Vb.Token);var fb={};Vb=bk(jb);for(var ac=Vb.next();!ac.done;fb={Bfb:fb.Bfb},ac=Vb.next())ac=ac.value,fb.Bfb=qb.a.create().toString(),makerstorage.getSharedScript(ac.value,fb.Bfb).then(function(Ac){return function(Rc){var Fc=[];Fc.push(Object(ea.a)(new ba.a,{name:"BodySize",int64:Rc.body.length}));Fc.push(Object(ea.a)(new ba.a,
{name:"CorrelationId",string:Ac.Bfb}));aa.a(ja.a.gsf,!0,va.getElapsedMilliseconds(kc,ua.a.Ta.Jb),Fc);xb++;Rc=new w(Rc);Rc.shareId=jb.na(Rc.id);Rb.Dj.Cs(Rc);Rb.nW=xb===jb.count;Rb.VFd=!0;Rb.r_a(Ic,kc,Va,tb)}}(fb)).catch(function(Ac){return function(Rc){var Fc=[];Object.getType(Rc)===makerstorage.StorageServiceError?(tb.push(Object(ea.a)(new ba.a,{name:"Error",string:Rc.message})),tb.push(Object(ea.a)(new ba.a,{name:"ErrorCode",string:String.format("makerstorage_{0}_{1}",Rc.errorCode.toString(),Rc.status.toString())}))):
(Fc.push(Object(ea.a)(new ba.a,{name:"Error",string:Rc.toString()})),Fc.push(Object(ea.a)(new ba.a,{name:"ErrorCode",string:"exception"})));Fc.push(Object(ea.a)(new ba.a,{name:"CorrelationId",string:Ac.Bfb}));aa.a(ja.a.gsf,!1,va.getElapsedMilliseconds(kc,ua.a.Ta.Jb),Fc);xb++;Va++;Rb.nW=xb===jb.count;Rb.r_a(Ic,kc,Va,tb)}}(fb)).finally(function(){if(V.EwaSettings.getBooleanFeatureGate(X.a.WWc,!1)&&Rb.indexedDB.zf()&&Rb.nW){var Ac=e.sWh(Rb.$,Rb.Dj);Rb.indexedDB.Mbb(new ab.a(X.a.ePb,Ac))}})}else fb=Vb?
Vb.ErrorCode:"need_token",Vb=Vb?Vb.ErrorMessage:"No Access Token",tb.push(Object(ea.a)(new ba.a,{name:"Error",string:Vb})),tb.push(Object(ea.a)(new ba.a,{name:"ErrorCode",string:fb})),this.nW=!0,this.r_a(Ic,kc,Va,tb);else this.nW=this.VFd=!0,this.r_a(Ic,kc,Va,tb),V.EwaSettings.getBooleanFeatureGate(X.a.WWc,!1)&&R.TaskExtensions.F$(e.lLf(this.$,this.indexedDB),function(Ac){Ac.result&&(Rb.indexedDB.f5c(X.a.ePb),Rb.Dj.clear(),Ic.JN("CachedScripts"))},this.$.la,3)};d.prototype.TVh=function(jb){var Vb=
{id:"samples-6"};Vb.name=qa.a.instance.ga(2116);this.uB.Cs(new w(Vb));Vb.id="samples-8";Vb.name=qa.a.instance.ga(2117);this.uB.Cs(new w(Vb));Vb.id="samples-2";Vb.name=qa.a.instance.ga(2113);this.uB.Cs(new w(Vb));Vb.id="samples-4";Vb.name=qa.a.instance.ga(2114);this.uB.Cs(new w(Vb));Vb.id="samples-5";Vb.name=qa.a.instance.ga(2115);this.uB.Cs(new w(Vb));Vb.id="samples-9";Vb.name=qa.a.instance.ga(2118);this.uB.Cs(new w(Vb));this.$Gb=!0;jb.JN("SampleScripts")};d.prototype.kYh=function(){var jb={};jb.id=
X.a.N7f;jb.name=qa.a.instance.ga(2119);this.OMb.Cs(new w(jb));jb.id=X.a.O7f;jb.name=qa.a.instance.ga(2120);this.OMb.Cs(new w(jb))};d.prototype.rWi=function(jb){var Vb=new Mb.a;if(jb=this.l1a.parseFromString(jb,"text/xml").querySelector('[id="script-ids-node-id"]')){jb=jb.getElementsByTagName("scriptId");for(var Ic={},Rb=0;Rb<jb.length;Ic={PPb:Ic.PPb,MPb:Ic.MPb,HPb:Ic.HPb},Rb++)Ic.PPb=jb[Rb].getAttribute("id"),Ic.PPb&&(Ic.MPb=void 0,Ic.HPb=void 0,function(kc){return function(){var xb=e.wXh(kc.PPb);
kc.MPb=xb.L5f;kc.HPb=xb.shareId;return xb}}(Ic)().returnValue&&Vb.ia(Ic.MPb,Ic.HPb))}return Vb};d.prototype.o5i=function(jb){var Vb=this,Ic=ua.a.Ta.Jb,Rb=[];R.TaskExtensions.F$(e.lLf(this.$,this.indexedDB),function(kc){var xb=kc.result;Rb.push(Object(ea.a)(new ba.a,{name:"ExistingScriptCount",int64:Vb.Dj.length}));if(xb){Rb.push(Object(ea.a)(new ba.a,{name:"CachedScriptCount",int64:xb.length}));if(kc=!Vb.nW||0===Vb.Dj.length){xb=bk(xb.getScripts());for(var Va=xb.next();!Va.done;Va=xb.next())Vb.Dj.Cs(Va.value);
Vb.Dj.sort();aa.a(ja.a.Uxd,kc,va.getElapsedMilliseconds(Ic,ua.a.Ta.Jb),Rb);Vb.CGd(jb);return!0}aa.a(ja.a.Uxd,kc,va.getElapsedMilliseconds(Ic,ua.a.Ta.Jb),Rb)}else aa.a(ja.a.Uxd,!1,va.getElapsedMilliseconds(Ic,ua.a.Ta.Jb),Rb);return!1},this.$.la,3)};d.prototype.g5i=function(jb){var Vb=this,Ic=ua.a.Ta.Jb,Rb=[];R.TaskExtensions.F$(this.indexedDB.C3a(X.a.W$a),function(kc){var xb=!Vb.nab||!Vb.Qp.length;kc=kc.result;Rb.push(Object(ea.a)(new ba.a,{name:"ExistingScriptCount",int64:Vb.Qp.length}));if(""!==
kc&&(kc=ob.b(kc),Rb.push(Object(ea.a)(new ba.a,{name:"CachedScriptCount",int64:kc.length})),xb)){kc=bk(kc);for(var Va=kc.next();!Va.done;Va=kc.next())Vb.Qp.Cs(new w(Va.value));Vb.Qp.sort();aa.a(ja.a.esf,xb,va.getElapsedMilliseconds(Ic,ua.a.Ta.Jb),Rb);Vb.CGd(jb);return!0}aa.a(ja.a.esf,xb,va.getElapsedMilliseconds(Ic,ua.a.Ta.Jb),Rb);return!1},this.$.la,3)};d.prototype.r_a=function(jb,Vb,Ic,Rb){this.nW&&(Rb.push(Object(ea.a)(new ba.a,{name:"ScriptCount",int64:this.Dj.length})),Rb.push(Object(ea.a)(new ba.a,
{name:"ScriptErrorCount",int64:Ic})),aa.a(ja.a.NEi,!Ic,va.getElapsedMilliseconds(Vb,ua.a.Ta.Jb),Rb),this.Dj.sort(),jb.JN(X.a.ePb))};d.prototype.CGd=function(jb){this.Jwb=!0;jb.JN("CachedScripts")};Object(u.a)(d,"AutomateCommandStorage",e,[]);var Aa=b(911),Za=P.a;Rk(c,Za);c.prototype.create=function(){var jb=this,Vb=Ua.GetServiceTaskFactory.Ra(this.$.da,349,350,this.hb),Ic=da.a.loadScript(130,4,this.hb,void 0,void 0,351),Rb=Ua.GetServiceTaskFactory.create(this.$.da,102,this.$.la,this.hb),kc=Ua.GetServiceTaskFactory.create(this.$.da,
396,this.$.la,this.hb),xb=Ua.GetServiceTaskFactory.Ra(this.$.da,5,4,this.hb);R.TaskExtensions.Aa(R.TaskExtensions.Vd([Vb,Ic,Rb,kc,xb],this.la,3),function(){var Va=Vb.result,tb=kc.result,fb=xb.result,ac=new v,Ac=new K(jb.$,Va,ac),Rc=new d(jb.$,tb),Fc=new m(jb.$,Rc),wb=new k(jb.$,Ac,ac,fb);V.EwaSettings.isChangeGateEnabled("OfficeVSO:6143820_MoveServiceRegistrationFromFAM")?(fb=Object(Aa.b)(jb.$.da,352,function(){return new l(jb.$,Va,Rb.result,tb,wb,ac,Ac,Rc,Fc)}),jb.pb(fb)):jb.pb(jb.$.da.za(352)||
new l(jb.$,Va,Rb.result,tb,wb,ac,Ac,Rc,Fc))},this.la,3)};c.ka=function(jb){jb&&jb.da.Ga(351,new c(jb))};Object(u.a)(c,"AutomateCommandManagerFactory",P.a,[]);var Zb=b(10);b.d(E,"a",function(){return a})},1382:function(u,E,b){function a(){Type.registerNamespace("Common.App.WopiIdentity");c.main()}function c(){this.fb=null}function d(O){this._initialized=!1;this.$9a={};this.myc={};this.kO=y.AFrameworkApplication.ta.pD;this.hjd=O}function e(O,U,J){this.expiration=this.authority=this.accessToken=null;
this.accessToken=O;this.authority=U;this.expiration=J}function k(){this.authority=this.email=this.displayName=null;this.authority=this.email=this.displayName=""}function l(){}function n(O,U){this.requestCallback=this.requestParameters=null;this.requestParameters=O;this.requestCallback=U}u=b(0);var f=b(14),v=b(84),r;(function(O){O[O.generalException=0]="generalException";O[O.invalidArgument=1]="invalidArgument";O[O.notAllowed=2]="notAllowed";O[O.apiNotAvailable=3]="apiNotAvailable";O[O.unresolvedPendingRequest=
4]="unresolvedPendingRequest";O[O.timeout=5]="timeout";O[O.adalTimeout=6]="adalTimeout";O[O.userNotSignedIn=7]="userNotSignedIn";O[O.userAborted=8]="userAborted";O[O.silentSignInFailed=9]="silentSignInFailed";O[O.invalidResourceUrl=10]="invalidResourceUrl";O[O.invalidGrant=11]="invalidGrant";O[O.connectionLost=12]="connectionLost";O[O.clientError=13]="clientError";O[O.serverError=14]="serverError"})(r||(r={}));Object(u.b)("ErrorCodes",r);b(1503);Object(u.a)(n,"OutstandingRequest",null,[]);l.WCi="AADSTS50058";
l.invalidResourceUrl="AADSTS50001";l.RCi="AADSTS65001";l.gDi="AADSTS70011";l.userAborted="13002";l.bZi="Popup Window is null";l.aZi="Popup Window closed";l.adalTimeout="Token renewal operation failed due to timeout";l.WJj="tokenRevoked";Object(u.a)(l,"WopiHostErrorType",null,[]);var y=b(4),m=b(943),w=b(635),B=b(41),A=b(1502);Object(u.a)(k,"WopiIdentityInfo",null,[126]);Object(u.a)(e,"WopiIdentityToken",null,[77]);var z=b(27),x=b(153),D=b(391),I=b(170),F=b(80),G=b(355);d.prototype.I1a=function(O){this._initialized||
(O.Tn(I.a.wGf),O.Ml(I.a.wGf,Object(v.a)(this,this.IPi,"onReceivedAccessToken")),this._initialized=!0)};d.prototype.getAccessToken=function(O,U,J){var H=this;J=void 0===J?null:J;this.rNa(O,U);return new Promise(function(K,N){if(H.Ald(U))if(U in H.$9a)N("unresolvedPendingRequest");else{var M=window.setTimeout(function(){var Q={};f.ULS.sendTraceTag(37856032,344,10,B.c((Q.error="Request timeout.",Q.callerId=U,Q)));N("timeout")},12E4);H.Ebd(O,U,J,function(Q,P){window.clearTimeout(M);Q?K(Q):(Q={},f.ULS.sendTraceTag(37856033,
369,15,B.c((Q.error=r[P],Q))),N(P))})}else{var C={};f.ULS.sendTraceTag(37856034,344,10,B.c((C.error="Caller is not allowed.",C)));N("notAllowed")}})};d.prototype.getPrimaryIdentityInfo=function(O){var U=this;return new Promise(function(J,H){if(U.Ald(O))U.RTh(function(N,M){N?J(N):(N={},f.ULS.sendTraceTag(37856064,369,10,B.c((N.error=M.toString(),N))),H(M))});else{var K={};f.ULS.sendTraceTag(37856065,344,10,B.c((K.error="Caller is not allowed.",K)));H("notAllowed")}})};d.prototype.getAuthContext=function(O){var U=
this;return new Promise(function(J,H){var K=U.getAuthContextSync(O);K?J(K):H("notAllowed")})};d.prototype.getAuthContextSync=function(O){if(this.Ald(O)){var U=new A.a;U.upn=y.AFrameworkApplication.fa.Wa("UserPrincipalName");U.userId=y.AFrameworkApplication.fa.Wa("LoggableUserId");U.authority=y.AFrameworkApplication.fa.Wa("HostAuthAuthority");U.tenantId=y.AFrameworkApplication.fa.Wa("TenantId");U.isAnonymous=y.AFrameworkApplication.fa.qa("IsAnonymousUser");U.supportsAuthToken=this.E6h(O);O=y.AFrameworkApplication.fa.Wa("HostAuthType");
U.authorityType="aad"===O.toLowerCase()?2:"msa"===O.toLowerCase()?1:0;return U}U={};f.ULS.sendTraceTag(40751647,344,10,B.c((U.error="Caller is not allowed.",U)));return null};d.prototype.E6h=function(O){var U=m.a.lxb;return z.a.Wwa?U&&m.a.G7f?Array.contains(m.a.G7f,O.toLowerCase()):!1:U};d.prototype.Ebd=function(O,U,J,H){var K=this,N=[];Array.add(N,Object.assign(new F.a,{name:"CallerId",string:U}));Array.add(N,Object.assign(new F.a,{name:D.a.vSd,string:O.correlationId}));x.a.sendTelemetryEvent(Object.assign(new G.a,
{name:"Office.Online.Extensibility.SSO.FirstPartyRequestTokenFromHost",dataFields:N}));N=w.a.create().toString();var M="getAccessToken_"+N,C=this.kO.sc("ComponentAttach",M);this.myc[M]=C;var Q={};Q[D.a.wSd]=N;Q[D.a.nDj]=O.resource;Q[D.a.oDj]=O.scope;Q[D.a.F4f]=y.AFrameworkApplication.fa.Wa("HostAuthType");Q[D.a.rDj]=y.AFrameworkApplication.fa.Wa("UserPrincipalName");Q[D.a.pDj]=O.silentLogin;Q[D.a.kDj]=O.options;Q[D.a.vSd]=O.correlationId;Q[D.a.lDj]=U;J&&(Q[D.a.addinName]=J.AddinName,Q[D.a.jDj]=J.AddinTrustId);
this.hjd.execute(function(P){K.I1a(P);P.uj(I.a.getAuthToken,Q)});this.$9a[N]=new n(O,H)};d.prototype.RTh=function(O){var U=y.AFrameworkApplication.fa.Wa("UserName"),J=y.AFrameworkApplication.fa.Wa("UserPrincipalName"),H=y.AFrameworkApplication.fa.Wa("LoggableUserIdSpace"),K=new k;K.email=J;K.displayName=U;switch(H){case "OrgIdPuid":K.authority="AzureActiveDirectoryAccount";break;case "MsaCid":case "MsaPuid":K.authority="MicrosoftAccount";break;default:K.authority=H}O(K,null)};d.prototype.IPi=function(O){var U=
null;try{var J=O.Values[D.a.wSd],H=O.Values[D.a.iDj],K=O.Values[D.a.F4f],N=O.Values[D.a.qDj],M=null,C=null,Q=this.$9a[J];if("undefined"!==typeof Q&&Q){var P=[];Array.add(P,Object.assign(new F.a,{name:D.a.vSd,string:Q.requestParameters.correlationId}));x.a.sendTelemetryEvent(Object.assign(new G.a,{name:"Office.Online.Extensibility.SSO.FirstPartyResponseTokenFromHost",dataFields:P}));U=Q.requestCallback;delete this.$9a[J];"undefined"!==typeof H&&H&&H.length?C=new e(H,K,N):M=r[this.Xxi(O)];J="getAccessToken_"+
J;J in this.myc&&(this.myc[J].stop(),delete this.myc[J]);U(C,M)}else M={},f.ULS.sendTraceTag(37856066,344,10,B.c((M.error="No matching outstanding request for request ID.",M.requestId=J,M)))}catch(ka){O=O.Values[D.a.wSd],O in this.$9a&&delete this.$9a[O],this.Fjc(),O={},f.ULS.sendTraceTag(37856067,344,10,B.c((O.error=ka.message,O.stack=ka.stack,O))),U&&U(null,"generalException")}};d.prototype.Ald=function(O){var U=y.AFrameworkApplication.S_h();O=O.toLowerCase();U=bk(U);for(var J=U.next();!J.done;J=
U.next())if(O===J.value.toLowerCase())return!0;U=m.a.FVc;for(var H in U)if(O===U[H].toLowerCase())return!0;return!1};d.prototype.Xxi=function(O){O=O.Values[D.a.mDj];this.Fjc();var U={};f.ULS.sendTraceTag(39068821,344,15,B.c((U.error=O,U)));return O?-1<O.indexOf(l.WCi)?9:-1<O.indexOf(l.bZi)||-1<O.indexOf(l.aZi)?12:-1<O.indexOf(l.invalidResourceUrl)?10:-1<O.indexOf(l.userAborted)?8:-1<O.indexOf(l.gDi)||-1<O.indexOf(l.RCi)||O===l.WJj?11:-1<O.indexOf(l.adalTimeout)?6:0:13};d.prototype.rNa=function(O,
U){O=this.p6i(O.resource);var J={};f.ULS.sendTraceTag(39921882,344,50,B.c((J.callerId=U,J.resource=O,J)))};d.prototype.Fjc=function(){var O={};f.ULS.sendTraceTag(39068822,344,50,B.c((O.userAgent=window.navigator.userAgent,O)))};d.prototype.p6i=function(O){return(O?O:"").replace("://","__").replace(RegExp("\\.","g"),"_dot_").replace("/","\\")};Object(u.a)(d,"WopiIdentityManager",null,[41]);var T=b(254);c.prototype.Ph=function(O){this.fb=O;O.register(d,"Common.App.WopiIdentity.WopiIdentityManager").as("Common.App.WopiIdentity.IWopiIdentity").tc().Cc(function(){return new d(O.Tb("Postmessage.IHostPostmessenger"))})};
c.prototype.init=function(){y.AFrameworkApplication.fa&&y.AFrameworkApplication.fa.Su(Object(v.a)(this,this.oB,"onFullAppSettingsReady"))};c.prototype.oB=function(){try{this.fb.resolve("Common.App.WopiIdentity.IWopiIdentity")}catch(O){f.ULS.sendTraceTag(571074327,383,10,"Failed to initialize WopiIdentityPackage with exception: "+O)}};c.prototype.dispose=function(){};c.main=function(){T.a.instance.Qi(new c)};Mf.Object.defineProperties(c.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.WopiIdentity"}}});
Object(u.a)(c,"WopiIdentityPackage",null,[10,11]);b.d(E,"a",function(){return a})},1392:function(u,E,b){function a(ba,oa,ra){this.ywa=!1;this.WE={};this.$=ba;this.ij=oa;this.$kd().Wma();this.indexedDB=ra;this.indexedDB.zf()&&(this.ywa=!0,this.indexedDB.initialize(a.gkd,a.hkd))}function c(ba,oa){this.aQc=ba;this._message=oa}function d(){}function e(){}function k(ba){switch(ba){case 0:return"Medium";case 1:return"Unexpected";case 2:return"Verbose";default:return""}}function l(ba,oa){m(b(1392).CustomFunctionsInstaller.vZe("CustomFunctionsRuntimeLogging"),
function(ra){if(ra.result&&window.console)switch(ra=k(ba.severity)+" "+ba.message+oa,ba.severity){case 2:window.console.log&&window.console.log(ra);break;case 0:window.console.info&&window.console.info(ra);break;case 1:window.console.error&&window.console.error(ra)}return!0},"CustomFunctionsInstaller::LogEvent failed due to GetLocalCacheItemSafeFromLocalStorage failed")}function n(ba,oa,ra,db,Ka){ra=ba.continueWith(function(){oa(ba)},3,ra,db);ra.continueWith(function(){F.ULS.sendTraceTag(537163459,
0,10,Ka)},4);return ra}function f(ba,oa,ra){return n(ba,oa,ka.a.none,R.a.current,ra)}function v(ba,oa,ra,db,Ka){ra=ba.Io(function(){return oa(ba)},3,ra,db);ra.continueWith(function(){F.ULS.sendTraceTag(537163460,0,10,Ka)},4);return M.TaskExtensions.GAc(ra)}function r(ba,oa,ra){return v(ba,oa,ka.a.none,R.a.current,ra)}function y(ba,oa,ra,db,Ka){ra=ba.Io(function(){return oa(ba)},3,ra,db);ra.continueWith(function(){F.ULS.sendTraceTag(537163461,0,10,Ka)},4);return ra}function m(ba,oa,ra){return y(ba,
oa,ka.a.none,R.a.current,ra)}function w(ba,oa,ra,db,Ka){ra=ba.Io(function(){return oa(ba)},3,ra,db);ra.continueWith(function(){F.ULS.sendTraceTag(537163462,0,10,Ka)},4);return M.TaskExtensions.GAc(ra)}function B(ba,oa,ra){return w(ba,oa,ka.a.none,R.a.current,ra)}function A(ba,oa,ra,db,Ka){ra=ba.continueWith(function(){oa(ba)},3,ra,db);ra.continueWith(function(){F.ULS.sendTraceTag(537163463,0,10,Ka)},4);return ra}function z(ba,oa,ra){return A(ba,oa,ka.a.none,R.a.current,ra)}function x(){}function D(ba){ba=
ba.split("|");this.Ww=ba[1];this.DQc=ba[2];this.hTd=ba[3]}b.r(E);u=b(0);var I=b(7),F=b(14),G=b(4),T=b(162),O=b(202),U=b(85),J=b(564),H=b(177),K=b(62),N=b(51),M=b(37),C=b(223),Q=b(121),P=b(592);Mf.Object.defineProperties(D.prototype,{solutionId:{configurable:!0,enumerable:!0,get:function(){return this.Ww}},solutionVersion:{configurable:!0,enumerable:!0,get:function(){return this.DQc}},needToRestoreManifest:{configurable:!0,enumerable:!0,get:function(){return this.hTd===OSF.StoreTypeEnum.Registry.toString()}}});
Object(u.a)(D,"AddinStoreInfo",null,[]);Object(u.a)(x,"CustomFunctionRegistrationInfos",null,[]);var ka=b(214),R=b(63),fa=b(1170);Object(u.a)(e,"InstallationInfo",null,[]);Object(u.a)(d,"UninstallationInfo",null,[]);var ca=b(28),ea=b(91),wa=b(34),X=b(31),ja=b(1),va=b(22),ua=b(294),Xa=b(998),aa=b(58);Mf.Object.defineProperties(c.prototype,{severity:{configurable:!0,enumerable:!0,get:function(){return this.aQc}},message:{configurable:!0,enumerable:!0,get:function(){return this._message}}});Object(u.a)(c,
"CustomFunctionLog",null,[]);b.d(E,"CustomFunctionsInstaller",function(){return a});a.prototype.d$e=function(ba,oa,ra,db){var Ka=this;if(db.invariantNamespace)for(var Ga=0;Ga<db.invariantNamespace.length;++Ga){var xa=db.invariantNamespace.charAt(Ga);if("."!==xa&&"_"!==xa&&"a">xa&&"z"<xa&&"A">xa&&"Z"<xa&&"0">xa&&"9"<xa)throw F.ULS.sendTraceTag(537163552,0,10,"CustomFunctionsInstaller::InstallAsync: InvariantNamespace validation failed. Character='{0}', Position={1}.",xa,Ga),Error.create("InvariantNamespace validation failed");
}return B(this.DSg(ra,db.manifest),function(){return B(Ka.QFd(ba),function(da){var qa=da.result;return(null===qa||void 0===qa?0:qa.isDynamicMetadata)?Ka.SGd(ba,oa,qa,!1,!1,!1):B(Ka.tXj(ba,oa,db),function(na){var ia;qa=(ia=new e,ia.addinId=ra,ia.locale=db.locale,ia.addinInvariantNamespace=db.invariantNamespace,ia.addinNamespace=db.namespace,ia.addinTitle=db.title,ia.isXllCompatible=db.isXllCompatible,ia.metadataContent=JSON.stringify(JSON.parse(na.result)),ia);return Ka.SGd(ba,oa,qa,!1,a.Ixh(db.osfControl.getStoreType()),
fa.a(Ka.$,db))},"CustomFunctionsInstaller::InstallAsync failed due to XhrGetMetadataAsync failed")},"CustomFunctionsInstaller::InstallAsync failed due to ReadInstallationInfoAsync failed")},"CustomFunctionsInstaller::InstallAsync failed due to CacheManifestAsync failed")};a.prototype.f$e=function(ba,oa,ra,db){var Ka=this;if(!a.uqd(ra))throw F.ULS.sendTraceTag(537163551,0,10,"CustomFunctionsInstaller.InstallDynamicFunctionsAsync: Invalid metadata JSON."),Error.create("Invalid Metadata JSON");return B(this.QFd(ba),
function(Ga){Ga=Ga.result;if(!Ga&&(Ga=wa.a.yc(Ka.jV,ba),!Ga))throw F.ULS.sendTraceTag(537163550,0,10,String.format("CustomFunctionsInstaller::InstallDynamicFunctionsAsync: Unexpected error, the addin with solutionId {0} hasn't been installed yet.",Telemetry.PrivacyRules.GetPrivacyCompliantId(ba,oa,null))),Error.create("Customfunctions dynamic registration failed");Ga.metadataContent=JSON.stringify(JSON.parse(ra));Ga.isDynamicMetadata=!0;return Ka.SGd(ba,oa,Ga,!0,!0,db)},"CustomFunctionsInstaller::InstallDynamicFunctionsAsync failed due to ReadInstallationInfoAsync failed")};
a.prototype.qag=function(ba,oa){var ra=this;this.ij.mia();var db=Object(I.a)(new d,{solutionId:ba}),Ka=String.format("CustomFunctionsInstaller.UninstallAsync: Failed to uninstall Custom Functions for solution: {0}.",Telemetry.PrivacyRules.GetPrivacyCompliantId(ba,oa,null));return B(this.CHd(ba),function(){return B(ra.JHd(ba),function(){return ra.TWd(ra.ij,ba,oa,db)},"CustomFunctionsInstaller.UninstallAsync failed due to RemoveManifestAsync failed")},Ka)};a.prototype.tXj=function(ba,oa,ra){var db=
new T.a;OSF.OUtil.xhrGet(ra.metadataUrl,function(Ka){Ka?db.setResult(Ka):db.setException(Error.create("Invalid manifest"))},function(Ka){F.ULS.sendTraceTag(537163548,0,10,"CustomFunctionsInstaller.XhrGetMetadataAsync: Failed to download Custom Functions metadata for solution {0}. ErrorCode: {1}.",Telemetry.PrivacyRules.GetPrivacyCompliantId(ba,oa,null),Ka);db.setException(Error.create("Failed to download manifest"))});return db.task};a.prototype.$kd=function(){var ba=this;return B(this.Lqc(),function(oa){var ra=
oa.result;if(!ra.length)return aa.Task.Ua(!0);F.ULS.sendTraceTag(537163547,0,50,"CustomFunctionsInstaller.InstallFromCacheAsync: Custom Functions registration from cache attempted.");oa=new O.a;for(var db=[],Ka={},Ga=0;Ga<ra.length;Ka={KPb:Ka.KPb},Ga++)Ka.KPb=Object(U.a)(String,ra[Ga]),oa.add(m(ba.QFd(Ka.KPb),function(xa){return function(da){if(da=da.result){var qa=wa.a.yc(ba.WE,da.addinId);qa&&qa===da.metadataContent||(ba.WE[da.addinId]=da.metadataContent,ba.jV[xa.KPb]=da,db.push(da))}return!0}}(Ka),
"CustomFunctionsInstaller::InstallFromCacheAsync failed due to ReadInstallationInfoAsync failed"));return r(aa.Task.WhenAllEnumerable(oa),function(){if(db.length){var xa,da=(xa=new x,xa.registrationInfos=db,xa);return ba.m0b(ba.ij,ra,da)}F.ULS.sendTraceTag(537163546,0,50,"CustomFunctionsInstaller.InstallFromCacheAsync: There is no custom function to register from cache");return aa.Task.Ua(!0)},"CustomFunctionsInstaller::InstallFromCacheAsync failed due to getInstallationInfoTasks failed")},"CustomFunctionsInstaller::InstallFromCacheAsync failed")};
a.prototype.g$e=function(){var ba=this,oa=new T.a;new O.a;var ra=[],db=[];Object.keys(this.jV).forEach(function(Ka){Ka=Object(U.a)(String,Ka);var Ga=wa.a.yc(ba.jV,Ka);ra.push(Ga);db.push(Ka)});if(!db.length)return oa.setResult(!0),oa.task;oa=Object(I.a)(new x,{registrationInfos:ra});return this.m0b(this.ij,db,oa)};a.prototype.Lqc=function(){return m(this.eed(P.a.zYa),function(ba){ba=ba.result;return Array.isArray(Sys.Serialization.JavaScriptSerializer.deserialize(ba||"[]"))?Sys.Serialization.JavaScriptSerializer.deserialize(ba||
"[]"):null},"CustomFunctionsInstaller::ReadSolutionIdsLowerCaseAsync failed due to GetLocalCacheItemSafeAsync failed")};a.prototype.cgg=function(ba){return this.YNd(P.a.zYa,Sys.Serialization.JavaScriptSerializer.serialize(ba))};a.prototype.QFd=function(ba){return B(this.eed(P.a.I3a(ba)),function(oa){oa=oa.result||"";return 0<oa.length?aa.Task.Ua(Sys.Serialization.JavaScriptSerializer.deserialize(oa,!0)):aa.Task.Ua(null)},"CustomFunctionsInstaller::ReadInstallationInfoAsync failed due to GetLocalCacheItemSafeAsync failed")};
a.prototype.mXj=function(ba,oa){var ra=this;return B(this.xKe(ba),function(){return B(ra.YNd(P.a.I3a(ba),Sys.Serialization.JavaScriptSerializer.serialize(oa)),function(){return a.ZNd(P.a.Nhd,"true")},"CustomFunctionsInstaller::WriteInstallationInfoAsync failed due to SetLocalCacheItemSafeAsync failed")},"CustomFunctionsInstaller::WriteInstallationInfoAsync failed due to EnsureCacheEntryForAddinAsync failed")};a.prototype.CHd=function(ba){var oa=this;return B(this.ONf(ba),function(){return B(oa.gOf(P.a.I3a(ba)),
function(){return B(oa.Lqc(),function(ra){return ra.result.length?aa.Task.Ua(!0):a.ZNd(P.a.Nhd,"false")},"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due update ReadSolutionIdsLowerCaseAsync failed")},"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due to RemoveLocalCacheItemSafeAsync failed")},"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due to RemoveCacheEntryForAddinSafeAsync failed")};a.prototype.fLf=function(ba){return this.eed(P.a.H3a(ba))};a.prototype.$fg=
function(ba,oa){var ra=this;return B(this.xKe(ba),function(){return ra.YNd(P.a.H3a(ba),oa)},"CustomFunctionsInstaller::WriteManifestAsync failed due to EnsureCacheEntryForAddinAsync failed")};a.prototype.JHd=function(ba){var oa=this;return B(this.ONf(ba),function(){return oa.gOf(P.a.H3a(ba))},"CustomFunctionsInstaller::RemoveManifestAsync failed due to RemoveCacheEntryForAddinSafeAsync failed")};a.prototype.xKe=function(ba){var oa=this;return B(this.Lqc(),function(ra){ra=ra.result;var db=ba.toLowerCase();
if(Array.contains(ra,db))return aa.Task.Ua(!0);ra.push(db);return oa.cgg(ra)},"CustomFunctionsInstaller::EnsureCacheEntryForAddinAsync failed due to ReadSolutionIdsLowerCaseAsync failed")};a.prototype.ONf=function(ba){var oa=this;return B(this.Lqc(),function(ra){ra=ra.result;var db=ba.toLowerCase();return Array.contains(ra,db)?(ra.splice(Array.indexOf(ra,db),1),oa.cgg(ra)):aa.Task.Ua(!0)},"CustomFunctionsInstaller::RemoveCacheEntryForAddinSafeAsync failed due to ReadSolutionIdsLowerCaseAsync failed")};
a.prototype.DSg=function(ba,oa){if(ja.EwaSettings.isChangeGateEnabled("OfficeVSO:5024811_AddinIdInfoDevCatalogCrashFix"))return ba=new OSF.AddinIdInfo(ba),ba.needToRestoreManifest()?this.$fg(ba.getSolutionId(),oa):aa.Task.Ua(!0);ba=new D(ba);return ba.needToRestoreManifest?this.$fg(ba.solutionId,oa):aa.Task.Ua(!0)};a.prototype.Dgj=function(ba){var oa=this;if(ja.EwaSettings.isChangeGateEnabled("OfficeVSO:5024811_AddinIdInfoDevCatalogCrashFix")){var ra=new OSF.AddinIdInfo(ba);return ra.needToRestoreManifest()?
m(this.fLf(ra.getSolutionId()),function(Ka){(Ka=Ka.result)&&OSF.OsfManifestManager.cacheManifestFromXml(ra.getSolutionId(),ra.getSolutionVersion(),Ka,oa.$.ya.UICultureTag);return!0},"CustomFunctionsInstaller::RestoreManifestAsync failed due to ReadManifestAsync failed"):aa.Task.Ua(!0)}var db=new D(ba);return db.needToRestoreManifest?m(this.fLf(db.solutionId),function(Ka){(Ka=Ka.result)&&OSF.OsfManifestManager.cacheManifestFromXml(db.solutionId,db.solutionVersion,Ka,oa.$.ya.UICultureTag);return!0},
"CustomFunctionsInstaller::RestoreManifestAsync failed due to ReadManifestAsync failed"):aa.Task.Ua(!0)};a.prototype.gOf=function(ba){return this.ywa?this.indexedDB.f5c(ba):a.U9i(ba)};a.prototype.YNd=function(ba,oa){return this.ywa?this.indexedDB.Mbb(new Xa.a(ba,oa)):a.ZNd(ba,oa)};a.prototype.eed=function(ba){return this.ywa?this.indexedDB.C3a(ba):a.vZe(ba)};a.prototype.SGd=function(ba,oa,ra,db,Ka,Ga){var xa=this,da=String.format("CustomFunctionsInstaller.RegisterFunctionsAsync: Failed to register Custom Functions for solution: {0}.",
Telemetry.PrivacyRules.GetPrivacyCompliantId(ba,oa,null));return M.TaskExtensions.GAc(m(this.TGd(this.ij,ba,oa,ra,!1,db,Ga),function(){return Ka?xa.mXj(ba,ra):aa.Task.Ua(!0)},da))};a.prototype.TGd=function(ba,oa,ra,db,Ka,Ga,xa){var da=this;if(!Ga&&(Ga=wa.a.yc(this.WE,db.addinId))&&Ga===db.metadataContent)return aa.Task.Ua(!0);this.WE[db.addinId]=db.metadataContent;this.jV[oa]=db;xa||ba.EHb(oa);ba.mia();return B(this.w7i(oa,ra,db),function(){return da.zEd(db.addinId,Ka)},"Failed to register functions for customfunction addin")};
a.prototype.w7i=function(ba,oa,ra){var db=this,Ka=new T.a,Ga=this.Wob(ra);return this.wia(function(xa){ja.EwaSettings.ma(257)&&l(a.Hrb,ba);(xa=xa.Result)&&204===xa.ResponseStatusCode?Ka.setResult(!0):(delete db.WE[ra.addinId],delete db.jV[ba],z(db.CHd(ba),function(){z(db.JHd(ba),function(){db.g2f()},"Failed to show customfunctions installation error info")},String.format("CustomFunctionsInstaller: Failed to register Custom Functions for solution: {0}. Received status code {1}.",ba,xa?xa.ResponseStatusCode.toString():
"Unknown")),Ka.setResult(!1))},function(xa){xa=Q.a.Mf(xa.data);F.ULS.sendTraceTag(537163544,0,10,"CustomFunctionsInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution {0}. Errors: {1}.",Telemetry.PrivacyRules.GetPrivacyCompliantId(ba,oa,null),X.a.Ec(xa));ja.EwaSettings.ma(257)&&l(a.Grb,ba);delete db.WE[ra.addinId];delete db.jV[ba];Ka.setResult(!1)},Ga,Ka,!0)};a.prototype.m0b=function(ba,oa,ra){var db=this,Ka=new T.a,Ga=ca.a.Ta.Wd.m;oa.forEach(function(da){da=Object(U.a)(String,
da);ba.Kwe(da)});ba.mia();var xa=this.WXc(ra);return this.wia(function(da){ja.EwaSettings.ma(257)&&l(a.Hrb,Sys.Serialization.JavaScriptSerializer.serialize(oa));da=da.Result;var qa=!0,na=Sys.Serialization.JavaScriptSerializer.deserialize(da.ResponseBody.toString());na=Array.isArray(na.value)?na.value:null;for(var ia=new O.a,ta={Eea:0};ta.Eea<na.length;ta={Eea:ta.Eea},ta.Eea++)if(!na[ta.Eea]){qa=!1;var za=String.format("CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions. Received status code {0}.",
da.ResponseStatusCode);ia.add(B(db.CHd(oa[ta.Eea]),function(sa){return function(){delete db.WE[ra.registrationInfos[sa.Eea].addinId];delete db.jV[oa[sa.Eea]];return db.JHd(oa[sa.Eea])}}(ta),za))}f(aa.Task.WhenAllEnumerable(ia),function(){z(db.zEd("",!1),function(){F.ULS.sendTraceTag(537163542,0,50,"CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync takes {0} Millisecond.",ca.a.Ta.Wd.m-Ga);qa?Ka.setResult(qa):f(db.g2f(),function(){Ka.setResult(qa)},"Failed to show customfunctions installation error info")},
String.format("CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to Batch register Custom Functions"))},"CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to get registration information")},function(da){da=Q.a.Mf(da.data);F.ULS.sendTraceTag(537163541,0,10,"CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions. Errors: {0}.",X.a.Ec(da));ja.EwaSettings.ma(257)&&l(a.Grb,Sys.Serialization.JavaScriptSerializer.serialize(oa));
for(da=0;da<ra.registrationInfos.length;da++)delete db.WE[ra.registrationInfos[da].addinId],delete db.jV[oa[da]];Ka.setResult(!1)},xa,Ka,!0)};a.prototype.TWd=function(ba,oa,ra,db){var Ka=this;return B(this.xOj(ba,oa,ra,db),function(){return Ka.zEd(db.solutionId,!1)},"Failed to unregister functions for customfunction addin")};a.prototype.xOj=function(ba,oa,ra,db){var Ka=new T.a;ba.EHb(oa);(ba=wa.a.yc(this.jV,oa))&&delete this.WE[ba.addinId];delete this.jV[oa];db=this.hYc(db);return this.wia(function(){ja.EwaSettings.ma(257)&&
l(a.f4c,oa);Ka.setResult(!0)},function(Ga){Ga=Q.a.Mf(Ga.data);F.ULS.sendTraceTag(537163539,0,10,"CustomFunctionsInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution {0}. Errors: {1}.",Telemetry.PrivacyRules.GetPrivacyCompliantId(oa,ra,null),X.a.Ec(Ga));ja.EwaSettings.ma(257)&&l(a.e4c,oa);Ka.setResult(!1)},db,Ka,!1)};a.prototype.wia=function(ba,oa,ra,db,Ka){function Ga(){function ta(V,Ia,Ha){ja.EwaSettings.ma(257)&&l(Ka?a.d4c:a.g4c,za.RequestBody);return K.g(da.xa,
"ExecuteRichApiRequest",ra,ua.b(V,ba),ua.a(Ia,oa),Ha,null,0)}if(xa.gHa()||0<da.xa.N3||0<da.Fk.N3)return!1;qa&&xa.so(qa);na&&da.Zr(na);ia&&da.Bz(ia);var za=ra.request,sa=0;ja.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")?za.RequestFlags&1&&256!==(za.RequestFlags&256)||(sa=16):sa=za.RequestFlags&1?0:16;ja.EwaSettings.Zb()?xa.Ot(new H.a(507,0,ta,sa|64)):xa.Ot(new J.a(507,0,ta,sa));return!0}var xa=this.$.userOperationManager,da=this.$.oa,qa=null,na=null,ia=null;
Ga()||(qa=function(){Ga()},na=function(){Ga()},ia=function(){Ga()},xa.zr(qa),da.Sq(na),da.Ey(ia));return db.task};a.prototype.Wob=function(ba){var oa={HttpMethod:"POST",PathAndQuery:"RegisterCustomFunctions",RequestHeaders:null};oa.RequestBody=JSON.stringify(ba);oa.RequestFlags=1;ja.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(oa.RequestFlags|=256);ba=this.$.oa.xa.Na(1);ba.request=oa;return ba};a.prototype.WXc=function(ba){var oa={HttpMethod:"POST",PathAndQuery:"BatchRegisterCustomFunctions",
RequestHeaders:null};oa.RequestBody=JSON.stringify(ba);oa.RequestFlags=1;ja.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(oa.RequestFlags|=256);ba=this.$.oa.xa.Na(1);ba.request=oa;return ba};a.prototype.hYc=function(ba){var oa={HttpMethod:"POST",PathAndQuery:"UnregisterCustomFunctions",RequestHeaders:null};oa.RequestBody=JSON.stringify(ba);oa.RequestFlags=1;ja.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(oa.RequestFlags|=
256);ba=this.$.oa.xa.Na(1);ba.request=oa;return ba};a.prototype.zEd=function(ba,oa){var ra=this,db=N.GetServiceTaskFactory.create(this.$.da,153,this.$.la,1);return w(db,function(){db.result.VJd();return ba&&oa?ra.Dgj(ba):aa.Task.Ua(!0)},this.$.la,C.a.instance,"CustomFunctionsInstaller::ProcessPostRegistrationActionsAsync failed due to create IFunctionInfoManager failed")};a.prototype.g2f=function(){var ba=new ea.a(1949669462,0,this.$.Jc,0,null);return this.$.Ka.Kb(ba)};a.vZe=function(ba){try{return aa.Task.Ua(localStorage.getItem(ba))}catch(oa){return F.ULS.sendTraceTag(537163537,
0,50,"CustomFunctionsInstaller.GetLocalCacheItemSafe: Failed to get data from the localStorage. Reason: {0}",oa.message||"Unknown"),aa.Task.Ua(null)}};a.ZNd=function(ba,oa){try{return localStorage.setItem(ba,oa),aa.Task.Ua(!0)}catch(ra){return F.ULS.sendTraceTag(537163536,0,50,"CustomFunctionsInstaller.SetLocalCacheItemSafe: Failed to set data into the localStorage. Reason: {0}",ra.message||"Unknown"),aa.Task.Ua(!1)}};a.U9i=function(ba){try{return localStorage.removeItem(ba),aa.Task.Ua(!0)}catch(oa){return F.ULS.sendTraceTag(537163535,
0,50,"CustomFunctionsInstaller.RemoveLocalCacheItemSafeAsync: Failed to set data into the localStorage. Reason: {0}",oa.message||"Unknown"),aa.Task.Ua(!1)}};a.Ixh=function(ba){return va.a.equals(ba,"registry",!0)||va.a.equals(ba,"uploadfiledevcatalog",!0)||G.AFrameworkApplication.userNameUnknown||G.AFrameworkApplication.limitedEdit};a.uqd=function(ba){if(!ba)return!1;try{JSON.parse(ba)}catch(oa){return!1}return!0};Mf.Object.defineProperties(a.prototype,{jV:{configurable:!0,enumerable:!0,get:function(){return this.ij.jV}}});
a.gkd="CustomFunctionCache";a.hkd="CustomFunction";a.d4c=new c(2,"CustomFunctions [Registration] [Begin] SolutionId=");a.Hrb=new c(0,"CustomFunctions [Registration] [End] [Success] SolutionId=");a.Grb=new c(1,"CustomFunctions [Registration] [End] [Failure] SolutionId=");a.g4c=new c(2,"CustomFunctions [Unregistration] [Begin] SolutionId=");a.f4c=new c(0,"CustomFunctions [Unregistration] [End] [Success] SolutionId=");a.e4c=new c(1,"CustomFunctions [Unregistration] [End] [Failure] SolutionId=");Object(u.a)(a,
"CustomFunctionsInstaller",null,[851])},1397:function(u,E,b){function a(C){this.WE={};this.$=C;this.$kd().Wma()}function c(C,Q){this.aQc=C;this._message=Q}function d(){}function e(){}function k(C){switch(C){case 0:return"Medium";case 1:return"Unexpected";case 2:return"Verbose";default:return""}}function l(C,Q){if(b(1397).CustomFunctionsLegacyInstaller.rvb("CustomFunctionsRuntimeLogging")&&window.console)switch(Q=k(C.severity)+" "+C.message+Q,C.severity){case 2:window.console.log&&window.console.log(Q);
break;case 0:window.console.info&&window.console.info(Q);break;case 1:window.console.error&&window.console.error(Q)}}function n(){}function f(C){C=C.split("|");this.Ww=C[1];this.DQc=C[2];this.hTd=C[3]}b.r(E);u=b(0);var v=b(7),r=b(14),y=b(1144),m=b(162),w=b(85),B=b(564),A=b(177),z=b(62),x=b(51),D=b(37),I=b(121),F=b(592),G=b(1170);Mf.Object.defineProperties(f.prototype,{solutionId:{configurable:!0,enumerable:!0,get:function(){return this.Ww}},solutionVersion:{configurable:!0,enumerable:!0,get:function(){return this.DQc}},
needToRestoreManifest:{configurable:!0,enumerable:!0,get:function(){return this.hTd===OSF.StoreTypeEnum.Registry.toString()}}});Object(u.a)(f,"AddinStoreInfo",null,[]);Object(u.a)(n,"CustomFunctionRegistrationInfos",null,[]);Object(u.a)(e,"InstallationInfo",null,[]);Object(u.a)(d,"UninstallationInfo",null,[]);var T=b(159),O=b(34),U=b(31),J=b(1),H=b(15),K=b(294),N=b(1074),M=b(58);Mf.Object.defineProperties(c.prototype,{severity:{configurable:!0,enumerable:!0,get:function(){return this.aQc}},message:{configurable:!0,
enumerable:!0,get:function(){return this._message}}});Object(u.a)(c,"CustomFunctionLog",null,[]);b.d(E,"CustomFunctionsLegacyInstaller",function(){return a});a.prototype.d$e=function(C,Q,P,ka){var R=this,fa=new m.a;if(ka.invariantNamespace)for(Q=0;Q<ka.invariantNamespace.length;++Q){var ca=ka.invariantNamespace.charAt(Q);if("."!==ca&&"_"!==ca&&"a">ca&&"z"<ca&&"A">ca&&"Z"<ca&&"0">ca&&"9"<ca)return r.ULS.sendTraceTag(537163530,0,10,"CustomFunctionsLegacyInstaller.InstallAsync: InvariantNamespace validation failed. Character='{0}', Position={1}.",
ca,Q),fa.setResult(!1),fa.task}a.cacheManifest(P,ka.manifest);var ea=a.RFd(C);(null===ea||void 0===ea?0:ea.isDynamicMetadata)?this.RGd(C,ea,fa,!1,!1):OSF.OUtil.xhrGet(ka.metadataUrl,function(wa){ea=Object(v.a)(new e,{addinId:P,locale:ka.locale,addinInvariantNamespace:ka.invariantNamespace,addinNamespace:ka.namespace,addinTitle:ka.title,isXllCompatible:ka.isXllCompatible,metadataContent:JSON.stringify(JSON.parse(wa))});R.RGd(C,ea,fa,!1,G.a(R.$,ka))},function(wa){r.ULS.sendTraceTag(537163528,0,10,"CustomFunctionsLegacyInstaller.InstallAsync: Failed to download Custom Functions metadata for solution {0}. ErrorCode: {1}.",
C,wa);fa.setResult(!1)});return fa.task};a.prototype.f$e=function(C,Q,P,ka){Q=new m.a;if(!a.uqd(P))return r.ULS.sendTraceTag(537163527,0,10,"CustomFunctionsLegacyInstaller.InstallDynamicFunctionsAsync: Invalid metadata JSON."),Q.setResult(!1),Q.task;var R=a.RFd(C);if(!R)return r.ULS.sendTraceTag(537163526,0,10,"CustomFunctionsLegacyInstaller.InstallDynamicFunctionsAsync: Unexpected error, could not read existing solution cache info."),Q.setResult(!1),Q.task;R.metadataContent=JSON.stringify(JSON.parse(P));
R.isDynamicMetadata=!0;this.RGd(C,R,Q,!0,ka);return Q.task};a.prototype.qag=function(C){var Q=this,P=new m.a,ka=x.GetServiceTaskFactory.create(this.$.da,106,this.$.la,1);D.TaskExtensions.Aa(ka,function(){var R=ka.result;R.mia();var fa=Object(v.a)(new d,{solutionId:C});a.DHd(C);a.KHd(C);D.TaskExtensions.Aa(Q.TWd(R,C,fa),function(ca){T.b(ca)?P.setResult(ca.result):(ca.Xf?r.ULS.sendTraceTag(537163524,0,10,"CustomFunctionsLegacyInstaller.UninstallAsync: Failed to uninstall Custom Functions for solution: {0}.",
C):ca.zh&&r.ULS.sendTraceTag(537163523,0,10,"CustomFunctionsLegacyInstaller.UninstallAsync: Uninstall Custom Functions is canceled for solution: {0}.",C),P.setResult(!1))},Q.$.la,0)},this.$.la,3);return P.task};a.prototype.$kd=function(){var C=this,Q=new m.a,P=a.WFd();0<P.length&&r.ULS.sendTraceTag(537163522,0,50,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Custom Functions registration from cache attempted.");var ka=[];P.forEach(function(fa){fa=Object(w.a)(String,fa);if(fa=a.RFd(fa)){var ca=
O.a.yc(C.WE,fa.addinId);ca&&ca===fa.metadataContent||(C.WE[fa.addinId]=fa.metadataContent,ka.push(fa))}});if(!ka.length)return Q.setResult(!0),r.ULS.sendTraceTag(537163521,0,50,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: There is no custom function to register from cache"),Q.task;var R=x.GetServiceTaskFactory.create(this.$.da,106,this.$.la,1);D.TaskExtensions.Aa(R,function(){var fa=R.result,ca=Object(v.a)(new n,{registrationInfos:ka});D.TaskExtensions.Aa(C.m0b(fa,P,ca),function(ea){T.b(ea)?
Q.setResult(ea.result):(ea.Xf?r.ULS.sendTraceTag(537163491,0,10,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Failed to register Custom Functions."):ea.zh&&r.ULS.sendTraceTag(537163490,0,10,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Registering Custom Functions is canceled."),Q.setResult(!1))},C.$.la,0)},this.$.la,3);return Q.task};a.prototype.Cgj=function(C){C=new f(C);if(C.needToRestoreManifest){var Q=a.a5i(C.solutionId);OSF.OsfManifestManager.cacheManifestFromXml(C.solutionId,
C.solutionVersion,Q,this.$.ya.UICultureTag)}};a.prototype.RGd=function(C,Q,P,ka,R){var fa=this,ca=x.GetServiceTaskFactory.create(this.$.da,106,this.$.la,1);D.TaskExtensions.Aa(ca,function(){D.TaskExtensions.Aa(fa.TGd(ca.result,C,Q,!1,ka,R),function(ea){T.b(ea)?((ea=ea.result)&&a.nXj(C,Q),P.setResult(ea)):(ea.Xf?r.ULS.sendTraceTag(537163488,0,10,"CustomFunctionsLegacyInstaller.InstallAsync: Failed to register Custom Functions for solution: {0}.",C):ea.zh&&r.ULS.sendTraceTag(537163487,0,10,"CustomFunctionsLegacyInstaller.InstallAsync: Registering Custom Functions is canceled for solution: {0}.",
C),P.setResult(!1))},fa.$.la,0)},this.$.la,3)};a.prototype.TGd=function(C,Q,P,ka,R,fa){var ca=this;if(!R&&(R=O.a.yc(this.WE,P.addinId))&&R===P.metadataContent)return M.Task.Ua(!0);this.WE[P.addinId]=P.metadataContent;var ea=new m.a;fa||C.EHb(Q);C.mia();C=this.Wob(P);return this.wia(function(wa){J.EwaSettings.ma(257)&&l(a.Hrb,Q);var X=wa.Result;204===X.ResponseStatusCode?D.TaskExtensions.Aa(ca.yEd(ea,P.addinId,ka),function(ja){ja.Xf?Q?r.ULS.sendTraceTag(537163485,0,10,"CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution {0}.",
Q):r.ULS.sendTraceTag(537163484,0,10,"CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for addinId {0}.",P.addinId):ja.zh&&(Q?r.ULS.sendTraceTag(537163483,0,10,"CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Registering Custom Functions is canceled for solution {0}.",Q):r.ULS.sendTraceTag(537163482,0,10,"CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Registering Custom Functions is canceled for addinId {0}.",P.addinId));
ea.setResult(!1)},ca.$.la,4):(wa=function(){delete ca.WE[P.addinId];a.DHd(Q);a.KHd(Q);r.ULS.sendTraceTag(537163481,0,10,"CustomFunctionsLegacyInstaller: Failed to register Custom Functions for solution: {0}. Received status code {1}.",Q,X.ResponseStatusCode);ea.setResult(!1)},wa=Object(v.a)(new N.a,{iLa:OSF.InfoType.Error,title:P.addinTitle,description:String.format(H.a.instance.mb(153),H.a.instance.ga(1867)),buttonText:H.a.instance.ga(4),lha:wa,Gdc:!1,bia:wa,errorCode:OSF.ErrorStatusCodes.WAC_CustomFunctionsRegistrationError}),
y.a.GQd(wa))},function(wa){wa=I.a.Mf(wa.data);r.ULS.sendTraceTag(537163480,0,10,"CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution {0}. Errors: {1}.",Q,U.a.Ec(wa));J.EwaSettings.ma(257)&&l(a.Grb,Q);delete ca.WE[P.addinId];ea.setResult(!1)},C,ea,!0)};a.prototype.m0b=function(C,Q,P){var ka=this,R=new m.a;Q.forEach(function(ca){ca=Object(w.a)(String,ca);C.Kwe(ca)});C.mia();var fa=this.WXc(P);return this.wia(function(ca){J.EwaSettings.ma(257)&&
l(a.Hrb,Sys.Serialization.JavaScriptSerializer.serialize(Q));ca=ca.Result;var ea=!0,wa=Sys.Serialization.JavaScriptSerializer.deserialize(ca.ResponseBody.toString());wa=Array.isArray(wa.value)?wa.value:null;for(var X=0;X<wa.length;X++)wa[X]||(ea=!1,delete ka.WE[P.registrationInfos[X].addinId],a.DHd(Q[X]),a.KHd(Q[X]),r.ULS.sendTraceTag(537163478,0,10,"CustomFunctionsLegacyInstaller: Failed to register Custom Functions for solutionId: {0}. Received status code {1}.",Q[X],ca.ResponseStatusCode));D.TaskExtensions.Aa(ka.yEd(R,
"",!1),function(ja){ja.Xf?r.ULS.sendTraceTag(537163477,0,10,"CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Failed to Batch register Custom Functions"):ja.zh&&r.ULS.sendTraceTag(537163476,0,10,"CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Batch register Custom Functions is canceled");R.setResult(!1)},ka.$.la,4);R.setResult(ea)},function(ca){ca=I.a.Mf(ca.data);r.ULS.sendTraceTag(537163475,0,10,"CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions for solutionIds {0}. Errors: {1}.",
Sys.Serialization.JavaScriptSerializer.serialize(Q),U.a.Ec(ca));J.EwaSettings.ma(257)&&l(a.Grb,Sys.Serialization.JavaScriptSerializer.serialize(Q));ca=bk(P.registrationInfos);for(var ea=ca.next();!ea.done;ea=ca.next())delete ka.WE[ea.value.addinId];R.setResult(!1)},fa,R,!0)};a.prototype.TWd=function(C,Q,P){var ka=this,R=new m.a;C.EHb(Q);C=this.hYc(P);return this.wia(function(){J.EwaSettings.ma(257)&&l(a.f4c,Q);D.TaskExtensions.Aa(ka.yEd(R,P.solutionId,!1),function(fa){fa.Xf?Q&&r.ULS.sendTraceTag(537163473,
0,10,"CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution {0}.",Q):fa.zh&&Q&&r.ULS.sendTraceTag(537163472,0,10,"CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Unregistering Custom Functions is canceled for solution {0}.",Q);R.setResult(!1)},ka.$.la,4)},function(fa){fa=I.a.Mf(fa.data);r.ULS.sendTraceTag(537163471,0,10,"CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution {0}. Errors: {1}.",
Q,U.a.Ec(fa));J.EwaSettings.ma(257)&&l(a.e4c,Q);R.setResult(!1)},C,R,!1)};a.prototype.wia=function(C,Q,P,ka,R){function fa(){function va(aa,ba,oa){J.EwaSettings.ma(257)&&l(R?a.d4c:a.g4c,ua.RequestBody);return z.g(ea.xa,"ExecuteRichApiRequest",P,K.b(aa,C),K.a(ba,Q),oa,null,0)}if(ca.gHa()||0<ea.xa.N3||0<ea.Fk.N3)return!1;wa&&ca.so(wa);X&&ea.Zr(X);ja&&ea.Bz(ja);var ua=P.request,Xa=ua.RequestFlags&1?0:16;J.EwaSettings.Zb()?ca.Ot(new A.a(507,0,va,Xa|64)):ca.Ot(new B.a(507,0,va,Xa));return!0}var ca=this.$.userOperationManager,
ea=this.$.oa,wa=null,X=null,ja=null;fa()||(wa=function(){fa()},X=function(){fa()},ja=function(){fa()},ca.zr(wa),ea.Sq(X),ea.Ey(ja));return ka.task};a.prototype.Wob=function(C){var Q={HttpMethod:"POST",PathAndQuery:"RegisterCustomFunctions",RequestHeaders:null};Q.RequestBody=JSON.stringify(C);Q.RequestFlags=1;C=this.$.oa.xa.Na(1);C.request=Q;return C};a.prototype.WXc=function(C){var Q={HttpMethod:"POST",PathAndQuery:"BatchRegisterCustomFunctions",RequestHeaders:null};Q.RequestBody=JSON.stringify(C);
Q.RequestFlags=1;C=this.$.oa.xa.Na(1);C.request=Q;return C};a.prototype.hYc=function(C){var Q={HttpMethod:"POST",PathAndQuery:"UnregisterCustomFunctions",RequestHeaders:null};Q.RequestBody=JSON.stringify(C);Q.RequestFlags=1;C=this.$.oa.xa.Na(1);C.request=Q;return C};a.prototype.yEd=function(C,Q,P){var ka=this,R=x.GetServiceTaskFactory.create(this.$.da,153,this.$.la,1);D.TaskExtensions.Aa(R,function(){R.result.VJd();Q&&P&&ka.Cgj(Q);C.setResult(!0)},this.$.la,3);return R};a.prototype.g$e=function(){return M.Task.Ua(!0)};
a.WFd=function(){return(Array.isArray(Sys.Serialization.JavaScriptSerializer.deserialize(a.rvb(F.a.zYa)||"[]"))?Sys.Serialization.JavaScriptSerializer.deserialize(a.rvb(F.a.zYa)||"[]"):null)||[]};a.dgg=function(C){a.$Nd(F.a.zYa,Sys.Serialization.JavaScriptSerializer.serialize(C))};a.RFd=function(C){C=a.rvb(F.a.I3a(C))||"";return 0<C.length?Sys.Serialization.JavaScriptSerializer.deserialize(C,!0):null};a.nXj=function(C,Q){a.wKe(C);a.$Nd(F.a.I3a(C),Sys.Serialization.JavaScriptSerializer.serialize(Q))};
a.DHd=function(C){a.NNf(C);a.hOf(F.a.I3a(C))};a.a5i=function(C){return a.rvb(F.a.H3a(C))};a.oXj=function(C,Q){a.wKe(C);a.$Nd(F.a.H3a(C),Q)};a.KHd=function(C){a.NNf(C);a.hOf(F.a.H3a(C))};a.wKe=function(C){var Q=a.WFd();C=C.toLowerCase();Array.contains(Q,C)||(Q.push(C),a.dgg(Q))};a.NNf=function(C){var Q=a.WFd();C=C.toLowerCase();Array.contains(Q,C)&&(Q.splice(Array.indexOf(Q,C),1),a.dgg(Q))};a.cacheManifest=function(C,Q){C=new f(C);C.needToRestoreManifest&&a.oXj(C.solutionId,Q)};a.rvb=function(C){try{return localStorage.getItem(C)}catch(Q){return r.ULS.sendTraceTag(537163469,
0,50,"CustomFunctionsLegacyInstaller.GetLocalStorageItemSafe: Failed to get data from the localStorage. Reason: {0}",Q.message||"Unknown"),null}};a.$Nd=function(C,Q){try{localStorage.setItem(C,Q)}catch(P){r.ULS.sendTraceTag(537163468,0,50,"CustomFunctionsLegacyInstaller.SetLocalStorageItemSafe: Failed to set data into the localStorage. Reason: {0}",P.message||"Unknown")}};a.hOf=function(C){try{localStorage.removeItem(C)}catch(Q){r.ULS.sendTraceTag(537163467,0,50,"CustomFunctionsLegacyInstaller.SetLocalStorageItemSafe: Failed to set data into the localStorage. Reason: {0}",
Q.message||"Unknown")}};a.uqd=function(C){if(!C)return!1;try{JSON.parse(C)}catch(Q){return!1}return!0};a.d4c=new c(2,"CustomFunctions [Registration] [Begin] SolutionId=");a.Hrb=new c(0,"CustomFunctions [Registration] [End] [Success] SolutionId=");a.Grb=new c(1,"CustomFunctions [Registration] [End] [Failure] SolutionId=");a.g4c=new c(2,"CustomFunctions [Unregistration] [Begin] SolutionId=");a.f4c=new c(0,"CustomFunctions [Unregistration] [End] [Success] SolutionId=");a.e4c=new c(1,"CustomFunctions [Unregistration] [End] [Failure] SolutionId=");
Object(u.a)(a,"CustomFunctionsLegacyInstaller",null,[851])},1437:function(u,E,b){function a(G,T,O,U,J){this.$=G;this.se=T;this.ownerAddinInfo=O;this.Ed=void 0===J?null:J;this.nQa=(void 0===U?null:U)||I.Task.Ua(!0);return this}function c(G){var T=D.call(this)||this;T.OCa="AddInCommandsDialog";T.ye=T.OCa;T.Rb=5;T.dialogWidth=695;T.dialogHeight=438;T.p1g="100%";T.m1g="408px";T.n1g="15px";T.o1g="0";T.Hsg=G;return T}function d(G,T,O,U,J,H){var K=G.Na(9);K.sharedInfo=T;return r.g(G,"InsertAgaveTaskpane",
K,O,U,J,H,0)}function e(){}u=b(0);var k=b(214),l=b(14);Object(u.a)(e,"AddinCommandsHost",null,[]);var n=b(1518),f=b(1596),v=b(1072),r=b(62),y=b(564),m=b(388),w=b(177),B=b(37),A=b(1),z=b(294),x=b(150),D=x.a;Rk(c,D);c.prototype.$C=function(){D.prototype.$C.call(this);this.np.style.width=this.p1g;this.np.style.height=this.m1g;this.np.style.marginTop=this.n1g;this.np.style.padding=this.o1g};c.prototype.fO=function(){D.prototype.fO.call(this);this.Db.style.width=String.format("{0}px",this.dialogWidth);
this.Db.style.height=String.format("{0}px",this.dialogHeight)};c.prototype.dispose=function(){D.prototype.dispose.call(this);this.Hsg()};Mf.Object.defineProperties(c.prototype,{containerDiv:{configurable:!0,enumerable:!0,get:function(){return this.np}}});Object(u.a)(c,"AddInCommandsDialog",x.a,[]);var I=b(58),F=b(63);x=b(100);b.d(E,"a",function(){return a});Rk(a,e);a.prototype.h1g=function(){var G=this.nQa;this.nQa=I.Task.Ua(!0);return G};a.prototype.disposeHost=function(G){this.se.QPa(G)};a.prototype.setOwnerAddinEToken=
function(G){this.ownerAddinInfo.eToken=G};a.prototype.showTaskpane=function(G,T,O){var U=this;l.ULS.sendTraceTag(537170642,220,50,"ShowTaskpane action called.");var J=null,H=!1,K=(new n.a("m_excelWebRenderer_ewaCtl_",this.ownerAddinInfo.solutionId,new v.a,!0)).OEe(G.solutionId.substr(this.ownerAddinInfo.solutionId.length));J=T.getSharedRuntimeForTaskpane("Workbook",K);H=!!J&&1===J.LifeTime;this.se.Nwe(H?this.ownerAddinInfo.solutionId:G.solutionId,H?J:null,null)||(this.zlf(H,!0),this.nQa=this.Ykd(G,
J,function(N,M){N?(H&&(N.PrimaryMarketplace.SolutionId=U.ownerAddinInfo.solutionId,N.SharedRuntime=J),N.WebExtensionOsfControlType=3,U.se.n0a(N),O(N.InstanceId,M),U.zlf(H,!1),A.EwaSettings.isChangeGateEnabled("OfficeVSO:6085876_TelemetryForActiveAddinSuccessOnExcelWacEnabled")&&l.ULS.sendTraceTag(524818146,220,50,"ShowTaskpane: succeed to call.")):(l.ULS.sendTraceTag(17306640,220,10,"ShowTaskpane: instance id is null."),O(null,M))}))};a.prototype.getSettings=function(G,T){var O=this.se.saa(G.solutionId);
O?T(this.se.dZ(O).OsfPropertyBag):this.nQa=this.Ykd(G,null,function(U){U?T(U.OsfPropertyBag):l.ULS.sendTraceTag(537170641,220,10,"GetSettings: insertData is null.")})};a.prototype.showDialog=function(G,T,O){function U(M,C,Q){return d(K,N,z.b(M,J),C,Q,null)}function J(M){var C=M.Result,Q=C?C.AgaveData:null;Q?(H.se.HDe(Q,function(){var P=new c(function(){H.disposeHost(Q.InstanceId)});P.initializeAndShow("",null,null);return P.containerDiv}),O(Q.InstanceId,0)):(l.ULS.sendTraceTag(537170638,220,10,"ShowDialog: instance id is null."),
O(null,M.Errors?M.Errors[0].ErrorCause:5001))}var H=this;l.ULS.sendTraceTag(537170640,220,50,"ShowDialog action called.");var K=this.$.oa.xa,N=a.nrb(G,this.ownerAddinInfo);A.EwaSettings.Zb()?this.nQa=m.a(this.$.userOperationManager,U,function(M){return new w.a(500,0,M,64)},this.Ed):this.nQa=m.a(this.$.userOperationManager,U,function(M){return new y.a(500,0,M)},this.Ed)};a.prototype.createUILessSandbox=function(G,T,O){var U=this;l.ULS.sendTraceTag(537170637,220,50,"UILess action called.");var J=T.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"),
H=!!J&&1===J.LifeTime;(T=this.se.sAh(H?this.ownerAddinInfo.solutionId:G.solutionId,H?J:null))?O(T,0):this.nQa=this.Ykd(G,J,function(K,N){K?(H?(K.PrimaryMarketplace.SolutionId=U.ownerAddinInfo.solutionId,K.SharedRuntime=J,K.TaskpaneVisible=!1,K.WebExtensionOsfControlType=3,U.se.n0a(K)):(K.WebExtensionOsfControlType=4,U.se.HDe(K,function(){a.Beb.ia(K.InstanceId,new f.a);return a.Beb.na(K.InstanceId).Z0a})),O(K.InstanceId,N)):(l.ULS.sendTraceTag(537170636,220,10,"UILess: instance id is null."),O(null,
N))})};a.prototype.Ykd=function(G,T,O){function U(ka,R,fa){return d(N,M,z.b(ka,J),R,fa,null)}function J(ka){var R=ka.Result;(K=R?R.AgaveData:null)||O(null,ka.Errors?ka.Errors[0].ErrorCause:5001)}var H=this,K=null,N=this.$.oa.xa,M=a.nrb(G,this.ownerAddinInfo);T&&(l.ULS.sendTraceTag(537170634,220,50,"Shared runtime agave is inserted."),M.SharedRuntimeId=T.Resid);var C=500,Q=0;void 0===M.IsToBePersisted||null===M.IsToBePersisted||M.IsToBePersisted||(C=538,U=function(ka,R,fa){l.ULS.sendTraceTag(537170633,
220,50,"Web Method ShowAgaveTaskpane is called, StoreType {0}, StoreId {1}, SolutionId {2}.",Telemetry.PrivacyRules.GetPrivacyCompliantId(H.ownerAddinInfo.solutionId,H.ownerAddinInfo.storeType,H.ownerAddinInfo.assetId,null,null,H.ownerAddinInfo.storeId));ka=z.b(ka,J);var ca=N.Na(9,null);ca.sharedInfo=M;return r.g(N,"ShowAgaveTaskpane",ca,ka,R,fa,null,0)},Q=16);if(A.EwaSettings.Zb()){Q|=64;var P=m.a(this.$.userOperationManager,U,function(ka){return new w.a(C,0,ka,Q)},this.Ed)}else P=m.a(this.$.userOperationManager,
U,function(ka){return new y.a(C,0,ka,Q)},this.Ed);return B.TaskExtensions.ts(P,function(){return K?H.Jsd(N,K.InstanceId,function(ka,R){if(ka){T||(K.PrimaryMarketplace.MarketplaceType=G.storeType);K.OwnerAddinSolutionId=H.ownerAddinInfo.solutionId;K.OwnerAddinStoreType=H.ownerAddinInfo.storeType;K.OsfPropertyBag=[];for(R=0;R<ka.Settings.length;R++){var fa=[];fa[0]=ka.Settings[R].Name;fa[1]=ka.Settings[R].Value;K.OsfPropertyBag[R]=fa}O(K,0)}else O(null,R.Errors?R.Errors[0].ErrorCause:5001)}):I.Task.Ua(!1)},
k.a.none,3,F.a.current)};a.prototype.Jsd=function(G,T,O){function U(H,K,N){H=z.b(H,J);var M=G.Na(1);M.controlId=T;return r.g(G,"DdaLoadSettings",M,H,K,N,null,0)}function J(H){O(H.Result,H)}return A.EwaSettings.Zb()?m.a(this.$.userOperationManager,U,function(H){return new w.a(501,0,H,80)},this.Ed):m.a(this.$.userOperationManager,U,function(H){return new y.a(501,0,H,16)},this.Ed)};a.prototype.zlf=function(G,T){var O;G&&(null===(O=window.performance)||void 0===O?0:O.memory)&&l.ULS.sendTraceTag(537170630,
220,50,"Shared runtime memory usage: before={0}, jsHeapSizeLimit={1}, totalJSHeapSize={2}, usedJSHeapSize={3}",T,window.performance.memory.jsHeapSizeLimit,window.performance.memory.totalJSHeapSize,window.performance.memory.usedJSHeapSize)};a.showUILessDialog=function(G){a.Beb.kb(G)&&a.Beb.na(G).initializeAndShowWithTitle()};a.hideUILessDialog=function(G){a.Beb.kb(G)&&a.Beb.na(G).hide()};a.nrb=function(G,T){var O={};O.SolutionId=G.solutionId;O.Version=G.version;O.StoreType=T.storeType;O.StoreId=G.storeId;
O.AssetId=G.solutionId;O.AssetStoreId="omex";O.TargetType=1;O.Width=350;O.OwnerAddinSolutionId=T.solutionId;O.OwnerAddinStoreType=T.storeType;O.SharedRuntimeId=null;O.Preload=!1;return O};a.Beb=new x.a;Object(u.a)(a,"WACExcelAddinCommandsHost",e,[])},1443:function(u,E,b){function a(){e.a.Fa(function(z){c.ka(z)})}function c(z){return A.call(this,z)||this}function d(z,x,D){this.Krb=null;this.$=z;x?(l.ULS.sendTraceTag(537163346,0,50,"DataFromPictureCommandHandler.constructor - AugmentationLoopManager and UploaderCreator instantiated."),
this.Krb=new v.a(z,x,D)):l.ULS.sendTraceTag(537163347,0,10,"DataFromPictureCommandHandler.constructor - Failed to instantiate AugmentationLoopManager.")}var e=b(10);u=b(0);var k=b(905),l=b(14),n=b(104),f=b(4),v=b(1510),r=b(1),y=b(186),m=b(58);d.prototype.Lc=function(){return!1};d.prototype.executeCommand=function(z,x,D){z=!1;switch(x.command){case 73979048:this.Krb&&this.Krb.f_i(x,n.a.instance,f.AFrameworkApplication.fa,D),z=!0}return z?m.Task.Ua(!0):y.a(x.command)};d.prototype.zc=function(z,x){return 73979048===
x.command&&r.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataFromPictureOnXLO",!1)};d.prototype.Qc=function(){return!1};d.prototype.dispose=function(){this.Krb&&this.Krb.dispose()};Object(u.a)(d,"DataFromPictureCommandHandler",null,[429,3]);var w=b(37),B=b(51),A=k.a;Rk(c,A);c.prototype.Ad=function(){var z=this,x=B.GetServiceTaskFactory.Ra(this.$.da,328,327,1),D=B.GetServiceTaskFactory.Ra(this.$.da,484,485,1);w.TaskExtensions.Aa(w.TaskExtensions.Vd([x,D],this.$.la),function(){z.jd([new d(z.$,
x.result,D.result)])},this.$.la,3)};c.ka=function(z){k.a.Qd(452,new c(z))};Object(u.a)(c,"DataFromPictureCommandHandlerFactory",k.a,[]);b.d(E,"a",function(){return a})},1470:function(u,E,b){function a(){Type.registerNamespace("Common.App.AppsForOffice");window.Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper=c.a}var c=b(1163);b.d(E,"a",function(){return a})},1502:function(u,E,b){function a(){this.authority=this.userId=this.upn=null;this.authorityType=0;this.tenantId=null;this.supportsAuthToken=
this.isAnonymous=!1;this.authority=this.userId=this.upn="";this.authorityType=0;this.tenantId="";this.isAnonymous=!0;this.supportsAuthToken=!1}b.d(E,"a",function(){return a});u=b(0);a.YHh=function(c){switch(c){case 0:return"external";case 2:return"aad";case 1:return"msa";default:return"external"}};Object(u.a)(a,"WopiAuthContext",null,[127])},1503:function(u,E,b){function a(){}b.d(E,"a",function(){return a});u=b(0);a.CDf="OneDriveWOPI";Object(u.a)(a,"HostApplicationType",null,[])},1504:function(u,
E,b){function a(c,d,e,k){this._id=c;this.qwg=d;this.rge=e;this.tUa=k}b.d(E,"a",function(){return a});u=b(0);a.prototype.getId=function(){return this._id};a.prototype.getStoreId=function(){return this.qwg};a.prototype.getStoreType=function(){return this.rge};Object(u.a)(a,"ExtensionIdentity",null,[207])},1505:function(u,E,b){function a(c,d,e){this.q$d=e}b.d(E,"a",function(){return a});u=b(0);Object(u.a)(a,"HostProperties",null,[])},1506:function(u,E,b){function a(){this.optionalProperties={};this.kq=
{}}b.d(E,"a",function(){return a});u=b(0);Object(u.a)(a,"ExtensionLaunchProperties",null,[])},1507:function(u,E,b){function a(){this.La=n.AFrameworkApplication.ub}b.d(E,"a",function(){return a});u=b(0);var c=b(1504),d=b(1506),e=b(1168),k=b(1509),l=b(1505),n=b(4),f=b(635),v=b(25);a.prototype.XMa=function(r,y,m,w,B){this.zqi(r,y,m,w,B)};a.prototype.zqi=function(r,y,m,w,B){var A=b(1508).ExtensionComponentInstance,z={};z[e.a.P8b]=r;z[e.a.Xze]=y;z[e.a.aHa]=m;z[e.a.ijd]=w;z[e.a.Eya]=B;w=8;if(n.AFrameworkApplication.vpd(r.getId()))switch(y){case k.a.action:w=
this.La.$d(v.a.eQe,2,z);break;case k.a.taskpane:w=this.La.$d(v.a.o2f,2,z);break;case k.a.nkj:w=this.La.$d(v.a.Sqi,2,z);break;default:w=16}32===w?(w=f.a.create().toString(),B.optionalProperties.InstanceToken&&(w=B.optionalProperties.InstanceToken),r=new A(r,y,m,w),a.Av[w]=r):r=new A(r,y,m,null);r.Cnj(z)};a.prototype.yqi=function(r){var y=r.ExtId,m=r.ComponentType,w=r.ComponentId,B=r.HostProps;r=r.OptionalProps;y=new c.a(y.Id,y.StoreId,y.StoreType,y.AppVersion);B=new l.a(B.HostType,B.FormFactor,B.Locale);
var A=new d.a;A.optionalProperties=r.OptionalProperties;A.kq=r.DevProperties;a.instance.XMa(y,m,w,B,A)};a.prototype.getInstance=function(r){return a.Av[r]};a.prototype.Q9i=function(r){delete a.Av[r]};Mf.Object.defineProperties(a,{instance:{configurable:!0,enumerable:!0,get:function(){a.vHc||(a.vHc=new a);return a.vHc}}});a.vHc=null;a.Av={};Object(u.a)(a,"ExtensionLifeCycleManager",null,[206])},1508:function(u,E,b){function a(k,l,n,f){this.tUa=this.dG=null;this._id=k;this.Xlg=n;this.Wpg=f;this.La=
d.AFrameworkApplication.ub?d.AFrameworkApplication.ub:null}b.r(E);b.d(E,"ExtensionComponentInstance",function(){return a});u=b(0);var c=b(1507),d=b(4),e=b(25);a.prototype.vcd=function(){return this.Xlg};a.prototype.Cnj=function(k){this.dG=k};a.prototype.stop=function(){var k=this.La.$d(e.a.OYg,2,this.dG);c.a.instance.Q9i(this.Wpg);return 32===k};a.prototype.ntc=function(){this.La.$d(e.a.DSf,2,this.dG)};Mf.Object.defineProperties(a.prototype,{appVersion:{configurable:!0,enumerable:!0,get:function(){return this.tUa}}});
Object(u.a)(a,"ExtensionComponentInstance",null,[227])},1509:function(u,E,b){function a(){}b.d(E,"a",function(){return a});u=b(0);a.taskpane="Taskpane";a.action="Action";a.nkj="SDXDialog";Object(u.a)(a,"ComponentTypeNames",null,[])},1510:function(u,E,b){(function(a){function c(F,G,T){var O=I.call(this)||this;O.t8e=n.a.getTypeName();O.Ed=null;O.aU=null;O.xxb=null;O.imageWidth=0;O.imageHeight=0;O.tableData=null;O.errorMessage=null;O.fLa=null;O.pjd=0;O.DSc=!1;O.WEe=function(U){if(U){var J={};if(function(){var Q=
x.d(O.Gbh(U.data));J=Q.Lt;return Q}().returnValue){var H=Object(l.a)(Object,J);if("."===H.DataFromPictureWildcard)if(H.SessionId!==O.fLa)e.ULS.sendTraceTag(523805139,0,10,"DataFromPictureManager.DataFromPictureMessageReceivedEventHandler() - SessionID of received message does not match current Session ID.");else switch(e.ULS.sendTraceTag(523805138,0,50,"DataFromPictureManager.DataFromPictureMessageReceivedEventHandler - Message Received from SDX pane"),H.CmdType){case "ACK":O.DSc=!0;O.z7f.stop();
e.ULS.sendTraceTag(523805137,0,50,"DataFromPictureManager.DataFromPictureMessageReceivedEventHandler - SDX pane launched.");O.gmj();0<O.errorMessage.length?O.tWf():0<O.tableData.length&&O.KWf();break;case "insert_html":var K=O.$.oa.xa,N={},M=z.g(O.$).ha.sa.Vc.clone();N.PasteId=k.a.create().toString();N.DestinationRanges=r.s(r.v(M,O.$));M=H.Parameters.split("|",3);e.ULS.sendTraceTag(523805136,0,50,"DataFromPictureManager.dataFromPictureMessageReceivedEventHandler - LCC:{0}|{1}|{2}.",M[0],M[1],M[2]);
M=H.Parameters.indexOf("|");M=H.Parameters.indexOf("|",M+1);M=H.Parameters.indexOf("|",M+1);N.SourceHtml=H.Parameters.substring(M+1);N.CopyOperationId=null;var C=K.Na(1,K.Pb());C.pasteHtmlParameters=N;y.a(O.$.userOperationManager,function(Q,P,ka){return w.g(K,"pasteHtmlContent",C,Q,P,ka,null,64)},function(Q){return new m.a(204,0,Q,1)},null);O.pjd++;e.ULS.sendTraceTag(523805135,0,50,"DataFromPictureManager.dataFromPictureMessageReceivedEventHandler - Number of pastes to workbook per Session ID:{0}",
O.pjd.toString())}}}};O.D7h=function(U,J){if(U=J.jJ)if(!J.parentPath||1>=J.parentPath.length||J.parentPath[1]!==O.fLa)e.ULS.sendTraceTag(523805124,0,10,"DataFromPictureManager.ImageToTableAnnotationHandler() - SessionID of received annotation does not match current Session ID.");else{e.ULS.sendTraceTag(523805123,0,50,"DataFromPictureManager.ImageToTableAnnotationHandler() - Annotation Received.");J=U.errorCode;switch(J){case null:case -1:O.errorMessage=A.a.instance.ga(2238);break;case 1:O.errorMessage=
A.a.instance.ga(2239);break;case 2:O.errorMessage=A.a.instance.ga(2240)}0<O.errorMessage.length&&e.ULS.sendTraceTag(523805122,0,10,"DataFromPictureManager.ImageToTableAnnotationHandler() - ErrorCode:{0}.",J?J.toString():"null");O.Soe.stop();O.tableData=U.html;O.DSc&&(0<O.errorMessage.length?O.tWf():0<O.tableData.length&&O.KWf())}else e.ULS.sendTraceTag(523805125,0,10,"DataFromPictureManager.ImageToTableAnnotationHandler() - Received annotation is null.")};O.$=F;O.augmentationLoopManager=G;O.uploaderCreator=
T;O.initialize();return O}b.d(E,"a",function(){return c});var d=b(0),e=b(14),k=b(178),l=b(85),n=b(1515),f=b(38),v=b(257),r=b(45),y=b(388),m=b(177),w=b(62),B=b(91),A=b(15),z=b(21),x=b(41),D=b(1516),I=f.a;Rk(c,I);c.prototype.dispose=function(){window.removeEventListener("message",this.WEe,!1);I.prototype.dispose.call(this)};c.prototype.$Ri=function(F,G){var T=this;e.ULS.sendTraceTag(523805146,0,50,"DataFromPictureManager.onSuccessfulFileLoad - Start function.");var O=new Image;O.onload=function(){var U=
document.createElement("canvas");U.width=O.width;U.height=O.height;var J=U.getContext("2d");try{J.drawImage(O,0,0,O.width,O.height)}catch(N){e.ULS.sendTraceTag(523805145,0,10,"DataFromPictureManager.onSuccessfulFileLoad - Can't draw to canvas. ex.Message: {0}",N.message);return}try{var H=U.toDataURL("image/jpeg")}catch(N){e.ULS.sendTraceTag(523805144,0,10,"DataFromPictureManager.onSuccessfulFileLoad - Can't render to jpeg. ex.Message: {0}",N.message);return}U=H.split(",");if(2>U.length)e.ULS.sendTraceTag(523805143,
0,10,"DataFromPictureManager.onSuccessfulFileLoad - Can't render to jpeg.");else{U=U[1];try{var K=window.self.atob(U)}catch(N){e.ULS.sendTraceTag(523805142,0,10,"DataFromPictureManager.onSuccessfulFileLoad - Can't convert image to byte string. ex.Message: {0}",N.message);return}28E5<K.length?(e.ULS.sendTraceTag(523805141,0,15,"DataFromPictureManager.onSuccessfulFileLoad - Image exceeds max size limit."),G.Yyj()):(T.oij(T.Ed,T.aU,U,O.width,O.height),URL.revokeObjectURL(O.src),O=null,e.ULS.sendTraceTag(523805140,
0,50,"DataFromPictureManager.onSuccessfulFileLoad - End function."))}};O.src=F};c.prototype.f_i=function(F,G,T,O){this.Ed=F;this.aU=O;this.uploaderCreator.j$h(this.$,G,T,O,this)};c.prototype.oij=function(F,G,T,O,U){this.fLa=k.a.create().toString();this.pjd=0;this.xxb=T;this.imageWidth=O;this.imageHeight=U;this.errorMessage=this.tableData="";this.DSc=!1;this.z7f=this.$.Fb.Kg("LoadResource","DataFromPictureTaskpaneLaunch");this.z7f.start();this.DUi(F,G);this.Soe=this.$.Fb.Kg("LoadResource","DataFromPictureAnnotation");
this.Soe.start();this.BTj()};c.prototype.BTj=function(){if(this.xxb.length){var F=window.self.atob(this.xxb);for(var G=new Uint8Array(F.length),T=0;T<F.length;T++)G[T]=F.charCodeAt(T);this.augmentationLoopManager.ATj(G,this.fLa,this.imageWidth,this.imageHeight)}else e.ULS.sendTraceTag(523805134,0,10,"DataFromPictureManager.UploadImageToAugmentationLoop - imageDataBase64 is empty")};c.prototype.DUi=function(F,G){G.SessionID=this.fLa;G.DataFromPictureAssetId="FA000000050";G.LoadDataFromPictureTaskpane=
!0;F=new B.a(-859308420,F.method,F.mode,F.Le,F.tabName);this.$.Ka.Kb(F,G)};c.prototype.$6c=function(F){try{var G=a.from(F,"utf16le").toString("base64");return D.a.nHa(this.fLa,G)}catch(T){return e.ULS.sendTraceTag(523805133,0,10,"DataFromPictureManager.encodeAndEncrypt - Buffer can't encode message.",T.message),""}};c.prototype.Gbh=function(F){try{var G=D.a.nHa(this.fLa,F);return a.from(G,"base64").toString("utf16le")}catch(T){return e.ULS.sendTraceTag(523805132,0,50,"DataFromPictureManager.decryptAndDecode - Buffer can't decode message.",
T.message),""}};c.prototype.gmj=function(){if(this.xxb.length){var F=v.a(this.$).saa("FA000000050"),G={};G=(G.DataFromPictureWildcard=".",G);G.imageData=this.$6c(this.xxb);OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(F,"onCustomMessage",G,function(T){T&&e.ULS.sendTraceTag(523805130,0,10,"DataFromPictureManager.sendImageToTaskPane() - Attempted to send image to Pane - Failed .")})}else e.ULS.sendTraceTag(523805131,0,10,"DataFromPictureManager.sendImageToTaskPane() - Attempted to send image to Pane - Failed no image Data.")};
c.prototype.KWf=function(){if(this.tableData.length){var F=v.a(this.$).saa("FA000000050"),G={};G=(G.DataFromPictureWildcard=".",G);G.tableHtml=this.$6c(this.tableData);OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(F,"onCustomMessage",G,function(T){T&&e.ULS.sendTraceTag(523805128,0,10,"DataFromPictureManager.sendTableToTaskPane() - Attempted to send table data to Pane - Failed.")})}else e.ULS.sendTraceTag(523805129,0,10,"DataFromPictureManager.sendTableToTaskPane() - Attempted to send table data to Pane - Failed, No Table Data.")};
c.prototype.tWf=function(){if(this.errorMessage.length){var F=v.a(this.$).saa("FA000000050"),G={};G=(G.DataFromPictureWildcard=".",G);G.errorMessage=this.$6c(this.errorMessage);OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(F,"onCustomMessage",G,function(T){T&&e.ULS.sendTraceTag(523805126,0,10,"DataFromPictureManager.sendErrorMessageToTaskPane() - Attempted to send ErrorMessage to Pane - Failed .")})}else e.ULS.sendTraceTag(523805127,0,10,"DataFromPictureManager.sendErrorToTaskPane() - Attempted to send ErrorMessage to Pane - Failed, No valid error message.")};
c.prototype.initialize=function(){window.addEventListener("message",this.WEe,!1);this.augmentationLoopManager.activateAnnotation(this.t8e);this.augmentationLoopManager.dJ(this.t8e,this.D7h)};Object(d.a)(c,"DataFromPictureManager",f.a,[685])}).call(this,b(1511).Qgg)},1511:function(u,E,b){(function(a){function c(){try{var U=new Uint8Array(1);U.__proto__={__proto__:Uint8Array.prototype,xad:function(){return 42}};return 42===U.xad()&&"function"===typeof U.subarray&&0===U.subarray(1,1).byteLength}catch(J){return!1}}
function d(U,J){if((e.LO?2147483647:1073741823)<J)throw new RangeError("Invalid typed array length");e.LO?(U=new Uint8Array(J),U.__proto__=e.prototype):(null===U&&(U=new e(J)),U.length=J);return U}function e(U,J,H){if(!(e.LO||this instanceof e))return new e(U,J,H);if("number"===typeof U){if("string"===typeof J)throw Error("If encoding is specified then the first argument must be a string");return n(this,U)}return k(this,U,J,H)}function k(U,J,H,K){if("number"===typeof J)throw new TypeError('"value" argument must not be a number');
if("undefined"!==typeof ArrayBuffer&&J instanceof ArrayBuffer){J.byteLength;if(0>H||J.byteLength<H)throw new RangeError("'offset' is out of bounds");if(J.byteLength<H+(K||0))throw new RangeError("'length' is out of bounds");J=void 0===H&&void 0===K?new Uint8Array(J):void 0===K?new Uint8Array(J,H):new Uint8Array(J,H,K);e.LO?(U=J,U.__proto__=e.prototype):U=f(U,J);J=U}else if("string"===typeof J){K=U;U=H;if("string"!==typeof U||""===U)U="utf8";if(!e.Gbf(U))throw new TypeError('"encoding" must be a valid string encoding');
H=y(J,U)|0;K=d(K,H);J=K.write(J,U);J!==H&&(K=K.slice(0,J));J=K}else J=v(U,J);return J}function l(U){if("number"!==typeof U)throw new TypeError('"size" argument must be a number');if(0>U)throw new RangeError('"size" argument must not be negative');}function n(U,J){l(J);U=d(U,0>J?0:r(J)|0);if(!e.LO)for(var H=0;H<J;++H)U[H]=0;return U}function f(U,J){var H=0>J.length?0:r(J.length)|0;U=d(U,H);for(var K=0;K<H;K+=1)U[K]=J[K]&255;return U}function v(U,J){if(e.isBuffer(J)){var H=r(J.length)|0;U=d(U,H);if(0===
U.length)return U;J.copy(U,0,0,H);return U}if(J){if("undefined"!==typeof ArrayBuffer&&J.buffer instanceof ArrayBuffer||"length"in J)return(H="number"!==typeof J.length)||(H=J.length,H=H!==H),H?d(U,0):f(U,J);if("Buffer"===J.type&&G(J.data))return f(U,J.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.");}function r(U){if(U>=(e.LO?2147483647:1073741823))throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+(e.LO?2147483647:
1073741823).toString(16)+" bytes");return U|0}function y(U,J){if(e.isBuffer(U))return U.length;if("undefined"!==typeof ArrayBuffer&&"function"===typeof ArrayBuffer.isView&&(ArrayBuffer.isView(U)||U instanceof ArrayBuffer))return U.byteLength;"string"!==typeof U&&(U=""+U);var H=U.length;if(0===H)return 0;for(var K=!1;;)switch(J){case "ascii":case "latin1":case "binary":return H;case "utf8":case "utf-8":case void 0:return z(U).length;case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return 2*
H;case "hex":return H>>>1;case "base64":return D(U).length;default:if(K)return z(U).length;J=(""+J).toLowerCase();K=!0}}function m(U,J,H){var K=!1;if(void 0===J||0>J)J=0;if(J>this.length)return"";if(void 0===H||H>this.length)H=this.length;if(0>=H)return"";H>>>=0;J>>>=0;if(H<=J)return"";for(U||(U="utf8");;)switch(U){case "hex":U=J;J=H;H=this.length;if(!U||0>U)U=0;if(!J||0>J||J>H)J=H;K="";for(H=U;H<J;++H)U=K,K=this[H],K=16>K?"0"+K.toString(16):K.toString(16),K=U+K;return K;case "utf8":case "utf-8":return A(this,
J,H);case "ascii":U="";for(H=Math.min(this.length,H);J<H;++J)U+=String.fromCharCode(this[J]&127);return U;case "latin1":case "binary":U="";for(H=Math.min(this.length,H);J<H;++J)U+=String.fromCharCode(this[J]);return U;case "base64":return 0===J&&H===this.length?F.eUe(this):F.eUe(this.slice(J,H));case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":J=this.slice(J,H);H="";for(U=0;U<J.length;U+=2)H+=String.fromCharCode(J[U]+256*J[U+1]);return H;default:if(K)throw new TypeError("Unknown encoding: "+
U);U=(U+"").toLowerCase();K=!0}}function w(U,J,H,K,N){if(0===U.length)return-1;"string"===typeof H?(K=H,H=0):2147483647<H?H=2147483647:-2147483648>H&&(H=-2147483648);H=+H;isNaN(H)&&(H=N?0:U.length-1);0>H&&(H=U.length+H);if(H>=U.length){if(N)return-1;H=U.length-1}else if(0>H)if(N)H=0;else return-1;"string"===typeof J&&(J=e.from(J,K));if(e.isBuffer(J))return 0===J.length?-1:B(U,J,H,K,N);if("number"===typeof J)return J&=255,e.LO&&"function"===typeof Uint8Array.prototype.indexOf?N?Uint8Array.prototype.indexOf.call(U,
J,H):Uint8Array.prototype.lastIndexOf.call(U,J,H):B(U,[J],H,K,N);throw new TypeError("val must be string, number or Buffer");}function B(U,J,H,K,N){function M(ka,R){return 1===C?ka[R]:ka.m5i(R*C)}var C=1,Q=U.length,P=J.length;if(void 0!==K&&(K=String(K).toLowerCase(),"ucs2"===K||"ucs-2"===K||"utf16le"===K||"utf-16le"===K)){if(2>U.length||2>J.length)return-1;C=2;Q/=2;P/=2;H/=2}if(N)for(K=-1;H<Q;H++)if(M(U,H)===M(J,-1===K?0:H-K)){if(-1===K&&(K=H),H-K+1===P)return K*C}else-1!==K&&(H-=H-K),K=-1;else for(H+
P>Q&&(H=Q-P);0<=H;H--){Q=!0;for(K=0;K<P;K++)if(M(U,H+K)!==M(J,K)){Q=!1;break}if(Q)return H}return-1}function A(U,J,H){H=Math.min(U.length,H);for(var K=[];J<H;){var N=U[J],M=null,C=239<N?4:223<N?3:191<N?2:1;if(J+C<=H)switch(C){case 1:128>N&&(M=N);break;case 2:var Q=U[J+1];128===(Q&192)&&(N=(N&31)<<6|Q&63,127<N&&(M=N));break;case 3:Q=U[J+1];var P=U[J+2];128===(Q&192)&&128===(P&192)&&(N=(N&15)<<12|(Q&63)<<6|P&63,2047<N&&(55296>N||57343<N)&&(M=N));break;case 4:Q=U[J+1];P=U[J+2];var ka=U[J+3];128===(Q&
192)&&128===(P&192)&&128===(ka&192)&&(N=(N&15)<<18|(Q&63)<<12|(P&63)<<6|ka&63,65535<N&&1114112>N&&(M=N))}null===M?(M=65533,C=1):65535<M&&(M-=65536,K.push(M>>>10&1023|55296),M=56320|M&1023);K.push(M);J+=C}U=K.length;if(U<=T)K=String.fromCharCode.apply(String,K);else{H="";for(J=0;J<U;)H+=String.fromCharCode.apply(String,K.slice(J,J+=T));K=H}return K}function z(U,J){J=J||Infinity;for(var H,K=U.length,N=null,M=[],C=0;C<K;++C){H=U.charCodeAt(C);if(55295<H&&57344>H){if(!N){if(56319<H){-1<(J-=3)&&M.push(239,
191,189);continue}else if(C+1===K){-1<(J-=3)&&M.push(239,191,189);continue}N=H;continue}if(56320>H){-1<(J-=3)&&M.push(239,191,189);N=H;continue}H=(N-55296<<10|H-56320)+65536}else N&&-1<(J-=3)&&M.push(239,191,189);N=null;if(128>H){if(0>--J)break;M.push(H)}else if(2048>H){if(0>(J-=2))break;M.push(H>>6|192,H&63|128)}else if(65536>H){if(0>(J-=3))break;M.push(H>>12|224,H>>6&63|128,H&63|128)}else if(1114112>H){if(0>(J-=4))break;M.push(H>>18|240,H>>12&63|128,H>>6&63|128,H&63|128)}else throw Error("Invalid code point");
}return M}function x(U){for(var J=[],H=0;H<U.length;++H)J.push(U.charCodeAt(H)&255);return J}function D(U){var J=F,H=J.rJj;U=(U.trim?U.trim():U.replace(/^\s+|\s+$/g,"")).replace(O,"");if(2>U.length)U="";else for(;0!==U.length%4;)U+="=";return H.call(J,U)}function I(U,J,H,K){for(var N=0;N<K&&!(N+H>=J.length||N>=U.length);++N)J[N+H]=U[N];return N}var F=b(1512);b(1513);var G=b(1514);E.Qgg=e;E.HYj=function(U){+U!=U&&(U=0);return e.noe(+U)};E.dYj=50;e.LO=void 0!==a.LO?a.LO:c();E.e_j=e.LO?2147483647:1073741823;
e.from=function(U,J,H){return k(null,U,J,H)};e.LO&&(e.prototype.__proto__=Uint8Array.prototype,e.__proto__=Uint8Array,"undefined"!==typeof Symbol&&Symbol.species&&e[Symbol.species]===e&&Object.defineProperty(e,Symbol.species,{value:null,configurable:!0}));e.noe=function(U){l(U);return d(null,U)};e.sIg=function(U){return n(null,U)};e.isBuffer=function(U){return!(null==U||!U.lqg)};e.compare=function(U,J){if(!e.isBuffer(U)||!e.isBuffer(J))throw new TypeError("Arguments must be Buffers");if(U===J)return 0;
for(var H=U.length,K=J.length,N=0,M=Math.min(H,K);N<M;++N)if(U[N]!==J[N]){H=U[N];K=J[N];break}return H<K?-1:K<H?1:0};e.Gbf=function(U){switch(String(U).toLowerCase()){case "hex":case "utf8":case "utf-8":case "ascii":case "latin1":case "binary":case "base64":case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return!0;default:return!1}};e.concat=function(U,J){if(!G(U))throw new TypeError('"list" argument must be an Array of Buffers');if(0===U.length)return e.noe(0);var H;if(void 0===J)for(H=J=
0;H<U.length;++H)J+=U[H].length;J=e.sIg(J);var K=0;for(H=0;H<U.length;++H){var N=U[H];if(!e.isBuffer(N))throw new TypeError('"list" argument must be an Array of Buffers');N.copy(J,K);K+=N.length}return J};e.byteLength=y;e.prototype.lqg=!0;e.prototype.toString=function(){var U=this.length|0;return 0===U?"":0===arguments.length?A(this,0,U):m.apply(this,arguments)};e.prototype.equals=function(U){if(!e.isBuffer(U))throw new TypeError("Argument must be a Buffer");return this===U?!0:0===e.compare(this,
U)};e.prototype.compare=function(U,J,H,K,N){if(!e.isBuffer(U))throw new TypeError("Argument must be a Buffer");void 0===J&&(J=0);void 0===H&&(H=U?U.length:0);void 0===K&&(K=0);void 0===N&&(N=this.length);if(0>J||H>U.length||0>K||N>this.length)throw new RangeError("out of range index");if(K>=N&&J>=H)return 0;if(K>=N)return-1;if(J>=H)return 1;J>>>=0;H>>>=0;K>>>=0;N>>>=0;if(this===U)return 0;var M=N-K,C=H-J,Q=Math.min(M,C);K=this.slice(K,N);U=U.slice(J,H);for(J=0;J<Q;++J)if(K[J]!==U[J]){M=K[J];C=U[J];
break}return M<C?-1:C<M?1:0};e.prototype.includes=function(U,J,H){return-1!==this.indexOf(U,J,H)};e.prototype.indexOf=function(U,J,H){return w(this,U,J,H,!0)};e.prototype.lastIndexOf=function(U,J,H){return w(this,U,J,H,!1)};e.prototype.write=function(U,J,H,K){if(void 0===J)K="utf8",H=this.length,J=0;else if(void 0===H&&"string"===typeof J)K=J,H=this.length,J=0;else if(isFinite(J))J|=0,isFinite(H)?(H|=0,void 0===K&&(K="utf8")):(K=H,H=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");
var N=this.length-J;if(void 0===H||H>N)H=N;if(0<U.length&&(0>H||0>J)||J>this.length)throw new RangeError("Attempt to write outside buffer bounds");K||(K="utf8");for(N=!1;;)switch(K){case "hex":J=Number(J)||0;K=this.length-J;H?(H=Number(H),H>K&&(H=K)):H=K;K=U.length;if(0!==K%2)throw new TypeError("Invalid hex string");H>K/2&&(H=K/2);for(K=0;K<H;++K){N=parseInt(U.substr(2*K,2),16);if(isNaN(N))break;this[J+K]=N}return K;case "utf8":case "utf-8":return I(z(U,this.length-J),this,J,H);case "ascii":return I(x(U),
this,J,H);case "latin1":case "binary":return I(x(U),this,J,H);case "base64":return I(D(U),this,J,H);case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":K=U;N=this.length-J;for(var M=[],C=0;C<K.length&&!(0>(N-=2));++C){var Q=K.charCodeAt(C);U=Q>>8;Q%=256;M.push(Q);M.push(U)}return I(M,this,J,H);default:if(N)throw new TypeError("Unknown encoding: "+K);K=(""+K).toLowerCase();N=!0}};e.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this.MYj||this,0)}};var T=4096;e.prototype.slice=
function(U,J){var H=this.length;U=~~U;J=void 0===J?H:~~J;0>U?(U+=H,0>U&&(U=0)):U>H&&(U=H);0>J?(J+=H,0>J&&(J=0)):J>H&&(J=H);J<U&&(J=U);if(e.LO)J=this.subarray(U,J),J.__proto__=e.prototype;else{H=J-U;J=new e(H,void 0);for(var K=0;K<H;++K)J[K]=this[K+U]}return J};e.prototype.m5i=function(U){if(0!==U%1||0>U)throw new RangeError("offset is not uint");if(U+2>this.length)throw new RangeError("Trying to access beyond buffer length");return this[U]<<8|this[U+1]};e.prototype.copy=function(U,J,H,K){H||(H=0);
K||0===K||(K=this.length);J>=U.length&&(J=U.length);J||(J=0);0<K&&K<H&&(K=H);if(K===H||0===U.length||0===this.length)return 0;if(0>J)throw new RangeError("targetStart out of bounds");if(0>H||H>=this.length)throw new RangeError("sourceStart out of bounds");if(0>K)throw new RangeError("sourceEnd out of bounds");K>this.length&&(K=this.length);U.length-J<K-H&&(K=U.length-J+H);var N=K-H;if(this===U&&H<J&&J<K)for(K=N-1;0<=K;--K)U[K+J]=this[K+H];else if(1E3>N||!e.LO)for(K=0;K<N;++K)U[K+J]=this[K+H];else Uint8Array.prototype.set.call(U,
this.subarray(H,H+N),J);return N};e.prototype.fill=function(U,J,H,K){if("string"===typeof U){"string"===typeof J?(K=J,J=0,H=this.length):"string"===typeof H&&(K=H,H=this.length);if(1===U.length){var N=U.charCodeAt(0);256>N&&(U=N)}if(void 0!==K&&"string"!==typeof K)throw new TypeError("encoding must be a string");if("string"===typeof K&&!e.Gbf(K))throw new TypeError("Unknown encoding: "+K);}else"number"===typeof U&&(U&=255);if(0>J||this.length<J||this.length<H)throw new RangeError("Out of range index");
if(H<=J)return this;J>>>=0;H=void 0===H?this.length:H>>>0;U||(U=0);if("number"===typeof U)for(K=J;K<H;++K)this[K]=U;else for(U=e.isBuffer(U)?U:z((new e(U,K)).toString()),N=U.length,K=0;K<H-J;++K)this[K+J]=U[K%N];return this};var O=/[^+\/0-9A-Za-z-_]/g}).call(this,b(743))},1512:function(u,E){function b(e){var k=e.length;if(0<k%4)throw Error("Invalid string. Length must be a multiple of 4");e=e.indexOf("=");-1===e&&(e=k);return[e,e===k?0:4-e%4]}E.byteLength=function(e){e=b(e);var k=e[1];return 3*(e[0]+
k)/4-k};E.rJj=function(e){var k=b(e);var l=k[0];k=k[1];var n=new d(3*(l+k)/4-k),f=0,v=0<k?l-4:l,r;for(r=0;r<v;r+=4)l=c[e.charCodeAt(r)]<<18|c[e.charCodeAt(r+1)]<<12|c[e.charCodeAt(r+2)]<<6|c[e.charCodeAt(r+3)],n[f++]=l>>16&255,n[f++]=l>>8&255,n[f++]=l&255;2===k&&(l=c[e.charCodeAt(r)]<<2|c[e.charCodeAt(r+1)]>>4,n[f++]=l&255);1===k&&(l=c[e.charCodeAt(r)]<<10|c[e.charCodeAt(r+1)]<<4|c[e.charCodeAt(r+2)]>>2,n[f++]=l>>8&255,n[f++]=l&255);return n};E.eUe=function(e){for(var k=e.length,l=k%3,n=[],f=0,v=
k-l;f<v;f+=16383){for(var r=n,y=r.push,m,w=e,B=f+16383>v?v:f+16383,A=[],z=f;z<B;z+=3)m=(w[z]<<16&16711680)+(w[z+1]<<8&65280)+(w[z+2]&255),A.push(a[m>>18&63]+a[m>>12&63]+a[m>>6&63]+a[m&63]);m=A.join("");y.call(r,m)}1===l?(e=e[k-1],n.push(a[e>>2]+a[e<<4&63]+"==")):2===l&&(e=(e[k-2]<<8)+e[k-1],n.push(a[e>>10]+a[e>>4&63]+a[e<<2&63]+"="));return n.join("")};var a=[],c=[],d="undefined"!==typeof Uint8Array?Uint8Array:Array;for(u=0;64>u;++u)a[u]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[u],
c["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(u)]=u;c[45]=62;c[95]=63},1513:function(u,E){E.read=function(b,a,c,d,e){var k=8*e-d-1;var l=(1<<k)-1,n=l>>1,f=-7;e=c?e-1:0;var v=c?-1:1,r=b[a+e];e+=v;c=r&(1<<-f)-1;r>>=-f;for(f+=k;0<f;c=256*c+b[a+e],e+=v,f-=8);k=c&(1<<-f)-1;c>>=-f;for(f+=d;0<f;k=256*k+b[a+e],e+=v,f-=8);if(0===c)c=1-n;else{if(c===l)return k?NaN:Infinity*(r?-1:1);k+=Math.pow(2,d);c-=n}return(r?-1:1)*k*Math.pow(2,c-d)};E.write=function(b,a,c,d,e,k){var l,
n=8*k-e-1,f=(1<<n)-1,v=f>>1,r=23===e?Math.pow(2,-24)-Math.pow(2,-77):0;k=d?0:k-1;var y=d?1:-1,m=0>a||0===a&&0>1/a?1:0;a=Math.abs(a);isNaN(a)||Infinity===a?(a=isNaN(a)?1:0,d=f):(d=Math.floor(Math.log(a)/Math.LN2),1>a*(l=Math.pow(2,-d))&&(d--,l*=2),a=1<=d+v?a+r/l:a+r*Math.pow(2,1-v),2<=a*l&&(d++,l/=2),d+v>=f?(a=0,d=f):1<=d+v?(a=(a*l-1)*Math.pow(2,e),d+=v):(a=a*Math.pow(2,v-1)*Math.pow(2,e),d=0));for(;8<=e;b[c+k]=a&255,k+=y,a/=256,e-=8);d=d<<e|a;for(n+=e;0<n;b[c+k]=d&255,k+=y,d/=256,n-=8);b[c+k-y]|=
128*m}},1514:function(u){var E={}.toString;u.exports=Array.isArray||function(b){return"[object Array]"==E.call(b)}},1515:function(u,E,b){function a(){var e=d.call(this)||this;e.errorCode=null;e.errorDescription=null;e.html=null;e.H_=Object.assign(new c.a,{T_:a.getTypeName(),B_:a.Nd()});return e}b.d(E,"a",function(){return a});u=b(0);E=b(935);var c=b(909),d=E.a;Rk(a,d);a.getTypeName=function(){return"AugLoop_ImageToTable_DetectedHtmlTableAnnotation"};a.Nd=function(){return["AugLoop_Core_Annotation"]};
Object(u.a)(a,"DetectedHtmlTableAnnotation",E.a,[])},1516:function(u,E,b){function a(){}b.d(E,"a",function(){return a});u=b(0);a.nHa=function(c,d){if(!(c&&d&&c.length&&d.length)||256<c.length)return"";var e=Array(256),k=Array(256),l,n=0,f=0,v="";for(l=0;256>l;l++)e[l]=l;for(l=0;256>l;l++){var r=c.charCodeAt(l%c.length);if(256<=r)return"";n=(n+e[l]+r)%256;r=e[l];e[l]=e[n];e[n]=r}for(l=0;256>l;l++)k[l]=e[256-l-1];for(c=n=l=0;c<d.length;c++){l=(l+1)%256;n=(n+e[l])%256;r=e[l];e[l]=e[n];e[n]=r;r=d.charCodeAt(c);
if(256<=r)return"";var y=r^e[(e[l]+e[n])%256];f=(f+k[l])%256;r=k[l];k[l]=k[f];k[f]=r;v+=String.fromCharCode(y^e[(k[l]+k[f])%256])}return v};Object(u.a)(a,"RC4A",null,[])},1518:function(u,E,b){function a(d,e,k,l){this.Sjb=d;c.AFrameworkApplication.fa.qa("AddInCommandsMissingTabIsEnabled")&&k.kRh();this.pkg=this.Ww=e;this.xvg=l}b.d(E,"a",function(){return a});u=b(0);b(14);var c=b(4);a.prototype.HJa=function(d){d=this.XCb+this.solutionId+d;return this.fQd?(d in a.MZb||(a.MZb[d]="AddinControl"+a.eHg++),
a.MZb[d]):d};a.prototype.OEe=function(d){if(this.fQd){var e=a.MZb,k;for(k in e){var l=k;if(d===e[k])return l.substr(this.XCb.length+this.solutionId.length)}}return d};a.prototype.Q1e=function(d){d=this.XCb+this.solutionId+d;return this.fQd?(d in a.YUc||(a.YUc[d]="AddinTab"+a.oHg++),a.YUc[d]):d};Mf.Object.defineProperties(a.prototype,{XCb:{configurable:!0,enumerable:!0,get:function(){return this.Sjb}},solutionId:{configurable:!0,enumerable:!0,get:function(){return this.Ww}},assetId:{configurable:!0,
enumerable:!0,get:function(){return this.pkg}},fQd:{configurable:!0,enumerable:!0,get:function(){return this.xvg}}});a.MZb={};a.YUc={};a.oHg=0;a.eHg=0;Object(u.a)(a,"DefaultRibbonNamingProvider",null,[195])},1566:function(u,E,b){function a(m){var w=this;this.QA=null;this.r9f={};this.t9f={};this.M$c={};this.ixd={};this.uhd=function(B,A){B=w.$.Fb.sc("Task","DdaEventDispatch.HandleServerEvent");A=A.QWf;for(var z=0;z<A.length;z++)switch(A[z].EventType){case 2:var x=A[z],D={};D.Name=x.Name;D.BindingType=
x.BindingType;D.ColCount=x.ColCount;D.RowCount=x.RowCount;w.yva(x.InstanceId,OSF.DDA.EventDispId.dispidBindingDataChangedEvent,D,null);break;case 4:w.yva(A[z].InstanceId,OSF.DDA.EventDispId.dispidSettingsChangedEvent,null,null);break;case 8:if(x=A[z],x.InstanceId){D=Array(x.Entries.length);for(var I=0;I<x.Entries.length;I++)D[I]=a.Ibc(x.Entries[I],x.IsRemoteOverride);0<x.Entries.length&&1===x.Entries[0].Category?w.z0i(x.InstanceId,D):x.InstanceId&&w.yva(x.InstanceId,OSF.DDA.EventDispId.dispidRichApiMessageEvent,
null,D)}else{w.M$c={};w.ixd={};for(D=0;D<x.Entries.length;D++)w.tHe(x.Entries[D],x.IsRemoteOverride);c.ULS.sendTraceTag(537170593,0,50,"Number of Fired event: {0}, Number of Not Fired event: {1}, Total Number of Fired event: {2}, Total Number of Not Fired event: {3}",w.M$c,w.ixd,w.r9f,w.t9f)}}B.stop()};this.OJb=function(B,A){w.yva(B,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,A)};this.$=m;this.Uuc=this.uhd}b.r(E);u=b(0);var c=b(14),d=b(85),e;(function(m){m[m.none=0]="none";m[m.testEvent=1]=
"testEvent";m[m.test1Event=2]="test1Event";m[m.worksheetDataChangedEvent=10]="worksheetDataChangedEvent";m[m.worksheetActivatedEvent=11]="worksheetActivatedEvent";m[m.worksheetDeactivatedEvent=12]="worksheetDeactivatedEvent";m[m.worksheetAddedEvent=13]="worksheetAddedEvent";m[m.worksheetSelectionChangedEvent=14]="worksheetSelectionChangedEvent";m[m.worksheetDeletedEvent=15]="worksheetDeletedEvent";m[m.worksheetCalculatedEvent=16]="worksheetCalculatedEvent";m[m.worksheetFilteredEvent=17]="worksheetFilteredEvent";
m[m.worksheetFormatChangedEvent=18]="worksheetFormatChangedEvent";m[m.worksheetRowSortedEvent=19]="worksheetRowSortedEvent";m[m.worksheetColumnSortedEvent=20]="worksheetColumnSortedEvent";m[m.worksheetSingleClickedEvent=21]="worksheetSingleClickedEvent";m[m.worksheetRowHiddenChangedEvent=22]="worksheetRowHiddenChangedEvent";m[m.worksheetFormulaChangedEvent=23]="worksheetFormulaChangedEvent";m[m.worksheetProtectionChangedEvent=24]="worksheetProtectionChangedEvent";m[m.worksheetNameChangedEvent=25]=
"worksheetNameChangedEvent";m[m.worksheetVisibilityChangedEvent=26]="worksheetVisibilityChangedEvent";m[m.worksheetMovedEvent=27]="worksheetMovedEvent";m[m.worksheetNavigationObjectChangedEvent=28]="worksheetNavigationObjectChangedEvent";m[m.worksheetRowHeightChangedEvent=29]="worksheetRowHeightChangedEvent";m[m.workbookFormulaReferenceStyleChangedEvent=30]="workbookFormulaReferenceStyleChangedEvent";m[m.chartAddedEvent=50]="chartAddedEvent";m[m.chartActivatedEvent=51]="chartActivatedEvent";m[m.chartDeactivatedEvent=
52]="chartDeactivatedEvent";m[m.chartDeletedEvent=53]="chartDeletedEvent";m[m.tableSelectionChangedEvent=100]="tableSelectionChangedEvent";m[m.tableDataChangedEvent=101]="tableDataChangedEvent";m[m.tableAddedEvent=102]="tableAddedEvent";m[m.tableDeletedEvent=103]="tableDeletedEvent";m[m.tableFilteredEvent=104]="tableFilteredEvent";m[m.agaveVisualUpdateEvent=150]="agaveVisualUpdateEvent";m[m.customFunctionExecutionBeginEvent=200]="customFunctionExecutionBeginEvent";m[m.customFunctionExecutionEndEvent=
201]="customFunctionExecutionEndEvent";m[m.commentAddedEvent=250]="commentAddedEvent";m[m.commentDeletedEvent=251]="commentDeletedEvent";m[m.commentChangedEvent=252]="commentChangedEvent";m[m.invocationMessage=1E3]="invocationMessage";m[m.cancellationMessage=1001]="cancellationMessage";m[m.metadataMessage=1002]="metadataMessage";m[m.visualSelectionChangedEvent=2E3]="visualSelectionChangedEvent";m[m.visualChangeEvent=2001]="visualChangeEvent";m[m.visualTrackerModelChangedEvent=2002]="visualTrackerModelChangedEvent";
m[m.shapeSelectionChangedEvent=2100]="shapeSelectionChangedEvent";m[m.shapeActivatedEvent=2101]="shapeActivatedEvent";m[m.shapeDeactivatedEvent=2102]="shapeDeactivatedEvent";m[m.shapeAddedEvent=2103]="shapeAddedEvent";m[m.shapeDeletedEvent=2104]="shapeDeletedEvent";m[m.workbookAutoSaveSettingChangedEvent=2200]="workbookAutoSaveSettingChangedEvent";m[m.wacOperationEvent=2201]="wacOperationEvent";m[m.recordingStateChangedEvent=2202]="recordingStateChangedEvent";m[m.workbookActivatedEvent=2203]="workbookActivatedEvent";
m[m.workbookNavigationObjectChangedEvent=2204]="workbookNavigationObjectChangedEvent";m[m.ribbonCommandExecutedEvent=2300]="ribbonCommandExecutedEvent";m[m.linkedDataTypeRefreshRequestCompletedEvent=2500]="linkedDataTypeRefreshRequestCompletedEvent";m[m.linkedDataTypeRefreshModeChangedEvent=2501]="linkedDataTypeRefreshModeChangedEvent";m[m.linkedDataTypeLinkedDataTypeAddedEvent=2502]="linkedDataTypeLinkedDataTypeAddedEvent";m[m.linkedWorkbookWorkbookLinksChangedEvent=2600]="linkedWorkbookWorkbookLinksChangedEvent";
m[m.linkedWorkbookRefreshCompletedEvent=2601]="linkedWorkbookRefreshCompletedEvent";m[m.rangePickerSelectionChangedEvent=2700]="rangePickerSelectionChangedEvent";m[m.lineageActivityUpdateAvailableEvent=2800]="lineageActivityUpdateAvailableEvent";m[m.lineageActivityFilterUpdatedEvent=2801]="lineageActivityFilterUpdatedEvent";m[m.lineageActivityLoadCompletedEvent=2802]="lineageActivityLoadCompletedEvent";m[m.pivotTableAddedEvent=2900]="pivotTableAddedEvent";m[m.pivotTableDeletedEvent=2901]="pivotTableDeletedEvent";
m[m.namedItemAddedEvent=3E3]="namedItemAddedEvent";m[m.namedItemDeletedEvent=3001]="namedItemDeletedEvent";m[m.guidedReapplyManagerUpdateAvailableEvent=3100]="guidedReapplyManagerUpdateAvailableEvent";m[m.appRuntimeVisibilityChangedEvent=65539]="appRuntimeVisibilityChangedEvent";m[m.beforeCloseNotifiactionCancelledEvent=65540]="beforeCloseNotifiactionCancelledEvent"})(e||(e={}));Object(u.b)("MessageType",e);var k=b(976),l=b(257),n=b(947),f=b(54),v=b(37),r=b(159),y=b(1);b.d(E,"DdaEventDispatch",function(){return a});
a.prototype.oZb=function(m){m&&(this.mia(),this.QA.push(m))};a.prototype.lsc=function(m){this.QA&&(Array.remove(this.QA,m),this.QA.length||(this.$.wantServerEvents=!1,this.$.ecj(this.Uuc),this.QA=null))};a.prototype.z0i=function(m,w){var B=this,A=Object(d.a)(n.DdaFacade,l.a(this.$));v.TaskExtensions.Aa(A.GSh(m),function(z){if(r.b(z)){var x=z.result;z=A.Tm(x);if(x)if(z.tod)B.yva(x,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,w);else if(z.c4c)for(x=0;x<w.length;x++)z.c4c.push(w[x]);else z.c4c=
w}else z.Xf?c.ULS.sendTraceTag(537170591,0,10,"DdaEventDispatch.HandleServerEvent: Failed to get or create Custom Functions sandbox."):z.zh&&c.ULS.sendTraceTag(537170590,0,10,"DdaEventDispatch.HandleServerEvent: Getting or creating Custom Functions sandbox is cancelled.")},this.$.la,0)};a.prototype.V0i=function(m,w){var B=Object(d.a)(n.DdaFacade,l.a(this.$)),A=B.SGh(m);A?OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(A,w,this.OJb):B.D3g(m,w)};a.prototype.tHe=function(m,w){var B=
!1,A=parseInt(m.Type,10),z=m.Target,x=Object(d.a)(n.DdaFacade,l.a(this.$));if((z=x.Ri.MSh(A,z))&&0<Object.keys(z).length){B=!0;for(var D in z)if(z=D,x.Ri.B_b(z)){var I=Array(1);I[0]=a.Ibc(m,w);if(y.EwaSettings.isChangeGateEnabled("OfficeVSO:5379862_RichApiEventsTriggerSource")){var F=I[0][3];if(void 0!==F&&null!==F&&(F=Object(d.a)(Object,f.a.Th(F)))&&void 0!==F.triggerControlId&&null!==F.triggerControlId&&void 0!==F.triggerSource&&null!==F.triggerSource){var G=!1;w?(F.triggerSource="Unknown",G=!0):
x.rgh(F.triggerControlId,z)&&(F.triggerSource="ThisLocalAddin",G=!0);G&&(I[0][3]=f.a.xc(F))}}this.yva(z,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,I)}}B?(this.lec(e[A],this.M$c),this.lec(e[A],this.r9f)):(this.lec(e[A],this.ixd),this.lec(e[A],this.t9f))};a.prototype.mia=function(){this.QA||(this.QA=[],this.$.lne(this.Uuc),this.$.wantServerEvents=!0)};a.prototype.lec=function(m,w){m in w||(w[m]=0);w[m]+=1};a.prototype.rM=function(m,w,B){var A={};A.Target=w;A.Category=65536;A.Type=m;A.Message=
B;A.Id=-1;this.tHe(A,!1)};a.prototype.HAh=function(m,w){var B={Target:"",Category:2,Type:1E3};B.Message=w;B.Id=0;w=Array(1);w[0]=a.Ibc(B,!1);this.V0i(m,w)};a.prototype.E9b=function(m,w,B,A){var z={};z.Target=B;z.Category=65536;z.Type=w;z.Message=A;z.Id=-1;w=Array(1);w[0]=a.Ibc(z,!1);this.yva(m,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,w)};a.prototype.GAh=function(m,w){this.yva(m,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,w)};a.prototype.yva=function(m,w,B,A){if(this.QA){var z=Object(d.a)(n.DdaFacade,
l.a(this.$));if(!z||w!==OSF.DDA.EventDispId.dispidBindingDataChangedEvent&&w!==OSF.DDA.EventDispId.dispidSettingsChangedEvent||z.Ri.B_b(m))for(m=new k.a(w,m,B,A),w=0,B=this.QA.length;w<B;w++)(A=this.QA[w])&&A(m)}};a.Ibc=function(m,w){var B=Array(6);B[0]=m.Category;B[1]=m.Type;B[2]=m.Target;B[3]=m.Message;B[4]=m.Id;B[5]=w;return B};Object(u.a)(a,"DdaEventDispatch",null,[])},1595:function(u,E,b){function a(){}b.d(E,"a",function(){return a});u=b(0);a.taskPaneWidth="TaskPaneWidth";a.sourceLocationOverrideResourceId=
"SourceLocationOverrideResourceId";a.Qk="TaskPaneTitle";a.Jk="IconCssClass";a.eUd="TaskPaneIconUrl";a.eS="TaskPaneIconId";a.PH="NonPersistedSettings";a.onTaskPaneClose="OnTaskPaneClose";a.ESc="ActionArgs";Object(u.a)(a,"PropertyNames",null,[])},1596:function(u,E,b){function a(){var e=d.call(this,void 0,void 0,void 0,!0)||this;e.OCa="AddinCommandsUILessDialog";e.CRc="WACDialogTitleText";e.NUa="0";e.RCa=380;e.Bhb=190;e.ye=e.OCa;e.Rb=5;e.dmg=String.format("{0}px",e.RCa);e.MUa=String.format("{0}px",e.Bhb);
e.Pu=!1;e.u5e=!1;e.$C();return e}b.d(E,"a",function(){return a});u=b(0);E=b(150);var c=b(88),d=E.a;Rk(a,d);a.prototype.$C=function(){d.prototype.$C.call(this);this.np.style.width=this.dmg;this.np.style.height=this.MUa;this.np.style.padding=this.NUa};a.prototype.hv=function(e){this.fO();document.getElementById(this.$h(this.CRc)).innerText=e};a.prototype.fO=function(){d.prototype.fO.call(this);this.Db.style.width=String.format("{0}px",this.RCa);this.Db.style.height=String.format("{0}px",this.Bhb);this.Db.removeAttribute(c.a.Hd);
this.Db.removeAttribute(c.a.XD)};a.prototype.hide=function(){this.hxb()};a.prototype.initializeAndShowWithTitle=function(){this.initializeAndShow(CommonUIStrings.l_NotificationUITitle,null,null)};Mf.Object.defineProperties(a.prototype,{Z0a:{configurable:!0,enumerable:!0,get:function(){return this.np}}});Object(u.a)(a,"AddinCommandsUILessDialog",E.a,[196])},1626:function(u,E,b){function a(S){return Df.call(this,S)||this}function c(S,Ma,Gb){this.rangePicker=null;this.$=S;this.se=Ma;this.re=new K(S.ea);
this.Sz=new F(S,this.re);this.Bqf=Gb;this.Y8b=new Map}function d(S,Ma,Gb,hc,Yc){this.fSc=null;this.uQb=S;this.hA=Ma;this.GI=Gb;this.jb=hc;this.jyg=Yc}function e(){}function k(){this.cra=null}function l(S){if(!S)throw OfficeExtension.WacRuntime.Utility.createRichApiException("InvalidArgument","wacApiDelegates parameter is null");this.Fud=S}function n(S,Ma,Gb){return function(hc){return function(Yc,ed){$f.TaskExtensions.Aa(Lg.GetServiceTaskFactory.create(Ma.da,279,Ma.la,1),function(xd){xd=xd.result;
var Ed=!1,Xd=Gb.Qh.getOsfControl(S),Ud=null;Xd&&(Ud=Xd.getStoreType(),(Xd=Xd.getManifest())&&Xd.getSharedRuntimeForCustomFunctions("Workbook")&&(Ed=!0));$f.TaskExtensions.Aa(xd.f$e(S,Ud,hc,Ed),function(ne){fc.b(ne)?ne.result?Yc(null):ed(OfficeExtension.WacRuntime.Utility.createRichApiException(cg.a.invalidArgument,gg.a.instance.ga(1744))):ed(OfficeExtension.WacRuntime.Utility.createRichApiException(cg.a.generalException,gg.a.instance.ga(1740)))},Ma.la,3)},Ma.la,3)}}}function f(S,Ma){this.OO=fh.a.instance.Tb("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");
this.hA=S;this.GI=Ma;this.Tsg=this.GI.Qh.getOsfControl(this.hA)}function v(S,Ma,Gb,hc){this.K1d="";this.nSb=0;this.OO=S;this._id=Ma;this.hA=Gb;this.GI=hc}function r(S,Ma,Gb){this.$pg=S;this.aqg=Ma;this.dug=Gb}function y(){this.sge=this.Gae=this.bA=!1}function m(S,Ma,Gb,hc){this.Ww=S;this.n1=Gb;this.zy=hc.Qh.getOsfControl(Ma)}function w(S,Ma){this.GI=Ma;this.hA=S}function B(S){this.hA=S}function A(S){this.mIa={};this.Jyi=S}function z(S,Ma){var Gb=this;Gb.Uff=function(hc,Yc){hc=z.r2g(hc,Yc);if(!Y.a(Gb.$,
hc))return!0;hc=Gb.$.shortcutKeyManager.r1e(hc);return!!hc&&0<hc.length};Gb.addinId=S;Gb.$=Ma;return Gb}function x(){}function D(){}function I(S,Ma,Gb,hc){this.Byh=S;this.fileSize=Ma;this.IBj=hc}function F(S,Ma){var Gb=this;this.WH=function(hc,Yc){Gb.fQ.vJa(Qf.a.internalError,Yc)};this.$=S;this.fQ=Ma}function G(S,Ma,Gb,hc){Gb=Gi.call(this,576,0,Gb,hc)||this;Gb.ZKd=new O("576",S,Ma);return Gb}function T(S,Ma,Gb,hc,Yc,ed,xd,Ed){Ma=Fi.call(this,10,0,Ma,Ed)||this;Ma.Clb=Gb;Ma.Whb=hc;Ma.n3=Yc;Ma.YEa=ed;
Ma.request=xd;Ma.ZKd=new O("10",S,xd);return Ma}function O(S,Ma,Gb){this.parentName=S;this.$=Ma;this.request=Gb}function U(S,Ma){this.source=S;this.eventId=Ma}function J(S,Ma,Gb,hc,Yc,ed){var xd=S.Na(1);xd.request=Ma;return Yg.g(S,"ExecuteRichApiRequest",xd,Gb,hc,Yc,ed,0)}function H(S,Ma,Gb){this.$=S;this.fQ=Ma;this.Sz=Gb}function K(S){this.ea=S}function N(S,Ma,Gb,hc){S=si.call(this,S,"Select Data")||this;S.Dob=null;S.fFe=Ma;S.F4c=Gb;S.callback=hc;return S}function M(S){this.jb=S}function C(S){S.add("InternalTest",
"PreviewExecutionMethod",Q)}function Q(S,Ma){console.log("InternalTestPreviewExecution.PreviewExecutionMethod: typeof(objectId)="+typeof S+", objectId="+S+", value="+Ma);return null}function P(S,Ma){this.Vrg=S;this.qsg=Ma}function ka(S){var Ma=S.addType("Microsoft.Office.ActionService","{b9b4137f-8502-4b7a-9f64-d9b7c69bf883}","{df562add-0bb3-47cb-9780-0bd6c054e5e8}",3,0);var Gb=Ma.addMethod("AreShortcutsInUse",3,"Object[]",1,0,"AreShortcutsInUse",0);Gb.addParameter("shortcuts","String[]",1,null,0);
Ma.addMethod("GetShortcuts",1,"Object",1,1,"Shortcuts",0);Gb=Ma.addMethod("ReplaceShortcuts",2,"Void",0,0,"ReplaceShortcuts",0);Gb.addParameter("shortcuts","Object",1,null,0);Ma=S.addType("Microsoft.Office.SharedFilePicker","{209dd80f-a169-43dd-be1e-504a1a11a736}","{3f72536f-72cd-42d9-b4fd-eb8f8561e1f5}",3,0);Gb=Ma.addMethod("GetSharedFilePickerResponse",1,"Object",1,1,"SharedFilePickerResponse",0);Gb.addParameter("pickerCustomizationJsonString","String",1,null,0);Ma=S.addType("Microsoft.ExcelServices.WacWorkbook",
"{79eea901-609d-4204-a8f6-9f40f367a679}","",3,0);Gb=Ma.addMethod("CreateAndOpenWorkbook",1,"Void",0,1,"CreateAndOpenWorkbook",0);Gb.addParameter("base64File","String",1,null,0);Ma=S.addType("Microsoft.ExcelServices.AppRuntimeService","{21351f4a-8ee5-42e7-9776-62f23a567703}","",3,0);Ma.addMethod("GetAppRuntimeState",2,"Microsoft.AppRuntime.AppRuntimeState",1,1,"AppRuntimeState",0);Gb=Ma.addMethod("SetAppRuntimeState",1,"Void",0,1,"SetAppRuntimeState",0);Gb.addParameter("appRuntimeState","Microsoft.AppRuntime.AppRuntimeState",
1,null,0);Ma=S.addType("Microsoft.ExcelServices.CustomFunctionManager","{158db0d2-762c-449f-9917-b7c4778971ef}","{1a8cbe28-44d1-4b9a-9cd2-69311e909c1a}",3,0);Ma.addProperty("Status",2,"Microsoft.ExcelServices.CustomFunctionEngineStatus",2,!0,null,0);Gb=Ma.addMethod("Register",1,"Void",0,0,"Register",0);Gb.addParameter("metadata","String",1,null,0);Gb.addParameter("javascript","String",1,null,0);Ma=S.addType("Microsoft.ExcelServices.CustomFunctionEngineStatus","{22864d76-d53e-416b-b496-23e5bb38ebd0}",
"",2,0);Ma.addProperty("Enabled",1,"Boolean",1,!1,null,0);Ma.addProperty("NativeRuntime",3,"Boolean",1,!1,null,0);Ma.addProperty("StreamingEnabled",2,"Boolean",1,!1,null,0);Ma=S.addEnumType("Microsoft.Authentication.IdentityType");Ma.addEnumField("OrganizationAccount",0);Ma.addEnumField("MicrosoftAccount",1);Ma=S.addEnumType("Microsoft.Authentication.AuthorityType");Ma.addEnumField("External",0);Ma.addEnumField("Msa",1);Ma.addEnumField("Aad",2);Ma=S.addType("Microsoft.Authentication.OfficeIdentityInfo",
"{4c070280-74b4-4850-adfd-178c6c287817}","{8b83e3cb-6183-4206-bbcf-cc019d857327}",2,0);Ma.addProperty("DisplayName",4,"String",1,!1,null,0);Ma.addProperty("Email",3,"String",1,!1,null,0);Ma.addProperty("FederationProvider",2,"String",1,!1,null,0);Ma.addProperty("IdentityType",1,"Microsoft.Authentication.IdentityType",1,!1,null,0);Ma=S.addType("Microsoft.Authentication.AuthContext","{fd7bb67b-838a-4e86-84df-43023e360260}","{14d05e71-cb07-4eb7-bb51-93bc432750f9}",2,0);Ma.addProperty("AppId",4,"String",
1,!1,null,0);Ma.addProperty("Authority",2,"String",1,!1,null,0);Ma.addProperty("AuthorityType",3,"Microsoft.Authentication.AuthorityType",1,!1,null,0);Ma.addProperty("IsAnonymous",5,"Boolean",1,!1,null,0);Ma.addProperty("TenantId",6,"String",1,!1,null,0);Ma.addProperty("Upn",1,"String",1,!1,null,0);Ma=S.addType("Microsoft.Authentication.AuthenticationService","{3084014c-8862-4ad3-adf6-fb105947dd9a}","{799af6f3-8bf5-4859-8aca-7dd712862fca}",3,0);Ma.addProperty("RoamingSettings",99,"Microsoft.Authentication.RoamingSettingCollection",
3,!0,null,0);Gb=Ma.addMethod("GetAccessToken",1,"Microsoft.Authentication.SingleSignOnToken",2,1,"AccessToken",4);Gb.addParameter("tokenParameters","Microsoft.Authentication.TokenParameters",2,null,0);Ma.addMethod("GetAuthContext",3,"Microsoft.Authentication.AuthContext",2,1,"AuthContext",0);Ma.addMethod("GetPrimaryIdentityInfo",2,"Microsoft.Authentication.OfficeIdentityInfo",2,1,"PrimaryIdentityInfo",4);Ma=S.addType("Microsoft.Authentication.TokenParameters","{d9b0bca1-16af-48a6-b707-3b2bc97b082e}",
"{6e979115-496c-4ded-8ffb-b21d9ae45a6c}",2,0);Ma.addProperty("AuthChallenge",3,"String",1,!1,null,0);Ma.addProperty("CorrelationId",7,"String",1,!1,null,0);Ma.addProperty("Policy",4,"String",1,!1,null,0);Ma.addProperty("Resource",2,"String",1,!1,null,0);Ma.addProperty("Scope",5,"String",1,!1,null,0);Ma.addProperty("SilentLogin",6,"Boolean",1,!1,null,0);Ma=S.addType("Microsoft.Authentication.SingleSignOnToken","{dd692cad-089f-4adf-b070-bb12a957fef1}","{21e799a6-33ec-4ec7-8e74-fe7c4765a59f}",2,0);Ma.addProperty("AccessToken",
2,"String",1,!1,null,0);Ma.addProperty("TokenIdenityType",3,"Microsoft.Authentication.IdentityType",1,!1,null,0);Ma=S.addType("Microsoft.Authentication.RoamingSetting","{4f7e9fad-cbd7-4d76-8dab-9a2f7dc00141}","",3,0);Ma.addProperty("Id",1,"String",1,!0,null,0);Ma.addProperty("Value",2,"Object",1,!1,null,0);Ma=S.addType("Microsoft.Authentication.RoamingSettingCollection","{f9e004e4-a087-42ec-b22d-51ac584551a9}","",3,0);Gb=Ma.addMethod("GetItem",1,"Microsoft.Authentication.RoamingSetting",3,1,"Item",
0);Gb.addParameter("id","String",1,null,0);Gb=Ma.addMethod("GetItemOrNullObject",2,"Microsoft.Authentication.RoamingSetting",3,1,"ItemOrNullObject",0);Gb.addParameter("id","String",1,null,0);Ma=S.addType("Microsoft.AppRuntime.AppRuntimeService","{a9f1fc0a-741e-4882-87e1-025d6f8024e7}","{43a4559c-806b-4e89-914e-da9256212148}",3,0);Ma.addMethod("GetAppRuntimeState",2,"Microsoft.AppRuntime.AppRuntimeState",1,1,"AppRuntimeState",0);Gb=Ma.addMethod("SetAppRuntimeState",1,"Void",0,0,"SetAppRuntimeState",
0);Gb.addParameter("appRuntimeState","Microsoft.AppRuntime.AppRuntimeState",1,null,0);Ma=S.addEnumType("Microsoft.AppRuntime.AppRuntimeState");Ma.addEnumField("Inactive",0);Ma.addEnumField("Background",1);Ma.addEnumField("Visible",2);Ma=S.addEnumType("Microsoft.AppRuntime.Visibility");Ma.addEnumField("Hidden",1);Ma.addEnumField("Visible",2);Ma=S.addType("Microsoft.DynamicRibbon.DynamicRibbon","{967ecb27-5cdb-41a1-8383-04fc1d6e118f}","{a652fd4a-c501-486a-8cb6-ed52946eca50}",3,0);Ma.addProperty("Buttons",
4,"Microsoft.DynamicRibbon.RibbonButtonCollection",3,!0,null,0);Gb=Ma.addMethod("ExecuteRequestCreate",7,"Void",0,1,"ExecuteRequestCreate",0);Gb.addParameter("jsonCreate","String",1,null,0);Gb=Ma.addMethod("ExecuteRequestUpdate",6,"Void",0,1,"ExecuteRequestUpdate",0);Gb.addParameter("jsonUpdate","String",1,null,0);Gb=Ma.addMethod("GetButton",3,"Microsoft.DynamicRibbon.RibbonButton",3,1,"Button",0);Gb.addParameter("id","String",1,null,0);Gb=Ma.addMethod("GetTab",5,"Microsoft.DynamicRibbon.RibbonTab",
3,1,"Tab",0);Gb.addParameter("id","String",1,null,0);Ma.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);Ma=S.addType("Microsoft.DynamicRibbon.RibbonTab","{c68e16e8-67dd-48cf-b92f-46b40ca336ee}","",3,0);Ma.addProperty("Id",2,"String",1,!0,null,0);Gb=Ma.addMethod("SetVisibility",3,"Void",0,0,"SetVisibility",0);Gb.addParameter("visibility","Boolean",1,null,0);Ma.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);Ma=S.addType("Microsoft.DynamicRibbon.RibbonButton","{88e27ee2-4787-4d0d-8ff7-788a8be7c8c5}",
"",3,0);Ma.addProperty("Enabled",3,"Boolean",1,!1,null,0);Ma.addProperty("Id",2,"String",1,!0,null,0);Ma.addProperty("Label",4,"String",1,!0,null,0);Gb=Ma.addMethod("SetEnabled",5,"Void",0,0,"SetEnabled",0);Gb.addParameter("enabled","Boolean",1,null,0);Ma.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);Ma=S.addType("Microsoft.DynamicRibbon.RibbonButtonCollection","{208b41cf-a38c-47cd-83fc-0ff0c4848ec3}","",3,0);Ma.addMethod("GetCount",3,"Int32",1,1,"Count",0);Gb=Ma.addIndexerMethod(2,"Microsoft.DynamicRibbon.RibbonButton",
3,0);Gb.addParameter("key","String",1,null,0);Ma.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);Ma.setCollectionInfo("Microsoft.DynamicRibbon.RibbonButton",!0);Ma=S.addEnumType("Microsoft.Office.Licensing.LicenseFeatureTier");Ma.addEnumField("Unknown",0);Ma.addEnumField("Basic",1);Ma.addEnumField("Premium",2);Ma=S.addType("Microsoft.Office.Licensing.License","{db7c13ab-8285-4ff7-88d6-c9e7b2ca9b12}","{89df9b4a-85de-42d7-89d1-de8bc29e6df0}",3,0);Gb=Ma.addMethod("GetFeatureTier",2,"Microsoft.Office.Licensing.LicenseFeatureTier",
1,1,"FeatureTier",0);Gb.addParameter("feature","String",1,null,0);Gb.addParameter("fallbackValue","Microsoft.Office.Licensing.LicenseFeatureTier",1,null,0);Gb=Ma.addMethod("GetLicenseFeature",5,"Microsoft.Office.Licensing.LicenseFeature",3,1,"LicenseFeature",0);Gb.addParameter("feature","String",1,null,0);Gb=Ma.addMethod("IsFeatureEnabled",1,"Boolean",1,1,"IsFeatureEnabled",0);Gb.addParameter("feature","String",1,null,0);Gb.addParameter("fallbackValue","Boolean",1,null,0);Ma.addMethod("IsFreemiumUpsellEnabled",
3,"Boolean",1,1,"IsFreemiumUpsellEnabled",0);Gb=Ma.addMethod("LaunchUpsellExperience",4,"Void",0,1,"LaunchUpsellExperience",0);Gb.addParameter("experienceId","String",1,null,0);Gb=Ma.addMethod("_TestFireStateChangedEvent",6,"Void",0,0,"_TestFireStateChangedEvent",4);Gb.addParameter("feature","String",1,null,0);Ma=S.addType("Microsoft.Office.Licensing.LicenseFeature","{5af0b996-137f-447f-99be-8749e73546c8}","",3,0);Ma.addProperty("Id",5,"String",1,!0,null,0);Ma.addMethod("_RegisterStateChange",6,"Void",
0,1,"_RegisterStateChange",0);Ma.addMethod("_UnregisterStateChange",7,"Void",0,1,"_UnregisterStateChange",0);Ma=S.addType("Microsoft.InternalService.AddinInternalService","{4ddc0abf-728b-44e0-b834-138c166e2651}","{16374866-b755-4a62-8e65-ad23696872b0}",3,0);Ma.addMethod("NotifyActionHandlerReady",1,"Void",0,1,"NotifyActionHandlerReady",0);Ma=S.addType("Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification","{d689e1c3-2ec7-4e8d-9327-7d6703cde2c5}","{bc4e14a3-3463-425f-8e52-07b578e4c4b7}",
3,0);Ma.addMethod("Disable",3,"Void",0,1,"Disable",0);Ma.addMethod("Enable",2,"Void",0,1,"Enable",0);Ma.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0)}function R(S,Ma,Gb,hc){this.menuItemId=S;this.OF=Ma;this.hFj=Gb;this.Myh=hc}function fa(S){this.bxi=S}function ca(S){this.zxa=S;this.kng=hf.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AppForOfficeSSOV2MSA",!1)}function ea(){}function wa(){}function X(){}function ja(S,Ma){this.bhb=Ma;this.hA=S}function va(){this.Y0d=
null;this.Hee=this.FVb=this.xD="";this.Sfe=!0;this.options=null}function ua(S,Ma){this.XPb=S;this.Eib=Ma}function Xa(){}function aa(){this.i5d=this.C4d=this.Xea=null;this.Eib=0}function ba(S){var Ma=rj.call(this)||this;Ma.$=S;Ma.Eb();return Ma}function oa(){this.initialized=!1;this.agaveCommandManager=this.se=this.P_a=null;this.dU={}}function ra(S){var Ma=qj.call(this)||this;Ma.$=S;Ma.Eb();return Ma}function db(){}function Ka(){}function Ga(S,Ma,Gb,hc,Yc){var ed=pj.call(this)||this;ed.tRa={};ed.S$c=
{};ed.Wva=null;ed.Uya=null;ed.Bab=!1;ed.y3h=function(xd,Ed,Xd,Ud,ne){if(2!==Xd)return 32;xd=ne[Sh.a.P8b];Xd=ne[Sh.a.aHa];ne=ne[Sh.a.Eya];Ed=new Fh.a;Ed.Ebi=ne.optionalProperties.InstanceToken;Ed.Qk=ne.optionalProperties[Wg.a.Qk];Ed.eS=ne.optionalProperties[Wg.a.eS];Wg.a.taskPaneWidth in ne.optionalProperties&&(Ed.taskPaneWidth=ne.optionalProperties[Wg.a.taskPaneWidth]);Ed.sourceLocationOverrideResourceId=ne.optionalProperties[Wg.a.sourceLocationOverrideResourceId];Ed.PH=ne.kq;Ed.onTaskPaneClose=ne.optionalProperties[Wg.a.onTaskPaneClose];
Ed.aHa=Xd;Xd=new Wh.a(-859308420,0,2,0,"");Ud=xd.getStoreType()===OSF.StoreType.Sdx;var Qe=new ph.a;Qe.s4=ne.optionalProperties.HeaderCssClass||Xg.a.X1a;Qe.aeb=ne.optionalProperties.TitleCssClass;ed.u7(Xd,xd.getId(),Ed,Ud,Qe);return 32};ed.i3h=function(xd,Ed,Xd,Ud,ne){if(2!==Xd)return 32;xd=ne[Sh.a.P8b].getId();ne=ne[Sh.a.Eya].optionalProperties[Wg.a.sourceLocationOverrideResourceId];return xd?(ed.se.Qh.refreshOsfControl(xd,ne),32):8};ed.oZi=function(xd){xd=xd.Result;if(xd=null===xd?null:xd.SolutionId)ed.se.kke(xd),
Di.a(ed.$).ana(3,xd)};ed.AGf=function(xd,Ed){var Xd,Ud=(xd=xd.Result)?xd.AgaveData:null;if(Ud){ae.ULS.shipAssertTag(537170434,0,Ud.TaskpaneWidth===Ga.lch,"Taskpane width is {0}, assetId is {1}.",Ud.TaskpaneWidth,Telemetry.PrivacyRules.GetPrivacyCompliantId(Ud.PrimaryMarketplace.SolutionId,Ud.PrimaryMarketplace.MarketplaceType,null===(Xd=null===Ud||void 0===Ud?void 0:Ud.AssetMarketplace)||void 0===Xd?void 0:Xd.SolutionId,null,null,Ud.PrimaryMarketplace.MarketplaceRef));if(Xd=ed.S$c[Ud.PrimaryMarketplace.SolutionId])Xd.dzc&&
(Ud.TaskpaneTitle=Xd.dzc),Xd.bzc&&(Ud.TaskpaneIconId=Xd.bzc),Xd.iUd&&(Ud.TaskpaneButtonTooltip=Xd.iUd),0<Xd.ju&&(Ud.TaskpaneWidth=Xd.ju);Ed&&(Ud.FocusOnIframeWhenLoaded=Ed.focusOnIframeWhenLoaded,Ed.width&&(Ud.TaskpaneWidth=Ed.width),Ud.TaskpaneIconCssClass=Ed.Jk,Ud.TaskpaneHeaderCssClass=Ed.s4,Ud.TaskpaneTitleCssClass=Ed.aeb,Ud.IsFirstPartyOptOutAppContextOptmization=Ed.isFirstPartyOptOutAppContextOptmization);ed.tRa[Ud.PrimaryMarketplace.SolutionId]&&(Ud.OsfPropertyBag=ed.uvd(Ud.OsfPropertyBag,
Ud.PrimaryMarketplace.SolutionId));mj.a(Ud)||(Ud.WebExtensionOsfControlType=1);Ud&&(ed.se.kke(xd.SolutionId),ed.se.n0a(Ud))}else ae.ULS.sendTraceTag(593285650,220,10,"AgaveCommandHandler.PostInsertAgaveTaskpaneSuccess: failed to return valid response.")};ed.Wxh=function(xd){xd&&(ed.Z9c.Ghf(xd),ed.Vve())};ed.EGf=function(xd){xd=xd.toDataURL("image/jpeg");var Ed=ed.se.saa(Ga.C6e+"."+Ga.j3e);OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(Ed,"onScreenshot",{screenshot:xd},function(){})};ed.H1h=
function(xd,Ed,Xd,Ud,ne){if(2!==Xd)return 32;if(ci.a.fh(ne)||ne[Sh.a.Xze]!==Mj.a.action)return 8;Ed=ne[Sh.a.Eya];return Ed?(xd=(xd=ed.LSh(ne))?ed.se.saa(xd):null)?(ne=ed.se.A3g(ne[Sh.a.aHa],Ed.optionalProperties[Wg.a.ESc]),ef.EwaSettings.isChangeGateEnabled("OfficeVSO:5295210_SdxTaskpaneTitleOverrideNew")&&(Xd=ed.se.dZ(xd),Xd.TaskpaneTitle!==Ed.optionalProperties[Wg.a.Qk]&&(Xd.TaskpaneTitle=Ed.optionalProperties[Wg.a.Qk],Xd.TaskpaneIconCssClass=Ed.optionalProperties.IconCssClass,Xd.TaskpaneIconUrl=
Ed.optionalProperties.TaskPaneIconUrl,Xd.TaskpaneIconId=Ed.optionalProperties.TaskPaneIconId,ef.EwaSettings.isChangeGateEnabled("OfficeVSO:5793296_SDXIframeTitleOverride")?(Ed=ed.se.Qh,Ed.changeIframeTitle(xd,Xd.TaskpaneTitle),Xd=Ed.getOsfControl(xd),Ed.raiseOsfControlStatusChange(Xd)):(Ed=ed.se.Qh.getOsfControl(xd),ed.se.Qh.raiseOsfControlStatusChange(Ed)))),OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(xd,ne,ed.OJb),32):8:8};ed.OJb=function(xd,Ed){ed.se.CAh(xd,Ed)};ed.aHd=
function(){$f.TaskExtensions.F$(Lg.GetServiceTaskFactory.Ra(ed.$.da,20,404,1),function(xd){xd.result.Yvb()},ed.$.la)};ed.$=S;ed.viewBlockContainerHelpers=Gb;ed.se=Ma;ed.Z9c=hc;ed.oi=Yc;ed.oi.Mb(Eg.a.o2f,ii.a.frame,ed.y3h);ed.oi.Mb(Eg.a.DSf,ii.a.frame,ed.i3h);ed.oi.Mb(Eg.a.eQe,ii.a.frame,ed.H1h);return ed}function xa(){var S=Ri.call(this)||this;S.MUa="calc(100% - 46px)";S.iRb="15px";S.NUa="0";S.Ymg="WACDialogPanel";S.RCa=695;S.Zmg=462;S.Bhb="80%";S.Lkg=350;S.p1d="100%";S.Rb=5;S.ye="AppsForOfficeInsertionDialog";
S.iHc=!!hf.AFrameworkApplication.fa&&hf.AFrameworkApplication.fa.qa("OfficeAddinEnableInsertDialogAccessibilityFix");return S}function da(S,Ma){this.selection=S;this.tables=Ma}function qa(){this.autoFilterType=this.autoFilterRange=null;this.id=this.itemIndex=0}function na(){var S=ia.call(this)||this;S.isTable=!1;S.isPivotTable=!1;S.hasTableHeaders=!1;S.tableName=null;S.userSelectedPivotTable=!1;return S}function ia(){this.addressWithSheet=this.address=this.sheetName=this.sheetId=null;this.columnIndex=
this.columnCount=this.rowIndex=this.rowCount=0;this.isSheetEmpty=!1;this.selectionType=null}function ta(){this.iUd=this.dzc=null;this.ju=0;this.bzc=null}function za(){var S=this;this.se=null;this.Y$a=function(Ma,Gb,hc,Yc,ed){if(2===hc){Ma=ed?ed:{};Gb=Ma.callback;hc=Ma.refresh?Ma.refresh:!1;if(!Gb)return 16;hf.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6458904_QueryEntitledAppsForStoreType")&&null!=Ma.storeType?S.se.ZIf(Gb,hc,Ma.storeType):S.se.Oca(Gb,hc)}return 32};this.$7i=function(Ma,
Gb,hc,Yc,ed){2===hc&&(Ma=ed?ed.callback:null)&&S.se.SDg(Ma);return 32}}function sa(){}function V(S){return hi.call(this,S)||this}function Ia(S){var Ma=kj.call(this)||this;Ma.$=S;Ma.isFirstLaunch=!1;return Ma}function Ha(S){ae.ULS.sendTraceTag(41521353,1313,50,"SmartLookupManager - Initialize");this.bnf=hf.AFrameworkApplication.fa.qa("IsTellMeUpSellEnterpriseEnabled");this.uwi=hf.AFrameworkApplication.fa.Wa("SmartLookupApprovedOriginPattern");this.c8a=hf.AFrameworkApplication.fa.Wa("SmartLookupShredderServiceEndpoint");
this.$wi=wi.a.yM(hf.AFrameworkApplication.fa.Wa("AppCatalogUrl")||"");this.b8a=new La;this.b8a.EnableAllTabV2=!0;this.b8a.EnableIntentService=!0;this.b8a.EnableInDocumentSearch=hf.AFrameworkApplication.fa.qa("SmartLookupEnableInDocumentSearch");this.b8a.EnableLocalSearch=hf.AFrameworkApplication.fa.qa("SmartLookupEnableLocalSearch");this.b8a.IntentServiceEndpoint=ob.uWh();this.Uwi=new ib(S,this.c8a)}function ob(){}function ib(S,Ma,Gb){this.SJj=9E5;this.VJj=3E5;this.jud=null;this.vmf="";this.gud=0;
this.cFe=Date.now;this.zxa=S;this.c8a=Ma;(void 0===Gb||Gb)&&this.Rbd()}function La(){}function zb(){}function Fb(){}function Yb(){}function kb(){}function vb(S,Ma,Gb,hc,Yc,ed){this.$=S;this.agaveCommandManager=ed}function Wa(S){var Ma=Ai.call(this)||this;Ma.ddaFacade=null;Ma.BLf=null;Ma.$=S;S.da.Ga(106,Ma);Ma.Eb();return Ma}function qb(){}function yb(){}function ec(S){this.dFa=S}function Ob(S,Ma,Gb){this.iframe=S;this.onSuccess=Ma;this.onError=Gb;$addHandler(window,"message",Object(Dg.a)(this,this.T4e,
"handleResponse"))}function Cb(S,Ma){return uh.a.Isd(64,function(){return window.OfficeExtension&&window.OfficeExtension.WacRuntime},hf.AFrameworkApplication.fa.kd("MaxRetriesForLoadingScript",0),S,Ma)}function ab(S){var Ma=ij.call(this)||this;Ma.$=S;Ma.Eb();return Ma}function ya(S,Ma){var Gb=this;this.wPa=this.xPa=null;this.S9f=function(hc,Yc){var ed=null,xd=null,Ed=null;Yc?(Object(eh.a)(528,Yc)?(ed=Yc.SFa,Ed=Yc.instanceId):Object(eh.a)(439,Yc)&&(ed=Yc.get_element(),Ed=Yc.instanceId),ed)?(xd=Object(rg.a)(793,
hc),xd)?Gb.CLf(Ed,ed,xd)||Ed in Gb.wPa||(Gb.xPa[Ed]=0,Gb.wPa[Ed]=Jj.a.instance.nE(function(){10<=Gb.xPa[Ed]||Gb.CLf(Ed,ed,xd)?(delete Gb.xPa[Ed],Gb.wPa[Ed].dispose(),delete Gb.wPa[Ed]):Gb.xPa[Ed]+=1},500,Wj.a.XHg,!0,!1)):ae.ULS.sendTraceTag(537170624,0,10,"The AgaveOnSelectedReadoutEvent raised from a null object."):ae.ULS.sendTraceTag(537170625,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."):ae.ULS.sendTraceTag(537170626,0,10,"Invalid parameter for ReadoutSelection")};
this.ariaLiveNotifier=S;this.$=Ma;this.IWc=!1;this.$.da.Ga(224,this)}function ma(S){var Ma=Ni.call(this)||this;Ma.$=S;Ma.Eb();return Ma}function ha(S){var Ma=Hj.call(this,S)||this;Ma.handler=null;Ma.dzg=function(){ae.ULS.sendTraceTag(38410434,0,50,"AddinUICommandHandlerFactory.ActivateFeature, isEditMode [{0}] ShowCommandUI [{1}]",Ma.$.isEditMode,!!(Ma.$.Cd&16384));var Gb=new Ji.a;Ma.$.da.Za(53,function(ne){ae.ULS.sendTraceTag(38410435,0,50,"AddinUICommandHandlerFactory.ActivateFeature success to get service IRibbonManager");
Gb.setResult(ne)});var hc=Gb.task,Yc=new qd,ed=bj.a.getInstance(),xd=new Le(Ma.$,ed),Ed=Lg.GetServiceTaskFactory.create(Ma.$.da,203,Ma.la,Ma.hb),Xd=Ma.b7i(Yc),Ud=Lg.GetServiceTaskFactory.Ra(Ma.$.da,349,350,Ma.hb);return $f.TaskExtensions.Aa($f.TaskExtensions.Vd([hc,Ed,Xd,Ud],Ma.la),function(){ae.ULS.sendTraceTag(38942482,0,50,"AddinUICommandHandlerFactory.ActivateFeature, ContinueWith after realated task finished.");$f.TaskExtensions.Aa(Lg.GetServiceTaskFactory.create(Ma.$.da,106,Ma.la,Ma.hb),function(ne){Ma.handler=
new Z(Ma.$,ne.result,Yc,new Td,ed,xd,fh.a.instance.mh("Common.IExternalUICommandDefinitionMapping"));ae.ULS.sendTraceTag(38410436,0,50,"AddinUICommandHandlerFactory.ActivateFeature, OnCommandHandlersCreated");Ma.jd([Ma.handler]);Ma.$.da.Ga(198,Ma.handler)},Ma.la,3)},Ma.la,3)};Ma.ubh=function(){void 0!==Ma.handler&&null!==Ma.handler?(Ma.$.Ka.Jab(Ma.handler),Ma.$.da.tU(198),Ma.handler=null):ae.ULS.sendTraceTag(42341715,0,50,"AddinUICommandHandlerFactory.DeactivateFeature: handler is not defined, it might have never been activated.");
Ma.$.da.tU(204);Uj.a(Gj.a,21,Ma.$.da,198)};return Ma}function Z(S,Ma,Gb,hc,Yc,ed,xd){var Ed=this;xd=void 0===xd?null:xd;this.disposed=!1;this.UFi=function(Xd,Ud){if(Ud)if(Ud)if(Xd=Ud.Oj){Ud=Ud.to;var ne=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap();if(Xd.solutionId in ne)Ud=ne[Xd.solutionId];else if(Ud=Ed.RKh(Ud),void 0===Ud||null===Ud){ae.ULS.sendTraceTag(528098434,220,15,"addinCommandControlId is NullOrUndefined");return}ne=new Wh.a(Eg.a.l2,0,0,2,null);var Qe={};Ed.executeCommand(0,
ne,(Qe.SourceControlId=Ud,Qe),null);Xd.isAutoLaunched=!0}else ae.ULS.sendTraceTag(528098435,220,15,"insertionParam is null");else ae.ULS.sendTraceTag(528098436,220,15,"agaveParams is null");else ae.ULS.sendTraceTag(528098437,220,15,"No args for OnAutoLaunchAddin event")};this.Z9e=function(Xd,Ud){"Insert"==Ud.tabName&&(Xd=Ed.$.Ka,null!=Xd&&(Xd.VPf(Ed.Z9e),ae.ULS.sendTraceTag(527286662,220,50,"Remove insertTabSwitched handler")),Ed.UAa.PAj())};this.qNi=function(Xd,Ud){Xd=null;Ud&&(Xd=Ud);(null===Xd||
void 0===Xd?0:Xd.to)&&Ed.Grj(Xd.to);Ed.$.hf();ef.EwaSettings.ma(88)&&Xd&&Xd.Oj&&Ed.GMg(Xd.Oj)};this.$=S;ae.ULS.shipAssertTag(537170659,0,!(void 0===Ma||null===Ma),"AddinUICommandHandler constructor error - ddaFacade param should not be null, stack: {0}",Mi.a.d3());this.se=Ma;this.IAe=Gb;this.KZb=hc;this.Iga=Yc;this.nnb=ed;this.Bo=new hj.a;this.Hga=new Se;this.L9c=xd;Lh.a.kxb=Lh.a.aQe;this.O4c=new df.a;this.d1a=new df.a}function Na(S){var Ma=this;this.GFa=this.LFa=this.Oj=this.to=null;this.ZNf=0;this.pNi=
function(){if(Ma.Oj&&Ma.GFa){var Gb=new Wh.a(Eg.a.l2,0,0,2,null),hc={};Ma.addinUICommandHandler.executeCommand(0,Gb,(hc.SourceControlId=Ma.GFa,hc),null);ae.ULS.sendTraceTag(537170697,220,50,"Launch addin command has been triggered")}};this.uyj=function(Gb,hc){Gb=null;if(hc)if(Gb=hc,Ma.Oj=Gb.Oj,Ma.to=Gb.to,Ma.to&&Ma.to.QV&&Ma.to.QV.Bs&&(Ma.LFa=Ma.to.QV.Bs.na(0)),Ma.LFa&&Ma.LFa.id)if(Ma.LFa.isOfficeTab)if(hc=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap(),Gb=Ma.Oj.solutionId,
Gb in hc?Ma.GFa=hc[Gb]:(ae.ULS.sendTraceTag(537170695,220,15,"Failed to get button id from controlIdMap for add-in: {0}",Na.GetPrivacyCompliantId(Ma.Oj)),Ma.GFa=Ma.bHh(Ma.to)),Ma.GFa)if(xi.a.contains(Ma.LFa.id,gh.a.mW,!0))appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(ni.a.T2a(Ma.to),function(){Ma.n3f(Ma.Zed(Ma.GFa))});else{if(hc=Ma.$.Ka)hc.une(Ma.sCf),ae.ULS.sendTraceTag(537170693,220,50,"ShowCalloutOnAddin registered a tab switched event")}else ae.ULS.sendTraceTag(537170694,220,10,"Failed to get button id for addin"),
hc={},hc=(hc.AppTeachingUICalloutAction="NoEnabledButtonFound",hc["SDX.Id"]=Na.GetPrivacyCompliantId(Ma.Oj),hc.AppTeachingUICalloutGoal="NewAdminDeployment",hc["SDX.AppInstallOrigin"]="Organization",hc),tg.a.sendTelemetryEvent(Object(Vg.a)(new og.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:vg.a.Uk(hc)})),Ma.J5();else Ma.p3f(Ma.Zed(Ma.LFa.id),0);else ae.ULS.sendTraceTag(537170696,220,10,"ShowCalloutOnAddin finds that the ribbon extensibility has no tab id"),hc={},hc=(hc.AppTeachingUICalloutAction=
"NoTabFound",hc["SDX.Id"]=Na.GetPrivacyCompliantId(Ma.Oj),hc.AppTeachingUICalloutGoal="NewAdminDeployment",hc["SDX.AppInstallOrigin"]="Organization",hc),tg.a.sendTelemetryEvent(Object(Vg.a)(new og.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:vg.a.Uk(hc)})),Ma.J5();else Ma.J5()};this.sCf=function(){if(xi.a.contains(Ma.LFa.id,appChrome.selectors.getSelectedTabId(),!0)){var Gb=Ma.$.Ka;Gb&&Gb.VPf(Ma.sCf);Ma.n3f(Ma.Zed(Ma.GFa))}};this.rNi=function(){var Gb={};Gb=(Gb.AppTeachingUICalloutAction=
"ClickOnLaunch",Gb["SDX.Id"]=Na.eUa(Ma.hC),Gb.AppTeachingUICalloutGoal="NewAdminDeployment",Gb["SDX.AppInstallOrigin"]="Organization",Gb);tg.a.sendTelemetryEvent(Object(Vg.a)(new og.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:vg.a.Uk(Gb)}));Ma.J5();var hc={};hc[oh.a.Uf]=Ma.hC;Gb={};Gb.solutionId=Ma.hC.solutionId;Gb.assetId=Ma.hC.assetId;Gb.assetStoreId=Ma.hC.assetStoreId;Gb.height=0!=Ma.hC.height?Ma.hC.height:600;Gb.storeId=Ma.hC.storeId;Gb.storeType=Ma.hC.storeType;Gb.targetType=
Ma.hC.targetType;Gb.width=0!=Ma.hC.width?Ma.hC.width:600;Gb.displayName=Ma.hC.displayName;Gb.version=Ma.hC.version;Gb.isAddinCommands=!1;hc[jf.a.Fra]=Gb;var Yc=new Wh.a(-741808261,0,0,2,null);$f.TaskExtensions.Aa(Lg.GetServiceTaskFactory.Ra(Ma.$.da,374,375,1),function(ed){ed=ed.result;null!=ed&&ed.insertAgave(hc,Yc)},Ma.$.la,3)};this.gHi=function(){var Gb={};Gb=(Gb.AppTeachingUICalloutAction="ClickOnClose",Gb["SDX.Id"]=Na.eUa(Ma.hC),Gb.AppTeachingUICalloutGoal="NewAdminDeployment",Gb["SDX.AppInstallOrigin"]=
"Organization",Gb);tg.a.sendTelemetryEvent(Object(Vg.a)(new og.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:vg.a.Uk(Gb)}));Ma.J5()};this.CIi=function(){var Gb={};Gb=(Gb.AppTeachingUICalloutAction="ClickOnDismiss",Gb["SDX.Id"]=Na.eUa(Ma.hC),Gb.AppTeachingUICalloutGoal="NewAdminDeployment",Gb["SDX.AppInstallOrigin"]="Organization",Gb);tg.a.sendTelemetryEvent(Object(Vg.a)(new og.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:vg.a.Uk(Gb)}));Ma.J5()};this.cW=
function(Gb){ae.ULS.sendTraceTag(522981591,306,10,"failed to POST data to Roaming Settings Service with status: {0}",Gb?Gb.httpStatus:-1)};this.$=S.$;this.addinUICommandHandler=S;this.appName=hf.AFrameworkApplication.fa.Wa("WebAppShortName")||"Excel";this.iHg=hf.AFrameworkApplication.fa.kd("AddinMaxDOMElementDetectionTimesForTeachingUI",10)}function eb(S,Ma){this.Sjb=S;this.iUa=new Ab;this.IUa=new Kb(Ma)}function cb(S,Ma,Gb,hc,Yc,ed){this.fQb=new df.a;this.jhb=this.Rea=this.WUa=null;this.YMc=S;this.iUa=
Ma;this.IUa=Gb;this.Ww=hc;this.jQb=Yc;this.X4d=ed}function Ua(){this.groups=this.attributes=this.title=this.id=null;this.visible=this.isOfficeTab=!1;this.insertAfter=this.insertBefore=this.tabType=null;this.autoFocus=!1}function pa(){this.iconLocation=this.title=this.id=null;this.enabled=!1;this.attributes=null}function Qa(){this.controls=this.title=this.mlrId=this.id=null;this.groupType=0;this.attributes=null}function Db(){this.iconLocation=this.title=this.id=null;this.enabled=!1;this.controlType=
0;this.attributes=this.menuItems=null}function Kb(S){this.CCa=S}function Ab(){}function ub(S){this.Sjb=S}function Mb(S,Ma,Gb){this.EI=this.VUa=null;this.YMc=S;this.IUa=Ma;this.iUa=Gb;this.asg=new df.a}function Aa(S){this.opa=null;if(hh.c(S))throw ae.ULS.sendTraceTag(9175314,220,10,"OfficeMenuDefinition id should not be null or undefined."),Error.create("OfficeMenuDefinition id should not be null or undefined");this._id=S}function Za(S){this.X$d=null;if(hh.c(S))throw ae.ULS.sendTraceTag(9175313,220,
10,"MenuItemDefinition id should not be null or undefined."),Error.create("MenuItemDefinition id should not be null or undefined");this._id=S;this.hla[jb.id]=this._id}function Zb(S,Ma){this.VDa=this.X2d=null;if(hh.c(S)||hh.c(Ma))throw ae.ULS.sendTraceTag(9175312,220,10,"ControlDefinition id or type should not be null or undefined."),Error.create("ControlDefinition id or type should not be null or undefined");this.omg=Ma;this._id=S;this.fU[jb.id]=this._id}function jb(){}function Vb(S,Ma,Gb,hc,Yc,ed,
xd,Ed){Ed=void 0===Ed?null:Ed;this.$a=new Cj.a;this.TDc=S;this.img=Ma;this.Lm=Gb;this.she=hc;this.QWa=Yc;this.Bjg=ed;this.jQb=xd;this.Dsg=Ed;this.rqg=hf.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:5996085_EmailAlertAutolaunchOnWacEnabled")}function Ic(S,Ma,Gb,hc,Yc,ed,xd){this.mSa=new Tj.a;this.Rr=S;this.Qh=Ma;this.Bo=Gb;this.ribbonManager=hc;this.contextMenuManager=Yc;this.EF=ed;this.Hga=xd;this.kO=hf.AFrameworkApplication.ta.pD}function Rb(S,Ma,Gb){this.v0d=this.eventBuilder=this.contextMenuBuilder=
this.ribbonBuilder=this.actionBuilder=this.commandSurface=null;this.ribbonBuilder=S;this.eventBuilder=Ma;this.contextMenuBuilder=Gb}function kc(S){this.qng=S.entitlement}function xb(S,Ma,Gb){Ma=void 0===Ma?null:Ma;Gb=void 0===Gb?0:Gb;if(hh.c(S))throw ae.ULS.sendTraceTag(9041814,220,10,"OneLineRibbonExtensibilityObject should not be null or undefined."),Error.create("OneLineRibbonExtensibilityObject should not be null or undefined.");this.Lsg=S;this.iwg=Ma;this.tog=Gb}function Va(S){this.nbe=null;
if(hh.c(S))throw ae.ULS.sendTraceTag(9175315,220,10,"The agave key should not be null or undefined."),Error.create("The agave key should not be null or undefined");this.Njg=S}function tb(){}function fb(S){this.r9d=null;this.l7d=S}function ac(S,Ma,Gb){this.sQa=!1;this.rX=null;this.$a=S;this.Kib=Ma;this.dgb=Gb}function Ac(S,Ma,Gb,hc,Yc,ed){this.Rr=S;this.Oj=Ma;this.f0=Gb;this.displayName=Yc;this.cif=ed}function Rc(){new Fc(oi.a.instance)}function Fc(S){this.ODa=S}function wb(){this.Ver=1}function uc(){}
function Pb(S){this.Ssg=S}function sc(S,Ma,Gb){this.Pa=new Cj.a;this.context=new se;this.iRc=this.N5f=this.kSd=this.IFa=this.cI=this.rX=null;this.contextActivationMgr=S;this.fHg=Ma;this.LZb=Gb;this.appName=hf.AFrameworkApplication.fa.Wa("WebAppShortName")}function nb(){this.addinId=null;this.targetType=0;this.storeId=this.solutionId=null}function pc(S){var Ma=Li.call(this)||this;Ma.properties=S;return Ma}function Dc(){this.mA=this.Vp=null;this._count=0}function oc(S,Ma,Gb){this.next=Gb;this.previous=
Ma;this.data=S}function Gc(S){this.vr=null;this.eA=S}function ld(S){var Ma=-1;switch(S.toLowerCase()){case "omex":Ma=0;break;case "spcatalog":Ma=1;break;case "spapp":Ma=2;break;case "filesystem":Ma=3;break;case "exchange":Ma=4;break;case "registry":Ma=6;break;case "inmemory":Ma=7;break;case "uploadfiledevcatalog":Ma=8;break;case "hardcodedpreinstall":Ma=9;break;case "excatalog":Ma=10;break;case "wopicatalog":Ma=16}return Ma}function gd(S){var Ma=null;switch(S){case 0:Ma="omex";break;case 1:Ma="spcatalog";
break;case 2:Ma="spapp";break;case 3:Ma="filesystem";break;case 4:Ma="exchange";break;case 6:Ma="registry";break;case 7:Ma="inmemory";break;case 8:Ma="uploadfiledevcatalog";break;case 9:Ma="hardcodedpreinstall";break;case 10:Ma="excatalog";break;case 16:Ma="wopicatalog"}return Ma}function Cc(S){var Ma={};Ma.solutionId=S.solutionId;Ma.version=S.version;Ma.storeType=S.storeType;Ma.storeId=S.storeId;Ma.assetId=S.assetId;Ma.assetStoreId=S.assetStoreId;Ma.targetType=S.targetType;Ma.requireConsent=S.requireConsent||
!1;Ma.isAddinCommands=!0;Ma.addinCommandsActionType=0;return Ma}function kd(){return wi.a.b4(window.location.href.toLowerCase(),"wdtpl")}function Fd(){var S=wi.a.b4(window.location.href.toLowerCase(),"wdomexsrctype");return!!S&&"4"===S}function rb(S){this.AYa=this.Oj=null;this.sQa=!1;this.kRb=this.iQb=this.uma=this.Qh=this.rX=this.cI=null;this.Pa=S}function Kd(S){var Ma=vi.call(this)||this;Ma.solutionId=S.solutionId;Ma.assetId=S.assetId;Ma.storeType=S.storeType;Ma.storeId=S.storeId;Ma.assetStoreId=
S.assetStoreId;Ma.targetType=S.targetType;Ma.width=S.width;Ma.height=S.height;Ma.displayName=S.displayName;Ma.version=S.version;return Ma}function Qd(S,Ma,Gb,hc){this.XIb=hf.AFrameworkApplication.fa.Wa("RoamingServiceHandlerWebServiceBase");this.appName=S;this.sib=Ma;this.oib=Gb;this.wkb=void 0===hc?null:hc}function ve(){var S=ui.call(this)||this;S.Oj=null;S.to=null;return S}function Be(){this.addinId=null;this.targetType=0;this.storeId=this.solutionId=null}function Ie(){}function se(){this.Rr=this.sR=
0;this.UUc=null;this.jqc=this.Ozc=0;this.Aqb=this.Uia=this.t2=null}function Se(){this.xYa=null}function Le(S,Ma){var Gb=Kh.call(this)||this;Gb.statusBarManager=null;Gb.agaveCommandManager=null;Gb.Lxe=function(){Gb.EF&&Gb.EF.rxe()};Gb.M3e=function(){Gb.raiseEvent("LAC")};Gb.Uc=function(hc,Yc){!hc.dc&&Aj.b(Yc)&&Gb.statusBarManager&&(Gb.statusBarManager.wF(Gb),Gb.statusBarManager=null)};Gb.EF=Ma;Gb.$=S;Gb.AEj=S.yb+"OfficeAddinLabel-Medium14";Gb.$.da.Za(29,function(hc){Gb.statusBarManager=hc;hc.gJ(Gb)});
Gb.$.ea.Vj(Gb.Uc);Gb.EF.kDg(Gb.M3e);Gb.$.da.Za(206,function(hc){Gb.agaveCommandManager=hc;hc.LEg(Gb.Lxe)});return Gb}function rf(){}function af(){this.mi=null;this.visible=!1}function xe(S,Ma){this.Va=S;this.G1g=Ma}function Td(){this.a1d=this.BDc=null}function Bc(){}function qd(){this.ilg=new df.a}function Jd(S){var Ma=yj.call(this)||this;Ma.$=S;Ma.Eb();return Ma}function ad(S){this.wb=null;this.$=S}function Yd(){return Hb.call(this)||this}function pe(){return Hb.call(this)||this}function Wd(){return Hb.call(this)||
this}function bf(){return Hb.call(this)||this}function ke(){return Hb.call(this)||this}function cf(){return Hb.call(this)||this}function Pe(){return Hb.call(this)||this}function nc(){return Hb.call(this)||this}function Da(){return Hb.call(this)||this}function Sb(){return Hb.call(this)||this}function hb(){return Hb.call(this)||this}function Xb(){return Hb.call(this)||this}function jc(){return Hb.call(this)||this}function Wc(){return Hb.call(this)||this}function fd(){return Hb.call(this)||this}function Tc(){return Hb.call(this)||
this}function td(){return Hb.call(this)||this}function Tb(){return Hb.call(this)||this}function Fa(){return Hb.call(this)||this}function Qb(){return Hb.call(this)||this}function cc(){return Hb.call(this)||this}function bc(){return Hb.call(this)||this}function Mc(){return Hb.call(this)||this}function rd(){return Hb.call(this)||this}function Hd(){return Hb.call(this)||this}function ic(){return Hb.call(this)||this}function Jc(){return Hb.call(this)||this}function zd(){return Hb.call(this)||this}function sd(){return Hb.call(this)||
this}function Pd(){return Hb.call(this)||this}function De(){return Hb.call(this)||this}function lc(){return Hb.call(this)||this}function Pc(){return Hb.call(this)||this}function md(){return Hb.call(this)||this}function bd(){return Hb.call(this)||this}function Od(){return Hb.call(this)||this}function le(){return Hb.call(this)||this}function dd(){return Hb.call(this)||this}function Zd(){return Hb.call(this)||this}function je(){return Hb.call(this)||this}function Ke(){return Hb.call(this)||this}function lf(){return Hb.call(this)||
this}function nf(){return Hb.call(this)||this}function me(){return Hb.call(this)||this}function $e(){return Hb.call(this)||this}function we(){return Hb.call(this)||this}function Ya(){return Hb.call(this)||this}function h(){return Hb.call(this)||this}function lb(){return Hb.call(this)||this}function Ub(){return Hb.call(this)||this}function zc(){return Hb.call(this)||this}function vc(){return Hb.call(this)||this}function ud(){return Hb.call(this)||this}function Gd(){return Hb.call(this)||this}function od(){return Hb.call(this)||
this}function Ae(){return Hb.call(this)||this}function Ne(){return Hb.call(this)||this}function gf(){return Ec.call(this,195,16)||this}function Ja(){return Ec.call(this,194,8)||this}function Lb(){return Hb.call(this)||this}function mc(){return Ec.call(this,198,2)||this}function xc(){return Ec.call(this,197,1)||this}function hd(){return Ec.call(this,196,32)||this}function Cd(){return Hb.call(this)||this}function dc(){return Ec.call(this,193,4)||this}function Ec(S,Ma){var Gb=Hb.call(this)||this;Gb.dfa=
S;Gb.GYd=Ma;return Gb}function gb(){return Hb.call(this)||this}function Bb(){return Hb.call(this)||this}function qc(){return Hb.call(this)||this}function Nc(){return Hb.call(this)||this}function nd(){return Hb.call(this)||this}function Vd(){return Hb.call(this)||this}function oe(){return Kf.call(this,11,16)||this}function qe(){return Kf.call(this,10,128)||this}function ee(){return Hb.call(this)||this}function re(){return Hb.call(this)||this}function Ze(){return Hb.call(this)||this}function mf(){return Hb.call(this)||
this}function Pa(){return Hb.call(this)||this}function Wb(){return Hb.call(this)||this}function Lc(){return Hb.call(this)||this}function jd(){return Hb.call(this)||this}function Ad(){return Hb.call(this)||this}function de(){return Kf.call(this,9,2)||this}function ce(){return Kf.call(this,8,1)||this}function He(){return Kf.call(this,7,8)||this}function We(){return Kf.call(this,6,32)||this}function Sa(){return Hb.call(this)||this}function Eb(){return Hb.call(this)||this}function gc(){return Hb.call(this)||
this}function Qc(){return Hb.call(this)||this}function cd(){return Hb.call(this)||this}function wd(){return Hb.call(this)||this}function Ld(){return Hb.call(this)||this}function ge(){return Hb.call(this)||this}function fe(){return Hb.call(this)||this}function ye(){return Hb.call(this)||this}function Rd(){return Hb.call(this)||this}function tc(){return Hb.call(this)||this}function Vc(){return Hb.call(this)||this}function ue(){return Hb.call(this)||this}function Rf(){return Kf.call(this,4,64)||this}
function Ee(){return Hb.call(this)||this}function vf(){return Hb.call(this)||this}function Ge(){return Hb.call(this)||this}function Of(){return Hb.call(this)||this}function If(){return Hb.call(this)||this}function Xf(){return Hb.call(this)||this}function pf(){return Hb.call(this)||this}function Yf(){}function Cg(){return Hb.call(this)||this}function Rg(){return Kf.call(this,3,4)||this}function Kf(S,Ma){var Gb=Hb.call(this)||this;Gb.dfa=S;Gb.GYd=Ma;return Gb}function Pf(){return Hb.call(this)||this}
function Ff(){return Hb.call(this)||this}function dh(){return Hb.call(this)||this}function Bg(){return Hb.call(this)||this}function Zf(){return Oe.call(this,185,18)||this}function bg(){return Hb.call(this)||this}function pg(){return Oe.call(this,181,14)||this}function kh(){return Oe.call(this,169,2)||this}function lg(){return Oe.call(this,168,1)||this}function ig(){return Hb.call(this)||this}function th(){return Oe.call(this,182,15)||this}function mg(){return Hb.call(this)||this}function fg(){return Hb.call(this)||
this}function Sg(){return Oe.call(this,180,13)||this}function yf(){return Oe.call(this,186,19)||this}function Tg(){return Oe.call(this,175,8)||this}function nh(){return Oe.call(this,176,9)||this}function Ug(){return Oe.call(this,187,20)||this}function $a(){return Oe.call(this,174,7)||this}function $b(){return Oe.call(this,179,12)||this}function wc(){return Oe.call(this,178,11)||this}function Sc(){return Oe.call(this,177,10)||this}function yc(){return Hb.call(this)||this}function Dd(){return Oe.call(this,
170,3)||this}function Sd(){return Oe.call(this,172,5)||this}function Fe(){return Oe.call(this,173,6)||this}function ze(){return Oe.call(this,183,16)||this}function Ce(){return Oe.call(this,184,17)||this}function Ue(){return Oe.call(this,171,4)||this}function Oe(S,Ma){var Gb=Hb.call(this)||this;Gb.dfa=S;Gb.opType=Ma;return Gb}function Ta(){return Hb.call(this)||this}function Ba(){return Hb.call(this)||this}function Jb(){return Hb.call(this)||this}function yd(){return Hb.call(this)||this}function Nd(){return Hb.call(this)||
this}function Je(){return Hb.call(this)||this}function Re(){return Hb.call(this)||this}function uf(){return Hb.call(this)||this}function Bf(){return Hb.call(this)||this}function wf(){return Hb.call(this)||this}function Lf(){return Hb.call(this)||this}function Wf(){return Hb.call(this)||this}function kg(){return Hb.call(this)||this}function Af(){return Hb.call(this)||this}function jh(){return Hb.call(this)||this}function $g(){return Hb.call(this)||this}function ng(){return Hb.call(this)||this}function sh(){return Hb.call(this)||
this}function ah(){return Hb.call(this)||this}function ch(){return Hb.call(this)||this}function Ag(){return Hb.call(this)||this}function ag(){return t.call(this)||this}function Ah(){return Hb.call(this)||this}function Nh(){return Hb.call(this)||this}function xh(){return Hb.call(this)||this}function Qg(){return Hb.call(this)||this}function Hg(){return Hb.call(this)||this}function Uf(){return Hb.call(this)||this}function bh(){return Hb.call(this)||this}function Dh(){return Hb.call(this)||this}function zh(){return Hb.call(this)||
this}function wh(){return rc.call(this,78,[-105,-106,-107,-108,-109,-110,-111,-112,-113,-114,-127,-116,-117,-118,-119,-120,-121,-122,-123,-125,-124,-126,-216,-217,-218,-219,-221,-222,-220,-129,-130,-131])||this}function lh(){return rc.call(this,79,[0,1,2,-102])||this}function qg(){return rc.call(this,75,[-101])||this}function Ih(){return rc.call(this,81,[100,101,102,103,104,105,106])||this}function Zg(){return Hb.call(this)||this}function ug(){return rc.call(this,85,[328,329,330,331,332,333,334,335])||
this}function Gg(){return t.call(this)||this}function Pg(S,Ma,Gb){this.response=this.request=this.eventId=this.source=null;S&&(this.source=S.source,this.eventId=S.eventId,this.request=Ma,this.response=Gb)}function t(){return Hb.call(this)||this}function L(){return rc.call(this,83,[500,501,502])||this}function la(){return rc.call(this,76,[-100])||this}function Ca(){return rc.call(this,82,[200,201,202,203,204,205,206,207,208,209,210])||this}function Ra(){return rc.call(this,80,[-104,-103,300,301,302,
303,304,305,306,307,308,309,310,311])||this}function mb(){return rc.call(this,84,[348,349,350,351,352,353,354,355,356,357,372,373,374,375])||this}function rc(S,Ma){var Gb=Hb.call(this)||this;Gb.dfa=S;Gb.AUj=Ma;return Gb}function Uc(){return Hb.call(this)||this}function W(){return Hb.call(this)||this}function Oa(){return Hb.call(this)||this}function Nb(){return Hb.call(this)||this}function Hb(){this.CHc=this.DHc=this.yNc=this.ZRc=null}function Xc(S,Ma,Gb){var hc=this;this.C9b=null;this.fxi=function(Yc,
ed){hc.e1f()&&hc.J$c(ed)};this.Fnf=Ma;this.Enf=Gb;this.$=S;this.$.Aba&&this.$.BFg(this.fxi);S.da.Ga(297,this)}function Bd(){}function be(){}function he(){this.ogb=null}b.r(E);var Me=b(559),Ye=b(1470),sf=b(1382),qf=b(10),Id=b(0),Ve=b(232),df=b(202),Hf=b(648);he.prototype.iei=function(S){return this.iNg.contains(S.operation)};he.prototype.KNj=function(S){for(var Ma=[],Gb=bk(S.payload.batchedOperations),hc=Gb.next();!hc.done;hc=Gb.next())Ma.push(new Hf.a(S.operation,hc.value));return Ma};Mf.Object.defineProperties(he.prototype,
{iNg:{configurable:!0,enumerable:!0,get:function(){this.ogb||(this.ogb=new df.a,this.ogb.add(12),this.ogb.add(11));return this.ogb}}});Object(Id.a)(he,"MacroRecorderBatchedEventList",null,[]);var ae=b(14),jg=b(54),Ig=b(127),dg=b(737);be.prototype.equals=function(S,Ma){return S===Ma};be.prototype.getHashCode=function(S){return S};be.prototype.jja=function(S){return S};Object(Id.a)(be,"UserOperationNameComparer",null,[14,15]);Bd.Q_h=function(){Bd.Gc||(Bd.Gc=new dg.a(new be),Bd.Gc.add(507),Bd.Gc.add(10),
Bd.Gc.add(576),Bd.Gc.add(563),Bd.Gc.add(564),Bd.Gc.add(565),Bd.Gc.add(566),Bd.Gc.add(567),Bd.Gc.add(568),Bd.Gc.add(569),Bd.Gc.add(570),Bd.Gc.add(571),Bd.Gc.add(572),Bd.Gc.add(573),Bd.Gc.add(574),Bd.Gc.add(575),Bd.Gc.add(501),Bd.Gc.add(520),Bd.Gc.add(1),Bd.Gc.add(1002),Bd.Gc.add(129),Bd.Gc.add(198),Bd.Gc.add(500),Bd.Gc.add(519),Bd.Gc.add(538),Bd.Gc.add(1E3),Bd.Gc.add(1003),Bd.Gc.add(144),Bd.Gc.add(502),Bd.Gc.add(505),Bd.Gc.add(179),Bd.Gc.add(205),Bd.Gc.add(134),Bd.Gc.add(230),Bd.Gc.add(103),Bd.Gc.add(110),
Bd.Gc.add(112),Bd.Gc.add(113),Bd.Gc.add(124),Bd.Gc.add(133),Bd.Gc.add(154),Bd.Gc.add(162),Bd.Gc.add(168),Bd.Gc.add(172),Bd.Gc.add(201),Bd.Gc.add(222),Bd.Gc.add(227),Bd.Gc.add(513),Bd.Gc.add(534),Bd.Gc.add(539),Bd.Gc.add(545),Bd.Gc.add(600),Bd.Gc.add(547),Bd.Gc.add(555),Bd.Gc.add(558),Bd.Gc.add(562),Bd.Gc.add(585),Bd.Gc.add(1001),Bd.Gc.add(1005),Bd.Gc.add(1008),Bd.Gc.add(1010),Bd.Gc.add(1011),Bd.Gc.add(1012),Bd.Gc.add(1018),Bd.Gc.add(252),Bd.Gc.add(253),Bd.Gc.add(258),Bd.Gc.add(101),Bd.Gc.add(102),
Bd.Gc.add(108),Bd.Gc.add(257),Bd.Gc.add(119),Bd.Gc.add(120),Bd.Gc.add(123),Bd.Gc.add(126),Bd.Gc.add(127),Bd.Gc.add(130),Bd.Gc.add(140),Bd.Gc.add(159),Bd.Gc.add(160),Bd.Gc.add(165),Bd.Gc.add(166),Bd.Gc.add(167),Bd.Gc.add(169),Bd.Gc.add(189),Bd.Gc.add(223),Bd.Gc.add(214),Bd.Gc.add(228),Bd.Gc.add(233),Bd.Gc.add(247),Bd.Gc.add(504),Bd.Gc.add(511),Bd.Gc.add(512),Bd.Gc.add(525),Bd.Gc.add(533),Bd.Gc.add(537),Bd.Gc.add(542),Bd.Gc.add(544),Bd.Gc.add(548),Bd.Gc.add(550),Bd.Gc.add(551),Bd.Gc.add(552),Bd.Gc.add(554),
Bd.Gc.add(577),Bd.Gc.add(584),Bd.Gc.add(586),Bd.Gc.add(587),Bd.Gc.add(588),Bd.Gc.add(592),Bd.Gc.add(1009),Bd.Gc.add(1016),Bd.Gc.add(1017));return Bd.Gc};Bd.Gc=null;Object(Id.a)(Bd,"MacroRecorderUnrecognizedEventList",null,[]);Xc.prototype.init=function(S){this.$.Aba&&(S?this.C9b=S:ae.ULS.sendTraceTag(537155424,0,10,"MacroRecorderEventHandler.Init failed because the function passed in is null."))};Xc.prototype.J$c=function(S){if(this.e1f())try{if(this.Enf.iei(S))for(var Ma=this.Enf.KNj(S),Gb=bk(Ma),
hc=Gb.next();!hc.done;hc=Gb.next())this.BSe(hc.value);else this.BSe(S)}catch(Yc){S=String.format("MacroRecorderEventHandler.FireMacroRecorderEvent: Error: {0}, Exception: {1}",Ig.a(S.operation),Yc.stack),ae.ULS.sendTraceTag(537155423,0,10,S)}};Xc.prototype.BSe=function(S){var Ma=this.Fnf.BZe(S,!0);Ma?(this.C9b(Ma.eventId,jg.a.xc(S.payload)),S=String.format("MacroRecorderEventHandler.FireMacroRecorderEvent: Matched: {0}",Ma.eventId),ae.ULS.sendTraceTag(537155422,0,50,S)):(Ma=this.Fnf.BZe(S,!1))?(S=
String.format("MacroRecorderEventHandler.FireMacroRecorderEvent: Matched: {0}, but failed to match filters",Ma.eventId),ae.ULS.sendTraceTag(537155421,0,50,S)):Bd.Q_h().contains(S.operation)||(this.C9b(0,jg.a.xc(S.operation)),S=String.format("MacroRecorderEventHandler.FireMacroRecorderEvent: Unrecognized: {0}",Ig.a(S.operation)),ae.ULS.sendTraceTag(537155420,0,50,S))};Xc.prototype.e1f=function(){return this.$.uka&&this.C9b&&this.$.wba?!0:!1};Object(Id.a)(Xc,"MacroRecorderEventHandler",null,[849]);
var ef=b(1);Hb.prototype.ig=function(){};Hb.prototype.Uva=function(){};Hb.prototype.hd=function(S){this.bCc.add(S)};Hb.prototype.Nb=function(S){this.operations.contains(S)||this.operations.add(S)};Hb.prototype.Hmb=function(){this.featureGates.add(675)};Hb.prototype.uke=function(S){this.fRe.add(S)};Mf.Object.defineProperties(Hb.prototype,{operations:{configurable:!0,enumerable:!0,get:function(){this.yNc||(this.yNc=new df.a,this.Xb());return this.yNc}},bCc:{configurable:!0,enumerable:!0,get:function(){this.ZRc||
(this.ZRc=new df.a,this.ig());return this.ZRc}},fRe:{configurable:!0,enumerable:!0,get:function(){this.CHc||(this.CHc=new df.a);return this.CHc}},featureGates:{configurable:!0,enumerable:!0,get:function(){this.DHc||(this.DHc=new df.a,this.Uva());return this.DHc}}});Object(Id.a)(Hb,"MacroRecorderEventBase",null,[]);Rk(Nb,Hb);Nb.prototype.Xb=function(){this.Nb(100)};Mf.Object.defineProperties(Nb.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 130}}});Object(Id.a)(Nb,"AccessibilityCheckRunEvent",
Hb,[]);Rk(Oa,Hb);Oa.prototype.Xb=function(){this.Nb(241)};Oa.prototype.ig=function(){this.hd(function(S){return S.addToPrintArea})};Mf.Object.defineProperties(Oa.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 160}}});Object(Id.a)(Oa,"AddedToPrintAreaEvent",Hb,[]);Rk(W,Hb);W.prototype.Xb=function(){this.Nb(516)};Mf.Object.defineProperties(W.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 65}}});Object(Id.a)(W,"AutoFilterToggledEvent",Hb,[]);Rk(Uc,Hb);
Uc.prototype.Xb=function(){this.Nb(502)};Uc.prototype.ig=function(){this.hd(function(S){return!(S.Z3a().FirstColumn===S.Z3a().LastColumn&&S.Z3a().FirstRow===S.Z3a().LastRow)})};Mf.Object.defineProperties(Uc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 118}}});Object(Id.a)(Uc,"AutoSumEvent",Hb,[]);Rk(rc,Hb);rc.prototype.Xb=function(){this.Nb(529);this.Nb(594)};rc.prototype.ig=function(){var S=this;this.hd(function(Ma){return Array.contains(S.AUj,Ma.Ded())})};Mf.Object.defineProperties(rc.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return this.dfa}}});Object(Id.a)(rc,"ChartPropertyAppliedEventBase",Hb,[]);Rk(mb,rc);Object(Id.a)(mb,"ChartAxisChangedEvent",rc,[]);Rk(Ra,rc);Object(Id.a)(Ra,"ChartAxisTitleChangedEvent",rc,[]);Rk(Ca,rc);Object(Id.a)(Ca,"ChartDataLabelsChangedEvent",rc,[]);Rk(la,rc);Object(Id.a)(la,"ChartDataSelectedEvent",rc,[]);Rk(L,rc);Object(Id.a)(L,"ChartDataTableChangedEvent",rc,[]);var Kg=b(616),eh=b(440),rg=b(85);Rk(t,Hb);Object(Id.a)(t,"RichApiRequestExecutedEventBase",
Hb,[]);Mf.Object.defineProperties(Pg.prototype,{isValid:{configurable:!0,enumerable:!0,get:function(){return!(void 0===this.source||null===this.source)&&!(void 0===this.eventId||null===this.eventId)&&!0}}});Object(Id.a)(Pg,"MacroRecorderRichApiRequestExecutedPayload",null,[438]);Rk(Gg,t);Gg.prototype.$E=function(S){Gg.Q6||(Gg.Q6=new dg.a(Kg.a.Ik()),Gg.Q6.add("907dd90f-a82f-4bbf-b4f2-fcd4868a5e14"),Gg.Q6.add("fa000000014"));return!!S&&Gg.Q6.contains(S.toLowerCase())};Gg.prototype.Xb=function(){this.Nb(507);
this.Nb(10);this.Nb(576)};Gg.prototype.ig=function(){var S=this;this.hd(function(Ma){return Object(eh.a)(Pg,Ma)&&(Ma=Object(rg.a)(Pg,Ma),Ma.isValid&&S.$E(Ma.source))?(ae.ULS.sendTraceTag(537155427,0,50,"[RichApiRecorder]: A ChartFormatRichApiRequestExecutedEvent is matched! eventId: {0}",Ma.eventId),!0):!1})};Mf.Object.defineProperties(Gg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 117}}});Gg.Q6=null;Object(Id.a)(Gg,"ChartFormatRichApiRequestExecutedEvent",t,[]);Rk(ug,
rc);Object(Id.a)(ug,"ChartGridlinesChangedEvent",rc,[]);Rk(Zg,Hb);Zg.prototype.Xb=function(){this.Nb(528)};Mf.Object.defineProperties(Zg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 66}}});Object(Id.a)(Zg,"ChartInsertedEvent",Hb,[]);Rk(Ih,rc);Object(Id.a)(Ih,"ChartLegendChangedEvent",rc,[]);Rk(qg,rc);Object(Id.a)(qg,"ChartRowColumnSwitchedEvent",rc,[]);Rk(lh,rc);Object(Id.a)(lh,"ChartTitleChangedEvent",rc,[]);Rk(wh,rc);Object(Id.a)(wh,"ChartTypeChangedEvent",rc,[]);Rk(zh,
Hb);zh.prototype.Xb=function(){this.Nb(521)};Mf.Object.defineProperties(zh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 131}}});Object(Id.a)(zh,"ConnectorFloatingObjectResizedEvent",Hb,[]);Rk(Dh,Hb);Dh.prototype.Xb=function(){this.Nb(109)};Mf.Object.defineProperties(Dh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 129}}});Object(Id.a)(Dh,"EntitySelectedEvent",Hb,[]);Rk(bh,Hb);bh.prototype.Xb=function(){this.Nb(149);this.Nb(147)};Mf.Object.defineProperties(bh.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 49}}});Object(Id.a)(bh,"FindCellEvent",Hb,[]);Rk(Uf,Hb);Uf.prototype.Xb=function(){this.Nb(122)};Mf.Object.defineProperties(Uf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 96}}});Object(Id.a)(Uf,"FloatingObjectAltTextAppliedEvent",Hb,[]);Rk(Hg,Hb);Hg.prototype.Xb=function(){this.Nb(522)};Mf.Object.defineProperties(Hg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 93}}});Object(Id.a)(Hg,
"FloatingObjectDeletedEvent",Hb,[]);Rk(Qg,Hb);Qg.prototype.Xb=function(){this.Nb(524)};Mf.Object.defineProperties(Qg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 94}}});Object(Id.a)(Qg,"FloatingObjectMovedAndResizedEvent",Hb,[]);Rk(xh,Hb);xh.prototype.Xb=function(){this.Nb(523)};Mf.Object.defineProperties(xh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 95}}});Object(Id.a)(xh,"FloatingObjectRotatedEvent",Hb,[]);Rk(Nh,Hb);Nh.prototype.Xb=function(){this.Nb(543)};
Mf.Object.defineProperties(Nh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 100}}});Object(Id.a)(Nh,"GroupDetailsShownOrHiddenEvent",Hb,[]);Rk(Ah,Hb);Ah.prototype.Xb=function(){this.Nb(125)};Mf.Object.defineProperties(Ah.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 154}}});Object(Id.a)(Ah,"HyperlinksRemovedFromRangeEvent",Hb,[]);Rk(ag,t);ag.prototype.$E=function(S){ag.Q6||(ag.Q6=new dg.a(Kg.a.Ik()),ag.Q6.add("f438b4e6-2b49-466f-9a91-b75f473eba96"),
ag.Q6.add("fa000000005"));return!!S&&ag.Q6.contains(S.toLowerCase())};ag.prototype.Xb=function(){this.Nb(507);this.Nb(10);this.Nb(576)};ag.prototype.ig=function(){var S=this;this.hd(function(Ma){return Object(eh.a)(Pg,Ma)?(Ma=Object(rg.a)(Pg,Ma),Ma.isValid&&S.$E(Ma.source)):!1})};Mf.Object.defineProperties(ag.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 125}}});ag.Q6=null;Object(Id.a)(ag,"IdeasRichApiRequestExecutedEvent",t,[]);Rk(Ag,Hb);Ag.prototype.Xb=function(){this.Nb(115)};
Mf.Object.defineProperties(Ag.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 136}}});Object(Id.a)(Ag,"LinkedEntityConvertedEvent",Hb,[]);Rk(ch,Hb);ch.prototype.Xb=function(){this.Nb(114)};Mf.Object.defineProperties(ch.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 148}}});Object(Id.a)(ch,"LinkedEntityDisambiguationPaneToggledEvent",Hb,[]);Rk(ah,Hb);ah.prototype.Xb=function(){this.Nb(119)};Mf.Object.defineProperties(ah.prototype,{eventId:{configurable:!0,
enumerable:!0,get:function(){return 127}}});Object(Id.a)(ah,"MovedToEdgeEvent",Hb,[]);Rk(sh,Hb);sh.prototype.Xb=function(){this.Nb(191)};sh.prototype.Uva=function(){this.Hmb()};Mf.Object.defineProperties(sh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 135}}});Object(Id.a)(sh,"NamedSheetViewCreatedEvent",Hb,[]);Rk(ng,Hb);ng.prototype.Xb=function(){this.Nb(200)};ng.prototype.Uva=function(){this.Hmb()};Mf.Object.defineProperties(ng.prototype,{eventId:{configurable:!0,enumerable:!0,
get:function(){return 166}}});Object(Id.a)(ng,"NamedSheetViewDeletedEvent",Hb,[]);Rk($g,Hb);$g.prototype.Xb=function(){this.Nb(192)};$g.prototype.Uva=function(){this.Hmb()};Mf.Object.defineProperties($g.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 133}}});Object(Id.a)($g,"NamedSheetViewExitedEvent",Hb,[]);Rk(jh,Hb);jh.prototype.Xb=function(){this.Nb(199)};jh.prototype.Uva=function(){this.Hmb()};Mf.Object.defineProperties(jh.prototype,{eventId:{configurable:!0,enumerable:!0,
get:function(){return 162}}});Object(Id.a)(jh,"NamedSheetViewRenamedEvent",Hb,[]);Rk(Af,Hb);Af.prototype.Xb=function(){this.Nb(195)};Af.prototype.Uva=function(){this.Hmb()};Mf.Object.defineProperties(Af.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 167}}});Object(Id.a)(Af,"NamedSheetViewSwitchedEvent",Hb,[]);Rk(kg,Hb);kg.prototype.Xb=function(){this.Nb(174)};Mf.Object.defineProperties(kg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 99}}});Object(Id.a)(kg,
"OutlineLevelSetEvent",Hb,[]);Rk(Wf,Hb);Wf.prototype.Xb=function(){this.Nb(244)};Mf.Object.defineProperties(Wf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 156}}});Object(Id.a)(Wf,"PageBreakInsertedEvent",Hb,[]);Rk(Lf,Hb);Lf.prototype.Xb=function(){this.Nb(245)};Mf.Object.defineProperties(Lf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 157}}});Object(Id.a)(Lf,"PageBreakRemovedEvent",Hb,[]);Rk(wf,Hb);wf.prototype.Xb=function(){this.Nb(246)};Mf.Object.defineProperties(wf.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 158}}});Object(Id.a)(wf,"PageBreaksAllResetEvent",Hb,[]);Rk(Bf,Hb);Bf.prototype.Xb=function(){this.Nb(503)};Bf.prototype.ig=function(){this.hd(function(S){return!!S.pasteParameters.ClientEstimationFloatingObjectId&&2===S.pasteParameters.CopyPasteTargetType&&!S.isFromCurrentSession})};Mf.Object.defineProperties(Bf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 112}}});Object(Id.a)(Bf,"PasteArtOtherWorkbookEvent",
Hb,[]);Rk(uf,Hb);uf.prototype.Xb=function(){this.Nb(503)};uf.prototype.ig=function(){this.hd(function(S){return!!S.pasteParameters.ClientEstimationFloatingObjectId&&2===S.pasteParameters.CopyPasteTargetType&&S.isFromCurrentSession})};Mf.Object.defineProperties(uf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 52}}});Object(Id.a)(uf,"PasteArtSameWorkbookEvent",Hb,[]);Rk(Re,Hb);Re.prototype.Xb=function(){this.Nb(204)};Mf.Object.defineProperties(Re.prototype,{eventId:{configurable:!0,
enumerable:!0,get:function(){return 110}}});Object(Id.a)(Re,"PasteHtmlEvent",Hb,[]);Rk(Je,Hb);Je.prototype.Xb=function(){this.Nb(506)};Mf.Object.defineProperties(Je.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 35}}});Object(Id.a)(Je,"PasteRangeEvent",Hb,[]);Rk(Nd,Hb);Nd.prototype.Xb=function(){this.Nb(503)};Nd.prototype.ig=function(){this.hd(function(S){return 1===S.pasteParameters.CopyPasteTargetType})};Mf.Object.defineProperties(Nd.prototype,{eventId:{configurable:!0,
enumerable:!0,get:function(){return 111}}});Object(Id.a)(Nd,"PasteShadowWorkbookRangeEvent",Hb,[]);Rk(yd,Hb);yd.prototype.Xb=function(){this.Nb(180)};Mf.Object.defineProperties(yd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 42}}});Object(Id.a)(yd,"PasteStringEvent",Hb,[]);Rk(Jb,Hb);Jb.prototype.Xb=function(){this.Nb(220)};Mf.Object.defineProperties(Jb.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 134}}});Object(Id.a)(Jb,"PendingMergeEvent",Hb,
[]);Rk(Ba,Hb);Ba.prototype.Xb=function(){this.Nb(510)};Mf.Object.defineProperties(Ba.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 122}}});Object(Id.a)(Ba,"PictureInsertedEvent",Hb,[]);Rk(Ta,Hb);Ta.prototype.Xb=function(){this.Nb(161)};Mf.Object.defineProperties(Ta.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 153}}});Object(Id.a)(Ta,"PivotDrillToggledEvent",Hb,[]);Rk(Oe,Hb);Oe.prototype.Xb=function(){this.Nb(225)};Oe.prototype.ig=function(){var S=
this;this.hd(function(Ma){return Ma.opType===S.opType})};Mf.Object.defineProperties(Oe.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return this.dfa}}});Object(Id.a)(Oe,"PivotTableSettingsChangedEventBase",Hb,[]);Rk(Ue,Oe);Object(Id.a)(Ue,"PivotTableAllItemLabelsRepeatedEvent",Oe,[]);Rk(Ce,Oe);Object(Id.a)(Ce,"PivotTableAltTextDescriptionChangedEvent",Oe,[]);Rk(ze,Oe);Object(Id.a)(ze,"PivotTableAltTextTitleChangedEvent",Oe,[]);Rk(Fe,Oe);Object(Id.a)(Fe,"PivotTableAutoFitColumnWidthsOnRefreshToggledEvent",
Oe,[]);Rk(Sd,Oe);Object(Id.a)(Sd,"PivotTableBlankLineAfterEachItemToggledEvent",Oe,[]);Rk(Dd,Oe);Object(Id.a)(Dd,"PivotTableColumnGrandTotalShownEvent",Oe,[]);Rk(yc,Hb);yc.prototype.Xb=function(){this.Nb(132)};Mf.Object.defineProperties(yc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 98}}});Object(Id.a)(yc,"PivotTableCreatedEvent",Hb,[]);Rk(Sc,Oe);Object(Id.a)(Sc,"PivotTableDisplayErrorStringToggledEvent",Oe,[]);Rk(wc,Oe);Object(Id.a)(wc,"PivotTableDisplayNullStringToggledEvent",
Oe,[]);Rk($b,Oe);Object(Id.a)($b,"PivotTableErrorStringChangedEvent",Oe,[]);Rk($a,Oe);Object(Id.a)($a,"PivotTableExpandCollapseButtonsShownEvent",Oe,[]);Rk(Ug,Oe);Object(Id.a)(Ug,"PivotTableIndentChangedEvent",Oe,[]);Rk(nh,Oe);Object(Id.a)(nh,"PivotTableItemsWithNoDataOnColumnsShownEvent",Oe,[]);Rk(Tg,Oe);Object(Id.a)(Tg,"PivotTableItemsWithNoDataOnRowsShownEvent",Oe,[]);Rk(yf,Oe);Object(Id.a)(yf,"PivotTableLayoutTypeSetEvent",Oe,[]);Rk(Sg,Oe);Object(Id.a)(Sg,"PivotTableNullStringChangedEvent",Oe,
[]);Rk(fg,Hb);fg.prototype.Xb=function(){this.Nb(219)};Mf.Object.defineProperties(fg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 149}}});Object(Id.a)(fg,"PivotTablePivotLocationChangedEvent",Hb,[]);Rk(mg,Hb);mg.prototype.Xb=function(){this.Nb(145)};Mf.Object.defineProperties(mg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 102}}});Object(Id.a)(mg,"PivotTablePivotedEvent",Hb,[]);Rk(th,Oe);Object(Id.a)(th,"PivotTableRefreshDataOnLoadToggledEvent",
Oe,[]);Rk(ig,Hb);ig.prototype.Xb=function(){this.Nb(50)};ig.prototype.ig=function(){this.hd(function(S){return!!S.pivotTableId&&!!S.pivotTableName})};Mf.Object.defineProperties(ig.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 104}}});Object(Id.a)(ig,"PivotTableRefreshedEvent",Hb,[]);Rk(lg,Oe);Object(Id.a)(lg,"PivotTableRenamedEvent",Oe,[]);Rk(kh,Oe);Object(Id.a)(kh,"PivotTableRowGrandTotalShownEvent",Oe,[]);Rk(pg,Oe);Object(Id.a)(pg,"PivotTableSaveSourceDataWithFileToggledEvent",
Oe,[]);var Jh=b(703);Rk(bg,Hb);bg.prototype.Xb=function(){this.Nb(131)};bg.prototype.ig=function(){this.hd(function(S){S=Object(rg.a)(Jh.a,S);return!!S&&!!S.LJa()&&!!S.hierarchyName})};Mf.Object.defineProperties(bg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 155}}});Object(Id.a)(bg,"PivotTableSortedEvent",Hb,[]);Rk(Zf,Oe);Object(Id.a)(Zf,"PivotTableSubTotalsVisibilitySettingSetEvent",Oe,[]);Rk(Bg,Hb);Bg.prototype.Xb=function(){this.Nb(560)};Mf.Object.defineProperties(Bg.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 206}}});Object(Id.a)(Bg,"PivotValueFieldSettingAppliedEvent",Hb,[]);Rk(dh,Hb);dh.prototype.Xb=function(){this.Nb(243)};Mf.Object.defineProperties(dh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 161}}});Object(Id.a)(dh,"PrintAreaClearedEvent",Hb,[]);Rk(Ff,Hb);Ff.prototype.Xb=function(){this.Nb(241)};Ff.prototype.ig=function(){this.hd(function(S){return!S.addToPrintArea})};Mf.Object.defineProperties(Ff.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 159}}});Object(Id.a)(Ff,"PrintAreaSetEvent",Hb,[]);Rk(Pf,Hb);Pf.prototype.Xb=function(){this.Nb(517)};Mf.Object.defineProperties(Pf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 57}}});Object(Id.a)(Pf,"RangeAutoFilterClearedEvent",Hb,[]);Rk(Kf,Hb);Kf.prototype.Xb=function(){this.Nb(11)};Kf.prototype.ig=function(){var S=this;this.hd(function(Ma){return 16===Ma.kZ().ValidMembers});this.hd(function(Ma){return Ma.kZ().Font.ValidMembers===
S.GYd})};Mf.Object.defineProperties(Kf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return this.dfa}}});Object(Id.a)(Kf,"RangeFontFormattedEventBase",Hb,[]);Rk(Rg,Kf);Object(Id.a)(Rg,"RangeBoldedEvent",Kf,[]);Rk(Cg,Hb);Cg.prototype.Xb=function(){this.Nb(11)};Cg.prototype.ig=function(){this.hd(function(S){return 128===S.kZ().ValidMembers})};Mf.Object.defineProperties(Cg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 2}}});Object(Id.a)(Cg,"RangeBorderedEvent",
Hb,[]);Yf.U9a="Table";Yf.toc="Sheet";Object(Id.a)(Yf,"MacroRecorderEventConstants",null,[]);Rk(pf,Hb);pf.prototype.Xb=function(){this.Nb(208)};pf.prototype.ig=function(){this.hd(function(S){return S.getParameters().FilterType===Yf.toc})};Mf.Object.defineProperties(pf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 113}}});Object(Id.a)(pf,"RangeCheckedItemsFilteredEvent",Hb,[]);Rk(Xf,Hb);Xf.prototype.Xb=function(){this.Nb(105)};Mf.Object.defineProperties(Xf.prototype,{eventId:{configurable:!0,
enumerable:!0,get:function(){return 109}}});Object(Id.a)(Xf,"RangeConditionalFormattingCreatedEvent",Hb,[]);Rk(If,Hb);If.prototype.Xb=function(){this.Nb(221)};Mf.Object.defineProperties(If.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 124}}});Object(Id.a)(If,"RangeConditionalFormattingRuleDeletedEvent",Hb,[]);Rk(Of,Hb);Of.prototype.Xb=function(){this.Nb(508)};Of.prototype.ig=function(){this.hd(function(S){return 3===S.Qt()||1===S.Qt()||4===S.Qt()})};Mf.Object.defineProperties(Of.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 29}}});Object(Id.a)(Of,"RangeContentClearedEvent",Hb,[]);Rk(Ge,Hb);Ge.prototype.Xb=function(){this.Nb(104)};Mf.Object.defineProperties(Ge.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 40}}});Object(Id.a)(Ge,"RangeCopiedCutCellsInsertedEvent",Hb,[]);Rk(vf,Hb);vf.prototype.Xb=function(){this.Nb(209)};vf.prototype.ig=function(){this.hd(function(S){return S.getParameters().FilterType===Yf.toc})};Mf.Object.defineProperties(vf.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 114}}});Object(Id.a)(vf,"RangeCustomFilteredEvent",Hb,[]);Rk(Ee,Hb);Ee.prototype.Xb=function(){this.Nb(121)};Mf.Object.defineProperties(Ee.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 106}}});Object(Id.a)(Ee,"RangeDataValidationChangedEvent",Hb,[]);Rk(Rf,Kf);Object(Id.a)(Rf,"RangeDoubleUnderlinedEvent",Kf,[]);Rk(ue,Hb);ue.prototype.Xb=function(){this.Nb(190)};Mf.Object.defineProperties(ue.prototype,{eventId:{configurable:!0,
enumerable:!0,get:function(){return 69}}});Object(Id.a)(ue,"RangeDuplicatesRemovedEvent",Hb,[]);Rk(Vc,Hb);Vc.prototype.Xb=function(){this.Nb(527);this.Nb(12)};Mf.Object.defineProperties(Vc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 1}}});Object(Id.a)(Vc,"RangeEditedEvent",Hb,[]);Rk(tc,Hb);tc.prototype.Xb=function(){this.Nb(255)};tc.prototype.ig=function(){this.hd(function(S){return 4===S.actionType})};Mf.Object.defineProperties(tc.prototype,{eventId:{configurable:!0,enumerable:!0,
get:function(){return 164}}});Object(Id.a)(tc,"RangeExternalLinksBrokeAllLinksEvent",Hb,[]);Rk(Rd,Hb);Rd.prototype.Xb=function(){this.Nb(255)};Rd.prototype.ig=function(){this.hd(function(S){return 3===S.actionType})};Mf.Object.defineProperties(Rd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 119}}});Object(Id.a)(Rd,"RangeExternalLinksBrokeLinkEvent",Hb,[]);Rk(ye,Hb);ye.prototype.Xb=function(){this.Nb(256)};ye.prototype.Uva=function(){this.uke("Microsoft.Office.Excel.WebExternalLinksChangeSourceMacroRecorder")};
Mf.Object.defineProperties(ye.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 205}}});Object(Id.a)(ye,"RangeExternalLinksChangeSourceEvent",Hb,[]);Rk(fe,Hb);fe.prototype.Xb=function(){this.Nb(553)};fe.prototype.ig=function(){this.hd(function(S){return 1===S.actionType})};Mf.Object.defineProperties(fe.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 163}}});Object(Id.a)(fe,"RangeExternalLinksRefreshedAllEvent",Hb,[]);Rk(ge,Hb);ge.prototype.Xb=function(){this.Nb(553)};
ge.prototype.ig=function(){this.hd(function(S){return 0===S.actionType})};Mf.Object.defineProperties(ge.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 77}}});Object(Id.a)(ge,"RangeExternalLinksRefreshedEvent",Hb,[]);Rk(Ld,Hb);Ld.prototype.Xb=function(){this.Nb(224)};Mf.Object.defineProperties(Ld.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 165}}});Object(Id.a)(Ld,"RangeExternalLinksSetAutoRefreshEvent",Hb,[]);Rk(wd,Hb);wd.prototype.Xb=function(){this.Nb(11)};
wd.prototype.ig=function(){this.hd(function(S){return 64===S.kZ().ValidMembers})};Mf.Object.defineProperties(wd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 5}}});Object(Id.a)(wd,"RangeFillColoredEvent",Hb,[]);Rk(cd,Hb);cd.prototype.Xb=function(){this.Nb(155)};Mf.Object.defineProperties(cd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 59}}});Object(Id.a)(cd,"RangeFilledEvent",Hb,[]);Rk(Qc,Hb);Qc.prototype.Xb=function(){this.Nb(176)};Qc.prototype.ig=
function(){this.hd(function(S){return S.TU().AutoFilterType===Yf.toc&&!!S.TU().CriteriaType})};Mf.Object.defineProperties(Qc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 115}}});Object(Id.a)(Qc,"RangeFilterAppliedEvent",Hb,[]);Rk(gc,Hb);gc.prototype.Xb=function(){this.Nb(176)};gc.prototype.ig=function(){this.hd(function(S){return S.TU().AutoFilterType===Yf.toc&&!S.TU().CriteriaType})};Mf.Object.defineProperties(gc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 58}}});
Object(Id.a)(gc,"RangeFilterClearedEvent",Hb,[]);Rk(Eb,Hb);Eb.prototype.Xb=function(){this.Nb(518)};Mf.Object.defineProperties(Eb.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 41}}});Object(Id.a)(Eb,"RangeFilterReappliedEvent",Hb,[]);Rk(Sa,Hb);Sa.prototype.Xb=function(){this.Nb(150)};Mf.Object.defineProperties(Sa.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 86}}});Object(Id.a)(Sa,"RangeFlashFilledEvent",Hb,[]);Rk(We,Kf);Object(Id.a)(We,"RangeFontColoredEvent",
Kf,[]);Rk(He,Kf);Object(Id.a)(He,"RangeFontItalicizedEvent",Kf,[]);Rk(ce,Kf);Object(Id.a)(ce,"RangeFontNamedEvent",Kf,[]);Rk(de,Kf);Object(Id.a)(de,"RangeFontSizedEvent",Kf,[]);Rk(Ad,Hb);Ad.prototype.Xb=function(){this.Nb(215)};Mf.Object.defineProperties(Ad.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 74}}});Object(Id.a)(Ad,"RangeFormattedAsTableEvent",Hb,[]);Rk(jd,Hb);jd.prototype.Xb=function(){this.Nb(188)};Mf.Object.defineProperties(jd.prototype,{eventId:{configurable:!0,
enumerable:!0,get:function(){return 97}}});Object(Id.a)(jd,"RangeGroupedOrUngroupedEvent",Hb,[]);Rk(Lc,Hb);Lc.prototype.Xb=function(){this.Nb(11)};Lc.prototype.ig=function(){this.hd(function(S){return 2===S.kZ().ValidMembers})};Mf.Object.defineProperties(Lc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 60}}});Object(Id.a)(Lc,"RangeHorizontallyAlignedEvent",Hb,[]);Rk(Wb,Hb);Wb.prototype.Xb=function(){this.Nb(526)};Mf.Object.defineProperties(Wb.prototype,{eventId:{configurable:!0,
enumerable:!0,get:function(){return 43}}});Object(Id.a)(Wb,"RangeHyperlinkAppliedEvent",Hb,[]);Rk(Pa,Hb);Pa.prototype.Xb=function(){this.Nb(11)};Pa.prototype.ig=function(){this.hd(function(S){return 256===S.kZ().ValidMembers})};Mf.Object.defineProperties(Pa.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 63}}});Object(Id.a)(Pa,"RangeIndentChangedEvent",Hb,[]);Rk(mf,Hb);mf.prototype.Xb=function(){this.Nb(156)};mf.prototype.ig=function(){this.hd(function(S){return 2===S.Qt()||
5===S.Qt()||6===S.Qt()||7===S.Qt()})};Mf.Object.defineProperties(mf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 53}}});Object(Id.a)(mf,"RangeMergedEvent",Hb,[]);Rk(Ze,Hb);Ze.prototype.Xb=function(){this.Nb(216)};Mf.Object.defineProperties(Ze.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 107}}});Object(Id.a)(Ze,"RangeNamedCellStyleAppliedEvent",Hb,[]);Rk(re,Hb);re.prototype.Xb=function(){this.Nb(11)};re.prototype.ig=function(){this.hd(function(S){return 32===
S.kZ().ValidMembers})};Mf.Object.defineProperties(re.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 12}}});Object(Id.a)(re,"RangeNumberFormattedEvent",Hb,[]);var Ii=b(1164);Rk(ee,Hb);ee.prototype.Xb=function(){this.Nb(141)};ee.prototype.ig=function(){this.hd(function(S){return Object(eh.a)(Ii.a,S)})};Mf.Object.defineProperties(ee.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 108}}});Object(Id.a)(ee,"RangeSortedEvent",Hb,[]);Rk(qe,Kf);Object(Id.a)(qe,
"RangeStrikedThroughEvent",Kf,[]);Rk(oe,Kf);Object(Id.a)(oe,"RangeUnderlinedEvent",Kf,[]);Rk(Vd,Hb);Vd.prototype.Xb=function(){this.Nb(11)};Vd.prototype.ig=function(){this.hd(function(S){return 1===S.kZ().ValidMembers})};Mf.Object.defineProperties(Vd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 61}}});Object(Id.a)(Vd,"RangeVerticallyAlignedEvent",Hb,[]);Rk(nd,Hb);nd.prototype.Xb=function(){this.Nb(11)};nd.prototype.ig=function(){this.hd(function(S){return 8===S.kZ().ValidMembers})};
Mf.Object.defineProperties(nd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 62}}});Object(Id.a)(nd,"RangeWrapTextToggledEvent",Hb,[]);Rk(Nc,Hb);Nc.prototype.Xb=function(){this.Nb(51)};Mf.Object.defineProperties(Nc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 103}}});Object(Id.a)(Nc,"RefreshedAllEvent",Hb,[]);Rk(qc,Hb);qc.prototype.Xb=function(){this.Nb(148)};Mf.Object.defineProperties(qc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 47}}});
Object(Id.a)(qc,"ReplaceAllEvent",Hb,[]);Rk(Bb,Hb);Bb.prototype.Xb=function(){this.Nb(532)};Bb.prototype.ig=function(){this.hd(function(S){return 95!==S.getShapeType()&&96!==S.getShapeType()&&97!==S.getShapeType()&&98!==S.getShapeType()&&100!==S.getShapeType()&&102!==S.getShapeType()&&103!==S.getShapeType()})};Mf.Object.defineProperties(Bb.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 91}}});Object(Id.a)(Bb,"ShapeInsertedEvent",Hb,[]);Rk(gb,Hb);gb.prototype.Xb=function(){this.Nb(531)};
Mf.Object.defineProperties(gb.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 92}}});Object(Id.a)(gb,"ShapeStyleSetEvent",Hb,[]);var ei=b(1023);Rk(Ec,Hb);Ec.prototype.Xb=function(){this.Nb(581)};Ec.prototype.ig=function(){var S=this;this.hd(function(Ma){return Object(eh.a)(ei.a,Ma)&&4===Ma.getShapeTextFormat().ValidMembers});this.hd(function(Ma){return Object(eh.a)(ei.a,Ma)&&Ma.getShapeTextFormat().Font.ValidMembers===S.GYd})};Mf.Object.defineProperties(Ec.prototype,{eventId:{configurable:!0,
enumerable:!0,get:function(){return this.dfa}}});Object(Id.a)(Ec,"ShapeTextFontFormattedEventBase",Hb,[]);Rk(dc,Ec);Object(Id.a)(dc,"ShapeTextBoldedEvent",Ec,[]);var fi=b(1166);Rk(Cd,Hb);Cd.prototype.Xb=function(){this.Nb(581)};Cd.prototype.ig=function(){this.hd(function(S){return Object(eh.a)(fi.a,S)})};Mf.Object.defineProperties(Cd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 191}}});Object(Id.a)(Cd,"ShapeTextChangedEvent",Hb,[]);Rk(hd,Ec);Object(Id.a)(hd,"ShapeTextFontColorChangedEvent",
Ec,[]);Rk(xc,Ec);Object(Id.a)(xc,"ShapeTextFontNameChangedEvent",Ec,[]);Rk(mc,Ec);Object(Id.a)(mc,"ShapeTextFontSizeChangedEvent",Ec,[]);Rk(Lb,Hb);Lb.prototype.Xb=function(){this.Nb(581)};Lb.prototype.ig=function(){this.hd(function(S){return Object(eh.a)(ei.a,S)&&2===S.getShapeTextFormat().ValidMembers})};Mf.Object.defineProperties(Lb.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 199}}});Object(Id.a)(Lb,"ShapeTextHorizontallyAlignedEvent",Hb,[]);Rk(Ja,Ec);Object(Id.a)(Ja,
"ShapeTextItalicizedEvent",Ec,[]);Rk(gf,Ec);Object(Id.a)(gf,"ShapeTextUnderlinedEvent",Ec,[]);Rk(Ne,Hb);Ne.prototype.Xb=function(){this.Nb(581)};Ne.prototype.ig=function(){this.hd(function(S){return Object(eh.a)(ei.a,S)&&1===S.getShapeTextFormat().ValidMembers})};Mf.Object.defineProperties(Ne.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 200}}});Object(Id.a)(Ne,"ShapeTextVerticallyAlignedEvent",Hb,[]);Rk(Ae,Hb);Ae.prototype.Xb=function(){this.Nb(138)};Mf.Object.defineProperties(Ae.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 13}}});Object(Id.a)(Ae,"SheetAddedEvent",Hb,[]);var sg=b(8);Rk(od,Hb);od.prototype.Xb=function(){this.Nb(237)};od.prototype.ig=function(){this.hd(function(S){return!!S.insertDeleteMultiRangeParameters});this.hd(function(S){return!S.insertDeleteMultiRangeParameters.IsTableCommand});this.hd(function(S){S=S.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0];return 0>S.DeltaColumn&&!S.DeltaRow&&(!!S.InsertDeleteRange.FirstRow||S.InsertDeleteRange.LastRow!==
sg.a.Tx)||!S.DeltaColumn&&0>S.DeltaRow&&(!!S.InsertDeleteRange.FirstColumn||S.InsertDeleteRange.LastColumn!==sg.a.Wu)})};Mf.Object.defineProperties(od.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 142}}});Object(Id.a)(od,"SheetCellsDeletedEvent",Hb,[]);Rk(Gd,Hb);Gd.prototype.Xb=function(){this.Nb(237)};Gd.prototype.ig=function(){this.hd(function(S){return!!S.insertDeleteMultiRangeParameters});this.hd(function(S){return!S.insertDeleteMultiRangeParameters.IsTableCommand});
this.hd(function(S){S=S.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0];return 0<S.DeltaColumn&&!S.DeltaRow&&(!!S.InsertDeleteRange.FirstRow||S.InsertDeleteRange.LastRow!==sg.a.Tx)||!S.DeltaColumn&&0<S.DeltaRow&&(!!S.InsertDeleteRange.FirstColumn||S.InsertDeleteRange.LastColumn!==sg.a.Wu)})};Mf.Object.defineProperties(Gd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 143}}});Object(Id.a)(Gd,"SheetCellsInsertedEvent",Hb,[]);Rk(ud,Hb);ud.prototype.Xb=function(){this.Nb(237)};
ud.prototype.ig=function(){this.hd(function(S){return!!S.insertDeleteMultiRangeParameters});this.hd(function(S){return!S.insertDeleteMultiRangeParameters.IsTableCommand});this.hd(function(S){return 0>S.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});this.hd(function(S){return!S.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow});this.hd(function(S){return!S.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstRow});this.hd(function(S){return S.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastRow===
sg.a.Tx})};Mf.Object.defineProperties(ud.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 139}}});Object(Id.a)(ud,"SheetColumnDeletedEvent",Hb,[]);Rk(vc,Hb);vc.prototype.Xb=function(){this.Nb(237)};vc.prototype.ig=function(){this.hd(function(S){return!!S.insertDeleteMultiRangeParameters});this.hd(function(S){return!S.insertDeleteMultiRangeParameters.IsTableCommand});this.hd(function(S){return 0<S.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});this.hd(function(S){return!S.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow});
this.hd(function(S){return!S.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstRow});this.hd(function(S){return S.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastRow===sg.a.Tx})};Mf.Object.defineProperties(vc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 138}}});Object(Id.a)(vc,"SheetColumnInsertedEvent",Hb,[]);Rk(zc,Hb);zc.prototype.Xb=function(){this.Nb(137)};Mf.Object.defineProperties(zc.prototype,{eventId:{configurable:!0,
enumerable:!0,get:function(){return 14}}});Object(Id.a)(zc,"SheetDeletedEvent",Hb,[]);Rk(Ub,Hb);Ub.prototype.Xb=function(){this.Nb(185)};Mf.Object.defineProperties(Ub.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 137}}});Object(Id.a)(Ub,"SheetDirectionChangedEvent",Hb,[]);Rk(lb,Hb);lb.prototype.Xb=function(){this.Nb(139)};Mf.Object.defineProperties(lb.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 54}}});Object(Id.a)(lb,"SheetDuplicatedEvent",Hb,
[]);Rk(h,Hb);h.prototype.Xb=function(){this.Nb(207)};Mf.Object.defineProperties(h.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 15}}});Object(Id.a)(h,"SheetNameEditedEvent",Hb,[]);Rk(Ya,Hb);Ya.prototype.Xb=function(){this.Nb(151)};Mf.Object.defineProperties(Ya.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 90}}});Object(Id.a)(Ya,"SheetPaneFrozenEvent",Hb,[]);Rk(we,Hb);we.prototype.Xb=function(){this.Nb(226)};Mf.Object.defineProperties(we.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 120}}});Object(Id.a)(we,"SheetPrintSettingsSavedEvent",Hb,[]);var Th=b(1067);Rk($e,Hb);$e.prototype.Xb=function(){this.Nb(507)};$e.prototype.Uva=function(){this.uke("Microsoft.Office.Excel.SheetProtectionMacroRecording")};$e.prototype.ig=function(){this.hd(function(S){return Object.getType(S)===Th.a})};Mf.Object.defineProperties($e.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 215}}});Object(Id.a)($e,"SheetProtectionPausedResumedEvent",
Hb,[]);Rk(me,Hb);me.prototype.Xb=function(){this.Nb(557)};Mf.Object.defineProperties(me.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 64}}});Object(Id.a)(me,"SheetReorderedEvent",Hb,[]);Rk(nf,Hb);nf.prototype.Xb=function(){this.Nb(237)};nf.prototype.ig=function(){this.hd(function(S){return!!S.insertDeleteMultiRangeParameters});this.hd(function(S){return!S.insertDeleteMultiRangeParameters.IsTableCommand});this.hd(function(S){return!S.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});
this.hd(function(S){return 0>S.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow});this.hd(function(S){return!S.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstColumn});this.hd(function(S){return S.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastColumn===sg.a.Wu})};Mf.Object.defineProperties(nf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 141}}});Object(Id.a)(nf,"SheetRowDeletedEvent",Hb,
[]);Rk(lf,Hb);lf.prototype.Xb=function(){this.Nb(237)};lf.prototype.ig=function(){this.hd(function(S){return!!S.insertDeleteMultiRangeParameters});this.hd(function(S){return!S.insertDeleteMultiRangeParameters.IsTableCommand});this.hd(function(S){return!S.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});this.hd(function(S){return 0<S.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow});this.hd(function(S){return!S.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstColumn});
this.hd(function(S){return S.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastColumn===sg.a.Wu})};Mf.Object.defineProperties(lf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 140}}});Object(Id.a)(lf,"SheetRowInsertedEvent",Hb,[]);Rk(Ke,Hb);Ke.prototype.Xb=function(){this.Nb(135)};Mf.Object.defineProperties(Ke.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 39}}});Object(Id.a)(Ke,"SheetRowsColumnsAutoFitEvent",Hb,[]);
Rk(je,Hb);je.prototype.Xb=function(){this.Nb(136)};Mf.Object.defineProperties(je.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 36}}});Object(Id.a)(je,"SheetRowsColumnsResizedEvent",Hb,[]);Rk(Zd,Hb);Zd.prototype.Xb=function(){this.Nb(183)};Mf.Object.defineProperties(Zd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 68}}});Object(Id.a)(Zd,"SheetShowGridlinesToggledEvent",Hb,[]);Rk(dd,Hb);dd.prototype.Xb=function(){this.Nb(184)};Mf.Object.defineProperties(dd.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 67}}});Object(Id.a)(dd,"SheetShowHeadingsToggledEvent",Hb,[]);Rk(le,Hb);le.prototype.Xb=function(){this.Nb(213)};Mf.Object.defineProperties(le.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 89}}});Object(Id.a)(le,"SheetSpellCheckedEvent",Hb,[]);Rk(Od,Hb);Od.prototype.Xb=function(){this.Nb(515)};Mf.Object.defineProperties(Od.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 70}}});Object(Id.a)(Od,
"SheetTabColoredEvent",Hb,[]);Rk(bd,Hb);bd.prototype.Xb=function(){this.Nb(157)};Mf.Object.defineProperties(bd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 71}}});Object(Id.a)(bd,"SheetVisibilityChangedEvent",Hb,[]);Rk(md,Hb);md.prototype.Xb=function(){this.Nb(239)};Mf.Object.defineProperties(md.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 126}}});Object(Id.a)(md,"SheetsVisibilityChangedEvent",Hb,[]);Rk(Pc,Hb);Pc.prototype.Xb=function(){this.Nb(203)};
Mf.Object.defineProperties(Pc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 188}}});Object(Id.a)(Pc,"SlicerInsertedEvent",Hb,[]);Rk(lc,Hb);lc.prototype.Xb=function(){this.Nb(173)};lc.prototype.ig=function(){this.hd(function(S){return!S.clearFilter})};Mf.Object.defineProperties(lc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 189}}});Object(Id.a)(lc,"SlicerSelectionAppliedEvent",Hb,[]);Rk(De,Hb);De.prototype.Xb=function(){this.Nb(173)};De.prototype.ig=
function(){this.hd(function(S){return S.clearFilter})};Mf.Object.defineProperties(De.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 190}}});Object(Id.a)(De,"SlicerSelectionClearedEvent",Hb,[]);Rk(Pd,Hb);Pd.prototype.Xb=function(){this.Nb(208)};Pd.prototype.ig=function(){this.hd(function(S){return S.getParameters().FilterType===Yf.U9a})};Mf.Object.defineProperties(Pd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 27}}});Object(Id.a)(Pd,"TableCheckedItemsFilteredEvent",
Hb,[]);Rk(sd,Hb);sd.prototype.Xb=function(){this.Nb(237)};sd.prototype.ig=function(){this.hd(function(S){return!!S.insertDeleteMultiRangeParameters});this.hd(function(S){return S.insertDeleteMultiRangeParameters.IsTableCommand});this.hd(function(S){return 0>S.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});this.hd(function(S){return!S.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow})};Mf.Object.defineProperties(sd.prototype,{eventId:{configurable:!0,enumerable:!0,
get:function(){return 144}}});Object(Id.a)(sd,"TableColumnDeletedEvent",Hb,[]);Rk(zd,Hb);zd.prototype.Xb=function(){this.Nb(237)};zd.prototype.ig=function(){this.hd(function(S){return!!S.insertDeleteMultiRangeParameters});this.hd(function(S){return S.insertDeleteMultiRangeParameters.IsTableCommand});this.hd(function(S){return 0<S.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});this.hd(function(S){return!S.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow})};
Mf.Object.defineProperties(zd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 145}}});Object(Id.a)(zd,"TableColumnInsertedEvent",Hb,[]);var $i=b(1165);Rk(Jc,Hb);Jc.prototype.Xb=function(){this.Nb(141)};Jc.prototype.ig=function(){this.hd(function(S){return Object(eh.a)($i.a,S)})};Mf.Object.defineProperties(Jc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 121}}});Object(Id.a)(Jc,"TableColumnSortedEvent",Hb,[]);Rk(ic,Hb);ic.prototype.Xb=function(){this.Nb(193)};
Mf.Object.defineProperties(ic.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 105}}});Object(Id.a)(ic,"TableConvertedToRangeEvent",Hb,[]);Rk(Hd,Hb);Hd.prototype.Xb=function(){this.Nb(206)};Mf.Object.defineProperties(Hd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 16}}});Object(Id.a)(Hd,"TableCreatedEvent",Hb,[]);Rk(rd,Hb);rd.prototype.Xb=function(){this.Nb(209)};rd.prototype.ig=function(){this.hd(function(S){return S.getParameters().FilterType===
Yf.U9a})};Mf.Object.defineProperties(rd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 30}}});Object(Id.a)(rd,"TableCustomFilteredEvent",Hb,[]);Rk(Mc,Hb);Mc.prototype.Xb=function(){this.Nb(187)};Mc.prototype.ig=function(){this.hd(function(S){return 1===S.options.OperationType})};Mf.Object.defineProperties(Mc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 25}}});Object(Id.a)(Mc,"TableCustomSortedEvent",Hb,[]);Rk(bc,Hb);bc.prototype.Xb=function(){this.Nb(176)};
bc.prototype.ig=function(){this.hd(function(S){return S.TU().AutoFilterType===Yf.U9a});this.hd(function(S){return 0===S.TU().CriteriaType})};Mf.Object.defineProperties(bc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 28}}});Object(Id.a)(bc,"TableFilterClearedEvent",Hb,[]);Rk(cc,Hb);cc.prototype.Xb=function(){this.Nb(176)};cc.prototype.ig=function(){this.hd(function(S){return S.TU().AutoFilterType===Yf.U9a});this.hd(function(S){var Ma=new df.a;Ma.add(1);Ma.add(2);Ma.add(8);
Ma.add(9);Ma.add(10);Ma.add(11);Ma.add(12);Ma.add(13);Ma.add(14);Ma.add(15);Ma.add(16);Ma.add(17);Ma.add(18);Ma.add(19);Ma.add(20);Ma.add(21);Ma.add(22);Ma.add(23);Ma.add(24);Ma.add(25);Ma.add(26);Ma.add(27);Ma.add(28);Ma.add(29);Ma.add(30);Ma.add(31);Ma.add(32);Ma.add(33);Ma.add(34);Ma.add(35);Ma.add(36);Ma.add(37);Ma.add(38);Ma.add(39);return Ma.contains(S.TU().CriteriaType)})};Mf.Object.defineProperties(cc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 32}}});Object(Id.a)(cc,
"TableItemFilteredEvent",Hb,[]);Rk(Qb,Hb);Qb.prototype.Xb=function(){this.Nb(217)};Mf.Object.defineProperties(Qb.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 101}}});Object(Id.a)(Qb,"TableRenamedEvent",Hb,[]);Rk(Fa,Hb);Fa.prototype.Xb=function(){this.Nb(211)};Mf.Object.defineProperties(Fa.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 73}}});Object(Id.a)(Fa,"TableResizedEvent",Hb,[]);Rk(Tb,Hb);Tb.prototype.Xb=function(){this.Nb(514)};Mf.Object.defineProperties(Tb.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 44}}});Object(Id.a)(Tb,"TableRowColumnRearrangedEvent",Hb,[]);Rk(td,Hb);td.prototype.Xb=function(){this.Nb(237)};td.prototype.ig=function(){this.hd(function(S){return!!S.insertDeleteMultiRangeParameters});this.hd(function(S){return S.insertDeleteMultiRangeParameters.IsTableCommand});this.hd(function(S){return!S.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});this.hd(function(S){return 0>S.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow})};
Mf.Object.defineProperties(td.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 146}}});Object(Id.a)(td,"TableRowDeletedEvent",Hb,[]);Rk(Tc,Hb);Tc.prototype.Xb=function(){this.Nb(237)};Tc.prototype.ig=function(){this.hd(function(S){return!!S.insertDeleteMultiRangeParameters});this.hd(function(S){return S.insertDeleteMultiRangeParameters.IsTableCommand});this.hd(function(S){return!S.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});this.hd(function(S){return 0<
S.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow})};Mf.Object.defineProperties(Tc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 147}}});Object(Id.a)(Tc,"TableRowInsertedEvent",Hb,[]);Rk(fd,Hb);fd.prototype.Xb=function(){this.Nb(177)};fd.prototype.ig=function(){this.hd(function(S){return S.TU().AutoFilterType===Yf.U9a})};Mf.Object.defineProperties(fd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 26}}});Object(Id.a)(fd,"TableSortedEvent",
Hb,[]);Rk(Wc,Hb);Wc.prototype.Xb=function(){this.Nb(212)};Mf.Object.defineProperties(Wc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 87}}});Object(Id.a)(Wc,"TableStyleAppliedEvent",Hb,[]);Rk(jc,Hb);jc.prototype.Xb=function(){this.Nb(196)};Mf.Object.defineProperties(jc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 88}}});Object(Id.a)(jc,"TableStyleOptionToggledEvent",Hb,[]);Rk(Xb,Hb);Xb.prototype.Xb=function(){this.Nb(210)};Xb.prototype.ig=function(){this.hd(function(S){return S.getParameters().FilterType===
Yf.U9a})};Mf.Object.defineProperties(Xb.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 31}}});Object(Id.a)(Xb,"TableTop10FilteredEvent",Hb,[]);Rk(hb,Hb);hb.prototype.Xb=function(){this.Nb(238)};Mf.Object.defineProperties(hb.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 207}}});Object(Id.a)(hb,"TextToColumnsEvent",Hb,[]);Rk(Sb,Hb);Sb.prototype.Xb=function(){this.Nb(559)};Mf.Object.defineProperties(Sb.prototype,{eventId:{configurable:!0,enumerable:!0,
get:function(){return 128}}});Object(Id.a)(Sb,"ValuesSortedEvent",Hb,[]);Rk(Da,Hb);Da.prototype.Xb=function(){this.Nb(197)};Mf.Object.defineProperties(Da.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 55}}});Object(Id.a)(Da,"WorkbookCalculationModeSetEvent",Hb,[]);Rk(nc,Hb);nc.prototype.Xb=function(){this.Nb(181)};nc.prototype.ig=function(){this.hd(function(S){return!!S.parentCommentId})};Mf.Object.defineProperties(nc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 34}}});
Object(Id.a)(nc,"WorkbookCommentRepliedEvent",Hb,[]);Rk(Pe,Hb);Pe.prototype.Xb=function(){this.Nb(181)};Pe.prototype.ig=function(){this.hd(function(S){return!S.parentCommentId})};Mf.Object.defineProperties(Pe.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 33}}});Object(Id.a)(Pe,"WorkbookCommentedEvent",Hb,[]);Rk(cf,Hb);cf.prototype.Xb=function(){this.Nb(128)};Mf.Object.defineProperties(cf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 56}}});Object(Id.a)(cf,
"WorkbookRecalculatedEvent",Hb,[]);Rk(ke,Hb);ke.prototype.Xb=function(){this.Nb(171)};Mf.Object.defineProperties(ke.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 46}}});Object(Id.a)(ke,"WorkbookRedoEvent",Hb,[]);Rk(bf,Hb);bf.prototype.Xb=function(){this.Nb(170)};Mf.Object.defineProperties(bf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 45}}});Object(Id.a)(bf,"WorkbookUndoEvent",Hb,[]);Rk(Wd,Hb);Wd.prototype.Xb=function(){this.Nb(507);this.Nb(576);
this.Nb(10)};Wd.prototype.ig=function(){this.hd(function(S){if(Object(eh.a)(Pg,S)&&(S=Object(rg.a)(Pg,S),void 0!==S.source&&null!==S.source&&void 0!==S.eventId&&null!==S.eventId))return ae.ULS.sendTraceTag(537155426,0,50,"[RichApiRecorder]: received a valid but unhandled event: source: {0}; eventId: {1}.",S.source,S.eventId),!0;ae.ULS.sendTraceTag(537155425,0,50,"[RichApiRecorder]: an invalid event was ignored.");return!1})};Mf.Object.defineProperties(Wd.prototype,{eventId:{configurable:!0,enumerable:!0,
get:function(){return 116}}});Object(Id.a)(Wd,"DefaultRichApiRequestExecutedEvent",Hb,[]);Rk(pe,Hb);pe.prototype.Xb=function(){this.Nb(1022)};Mf.Object.defineProperties(pe.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 216}}});Object(Id.a)(pe,"TablelAltTextEditedEvent",Hb,[]);Rk(Yd,Hb);Yd.prototype.Xb=function(){this.Nb(263)};Mf.Object.defineProperties(Yd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 217}}});Object(Id.a)(Yd,"FloatingObjectZOrderChangedEvent",
Hb,[]);ad.prototype.BZe=function(S,Ma){var Gb=this.CZe(S,this.macroRecorderEvents,Ma);Gb||(Gb=this.CZe(S,ad.K_h(),Ma),!Gb&&this.Cdf(S,ad.HFe,Ma)&&(Gb=ad.HFe));return Gb};ad.prototype.CZe=function(S,Ma,Gb){var hc=new df.a;Ma=bk(Ma);for(var Yc=Ma.next();!Yc.done;Yc=Ma.next())Yc=Yc.value,this.Cdf(S,Yc,Gb)&&hc.add(Yc);return 1===hc.count?hc.na(0):1<hc.count?ad.nIh(hc):null};ad.prototype.Cdf=function(S,Ma,Gb){var hc=ad.JUi(S,Ma);return Gb?hc&&ad.bVj(S,Ma):hc};ad.prototype.x9i=function(){for(var S=new df.a,
Ma=bk(this.wb),Gb=Ma.next();!Gb.done;Gb=Ma.next()){Gb=Gb.value;for(var hc=!1,Yc=bk(Gb.featureGates),ed=Yc.next();!ed.done;ed=Yc.next())if(!ef.EwaSettings.ma(ed.value)){S.add(Gb);hc=!0;break}if(!hc)for(hc=bk(Gb.fRe),Yc=hc.next();!Yc.done;Yc=hc.next())if(!ef.EwaSettings.getBooleanFeatureGate(Yc.value,!1)){S.add(Gb);break}}S=bk(S);for(Ma=S.next();!Ma.done;Ma=S.next())this.wb.remove(Ma.value)};ad.K_h=function(){ad.lCb||(ad.lCb=new df.a,ad.lCb.add(new Gg),ad.lCb.add(new ag));return ad.lCb};ad.JUi=function(S,
Ma){return Ma.operations.contains(S.operation)};ad.bVj=function(S,Ma){var Gb=Ma.bCc;if(!Gb.count)return!0;Ma=!0;Gb=bk(Gb);for(var hc=Gb.next();!hc.done;hc=Gb.next())if(hc=hc.value,!hc(S.payload)){Ma=!1;break}return Ma};ad.nIh=function(S){var Ma=S.na(0);S=bk(S);for(var Gb=S.next();!Gb.done;Gb=S.next())Gb=Gb.value,Gb.bCc.count>Ma.bCc.count&&(Ma=Gb);return Ma};Mf.Object.defineProperties(ad.prototype,{macroRecorderEvents:{configurable:!0,enumerable:!0,get:function(){this.wb||(this.wb=new df.a,this.wb.add(new Vc),
this.wb.add(new Cg),this.wb.add(new Rg),this.wb.add(new Rf),this.wb.add(new wd),this.wb.add(new We),this.wb.add(new He),this.wb.add(new ce),this.wb.add(new de),this.wb.add(new qe),this.wb.add(new oe),this.wb.add(new re),this.wb.add(new Ae),this.wb.add(new zc),this.wb.add(new h),this.wb.add(new Hd),this.wb.add(new sd),this.wb.add(new zd),this.wb.add(new td),this.wb.add(new Tc),this.wb.add(new vc),this.wb.add(new ud),this.wb.add(new lf),this.wb.add(new nf),this.wb.add(new Mc),this.wb.add(new fd),this.wb.add(new Pd),
this.wb.add(new bc),this.wb.add(new Of),this.wb.add(new rd),this.wb.add(new Xb),this.wb.add(new cc),this.wb.add(new Pe),this.wb.add(new nc),this.wb.add(new Je),this.wb.add(new je),this.wb.add(new od),this.wb.add(new Gd),this.wb.add(new Ke),this.wb.add(new Ge),this.wb.add(new Eb),this.wb.add(new Wb),this.wb.add(new yd),this.wb.add(new Tb),this.wb.add(new ke),this.wb.add(new bf),this.wb.add(new qc),this.wb.add(new bh),this.wb.add(new uf),this.wb.add(new mf),this.wb.add(new lb),this.wb.add(new Da),this.wb.add(new cf),
this.wb.add(new Pf),this.wb.add(new gc),this.wb.add(new cd),this.wb.add(new Lc),this.wb.add(new Vd),this.wb.add(new nd),this.wb.add(new Pa),this.wb.add(new me),this.wb.add(new W),this.wb.add(new Zg),this.wb.add(new dd),this.wb.add(new Zd),this.wb.add(new ue),this.wb.add(new bd),this.wb.add(new Od),this.wb.add(new Fa),this.wb.add(new Ad),this.wb.add(new qg),this.wb.add(new la),this.wb.add(new ge),this.wb.add(new wh),this.wb.add(new lh),this.wb.add(new Ra),this.wb.add(new Ih),this.wb.add(new Ca),this.wb.add(new L),
this.wb.add(new mb),this.wb.add(new ug),this.wb.add(new Sa),this.wb.add(new Wc),this.wb.add(new jc),this.wb.add(new le),this.wb.add(new Ya),this.wb.add(new Bb),this.wb.add(new gb),this.wb.add(new Hg),this.wb.add(new Qg),this.wb.add(new xh),this.wb.add(new Uf),this.wb.add(new jd),this.wb.add(new yc),this.wb.add(new kg),this.wb.add(new Nh),this.wb.add(new Qb),this.wb.add(new mg),this.wb.add(new Nc),this.wb.add(new ig),this.wb.add(new ic),this.wb.add(new Ee),this.wb.add(new Ze),this.wb.add(new ee),this.wb.add(new Xf),
this.wb.add(new Re),this.wb.add(new Nd),this.wb.add(new Bf),this.wb.add(new pf),this.wb.add(new vf),this.wb.add(new Qc),this.wb.add(new Uc),this.wb.add(new Ba),this.wb.add(new Rd),this.wb.add(new we),this.wb.add(new Jc),this.wb.add(new If),this.wb.add(new md),this.wb.add(new ah),this.wb.add(new Sb),this.wb.add(new Dh),this.wb.add(new Nb),this.wb.add(new zh),this.wb.add(new $g),this.wb.add(new Jb),this.wb.add(new sh),this.wb.add(new Ag),this.wb.add(new Ub),this.wb.add(new ch),this.wb.add(new fg),this.wb.add(new Ta),
this.wb.add(new Ah),this.wb.add(new bg),this.wb.add(new Wf),this.wb.add(new Lf),this.wb.add(new wf),this.wb.add(new Ff),this.wb.add(new Oa),this.wb.add(new dh),this.wb.add(new jh),this.wb.add(new fe),this.wb.add(new tc),this.wb.add(new Ld),this.wb.add(new ng),this.wb.add(new Af),this.wb.add(new lg),this.wb.add(new kh),this.wb.add(new Dd),this.wb.add(new Ue),this.wb.add(new Sd),this.wb.add(new Fe),this.wb.add(new $a),this.wb.add(new Tg),this.wb.add(new nh),this.wb.add(new Sc),this.wb.add(new wc),this.wb.add(new $b),
this.wb.add(new Sg),this.wb.add(new pg),this.wb.add(new th),this.wb.add(new ze),this.wb.add(new Ce),this.wb.add(new Zf),this.wb.add(new yf),this.wb.add(new Ug),this.wb.add(new Pc),this.wb.add(new lc),this.wb.add(new De),this.wb.add(new Cd),this.wb.add(new dc),this.wb.add(new Ja),this.wb.add(new gf),this.wb.add(new hd),this.wb.add(new xc),this.wb.add(new mc),this.wb.add(new Lb),this.wb.add(new Ne),this.wb.add(new ye),this.wb.add(new Bg),this.wb.add(new hb),this.wb.add(new $e),this.wb.add(new pe),this.wb.add(new Yd),
ef.EwaSettings.isChangeGateEnabled("OfficeVSO:4825267_RemoveDisabledEvents")&&this.x9i());return this.wb}}});ad.lCb=null;ad.HFe=new Wd;Object(Id.a)(ad,"MacroRecorderEventList",null,[]);var yj=Ve.a;Rk(Jd,yj);Jd.prototype.create=function(){this.pb(this.$.da.za(297)||new Xc(this.$,new ad(this.$),new he))};Jd.ka=function(S){S.da.Ga(298,new Jd(S))};Object(Id.a)(Jd,"MacroRecorderEventHandlerFactory",Ve.a,[]);var zj=b(1345),aj=b(1443),Vg=b(7);b(622);qd.prototype.wSh=function(S){ae.ULS.sendTraceTag(17306645,
220,50,"Context menu id: {0}",S);for(var Ma=new df.a,Gb=bk(this.$0b),hc=Gb.next();!hc.done;hc=Gb.next()){hc=bk(hc.value.ADb);for(var Yc=hc.next();!Yc.done;Yc=hc.next())Yc=Yc.value,Yc.id===S&&Ma.add(Yc)}return Ma};qd.prototype.hke=function(S){this.$0b.add(S)};qd.prototype.s9i=function(S){for(var Ma=bk(this.$0b),Gb=Ma.next();!Gb.done;Gb=Ma.next())if(Gb=Gb.value,Gb.foe===S.foe){this.$0b.remove(Gb);break}};qd.Reh=function(S,Ma,Gb){Gb=void 0===Gb?null:Gb;S=qd.NKh(S);0<S.length&&(qd.vvc(S,!1),Gb&&Gb(Ma,
S))};qd.NKh=function(S){var Ma=[];if(S&&S.ADb&&0<S.ADb.count){S=bk(S.ADb);for(var Gb=S.next();!Gb.done;Gb=S.next())if(Gb=Gb.value,Gb.controls&&0<Gb.controls.count){Gb=bk(Gb.controls);for(var hc=Gb.next();!hc.done;hc=Gb.next())if(hc=hc.value,hc.menuItems&&0<hc.menuItems.count){hc=bk(hc.menuItems);for(var Yc=hc.next();!Yc.done;Yc=hc.next())Array.add(Ma,Yc.value.id)}}}return Ma};qd.vvc=function(S,Ma){if(S.length){var Gb=[];S=bk(S);for(var hc=S.next();!hc.done;hc=S.next())Gb.push(appChrome.actions.updateControlEnabledDisabledState(hc.value,
Ma));appChrome.api.dispatch(Gb)}};Mf.Object.defineProperties(qd.prototype,{$0b:{configurable:!0,enumerable:!0,get:function(){return this.ilg}}});Object(Id.a)(qd,"ContextMenuExtensibilityCache",null,[197,198]);var bj=b(1666),Dg=b(84),hf=b(4),cj=b(1074),ni=b(1020);Bc.prototype.dYa=function(S,Ma){Ma=void 0===Ma?null:Ma;if(S=ni.a.T2a(S)){appChrome.addInApi.dispatchActionsToInstallAddIn(S,Ma);Ma=bk(S.tabs);for(var Gb=Ma.next();!Gb.done;Gb=Ma.next())if(Gb.value.autoFocus){appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(S,
function(){});break}}};Bc.prototype.THd=function(S){(S=ni.a.T2a(S))&&appChrome.addInApi.dispatchActionsToRemoveAddIn(S)};Bc.Zeh=function(S,Ma,Gb){Gb=void 0===Gb?null:Gb;S=Bc.xVh(S);0<S.length&&(Bc.vvc(S,!1),Gb&&Gb(Ma,S))};Bc.xVh=function(S){var Ma=[];if(S&&(S=S.QV,S.Bs&&0<S.Bs.count)){S=bk(S.Bs);for(var Gb=S.next();!Gb.done;Gb=S.next())if(Gb=Gb.value,Gb.groups&&0<Gb.groups.length){Gb=bk(Gb.groups);for(var hc=Gb.next();!hc.done;hc=Gb.next())if(hc=hc.value,hc.controls&&0<hc.controls.length){hc=bk(hc.controls);
for(var Yc=hc.next();!Yc.done;Yc=hc.next())Array.add(Ma,Yc.value.id)}}}return Ma};Bc.vvc=function(S){if(S.length){var Ma=[];S=bk(S);for(var Gb=S.next();!Gb.done;Gb=S.next())Ma.push(appChrome.actions.updateControlEnabledDisabledState(Gb.value,!0));appChrome.api.dispatch(Ma)}};Object(Id.a)(Bc,"OneLineRibbonExtensibilityManager",null,[226]);var Uh=b(1144);Td.prototype.getTaskPaneControlIdFromAssetIdRuntimeId=function(S,Ma){return OfficeExt.DefaultControlActionBinder.getTaskPaneControlIdFromAssetIdRuntimeId(S,
Ma)};Td.prototype.Sgd=function(S,Ma,Gb,hc,Yc,ed,xd){ed=void 0===ed?null:ed;xd=void 0===xd?null:xd;ae.ULS.sendTraceTag(17138449,220,50,"Control id: {0}.",S);if((S=Ma.Eia(Yc.ownerAddinInfo.storeType,Yc.ownerAddinInfo.solutionId))&&S.qB&&!S.qB.getIsUpgrading())if(Ma=null,0<S.qB.getNotificationParams().length&&(Ma=this.Fte(S.qB.getNotificationParams()[0]))&&2147758681===Ma.errorCode&&(S.isUpgraded=!0),2!==S.qB.getStatus()&&(1!==S.qB.getStatus()||Ma&&2147758681===Ma.errorCode))Ma&&this.Q1f(S,Ma,xd);else try{Gb.setOwnerAddinEToken(S.qB.getEToken()),
Yc.action(Gb,hc.cma),ed&&ed()}catch(Ed){ae.ULS.sendTraceTag(17425949,220,10,String.format("HandleAddinCommandsAction error info : {0}.",hf.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.LogStackInfo")?Ed.stack:Ed.message)),Uh.a.EQd(CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive)}};Td.prototype.Q1f=function(S,Ma,Gb){var hc=this;Gb=void 0===Gb?null:Gb;var Yc=S.qB;if(1===Yc.getNotificationParams().length||Ma.Gdc){var ed=Ma.lha,xd=
Ma.bia;Ma.lha=function(){Yc.removeFirstNotification();if(0<Yc.getNotificationParams().length){var Ed=hc.Fte(Yc.getNotificationParams()[0]);hc.Q1f(S,Ed)}2147758681===Ma.errorCode&&(Bc.Zeh(S.to,Yc,Object(Dg.a)(hc,hc.h9e,"initUpgradeStateDetectTask")),qd.Reh(S.Fqb,Yc,Object(Dg.a)(hc,hc.h9e,"initUpgradeStateDetectTask")));ed&&ed()};Ma.bia=function(){xd&&xd();Gb&&Gb()};Uh.a.GQd(Ma)}};Td.prototype.h9e=function(S,Ma){var Gb=null;Gb=function(){S.getIsUpgrading()?window.setTimeout(Gb,1E3):S.getUpgradingFailed()?
Bc.vvc(Ma,!0):hf.AFrameworkApplication.ta.updateCommandUI()};window.setTimeout(Gb,1E3)};Td.prototype.Fte=function(S){var Ma=new cj.a;Ma.iLa=S.infoType;Ma.id=S.id;Ma.title=S.title;Ma.description=S.description;Ma.buttonText=S.buttonTxt;Ma.lha=S.buttonCallback;Ma.Gdc=S.highPriority;Ma.bia=S.dismissCallback;Ma.errorCode=S.errorCode;Ma.i8e=S.iframeNotificationUrl;return Ma};Mf.Object.defineProperties(Td.prototype,{Tie:{configurable:!0,enumerable:!0,get:function(){return this.BDc||(this.BDc=OfficeExt.DefaultControlActionBinder.retrieveActionContext)},
set:function(S){this.BDc=S}},HMg:{configurable:!0,enumerable:!0,get:function(){return this.a1d||(this.a1d=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap())}}});Object(Id.a)(Td,"AddinCommandsActionHandler",null,[205]);var fh=b(83),Ji=b(162),Rh=b(905),gh=b(5),Vh=b(948),hh=b(906);xe.prototype.oFh=function(S){if(void 0!==S&&null!==S&&S===gh.a.JAe)S="ContextMenuCell";else return null;var Ma=this.Va.Bc();this.HEh(Ma,S);return Ma};xe.prototype.HEh=function(S,Ma){Ma=this.G1g.wSh(Ma);
Ma=bk(Ma);for(var Gb=Ma.next();!Gb.done;Gb=Ma.next()){Gb=bk(Gb.value.controls);for(var hc=Gb.next();!hc.done;hc=Gb.next())this.uEh(S,hc.value)}};xe.prototype.uEh=function(S,Ma){var Gb=Ma.fU[Vh.a.id],hc=Ma.fU[Vh.a.cUa],Yc=Ma.fU[Vh.a.fUa],ed="Image16by16",xd=Ma.fU[Vh.a.dUa];hh.c(Yc)&&(ed="None");0<Ma.menuItems.count?(Gb=this.Va.Qv(Gb,Gb,hc,798637440),Gb.sKb(ed,Yc,null),this.mFh(Gb.menu,Ma),S.buttons.push(Gb)):S.buttons.push(this.Va.qHa(Gb,hc,xd,Yc,ed,null,!1))};xe.prototype.mFh=function(S,Ma){var Gb,
hc=this.Va.Bc();Ma=bk(Ma.menuItems);for(Gb=Ma.next();!Gb.done;Gb=Ma.next()){var Yc=Gb.value;Gb=Yc.hla[Vh.a.id];var ed=Yc.hla[Vh.a.cUa],xd=Yc.hla[Vh.a.fUa],Ed="Image16by16";Yc=Yc.hla[Vh.a.dUa];hh.c(xd)&&(Ed="None");Gb=this.Va.qHa(Gb,ed,Yc,xd,Ed,null,!1);hc.buttons.push(Gb)}S.pc.push(hc)};Object(Id.a)(xe,"AddInCommandsContextMenuExtensibilityHandler",null,[852]);var dj=b(1069);Object(Id.a)(af,"AddinStatusCommandValues",null,[]);rf.P1i=function(S){var Ma=new af;Ma.mi=S.yYa;Ma.visible=Ma.mi?!0:!1;return Ma};
rf.hxc=function(S,Ma,Gb,hc,Yc){var ed=document.getElementById(Gb);ed?rf.Ezj(S,Ma,ed,hc,Yc):ae.ULS.sendTraceTag(17662423,220,100,String.format("{0} element is not availiable",Gb))};rf.Ezj=function(S,Ma,Gb,hc,Yc){Gb?S.yYa===CommonUIStrings.l_ErrorLoadingAddInsTitle?Uh.a.ryj(Ma,Gb,hc,Yc):S.yYa===CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg&&Uh.a.Jzj(Ma,Gb):ae.ULS.sendTraceTag(543801756,220,100,String.format("addinLabelElement element is not available"))};Object(Id.a)(rf,"AddinCommandsStatusHandler",
null,[]);var ai=b(38),Aj=b(235),gg=b(15),Kh=ai.a;Rk(Le,Kh);Le.prototype.gq=function(S){this.addHandler("LAC",S)};Le.prototype.Eq=function(S){this.removeHandler("LAC",S)};Le.prototype.Ir=function(S,Ma){var Gb=this;if("QueryAddinLabel"!==S)return!1;Ma[dj.a.LabelText]!==this.EF.yYa&&(S=rf.P1i(this.EF),Ma[dj.a.LabelText]=S.mi,Ma[dj.a.Visible]=S.visible,window.setTimeout(function(){Gb.hxc()},0));return!0};Le.prototype.an=function(){return!0};Le.prototype.hxc=function(){this.$&&rf.hxc(this.EF,this.$.domElement,
this.AEj,gg.a.instance.ga(338),gg.a.instance.ga(339))};Le.prototype.dispose=function(){this.$.ea.wk(this.Uc);this.EF.A$i(this.M3e);this.agaveCommandManager&&(this.agaveCommandManager.Maj(this.Lxe),this.agaveCommandManager=null);this.statusBarManager&&(this.statusBarManager.wF(this),this.statusBarManager=null);this.EF=this.$=null;Kh.prototype.dispose.call(this)};Object(Id.a)(Le,"AddinCommandsStatusBarManager",ai.a,[472,303]);var Lh=b(1517),jf=b(931),tg=b(153),vg=b(124),Bj=b(635),ej=b(142);Se.prototype.setErrorMessageForAddin=
function(S,Ma){this.xYa||(this.xYa={});this.xYa[S]=Ma};Se.prototype.fNh=function(S){return this.xYa&&S in this.xYa?this.xYa[S]:null};Object(Id.a)(Se,"AddinCommandsErrorManager",null,[]);var Vf=b(345),Cj=b(97);Object(Id.a)(se,"AddinCommandsListLoaderContext",null,[]);var Ki=b(1026);Object(Id.a)(Ie,"AppsForOfficeEntitlementQueryInfo",null,[]);var Eh=b(41),fj=b(267),Bh=b(29);Object(Id.a)(Be,"AddinAbstract",null,[]);var ui=Sys.EventArgs;Rk(ve,ui);Object(Id.a)(ve,"InsertionParamEventArgs",Sys.EventArgs,
[]);Qd.prototype.G8b=function(S){var Ma=new Sys.StringBuilder(this.XIb);Ma.append("RoamingServiceHandler.ashx?action=");Ma.append("getAddinTeachingCalloutSettings");Ma.append("&");Ma.append(this.Yed(S));Ma.append("&");Ma.append(hf.AFrameworkApplication.Yi);hf.AFrameworkApplication.qd.Yl(Ma.toString(),1,null,null,!0,2,Object(Dg.a)(this,this.sja,"getRequestSuccessCallback"),Object(Dg.a)(this,this.d4,"getRequestFailureCallback"),null)};Qd.prototype.d2a=function(S){var Ma=new Sys.StringBuilder(this.XIb);
Ma.append("RoamingServiceHandler.ashx?action=");Ma.append("saveAddinTeachingCalloutSettings");Ma.append("&");Ma.append(hf.AFrameworkApplication.Yi);Ma=Ma.toString();S=Eh.c(S);hf.AFrameworkApplication.qd.Yl(Ma,2,S,null,!0,4,null,Object(Dg.a)(this,this.cW,"postRequestFailureCallback"),null)};Qd.prototype.sja=function(S){var Ma=!1,Gb=null;try{if(0<S.data.Td.length){var hc=Object(rg.a)(Object,Eh.a(S.data.Td)),Yc=hc?hc[this.appName]:null;Yc&&(Gb=Object(rg.a)(Object,Eh.a(Yc.toString())))}Ma=!0}catch(ed){this.d4(null)}Ma&&
this.sib&&this.sib(Gb)};Qd.prototype.d4=function(S){this.oib&&this.oib(S?S.data:null)};Qd.prototype.cW=function(S){this.wkb&&this.wkb(S?S.data:null)};Qd.prototype.Yed=function(S){for(var Ma=new Sys.StringBuilder("requestedsettings="),Gb=0;Gb<S.count;Gb++)Ma.append(S.na(Gb)),Gb<S.count-1&&Ma.append(";");return Ma.toString()};Object(Id.a)(Qd,"AddinTeachingUIRoamingRequestHandler",null,[]);var vi=Sys.EventArgs;Rk(Kd,vi);Object(Id.a)(Kd,"ShowTeachingCalloutForContentAddinEventArgs",Sys.EventArgs,[]);
var og=b(355);rb.prototype.S8f=function(S){if(!S)return null;var Ma=new df.a;S=bk(S);for(var Gb=S.next();!Gb.done;Gb=S.next())Ma.add(Gb.value);return Ma};rb.prototype.BTc=function(S,Ma){window.addEventListener?(this.Oj=S,this.AYa=Ma,window.addEventListener("LaunchAddinTaskpane",Object(Dg.a)(this,this.Qzd,"onLaunchButtonClickedEventHandler"),!0),window.addEventListener("DismissCallout",Object(Dg.a)(this,this.Vyd,"onDismissButtonClickedEventHandler"),!0),window.addEventListener("CloseCallout",Object(Dg.a)(this,
this.Kyd,"onCloseButtonClickedEventHandler"),!0),hf.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)&&window.addEventListener("FGWebSurfaceEvent",Object(Dg.a)(this,this.NDb,"onCampaignLaunchedHandler"),!0)):ae.ULS.sendTraceTag(525112601,220,15,"AddEventListenerForTeachingCallout failed to get Window")};rb.prototype.OLj=function(S,Ma,Gb,hc){this.Qh=S;this.HFa=Ma;this.wAe=Gb;this.uma=hc;ae.ULS.sendTraceTag(0,220,50,"Calls into TriggerTeachingCallout with addin entitlements: command addins: {0}, content addins: {1}",
Ma?Ma.count.toString():"null",Gb?Gb.count.toString():"null");this.HFa?(S=new df.a,S.add(this.appName),this.pnb.G8b(S)):this.uma(new df.a,null)};rb.prototype.Qzd=function(){var S=this,Ma=new fj.ScriptSharpLegacyMap;this.AYa&&this.AYa.tabs&&!this.AYa.tabs[0].isOfficeTab&&Ma.ia("SDX.FeatureFlags","NonOfficeTab");this.Ska(rb.tZ(this.Oj),"ClickOnLaunch",Ma);hf.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)&&this.cla();this.AYa?appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(this.AYa,
function(){var Gb=new ve;Gb.Oj=S.Oj;S.Pa.raiseEvent(jf.a.Xrd,Gb)}):ae.ULS.sendTraceTag(525112602,220,10,"onLaunchButtonClickedEventHandler failed to get a valid addinObj")};rb.prototype.Kyd=function(){this.Ska(rb.tZ(this.Oj),"ClickOnClose");hf.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)&&this.cla()};rb.prototype.Vyd=function(){this.Ska(rb.tZ(this.Oj),"ClickOnDismiss");hf.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",
!1)&&this.cla()};rb.prototype.NDb=function(S){if(S&&(S=S.detail)&&S.id&&this.Sld(S.id)){var Ma=(S.action||"").toLowerCase();if(S.success&&"opened"===Ma)this.Ska(rb.tZ(this.Oj),"CampaignLaunched"),ae.ULS.sendTraceTag(523355483,220,50,"CD addin UI has been launched. Attempting to save roaming."),this.cla(),window.removeEventListener&&window.removeEventListener("FGWebSurfaceEvent",Object(Dg.a)(this,this.NDb,"onCampaignLaunchedHandler"),!0);else try{var Gb=JSON.stringify(S);ae.ULS.sendTraceTag(523321995,
220,15,"Campaign launch failure. Event:"+Gb)}catch(hc){Gb="id : "+S.id+" telemetryEventName: "+S.telemetryEventName,ae.ULS.sendTraceTag(523321996,220,50,"Error serializing campaign event. "+Gb+" Error: "+(hc?hc.toString():""))}}};rb.prototype.Sld=function(S){S=Bh.a.al(S);return-1!==S.indexOf("d7f1cbbb-3631-4cae-bc2d-177774aa1190")||-1!==S.indexOf("7f5167e4-54e6-4353-a9d7-686741f379b7")||-1!==S.indexOf("cbb7eaa0-6e95-422d-9647-2be7d2737d4a")||-1!==S.indexOf("f210940e-28e4-4d7c-90dd-0093db1f7df3")||
-1!==S.indexOf("d30cc3b5-1c10-414f-9390-b59949be99f8")||-1!==S.indexOf("912b80fb-c00f-4c89-ab73-2e14c3511993")};rb.prototype.h0=function(S){if(this.appName){var Ma={},Gb={};Gb.LastTeachingUIShowTime=(new Date).toUTCString();Gb.AddinHasShown=S;Ma[this.appName]=Eh.c(Gb);this.pnb.d2a(Ma);ae.ULS.sendTraceTag(539530527,220,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")}else ae.ULS.sendTraceTag(539530528,220,10,"Fail to save roaming service since AppName is null")};
rb.prototype.cla=function(){if(!this.sQa){var S=window.g_roamingAddinList;S&&(this.h0(S),this.sQa=!0)}};rb.prototype.sja=function(S){S?this.uQd(S)?(ae.ULS.sendTraceTag(527523845,220,50,"should show teaching UI"),this.cI="AddinHasShown"in S&&S.AddinHasShown?S.AddinHasShown.toString():null,this.rqb()):(ae.ULS.sendTraceTag(538248466,220,50,"Not Show TeachingUI this time"),this.uma(this.HFa,null)):(ae.ULS.sendTraceTag(527523844,220,50,"userSettings is null"),this.cI=null,this.rqb())};rb.prototype.d4=
function(S){ae.ULS.sendTraceTag(539530529,220,10,"GET data from Roaming Settings Service with status: {0}, fallback",S?S.httpStatus:-1);this.uma(this.HFa,null)};rb.prototype.cW=function(S){ae.ULS.sendTraceTag(539530530,220,10,"failed to POST data to Roaming Settings Service with status: {0}",S?S.httpStatus:-1)};rb.prototype.rqb=function(){var S=this.o5c();if(0===S.targetType){S.solutionId?this.XEd(S):this.Ska(S.addinId,"NoSolutionId");if(S.addinId){var Ma=this.cI?this.cI+","+S.addinId:S.addinId;hf.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",
!1)?window.g_roamingAddinList=Ma:this.h0(Ma)}this.uma(this.HFa,null)}else this.uma(this.HFa,S);ae.ULS.sendTraceTag(528023563,220,50,"Show teaching callout for: {0}",S.addinId)};rb.prototype.XEd=function(S){var Ma=this,Gb=new Ie;Gb.callbackFunc=function(hc){if(hc.errorCode)Ma.Ska(S.solutionId,"FailToGetAppDetails"),hf.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)&&(hc=window.g_roamingAddinList)&&Ma.h0(hc);else if(hc.value){var Yc=bk(hc.value);
for(hc=Yc.next();!hc.done;hc=Yc.next()){hc=hc.value;var ed=hc[1];if(ed===S.solutionId){Yc={solutionId:ed};Yc.assetId=hc[5];ed=hf.AFrameworkApplication.fa.isChangeGateEnabled("QueryEntitlementDetailsStoreTypeFixEnabled");Yc.storeType=ed?hc[12]:hc[6];hf.AFrameworkApplication.fa.isChangeGateEnabled("StoreIdFixEnabled")?Yc.storeId=S.storeId:Yc.storeId=hc[11];Yc.assetStoreId=hc[6];Yc.targetType=hc[3];Yc.width=hc[7];Yc.height=hc[8];Yc.displayName=hc[0];Yc.version=hc[4];ae.ULS.sendTraceTag(0,220,50,"Raise a teaching callout event for content addin: {0}.",
S.solutionId);hc=new Kd(Yc);Ma.Pa.raiseEvent(jf.a.KQd,hc);break}}}};Gb.storeType=OSF.StoreTypeEnum.PrivateCatalog;Gb.fromInsertDialog=!1;Gb.refresh=!1;this.Qh.queryEntitlementDetails(Gb)};rb.prototype.uQd=function(S){if("LastTeachingUIShowTime"in S){if(S=+new Date-+new Date(S.LastTeachingUIShowTime.toString()),S<hf.AFrameworkApplication.fa.zM("AddinShowTeachingUIIntervalInMS",864E5))return ae.ULS.sendTraceTag(538248467,220,50,"ShouldShowTeachingUI: False, Teaching callout is shown {0}MS ago",S),!1}else ae.ULS.sendTraceTag(527523846,
220,50,"userSetting has no date key");return!0};rb.prototype.o5c=function(){for(var S=new Vf.a(new Be,0),Ma=new Vf.a(new Be,0),Gb=0,hc=0,Yc=0,ed=new df.a,xd=bk(this.HFa),Ed=xd.next();!Ed.done;Ed=xd.next())ed.add(Ed.value);xd=bk(this.wAe);for(Ed=xd.next();!Ed.done;Ed=xd.next())ed.add(Ed.value);ed=bk(ed);for(Ed=ed.next();!Ed.done;Ed=ed.next())if(Ed=Ed.value,!("excatalog"!==Ed.storeType||hh.c(Ed.installTimeInMS)||!Ed.installTimeInMS||Ed.installTimeInMS<=hf.AFrameworkApplication.fa.zM("DateTimeInMSForNewAddin",
16409952E5))){xd=rb.tub(Ed);if(this.cI){var Xd=this.cI.split(",");if(0<Xd.length&&Array.contains(Xd,xd)){Yc++;ae.ULS.sendTraceTag(528345032,220,50,"This addin has shown teaching UI before");continue}}xd.startsWith("private_")?(S.value<Ed.installTimeInMS&&(S=new Vf.a(Object.assign(new Be,{addinId:xd,targetType:Ed.targetType,storeId:Ed.storeId,solutionId:Ed.solutionId}),Ed.installTimeInMS)),hc++):(Ma.value<Ed.installTimeInMS&&(Ma=new Vf.a(Object.assign(new Be,{addinId:xd,targetType:Ed.targetType,storeId:Ed.storeId,
solutionId:Ed.solutionId}),Ed.installTimeInMS)),Gb++)}ae.ULS.sendTraceTag(528345033,220,50,"Number of New CD addins for this user: Private:{0}, Store:{1}. Addin has shown teachingUI:{2}",hc,Gb,Yc);return 0<Ma.value?Ma.key:0<S.value?S.key:Object.assign(new Be,{addinId:null,targetType:-1,solutionId:null,storeId:null})};rb.prototype.Ska=function(S,Ma,Gb){Gb=void 0===Gb?null:Gb;var hc={};S=(hc.AppTeachingUICalloutAction=Ma,hc["SDX.Id"]=S,hc.AppTeachingUICalloutGoal="NewAdminDeployment",hc["SDX.AppInstallOrigin"]=
"Organization",hc);if(Gb)for(Ma=bk(Gb.keys),hc=Ma.next();!hc.done;hc=Ma.next())hc=hc.value,S[hc]=Gb.na(hc);tg.a.sendTelemetryEvent(Object.assign(new og.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:vg.a.Uk(S)}))};rb.prototype.Umi=function(S,Ma){return Ma&&Ma.addinId?Ma.addinId===rb.tub(S):!1};rb.prototype.uSj=function(S){S=this.cI?this.cI+","+S.addinId:S.addinId;hf.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)?window.g_roamingAddinList=
S:this.h0(S)};rb.tZ=function(S){return Telemetry.PrivacyRules.GetPrivacyCompliantId(S.solutionId,S.storeType,S.assetId,null,null,S.storeId)};rb.tub=function(S){return Telemetry.PrivacyRules.IsPrivateAddin(S.storeType,S.assetId,null,null,S.storeId)?"private_"+S.installTimeInMS:S.solutionId};Mf.Object.defineProperties(rb.prototype,{appName:{configurable:!0,enumerable:!0,get:function(){return hf.AFrameworkApplication.fa.Wa("WebAppShortName")}},pnb:{configurable:!0,enumerable:!0,get:function(){this.rX||
(this.rX=new Qd(this.appName,Object(Dg.a)(this,this.sja,"getRequestSuccessCallback"),Object(Dg.a)(this,this.d4,"getRequestFailureCallback"),Object(Dg.a)(this,this.cW,"postRequestFailureCallback")));return this.rX}},HFa:{configurable:!0,enumerable:!0,get:function(){this.iQb||(this.iQb=new df.a);return this.iQb},set:function(S){this.iQb=S}},wAe:{configurable:!0,enumerable:!0,get:function(){this.kRb||(this.kRb=new df.a);return this.kRb},set:function(S){this.kRb=S}}});Object(Id.a)(rb,"PrivateCatalogTeachingCalloutHandler2",
null,[]);var wi=b(81),Dj=b(893);Gc.prototype.get_current=function(){if(!this.vr)throw Error.argumentOutOfRange();return this.vr.data};Gc.prototype.moveNext=function(){if(!this.vr)return this.vr=this.eA,!!this.eA;if(!this.vr.next)return!1;this.vr=this.vr.next;return!0};Gc.prototype.blc=function(){if(!this.vr)return this.vr=this.eA,!!this.eA;if(!this.vr.previous)return!1;this.vr=this.vr.previous;return!0};Gc.prototype.reset=function(){this.vr=this.eA};Object(Id.a)(Gc,"ListEnumerator",null,[0]);Object(Id.a)(oc,
"ListNode",null,[]);Dc.prototype.add=function(S){this.Vp?this.mA=this.mA.next=new oc(S,this.mA,null):this.Vp=this.mA=new oc(S,null,null);this._count=this.count+1};Dc.prototype.insert=function(S,Ma){if(S>this.count||0>S)throw Error.argumentOutOfRange("pos");if(S===this.count)this.add(Ma);else{for(var Gb=this.Vp;0!==S--;)Gb=Gb.next;S=new oc(Ma,Gb.previous,Gb);S.previous?S.previous.next=S:this.Vp=S;S.next?S.next.previous=S:this.mA=S;this._count=this.count+1}};Dc.prototype.remove=function(S){for(var Ma=
this.Vp;Ma&&Ma.data!==S;)Ma=Ma.next;if(!Ma)return!1;Ma.previous?Ma.previous.next=Ma.next:this.Vp=Ma.next;Ma.next?Ma.next.previous=Ma.previous:this.mA=Ma.previous;this._count=this.count-1;return!0};Dc.prototype.clear=function(){var S=this.Vp;for(this.mA=this.Vp=null;S;){var Ma=S.next;S.previous=null;S.next=null;S=Ma}this._count=0};Dc.prototype.indexOf=function(S){for(var Ma=this.Vp,Gb=0;Ma&&Ma.data!==S;)Ma=Ma.next,Gb++;return Ma?Gb:-1};Dc.prototype.na=function(S){return this.at(S).data};Dc.prototype.getEnumerator=
function(){return new Gc(this.Vp)};Dc.prototype[Symbol.iterator]=function(){return Object(Dj.a)(this.getEnumerator())};Dc.prototype.Gac=function(S){S=this.at(S);return new Gc(S)};Dc.prototype.toArray=function(){for(var S=Array(this.count),Ma=0,Gb=bk(this),hc=Gb.next();!hc.done;hc=Gb.next())S[Ma]=hc.value,Ma++;return S};Dc.prototype.at=function(S){for(var Ma=this.Vp,Gb=0;Gb!==S;){if(!Ma)throw Error.argumentOutOfRange("pos");Ma=Ma.next;Gb++}return Ma};Mf.Object.defineProperties(Dc.prototype,{count:{configurable:!0,
enumerable:!0,get:function(){return this._count}}});Object(Id.a)(Dc,"List",null,[1]);var Li=Sys.EventArgs;Rk(pc,Li);Object(Id.a)(pc,"AddinCommandsEntitlementsRetrievedEventArgs",Sys.EventArgs,[]);Object(Id.a)(nb,"MiniAddinInfo",null,[]);sc.prototype.iDg=function(S){this.Pa.addHandler(jf.a.lnb,S)};sc.prototype.CGg=function(S){this.Pa.addHandler(jf.a.KQd,S)};sc.prototype.fNj=function(S){var Ma=this;null!==S&&(this.context.sR=S[jf.a.H9],this.context.Rr=S[jf.a.mP],this.context.Ozc=this.context.jqc=0,
S=jf.a.JFa in S?S[jf.a.JFa]:0,-1!==this.context.sR&&0!==this.context.Rr&&(this.context.t2=new Dc,this.context.Uia=new Dc,this.context.Aqb=new Dc,this.context.UUc=this.fHg.createAddinDataProvider(gd(this.context.sR),this.contextActivationMgr),this.context.UUc?this.context.UUc.getEntitlementsAsync(this.contextActivationMgr.cma,!0,S,function(Gb){Ma.BNi(Gb)}):ae.ULS.sendTraceTag(17638145,220,10,"Create AddinDataProvider fails for {0}",this.context.sR)))};sc.prototype.BNi=function(S){var Ma=this;if(S&&
0<S.length){this.context.Ozc=S.length;for(var Gb=0;Gb<S.length;Gb++){var hc=S[Gb];if(!hc||1!==hc.targetType&&-1!==hc.targetType)this.gyd();else{var Yc={};Yc.marketplaceId=hc.solutionId;Yc.marketplaceVersion=hc.version;Yc.storeType=hc.storeType;Yc.storeId=hc.storeId;Yc.targetData=hc;this.contextActivationMgr.isAddinCommandsAsync(Yc,function(ed,xd,Ed){ed?(xd&&Ma.context.t2.add(Ed.targetData),10===Ma.context.sR&&(ed=Ed.targetData,xd=ed.targetType,hf.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.PropertiesForTeachingUIOfPrivateCatelogEnabled",
!1)&&!hh.c(Ed.targetTypeForExp)&&(xd=Ed.targetTypeForExp,ed.targetType=xd),Ma.context.Uia.add(ed),0===xd&&Ma.context.Aqb.add(ed))):(Ed=Ed.targetData,ae.ULS.sendTraceTag(542978528,220,15,"Checking AddinCommands fails for {0} from {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(Ed.solutionId,Ed.storeType,Ed.assetId,null,null,Ed.storeId),Ed.storeType));Ma.gyd()})}}}else this.gyd()};sc.prototype.gyd=function(){var S=this,Ma;(Ma=this.context).jqc=Ma.jqc+1;if(this.context.jqc>=this.context.Ozc)if(this.LZb.eXf(this.context.sR,
!1),0<this.context.Ozc&&10===this.context.sR&&("Excel"===this.appName||"PowerPoint"===this.appName||"Word"===this.appName))if(Ma=!1,hf.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:5996085_EmailAlertAutolaunchOnWacEnabled")&&Fd()&&(Ma=this.Sti()),this.fti(),hf.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",!1)&&!Ma)if(sc.D7f){Ma=this.UAa.S8f(this.context.t2);var Gb=this.UAa.S8f(this.context.Aqb);this.UAa.OLj(this.contextActivationMgr,
Ma,Gb,function(hc,Yc){var ed=new df.a;hc=bk(hc);for(var xd=hc.next();!xd.done;xd=hc.next()){xd=xd.value;var Ed=Cc(xd);Yc&&S.UAa.Umi(xd,Yc)&&(Ed.showCallout=!0,S.UAa.uSj(Yc));ed.add(Ed)}S.uma(ed)})}else this.cHh(this.context.t2);else this.IYb(this.context.t2);else this.IYb(this.context.t2)};sc.prototype.IYb=function(S){if(sc.D7f)this.uma(this.c0g(S));else{var Ma=new df.a;if(S){S=bk(this.context.t2);for(var Gb=S.next();!Gb.done;Gb=S.next())Ma.add(Cc(Gb.value))}this.context.t2&&1>this.context.t2.count&&
Ki.a.zeb(jf.a.mnb,"false",this.context.sR);S={};Ma=(S.ack2=Ma,S);Ma[jf.a.H9]=this.context.sR;Ma[jf.a.mP]=this.context.Rr;this.Pa.raiseEvent(jf.a.lnb,new pc(Ma),this)}};sc.prototype.c0g=function(S){var Ma=new df.a;if(S){S=bk(S);for(var Gb=S.next();!Gb.done;Gb=S.next())Ma.add(Cc(Gb.value))}return Ma};sc.prototype.uma=function(S){S&&S.count||Ki.a.zeb(jf.a.mnb,"false",this.context.sR);var Ma={};S=(Ma.ack2=S,Ma);S[jf.a.H9]=this.context.sR;S[jf.a.mP]=this.context.Rr;this.Pa.raiseEvent(jf.a.lnb,new pc(S),
this)};sc.prototype.h0=function(S){if(this.appName){var Ma={},Gb={};Gb.LastTeachingUIShowTime=(new Date).toUTCString();Gb.AddinHasShown=S;Ma[this.appName]=Eh.c(Gb);this.rX&&(this.rX.d2a(Ma),ae.ULS.sendTraceTag(539530527,306,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service"))}else ae.ULS.sendTraceTag(539530528,306,10,"Fail to save roaming service since AppName is null")};sc.prototype.cHh=function(S){if(this.IFa=S)S=new df.a,S.add(this.appName),
this.rX=new Qd(this.appName,Object(Dg.a)(this,this.sja,"getRequestSuccessCallback"),Object(Dg.a)(this,this.d4,"getRequestFailureCallback"),Object(Dg.a)(this,this.cW,"postRequestFailureCallback")),this.rX.G8b(S);else{S=new df.a;var Ma={};S=(Ma.ack2=S,Ma);S[jf.a.H9]=this.context.sR;S[jf.a.mP]=this.context.Rr;this.Pa.raiseEvent(jf.a.lnb,new pc(S),this)}};sc.prototype.sja=function(S){S?this.uQd(S)?(ae.ULS.sendTraceTag(527523845,306,50,"should show teaching UI"),this.cI="AddinHasShown"in S&&S.AddinHasShown?
S.AddinHasShown.toString():null,this.rqb()):(ae.ULS.sendTraceTag(538248466,306,50,"Not Show TeachingUI this time"),this.IYb(this.IFa)):(ae.ULS.sendTraceTag(527523844,306,50,"userSettings is null"),this.cI=null,this.rqb())};sc.prototype.d4=function(S){ae.ULS.sendTraceTag(539530529,306,10,"GET data from Roaming Settings Service with status: {0}, fallback",S?S.httpStatus:-1);this.IYb(this.IFa)};sc.prototype.cW=function(S){ae.ULS.sendTraceTag(539530530,306,10,"failed to POST data to Roaming Settings Service with status: {0}",
S?S.httpStatus:-1)};sc.prototype.rqb=function(){var S=this.o5c();if(0===S.targetType){S.solutionId?(this.kSd=S.solutionId,this.N5f=S.storeId,this.XEd()):this.Ska("NoSolutionId");if(S.addinId){var Ma=this.cI?this.cI+","+S.addinId:S.addinId;hf.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)?window.g_roamingAddinList=Ma:this.h0(Ma)}this.Fke(null)}else this.Fke(S.addinId);ae.ULS.sendTraceTag(528023563,306,50,"Show teaching callout for: {0}",S.addinId)};
sc.prototype.XEd=function(){var S=this,Ma=new Ie;Ma.callbackFunc=function(Gb){if(Gb.errorCode)S.Ska("FailToGetAppDetails"),hf.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)&&(Gb=window.g_roamingAddinList)&&S.h0(Gb);else if(Gb.value){var hc=bk(Gb.value);for(Gb=hc.next();!Gb.done;Gb=hc.next()){Gb=Gb.value;var Yc=Gb[1];if(Yc===S.kSd){hc={solutionId:Yc};hc.assetId=Gb[5];Yc=hf.AFrameworkApplication.fa.isChangeGateEnabled("QueryEntitlementDetailsStoreTypeFixEnabled");
hc.storeType=Yc?Gb[12]:Gb[6];hf.AFrameworkApplication.fa.isChangeGateEnabled("StoreIdFixEnabled")?hc.storeId=S.N5f:hc.storeId=Gb[11];hc.assetStoreId=Gb[6];hc.targetType=Gb[3];hc.width=Gb[7];hc.height=Gb[8];hc.displayName=Gb[0];hc.version=Gb[4];Gb=new Kd(hc);S.Pa.raiseEvent(jf.a.KQd,Gb);break}}}};Ma.storeType=OSF.StoreTypeEnum.PrivateCatalog;Ma.fromInsertDialog=!1;Ma.refresh=!1;this.contextActivationMgr.queryEntitlementDetails(Ma)};sc.prototype.uQd=function(S){if("LastTeachingUIShowTime"in S){if(S=
+new Date-+new Date(S.LastTeachingUIShowTime.toString()),S<hf.AFrameworkApplication.fa.zM("AddinShowTeachingUIIntervalInMS",864E5))return ae.ULS.sendTraceTag(538248467,306,50,"ShouldShowTeachingUI: False, Teaching callout is shown {0}MS ago",S),!1}else ae.ULS.sendTraceTag(527523846,306,50,"userSetting has no date key");return!0};sc.prototype.o5c=function(){var S=new Vf.a(new nb,0),Ma=new Vf.a(new nb,0),Gb=0,hc=0,Yc=0,ed=new Dc;if(0<this.context.t2.count)for(var xd=bk(this.context.t2),Ed=xd.next();!Ed.done;Ed=
xd.next())ed.add(Ed.value);if(0<this.context.Aqb.count)for(xd=bk(this.context.Aqb),Ed=xd.next();!Ed.done;Ed=xd.next())ed.add(Ed.value);ed=bk(ed);for(Ed=ed.next();!Ed.done;Ed=ed.next())if(Ed=Ed.value,!("excatalog"!==Ed.storeType||hh.c(Ed.installTimeInMS)||!Ed.installTimeInMS||Ed.installTimeInMS<=hf.AFrameworkApplication.fa.zM("DateTimeInMSForNewAddin",16409952E5))){xd=sc.tub(Ed);if(this.cI){var Xd=this.cI.split(",");if(0<Xd.length&&Array.contains(Xd,xd)){Yc++;ae.ULS.sendTraceTag(528345032,306,50,"This addin has shown teaching UI before");
continue}}xd.startsWith("private_")?(S.value<Ed.installTimeInMS&&(S=new Vf.a(Object.assign(new nb,{addinId:xd,targetType:Ed.targetType,storeId:Ed.storeId,solutionId:Ed.solutionId}),Ed.installTimeInMS)),hc++):(Ma.value<Ed.installTimeInMS&&(Ma=new Vf.a(Object.assign(new nb,{addinId:xd,targetType:Ed.targetType,storeId:Ed.storeId,solutionId:Ed.solutionId}),Ed.installTimeInMS)),Gb++)}ae.ULS.sendTraceTag(528345033,306,50,"Number of New CD addins for this user: Private:{0}, Store:{1}. Addin has shown teachingUI:{2}",
hc,Gb,Yc);return 0<Ma.value?Ma.key:0<S.value?S.key:Object.assign(new nb,{addinId:null,targetType:-1,solutionId:null,storeId:null})};sc.prototype.Fke=function(S){for(var Ma=new df.a,Gb=bk(this.IFa),hc=Gb.next();!hc.done;hc=Gb.next()){var Yc=hc.value;hc=Cc(Yc);S&&(Yc=sc.tub(Yc),S===Yc&&(hc.showCallout=!0,Yc=this.cI?this.cI+","+S:S,hf.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)?window.g_roamingAddinList=Yc:this.h0(Yc)));Ma.add(hc)}this.IFa&&
1>this.IFa.count&&Ki.a.zeb(jf.a.mnb,"false",this.context.sR);S={};Ma=(S.ack2=Ma,S);Ma[jf.a.H9]=this.context.sR;Ma[jf.a.mP]=this.context.Rr;this.Pa.raiseEvent(jf.a.lnb,new pc(Ma),this)};sc.prototype.Sti=function(){var S=!1;if(this.context.Uia&&1>this.context.Uia.count)return S;var Ma=kd();if(!Ma)return S;for(var Gb=bk(this.context.Uia),hc=Gb.next();!hc.done;hc=Gb.next())if(hc=hc.value,hc.storeId&&hc.storeId.toLowerCase()===Ma.toLowerCase()||hc.assetId&&hc.assetId.toLowerCase()===Ma.toLowerCase()){S=
sc.tZ(hc);var Yc={};hc=(Yc.SDX_Id=S,Yc.SDX_TargetType=hh.c(hc.targetType)?"":hc.targetType.toString(),Yc);tg.a.sendTelemetryEvent(Object.assign(new og.a,{name:"Office.Extensibility.Host.EmailAlertNotification",dataFields:vg.a.Uk(hc)}));S=!0}return S};sc.prototype.fti=function(){if(!(this.context.Uia&&1>this.context.Uia.count))if(this.LZb.Nii()){var S=this.LZb.OTh();S?(S=this.cXe(this.context.Uia,S),ae.ULS.sendTraceTag(527523848,306,50,"detect new addins using localStorage")):(S=this.cXe(this.context.Uia,
null),ae.ULS.sendTraceTag(527523847,306,50,"no data from cache"));this.LZb.rrj(S)}else ae.ULS.sendTraceTag(528589915,306,50,"Local storage got disabled")};sc.prototype.cXe=function(S,Ma){var Gb={},hc=!1;S=bk(S);for(var Yc=S.next();!Yc.done;Yc=S.next()){Yc=Yc.value;var ed=sc.tZ(Yc);ed&&(!Ma||ed in Ma||(this.sxa(Yc,ed),ae.ULS.sendTraceTag(527523849,306,50,"New addin detected,log to AppInstall")),"private"===ed.toLowerCase()?hc||(hc=!0,Gb[ed]=null):Gb[ed]=null)}return Gb};sc.prototype.sxa=function(S,
Ma){var Gb=S.installTimeInMS?(new Date(S.installTimeInMS)).toISOString():"",hc={};Gb=(hc["SDX.Id"]=Ma,hc["SDX.AppInstallOrigin"]="Organization",hc["SDX.TargetType"]=hh.c(S.targetType)?"":S.targetType.toString(),hc["SDX.AdminDeploymentTime"]=Gb,hc);tg.a.sendTelemetryEvent(Object.assign(new og.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:vg.a.Uk(Gb)}));1===S.targetType&&(S={},Ma=(S["SDX.Id"]=Ma,S["SDX.AppInstallOrigin"]="Organization",S["SDX.CommandPlacement"]="Ribbon",S),tg.a.sendTelemetryEvent(Object.assign(new og.a,
{name:"Office.Extensibility.Host.AppPinning",dataFields:vg.a.Uk(Ma)})))};sc.prototype.Ska=function(S){var Ma={};S=(Ma.AppTeachingUICalloutAction=S,Ma["SDX.Id"]=this.kSd,Ma.AppTeachingUICalloutGoal="NewAdminDeployment",Ma["SDX.AppInstallOrigin"]="Organization",Ma);tg.a.sendTelemetryEvent(Object.assign(new og.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:vg.a.Uk(S)}))};sc.tZ=function(S){return Telemetry.PrivacyRules.GetPrivacyCompliantId(S.solutionId,S.storeType,S.assetId,null,
null,S.storeId)};sc.tub=function(S){return Telemetry.PrivacyRules.IsPrivateAddin(S.storeType,S.assetId,null,null,S.storeId)?"private_"+S.installTimeInMS:S.solutionId};Mf.Object.defineProperties(sc.prototype,{UAa:{configurable:!0,enumerable:!0,get:function(){this.iRc||(this.iRc=new rb(this.Pa));return this.iRc}}});Mf.Object.defineProperties(sc,{D7f:{configurable:!0,enumerable:!0,get:function(){return hf.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingCalloutRefactorEnabled",
!1)}}});Object(Id.a)(sc,"AddInCommandsListLoader",null,[]);Pb.prototype.insertOsfControl=function(S){return this.cma.insertOsfControl(S)};Pb.prototype.getManifestInvaildErrorString=function(){return this.cma.getManifestInvaildErrorString()};Pb.prototype.isAddinCommandsAsync=function(S,Ma){this.cma.isAddinCommandsAsync(S,Ma)};Pb.prototype.ownerAddinControlRecreated=function(S,Ma){this.cma.ownerAddinControlRecreated(S,Ma)};Pb.prototype.queryEntitlementDetails=function(S){this.cma.queryEntitlementDetails(S)};
Mf.Object.defineProperties(Pb.prototype,{cma:{configurable:!0,enumerable:!0,get:function(){return this.Ssg}}});Object(Id.a)(Pb,"ContextActivationMgrWrapper",null,[194]);uc.prototype.createAddinDataProvider=function(S,Ma){return OfficeExt.AddinDataProviderFactory.createAddinDataProvider(S,Ma.cma)};Mf.Object.defineProperties(uc,{instance:{configurable:!0,enumerable:!0,get:function(){uc.Ma||(uc.Ma=new uc);return uc.Ma}}});uc.Ma=null;Object(Id.a)(uc,"OSFAddinDataProviderFactory",null,[193]);Object(Id.a)(wb,
"CacheItem",null,[]);Fc.prototype.ll=function(S){var Ma=this.ODa.getItem(S);if(Ma){var Gb=new wb;try{Gb=Sys.Serialization.JavaScriptSerializer.deserialize(Ma,!0)}catch(hc){return this.ODa.removeItem(S),null}return Gb.Data?Gb.Data:Gb.data}return null};Fc.prototype.OPa=function(S){this.ODa.removeItem(S)};Object(Id.a)(Fc,"AppsDataCacheManager",null,[228]);var oi=b(1027);Rc.prototype.eXf=function(S,Ma){S=jf.a.eYe()+S;oi.a.instance.setItem(S,Ma.toString())};Rc.prototype.OTh=function(){var S=jf.a.b0e();
ae.ULS.sendTraceTag(527523850,306,50,"set cache key:{0}",S);S=oi.a.instance.getItem(S);return Eh.a(S)};Rc.prototype.rrj=function(S){var Ma=jf.a.b0e();ae.ULS.sendTraceTag(527523851,306,50,"get cache key:{0}",Ma);oi.a.instance.setItem(Ma,Eh.c(S))};Rc.prototype.Nii=function(){return!!oi.a.instance.localStorage};Mf.Object.defineProperties(Rc,{instance:{configurable:!0,enumerable:!0,get:function(){Rc.Ma||(Rc.Ma=new Rc);return Rc.Ma}}});Rc.Ma=null;Object(Id.a)(Rc,"AddInCommandsCacheManager",null,[201]);
Object(Id.a)(Ac,"PostLaunchAddinCommandsParameters",null,[]);ac.prototype.BTc=function(){window.addEventListener?(window.addEventListener("LaunchAddinTaskpane",Object(Dg.a)(this,this.Qzd,"onLaunchButtonClickedEventHandler"),!0),window.addEventListener("DismissCallout",Object(Dg.a)(this,this.Vyd,"onDismissButtonClickedEventHandler"),!0),window.addEventListener("CloseCallout",Object(Dg.a)(this,this.Kyd,"onCloseButtonClickedEventHandler"),!0),hf.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",
!1)&&window.addEventListener("FGWebSurfaceEvent",Object(Dg.a)(this,this.NDb,"onCampaignLaunchedHandler"),!0)):ae.ULS.sendTraceTag(525112601,220,15,"AddEventListenerForTeachingCallout failed to get Window")};ac.prototype.Qzd=function(){var S=this,Ma={};Ma=(Ma.AppTeachingUICalloutAction="ClickOnLaunch",Ma["SDX.Id"]=ac.tZ(this.Kib),Ma.AppTeachingUICalloutGoal="NewAdminDeployment",Ma["SDX.AppInstallOrigin"]="Organization",Ma);this.dgb&&this.dgb.tabs&&!this.dgb.tabs[0].isOfficeTab&&(Ma["SDX.FeatureFlags"]=
"NonOfficeTab");tg.a.sendTelemetryEvent(Object.assign(new og.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:vg.a.Uk(Ma)}));hf.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)&&this.cla();this.dgb?appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(this.dgb,function(){var Gb=new ve;Gb.Oj=S.Kib;S.$a.raiseEvent(jf.a.Xrd,Gb)}):ae.ULS.sendTraceTag(525112602,220,10,"onLaunchButtonClickedEventHandler failed to get a valid addinObj")};
ac.prototype.Kyd=function(){var S={};S=(S.AppTeachingUICalloutAction="ClickOnClose",S["SDX.Id"]=ac.tZ(this.Kib),S.AppTeachingUICalloutGoal="NewAdminDeployment",S["SDX.AppInstallOrigin"]="Organization",S);tg.a.sendTelemetryEvent(Object.assign(new og.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:vg.a.Uk(S)}));hf.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)&&this.cla()};ac.prototype.Vyd=function(){var S={};S=(S.AppTeachingUICalloutAction=
"ClickOnDismiss",S["SDX.Id"]=ac.tZ(this.Kib),S.AppTeachingUICalloutGoal="NewAdminDeployment",S["SDX.AppInstallOrigin"]="Organization",S);tg.a.sendTelemetryEvent(Object.assign(new og.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:vg.a.Uk(S)}));hf.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)&&this.cla()};ac.prototype.NDb=function(S){if(S&&(S=S.detail)&&S.id&&this.Sld(S.id)){var Ma=(S.action||"").toLowerCase();if(S.success&&
"opened"===Ma){var Gb={};Gb=(Gb.AppTeachingUICalloutAction="CampaignLaunched",Gb["SDX.Id"]=ac.tZ(this.Kib),Gb.AppTeachingUICalloutGoal="NewAdminDeployment",Gb["SDX.AppInstallOrigin"]="Organization",Gb);tg.a.sendTelemetryEvent(Object.assign(new og.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:vg.a.Uk(Gb)}));ae.ULS.sendTraceTag(523355483,220,50,"CD addin UI has been launched. Attempting to save roaming.");this.cla();window.removeEventListener&&window.removeEventListener("FGWebSurfaceEvent",
Object(Dg.a)(this,this.NDb,"onCampaignLaunchedHandler"),!0)}else try{Gb=JSON.stringify(S),ae.ULS.sendTraceTag(523321995,220,15,"Campaign launch failure. Event:"+Gb)}catch(hc){Gb="id : "+S.id+" telemetryEventName: "+S.telemetryEventName,ae.ULS.sendTraceTag(523321996,220,50,"Error serializing campaign event. "+Gb+" Error: "+(hc?hc.toString():""))}}};ac.prototype.Sld=function(S){S=Bh.a.al(S);return-1!==S.indexOf("d7f1cbbb-3631-4cae-bc2d-177774aa1190")||-1!==S.indexOf("7f5167e4-54e6-4353-a9d7-686741f379b7")||
-1!==S.indexOf("cbb7eaa0-6e95-422d-9647-2be7d2737d4a")||-1!==S.indexOf("f210940e-28e4-4d7c-90dd-0093db1f7df3")||-1!==S.indexOf("d30cc3b5-1c10-414f-9390-b59949be99f8")||-1!==S.indexOf("912b80fb-c00f-4c89-ab73-2e14c3511993")};ac.prototype.h0=function(S){var Ma=hf.AFrameworkApplication.fa.Wa("WebAppShortName");if(Ma){var Gb={},hc={};hc.LastTeachingUIShowTime=(new Date).toUTCString();hc.AddinHasShown=S;Gb[Ma]=Eh.c(hc);this.rX=new Qd(Ma,null,null,Object(Dg.a)(this,this.cW,"postRequestFailureCallback")),
this.rX.d2a(Gb),ae.ULS.sendTraceTag(523535564,220,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")}else ae.ULS.sendTraceTag(523535565,220,10,"Fail to save roaming service since AppName is null")};ac.prototype.cla=function(){if(!this.sQa){var S=window.g_roamingAddinList;S&&(this.h0(S),this.sQa=!0)}};ac.prototype.cW=function(S){ae.ULS.sendTraceTag(523535566,220,10,"failed to POST data to Roaming Settings Service with status: {0}",S?S.httpStatus:
-1)};ac.tZ=function(S){return Telemetry.PrivacyRules.GetPrivacyCompliantId(S.solutionId,S.storeType,S.assetId,null,null,S.storeId)};Object(Id.a)(ac,"PrivateCatalogTeachingCalloutHandler",null,[]);fb.prototype.dYa=function(S,Ma){this.l7d.dYa(S,void 0===Ma?null:Ma);this.r9d=S};fb.prototype.THd=function(S){this.l7d.THd(S)};Mf.Object.defineProperties(fb.prototype,{fxa:{configurable:!0,enumerable:!0,get:function(){return this.r9d}}});Object(Id.a)(fb,"RibbonExtensibilityManagerWithChangeDetection",null,
[226]);var bi=b(1073),Tj=b(100);tb.OYe=function(S){var Ma=new df.a;if(tb.Mze)for(var Gb=bk(tb.Mze),hc=Gb.next();!hc.done;hc=Gb.next())Ma.add(hc.value);hc=null;switch(S){case "Workbook":hc=tb.ZWj;break;case "Document":hc=tb.Mgh;break;case "Presentation":hc=tb.B_i}if(hc)for(S=bk(hc),hc=S.next();!hc.done;hc=S.next())Ma.add(hc.value);return Ma};tb.Mze=["PrimaryCommandSurface","ContextMenu"];tb.ZWj=null;tb.Mgh=null;tb.B_i=null;Object(Id.a)(tb,"ExtensionPointType",null,[]);Mf.Object.defineProperties(Va.prototype,
{ADb:{configurable:!0,enumerable:!0,get:function(){return this.nbe||(this.nbe=new df.a)}},foe:{configurable:!0,enumerable:!0,get:function(){return this.Njg}}});Object(Id.a)(Va,"ContextMenuExtensibility",null,[203]);Mf.Object.defineProperties(xb.prototype,{QV:{configurable:!0,enumerable:!0,get:function(){return this.Lsg}},startedNode:{configurable:!0,enumerable:!0,get:function(){return this.iwg}},nGh:{configurable:!0,enumerable:!0,get:function(){return this.tog}}});Object(Id.a)(xb,"RibbonExtensibility",
null,[251]);kc.prototype.createActionContext=function(S,Ma){S={};S.ownerAddinInfo=this.entitlement;S.action=Ma;return S};Mf.Object.defineProperties(kc.prototype,{entitlement:{configurable:!0,enumerable:!0,get:function(){return this.qng}}});Object(Id.a)(kc,"AddInCommandsContextProvider",null,[]);Rb.prototype.$4g=function(S){return new kc(S)};Rb.prototype.createActionBuilder=function(S,Ma){return OfficeExt.DefaultControlActionBinder.createActionBuilder(S,Ma.entitlement,Ma.manifest)};Rb.prototype.startApplyAddin=
function(S){this.v0d=S;var Ma=this.$4g(S);this.actionBuilder=this.createActionBuilder(Ma,S)};Rb.prototype.endApplyAddin=function(){};Rb.prototype.zbd=function(S,Ma,Gb){Gb=void 0===Gb?0:Gb;return this.ribbonBuilder.Bs&&0<this.ribbonBuilder.Bs.count?new xb(this.CFh(S,Ma),this.Dne.startedNode,Gb):null};Rb.prototype.EUe=function(){var S=void 0===S?null:S;if(this.contextMenuBuilder.Ikc&&0<this.contextMenuBuilder.Ikc.count){S||(S=this.Dne.entitlement.solutionId);S=new Va(S);for(var Ma=bk(this.contextMenuBuilder.Ikc),
Gb=Ma.next();!Gb.done;Gb=Ma.next())S.ADb.add(Gb.value);return S}return null};Rb.prototype.CFh=function(S,Ma){return this.ribbonBuilder.Bs&&0<this.ribbonBuilder.Bs.count?new ni.a(this.ribbonBuilder.Bs,S,Ma):null};Mf.Object.defineProperties(Rb.prototype,{Dne:{configurable:!0,enumerable:!0,get:function(){return this.v0d}}});Object(Id.a)(Rb,"AddinCommandsBuilder",null,[]);Ic.prototype.nBb=function(S,Ma,Gb,hc,Yc,ed,xd){function Ed(ff,of,Jf,kf){Yc(ff,of,Jf,kf);ff=bi.a[Xd.Rr]+of.assetId;Jf=Xd.mSa.yc(ff);
of=Jf.value;Jf.returnValue&&(of.stop(),Xd.mSa.remove(ff))}var Xd=this;if(0!==this.Rr&&S)for(ae.ULS.sendTraceTag(17326351,220,50,"Addin count {0}.",S.count),4===this.Rr&&(ae.ULS.sendTraceTag(17586256,220,100,String.format("Refresh AddinCommands for dataprovider : {0}",hc)),this.kXg(S,hc),ed()),S=bk(S),hc=S.next();!hc.done;hc=S.next())if(hc=hc.value,ae.ULS.sendTraceTag(17638144,220,50,String.format("{0}: Install addin {1}",this.Bo.LM,Telemetry.PrivacyRules.GetPrivacyCompliantId(hc.solutionId,hc.ownerAddinStoreType||
hc.storeType,hc.assetId,null,null,hc.storeId))),this.Ceg(hc))if(xd&&hc.requireConsent)xd(hc,function(ff){try{if(Xd.kO){var of=bi.a[Xd.Rr]+ff.solutionId,Jf=Xd.kO.sc("ComponentAttach",of);Xd.mSa.ia(of,Jf)}var kf=Xd.EF.Eia(ff.storeType,ff.solutionId);6!==Xd.Rr&&(kf&&(Xd.f2b(kf),kf.qB.purge(!1)),Xd.Qh.insertOsfControl(Xd.kGb(ff,Ma,Gb,Ed)),kf&&Xd.Qh.ownerAddinControlRecreated(ff.solutionId,ff.storeType))}catch(tf){ae.ULS.sendTraceTag(572839882,220,10,String.format("{0}: AddinCommands SolutionId={1} Version={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",
Xd.Bo.LM,Telemetry.PrivacyRules.GetPrivacyCompliantId(ff.solutionId,ff.ownerAddinStoreType||ff.storeType,ff.assetId,null,null,ff.storeId),ff.version,ff.storeType,ff.storeId,tf.message)),Ed(!1,ff,null,null)}});else try{if(this.kO){var Ud=bi.a[this.Rr]+hc.solutionId,ne=this.kO.sc("ComponentAttach",Ud);this.mSa.ia(Ud,ne)}var Qe=this.EF.Eia(hc.storeType,hc.solutionId);6!==this.Rr&&(Qe&&(this.f2b(Qe),Qe.qB.purge(!1)),this.Qh.insertOsfControl(this.kGb(hc,Ma,Gb,Ed)),Qe&&this.Qh.ownerAddinControlRecreated(hc.solutionId,
hc.storeType))}catch(ff){ae.ULS.sendTraceTag(17388185,220,10,String.format("{0}: AddinCommands SolutionId={1} AppVersion={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",this.Bo.LM,Telemetry.PrivacyRules.GetPrivacyCompliantId(hc.solutionId,hc.ownerAddinStoreType||hc.storeType,hc.assetId,null,null,hc.storeId),hc.version,hc.storeType,hc.storeId,ff.message)),Ed(!1,hc,null,null)}else Ed(!1,hc,null,null)};Ic.prototype.vqi=function(S,Ma,Gb,hc,Yc,ed){function xd(Qe,ff,of,Jf){ed(Qe,
ff,of,Jf);Qe=bi.a[Ed.Rr]+ff.solutionId;of=Ed.mSa.yc(Qe);ff=of.value;of.returnValue&&(ff.stop(),Ed.mSa.remove(Qe))}var Ed=this;if(6===this.Rr&&S)if(ae.ULS.sendTraceTag(592290762,220,50,String.format("{0}: Install dynamic ribbon {1}",this.Bo.LM,Telemetry.PrivacyRules.GetPrivacyCompliantId(S.solutionId,S.ownerAddinStoreType||S.storeType,S.assetId,null,null,S.storeId))),this.Ceg(S))try{if(this.kO){var Xd=bi.a[this.Rr]+S.solutionId,Ud=this.kO.sc("ComponentAttach",Xd);this.mSa.ia(Xd,Ud)}var ne=this.EF.Eia(S.storeType,
S.solutionId);ne||xd(!1,S,null,null);hf.AFrameworkApplication.ta&&hf.AFrameworkApplication.ta.Qa.delayInstallAddInIsEnabled?this.bVe(S,Ma,hc,Yc,Gb,function(Qe){xd(Qe,S,Gb,ne.displayName)}):(this.bVe(S,Ma,hc,Yc,Gb),xd(!0,S,Gb,ne.displayName))}catch(Qe){ae.ULS.sendTraceTag(592290764,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to launch dynamic commands. Error message : {5}.",this.Bo.LM,Telemetry.PrivacyRules.GetPrivacyCompliantId(S.solutionId,
S.ownerAddinStoreType||S.storeType,S.assetId,null,null,S.storeId),S.version,S.storeType,S.storeId,Qe.message)),xd(!1,S,null,null)}else xd(!1,S,null,null)};Ic.prototype.pFi=function(S,Ma,Gb,hc,Yc,ed){if(ed)if(ed._isAddinCommandsManifest(this.Bo.LM))try{hf.AFrameworkApplication.ta&&hf.AFrameworkApplication.ta.Qa.delayInstallAddInIsEnabled?this.aVe(S,Ma,Gb,Yc,ed,function(xd){hc(xd,S,ed,ed.getDefaultDisplayName())}):(this.aVe(S,Ma,Gb,Yc,ed),hc(!0,S,ed,ed.getDefaultDisplayName()))}catch(xd){ae.ULS.sendTraceTag(17586257,
220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to generate ui extensibility. Error message : {5}.",this.Bo.LM,Telemetry.PrivacyRules.GetPrivacyCompliantId(S.solutionId,S.ownerAddinStoreType||S.storeType,S.assetId,null,null,S.storeId),S.version,S.storeType,S.storeId,xd.message)),hc(!1,S,ed,ed.getDefaultDisplayName())}else ae.ULS.sendTraceTag(17586258,220,10,String.format("{0}: Regular content/taskpane addin AssetId={1} AppVersion={2} StoreType={3} StoreId={4} is not supported for addincommands.",
this.Bo.LM,Telemetry.PrivacyRules.GetPrivacyCompliantId(S.solutionId,S.ownerAddinStoreType||S.storeType,S.assetId,null,null,S.storeId),S.version,S.storeType,S.storeId)),hc(!1,S,null,null);else ae.ULS.sendTraceTag(17586259,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to get manifest.",this.Bo.LM,Telemetry.PrivacyRules.GetPrivacyCompliantId(S.solutionId,S.ownerAddinStoreType||S.storeType,S.assetId,null,null,S.storeId),S.version,S.storeType,S.storeId)),
hc(!1,S,null,null)};Ic.prototype.kGb=function(S,Ma,Gb,hc){var Yc=this,ed={},xd=document.createElement("div");xd.setAttribute("visible","false");ed.div=xd;ed.id=S.solutionId;ed.solutionId=S.solutionId;ed.version=S.version;ed.storeType=S.storeType;ed.storeId=S.storeId;ed.assetId=S.assetId;ed.assetStoreId=S.assetStoreId;ed.isvirtualOsfControl=!0;ed.virtualOsfControlActivationCallback=function(Ed,Xd){var Ud=Yc.EF.Eia(S.storeType,S.solutionId);Ud&&(Ud.isUpgraded&&(S.isUpgraded=!0),Yc.f2b(Ud));Yc.pFi(S,
Ma,Gb,hc,Ed,Xd)};ed.reason=3===this.Rr?Microsoft.Office.WebExtension.InitializationReason.Inserted:Microsoft.Office.WebExtension.InitializationReason.DocumentOpened;return ed};Ic.prototype.aVe=function(S,Ma,Gb,hc,Yc,ed){ed=void 0===ed?null:ed;var xd={};xd.solutionId=hc.getSolutionId();xd.version=hc.getVersion();xd.storeType=hc.getStoreType();xd.storeId=hc.getStoreId();xd.assetId=hc.getSolutionId();xd.assetStoreId=hc.getAssetStoreId();xd.targetType=hc.getOsfControlType();var Ed=null,Xd=null;if(hf.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFGenerateUIExtensibilityParseBuildLoggingKill",
!1))Ed=(new OfficeExt.Parser.AddinCommandsManifestParser(this.Bo.LM,this.Bo.formFactor)).parseExtensions(xd,Yc,this.Hga),Xd=tb.OYe(this.Bo.LM);else try{Ed=(new OfficeExt.Parser.AddinCommandsManifestParser(this.Bo.LM,this.Bo.formFactor)).parseExtensions(xd,Yc,this.Hga),Xd=tb.OYe(this.Bo.LM)}catch(Ef){throw ae.ULS.sendTraceTag(538752131,220,10,"Exception encounter while parsing manifest. Exception: "+Ef.message),Ef;}if(Xd&&0<Xd.count){if(hf.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFGenerateUIExtensibilityParseBuildLoggingKill",
!1)){var Ud=Ma(S);var ne=Gb(S);Gb=!!hf.AFrameworkApplication.fa&&hf.AFrameworkApplication.fa.qa("AddinCommandsMultipleCustomTabsEnabled");Ud=new Rb(Ud,null,ne);Xd=bk(Xd);for(ne=Xd.next();!ne.done;ne=Xd.next())Ud.commandSurface=ne.value,Ed.apply(Ud,this.Hga,Gb)}else try{var Qe=Ma(S),ff=Gb(S),of=!!hf.AFrameworkApplication.fa&&hf.AFrameworkApplication.fa.qa("AddinCommandsMultipleCustomTabsEnabled");Ud=new Rb(Qe,null,ff);var Jf=bk(Xd);for(ne=Jf.next();!ne.done;ne=Jf.next())Ud.commandSurface=ne.value,
Ed.apply(Ud,this.Hga,of)}catch(Ef){throw ae.ULS.sendTraceTag(538752132,220,10,"Exception encounter while building ribbon. Exception: "+Ef.message),Ef;}if(OSF.OUtil.checkFlight(14))try{var kf=Ud.zbd(S.solutionId,Yc.getDefaultDisplayName()),tf=Ud.EUe();kf&&this.ribbonManager.dYa(kf,ed);tf&&this.contextMenuManager.hke(tf);this.EF.Lke(hc,kf,tf,Yc.getDefaultDisplayName());ae.ULS.sendTraceTag(17326353,220,100,"Add-in name: {0}.",Yc.getDefaultDisplayName())}catch(Ef){throw OfficeExt.DevConsole.log(Ef),ae.ULS.sendTraceTag(539870850,
220,10,"Error generating ribbon extensibility. Exception: "+Ef.message),Ef;}else try{var xf=Ud.zbd(S.solutionId,Yc.getDefaultDisplayName()),Nf=Ud.EUe();xf&&this.ribbonManager.dYa(xf);Nf&&this.contextMenuManager.hke(Nf);this.EF.Lke(hc,xf,Nf,Yc.getDefaultDisplayName());ae.ULS.sendTraceTag(579376721,220,100,"Add-in name: {0}.",Yc.getDefaultDisplayName())}catch(Ef){throw ae.ULS.sendTraceTag(539870851,220,10,"Error generating ribbon extensibility. Exception: "+Ef.message),Ef;}}};Ic.prototype.bVe=function(S,
Ma,Gb,hc,Yc,ed){ed=void 0===ed?null:ed;var xd={};xd.solutionId=S.solutionId;xd.version=S.version;xd.storeType=S.storeType;xd.storeId=S.assetStoreId;xd.assetId=S.assetId;xd.assetStoreId=S.assetStoreId;xd.targetType=S.targetType;var Ed=new OfficeExt.JsonParser.AddinCommandsJsonParser(this.Bo.LM,this.Bo.formFactor);try{var Xd=Ma.getManifest(),Ud=Ed.parse(xd,Xd,Yc,this.Hga,Ma.getSharedRuntimeId()),ne=Gb(S),Qe=hc(S),ff=new Rb(ne,null,Qe);ff.commandSurface="PrimaryCommandSurface";Ud.apply(ff,this.Hga,!0);
if(ff.ribbonBuilder.Bs&&0<ff.ribbonBuilder.Bs.count){var of=ff.zbd(S.solutionId,Ma.getManifest().getDefaultDisplayName(),1);hf.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RibbonExtensibilityNullCheckKillSwitch",!1)?this.ribbonManager.dYa(of,ed):of&&this.ribbonManager.dYa(of,ed);this.EF.pBg(Ma,of,Yc,Ma.getManifest().getDefaultDisplayName());ae.ULS.sendTraceTag(592290767,220,100,"Add-in name: {0}.",Ma.getManifest().getDefaultDisplayName())}}catch(Jf){ae.ULS.sendTraceTag(592290768,
220,15,"Failed to generate dynamic Add-in commands. Add-in name: {0}. Error: {1}",Ma.getManifest().getDefaultDisplayName(),Jf.toString()),OSF.OUtil.checkFlight(14)&&OfficeExt.DevConsole.log(Jf)}};Ic.prototype.f2b=function(S){S.to&&this.ribbonManager.THd(S.to);S.Fqb&&this.contextMenuManager.s9i(S.Fqb);this.EF.a9i(S.qB.getStoreType(),S.qB.getSolutionId())};Ic.prototype.kXg=function(S,Ma){Ma=gd(Ma);for(var Gb=bk(this.EF.m5a),hc=Gb.next();!hc.done;hc=Gb.next())if(hc=hc.value,hc.qB.getStoreType()===Ma){for(var Yc=
!0,ed=bk(S),xd=ed.next();!xd.done;xd=ed.next())if((xd=xd.value)&&hc.rff(xd.storeType,xd.solutionId)){Yc=!1;break}Yc&&(this.f2b(hc),hc.qB.purge(!1))}};Ic.prototype.Ceg=function(S){return!!S&&!!S.solutionId&&!!S.version&&!!S.storeType&&!!S.storeId};Object(Id.a)(Ic,"AddInCommandsIntegration",null,[]);Vb.prototype.jDg=function(S){this.$a.addHandler(jf.a.Cne,S)};Vb.prototype.$Eg=function(S){this.$a.addHandler(jf.a.Xrd,S)};Vb.prototype.BGg=function(S){this.$a.addHandler(jf.a.X1f,S)};Vb.prototype.pDg=function(S){this.$a.addHandler(jf.a.TWc,
S)};Vb.prototype.Nqi=function(S,Ma,Gb){var hc=this,Yc=Gb[jf.a.knb],ed=void 0===Gb[jf.a.mP]?0:Gb[jf.a.mP];if(Yc&&0!==ed)if(0>=Yc.count&&4!==ed)this.CGf(new Ac(ed,null,null,Ma,null,!0));else{var xd=Yc.count,Ed=new fb(new Bc),Xd=void 0===Gb[jf.a.H9]?-1:Gb[jf.a.H9],Ud=new Ic(ed,this.Lm,this.TDc,Ed,this.img,this.QWa,this.jQb),ne=function(kf){return hc.she.BQg(kf.solutionId,hc.jQb,hc.TDc,S)},Qe=function(kf){return hc.she.MPg(kf.solutionId)},ff=function(kf,tf,xf){xd--;xf=new Ac(ed,tf,Ed,Ma,xf,0>=xd);if(kf&&
tf)hc.CGf(xf);else{if(3===ed||tf&&tf.isUpgraded)kf="",tf&&(kf=Telemetry.PrivacyRules.GetPrivacyCompliantId(tf.solutionId,tf.ownerAddinStoreType||tf.storeType,tf.assetId,null,null,tf.storeId)),tf={},tf=(tf.SDX_AppInstallOrigin="User",tf.SDX_AppInstallErrorCode="onAddinCompletedBase.fail",tf.SDX_Id=kf,tf),tg.a.sendTelemetryEvent(Object.assign(new og.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:vg.a.Uk(tf)}));hc.BGf(xf)}xd||hf.AFrameworkApplication.ta.updateCommandUI()},of=function(kf,tf,
xf,Nf){ff(kf,tf,Nf)},Jf=function(){hc.vxd();0>=Yc.count&&4===ed&&hc.QWa.zNd()};6===ed?(Xd=Gb[jf.a.rIa],Gb=Gb[jf.a.sIa],Ud.vqi(Yc.na(0),Xd,Gb,ne,Qe,function(kf,tf,xf,Nf){ff(kf,tf,Nf)})):Ud.nBb(Yc,ne,Qe,Xd,of,Jf,this.Dsg)}else Ud={},Ud=(Ud.SDX_AppInstallOrigin="User",Ud.SDX_AppInstallErrorCode="LaunchOneLineRibbonAddinCommands.fail",Ud.SDX_Id="",Ud),tg.a.sendTelemetryEvent(Object.assign(new og.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:vg.a.Uk(Ud)})),ae.ULS.sendTraceTag(24786637,220,
10,String.format("{0}: parameters are invalid for LaunchOnlineAddinCommands.",this.TDc.LM)),this.BGf(new Ac(ed,null,null,Ma,null,!0))};Vb.prototype.BGf=function(S){this.vxd(S);this.O2f(!1,S)};Vb.prototype.CGf=function(S){var Ma=S.Oj,Gb=null;null!==Ma&&(Gb=Ma.storeType,Gb=Gb.toLowerCase());if(S&&"omex"===Gb&&(3===S.Rr||Ma.isUpgraded)){var hc={};hc=(hc.SDX_AppInstallOrigin="User",hc.SDX_AppInstallErrorCode="0",hc.SDX_Id=Telemetry.PrivacyRules.GetPrivacyCompliantId(Ma.solutionId,Ma.ownerAddinStoreType||
Ma.storeType,Ma.assetId,null,null,Ma.storeId),hc);tg.a.sendTelemetryEvent(Object.assign(new og.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:vg.a.Uk(hc)}))}this.vxd(S);"omex"===Gb&&S.f0&&(3===S.Rr||Ma.isUpgraded)&&(hc=new ve,hc.Oj=Ma,hc.to=S.f0.fxa,this.$a.raiseEvent(jf.a.TWc,hc));if(this.rqg){hc=Fd();var Yc=kd();hc&&Ma&&"excatalog"===Ma.storeType&&S.f0&&5===S.Rr&&Yc&&(Ma.storeId&&Ma.storeId.toLowerCase()===Yc.toLowerCase()||Ma.assetId&&Ma.assetId.toLowerCase()===Yc.toLowerCase())&&(hc=
new ve,hc.Oj=Ma,hc.to=S.f0.fxa,this.$a.raiseEvent(jf.a.TWc,hc),ae.ULS.sendTraceTag(525362254,220,50,"Email alert triggers AutoLaunchAddin event."))}Ma&&(Rc.instance.eXf(ld(Gb),!0),"uploadfiledevcatalog"===Gb&&(hc=this.Bjg.createAddinDataProvider(Gb,this.Lm))&&hc.localCacheAddinCommands(this.Lm.cma,Ma.solutionId,Ma.version,Ma.storeId),Ki.a.zeb(jf.a.mnb,"true",ld(Gb)));this.O2f(!0,S)};Vb.prototype.O2f=function(S,Ma){S?hf.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",
!1)&&Ma.f0&&5===Ma.Rr&&Ma.f0.fxa&&void 0!==Ma.Oj.showCallout&&null!==Ma.Oj.showCallout&&Ma.Oj.showCallout?(hf.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingCalloutRefactorEnabled",!1)?(new rb(this.$a)).BTc(Ma.Oj,ni.a.T2a(Ma.f0.fxa)):(new ac(this.$a,Ma.Oj,ni.a.T2a(Ma.f0.fxa))).BTc(),S=new ve,S.to=Ma.f0.fxa,S.Oj=Ma.Oj,this.$a.raiseEvent(jf.a.X1f,S)):3!==Ma.Rr?Ma.cif&&this.QWa.zNd():Ma.f0&&Ma.f0.fxa&&"hardcodedpreinstall"!==Ma.Oj.storeType&&Uh.a.tyj(Ma.displayName,
Ma.f0.fxa,Ma.Oj.isAutoLaunched):3===Ma.Rr?Ma.Oj&&"uploadfiledevcatalog"===Ma.Oj.storeType.toLowerCase()?(Ma=this.jQb.fNh(Ma.Oj.solutionId),Uh.a.EQd(Ma?Ma:CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive)):this.QWa.kYf():Ma.cif&&this.QWa.zNd()};Vb.prototype.vxd=function(S){var Ma=(S=void 0===S?null:S)?S.Oj:null,Gb=new ve;if(Gb.Oj=Ma){var hc=this.QWa.Eia(Ma.storeType,Ma.solutionId,6===S.Rr?1:0);hc&&hc.to&&(Gb.to=hc.to,3===S.Rr&&"hardcodedpreinstall"!==Ma.storeType)&&(S=
"",hc.to.QV&&hc.to.QV.Bs&&(hc=hc.to.QV.Bs.na(0))&&(S=hc.id),hc={},Ma=(hc.SDX_CommandPlacement=S,hc.SDX_PinningAction="Pinning",hc.SDX_PinningActionErrorCode="0",hc.SDX_Id=Telemetry.PrivacyRules.GetPrivacyCompliantId(Ma.solutionId,Ma.ownerAddinStoreType||Ma.storeType,Ma.assetId,null,null,Ma.storeId),hc),tg.a.sendTelemetryEvent(Object.assign(new og.a,{name:"Office.Extensibility.Host.AppPinning",dataFields:vg.a.Uk(Ma)})))}this.$a.raiseEvent(jf.a.Cne,Gb)};Object(Id.a)(Vb,"LaunchAddinCommandsHandler",
null,[204]);jb.cUa="Alt";jb.dUa="Command";jb.id="Id";jb.fUa="Image16by16";jb.TPb="LabelText";jb.gUa="Title";jb.GROUP="Group";jb.D_d="Groups";jb.Ufb="Controls";jb.button="Button";jb.yaa="FlyoutAnchor";jb.LARGE="Large";jb.SMALL="Small";Object(Id.a)(jb,"AddinDataNodeConstants",null,[]);b(393);b(631);b(625);b(167);Mf.Object.defineProperties(Zb.prototype,{id:{configurable:!0,enumerable:!0,get:function(){return this._id||""}},fU:{configurable:!0,enumerable:!0,get:function(){return this.X2d||(this.X2d={})}},
controlType:{configurable:!0,enumerable:!0,get:function(){return this.omg||""}},menuItems:{configurable:!0,enumerable:!0,get:function(){return this.VDa||(this.VDa=new df.a)}}});Object(Id.a)(Zb,"ControlDefinition",null,[200]);Mf.Object.defineProperties(Za.prototype,{hla:{configurable:!0,enumerable:!0,get:function(){return this.X$d||(this.X$d={})}},id:{configurable:!0,enumerable:!0,get:function(){return this._id||""}}});Object(Id.a)(Za,"MenuItemDefinition",null,[238]);Mf.Object.defineProperties(Aa.prototype,
{id:{configurable:!0,enumerable:!0,get:function(){return this._id}},controls:{configurable:!0,enumerable:!0,get:function(){return this.opa||(this.opa=new df.a)}}});Object(Id.a)(Aa,"OfficeMenuDefinition",null,[202]);var Eg=b(25);Mb.prototype.addButton=function(S){ae.ULS.sendTraceTag(17085952,220,50,"ContextMenu button actiontype: {0}.",S.actionType);this.EI=new Zb(this.fsa(S.id),jb.button);this.EI.fU[jb.TPb]=S.label;this.EI.fU[jb.cUa]=S.label;this.EI.fU[jb.fUa]=S.icon["16"];this.Cob(this.EI.fU[jb.id],
S.action);this.sFa(this.EI.fU);this.VUa.controls.add(this.EI);this.EI=null};Mb.prototype.startBuildMenu=function(S){if(hh.c(this.VUa))this.VUa=new Aa(S.id);else{var Ma=this.fsa(S.id);this.EI=new Zb(Ma,jb.yaa);this.JZa(this.EI.fU,S);this.EI.fU[jb.fUa]=S.icon["16"];this.EI.fU[jb.dUa]=Eg.a.alwaysEnabled}};Mb.prototype.addMenuItem=function(S){ae.ULS.sendTraceTag(17085953,220,50,"ContextMenu menu item actiontype: {0}.",S.actionType);var Ma=new Za(this.fsa(S.id));this.JZa(Ma.hla,S);S.icon&&(Ma.hla[jb.fUa]=
S.icon["16"]);this.Cob(Ma.hla[jb.id],S.action);this.sFa(Ma.hla);this.EI.menuItems.add(Ma)};Mb.prototype.endBuildMenu=function(){hh.c(this.EI)?(this.Ikc.add(this.VUa),this.VUa=null):(this.VUa.controls.add(this.EI),this.EI=null)};Mb.prototype.Cob=function(S,Ma){this.FSc.bindAction(S,Ma)};Mb.prototype.sFa=function(S){this.fqb.sFa(S)};Mb.prototype.fsa=function(S){return this.nlc.HJa(S)};Mb.prototype.JZa=function(S,Ma){S[jb.TPb]=Ma.label;S[jb.cUa]=Ma.label};Mf.Object.defineProperties(Mb.prototype,{nlc:{configurable:!0,
enumerable:!0,get:function(){return this.YMc}},fqb:{configurable:!0,enumerable:!0,get:function(){return this.IUa}},FSc:{configurable:!0,enumerable:!0,get:function(){return this.iUa}},Ikc:{configurable:!0,enumerable:!0,get:function(){return this.asg}}});Object(Id.a)(Mb,"ContextMenuExtensibilityCreator",null,[221,215]);ub.prototype.HJa=function(S){return this.XCb+S};Mf.Object.defineProperties(ub.prototype,{XCb:{configurable:!0,enumerable:!0,get:function(){return this.Sjb}}});Object(Id.a)(ub,"DefaultContextMenuNamingProvider",
null,[218]);var gj=b(1518);Ab.prototype.bindAction=function(S,Ma){OfficeExt.DefaultControlActionBinder.bindAction(S,Ma)};Object(Id.a)(Ab,"DefaultUIControlActionBinder",null,[217]);Kb.prototype.sFa=function(S){S[jb.dUa]=this.command};Mf.Object.defineProperties(Kb.prototype,{command:{configurable:!0,enumerable:!0,get:function(){return this.CCa}}});Object(Id.a)(Kb,"DefaultUIControlCommandBinder",null,[216]);var yh=b(32);Object(Id.a)(Db,"AddInControl",null,[]);Object(Id.a)(Qa,"AddInGroup",null,[]);Object(Id.a)(pa,
"AddInMenuItem",null,[]);Object(Id.a)(Ua,"AddInTab",null,[]);cb.prototype.startBuildTab=function(S){var Ma=S.isOfficeTab?S.id:this.nlc.Q1e(S.id),Gb=S.isOfficeTab?null:S.label;this.WUa=Object.assign(new Ua,{id:Ma,title:Gb,isOfficeTab:S.isOfficeTab,visible:S.visible,groups:[],tabType:S.tabType,insertBefore:S.insertBefore,insertAfter:S.insertAfter,autoFocus:S.autoFocus})};cb.prototype.startBuildGroup=function(S){var Ma=this.fsa(S.id);this.Rea=Object.assign(new Qa,{id:Ma,mlrId:S.mlrId,title:S.label,controls:[],
groupType:0})};cb.prototype.addNativeGroup=function(S){this.Rea=Object.assign(new Qa,{id:S.id,mlrId:S.mlrId,title:S.label,controls:[],groupType:1});this.WUa.groups.push(this.Rea)};cb.prototype.addButton=function(S){var Ma=this.fsa(S.id);Ma&&(this.Cob(Ma,S.action),ae.ULS.sendTraceTag(24786640,220,50,"AddInDataTransferObject button actiontype: {0}.",S.actionType),S=Object.assign(new Db,{id:Ma,title:S.label,iconLocation:this.Ndd(S),enabled:S.enabled,controlType:0,attributes:this.JZa()}),this.X4d.Wje(new yh.a(Ma,
this.fqb.command.toString())),this.Rea.controls.push(S))};cb.prototype.addNativeControl=function(S){S.id&&(ae.ULS.sendTraceTag(590709920,220,50,"AddInDataTransferObject button actiontype: {0}.",S.actionType),S=Object.assign(new Db,{id:S.id,title:"",iconLocation:"",enabled:S.enabled,controlType:2,attributes:this.JZa()}),this.Rea.controls.push(S))};cb.prototype.startBuildMenu=function(S){var Ma=this.fsa(S.id);Ma&&(this.jhb=Object.assign(new Db,{id:Ma,title:S.label,iconLocation:this.Ndd(S),controlType:1,
attributes:{},menuItems:[]}))};cb.prototype.addMenuItem=function(S){var Ma=this.fsa(S.id);Ma&&(this.Cob(Ma,S.action),ae.ULS.sendTraceTag(24786642,220,50,"AddInDataTransferObject menu item actiontype: {0}.",S.actionType),S=Object.assign(new pa,{id:Ma,title:S.label,iconLocation:this.Ndd(S),enabled:S.enabled,attributes:this.JZa()}),this.X4d.Wje(new yh.a(Ma,this.fqb.command.toString())),this.jhb.menuItems.push(S))};cb.prototype.endBuildMenu=function(){hh.c(this.jhb.id)||this.Rea.controls.push(this.jhb);
this.jhb=null};cb.prototype.endBuildGroup=function(){hh.c(this.Rea.id)||this.WUa.groups.push(this.Rea);this.Rea=null};cb.prototype.endBuildTab=function(){hh.c(this.WUa.id)||this.fQb.add(this.WUa);this.WUa=null};cb.prototype.JZa=function(){var S={};this.sFa(S);return S};cb.prototype.Ndd=function(S){return S.icon["80"]?S.icon["80"]:S.icon["32"]};cb.prototype.sFa=function(S){this.fqb.sFa(S)};cb.prototype.fsa=function(S){return this.nlc.HJa(S)};cb.prototype.Cob=function(S,Ma){this.FSc.bindAction(S,Ma)};
Mf.Object.defineProperties(cb.prototype,{nlc:{configurable:!0,enumerable:!0,get:function(){return this.YMc}},Bs:{configurable:!0,enumerable:!0,get:function(){return this.fQb}},FSc:{configurable:!0,enumerable:!0,get:function(){return this.iUa}},fqb:{configurable:!0,enumerable:!0,get:function(){return this.IUa}}});Object(Id.a)(cb,"OneLineRibbonExtensibilityCreator",null,[214,215]);eb.prototype.MPg=function(S){S=new ub(S);return new Mb(S,this.IUa,this.iUa)};eb.prototype.BQg=function(S,Ma,Gb,hc){Gb=new gj.a(this.Sjb,
S,Gb,!0);return new cb(Gb,this.iUa,this.IUa,S,Ma,hc)};Object(Id.a)(eb,"UIExtensibilityFactory",null,[192]);var Wh=b(91),hj=b(1072),xi=b(22),$f=b(37),oh=b(76),Lg=b(51);Na.GetPrivacyCompliantId=function(S){return Telemetry.PrivacyRules.GetPrivacyCompliantId(S.solutionId,S.storeType,S.assetId,null,null,S.storeId)};Na.eUa=function(S){return Telemetry.PrivacyRules.GetPrivacyCompliantId(S.solutionId,S.storeType,S.assetId,null,null,S.storeId)};Na.prototype.v8i=function(S){this.hC=S;window.addEventListener&&
(window.addEventListener("LaunchContentAddin",this.rNi,!0),window.addEventListener("DismissCallout",this.CIi,!0),window.addEventListener("CloseCallout",this.gHi,!0))};Na.prototype.Zed=function(S){return"[id="+S+"]"};Na.prototype.p3f=function(S,Ma){var Gb=this;Ma>this.iHg?(window.clearTimeout(this.ZNf),this.o3f("[data-unique-id='pivotOverflowButton']"),ae.ULS.sendTraceTag(537170692,220,50,"ShowTeachingCalloutWithPoll did not find the DOM element in time")):document.querySelector("button"+S)?this.o3f(S):
this.ZNf=window.setTimeout(function(){Gb.p3f(S,Ma+1)},1E3)};Na.prototype.n3f=function(S){var Ma=document.querySelector("button[data-unique-id='RightPaddle']");if(Ma)S={},S=(S.AppTeachingUICalloutAction="RightPaddlePresent",S["SDX.Id"]=Na.GetPrivacyCompliantId(this.Oj),S.AppTeachingUICalloutGoal="NewAdminDeployment",S["SDX.AppInstallOrigin"]="Organization",S),tg.a.sendTelemetryEvent(Object(Vg.a)(new og.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:vg.a.Uk(S)}));else if(Ma=document.querySelector("button"+
S),!Ma||"none"===window.getComputedStyle(Ma).display)if(Ma=document.querySelector("button[id='RibbonOverflowMenu-overflow']"),!Ma){Ma={};Ma=(Ma.AppTeachingUICalloutAction="NoAnchor",Ma["SDX.Id"]=Na.GetPrivacyCompliantId(this.Oj),Ma.AppTeachingUICalloutGoal="NewAdminDeployment",Ma["SDX.AppInstallOrigin"]="Organization",Ma);tg.a.sendTelemetryEvent(Object(Vg.a)(new og.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:vg.a.Uk(Ma)}));ae.ULS.sendTraceTag(537170691,220,15,"ShowTeachingCallout failed to get an anchorElement");
this.J5();return}this.P9f(Ma,"ShowTeachingUIForAddinButton")};Na.prototype.o3f=function(S){S=document.querySelector("button"+S);if(!S&&(S=document.querySelector("button[data-unique-id='pivotOverflowButton']"),!S)){S={};S=(S.AppTeachingUICalloutAction="NoAnchor",S["SDX.Id"]=Na.GetPrivacyCompliantId(this.Oj),S.AppTeachingUICalloutGoal="NewAdminDeployment",S["SDX.AppInstallOrigin"]="Organization",S);tg.a.sendTelemetryEvent(Object(Vg.a)(new og.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",
dataFields:vg.a.Uk(S)}));ae.ULS.sendTraceTag(537170690,220,15,"ShowTeachingCalloutToAddinTab failed to get an anchorElement");this.J5();return}this.P9f(S,"ShowTeachingUIForAddinTab")};Na.prototype.P9f=function(S,Ma){S.setAttribute("lpp-id","latestAddin");var Gb=fh.a.instance.Tb("Common.ISystemInitiatedFeedback");Gb&&S?(Gb.execute(function(hc){hc.logActivity(Ma,null)}),S={},S=(S.AppTeachingUICalloutAction="Show",S["SDX.Id"]=Na.GetPrivacyCompliantId(this.Oj),S.AppTeachingUICalloutGoal="NewAdminDeployment",
S["SDX.AppInstallOrigin"]="Organization",S),tg.a.sendTelemetryEvent(Object(Vg.a)(new og.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:vg.a.Uk(S)})),ae.ULS.sendTraceTag(537170688,220,50,"ShowTeachingCalloutToAddinTab triggered an LPP activity")):(ae.ULS.sendTraceTag(537170689,220,15,"ShowTeachingCalloutToAddinTab failed to get a sifFuture"),S={},S=(S.AppTeachingUICalloutAction="NoSifFutureObject",S["SDX.Id"]=Na.GetPrivacyCompliantId(this.Oj),S.AppTeachingUICalloutGoal="NewAdminDeployment",
S["SDX.AppInstallOrigin"]="Organization",S),tg.a.sendTelemetryEvent(Object(Vg.a)(new og.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:vg.a.Uk(S)})),this.J5())};Na.prototype.bHh=function(S){if(!S)return null;S=S.QV;if((null===S||void 0===S?0:S.Bs)&&0<S.Bs.count){S=bk(S.Bs);for(var Ma=S.next();!Ma.done;Ma=S.next())if(Ma=Ma.value,Ma.groups&&0<Ma.groups.length){Ma=bk(Ma.groups);for(var Gb=Ma.next();!Gb.done;Gb=Ma.next())if(Gb=Gb.value,Gb.controls&&0<Gb.controls.length){Gb=bk(Gb.controls);
for(var hc=Gb.next();!hc.done;hc=Gb.next()){hc=hc.value;if(hc.attributes&&0===hc.controlType&&hc.enabled)return hc.id;if(hc.menuItems)for(var Yc=bk(hc.menuItems),ed=Yc.next();!ed.done;ed=Yc.next())if(ed=ed.value,ed.attributes&&ed.enabled)return hc.id}}}}return null};Na.prototype.PAj=function(){var S=document.querySelector("button[data-unique-id = 'Ribbon-InsertAppsForOffice']");if(S&&"none"!==window.getComputedStyle(S).display)ae.ULS.sendTraceTag(527286666,220,15,"Callout show on OfficeAddin Button");
else{S=document.querySelector("button[data-unique-id = 'Overflow-RibbonOverflowMenu-overflow']");if(null==S){S={};S=(S.AppTeachingUICalloutAction="NoAnchor",S["SDX.Id"]=Na.eUa(this.hC),S.AppTeachingUICalloutGoal="NewAdminDeployment",S["SDX.AppInstallOrigin"]="Organization",S);tg.a.sendTelemetryEvent(Object(Vg.a)(new og.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:vg.a.Uk(S)}));ae.ULS.sendTraceTag(527286668,220,15,"ShowTeachingCalloutToContentAddin failed to get an anchorElement");
this.J5();return}ae.ULS.sendTraceTag(527286667,220,15,"Callout show on Overflow button")}var Ma=fh.a.instance.Tb("Common.ISystemInitiatedFeedback");null==Ma||null==S?(S={},S=(S.AppTeachingUICalloutAction="NoSifFutureObject",S["SDX.Id"]=Na.eUa(this.hC),S.AppTeachingUICalloutGoal="NewAdminDeployment",S["SDX.AppInstallOrigin"]="Organization",S),tg.a.sendTelemetryEvent(Object(Vg.a)(new og.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:vg.a.Uk(S)})),ae.ULS.sendTraceTag(527286665,220,
15,"ShowTeachingCalloutToContentAddin failed to get a sifFuture"),this.J5()):(Ma.execute(function(Gb){Gb.logActivity("ShowTeachingUIForContentAddin",null)}),S={},S=(S.AppTeachingUICalloutAction="Show",S["SDX.Id"]=Na.eUa(this.hC),S.AppTeachingUICalloutGoal="NewAdminDeployment",S["SDX.AppInstallOrigin"]="Organization",S),tg.a.sendTelemetryEvent(Object(Vg.a)(new og.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:vg.a.Uk(S)})),ae.ULS.sendTraceTag(527286664,220,50,"ShowTeachingCalloutToContentAddin triggered an LPP activity"))};
Na.prototype.h0=function(S){var Ma={},Gb={};Gb.LastTeachingUIShowTime=(new Date).toUTCString();Gb.AddinHasShown=S;Ma[this.appName]=Eh.c(Gb);this.pnb=new Qd(this.appName,null,null,this.cW),this.pnb.d2a(Ma),ae.ULS.sendTraceTag(522981592,306,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")};Na.prototype.J5=function(){if(hf.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)&&!this.sQa){var S=
window.g_roamingAddinList;S&&(this.h0(S),this.sQa=!0)}};Object(Id.a)(Na,"AddinTeachingCalloutHandler",null,[]);var yi=b(1437),Xh=b(394),gi=b(11),Sf=b(186),Mi=b(40),Ng=b(21),Mh=b(58);Z.prototype.dispose=function(){void 0!==this.nnb&&null!==this.nnb&&(this.nnb.dispose(),this.nnb=null);this.se=this.$=null;this.disposed=!0};Z.prototype.Qvj=function(S,Ma){switch(S){case Eg.a.l2:S=this.Cvj(Ma);break;default:S=!1}return S};Z.prototype.Lc=function(){return!1};Z.prototype.executeCommand=function(S,Ma,Gb){var hc=
this;S=$f.TaskExtensions.jk();Ma=Ma.command;switch(Ma){case 843847158:break;case -2025863019:Uh.a.EQd(Gb[jf.a.VUc].toString(),function(){Ng.g(hc.$).focus()});break;case -1777565636:yi.a.showUILessDialog(Gb[jf.a.onb].toString());this.se.Iyj(Gb[jf.a.onb].toString());break;case 1592314317:yi.a.hideUILessDialog(Gb[jf.a.onb].toString());this.se.A5h(Gb[jf.a.onb].toString());break;case Eg.a.l2:S=this.Sgd(Gb);break;case Eg.a.mBb:this.nBb(Gb);break;case Eg.a.Sma:this.Sma(Gb);break;case Eg.a.FQd:this.nnb.hxc();
break;case Eg.a.refreshAddinCommands:this.r6i();break;case 1949669462:this.Iga.kYf(!0);break;case -1014260128:S=this.executeDynamicAddInCommandsAPI(Gb);break;default:S=Sf.a(Ma)}return S};Z.prototype.zc=function(S,Ma){S=!1;switch(Ma.command){case 843847158:case -2025863019:case -1777565636:case 1592314317:case Eg.a.Sma:case Eg.a.FQd:case Eg.a.refreshAddinCommands:case 1949669462:case Eg.a.mBb:case -1014260128:S=!0;break;case Eg.a.l2:S=!hf.AFrameworkApplication.protectedFile}return S};Z.prototype.Qc=
function(){return!1};Z.prototype.RKh=function(S){if(!S)return ae.ULS.sendTraceTag(528098432,220,10,"Failed to get button id for addin"),null;if((S=S.QV)&&S.Bs&&0<S.Bs.count){S=bk(S.Bs);for(var Ma=S.next();!Ma.done;Ma=S.next()){Ma=Ma.value;if(Ma.groups&&1===Ma.groups.length){var Gb=Ma.groups[0];if(Gb.controls&&1===Gb.controls.length){var hc=Gb.controls[0];if(hc.attributes&&!hc.controlType&&hc.enabled)return hc.id}Gb.controls&&ae.ULS.sendTraceTag(528098403,220,15,"It has multiple buttons")}Ma.groups&&
ae.ULS.sendTraceTag(528098402,220,15,"It has multiple groups")}}return null};Z.prototype.r6i=function(){if(this.Iga.Msd()){this.Iga.rxe();var S=this.Ubd();if(S&&0<S.count){S=bk(S);for(var Ma=S.next();!Ma.done;Ma=S.next()){var Gb={};Ma=(Gb[jf.a.H9]=Ma.value,Gb[jf.a.mP]=4,Gb[jf.a.JFa]=(new Date).getTime(),Gb);this.Sma(Ma)}}}};Z.prototype.Sma=function(S){var Ma=this;ae.ULS.sendTraceTag(537170657,220,50,"Launch AddinCommands entitlements list, LaunchOperationType {0}, DataProvider {1}.",S[jf.a.mP],S[jf.a.H9]);
this.Iga.Xnj();window.setTimeout(function(){if(void 0===Ma.se||null===Ma.se)ae.ULS.sendTraceTag(537170656,220,10,String.format("AddinUICommandHandler RetrieveAddInCommandsEntitlementsList error - DdaFacadeService should not be null, stack: {0}",Mi.a.d3()));else{var Gb=new sc(new Pb(Ma.se.Qh),uc.instance,Rc.instance);Gb.iDg(function(hc,Yc){Ma.nBb(Yc.properties)});hf.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",!1)&&hf.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:5837059_TeachingUIForPrivateCatelogOnContentAddinEnabled")&&
Gb.CGg(function(hc,Yc){null==Yc?(hc={},hc=(hc.AppTeachingUICalloutAction="InvalidEventArgs",hc.AppTeachingUICalloutGoal="NewAdminDeployment",hc["SDX.AppInstallOrigin"]="Organization",hc),tg.a.sendTelemetryEvent(Object(Vg.a)(new og.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:vg.a.Uk(hc)}))):(Ma.UAa=new Na(Ma),Ma.UAa.v8i(Yc),hc=Ma.$.Ka,null!=hc&&(hc.une(Ma.Z9e),ae.ULS.sendTraceTag(527286663,220,50,"Register tab switched event")))});Gb.fNj(S)}},0)};Z.prototype.nBb=function(S){var Ma=
this;if(!this.disposed){ae.ULS.sendTraceTag(537170655,220,50,"LaunchOperationType {0}.",S[jf.a.mP]);try{if(ef.EwaSettings.ma(187)){var Gb=S[jf.a.knb];if(Gb&&0<Gb.count){for(var hc=Gb.count,Yc=hc-1;0<=Yc;Yc--){var ed=Gb.na(Yc);OSF.OsfControl.isFirstPartyStoreString(ed.storeType)||Gb.remove(Gb.na(Yc))}if(Gb.count<hc){var xd=Lg.GetServiceTaskFactory.Ra(this.$.da,5,4,0);$f.TaskExtensions.Aa(xd,function(){xd.result.Tf(35,null)},this.$.la,3)}if(!Gb.count)return}}if(void 0===this.se||null===this.se)ae.ULS.sendTraceTag(537170654,
220,10,String.format("LaunchAddinCommands error - this.DdaFacadeService should not be null, stack: {0}",Mi.a.d3()));else{var Ed=null;Ed=hf.AFrameworkApplication.fa.qa("HostInstallAddInsIsEnabled")?new Vb(this.Bo,this.IAe,new Pb(this.se.Qh),new eb(this.$.yb,Eg.a.l2),this.Iga,uc.instance,this.Hga,function(Ud,ne){var Qe={};Qe.InstanceId=Bj.a.create().toString();Qe.PrimaryMarketplace={};Qe.PrimaryMarketplace.SolutionId=Ud.solutionId;Qe.PrimaryMarketplace.SolutionVersion=Ud.version;Qe.PrimaryMarketplace.MarketplaceType=
Ud.storeType;Qe.PrimaryMarketplace.MarketplaceRef=Ud.storeId;Qe.WebExtensionType=1;Ma.se.VAj(Qe,function(){ne(Ud)})}):new Vb(this.Bo,this.IAe,new Pb(this.se.Qh),new eb(this.$.yb,Eg.a.l2),this.Iga,uc.instance,this.Hga);Ed.pDg(this.UFi);Ed.jDg(this.qNi);if(hf.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",!1)){var Xd=new Na(this);Ed.$Eg(Xd.pNi);Ed.BGg(Xd.uyj)}this.$.da.za(53).Ql&&ej.a.get_instance().ak(5,null).continueWith(function(){Ma.disposed||
Ed.Nqi(Ma.L9c,Ma.$.domElement,S)})}}catch(Ud){ae.ULS.sendTraceTag(537170653,220,10,String.format("LaunchAddinCommands error message : {0}.",Ud.message))}}};Z.prototype.Sgd=function(S){var Ma=$f.TaskExtensions.jk();S=S[this.Bo.Lha];var Gb=this.KZb.Tie(S),hc=new yi.a(this.$,this.se,Gb.ownerAddinInfo,Ma);return this.L3e(Ma,S,Gb,hc)};Z.prototype.L3e=function(S,Ma,Gb,hc){var Yc=this;this.KZb.Sgd(Ma,this.Iga,hc,new Pb(this.se.Qh),Gb,function(){S=hc.h1g()},function(){Ng.g(Yc.$).focus()});return S};Z.prototype.GMg=
function(S){var Ma=this,Gb=$f.TaskExtensions.jk(),hc=this.se.saa(S.solutionId);if(hc){var Yc=this.se.dZ(hc);if(gi.HelperMethods.fw(Yc)&&0!==Yc.SharedRuntime.State)return}Yc=this.KZb.HMg;var ed=S.solutionId in Yc?Yc[S.solutionId]:null;if(ed){var xd=this.KZb.Tie(ed),Ed=new yi.a(this.$,this.se,xd.ownerAddinInfo,Gb);Yc=function(Ud){if(Ud){var ne={};Ud=bk(Ud);for(var Qe=Ud.next();!Qe.done;Qe=Ud.next())Qe=Qe.value,ne[Qe[0]]=Qe[1];(ne=jf.a.Bne in ne?ne[jf.a.Bne]:null)&&"true"===ne.toLowerCase()&&(ae.ULS.sendTraceTag(537170652,
220,50,"Auto-Show AddinCommands TaskPane, StoreType {0}, StoreId {1}, SolutionId {2}.",S.storeType,S.storeId,Telemetry.PrivacyRules.GetPrivacyCompliantId(S.solutionId,null!==xd.ownerAddinInfo?xd.ownerAddinInfo.storeType:S.storeType,S.assetId,null,null,S.storeId)),Ma.L3e(Gb,ed,xd,Ed))}};ae.ULS.sendTraceTag(537170651,220,50,"Check Auto-Show AddinCommands TaskPane, StoreType {0}, StoreId {1}, SolutionId {2}.",S.storeType,S.storeId,Telemetry.PrivacyRules.GetPrivacyCompliantId(S.solutionId,null!==xd.ownerAddinInfo?
xd.ownerAddinInfo.storeType:S.storeType,S.assetId,null,null,S.storeId));if(hc)Yc(this.se.dZ(hc).OsfPropertyBag);else if(hc=this.$.ea.workbookContext.WebExtensions){hc=bk(hc);for(var Xd=hc.next();!Xd.done;Xd=hc.next())if(Xd=Xd.value,(1===Xd.WebExtensionType?OSF.OsfControlTarget.TaskPane:OSF.OsfControlTarget.InContent)===S.targetType&&Xd.PrimaryMarketplace.MarketplaceType.toLowerCase()===S.storeType.toLowerCase()&&Xd.PrimaryMarketplace.MarketplaceRef.toLowerCase()===S.storeId.toLowerCase()&&Xd.PrimaryMarketplace.SolutionId.toLowerCase()===
S.solutionId.toLowerCase()){Yc(Xd.OsfPropertyBag);break}}}};Z.prototype.UTd=function(S,Ma,Gb){S&&(void 0===Gb||!Gb||Ma||this.O4c.contains(S)||this.O4c.add(S),(Gb=this.d1a.contains(S))&&Ma&&this.d1a.remove(S),Gb||Ma||this.d1a.add(S))};Z.prototype.Grj=function(S){if((S=S.QV)&&S.Bs){S=bk(S.Bs);for(var Ma=S.next();!Ma.done;Ma=S.next())if(Ma=Ma.value,Ma.groups){Ma=bk(Ma.groups);for(var Gb=Ma.next();!Gb.done;Gb=Ma.next())if(Gb=Gb.value,Gb.controls){Gb=bk(Gb.controls);for(var hc=Gb.next();!hc.done;hc=Gb.next())if(hc=
hc.value,this.UTd(hc.id,hc.enabled,!0),1===hc.controlType&&hc.menuItems){hc=bk(hc.menuItems);for(var Yc=hc.next();!Yc.done;Yc=hc.next())Yc=Yc.value,this.UTd(Yc.id,Yc.enabled,!0)}}}}};Z.prototype.Ubd=function(){var S=new df.a;ef.EwaSettings.ma(54)&&(this.$.ea.Jg.get(27)&&(S.add(0),S.add(16)),this.$.ea.Jg.get(33)&&S.add(1),S.add(8));return S};Z.prototype.executeDynamicAddInCommandsAPI=function(S){var Ma=!0;if(void 0===S||null===S||void 0===S[jf.a.zsb]||null===S[jf.a.zsb])return Mh.Task.Ua(!1);switch(S[jf.a.zsb]){case 1:Ma=
this.jQj(S);break;case 2:Ma=this.Krj(S);break;case 4:this.d1a.clear();this.d1a.addRange(this.O4c);break;case 3:Ma=this.installContextualTab(S);break;default:Ma=!1}return Mh.Task.Ua(Ma)};Z.prototype.Cvj=function(S){return S&&this.Bo.Lha in S?(S=S[this.Bo.Lha])?this.d1a.contains(S):!1:!1};Z.prototype.jQj=function(S){var Ma=null,Gb=null,hc=null,Yc=!0;void 0!==S[jf.a.C3]&&null!==S[jf.a.C3]&&void 0!==S[this.Bo.Lha]&&null!==S[this.Bo.Lha]&&void 0!==S[jf.a.B3]&&null!==S[jf.a.B3]&&(Ma=S[jf.a.C3],Gb=S[jf.a.j7b],
hc=S[this.Bo.Lha],Yc=S[jf.a.B3]);if(!Ma||!hc)return ae.ULS.sendTraceTag(537170649,220,15,"UpdateControlEnableState failed to get solutionId or controlId."),!1;S=(new gj.a(this.$.yb,Ma,this.Bo,!0)).HJa(hc);Ma={DynamicAddinCommandsApiName:"UpdateControlEnableState"};Ma.AssetId=Gb;Ma.MaskedTabId=S;Ma.IsToEnable=Yc;ae.ULS.sendTraceTag(537170648,220,50,jg.a.xc(Ma));this.UTd(S,Yc);Xh.a.qA.updateCommandUI();return!0};Z.prototype.Krj=function(S){var Ma,Gb,hc=null,Yc=null,ed=null,xd=null,Ed=!0;void 0!==S[jf.a.u6c]&&
null!==S[jf.a.u6c]&&void 0!==S[jf.a.C3]&&null!==S[jf.a.C3]&&void 0!==S[this.Bo.Lha]&&null!==S[this.Bo.Lha]&&void 0!==S[jf.a.B3]&&null!==S[jf.a.B3]&&(hc=S[jf.a.u6c],Yc=S[jf.a.C3],ed=S[jf.a.j7b],xd=S[this.Bo.Lha],Ed=S[jf.a.B3]);if(!hc||!Yc||!xd)return ae.ULS.sendTraceTag(537170647,220,15,"SetRibbonTabVisible failed to get storeType or solutionId or tabId."),!1;S=(new gj.a(this.$.yb,Yc,this.Bo,!0)).Q1e(xd);xd={DynamicAddinCommandsApiName:"SetRibbonTabVisible"};xd.StoreType=hc;xd.AssetId=ed;xd.MaskedTabId=
S;xd.IsToShow=Ed;ae.ULS.sendTraceTag(537170646,220,15,jg.a.xc(xd));Yc=this.Iga.Eia(hc,Yc,1);hc=!1;if(null===(Gb=null===(Ma=null===Yc||void 0===Yc?void 0:Yc.to)||void 0===Ma?void 0:Ma.QV)||void 0===Gb?0:Gb.Bs)for(Ma=bk(Yc.to.QV.Bs),Gb=Ma.next();!Gb.done;Gb=Ma.next())if(Gb.value.id===S){hc=!0;break}if(!hc)return ae.ULS.sendTraceTag(537170645,220,15,"SetRibbonTabVisible failed to get contextual tabs"),!1;Ma=[];Ed?appChrome.selectors.getSelectedTabId()!==S&&Ma.push(appChrome.actions.activateRibbonTab(S)):
(appChrome.selectors.getSelectedTabId()===S&&Ma.push(appChrome.actions.setCurrentTab(gh.a.mW)),Ma.push(appChrome.actions.deactivateRibbonTab(S)));appChrome.api.dispatch(Ma);return!0};Z.prototype.installContextualTab=function(S){var Ma=null,Gb=null,hc=null,Yc=null;if(void 0!==S[jf.a.C3]&&null!==S[jf.a.C3]&&void 0!==S[jf.a.B3]&&null!==S[jf.a.B3]){var ed=S[jf.a.B3];Ma=S[jf.a.C3];void 0!==ed[jf.a.rIa]&&null!==ed[jf.a.rIa]&&void 0!==ed[jf.a.sIa]&&null!==ed[jf.a.sIa]&&(Gb=ed[jf.a.rIa],hc=ed[jf.a.sIa],Yc=
ed[jf.a.v6c])}if(!(Ma&&hc&&Gb&&Yc))return ae.ULS.sendTraceTag(537170644,220,15,"InstallContextualTab failed to invalid parameters"),!1;S=this.Iga.Eia(Yc.PrimaryMarketplace.MarketplaceType,Yc.PrimaryMarketplace.SolutionId,1);if(null===S||void 0===S?0:S.to)return ae.ULS.sendTraceTag(537170643,220,15,"InstallContextualTab was called multiple times"),!1;S={};S.solutionId=Yc.PrimaryMarketplace.SolutionId;S.version=Yc.PrimaryMarketplace.SolutionVersion;S.storeType=Yc.PrimaryMarketplace.MarketplaceType;
S.storeId=Yc.PrimaryMarketplace.MarketplaceRef;S.assetId=Yc.PrimaryMarketplace.SolutionId;S.assetStoreId=Yc.PrimaryMarketplace.MarketplaceRef;S.targetType=Yc.WebExtensionOsfControlType;S.width=Yc.TaskpaneWidth;S.height=0;S.isAddinCommands=!0;Yc=new df.a;Yc.add(S);S={};S[jf.a.knb]=Yc;S[jf.a.mP]=6;S[jf.a.rIa]=Gb;S[jf.a.sIa]=hc;this.nBb(S);return!0};Object(Id.a)(Z,"AddinUICommandHandler",null,[850,429,3]);var Ej=b(68),Fj=b(696),Gj=b(18),Uj=b(17),Hj=Rh.a;Rk(ha,Hj);ha.prototype.Ad=function(){var S=this;
ae.ULS.sendTraceTag(38410432,0,50,"AddinUICommandHandlerFactory.CreateCommandHandlersAsync");Ej.a(this.$).add(Object(Vg.a)(new Fj.a,{kwc:function(){var Ma=S.$.ea.bF&&S.$.ea.dc&&!!(S.$.Cd&16384)&&S.$.isEditMode;S.$.ea.dc&&ae.ULS.sendTraceTag(38410433,0,50,"AddinUICommandHandlerFactory.CreateCommandHandlersAsync FeatureActivator: shouldActivate [{0}] IsSessionFullyLoaded [{1}] IsSessionActive [{2}] ShowCommandUI [{3}] IsEditMode [{4}]",Ma,S.$.ea.bF,S.$.ea.dc,!!(S.$.Cd&16384),S.$.isEditMode);return Ma},
VXb:this.dzg,C5b:this.ubh,utb:2}))};ha.prototype.b7i=function(S){var Ma=this,Gb=Lg.GetServiceTaskFactory.create(this.$.da,102,this.la,this.hb);return $f.TaskExtensions.Aa(Gb,function(){ae.ULS.sendTraceTag(38942483,0,50,"AddinUICommandHandlerFactory.RegisterContextMenuExtensibilityService ribbonControlManagerTask finished.");Ma.$.da.Ga(204,new xe(Gb.result,S))},this.la,3)};ha.ka=function(S){Rh.a.Qd(199,new ha(S))};Object(Id.a)(ha,"AddinUICommandHandlerFactory",Rh.a,[]);var Ij=b(1392),Vj=b(1397),Ni=
Ve.a;Rk(ma,Ni);ma.prototype.create=function(){var S=this,Ma;if(ef.EwaSettings.ma(402)){var Gb=Lg.GetServiceTaskFactory.create(this.$.da,106,this.$.la,this.hb),hc=Lg.GetServiceTaskFactory.create(this.$.da,396,this.$.la,this.hb);$f.TaskExtensions.Aa(Mh.Task.oL(Gb,hc),function(){S.pb(S.$.da.za(278)||new Ij.CustomFunctionsInstaller(S.$,Gb.result,hc.result))},this.$.la,3)}else(Ma=this.$.da.za(278))||(Ma=this.$.da.Ga(278,new Vj.CustomFunctionsLegacyInstaller(this.$))),this.pb(Ma)};ma.ka=function(S){S.da.Ga(279,
new ma(S))};Object(Id.a)(ma,"CustomFunctionsInstallerFactory",Ve.a,[]);var zi=b(89),Jj=b(47),Wj=b(44);ya.prototype.ka=function(S){this.IWc?ae.ULS.sendTraceTag(537170629,0,10,"The instance AgaveOnSelectedReadoutHandler should not attach multiple times."):(this.IWc=!0,this.wPa={},this.xPa={},S?S.TDg(this.S9f):ae.ULS.sendTraceTag(537170628,0,10,"The AgaveOnSelectedReadoutHandler should not attach to a null object."))};ya.prototype.detach=function(S){if(S){S.baj(this.S9f);S=this.wPa;for(var Ma in S)zi.a.Ia(S[Ma]);
this.xPa=this.wPa=null;this.IWc=!1}else ae.ULS.sendTraceTag(537170627,0,10,"The AgaveOnSelectedReadoutHandler should not detach from a null object.")};ya.prototype.CLf=function(S,Ma,Gb){if(this.Odi(Gb,S))return!1;S=Ma.querySelector("iframe");if(!S)return ae.ULS.sendTraceTag(537170595,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."),!0;S=S.title;if(!S||!S.length)return ae.ULS.sendTraceTag(537170594,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."),
!0;this.ariaLiveNotifier.readText(S);return!0};ya.prototype.Odi=function(S,Ma){return(S=S.Qh.getOsfControl(Ma))?S.getPageStatus()!==OSF.OsfControlPageStatus.Ready:!0};Object(Id.a)(ya,"AgaveOnSelectedReadoutHandler",null,[794]);var ij=Ve.a;Rk(ab,ij);ab.prototype.create=function(){var S=this,Ma=this.$.da;$f.TaskExtensions.Aa(Lg.GetServiceTaskFactory.Ra(Ma,211,212,this.hb),function(Gb){Gb=Ma.za(224)||new ya(Gb.result,S.$);S.pb(Gb)},this.la,3)};ab.ka=function(S){S.da.Ga(225,new ab(S))};Object(Id.a)(ab,
"AgaveOnSelectedReadoutHandlerFactory",Ve.a,[]);var Mg=b(947),uh=b(53),Oi=b(246);Ob.prototype.T4e=function(S){try{if(S&&S.rawEvent&&S.rawEvent.origin&&this.iframe&&this.iframe.id){var Ma=this.TEf(S.rawEvent.origin),Gb=this.TEf(document.domain);if(Kg.a.Ik().equals(Gb,Ma))if(S.rawEvent.source&&S.rawEvent.source.frameElement&&S.rawEvent.source.frameElement.id&&Kg.a.Ik().equals(S.rawEvent.source.frameElement.id,this.iframe.id)){Ma=null;try{Ma=JSON.parse(S.rawEvent.data)}catch(hc){ae.ULS.sendTraceTag(39112971,
344,50,"AuthenticationProxy.HandleResponse: The received response is malformed or not intended for the privateCatalogIframe: {0}",hc.message)}Ma?(Ma.statusCode!==Oi.a.JO||void 0!==Ma.error&&Ma.error?(ae.ULS.sendTraceTag(23707648,344,50,"Authentication proxy returned a result but the operation failed. statusCode '{0}', Error: '{1}'",Ma.statusCode,Ma.error),this.onError()):(ae.ULS.sendTraceTag(23705827,344,100,"Received response from authentication proxy."),this.onSuccess(Ma.authorizationCode?Ma.authorizationCode:
Ma.signInUrl)),$removeHandler(window,"message",Object(Dg.a)(this,this.T4e,"handleResponse")),this.iframe?document.body.contains(this.iframe)?document.body.removeChild(this.iframe):ae.ULS.sendTraceTag(24978499,344,15,"The iframe is not a child of Body."):ae.ULS.sendTraceTag(24978500,344,15,"The iframe is null.")):ae.ULS.sendTraceTag(575976219,344,50,"AuthenticationProxy.HandleResponse: this was not our message, just wait for right one.")}else ae.ULS.sendTraceTag(51451614,344,50,"AuthenticationProxy ResponseHandler skipped processing for event. Event does not originate from expected iFrame.");
else ae.ULS.sendTraceTag(51451613,344,50,"AuthenticationProxy ResponseHandler skipped processing for event. Failed validate event origin.")}else ae.ULS.sendTraceTag(51418200,344,50,"AuthenticationProxy ResponseHandler skipped processing for event.")}catch(hc){ae.ULS.sendTraceTag(23707649,344,10,"Exception in authentication proxy message handler: {0}.",hc.message)}};Ob.prototype.TEf=function(S){var Ma="";try{S&&(Ma=-1<S.indexOf("//")?S.split("/")[2]:S.split("/")[0])&&(Ma=Ma.split(":")[0],Ma=Ma.split("?")[0])}catch(Gb){ae.ULS.sendTraceTag(51451615,
344,10,"Failed to parse host name from url: {0}",Gb.message)}return Ma};Ob.ka=function(S,Ma,Gb){new Ob(S,Ma,Gb)};Object(Id.a)(Ob,"ResponseHandler",null,[]);var Pi=b(260);ec.prototype.tryAuthenticate=function(S,Ma){this.r$a(ec.Bpg,function(){S()},Ma)};ec.prototype.tryAuthorize=function(S,Ma){this.r$a(ec.wkg,S,Ma)};ec.prototype.getSignInUrl=function(S,Ma){this.r$a(ec.Qfe,S,Ma)};ec.prototype.signOut=function(S,Ma){this.r$a(ec.Uvg,S,Ma)};ec.prototype.r$a=function(S,Ma,Gb){var hc=new Pi.QueryStringBuilder("AuthenticationProxyHandler.aspx");
hc.Ei("responseType",S);hf.AFrameworkApplication.ZXa(hc);hc=String.format("{0}{1}&{2}",this.dFa,hc.toString(),hf.AFrameworkApplication.Yi);var Yc=document.createElement("iframe");Yc.setAttribute("id","privateCatalogIframe");Yc.setAttribute("name","privateCatalogIframe");Yc.setAttribute("style","display: none");Kg.a.Ik().equals(S,ec.Qfe)||Yc.setAttribute("sandbox","allow-scripts allow-forms allow-same-origin allow-popups allow-pointer-lock");Ob.ka(Yc,Ma,Gb);Yc.setAttribute("src",hc);document.body.appendChild(Yc)};
ec.wkg="authcode";ec.Bpg="identitytoken";ec.Qfe="signinurl";ec.Uvg="signout";Object(Id.a)(ec,"AuthenticationProxy",null,[]);yb.getUserId="getUserId";yb.getLastStoreUpdate="laststoreupdate";yb.getEntitlement="getEntitlements";yb.getEToken="getEToken";yb.getManifest="getManifest";yb.getAppState="getAppState";yb.getKilledApps="getRemovedAddins";yb.getAppDetails="getAppDetails";yb.removeApps="removeAddin";yb.getLastPrivateCatalogUpdate="getLastPrivateCatalogUpdate";yb.getPrivateCatalogAddIns="getAddIns";
yb.getPrivateCatalogManifests="getAppManifests";yb.isStoreDisabled="isStoreDisabled";Object(Id.a)(yb,"S2SWebRequestActions",null,[]);var Oh=b(640);qb.prototype.getUserId=function(S,Ma){var Gb=new df.a;Gb.add(new Vf.a("corr",S));this.OW(yb.getUserId,Gb,1,Ma)};qb.prototype.getLastStoreUpdate=function(S,Ma,Gb){var hc=new df.a;hc.add(new Vf.a("lc",S));hc.add(new Vf.a("corr",Ma));this.OW(yb.getLastStoreUpdate,hc,1,Gb)};qb.prototype.getEntitlement=function(S,Ma,Gb,hc){S=new df.a;S.add(new Vf.a("av",Ma));
S.add(new Vf.a("corr",Gb));this.OW(yb.getEntitlement,S,1,hc)};qb.prototype.getEToken=function(S,Ma,Gb,hc,Yc,ed){var xd=new df.a;xd.add(new Vf.a("cmu",S));xd.add(new Vf.a("cmf",Ma));xd.add(new Vf.a("assetid",Gb));xd.add(new Vf.a("expver",hc));xd.add(new Vf.a("corr",Yc));this.OW(yb.getEToken,xd,1,ed)};qb.prototype.getManifest=function(S,Ma,Gb,hc){var Yc=new df.a;Yc.add(new Vf.a("cmu",S));Yc.add(new Vf.a("assetid",Ma));Yc.add(new Vf.a("corr",Gb));this.OW(yb.getManifest,Yc,1,hc)};qb.prototype.getAppState=
function(S,Ma,Gb){var hc=new df.a;hc.add(new Vf.a("ma",S));hc.add(new Vf.a("corr",Ma));this.OW(yb.getAppState,hc,1,Gb)};qb.prototype.getKilledApps=function(S,Ma){var Gb=new df.a;Gb.add(new Vf.a("corr",S));this.OW(yb.getKilledApps,Gb,1,Ma)};qb.prototype.getAppDetails=function(S,Ma,Gb,hc){var Yc=new df.a;Yc.add(new Vf.a("cmo",S));Yc.add(new Vf.a("corr",Gb));this.sendWithBody(yb.getAppDetails,Yc,Ma,2,hc,!1)};qb.prototype.removeApps=function(S,Ma,Gb){var hc=new df.a;hc.add(new Vf.a("corr",Ma));this.sendWithBody(yb.removeApps,
hc,S,2,Gb,!1)};qb.prototype.getLastPrivateCatalogUpdate=function(S,Ma,Gb,hc,Yc,ed){var xd=new df.a;xd.add(new Vf.a("catalog","privatecatalog"));xd.add(new Vf.a("clientCode",S));xd.add(new Vf.a("clientVersion",Ma));xd.add(new Vf.a("corr",Yc));S=String.format("authorizationCode={0}&refreshToken={1}",Gb?Bh.a.$e(Gb):"",hc?Bh.a.$e(hc):"");this.sendWithBody(yb.getLastPrivateCatalogUpdate,xd,S,2,ed,!0)};qb.prototype.getPrivateCatalogAddIns=function(S,Ma,Gb,hc,Yc,ed){var xd=new df.a;xd.add(new Vf.a("catalog",
"privatecatalog"));xd.add(new Vf.a("clientCode",S));xd.add(new Vf.a("clientVersion",Ma));xd.add(new Vf.a("corr",Yc));S=String.format("authorizationCode={0}&refreshToken={1}",Gb?Bh.a.$e(Gb):"",hc?Bh.a.$e(hc):"");this.sendWithBody(yb.getPrivateCatalogAddIns,xd,S,2,ed,!0)};qb.prototype.getPrivateCatalogManifests=function(S,Ma,Gb,hc,Yc){var ed=new df.a;ed.add(new Vf.a("catalog","privatecatalog"));ed.add(new Vf.a("corr",hc));S=String.format("extensionIds={0}&authorizationCode={1}&refreshToken={2}",Bh.a.$e(S),
Ma?Bh.a.$e(Ma):"",Gb?Bh.a.$e(Gb):"");this.sendWithBody(yb.getPrivateCatalogManifests,ed,S,2,Yc,!0)};qb.prototype.isStoreDisabled=function(S,Ma){var Gb=new df.a;Gb.add(new Vf.a("corr",S));this.OW(yb.isStoreDisabled,Gb,2,Ma)};qb.prototype.OW=function(S,Ma,Gb,hc){this.sendWithBody(S,Ma,null,Gb,hc,!1)};qb.prototype.sendWithBody=function(S,Ma,Gb,hc,Yc,ed){var xd=new Pi.QueryStringBuilder("AddinServiceHandler.ashx");xd.Ei("action",S);xd.Ei("app",Oh.a[hf.AFrameworkApplication.ta.Qa.Cj]);Ma=bk(Ma);for(var Ed=
Ma.next();!Ed.done;Ed=Ma.next())Ed=Ed.value,xd.Ei(Ed.key,Ed.value);xd=String.format("{0}{1}&{2}",hf.AFrameworkApplication.ta.Qa.IV,xd.toString(),hf.AFrameworkApplication.Yi);hf.AFrameworkApplication.qd.Yl(xd,hc,Gb,null,!1,2,function(Xd){var Ud=null,ne=null;Xd&&Xd.data&&(Xd.data.responseHeaders["X-BlockedForMinor"]&&"1"===Xd.data.responseHeaders["X-BlockedForMinor"].toString()&&(Xd.data.httpStatus=451),Ud=Xd.data.Td,ne=Xd.data.responseHeaders);Yc(Xd.data.httpStatus,Ud,ne)},function(Xd){var Ud=null,
ne=null;ed&&Xd&&Xd.data&&Xd.data.Td&&(Ud=Xd.data.Td,ne=Xd.data.responseHeaders);Yc(Xd.data.httpStatus,Ud,ne);if(hf.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OEP.AddinServiceHandlerTelemetry",!0)){Ud={message:"AddinServiceHandler request failed"};Ud.code=Xd.data.httpStatus;Ud.action=S;if(Xd.data.request||Xd.data.request.get_headers())Ud["X-UserSessionId"]=Xd.data.request.get_headers()["X-UserSessionId"];408===Xd.data.httpStatus||503===Xd.data.httpStatus?ae.ULS.sendTraceTag(538784582,
220,10,JSON.stringify(Ud)):ae.ULS.sendTraceTag(18392345,220,50,JSON.stringify(Ud))}else ae.ULS.sendTraceTag(538736349,220,50,"S2S web request failed with {0}.",Xd.data.httpStatus)},null,void 0,void 0,void 0,void 0,"AddinServiceHandler_"+S,void 0,void 0,void 0,void 0,["X-UserKey"])};Object(Id.a)(qb,"S2SWebRequestManager",null,[]);var Ai=Ve.a;Rk(Wa,Ai);Wa.prototype.create=function(){var S=this;ae.ULS.sendTraceTag(537170507,0,50,"DdaFacadeServiceFactory:Create.");hf.AFrameworkApplication.disableWholeAppsForOfficeFeature?
ae.ULS.sendTraceTag(537170506,0,50,"DdaFacadeServiceFactoryError.Create not creating DdaFacadeService : DisableWholeAppsForOfficeFeature [{0}]",hf.AFrameworkApplication.disableWholeAppsForOfficeFeature):ef.EwaSettings.ma(406)?fh.a.instance.Tb("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(Ma){Ma.isFeatureEnabled("mso_officeStore",!0).then(function(Gb){Mg.DdaFacade.J1c=Gb;S.RCe();return null})}):this.RCe()};Wa.prototype.RCe=function(){var S=this,Ma=Lg.GetServiceTaskFactory.Ra(this.$.da,
224,225,this.hb),Gb=uh.a.Isd(63,function(){return!(void 0===window.OSF||null===window.OSF)},this.$.ya.MaxRetriesForLoadingScript,this.$.la,this.hb,106),hc=Cb(this.la,this.hb);$f.TaskExtensions.Aa($f.TaskExtensions.Vd([Ma,Gb,hc],this.$.la),function(){"undefined"===typeof OfficeExt||"undefined"===typeof OSF?ae.ULS.sendTraceTag(537170505,0,15,"DdaFacadeServiceFactoryError.Create not creating DdaFacadeService. OfficeExt/OSF shouldn't be undefined. Stack: {0}",Mi.a.d3()):S.e9h();ae.ULS.sendTraceTag(537170504,
0,50,"DdaFacadeServiceFactoryError.Create: DdaFacadeService created");S.BLf=Ma.result;S.pb(S.se);ae.ULS.sendTraceTag(537170503,0,50,"VSO#2693929: ServiceCreatedEvent is registered.")},this.la,3)};Wa.prototype.e9h=function(){ef.EwaSettings.ma(65)&&OfficeExt.S2SOmexCatalogService.initRequestHandler(new qb);this.$.Jf.get(35)&&OfficeExt.PrivateCatalogService.initRequestHandler(new qb,new ec(hf.AFrameworkApplication.fa.appSettings.WebServiceBase),ef.EwaSettings.ma(72),ef.EwaSettings.ma(433));OfficeExt.MosRequestHandler.init&&
OfficeExt.MosRequestHandler.init(new qb)};Wa.prototype.dispose=function(){zi.a.Ia(this.ddaFacade);this.$=this.ddaFacade=null;Ai.prototype.dispose.call(this)};Wa.ka=function(S){new Wa(S)};Mf.Object.defineProperties(Wa.prototype,{se:{configurable:!0,enumerable:!0,get:function(){return this.ddaFacade||(this.ddaFacade=new Mg.DdaFacade(this.$,this.BLf))}}});Object(Id.a)(Wa,"DdaFacadeServiceFactory",Ve.a,[]);var Bi=b(493);vb.prototype.Qc=function(){return!1};vb.prototype.Lc=function(){return!1};vb.prototype.zc=
function(S,Ma,Gb,hc){var Yc=!1;switch(Ma.command){case -684355545:Yc=!0;break;case -741808261:Yc=!!Gb;break;case -859308420:Yc=!!hc&&1===hc.ox;break;case 418618014:Yc=1===S&&!!hc&&1===hc.ox;break;case -515602470:Ma=ef.EwaSettings.ma(235)&&2===S;Yc=(1===S||Ma)&&!!hc&&1===hc.ox;break;case 2086613372:Yc=ef.EwaSettings.ma(235)&&2===S&&!!hc&&1===hc.ox;break;case -1336341324:Yc=ef.EwaSettings.ma(481)&&1===S&&!!hc&&1===hc.ox;break;case 451940422:Yc=ef.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AnalyzeDataInAutoFilter",
!1)&&1===S&&!!hc&&1===hc.ox;break;case -1444574190:case -336193495:Yc=1===S&&!!hc&&1===hc.ox;break;case 1296389134:Yc=1===S&&!!hc&&1===hc.ox;break;case -1473679467:Yc=ef.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InstalledContentAddinsRibbonExperiment",!1)&&1===S&&!!hc&&1===hc.ox;break;case 1221897806:Yc=ef.EwaSettings.ma(167)&&2===S;break;case 1172793074:case 1930653487:Yc=ef.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneData",!1)&&2===S;break;case -1753056834:Yc=
ef.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LinkedEntityRefreshMenu",!1);break;case 932597253:Yc=!0;break;case 301511274:Yc=ef.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NavigationPaneWeb",!1);break;case 515196233:Yc=ef.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammer",!1)&&this.$.isEditMode;break;case 1723441034:Yc=this.$.isEditMode&&this.$.ea.YKb}return Yc};vb.prototype.executeCommand=function(S,Ma,Gb){var hc=$f.TaskExtensions.jk(),
Yc=Ma.command;switch(Ma.command){case -1473679467:Bi.a(this.$,488,489,1,function(ed){hc=ed.fbi(Gb.SourceControlId,Ma)});break;case 1296389134:this.agaveCommandManager.PDj(Gb.SourceControlId,Gb.LabelText);break;case -684355545:this.agaveCommandManager.cZc();break;case -741808261:hc=this.agaveCommandManager.insertAgave(Gb,Ma);Bi.a(this.$,488,489,1,function(ed){ed.Dzg(Gb)});break;case -1336341324:ef.EwaSettings.ma(481)&&(hc=this.agaveCommandManager.ehd(Gb,S,Ma));break;case 1172793074:ef.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneData",
!1)&&(hc=this.agaveCommandManager.ehd(Gb,S,Ma));break;case -859308420:case -515602470:case 2086613372:case -336193495:case -1444574190:case 451940422:case 418618014:case 1221897806:case 1930653487:case -1753056834:case 932597253:case 301511274:case 515196233:case 1723441034:hc=this.agaveCommandManager.ehd(Gb,S,Ma);break;default:hc=Sf.a(Yc)}return hc};Object(Id.a)(vb,"AgaveCommandHandler",null,[429]);Object(Id.a)(kb,"Selection",null,[]);var vd=b(1505),$d=b(1504),Kj=b(1506),Wg=b(1595),jj=b(1507);Object(Id.a)(Yb,
"SmartLookupApplicationInterface",null,[]);Object(Id.a)(Fb,"ApplicationProperties",null,[]);Object(Id.a)(zb,"EnterpriseUserInfo",null,[]);Object(Id.a)(La,"FeatureGates",null,[]);ib.prototype.XWh=function(){var S=void 0===S?!0:S;var Ma=this.cFe();if(Ma<this.gud+this.SJj)return Ma>this.gud+this.VJj&&this.Rbd(),this.vmf;S&&this.Rbd();return""};ib.prototype.Rbd=function(){var S=this;this.jud=this.jud||new Promise(function(Ma){S.YWh().then(function(Gb){S.vmf=Gb;S.gud=S.cFe();S.jud=null;Ma(Gb)})})};ib.prototype.YWh=
function(){var S=this;return this.c8a&&this.c8a.length?new Promise(function(Ma){S.zxa.xO("SmartLookup",S.c8a).then(function(Gb){Gb.IsSuccess?Gb.Token||(Ma(""),ae.ULS.sendTraceTag(51446545,1313,15,"SmartLookupManager - The AAD token is empty")):(ae.ULS.sendTraceTag(51446544,1313,15,"SmartLookupManager - Failed to get AAD token with error: "+Gb.ErrorCode+": "+Gb.ErrorMessage),Ma(""));Ma(Gb.Token)}).catch(function(Gb){Gb=Eh.c(Gb);ae.ULS.sendTraceTag(51446546,1313,15,"SmartLookupManager - Failed to get AAD token with exception: "+
Gb);Ma("")})}):(ae.ULS.sendTraceTag(51446543,1313,10,"SmartLookupManager - Missing service endpoint: "),Promise.resolve(""))};Object(Id.a)(ib,"SmartLookupAuthenticationManager",null,[398]);ob.$Mh=function(){switch(Object(rg.a)(String,hf.AFrameworkApplication.Ob.AudienceGroup)||""){case "Dogfood":if(hf.AFrameworkApplication.fa){var S=hf.AFrameworkApplication.fa.Wa("UserPrincipalName");S=Bh.a.al(S);var Ma=hf.AFrameworkApplication.fa.Zn("SmartLookupINTEnabledForSKITeam")?hf.AFrameworkApplication.fa.dw("SmartLookupINTEnabledForSKITeam"):
[];return 0<=Array.indexOf(Ma,S)?"INT":"EDOG"}return"EDOG";default:return"PROD"}};ob.uWh=function(){switch(hf.AFrameworkApplication.fa.qa("IntentSvcEnableEdogSourceLocationOverride")?"EDOG":hf.AFrameworkApplication.fa.qa("IntentSvcEnableProdSourceLocationOverride")?"PROD":hf.AFrameworkApplication.fa.qa("IntentSvcEnableIntSourceLocationOverride")?"INT":ob.$Mh()){case "INT":return"wss://augmentation.osi.office-int.net/officeaugmentation/searchendpoint/";case "EDOG":return"wss://augmentation.osi.officeppe.net/officeaugmentation/searchendpoint/";
default:return"wss://augmentation.osi.office.net/officeaugmentation/searchendpoint/"}};Object(Id.a)(ob,"Utils",null,[]);var Lj=b(619),pi=b(178);Ha.prototype.FHh=function(){return Promise.resolve(this.GHh())};Ha.prototype.GHh=function(){var S=new Fb;S.anid="";S.applicationVersion=hf.AFrameworkApplication.buildVersion;S.appCorrelationId=pi.a.create().toString();S.themePlatform=Ha.bWj;S.lcid=hf.AFrameworkApplication.lcid;S.launchUtcTime=(new Date).toUTCString();S.featureGates=this.b8a;var Ma=Lj.a.aH(hf.AFrameworkApplication.lcid);
Ma=Ma?Ma.name:null;S.market=this.rac(Ma);S.uiLanguage=Ma;S.sessionId=hf.AFrameworkApplication.userSessionId;S.themeId=0;S.parentalControl=Ha.VVi;var Gb=new zb;Gb.CountryCode=this.rac(Ma);Gb.ServiceEndpoint=this.c8a;Gb.IsGoLocal=!1;Gb.IsEnabled=this.bnf;Gb.IsEnterpriseEnabled=this.bnf;Gb.TenantRoot=this.$wi;S.enterpriseUserInfo=Gb;S.accessToken=this.Uwi.XWh();return S};Ha.prototype.rac=function(S){S=S.split("-");return S[S.length-1]};Mf.Object.defineProperties(Ha.prototype,{approvedOriginPattern:{configurable:!0,
enumerable:!0,get:function(){return this.uwi}}});Ha.bWj="web";Ha.VVi="yes";Object(Id.a)(Ha,"SmartLookupManager",null,[354]);var kj=ai.a;Rk(Ia,kj);Ia.prototype.Qc=function(){return!1};Ia.prototype.Lc=function(){return!1};Ia.prototype.zc=function(S,Ma){S=ef.EwaSettings.ma(135);return-983891024===Ma.command&&S};Ia.prototype.executeCommand=function(S,Ma){S=$f.TaskExtensions.jk();-983891024===Ma.command&&this.wqi();return S};Ia.prototype.wqi=function(){var S=this,Ma=new Ha(null),Gb={},hc=Ng.g(this.$).Ub(null).originalText;
hc=Object(Vg.a)(new kb,{neighborhood:hc,mentionStart:0,mentionLength:hc?hc.length:0});var Yc=Object(Vg.a)(new Yb,{selection:hc,entryPoint:0});Ma.FHh().then(function(xd){xd.applicationName=Ia.appName;xd.isFirstLaunch=S.isFirstLaunch;xd.themeId=5;Gb[Ia.smartLookupApplicationInterface]=JSON.stringify(Yc);Gb[Ia.lJg]=JSON.stringify(xd);S.isFirstLaunch=!1});Ma=new vd.a("ExcelOnline","Web","en-Us");hc=new $d.a("FA000000006",OSF.StoreType.FirstParty,OSF.StoreType.FirstParty,"1.0.0.0");var ed=new Kj.a;ed.optionalProperties[Wg.a.Qk]=
gg.a.instance.ga(1785);ed.optionalProperties[Wg.a.taskPaneWidth]=350;ed.optionalProperties[Wg.a.sourceLocationOverrideResourceId]="WAC.PROD.URL";ed.kq=Gb;jj.a.instance.XMa(hc,"Taskpane","SmartLookupSDXTaskpane",Ma,ed)};Ia.lJg="AppProperties";Ia.appName="Excel";Ia.smartLookupApplicationInterface="SmartLookupApplicationInterface";Object(Id.a)(Ia,"SmartLookupCommandHandler",ai.a,[429]);var hi=Rh.a;Rk(V,hi);V.prototype.Ad=function(){var S=this;Bi.a(this.$,374,375,this.hb,function(Ma){S.jd([new vb(S.$,
null,null,null,null,Ma),new Ia(S.$)])})};V.ka=function(S){Rh.a.Qd(76,new V(S))};Object(Id.a)(V,"AgaveCommandHandlerFactory",Rh.a,[]);Object(Id.a)(sa,"AppsDataManager",null,[351]);var Yh=b(1519),ii=b(107);za.prototype.initialize=function(S){za.initialized||(this.se=S,this.Bg(),za.initialized=!0)};za.prototype.Bg=function(){hf.AFrameworkApplication.ub.He(Eg.a.Y$a,ii.a.frame,this.Y$a,96);hf.AFrameworkApplication.ub.Mb(Eg.a.S6i,ii.a.frame,this.$7i)};Mf.Object.defineProperties(za,{instance:{configurable:!0,
enumerable:!0,get:function(){za.Ma||(za.Ma=new za);return za.Ma}}});za.Ma=null;za.initialized=!1;Object(Id.a)(za,"AgaveCommandActor",null,[]);var Fh=b(1562),Mj=b(1509),ci=b(113),qi=b(369),ri=b(366),wg=b(1441),Xg=b(19),Ci=b(357);Object(Id.a)(ta,"FirstPartyAddinTaskpaneOverrides",null,[]);Object(Id.a)(ia,"IdeasSelectionContext",null,[]);Rk(na,ia);Object(Id.a)(na,"IdeasTableSelectionContext",ia,[]);Object(Id.a)(function(){this.sheetName=null;this.lastRow=this.firstRow=this.lastColumn=this.firstColumn=
0},"AutoFilterRange",null,[]);Object(Id.a)(qa,"IdeasAutoFilterSource",null,[]);Object(Id.a)(da,"IdeasXLIMTableBoundaries",null,[]);var Yg=b(62),ph=b(1167),Ch=b(64),lj=b(133),zf=b(45),ji=b(564),Zh=b(388),Og=b(177),vh=b(169),mj=b(629),Tf=b(294),Di=b(105),nj=b(134),Qi=b(50),oj=b(150),di=b(183),Ri=oj.a;Rk(xa,Ri);xa.prototype.$C=function(){Ri.prototype.$C.call(this);this.np.style.width=this.p1d;this.np.style.height=this.MUa;this.np.style.marginTop=this.iRb;this.np.style.padding=this.NUa};xa.prototype.sPa=
function(){this.np.style.width=this.p1d;this.np.style.height=this.MUa;this.np.style.marginTop=this.iRb;this.np.style.padding=this.NUa;this.RCa>di.a.e$a?(this.Db.style.width=String.format("{0}px",di.a.e$a),this.Db.style.overflowX="scroll",hf.AFrameworkApplication.isRtl?this.Db.style.right="0":this.Db.style.left="0"):(this.Db.style.width=String.format("{0}px",this.RCa),this.Db.style.overflowX="hidden");this.Db.offsetHeight>di.a.d$a||this.Zmg+50>di.a.d$a?(this.Db.style.height=String.format("{0}px",di.a.d$a),
this.Db.style.overflowY="scroll",this.Db.style.top="0",hf.AFrameworkApplication.isRtl?this.Db.style.right="0":this.Db.style.left="0",this.iHc||(this.Db.style.marginTop="-48px"),this.np.style.minHeight=String.format("{0}px",this.Lkg)):(this.Db.style.overflowY="hidden",this.Db.style.top="10%",this.Db.style.height=this.Bhb);this.m_a()};xa.prototype.m_a=function(){if(this.Db){var S=this.Db.style.zIndex;this.Db.style.zIndex="-9999";if(this.RCa>di.a.e$a)hf.AFrameworkApplication.isRtl?this.Db.style.marginRight=
"0":this.Db.style.marginLeft="0";else{var Ma=String.format("{0}px",Math.floor(-this.Db.offsetWidth/2));hf.AFrameworkApplication.isRtl?this.Db.style.marginRight=Ma:this.Db.style.marginLeft=Ma;hf.AFrameworkApplication.isRtl?this.Db.style.right="50%":this.Db.style.left="50%"}this.Db.style.zIndex=String(S)}else ae.ULS.sendTraceTag(19976784,306,10,"_divMessageBox is null in CenterDialog()")};xa.prototype.fO=function(){Ri.prototype.fO.call(this);var S=document.getElementById(this.$h(this.Ymg));S.style.width=
String.format("{0}px",this.RCa);S.style.height=this.Bhb};Mf.Object.defineProperties(xa.prototype,{Z0a:{configurable:!0,enumerable:!0,get:function(){return this.np}}});Object(Id.a)(xa,"AppsForOfficeInsertionDialog",oj.a,[395]);var Sh=b(1168),Xj=b(187),Nj=b(638),Si;(function(S){S[S.Valid=2]="Valid";S[S.Invalid=4]="Invalid";S[S.All=6]="All"})(Si||(Si={}));Object(Id.b)("MetadataState",Si);var Yj=b(354),pj=ai.a;Rk(Ga,pj);Ga.prototype.LEg=function(S){this.addHandler(Ga.kBd,S)};Ga.prototype.Maj=function(S){this.removeHandler(Ga.kBd,
S)};Ga.prototype.dispose=function(){zi.a.Ia(this.Wva);this.Wva=null;this.Bab&&(this.$.ea.mn(this.aHd),this.Bab=!1);pj.prototype.dispose.call(this)};Ga.prototype.cZc=function(){this.Wva.hide()};Ga.prototype.PDj=function(S,Ma){if(S){this.raiseEvent(Ga.kBd);var Gb=S.split("|");this.Dui(S,Ma,Gb);this.Wva=new xa;this.Wva.initializeAndShow("",null,null);this.se.Pqi(this.Wva.Z0a,Gb)}};Ga.prototype.ehd=function(S,Ma,Gb){var hc=$f.TaskExtensions.jk();if(-515602470===Gb.command||-336193495===Gb.command||2086613372===
Gb.command||-1444574190===Gb.command||-1336341324===Gb.command||451940422===Gb.command)hc=this.b2h(S,Ma,Gb);418618014===Gb.command&&(Ma=new Fh.a,Ma.Qk=gg.a.instance.ga(1798),hc=this.u7(Gb,Ga.k5h,Ma,!0));if((Gb.tabName===this.$.yb+gh.a.aTf||Gb.tabName===gh.a.lW)&&2===Gb.Le||-1!==Array.indexOf("A0 A1 Help ContactSupport WhatsNew GiveFeedback".split(" "),S[oh.a.Nc])||S[oh.a.Nc]===gh.a.CQ)return this.x4e(S,Gb);if(7===Gb.Le&&S.SourceControlId===this.$.yb+gh.a.tcc)return S.MenuItemId=gh.a.YFd,this.x4e(S,
Gb);1221897806===Gb.command&&(hc=this.$1f(Gb,"Format"));if(1930653487===Gb.command||1172793074===Gb.command)hc=this.$1f(Gb,"Data");-1753056834===Gb.command&&(hc=this.Czj(Gb));932597253===Gb.command&&(ae.ULS.sendTraceTag(537170445,0,50,"InsertPowerBIPivotTable - addin launch requested"),Xj.c(932597253,!0),Ma=new Fh.a,Ma.Qk=gg.a.instance.ga(2133),Ma.sourceLocationOverrideResourceId=ef.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerBIUseDevURL",!1)?Ga.xZi:Ga.zZi,Ma.focusOnIframeWhenLoaded=
!0,Ma.taskPaneWidth=Ga.f8e,hc={},hc.LaunchSource=Object(rg.a)(String,S.SourceControlId),hc.LaunchMode="Default",Ma.PH=hc,hc=this.u7(Gb,Ga.yZi,Ma,!0));301511274===Gb.command&&(hc=this.Mzj(Gb));515196233===Gb.command&&((Ma=this.$.da.za(465))&&Ma.I6e(),Ma=new Fh.a,Ma.Qk=gg.a.instance.ga(2203),hc={},hc.SourceUILocation=qi.a[Gb.Le],Ma.PH=hc,hc=new ph.a,hc.s4=Xg.a.X1a,hc=this.u7(Gb,Ga.KUi,Ma,!0,hc,void 0,Ma.Qk));1723441034===Gb.command&&(Ma=new Fh.a,Ma.Qk=gg.a.instance.ga(2215),Ma.focusOnIframeWhenLoaded=
!0,Ma.taskPaneWidth=Ga.r1i,hc=new ph.a,hc.s4=Xg.a.Eoh,hc=this.u7(Gb,Nj.a,Ma,!0,hc));ef.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataFromPictureOnXLO",!1)&&S.LoadDataFromPictureTaskpane&&(Ma={},hc=new Fh.a,hc.Qk=gg.a.instance.ga(2241),Ma.SessionID=S.SessionID,hc.PH=Ma,hc.focusOnIframeWhenLoaded=!0,hc=this.u7(Gb,S.DataFromPictureAssetId,hc,!0));return hc};Ga.prototype.insertAgave=function(S,Ma){var Gb=this,hc=$f.TaskExtensions.jk(),Yc=this.$,ed=S[jf.a.Fra];var xd=S[oh.a.Uf];var Ed=
null;ph.a.key in S&&(Ed=S[ph.a.key]);this.Wva&&this.Wva.hide();if(!xd||!ed)return ae.ULS.sendTraceTag(537170444,220,10,"Inserting addin needs inserted agave parameters"),hc;this.$.g5&&gh.a.Vda in S&&(xd.EnabledInViewMode=S[gh.a.Vda]);S=this.oKh(Ma.command);if(!xd.EnabledInViewMode&&!Yc.hq(null,!1,S))return hc;var Xd=void 0===xd.IsToBePersisted||null===xd.IsToBePersisted||xd.IsToBePersisted?0:16;if(1===xd.TargetType)hc=this.Abi(xd,ed,Ma,Ed,Xd);else{ed=Ng.g(Yc);hc=this.viewBlockContainerHelpers.mfb(ed);
var Ud=Yc.ea.isNamedObjectViewMode?Yc.pa.sheetName:Yc.pa.name;if(hc){ed=hc.Fe;var ne=ed.jf.top;var Qe=ed.jf.left;var ff=hc.xI.x;var of=hc.xI.y}else ne=Qe=1,hc=this.viewBlockContainerHelpers.nKa(ed),ff=hc.x,of=hc.y;var Jf=this.$.oa.xa.Pb();hc=function(kf,tf,xf){var Nf=Yc.oa.xa,Ef=ne,Gf=Qe,Fg=ff,Cf=of;kf=Tf.b(kf,Gb.oZi);var yg=Nf.Na(9,Jf);yg.sharedInfo=xd;yg.sheetName=Ud;yg.positionRow=Ef;yg.positionCol=Gf;yg.positionOffsetX=Fg;yg.positionOffsetY=Cf;return Yg.g(Nf,"InsertWebExtension",yg,kf,tf,xf,null,
0)};ef.EwaSettings.Zb()?(Xd|=64,hc=Zh.a(this.$.userOperationManager,hc,function(kf){return new Og.a(534,0,kf,Xd)},Ma)):hc=Zh.a(this.$.userOperationManager,hc,function(kf){return new ji.a(534,0,kf,Xd)},Ma)}return hc};Ga.prototype.a1g=function(){var S=fh.a.instance.Tb("Common.App.ICustomerFeedbackUiWrapper"),Ma=fh.a.instance.Tb("Common.App.CustomerFeedback.ICustomerFeedbackResourceDownloadManager");this.Z9c?this.Z9c.cjb?this.Vve():Ma.instance.d6c(this.Wxh):ae.ULS.sendTraceTag(537170443,1302,15,"feedbackFormManager is undefined");
Ma={};hf.AFrameworkApplication.fa.Dke(Ma);S=S.instance.getContext(Ma);Ma={};"telemetryGroup"in S&&(Ma=S.telemetryGroup);Ma.processSessionId=S.sessionId;Ma.officeBuild=S.build;S.telemetryGroup=Ma;S.feedbackType=-1;S.userVoiceEnabled=!1;"disableIncludeScreenshot"in S||(S.disableIncludeScreenshot=!1);"screenshot"in S||(S.screenshot=!1);S.disableScreenshotPreview=!1;S.includeScreenshotSelectedDefault=!0;return S};Ga.prototype.MZi=function(S){if(!this.Uya&&ef.EwaSettings.getBooleanFeatureGate(Ga.i7h,!1)){var Ma=
ef.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?"Insights.Https.PPE.Bundle":"Insights.Https.Bundle";Ma=this.zte(Ma);var Gb=new ph.a;Gb.Jk=Xg.a.u8b;Gb.s4=Xg.a.QMe;Gb.aeb=Xg.a.t8c;this.Uya=this.ILd(Ma,null,!1,null,Gb);Ma={};nj.b(this.$).yd(lj.a.NZi,(Ma.Location=qi.a[S.Le],Ma.InputMethod=ri.a[S.method],Ma),void 0,!0);ef.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PassXlimTableBoundariesToIdeas",!1)&&this.cWd()}};Ga.prototype.lYf=function(S){var Ma=this.$.ea.Jg.get(17);
fh.a.instance.Tb("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(Gb){Gb.isFeatureEnabled("mso_sendASmile",Ma).then(function(hc){S.FeedbackEnabled=Ma&&hc;return null})})};Ga.prototype.$1f=function(S,Ma){var Gb=Ng.g(this.$),hc=new Fh.a,Yc={};Yc.ActiveTab=Ma;Yc.DatapaneFlighting=ef.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneData",!1);Yc.RangePickerFlighting=ef.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneDataRangePicker",
!1);Yc.AceFlighting=!0;Yc.ChartNewSDXRecording=ef.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OfficeScriptingChartTaskPaneNewRecording",!1);Yc.ThemeColorsFlighting=ef.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1)&&ef.EwaSettings.isChangeGateEnabled("OfficeVSO:5732064_ThemeColorsInChartsTaskpaneEnabled");Yc.UOMirror=ef.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UOMirror",!1);Yc.FormatTaskPaneAceButtonDark=ef.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatTaskPaneAceButtonDark",
!1);Yc.FormatTaskPaneBetterFeedbackButton=ef.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatTaskPaneBetterFeedbackButton",!1);Yc.FormatTaskPaneBetterScrollbar=ef.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatTaskPaneBetterScrollbar",!1);this.lYf(Yc);Yc.startTimeMs=Date.now();Yc.UserSessionId=this.$.ya.UserSessionId;(Ma=Gb.ha.Oa.xo)&&(Yc.SubSelection=Ma);ae.ULS.sendTraceTag(592524688,0,50,"Chart task pane launched. UserSessionId: {0}, UILocation: {1}, SubSelection: {2}",
Yc.UserSessionId,void 0===S.Le||null===S.Le?"Null":qi.a[S.Le],Ma||"ChartRoot");hc.PH=Yc;hc.Qk=gg.a.instance.ga(976);Yc=new ph.a;Yc.s4=Xg.a.X1a;return this.u7(S,Ga.TVg,hc,!0,Yc)};Ga.prototype.Czj=function(S){var Ma=new Fh.a;Ma.PH={};Ma.Qk=gg.a.instance.ga(1784);Ma.eS=Ga.Cjf;var Gb=new ph.a;Gb.s4=Xg.a.X1a;return this.u7(S,Ga.Cjf,Ma,!0,Gb,void 0,Ma.Qk)};Ga.prototype.Mzj=function(S){var Ma=new Fh.a;Ma.PH={};Ma.Qk=gg.a.instance.ga(2157);var Gb=new ph.a;Gb.s4=Xg.a.qqh;Gb.aeb=Xg.a.VMe;return this.u7(S,Ga.dCi,
Ma,!0,Gb)};Ga.prototype.x4e=function(S,Ma){var Gb=Ga.C6e,hc=S[oh.a.Nc].toString(),Yc={},ed=new Fh.a;ed.Qk=gg.a.instance.ga(9);switch(hc){case "A0":Yc.query=(S[oh.a.Uf]||"").split("|").slice(2,Ci.a.tS).join("|");break;case "A1":Yc.query=S.CommandValueId;break;case "Help":Yc.gwdropdownflightinfo=ef.EwaSettings.ma(240);Yc.query="";break;case gh.a.YFd:ef.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FeedbackTaskPaneExperienceEnabled",!1)?(ed.Qk=gg.a.instance.ga(1750),ed.sourceLocationOverrideResourceId=
Ga.j3e,Yc.feedback=this.a1g()):Yc.query=hc;break;case "HelpArticle":Yc.query=S[oh.a.Uf];break;case "ContactSupport":case "ShowTraining":case "WhatsNew":Yc.query=hc;break;default:return Mh.Task.Ua(!0)}ed.PH=Yc;hc=new ph.a;hc.s4=Xg.a.X1a;return this.u7(Ma,Gb,ed,!1,hc,S[gh.a.Vda]||!1)};Ga.prototype.zte=function(S){var Ma={Version:"0.0.0.0"};Ma.AssetId=Ga.bLa;Ma.SolutionId=Ga.bLa;Ma.AssetStoreId="";Ma.StoreType=OSF.StoreType.Sdx;Ma.Height=0;Ma.Width=0;Ma.StoreId=OSF.StoreType.Sdx;Ma.TargetType=OSF.OsfControlTarget.TaskPane;
Ma.IsToBePersisted=!1;Ma.SourceLocationOverrideResourceId=S;Ma.SharedRuntimeId=S;return Ma};Ga.prototype.b2h=function(S,Ma,Gb){function hc(){Ed.LaunchMode="Default";ef.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?ed.sourceLocationOverrideResourceId="Insights.Https.PPE.Bundle":ed.sourceLocationOverrideResourceId="Insights.Https.Bundle";ed.Qk=gg.a.instance.ga(1797);ed.eS=Ga.wVc;ed.Jk=Xg.a.u8b;xd.Jk=Xg.a.u8b}var Yc=this,ed=new Fh.a,xd=new ph.a,Ed={};this.Uya&&this.lYf(Ed);
Ed.LaunchSource="";Ed.StartTimeMs=Date.now();Ed.CorrelationId=pi.a.create().toString();ed.PH=Ed;ed.focusOnIframeWhenLoaded=!0;ed.taskPaneWidth=Ga.f8e;xd.s4=Xg.a.QMe;xd.aeb=Xg.a.t8c;switch(Gb.command){case -1444574190:var Xd,Ud;Ed.LaunchMode="RecommendedPivotTables";Ed.SelectionContext="";Ed.LaunchSource="PivotTableHandRaise"===Object(rg.a)(String,S.SourceControlId)?"PivotTableHandRaise":"InsertPivotTable";if(this.$&&ef.EwaSettings.isChangeGateEnabled("OfficeVSO:4618462_PassSourceSelectionToIdeas")&&
S.SourceSelection){var ne=S.SourceSelection.split(",")[0];Ma=ef.EwaSettings.isChangeGateEnabled("OfficeVSO:4701499_IdeasSelectionIndexing")?-1:0;if(function(){var of=zf.Z(ne,Yc.$.va);Xd=of.sheetName;Ud=of.QGb;Qe=of.range;return of}().returnValue&&!Ng.g(this.$).Ab.d5(Qe))S=this.$.va.getItemByName(Xd),Ed.SelectionContext=JSON.stringify(Object(Vg.a)(new ia,{address:Ud,addressWithSheet:Xd+"!"+Qe.aB(!1),sheetId:Ch.d(S),sheetName:Xd,isSheetEmpty:!1,columnCount:Qe.width,rowCount:Qe.height,columnIndex:Qe.left+
Ma,rowIndex:Qe.top+Ma,selectionType:"Continuous"}));else if((S=this.$.vb.getItemByName(Object(rg.a)(String,S.SourceSelection)))&&Ch.n(S)){var Qe=vh.a(S,!0);var ff=this.$.va.getItemByName(S.sheetName);Ed.SelectionContext=JSON.stringify(Object(Vg.a)(new na,{tableName:S.name,hasTableHeaders:vh.d(S),isPivotTable:!1,isTable:!0,userSelectedPivotTable:!1,address:Qe.aB(!1),addressWithSheet:ff.name+"!"+Qe.aB(!1),sheetId:Ch.d(ff),sheetName:ff.name,isSheetEmpty:!1,columnCount:Qe.width,rowCount:Qe.height,columnIndex:Qe.left+
Ma,rowIndex:Qe.top+Ma,selectionType:"Continuous"}))}}ef.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?ed.sourceLocationOverrideResourceId="RecommendPivotTables.PPE.Bundle":ed.sourceLocationOverrideResourceId="RecommendPivotTables.Bundle";ed.Qk=gg.a.instance.ga(1796);ed.eS=Ga.MXi;ed.Jk=Xg.a.kPe;xd.Jk=Xg.a.kPe;break;case -336193495:Ed.LaunchMode="RecommendedCharts";ef.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?ed.sourceLocationOverrideResourceId=
"RecommendCharts.PPE.Bundle":ed.sourceLocationOverrideResourceId="RecommendCharts.Bundle";ed.Qk=gg.a.instance.ga(1795);ed.eS=Ga.E5i;ed.Jk=Xg.a.lPe;xd.Jk=Xg.a.lPe;break;case -1336341324:if(!ef.EwaSettings.ma(481))return Mh.Task.Ua(!1);Ed.LaunchMode="NL";ed.eS=Ga.wVc;ef.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?ed.sourceLocationOverrideResourceId="IdeasNL.PPE.Bundle":ed.sourceLocationOverrideResourceId="IdeasNL.Bundle";switch(ef.EwaSettings.getIntFeatureGate("Microsoft.Office.ExcelOnline.Insights.GridContextMenuQnABrandingCandidatesIndex",
0)){case 1:ed.Qk=gg.a.instance.ga(1800);Ed.NLLaunchModeBrandingCandidatesIndex=1;break;case 2:ed.Qk=gg.a.instance.ga(1801);Ed.NLLaunchModeBrandingCandidatesIndex=2;break;default:ed.Qk=gg.a.instance.ga(1799),Ed.NLLaunchModeBrandingCandidatesIndex=0}break;case 2086613372:if(!ef.EwaSettings.ma(235))return Mh.Task.Ua(!1);Ed.LaunchMode="ChartDesigner";Ed.LaunchSelectionMode=Ma.toString();ef.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?ed.sourceLocationOverrideResourceId=
"Insights.Https.PPE.Bundle":ed.sourceLocationOverrideResourceId="Insights.Https.Bundle";ed.Qk=gg.a.instance.ga(1802);ed.eS=Ga.wVc;break;case 451940422:Ed.LaunchSource="AutoFilter";Ma=JSON.parse(S.CommandValueId);Ed.AutoFilterSource=JSON.stringify(Object.assign(new qa,{autoFilterRange:{sheetName:Ma.AutoFilterRange.SheetName,firstColumn:Ma.AutoFilterRange.FirstColumn,lastColumn:Ma.AutoFilterRange.LastColumn,firstRow:Ma.AutoFilterRange.FirstRow,lastRow:Ma.AutoFilterRange.LastRow},autoFilterType:Ma.AutoFilterType,
itemIndex:Ma.ItemIndex,id:Ma.Id}));hc();break;default:ef.EwaSettings.ma(235)&&(Ed.LaunchSelectionMode=Ma.toString()),ef.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PassXlimTableBoundariesToIdeas",!1)&&(Ed.XlimTableBoundaries=this.YXh()),hc()}ef.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?ed.sourceLocationOverrideResourceId="Insights.Https.PPE.Bundle":ed.sourceLocationOverrideResourceId="Insights.Https.Bundle";return this.Uya?this.Uya.Io(function(){return Yc.nWf(Ed,
ed)}):this.F$h(Gb,ed,xd,Ed)};Ga.prototype.F$h=function(S,Ma,Gb,hc){var Yc=this;this.Uya=this.ILd(this.zte(Ma.sourceLocationOverrideResourceId),Ma,!1,S,Gb,!1);return ef.EwaSettings.isChangeGateEnabled("OfficeVSO:6256725_NoActionMsgOnFirstInstance")?(hc.NoActionMsgOnFirstInstance=!0,this.tRa[Ga.bLa]=hc,this.Uya):this.Uya.Io(function(){return Yc.nWf(hc,Ma)})};Ga.prototype.nWf=function(S,Ma){var Gb=this.se.saa(this.se.V2a(Ga.bLa,Ma.sourceLocationOverrideResourceId));if(Gb){this.tRa[Ga.bLa]=S;var hc=this.uvd(this.se.dZ(Gb).OsfPropertyBag,
Ga.bLa);this.se.dZ(Gb).OsfPropertyBag=hc}this.XMa(Ga.bLa,"LaunchIdeasAction",S,Ma);return Mh.Task.Ua(!0)};Ga.prototype.u7=function(S,Ma,Gb,hc,Yc,ed,xd){Gb=void 0===Gb?null:Gb;hc=void 0===hc?!1:hc;Yc=void 0===Yc?null:Yc;ed=void 0===ed?!1:ed;xd=void 0===xd?null:xd;$f.TaskExtensions.jk();Gb||(Gb=new Fh.a);var Ed={Version:"0.0.0.0"};Ed.AssetId=Ma;Ed.SolutionId=Ma;Ed.AssetStoreId="";Ed.StoreType=hc?OSF.StoreType.Sdx:OSF.StoreType.FirstParty;Ed.Height=0;Ed.Width=0;Ed.StoreId=hc?OSF.StoreType.Sdx:OSF.StoreType.FirstParty;
Ed.TargetType=OSF.OsfControlTarget.TaskPane;Ed.IsToBePersisted=!1;Ed.SourceLocationOverrideResourceId=Gb.sourceLocationOverrideResourceId;if(Gb.Qk||xd)this.S$c[Ma]=Object(Vg.a)(new ta,{dzc:Gb.Qk,iUd:xd,bzc:Gb.eS});ef.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1)?(Gb.PH||(Gb.PH={}),Gb.PH.ShowFeedback=this.$.isFeedbackEnabled,this.tRa[Ma]=Gb.PH):Gb.PH&&(this.tRa[Ma]=Gb.PH);Ma={};Ma[oh.a.Uf]=Ed;xd={};xd.solutionId=Ed.SolutionId;
xd.version=Ed.Version;xd.storeType=Ed.StoreType;xd.storeId=Ed.StoreId;xd.assetId=Ed.AssetId;xd.assetStoreId=Ed.AssetStoreId;xd.height=Ed.Height;xd.targetType=Ed.TargetType;xd.width=Ed.Width;xd.isAddinCommands=!hc;Ma[jf.a.Fra]=xd;Yc||(Yc=new ph.a);Yc.focusOnIframeWhenLoaded=Gb.focusOnIframeWhenLoaded;Yc.width=Gb.taskPaneWidth;Ma[ph.a.key]=Yc;Ma[gh.a.Vda]=ed;return this.insertAgave(Ma,S)};Ga.prototype.Abi=function(S,Ma,Gb,hc,Yc){function ed(ne){ae.ULS.sendTraceTag(537170440,220,50,"Insert addincommands for {0} from {1}.",
Telemetry.PrivacyRules.GetPrivacyCompliantId(ne.solutionId,ne.storeType,ne.assetId,null,null,ne.storeId),ne.storeType);var Qe={},ff=new df.a;ff.add(ne);Qe[jf.a.knb]=ff;Qe[jf.a.mP]=3;ne=new Wh.a(Eg.a.mBb,0,Ed.$.Jc,0,null);return Ed.$.Ka.Kb(ne,Qe)}function xd(ne,Qe){var ff=ne.SolutionId;var of=OSF.OsfControl.isFirstPartyStoreString(ne.StoreType);of&&ne.SourceLocationOverrideResourceId&&(ff=Ed.se.V2a(ff,ne.SourceLocationOverrideResourceId));var Jf=Ed.se.Nwe(ff,null,ne.SharedRuntimeId);of&&(ef.EwaSettings.ma(296)&&
Jf&&(of=Ed.se.saa(ff))&&(ff=null,ff=Ed.uvd(Ed.se.dZ(of).OsfPropertyBag,ne.SolutionId),(of=Ed.se.Qh.getOsfControl(of))&&of.setSettings(ff)),ne.SharedRuntimeId&&Jf||Ed.se.Qh.refreshOsfControl(ne.SolutionId,ne.SourceLocationOverrideResourceId));if(!Jf){var kf=Ed.$.oa.xa.Pb(),tf=519;Jf=function(xf,Nf,Ef){var Gf=Ed.$.oa.xa;xf=Tf.b(xf,Ed.AGf);var Fg=Gf.Na(9,kf);Fg.sharedInfo=ne;return Yg.g(Gf,"InsertAgaveTaskpane",Fg,xf,Nf,Ef,hc,0)};void 0===ne.IsToBePersisted||null===ne.IsToBePersisted||ne.IsToBePersisted||
(tf=538,Jf=function(xf,Nf,Ef){ae.ULS.sendTraceTag(537170442,220,50,"Web Method ShowAgaveTaskpane is called, StoreType {0}, StoreId {1}, SolutionId {2}.",ne.StoreType,ne.StoreId,Telemetry.PrivacyRules.GetPrivacyCompliantId(ne.SolutionId,ne.StoreType,ne.AssetId,null,null,ne.StoreId));var Gf=Ed.$.oa.xa;xf=Tf.b(xf,Ed.AGf);var Fg=Gf.Na(9,void 0===kf?null:kf);Fg.sharedInfo=ne;return Yg.g(Gf,"ShowAgaveTaskpane",Fg,xf,Nf,Ef,hc,0)});return ef.EwaSettings.Zb()?(Yc|=64,Zh.a(Ed.$.userOperationManager,Jf,function(xf){return new Og.a(tf,
0,xf,Yc)},Qe)):Zh.a(Ed.$.userOperationManager,Jf,function(xf){return new ji.a(tf,0,xf,Yc)},Qe)}return $f.TaskExtensions.Saa()}var Ed=this;if(!ef.EwaSettings.ma(54)||S.StoreId===OSF.StoreType.FirstParty)return xd(S,Gb,hc);if(Ma.isAddinCommands)return ed(Ma);var Xd=new Ji.a,Ud={};Ud.marketplaceId=S.SolutionId;Ud.marketplaceVersion=S.Version;Ud.storeType=S.StoreType;Ud.storeId=S.StoreId;Ud.targetData=S;ef.EwaSettings.ma(94)&&(Ud.clearCache=!0);this.se.Qh.isAddinCommandsAsync(Ud,function(ne,Qe,ff){Xd.setResult(Qe);
ne||(ne=ff.targetData,ae.ULS.sendTraceTag(537170438,220,10,"Judging AddinCommands failed for {0} from {1} during addin inserting",Telemetry.PrivacyRules.GetPrivacyCompliantId(ne.SolutionId,ne.StoreType,ne.AssetId,null,null,ne.StoreId),ne.StoreType))});return $f.TaskExtensions.ts(Xd.task,function(ne){return ne.result?ed(Ma):xd(S,Gb,hc)},this.$.la)};Ga.prototype.uvd=function(S,Ma){if(!this.tRa[Ma])return S;var Gb={};if(S){S=bk(S);for(var hc=S.next();!hc.done;hc=S.next())hc=hc.value,Gb[hc[0]]=hc[1]}S=
this.tRa[Ma];hc=bk(Object.keys(S));for(Ma=hc.next();!Ma.done;Ma=hc.next())Ma=Ma.value,Ma===Ga.Yxh&&ef.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FeedbackTaskPaneExperienceEnabled",!1)?Gb[Ma]=Sys.Serialization.JavaScriptSerializer.serialize(S[Ma]):Gb[Ma]=Sys.Serialization.JavaScriptSerializer.serialize(S[Ma].toString());Ma=Object.keys(Gb).length;S=Array(Ma);hc=0;var Yc=bk(Object.keys(Gb));for(Ma=Yc.next();!Ma.done;Ma=Yc.next())Ma=Ma.value,S[hc]=[Ma,Gb[Ma].toString()],hc++;return S};
Ga.prototype.Dui=function(S,Ma,Gb){var hc=this.$.ya.UserSessionId,Yc=this.$.ya.UICultureTag,ed=this.$.ya.UICultureTagLcid,xd=this.$.ya.WacHostId,Ed="",Xd="";5<=Gb.length&&(Ed=Gb[3],Xd=Gb[4]);this.Eui(Ed,Xd,S,Ma,Yc,ed,hc,xd)};Ga.prototype.Eui=function(S,Ma,Gb,hc,Yc,ed,xd,Ed){var Xd={};Xd.a=xd;Xd.b=Gb;Xd.c=hc;Xd.d=S;Xd.e=Ma;Xd.f=Yc;Xd.g=ed;Xd.h=Ed;Qi.b().Ce(36,Xd)};Ga.prototype.Vve=function(){if(wg.a.Vrf())ae.ULS.sendTraceTag(537170433,1302,15,"OBF is undefined");else{try{OfficeBrowserFeedback.createScreenshot(document.body).then(this.EGf);
return}catch(S){ae.ULS.sendTraceTag(537170432,1302,15,"Failed to use createScreenshot "+(S?S.toString():null))}try{OfficeBrowserFeedback.html2canvas(document.body,null)().then(this.EGf)}catch(S){ae.ULS.sendTraceTag(537170403,1302,15,"Failed to use html2canvas"+(S?S.toString():null))}}};Ga.prototype.ILd=function(S,Ma,Gb,hc,Yc,ed){Ma=void 0===Ma?null:Ma;Gb=void 0===Gb?!1:Gb;hc=void 0===hc?null:hc;Yc=void 0===Yc?null:Yc;ed=void 0===ed?!0:ed;var xd=S.SolutionId,Ed=Mh.Task.Ua(!1);S&&xd&&S.SharedRuntimeId&&
(hc=hc||new Wh.a(-859308420,0,2,0,""),xd={},xd.solutionId=S.SolutionId,xd.version=S.Version,xd.storeType=S.StoreType,xd.storeId=S.StoreId,xd.assetId=S.AssetId,xd.assetStoreId=S.AssetStoreId,xd.height=S.Height,xd.targetType=S.TargetType,xd.width=0,xd.isAddinCommands=!1,xd.sharedRuntimeId=S.SharedRuntimeId,S.Preload=ed,Yc=Yc?Yc:new ph.a,Yc.width=0,Ma&&(Yc.focusOnIframeWhenLoaded=Ma.focusOnIframeWhenLoaded,ed=new ta,Ma.Qk&&(ed.dzc=Ma.Qk),0<Ma.taskPaneWidth&&(ed.ju=Ma.taskPaneWidth),Ma.eS&&(ed.bzc=Ma.eS),
this.S$c[S.SolutionId]=ed),Ma={},Ma[oh.a.Uf]=S,Ma[jf.a.Fra]=xd,Ma[ph.a.key]=Yc,Ma[gh.a.Vda]=Gb,Ed=this.insertAgave(Ma,hc));return Ed};Ga.prototype.XMa=function(S,Ma,Gb,hc){hc=void 0===hc?null:hc;if(S&&Ma){S=new $d.a(S,OSF.StoreType.Sdx,OSF.StoreType.Sdx,"1.0.0.0");var Yc=new vd.a("ExcelOnline","Web",this.$.ya.UICultureTag),ed=new Kj.a;ed.optionalProperties[Wg.a.ESc]=Gb;hc&&(Gb=hc,Gb.sourceLocationOverrideResourceId&&(ed.optionalProperties[Wg.a.sourceLocationOverrideResourceId]=Gb.sourceLocationOverrideResourceId),
Gb.Qk&&(ed.optionalProperties[Wg.a.Qk]=Gb.Qk),Gb.Jk&&(ed.optionalProperties.IconCssClass=Gb.Jk),Gb.eUd&&(ed.optionalProperties.TaskPaneIconUrl=Gb.eUd),Gb.eS&&(ed.optionalProperties.TaskPaneIconId=Gb.eS));jj.a.instance.XMa(S,Mj.a.action,Ma,Yc,ed)}};Ga.prototype.LSh=function(S){if(!ci.a.fh(S)){var Ma=S[Sh.a.P8b];if(Ma&&(Ma=Ma.getId(),S=S[Sh.a.Eya],Ma&&S))return this.V2a(Ma,S.optionalProperties[Wg.a.sourceLocationOverrideResourceId])}return null};Ga.prototype.V2a=function(S,Ma){Ma=void 0===Ma?null:Ma;
return S&&Ma?String.format("{0}.{1}",S,Ma):S};Ga.prototype.oKh=function(S){switch(S){case 1172793074:case 1221897806:case 1930653487:return 2;case -515602470:case 2086613372:return ef.EwaSettings.ma(235)?1023:1;case 1723441034:return 1023;case -859308420:return 1023;case 515196233:return 1023;default:return 1}};Ga.prototype.cWd=function(){this.$.ea.Tg?this.aHd():(this.$.ea.il(this.aHd),this.Bab=!0)};Ga.prototype.YXh=function(){var S=this.$.da.za(20);if(!S)return this.cWd(),"";S=S.Yvb();if(!S)return this.cWd(),
"";var Ma=this.$.va.getItemByName(this.$.ea.isNamedObjectViewMode?this.$.pa.sheetName:this.$.pa.name);Ma=Ch.d(Ma);var Gb=Ng.g(this.$).ha.sa.selectedRanges,hc=[];Gb=bk(Gb);for(var Yc=Gb.next();!Yc.done;Yc=Gb.next()){Yc=Yc.value;var ed=new Yj.a(Yc,Ma),xd=S.efd(ed,Si.Valid);ed=[];if(xd){xd=bk(xd);for(var Ed=xd.next();!Ed.done;Ed=xd.next())(Ed=Ed.value.table.Au)&&(Ed=Ed.range.toString())&&ed.push(Ed)}Yc=new da(Yc.toString(),ed);hc.push(Yc)}return JSON.stringify(hc)};Ga.i7h="Microsoft.Office.Excel.IdeasXLOPreload";
Ga.kBd="IDS";Ga.C6e="FA000000012";Ga.bLa="FA000000005";Ga.k5h="HelloWorld";Ga.TVg="FA000000014";Ga.j3e="Help.GiveFeedback.Url";Ga.Yxh="feedback";Ga.Cjf="FA000000066";Ga.zZi="PowerBi.Url";Ga.xZi="PowerBi.DevUrl";Ga.yZi="FA000000054";Ga.dCi="FA000000064";Ga.KUi="FA000000075";Ga.wVc="AnalyzeDataTaskPane";Ga.E5i="RecommendedChartsTaskPane";Ga.MXi="PivotTableTaskPane";Ga.lch=350;Ga.f8e=320;Ga.r1i=320;Object(Id.a)(Ga,"AgaveCommandManager",ai.a,[853,854]);Mf.Object.defineProperties(Ka,{instance:{configurable:!0,
enumerable:!0,get:function(){return Ka.Ma}}});Ka.Ma=new Ka;Object(Id.a)(Ka,"AppsDataManagerFactory",null,[]);Object(Id.a)(db,"AppsDataProvider",null,[394]);var $h=b(911),qj=Ve.a;Rk(ra,qj);ra.prototype.create=function(){var S=this,Ma=this.$.da,Gb=Lg.GetServiceTaskFactory.create(Ma,106,this.la,this.hb),hc=Lg.GetServiceTaskFactory.create(Ma,104,this.la,this.hb),Yc=uh.a.loadScript(36,0,this.hb,void 0,void 0,375);$f.TaskExtensions.Aa($f.TaskExtensions.Vd([hc,Gb,Yc],this.la),function(){if(!ef.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionIdRefactor",
!1)){var ed=new Fc(oi.a.instance),xd=new db(hf.AFrameworkApplication.fa,hf.AFrameworkApplication.qd,"WAC_Excel");new sa(ed,xd,"PreinstalledAppsData_Excel")}var Ed=null;ef.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FeedbackTaskPaneExperienceEnabled",!1)&&(Ed=fh.a.instance.Tb("Common.App.CustomerFeedback.ICustomerFeedbackFormManager").instance);ef.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionIdRefactor",!1);za.instance.initialize(Gb.result);ed=ef.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.PreloadRaceCondition6395242",
!0)?Object($h.c)(S.$.da,374,function(){return new Ga(S.$,Gb.result,hc.result,Ed,hf.AFrameworkApplication.ub)}):new Ga(S.$,Gb.result,hc.result,Ed,hf.AFrameworkApplication.ub);Ma.Ga(206,ed);S.pb(Ma.za(374)||Ma.Ga(374,ed))},this.la,3);fh.a.instance.register(Yh.a,"Common.Utils.AriaNotifier").as("Common.Utils.IAriaNotifier").tc().Cc(function(){return new Yh.a(S.$.Ov)})};ra.ka=function(S){S.da.Ga(375,new ra(S))};Object(Id.a)(ra,"AgaveCommandManagerFactory",Ve.a,[]);var Zj=b(624);oa.prototype.initialize=
function(S){ef.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InstalledContentAddinsRibbonExperiment",!1)&&!this.initialized&&this.tij(S)};oa.prototype.fbi=function(S,Ma){var Gb=$f.TaskExtensions.jk();if(this.initialized&&S&&0<S.length){var hc=this.iHh(S);S in this.dU&&(Gb=this.agaveCommandManager.insertAgave(hc,Ma))}return Gb};oa.prototype.Dzg=function(S){var Ma=this;this.initialized&&(S=S[oh.a.Uf]||{},!S.SolutionId||S.SolutionId in this.dU||this.se.Oca(function(Gb){Ma.Oca(Gb)},
!0))};oa.prototype.d3h=function(S){var Ma=this;this.initialized&&(S=S||"")&&0<S.length&&S in this.dU&&(delete this.dU[S],this.se.Oca(function(Gb){Ma.Oca(Gb)},!0))};oa.prototype.iHh=function(S){return S in this.dU?this.dU[S]:{}};oa.prototype.Oca=function(S){var Ma=!1;if(S&&!S.errorCode){if(S.value){S=bk(S.value);for(var Gb=S.next();!Gb.done;Gb=S.next()){Gb=Gb.value;var hc=Gb[1];Gb[3]==OSF.OsfControlTarget.InContent&&hc&&0<hc.length&&!(hc in this.dU)&&(Ma={NoReporting:!1,IsSystemInitiated:!1},Ma.description=
Gb[2],Ma.iconUrl=Gb[9],Ma[jf.a.Fra]={solutionId:Gb[1],version:Gb[4],storeType:Gb[12],storeId:Gb[11],assetId:Gb[5],assetStoreId:Gb[6],targetType:Gb[3],width:Gb[7],height:Gb[8],displayName:Gb[0],id:Gb[1]},Ma[oh.a.Uf]={SolutionId:Gb[1],Version:Gb[4],StoreType:Gb[12],StoreId:Gb[11],AssetId:Gb[5],AssetStoreId:Gb[6],TargetType:Gb[3],Width:Gb[7],Height:Gb[8],Id:Gb[1]},this.dU[hc]=Ma,Ma=!0)}}Ma&&this.U4g()}};oa.prototype.U4g=function(){var S=[],Ma;for(Ma in this.dU)S.push({id:Ma,controlType:0,title:this.dU[Ma][jf.a.Fra].displayName});
if(0<S.length){for(var Gb in this.dU)appChrome.addInApi.registerAddinIcon("AddinIcon_"+Gb,this.dU[Gb].iconUrl);this.bXg();appChrome.addInApi.dispatchActionsToInstallAddIn({tabs:[{id:oa.bsf,isOfficeTab:!0,groups:[{id:oa.h$e,title:oa.i$e,controls:S}]}]});for(var hc in this.dU)this.P_a.addCommandToMaps(Object(Vg.a)(new yh.a(hc,"-1473679467"),{legacyControlId:hc}))}};oa.prototype.bXg=function(){appChrome.addInApi.dispatchActionsToRemoveAddIn({tabs:[{id:oa.bsf,isOfficeTab:!0,groups:[{id:oa.h$e,title:oa.i$e,
controls:[]}]}]})};oa.prototype.tij=function(S){var Ma=this,Gb=Lg.GetServiceTaskFactory.Ra(S.da,374,375,1),hc=Lg.GetServiceTaskFactory.create(S.da,106,S.la,1);$f.TaskExtensions.Aa($f.TaskExtensions.Vd([Gb,hc],S.la),function(){Ma.agaveCommandManager=Gb.result;Ma.P_a=fh.a.instance.mh("Common.IExternalUICommandDefinitionMapping")||new Zj.a(S.yb,S);hf.AFrameworkApplication.ub.Mb(Eg.a.JNf,ii.a.frame,function(Yc,ed,xd,Ed,Xd){Ma.d3h(Xd)});Ma.se=hc.result;Ma.se.Oca(function(Yc){Ma.Oca(Yc)},!0);Ma.initialized=
!0},S.la,3)};oa.bsf="tabinsert";oa.h$e="installedContentAddins";oa.i$e=gg.a.instance.ga(2249);Object(Id.a)(oa,"AgaveCommandRibbon",null,[800]);var rj=Ve.a;Rk(ba,rj);ba.prototype.create=function(){if(ef.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InstalledContentAddinsRibbonExperiment",!1)){var S=this.$.da,Ma=new oa;Ma.initialize(this.$);this.pb(S.za(488)||S.Ga(488,Ma))}};ba.ka=function(S){S.da.Ga(489,new ba(S))};Object(Id.a)(ba,"AgaveCommandRibbonFactory",Ve.a,[]);var Ei=b(1503),
cg=b(945);aa.prototype.getTypeName=function(){return"Microsoft.Authentication.OfficeIdentityInfo"};aa.prototype.invokePropertyGet=function(S){switch(S){case 4:return this.displayName;case 3:return this.email;case 2:return this.federationProvider;case 1:return this.identityType}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(S);};aa.prototype.invokePropertyGetAsync=function(S){S=this.invokePropertyGet(S);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(S)};aa.prototype.invokePropertySet=
function(S,Ma){switch(S){case 4:this.displayName=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ma,0,"string");return;case 3:this.email=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ma,0,"string");return;case 2:this.federationProvider=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ma,0,"string");return;case 1:this.identityType=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ma,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(S);
};aa.prototype.invokePropertySetAsync=function(S,Ma){this.invokePropertySet(S,Ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};aa.prototype.invokeMethod=function(S){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(S);};aa.prototype.invokeMethodAsync=function(S,Ma){S=this.invokeMethod(S,Ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(S)};aa.f6g=function(S){var Ma=new aa;Ma.displayName=S.displayName;Ma.email=S.email;switch(S.authority){case Ei.a.CDf:Ma.identityType=
1;break;default:Ma.identityType=0}Ma.federationProvider="";return Ma};Mf.Object.defineProperties(aa.prototype,{displayName:{configurable:!0,enumerable:!0,get:function(){return this.Xea},set:function(S){this.Xea=S}},email:{configurable:!0,enumerable:!0,get:function(){return this.C4d},set:function(S){this.C4d=S}},federationProvider:{configurable:!0,enumerable:!0,get:function(){return this.i5d},set:function(S){this.i5d=S}},identityType:{configurable:!0,enumerable:!0,get:function(){return this.Eib},set:function(S){this.Eib=
S}}});Object(Id.a)(aa,"OfficeIdentityInfo",null,[]);Xa.Hac=function(S){return S in Xa.dLe?Xa.dLe[S].toString():S};Mf.Object.defineProperties(Xa,{dLe:{configurable:!0,enumerable:!0,get:function(){return Xa.ung}}});Xa.map=null;var Gh={};Xa.ung=(Gh.GeneralException=cg.a.generalException,Gh.AccessDenied=cg.a.ASc,Gh.ApiNotAvailable=cg.a.apiNotAvailable,Gh.UserNotSignedIn=cg.a.userNotSignedIn,Gh.UserAborted=cg.a.userAborted,Gh.UnsupportedUserIdentity=cg.a.kPj,Gh.InvalidResourceUrl=cg.a.invalidResourceUrl,
Gh.InvalidGrant=cg.a.invalidGrant,Gh.AddinIsAlreadyRequestingToken=cg.a.hHg,Gh.ResourceNotAllowed=cg.a.mgj,Gh.ClientError=cg.a.clientError,Gh.ServerError=cg.a.serverError,Gh);Object(Id.a)(Xa,"SingleSignOnErrorCodeMap",null,[]);ua.prototype.getTypeName=function(){return"Microsoft.Authentication.SingleSignOnToken"};ua.prototype.invokePropertyGet=function(S){switch(S){case 2:return this.accessToken;case 3:return this.tokenIdenityType}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(S);
};ua.prototype.invokePropertyGetAsync=function(S){S=this.invokePropertyGet(S);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(S)};ua.prototype.invokePropertySet=function(S,Ma){switch(S){case 2:this.accessToken=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ma,0,"string");return;case 3:this.tokenIdenityType=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ma,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(S);};ua.prototype.invokePropertySetAsync=
function(S,Ma){this.invokePropertySet(S,Ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};ua.prototype.invokeMethod=function(S){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(S);};ua.prototype.invokeMethodAsync=function(S,Ma){S=this.invokeMethod(S,Ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(S)};Mf.Object.defineProperties(ua.prototype,{accessToken:{configurable:!0,enumerable:!0,get:function(){return this.XPb},set:function(S){this.XPb=
S}},tokenIdenityType:{configurable:!0,enumerable:!0,get:function(){return this.Eib},set:function(S){this.Eib=S}}});Object(Id.a)(ua,"SingleSignOnToken",null,[]);va.prototype.getTypeName=function(){return"Microsoft.Authentication.TokenParameters"};va.prototype.invokePropertyGet=function(S){switch(S){case 3:return this.authChallenge;case 7:return this.correlationId;case 4:return this.policy;case 2:return this.resource;case 5:return this.scope;case 6:return this.silentLogin}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(S);
};va.prototype.invokePropertyGetAsync=function(S){S=this.invokePropertyGet(S);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(S)};va.prototype.invokePropertySet=function(S,Ma){switch(S){case 3:this.authChallenge=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ma,0,"string");return;case 7:this.correlationId=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ma,0,"string");return;case 4:this.policy=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ma,0,"string");
return;case 2:this.resource=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ma,0,"string");return;case 5:this.scope=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ma,0,"string");return;case 6:this.silentLogin=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ma,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(S);};va.prototype.invokePropertySetAsync=function(S,Ma){this.invokePropertySet(S,Ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};
va.prototype.invokeMethod=function(S){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(S);};va.prototype.invokeMethodAsync=function(S,Ma){S=this.invokeMethod(S,Ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(S)};Mf.Object.defineProperties(va.prototype,{authChallenge:{configurable:!0,enumerable:!0,get:function(){return this.Y0d},set:function(S){this.Y0d=S}},correlationId:{configurable:!0,enumerable:!0,get:function(){return this.xD},set:function(S){this.xD=S}},
policy:{configurable:!0,enumerable:!0,get:function(){return null},set:function(){}},resource:{configurable:!0,enumerable:!0,get:function(){return this.FVb},set:function(S){this.FVb=S}},scope:{configurable:!0,enumerable:!0,get:function(){return this.Hee},set:function(S){this.Hee=S}},silentLogin:{configurable:!0,enumerable:!0,get:function(){return this.Sfe},set:function(S){this.Sfe=S}}});Object(Id.a)(va,"TokenParameters",null,[858]);ja.prototype.getAccessToken=function(S){var Ma=this,Gb=this.bhb.getOsfControl(this.hA),
hc=Gb.getManifest(),Yc=hc.getMarketplaceID();this.rNa(S,Yc);return OfficeExtension.WacRuntime.Utility.createPromise(function(ed,xd){Gb.isFirstParty()&&Ma.bhb._enableFirstPartySSO?Ma.dei(hc,S)?fh.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getAccessToken(S,Yc).then(function(Ed){ed(Ed)},function(Ed){xd(Ed)}):xd(cg.a.ASc):xd(cg.a.apiNotAvailable)}).then(function(ed){switch(ed.authority){case Ei.a.CDf:var xd=1;break;default:xd=0}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new ua(ed.accessToken,
xd))},function(ed){Ma.logErrorResponse(S,Yc,ed);return ed?OfficeExtension.WacRuntime.Utility.createPromise(function(xd,Ed){Ed(OfficeExtension.WacRuntime.Utility.createRichApiException(ed,Xa.Hac(ed)))}):OfficeExtension.WacRuntime.Utility.createPromise(function(xd,Ed){Ed(OfficeExtension.WacRuntime.Utility.createRichApiException(cg.a.generalException,Xa.Hac(cg.a.generalException)))})})};ja.prototype.getAuthContext=function(){return null};ja.prototype.getPrimaryIdentityInfo=function(){var S=this.bhb.getOsfControl(this.hA);
S.getManifest();var Ma=S.getManifest().getMarketplaceID();return OfficeExtension.WacRuntime.Utility.createPromise(function(Gb,hc){fh.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getPrimaryIdentityInfo(Ma).then(function(Yc){Gb(Yc)},function(Yc){hc(Yc.toString())})}).then(function(Gb){Gb=aa.f6g(Gb);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Gb)},function(Gb){return Gb?OfficeExtension.WacRuntime.Utility.createPromise(function(hc,Yc){Yc(OfficeExtension.WacRuntime.Utility.createRichApiException(Gb,
Xa.Hac(Gb)))}):OfficeExtension.WacRuntime.Utility.createPromise(function(hc,Yc){Yc(OfficeExtension.WacRuntime.Utility.createRichApiException(cg.a.generalException,Xa.Hac(cg.a.generalException)))})})};ja.prototype.getTypeName=function(){return"Microsoft.Authentication.AuthenticationService"};ja.prototype.invokePropertyGet=function(S){switch(S){case 99:return this.roamingSettings}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(S);};ja.prototype.invokePropertyGetAsync=function(S){S=
this.invokePropertyGet(S);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(S)};ja.prototype.invokePropertySet=function(S){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(S);};ja.prototype.invokePropertySetAsync=function(S,Ma){this.invokePropertySet(S,Ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};ja.prototype.invokeMethod=function(S){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(S);};ja.prototype.invokeMethodAsync=
function(S,Ma){switch(S){case 1:return this.zGh(Ma);case 3:return this.VHh();case 2:return this.QTh()}S=this.invokeMethod(S,Ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(S)};ja.prototype.zGh=function(S){S=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(S,0,va);return this.getAccessToken(S)};ja.prototype.VHh=function(){return this.getAuthContext()};ja.prototype.QTh=function(){return this.getPrimaryIdentityInfo()};ja.prototype.dei=function(S,Ma){var Gb=!1,hc=S.getWebApplicationAuthorizations();
S=null;hc=bk(hc);for(var Yc=hc.next();!Yc.done;Yc=hc.next())if(Yc=Yc.value,Yc.getResource().toLowerCase()===Ma.resource.toLowerCase()){S=Yc;Gb=!0;break}if(!Gb)return!1;Ma=Ma.scope.split(" ,+");Ma=bk(Ma);for(Gb=Ma.next();!Gb.done;Gb=Ma.next())if((Gb=Gb.value)&&Gb.length){hc=!1;Yc=bk(S.getScopes());for(var ed=Yc.next();!ed.done;ed=Yc.next())Gb.toLowerCase()===ed.value.toLowerCase()&&(hc=!0);if(!hc)return!1}return!0};ja.prototype.rNa=function(S,Ma){S=this.Orf(S.resource);var Gb={};ae.ULS.sendTraceTag(538572831,
369,50,"{0}",(Gb.manifestId=Ma,Gb.resource=S,Gb))};ja.prototype.logErrorResponse=function(S,Ma,Gb){S=this.Orf(S.resource);var hc={};ae.ULS.sendTraceTag(538572830,369,10,"{0}",(hc.manifestId=Ma,hc.resource=S,hc.error=Gb,hc))};ja.prototype.Orf=function(S){return S.replace("://","__").replace(RegExp("\\.","g"),"_dot_").replace("/","\\")};Mf.Object.defineProperties(ja.prototype,{roamingSettings:{configurable:!0,enumerable:!0,get:function(){return null}}});Object(Id.a)(ja,"AuthenticationService",null,
[]);X.prototype.create=function(S,Ma){return new ja(S,Ma)};Object(Id.a)(X,"AuthenticationServiceFactory",null,[]);var sj=b(1057),tj=b(1171),xg=b(1155);wa.generalException="generalException";wa.invalidArgument="invalidArgument";wa.notAllowed="notAllowed";wa.apiNotAvailable="apiNotAvailable";wa.unresolvedPendingRequest="unresolvedPendingRequest";wa.timeout="timeout";wa.adalTimeout="adalTimeout";wa.userNotSignedIn="userNotSignedIn";wa.userAborted="userAborted";wa.silentSignInFailed="silentSignInFailed";
wa.invalidResourceUrl="invalidResourceUrl";wa.invalidGrant="invalidGrant";wa.connectionLost="connectionLost";wa.clientError="clientError";wa.serverError="serverError";Object(Id.a)(wa,"WopiHostErrorCodes",null,[]);var Oj=b(943);Object(Id.a)(ea,"OAuthCallerMetadata",null,[]);var ki=b(27);ca.prototype.Ryg=function(S,Ma,Gb,hc,Yc,ed){var xd=this;if(!this.zxa)return hc=new tj.a,hc.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,Promise.resolve(hc);var Ed=new ea;Ed.AddinName=Yc;Ed.AddinTrustId=
ed;var Xd=-1;ed=null;if(hc&&this.adf())ed=this.zxa.w$f(jf.a.rzc,S,hc,ca.d0e(Yc),Ed);else{var Ud=Date.now();ed=this.zxa.xO(jf.a.rzc,S,Ed).then(function(ne){Xd=Date.now()-Ud;var Qe=(Ma||Gb)&&"login_required"===ne.ErrorCode;return(Ma&&("interaction_required"===ne.ErrorCode||"consent_required"===ne.ErrorCode||"invalid_grant"===ne.ErrorCode)||Qe)&&xd.adf()?xd.zxa.w$f(jf.a.rzc,S,null,ca.d0e(Yc),Ed):Promise.resolve(ne)})}return ed.then(function(ne){var Qe=new tj.a;ne.IsSuccess?(Qe.token=ne.Token,ne.Telemetry&&
(Qe.MSa=ne.Telemetry.fromCache,Qe.expiresOn=ne.Telemetry.expiresOn)):(Qe.errorCode=xd.Wxi(ne),Qe.mUd=xd.XVi(ne));return Qe}).catch(function(){var ne=new tj.a;ne.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;return Promise.resolve(ne)}).then(function(ne){ne.Wga="OauthManager";0<=Xd&&(ne.bwb=Xd);return ne})};ca.prototype.Agi=function(S){var Ma=(hf.AFrameworkApplication.fa.Wa(hf.AFrameworkApplication.gea)||"").toLowerCase();return(ki.a.Wwa||"teams"===Ma&&Oj.a.lxb)&&!ca.dgi(S)||!this.zxa||
!this.zxa.w5a()?!1:!0};ca.prototype.adf=function(){return this.kng||1!==xg.a.N$b()};ca.prototype.Wxi=function(S){switch(S.ErrorCode){case "UserCancelled":case "interaction_required":S=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted;break;case "consent_required":case "invalid_grant":S=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant;break;case "login_required":S=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform;break;case "invalid_client":case "invalid_application_ID":S=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;
break;case "invalid_resource":S=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl;break;case "popup_window_error":S=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost;break;default:S=S.ErrorCode===wa.userAborted?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted:S.ErrorCode===wa.silentSignInFailed?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform:S.ErrorCode===wa.invalidResourceUrl?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl:S.ErrorCode===wa.invalidGrant?
OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant:S.ErrorCode===wa.connectionLost?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost:OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError}return S};ca.prototype.XVi=function(S){var Ma="";(S=RegExp("AADSTS(\\d+)").exec(S.ErrorMessage))&&1<S.length&&(Ma=S[1]);return Ma};ca.d0e=function(S){return String.format(CommonUIStrings.l_SSOSignInNeededNotification_Description_Text_Addins,S)};ca.dgi=function(S){if(!S)return!1;S=S.toLowerCase();for(var Ma=
bk(sj.AppsForOfficeSingleSignOnManager.ISe),Gb=Ma.next();!Gb.done;Gb=Ma.next())if(Gb.value===S)return!0;return!1};Object(Id.a)(ca,"AppsforOfficeTokenFromOauthManager",null,[73]);fa.moa=function(){if(hf.AFrameworkApplication.fa.qa("AppForOfficeSSOV2IsEnabled")){var S=null;try{S=fh.a.instance.resolve("Common.App.OAuth.IOAuthManager")}catch(Ma){ae.ULS.sendTraceTag(592061330,1300,10,"Unable to resolve IOAuthManager: "+Ma)}S=new ca(S);fa.Ma=new fa(S)}};fa.getInstance=function(){fa.d7d||(fa.moa(),fa.d7d=
!0);return fa.Ma};fa.Ma=null;fa.d7d=!1;Object(Id.a)(fa,"AppsForOfficeOauthManagerFactory",null,[35]);var Pj=b(1502),Ti=b(135);Object(Id.a)(R,"NewDocumentParameters",null,[]);var Hh=b(180);P.prototype.createAndOpenWorkbook=function(S){var Ma=this;if(S&&S.length>this.Vrg)throw ae.ULS.sendTraceTag(538572821,0,15,"Too large base64 stream size:{0}",S.length),OfficeExtension.WacRuntime.Utility.createRichApiException(cg.a.invalidArgument,Hh.a.ga(1744));var Gb=new R("blank","agave",S?"streamBase64":"streamEmpty",
S),hc=null;return OfficeExtension.WacRuntime.Utility.createPromise(function(Yc,ed){var xd=new Ti.StandardDialog;xd.Rb=4;xd.ql(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_NewFileAPIConsentMessage,1,function(Ed){2===Ed||0===Ed?ed("Cancelled"):(hc=window.open(""),Ma.qsg.create(Yc,ed,Gb).m0a())})}).then(function(Yc){if(!Yc)throw OfficeExtension.WacRuntime.Utility.createRichApiException(cg.a.generalException,Hh.a.ga(1740));try{hc.top.location.href=Yc}catch(ed){ae.ULS.sendTraceTag(538572820,
0,10,"CreateWorkbook API - exception while trying to change Window.Top.Location.Href, isChrome:{0}, exception:{1}",ki.a.Uo,ed),ae.ULS.sendTraceTag(538572819,0,50,"CreateWorkbook API: calling self Window.Location.Replace instead of Window.Top.Location.Replace"),hc.location.replace(Yc)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)},function(Yc){if("Cancelled"===Yc)throw OfficeExtension.WacRuntime.Utility.createRichApiException(cg.a.oBd,Hh.a.ga(1743));hc.close();Ma.oIj();return null})};
P.prototype.getTypeName=function(){return"Microsoft.ExcelServices.WacWorkbook"};P.prototype.invokePropertyGet=function(S){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(S);};P.prototype.invokePropertyGetAsync=function(S){S=this.invokePropertyGet(S);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(S)};P.prototype.invokePropertySet=function(S){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(S);};P.prototype.invokePropertySetAsync=function(S,
Ma){this.invokePropertySet(S,Ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};P.prototype.invokeMethod=function(S){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(S);};P.prototype.invokeMethodAsync=function(S,Ma){switch(S){case 1:return this.T3g(Ma)}S=this.invokeMethod(S,Ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(S)};P.prototype.T3g=function(S){S=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(S,0,"string");return this.createAndOpenWorkbook(S)};
P.prototype.oIj=function(){throw OfficeExtension.WacRuntime.Utility.createRichApiException(cg.a.generalException,Hh.a.ga(1740));};Object(Id.a)(P,"WacWorkbook",null,[]);var Ph=b(257),Qf=b(944),Qj=b(950);Mf.Object.defineProperties(M.prototype,{$:{configurable:!0,enumerable:!0,get:function(){return this.jb}}});Object(Id.a)(M,"RichApiPreviewExecutionContext",null,[]);var Ui=b(24),uj=b(1076),li=b(36),Rj=b(216),Vi=b(218),vj=b(118),Wi=b(12),si=Vi.a;Rk(N,si);N.prototype.start=function(S,Ma){var Gb="<div class='"+
vj.a.hnh+" "+Xg.a.Lo+"'><label for='{1}'>{0}</label></div>\r\n<div><input type='text' id='{1}' maxlength='388' class='"+vj.a.vC+"' /></div>";Gb=String.format(Gb,Bh.a.zg(this.F4c.DdaBindingsMethod.PromptText.substr(0,200)),"bindingText");this.Gb.innerHTML=Gb;this.Dob=Wi.DOMElementExtensions.getElementById(this.Gb,"bindingText");S=Ma?S.p2a(Ma,this.F4c.DdaBindingsMethod.BindingId):null;(null===S||void 0===S?0:S.IsValidRef)?(Ma=new Ui.Range(S.Reference.FirstRow+1,S.Reference.FirstColumn+1,S.Reference.LastRow+
1,S.Reference.LastColumn+1,!1,!1),this.Dob.value=S.Reference.SheetName+"!"+Ma):(S=Ng.g(this.$).ha,this.Dob.value=Ch.f(this.$.pa)||!S.sa.sg?"":S.Xha);this.initialize();this.gf()};N.prototype.pn=function(){this.x_c();this.addButton(0);this.addButton(1);si.prototype.pn.call(this)};N.prototype.setFocus=function(){Wi.DOMElementExtensions.setFocus(this.Dob)};N.prototype.validate=function(){return!0};N.prototype.commit=function(){var S=this.Dob.value.trim(),Ma=S.indexOf("!");-1!==Ma&&(S=this.PWh(S.substring(0,
Ma))+S.substr(Ma));this.fFe.addBinding(this.F4c,S,0,this.callback);return!0};N.prototype.nsa=function(){this.fFe.fQ.kf(Qf.a.internalError,this.callback);si.prototype.nsa.call(this)};N.prototype.PWh=function(S){S=xi.a.trimStart(S.trim(),"=");return S.length?S.startsWith("'")&&S.endsWith("'")?S:gi.HelperMethods.T7b(S):""};Mf.Object.defineProperties(N.prototype,{nc:{configurable:!0,enumerable:!0,get:function(){return"DdaBindingPrompt"}}});Object(Id.a)(N,"DdaBindingPrompt",Vi.a,[]);K.prototype.kf=function(S,
Ma){if(Ma){var Gb={};Gb.Error=S;Gb.Version=this.ea.Ue;Ma(Gb)}};K.prototype.vJa=function(S,Ma){this.kf(S,Ma)};K.prototype.ZG=function(S,Ma){this.kf(Qf.a.fUe(S.Errors[0].MessageId),Ma)};K.prototype.Ku=function(S){S&&S(this.MP())};K.prototype.MP=function(){var S={Error:0};S.Version=this.ea.Ue;return S};Object(Id.a)(K,"DdaErrorGenerator",null,[]);var mh=b(295),Xi=b(95);H.prototype.pwd=function(S,Ma){function Gb(Ed){var Xd=hc.$.va.getItemByName(Ed.SheetName);(null===Xd||void 0===Xd?0:Xd.visible)?(Ng.g(hc.$).gg(Ed,
null,null,null,3,Xi.a.qbh,void 0,void 0,void 0,void 0,!0),hc.fQ.Ku(Ma)):hc.fQ.kf(Qf.a.xUg,Ma)}var hc=this,Yc=S.DdaGoToByIdMethod.GoToType,ed=S.DdaGoToByIdMethod.SelectionMode,xd=S.DdaGoToByIdMethod.Id.toString().trim();0===Yc?this.UBi(xd,ed,S.DdaMethod.ControlId,Gb,Ma):1===Yc?this.YBi(xd,ed,Gb,Ma):this.fQ.kf(Qf.a.hPj,Ma)};H.prototype.UBi=function(S,Ma,Gb,hc,Yc){var ed=this;this.Sz.ddaGetBinding(Gb,S,function(xd){if(!mh.a(xd)&&xd.Result&&xd.Result.Reference){xd=xd.Result;var Ed={};Ed.SheetName=xd.Reference.SheetName;
Ed.FirstRow=xd.Reference.FirstRow;Ed.FirstColumn=xd.Reference.FirstColumn;Ed.LastRow=xd.Reference.LastRow;Ed.LastColumn=xd.Reference.LastColumn;H.iVc(Ed,Ma);1!==xd.BindingType?hc(Ed):ed.Sz.ddaGetBindingData(Gb,S,1,0,2,0,0,-1,-1,function(Xd){mh.a(Xd)||!Xd.Result?ed.fQ.ZG(Xd,Yc):(Xd=Xd.Result,2!==Ma&&(Ed.FirstRow-=Xd.Headers.length,0>Ed.FirstRow&&(Ed.FirstRow=0)),hc(Ed))},Yc)}else ed.fQ.vJa(Qf.a.v4f,Yc)},Yc)};H.prototype.YBi=function(S,Ma,Gb,hc){var Yc=this,ed=zf.z(S);ed?(ed=zf.v(ed,this.$),H.iVc(ed,
Ma),Gb(ed)):this.$.ea.isNamedObjectViewMode&&this.$.vb.Jj(S)?this.$.vb.pa=this.$.vb.getItemByName(S):(ed=function(xd){mh.a(xd)||!xd.Result?Yc.$.va.contains(S)?(xd={},xd.SheetName=S,xd.FirstRow=0,xd.FirstColumn=0,xd.LastRow=0,xd.LastColumn=0,Gb(xd)):Yc.fQ.vJa(Qf.a.v4f,hc):(xd=xd.Result,H.iVc(xd,Ma),Gb(xd))},this.$.va.pa?this.Sz.parseRangeForGoto(S,this.$.va.pa.name,ed,hc):this.Sz.parseRange(S,ed,hc))};H.iVc=function(S,Ma){S.LastRow=2===Ma?S.FirstRow:S.LastRow;S.LastColumn=2===Ma?S.FirstColumn:S.LastColumn};
Object(Id.a)(H,"DdaNavigator",null,[]);var Yi=b(308),ti;(function(S){S[S.unsupported=0]="unsupported";S[S.surface=1]="surface";S[S.combo=2]="combo";S[S.column=3]="column";S[S.column3D=4]="column3D";S[S.bar=5]="bar";S[S.bar3D=6]="bar3D";S[S.line=7]="line";S[S.line3D=8]="line3D";S[S.pie=9]="pie";S[S.pie3D=10]="pie3D";S[S.scatter=11]="scatter";S[S.bubble=12]="bubble";S[S.area=13]="area";S[S.area3D=14]="area3D";S[S.doughnut=15]="doughnut";S[S.radar=16]="radar";S[S.stock=17]="stock";S[S.waterfall=18]=
"waterfall";S[S.funnel=19]="funnel";S[S.treemap=20]="treemap";S[S.sunburst=21]="sunburst";S[S.boxWhisker=22]="boxWhisker";S[S.histogram=23]="histogram";S[S.pareto=24]="pareto";S[S.regionMap=25]="regionMap";S[S.noVisibleSeries=26]="noVisibleSeries";S[S.complexDataSource=27]="complexDataSource";S[S.pivotChart=28]="pivotChart"})(ti||(ti={}));Object(Id.b)("ChartCategory",ti);Object(Id.a)(U,"MacroRecorderEventData",null,[]);O.prototype.gVh=function(S){var Ma;if(void 0===S||null===S||void 0===S.RequestBody||
null===S.RequestBody)return null;var Gb=JSON.parse(S.RequestBody);if(void 0!==S.ActiveChartId&&null!==S.ActiveChartId){Gb.ActiveChartId=S.ActiveChartId;var hc=Ng.g(this.$).ha.Oa.Yb;if(null===(Ma=null===hc||void 0===hc?void 0:hc.floatingObject)||void 0===Ma?0:Ma.Oc)Gb.ActiveChartType=ti[hc.floatingObject.Oc.ChartCategory]}void 0!==S.SheetMultiRange&&null!==S.SheetMultiRange&&(Gb.SheetName=S.SheetMultiRange.SheetName);return Gb};O.prototype.tVh=function(S){if(void 0===S||null===S||void 0===S.Result||
null===S.Result)return null;S=S.Result;return void 0===S.ResponseBody||null===S.ResponseBody||S.ResponseBody[0].startsWith('{"Error":')?null:JSON.parse(S.ResponseBody.join(""))};O.prototype.Oki=function(S){return!!S&&!(void 0===S.eventId||null===S.eventId)&&0<S.eventId.length};O.prototype.Zi=function(S){var Ma=this;return function(){if(Ma.$.wba){var Gb=Ma.KQg(Ma.request);if(Ma.Oki(Gb)){var hc=Ma.gVh(Ma.request),Yc=Ma.tVh(S);if(hc&&!ci.a.isEmpty(hc)&&Yc&&!ci.a.isEmpty(Yc))return ae.ULS.sendTraceTag(537163164,
0,50,"[RichApiRecorder]: Creating a MacroRecorderRichApiRequestExecutedPayload object."),new Pg(Gb,hc,Yc);Gb=String.format("requestInfo: {0}; responseInfo: {1}",hc?"(not null)":"(null)",Yc?"(not null)":"(null)");ae.ULS.sendTraceTag(537163163,0,50,"[RichApiRecorder]: Failed due to bad data: {0}",Gb)}}return new Pg(null,null,null)}};O.prototype.KQg=function(S){var Ma=this.Pki(S.SolutionId),Gb=O.OUh(S);if(Gb&&Ma)return Ma={},ae.ULS.sendTraceTag(537163162,0,50,"[RichApiRecorder][{0}]: {1}",this.parentName,
(Ma.recorderEventId=Gb,Ma["request.SolutionId"]=S.SolutionId,Ma)),new U(S.SolutionId,Gb);var hc={};ae.ULS.sendTraceTag(537163161,0,50,"[RichApiRecorder][{0}]: {1}",this.parentName,(hc.recorderEventId=Gb,hc.isRecorderAwareAddin=Ma,hc["request.SolutionId"]=S.SolutionId,hc));return null};O.prototype.Pki=function(S){if(!S)return!1;S=S.toLowerCase();return O.N_h().contains(S)};O.N_h=function(){O.qza||(O.qza=new dg.a(Kg.a.Ik()),O.qza.add("f438b4e6-2b49-466f-9a91-b75f473eba96"),O.qza.add("fa000000005"),
O.qza.add("907dd90f-a82f-4bbf-b4f2-fcd4868a5e14"),O.qza.add("fa000000014"),O.qza.add("c5daabb3-e185-4e8c-adfc-1a7b7283fb6f"));return O.qza};O.OUh=function(S){var Ma=null,Gb=RegExp('"Name":"EnableOfficeScriptRecording".*?Arguments":\\[.*?"(.*?)"',"mi");if(Gb.test(S.RequestBody))Ma=Gb.exec(S.RequestBody)[1];else{S=S.RequestHeaders;if(!S)return Ma;Gb=sg.a.IEi.toLowerCase();for(var hc=0;hc<S.length;hc++)if(S[hc].Name.toLowerCase()===Gb){Ma=S[hc].Value;break}}return Ma};O.qza=null;Object(Id.a)(O,"DdaRichApiRequestRecorder",
null,[]);var wj=b(70),Fi=Yi.a;Rk(T,Fi);T.prototype.C2=function(S){return Fi.prototype.C2.call(this,S)||this.tTg(S)};T.prototype.Zi=function(){return this.ZKd.Zi(this.Wc)};T.prototype.ceb=function(){var S={OperationType:3};S.RichApiRequest=this.request;return S};T.prototype.tTg=function(S){var Ma=this;return function(Gb,hc,Yc){return J(S,Ma.request,Tf.b(Gb,Ma.Clb),Tf.a(hc,Ma.Whb),Yc,Ma.n3)}};Mf.Object.defineProperties(T.prototype,{operationWorkingState:{configurable:!0,enumerable:!0,get:function(){return ef.EwaSettings.Zb()?
Object(wj.a)(T.prototype,this,"operationWorkingState"):2}},NBc:{configurable:!0,enumerable:!0,get:function(){return this.YEa}},kt:{configurable:!0,enumerable:!0,get:function(){return this.Clb}},naa:{configurable:!0,enumerable:!0,get:function(){return this.Whb}}});Object(Id.a)(T,"DdaRichApiRequestBatchOperation",Yi.a,[]);var Gi=Og.a;Rk(G,Gi);G.prototype.Zi=function(){return this.ZKd.Zi(this.Wc)};Mf.Object.defineProperties(G.prototype,{operationWorkingState:{configurable:!0,enumerable:!0,get:function(){return ef.EwaSettings.Zb()?
Object(wj.a)(G.prototype,this,"operationWorkingState"):0}}});Object(Id.a)(G,"DdaRichApiRequestOperation",Og.a,[]);F.prototype.ddaAddBinding=function(S,Ma,Gb,hc,Yc,ed,xd){var Ed=this;this.DJ(function(Xd,Ud,ne){var Qe=Ed.$.oa.xa,ff=Ed.gja();Xd=Tf.b(Xd,ed);Ud=Tf.a(Ud,Ed.WH);var of=Qe.Na(9);of.controlId=S;of.bindingId=Ma;of.bindingType=Gb;of.currentSheetName=ff;of.formula=hc;of.options=Yc;return Yg.g(Qe,"DdaAddBinding",of,Xd,Ud,ne,xd,0)},xd,563)};F.prototype.ddaReleaseBinding=function(S,Ma,Gb,hc){var Yc=
this;this.DJ(function(ed,xd,Ed){var Xd=Yc.$.oa.xa;ed=Tf.b(ed,Gb);xd=Tf.a(xd,Yc.WH);var Ud=Xd.Na(9);Ud.controlId=S;Ud.bindingId=Ma;return Yg.g(Xd,"DdaReleaseBinding",Ud,ed,xd,Ed,hc,0)},hc,564)};F.prototype.ddaGetBinding=function(S,Ma,Gb,hc){var Yc=this;this.DJ(function(ed,xd,Ed){var Xd=Yc.$.oa.xa;ed=Tf.b(ed,Gb);xd=Tf.a(xd,Yc.WH);var Ud=Xd.Na(1);Ud.controlId=S;Ud.bindingId=Ma;return Yg.g(Xd,"DdaGetBinding",Ud,ed,xd,Ed,hc,0)},hc,565,16)};F.prototype.ddaGetAllBindings=function(S,Ma,Gb){var hc=this;this.DJ(function(Yc,
ed,xd){var Ed=hc.$.oa.xa;Yc=Tf.b(Yc,Ma);ed=Tf.a(ed,hc.WH);var Xd=Ed.Na(1);Xd.controlId=S;return Yg.g(Ed,"DdaGetAllBindings",Xd,Yc,ed,xd,Gb,0)},Gb,566,16)};F.prototype.ddaGetBindingData=function(S,Ma,Gb,hc,Yc,ed,xd,Ed,Xd,Ud,ne){var Qe=this;this.DJ(function(ff,of,Jf){var kf=Qe.$.oa.xa,tf=Qe.gja();ff=Tf.b(ff,Ud);of=Tf.a(of,Qe.WH);var xf=kf.Na(1);xf.controlId=S;xf.bindingId=Ma;xf.coerceType=Gb;xf.valueFormat=hc;xf.filterType=Yc;xf.startRow=ed;xf.startCol=xd;xf.rowCount=Ed;xf.colCount=Xd;xf.currentSheetName=
tf;return Yg.g(kf,"DdaGetBindingData",xf,ff,of,Jf,ne,0)},ne,567,16)};F.prototype.ddaSetBindingData=function(S,Ma,Gb,hc,Yc,ed,xd){var Ed=this;this.DJ(function(Xd,Ud,ne){var Qe=Ed.$.oa.xa,ff=Ed.gja();Xd=Tf.b(Xd,ed);Ud=Tf.a(Ud,Ed.WH);var of=Qe.Na(9);of.controlId=S;of.bindingId=Ma;of.startRow=Gb;of.startCol=hc;of.currentSheetName=ff;of.bindingData=Yc;return Yg.g(Qe,"DdaSetBindingData",of,Xd,Ud,ne,xd,0)},xd,568)};F.prototype.ddaGetSelectedData=function(S,Ma,Gb,hc,Yc,ed,xd){var Ed=this;this.DJ(function(Xd,
Ud,ne){var Qe=Ed.$.oa.xa,ff=Ed.gja();Xd=Tf.b(Xd,ed);Ud=Tf.a(Ud,Ed.WH);var of=Qe.Na(1);of.controlId=S;of.coerceType=Ma;of.valueFormat=Gb;of.filterType=hc;of.currentSheetName=ff;of.formula=Yc;return Yg.g(Qe,"DdaGetSelectedData",of,Xd,Ud,ne,xd,0)},xd,569,16)};F.prototype.ddaSetSelectedData=function(S,Ma,Gb,hc,Yc){var ed=this;this.DJ(function(xd,Ed,Xd){var Ud=ed.$.oa.xa,ne=ed.gja();xd=Tf.b(xd,hc);Ed=Tf.a(Ed,ed.WH);var Qe=Ud.Na(9);Qe.controlId=S;Qe.currentSheetName=ne;Qe.formula=Ma;Qe.bindingData=Gb;return Yg.g(Ud,
"DdaSetSelectedData",Qe,xd,Ed,Xd,Yc,0)},Yc,570)};F.prototype.ddaLoadSettings=function(S,Ma,Gb){var hc=this;this.DJ(function(Yc,ed,xd){var Ed=hc.$.oa.xa;Yc=Tf.b(Yc,Ma);ed=Tf.a(ed,hc.WH);var Xd=Ed.Na(1);Xd.controlId=S;return Yg.g(Ed,"DdaLoadSettings",Xd,Yc,ed,xd,Gb,0)},Gb,501,16)};F.prototype.ddaSaveSettings=function(S,Ma,Gb,hc,Yc){var ed=this;this.DJ(function(xd,Ed,Xd){var Ud=ed.$.oa.xa;xd=Tf.b(xd,hc);Ed=Tf.a(Ed,ed.WH);var ne=Ud.Na(9);ne.controlId=S;ne.settings=Ma;ne.overwriteIfStale=Gb;return Yg.g(Ud,
"DdaSaveSettings",ne,xd,Ed,Xd,Yc,0)},Yc,571)};F.prototype.ddaAddRowsColumns=function(S,Ma,Gb,hc,Yc,ed){var xd=this;this.DJ(function(Ed,Xd,Ud){var ne=xd.$.oa.xa,Qe=xd.gja();Ed=Tf.b(Ed,Yc);Xd=Tf.a(Xd,xd.WH);var ff=ne.Na(9);ff.controlId=S;ff.bindingId=Ma;ff.isRow=Gb;ff.currentSheetName=Qe;ff.bindingData=hc;return Yg.g(ne,"DdaAddRowsColumns",ff,Ed,Xd,Ud,ed,0)},ed,572)};F.prototype.ddaDeleteAllDataValues=function(S,Ma,Gb,hc){var Yc=this;this.DJ(function(ed,xd,Ed){var Xd=Yc.$.oa.xa,Ud=Yc.gja();ed=Tf.b(ed,
Gb);xd=Tf.a(xd,Yc.WH);var ne=Xd.Na(9);ne.controlId=S;ne.bindingId=Ma;ne.currentSheetName=Ud;return Yg.g(Xd,"DdaDeleteAllDataValues",ne,ed,xd,Ed,hc,0)},hc,573)};F.prototype.ddaClearBindingFormats=function(S,Ma,Gb,hc){var Yc=this;this.DJ(function(ed,xd,Ed){var Xd=Yc.$.oa.xa,Ud=Yc.gja();ed=Tf.b(ed,Gb);xd=Tf.a(xd,Yc.WH);var ne=Xd.Na(9);ne.controlId=S;ne.bindingId=Ma;ne.currentSheetName=Ud;return Yg.g(Xd,"DdaClearBindingFormats",ne,ed,xd,Ed,hc,0)},hc,574)};F.prototype.ddaSetBindingFormats=function(S,Ma,
Gb,hc,Yc,ed){var xd=this;this.DJ(function(Ed,Xd,Ud){var ne=xd.$.oa.xa,Qe=xd.gja();Ed=Tf.b(Ed,Yc);Xd=Tf.a(Xd,xd.WH);var ff=ne.Na(9);ff.controlId=S;ff.bindingId=Ma;ff.currentSheetName=Qe;ff.bindingData=Gb;ff.isSetFormats=hc;return Yg.g(ne,"DdaSetBindingFormats",ff,Ed,Xd,Ud,ed,0)},ed,575)};F.prototype.parseRange=function(S,Ma,Gb){var hc=this;this.DJ(function(Yc,ed,xd){var Ed=hc.$.oa.xa.Pb();return Yg.w(hc.$.oa.xa,S,-1,Tf.b(Yc,Ma),Tf.a(ed,hc.WH),xd,Gb,Ed)},Gb,162,16)};F.prototype.parseRangeForGoto=function(S,
Ma,Gb,hc){var Yc=this;this.DJ(function(ed,xd,Ed){var Xd=Yc.$.oa.xa.Pb();return Yg.x(Yc.$.oa.xa,S,Ma,Tf.b(ed,Gb),Tf.a(xd,Yc.WH),Ed,hc,Xd)},hc,562,16)};F.prototype.executeRichApiRequest=function(S,Ma,Gb){var hc=this;ef.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(S.RequestFlags&=8191);if(ef.EwaSettings.ma(259))this.Mwh(this.$.oa.xa.Pb(),Ma,function(){hc.fQ.vJa(Qf.a.internalError,Gb)},Gb,S);else{var Yc=Mg.DdaFacade.Ced(S);!ef.EwaSettings.isChangeGateEnabled("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")||
!this.$.ob.mz||Yc&16?(ef.EwaSettings.Zb()&&(Yc|=64),this.$.userOperationManager.Ot(new G(this.$,S,function(ed,xd,Ed){return J(hc.$.oa.xa,S,Tf.b(ed,Ma),Tf.a(xd,hc.WH),Ed,Gb)},Yc))):(this.fQ.vJa(Qf.a.NCc,Gb),ae.ULS.sendTraceTag(537163160,0,50,"Write operation is not allowed"))}};F.prototype.gja=function(){return this.$.ea.isNamedObjectViewMode?this.$.pa.sheetName:this.$.activeItemName};F.prototype.DJ=function(S,Ma,Gb,hc){hc=void 0===hc?0:hc;!ef.EwaSettings.isChangeGateEnabled("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")||
!this.$.ob.mz||hc&16?ef.EwaSettings.Zb()?this.$.userOperationManager.Ot(new Og.a(Gb,0,S,hc|64)):this.$.userOperationManager.Ot(new ji.a(Gb,0,S,hc)):(this.fQ.vJa(Qf.a.NCc,Ma),ae.ULS.sendTraceTag(537163159,0,50,"Write operation is not allowed"))};F.prototype.Mwh=function(S,Ma,Gb,hc,Yc){var ed=Mg.DdaFacade.Ced(Yc);if(!ef.EwaSettings.isChangeGateEnabled("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")||!this.$.ob.mz||ed&16){var xd=this.$.Fb.sc("UserAction","Rich Api request");ef.EwaSettings.Zb()&&
(ed|=64);this.$.userOperationManager.Sb(new T(this.$,S,Ma,Gb,hc,xd,Yc,ed),null)}else this.fQ.vJa(Qf.a.NCc,hc),ae.ULS.sendTraceTag(537163158,0,50,"Write operation is not allowed")};Object(Id.a)(F,"DdaWebServiceHelper",null,[]);Object(Id.a)(I,"DocumentFile",null,[]);D.generalException="GeneralException";D.bJg="ApiNotFound";D.oBd="OperationCancelled";D.invalidArgument="InvalidArgument";Object(Id.a)(D,"ErrorCodes",null,[]);x.prototype.replaceShortcuts=function(){return Promise.reject("ReplaceShortcuts method is not overridden")};
x.prototype.getShortcuts=function(){return Promise.reject("GetShortcuts method is not overridden")};x.prototype.checkShortcutsInUse=function(){return Promise.reject("CheckShortcutsInUse method is not overridden")};Object(Id.a)(x,"WacApiDelegates",null,[]);var Y=b(712);Rk(z,x);z.prototype.replaceShortcuts=function(S){return OfficeExt.ShortcutKeyDispatchManager.replaceShortcuts(this.addinId,S,this.Uff)};z.prototype.getShortcuts=function(){return OfficeExt.ShortcutKeyDispatchManager.getShortcuts(this.addinId)};
z.prototype.checkShortcutsInUse=function(S){return OfficeExt.ShortcutKeyDispatchManager.checkShortcutsInUse(S,this.Uff)};z.O6g=function(S,Ma){var Gb=document.createEvent("KeyboardEvent");if(ki.a.cF)Gb.initKeyboardEvent("keydown",!1,!1,window.self,"A",0,!!(S&8),!!(S&32),!!(S&4),!!(S&256));else{var hc=[];S&4&&hc.push("Shift");S&8&&hc.push("Control");S&32&&hc.push("Alt");Gb.initKeyboardEvent("keydown",!1,!1,window.self,"A",0,hc.join(" "),!1,"en-US")}S=new Sys.UI.DomEvent(Gb);S.keyCode=Ma;return S};z.r2g=
function(S,Ma){if(ki.a.Nf)switch(Ma){case 189:Ma=173;break;case 187:Ma=61;break;case 186:Ma=59}return z.O6g(S,Ma)};Object(Id.a)(z,"ExcelWacApiDelegates",x,[]);A.prototype.uAg=function(S,Ma){this.cdc(S)||(this.mIa[S]={});if(this.cgi(S))return ae.ULS.sendTraceTag(537163157,344,50,"App {0} has reach the limit of number of cached files.",S),Qf.a.qzi;this.mIa[S][Ma.Byh.toString()]=Ma;return Qf.a.success};A.prototype.AMh=function(S,Ma){var Gb=null;this.cdc(S)&&(Gb=this.mIa[S][Ma.toString()]);Gb||ae.ULS.sendTraceTag(537163156,
344,15,"File cache for [agave:{0}, fileHandler:{1}] doesn't exist",S,Ma);return Gb};A.prototype.cdc=function(S){return S in this.mIa};A.prototype.T8i=function(S,Ma){if(this.cdc(S)){var Gb=this.mIa[S];delete Gb[Ma.toString()];1>Object.keys(Gb).length&&delete this.mIa[S];return Ma.toString()in Gb?Qf.a.internalError:Qf.a.success}return Qf.a.internalError};A.prototype.cgi=function(S){return this.cdc(S)?Object.keys(this.mIa[S]).length>=this.Jyi:!1};A.getInstance=function(S){return S.da.za(200)||S.da.Ga(200,
new A(A.Kyi))};A.ICi=function(){return++A.HSg};A.pyi=4194304;A.Kyi=1;A.HSg=0;Object(Id.a)(A,"GetFileApiHelper",null,[]);B.prototype.notifyActionHandlerReady=function(){OfficeExt.ShortcutKeyDispatchManager.sendQueuedActions(this.hA)};B.prototype.getTypeName=function(){return"Microsoft.InternalService.AddinInternalService"};B.prototype.invokePropertyGet=function(S){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(S);};B.prototype.invokePropertyGetAsync=function(S){S=this.invokePropertyGet(S);
return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(S)};B.prototype.invokePropertySet=function(S){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(S);};B.prototype.invokePropertySetAsync=function(S,Ma){this.invokePropertySet(S,Ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};B.prototype.invokeMethod=function(S){switch(S){case 1:return this.oDi()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(S);};B.prototype.invokeMethodAsync=
function(S,Ma){S=this.invokeMethod(S,Ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(S)};B.prototype.oDi=function(){this.notifyActionHandlerReady();return null};Object(Id.a)(B,"AddinInternalService",null,[]);w.prototype.getAppRuntimeState=function(){return this.GI.getAppRuntimeState(this.hA)?2:1};w.prototype.setAppRuntimeState=function(S){switch(S){case 2:S=!0;break;case 1:S=!1;break;default:throw OfficeExtension.WacRuntime.Utility.createRichApiException(cg.a.invalidArgument,
Hh.a.ga(1744));}this.GI.setAppRuntimeState(this.hA,S)};w.prototype.getTypeName=function(){return"Microsoft.AppRuntime.AppRuntimeService"};w.prototype.invokePropertyGet=function(S){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(S);};w.prototype.invokePropertyGetAsync=function(S){S=this.invokePropertyGet(S);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(S)};w.prototype.invokePropertySet=function(S){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(S);
};w.prototype.invokePropertySetAsync=function(S,Ma){this.invokePropertySet(S,Ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};w.prototype.invokeMethod=function(S,Ma){switch(S){case 2:return this.HHh();case 1:return this.Nnj(Ma)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(S);};w.prototype.invokeMethodAsync=function(S,Ma){S=this.invokeMethod(S,Ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(S)};w.prototype.HHh=function(){return this.getAppRuntimeState()};
w.prototype.Nnj=function(S){S=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(S,0,"int");this.setAppRuntimeState(S);return null};Object(Id.a)(w,"AppRuntimeService",null,[]);var Ea=b(1172);m.prototype.disable=function(){try{if(!Hh.a.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled"))return this.UBe();if(!this.qff())return this.VBe();this.n1.pOj(this.Ww)}catch(S){return ae.ULS.sendTraceTag(538572829,0,15,"BeforeDocumentCloseNotification.Disable() Failed. reason: {0}",
S.message||"Unknown"),this.SBe()}return null};m.prototype.enable=function(){try{if(!Hh.a.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled"))return this.UBe();if(!this.qff())return this.VBe();this.n1.X6i(this.Ww)}catch(S){return ae.ULS.sendTraceTag(538572828,0,15,"BeforeDocumentCloseNotification.Enable() Failed. reason: {0}",S.message||"Unknown"),this.SBe()}return null};m.prototype._OnAccess=function(){};m.prototype.getTypeName=function(){return"Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification"};
m.prototype.invokePropertyGet=function(S){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(S);};m.prototype.invokePropertyGetAsync=function(S){S=this.invokePropertyGet(S);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(S)};m.prototype.invokePropertySet=function(S){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(S);};m.prototype.invokePropertySetAsync=function(S,Ma){this.invokePropertySet(S,Ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};
m.prototype.invokeMethod=function(S){switch(S){case 1:return this.eCa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(S);};m.prototype.invokeMethodAsync=function(S,Ma){switch(S){case 3:return this.Veh();case 2:return this.Qjh()}S=this.invokeMethod(S,Ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(S)};m.prototype.Veh=function(){return this.disable()};m.prototype.Qjh=function(){return this.enable()};m.prototype.eCa=function(){this._OnAccess();return null};
m.prototype.UBe=function(){return Ea.a(cg.a.notImplemented,Hh.a.ga(1745))};m.prototype.VBe=function(){return Ea.a(cg.a.sharedRuntimeNotAvailable,Hh.a.ga(1749))};m.prototype.SBe=function(){return Ea.a(cg.a.generalException,Hh.a.ga(1740))};m.prototype.qff=function(){var S=this.zy.getSharedRuntimeId();return!!S&&0<S.length};Object(Id.a)(m,"BeforeDocumentCloseNotification",null,[]);y.prototype.getTypeName=function(){return"Microsoft.ExcelServices.CustomFunctionEngineStatus"};y.prototype.invokePropertyGet=
function(S){switch(S){case 1:return this.enabled;case 3:return this.nativeRuntime;case 2:return this.streamingEnabled}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(S);};y.prototype.invokePropertyGetAsync=function(S){S=this.invokePropertyGet(S);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(S)};y.prototype.invokePropertySet=function(S,Ma){switch(S){case 1:this.enabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ma,0,"boolean");return;case 3:this.nativeRuntime=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ma,0,"boolean");return;case 2:this.streamingEnabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(Ma,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(S);};y.prototype.invokePropertySetAsync=function(S,Ma){this.invokePropertySet(S,Ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};y.prototype.invokeMethod=function(S){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(S);
};y.prototype.invokeMethodAsync=function(S,Ma){S=this.invokeMethod(S,Ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(S)};Mf.Object.defineProperties(y.prototype,{enabled:{configurable:!0,enumerable:!0,get:function(){return this.bA},set:function(S){this.bA=S}},nativeRuntime:{configurable:!0,enumerable:!0,get:function(){return this.Gae},set:function(S){this.Gae=S}},streamingEnabled:{configurable:!0,enumerable:!0,get:function(){return this.sge},set:function(S){this.sge=S}}});Object(Id.a)(y,
"CustomFunctionEngineStatus",null,[]);r.prototype.register=function(S){return OfficeExtension.WacRuntime.Utility.createPromise(this.dug(S))};r.prototype.getTypeName=function(){return"Microsoft.ExcelServices.CustomFunctionManager"};r.prototype.invokePropertyGet=function(S){switch(S){case 2:return this.status}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(S);};r.prototype.invokePropertyGetAsync=function(S){S=this.invokePropertyGet(S);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(S)};
r.prototype.invokePropertySet=function(S){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(S);};r.prototype.invokePropertySetAsync=function(S,Ma){this.invokePropertySet(S,Ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};r.prototype.invokeMethod=function(S){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(S);};r.prototype.invokeMethodAsync=function(S,Ma){switch(S){case 1:return this.N7i(Ma)}S=this.invokeMethod(S,Ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(S)};
r.prototype.N7i=function(S){var Ma=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(S,0,"string");S=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(S,1,"string");return this.register(Ma,S)};Mf.Object.defineProperties(r.prototype,{status:{configurable:!0,enumerable:!0,get:function(){var S=new y;S.enabled=this.$pg;S.streamingEnabled=this.aqg;S.nativeRuntime=!1;return S}}});Object(Id.a)(r,"CustomFunctionManager",null,[]);var sb=b(1154);v.prototype._RegisterStateChange=function(){var S=
this;this.nSb||this.OO.execute(function(Ma){S.K1d=Ma.yma(S._id,function(Gb){S.GI.FAh(S.hA,S._id,JSON.stringify(Gb))})});this.nSb++;return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};v.prototype._UnregisterStateChange=function(){var S=this;this.nSb--;this.nSb||this.OO.execute(function(Ma){Ma.xHd(S._id,S.K1d)});return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};v.prototype.getTypeName=function(){return"Microsoft.Office.Licensing.LicenseFeature"};v.prototype.invokePropertyGet=
function(S){switch(S){case 5:return this.id}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(S);};v.prototype.invokePropertyGetAsync=function(S){S=this.invokePropertyGet(S);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(S)};v.prototype.invokePropertySet=function(S){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(S);};v.prototype.invokePropertySetAsync=function(S,Ma){this.invokePropertySet(S,Ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};
v.prototype.invokeMethod=function(S){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(S);};v.prototype.invokeMethodAsync=function(S,Ma){switch(S){case 6:return this.pjg();case 7:return this.rjg()}S=this.invokeMethod(S,Ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(S)};v.prototype.pjg=function(){return this._RegisterStateChange()};v.prototype.rjg=function(){return this._UnregisterStateChange()};Mf.Object.defineProperties(v.prototype,{id:{configurable:!0,enumerable:!0,
get:function(){return this._id}}});Object(Id.a)(v,"LicenseFeature",null,[]);f.prototype.getFeatureTier=function(S,Ma){var Gb=this;return OfficeExtension.WacRuntime.Utility.createPromise(function(hc){var Yc=1===Ma?1:2===Ma?2:0;Gb.OO.execute(function(ed){ed.getFeatureTier(S,Yc).then(function(xd){hc(Gb.HQh(xd))},function(){hc(Ma)})})})};f.prototype.getLicenseFeature=function(S){S=new v(this.OO,S,this.hA,this.GI);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(S)};f.prototype.isFeatureEnabled=
function(S,Ma){var Gb=this;return OfficeExtension.WacRuntime.Utility.createPromise(function(hc){Gb.OO.execute(function(Yc){Yc.isFeatureEnabled(S,Ma).then(function(ed){hc(ed)},function(){hc(Ma)})})})};f.prototype.isFreemiumUpsellEnabled=function(){var S=this;return OfficeExtension.WacRuntime.Utility.createPromise(function(Ma){S.OO.execute(function(Gb){Gb=Gb.isFreemiumUpsellEnabled();Ma(Gb)})})};f.prototype.launchUpsellExperience=function(S){var Ma=this;if(this.Tsg.isFirstParty())return OfficeExtension.WacRuntime.Utility.createPromise(function(){Ma.OO.execute(function(Gb){Gb.launchUpsellExperience(S)})});
throw OfficeExtension.WacRuntime.Utility.createRichApiException(cg.a.ASc,"");};f.prototype._TestFireStateChangedEvent=function(){};f.prototype.getTypeName=function(){return"Microsoft.Office.Licensing.License"};f.prototype.invokePropertyGet=function(S){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(S);};f.prototype.invokePropertyGetAsync=function(S){S=this.invokePropertyGet(S);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(S)};f.prototype.invokePropertySet=function(S){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(S);
};f.prototype.invokePropertySetAsync=function(S,Ma){this.invokePropertySet(S,Ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};f.prototype.invokeMethod=function(S,Ma){switch(S){case 6:return this.qjg(Ma)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(S);};f.prototype.invokeMethodAsync=function(S,Ma){switch(S){case 2:return this.uNh(Ma);case 5:return this.GQh(Ma);case 1:return this.Rgi(Ma);case 3:return this.xhi();case 4:return this.Yqi(Ma)}S=this.invokeMethod(S,
Ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(S)};f.prototype.uNh=function(S){var Ma=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(S,0,"string");S=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(S,1,"int");return this.getFeatureTier(Ma,S)};f.prototype.GQh=function(S){S=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(S,0,"string");return this.getLicenseFeature(S)};f.prototype.Rgi=function(S){var Ma=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(S,
0,"string");S=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(S,1,"boolean");return this.isFeatureEnabled(Ma,S)};f.prototype.xhi=function(){return this.isFreemiumUpsellEnabled()};f.prototype.Yqi=function(S){S=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(S,0,"string");return this.launchUpsellExperience(S)};f.prototype.qjg=function(S){S=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(S,0,"string");this._TestFireStateChangedEvent(S);return null};f.prototype.HQh=function(S){switch(S){case 1:return 1;
case 2:return 2;default:return 0}};Object(Id.a)(f,"License",null,[]);var fc=b(159);l.prototype.areShortcutsInUse=function(S){var Ma=this;return OfficeExtension.WacRuntime.Utility.createPromise(function(Gb,hc){Ma.Fud.checkShortcutsInUse(S).then(function(Yc){Gb(Yc)}).catch(function(Yc){hc(Yc)})})};l.prototype.getShortcuts=function(){var S=this;return OfficeExtension.WacRuntime.Utility.createPromise(function(Ma,Gb){S.Fud.getShortcuts().then(function(hc){Ma(hc)}).catch(function(hc){Gb(hc)})})};l.prototype.replaceShortcuts=
function(S){var Ma=this;return OfficeExtension.WacRuntime.Utility.createPromise(function(Gb,hc){Ma.Fud.replaceShortcuts(S).then(function(){Gb(null)}).catch(function(Yc){hc(Yc)})})};l.prototype.getTypeName=function(){return"Microsoft.Office.ActionService"};l.prototype.invokePropertyGet=function(S){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(S);};l.prototype.invokePropertyGetAsync=function(S){S=this.invokePropertyGet(S);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(S)};
l.prototype.invokePropertySet=function(S){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(S);};l.prototype.invokePropertySetAsync=function(S,Ma){this.invokePropertySet(S,Ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};l.prototype.invokeMethod=function(S){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(S);};l.prototype.invokeMethodAsync=function(S,Ma){switch(S){case 3:return this.LKg(Ma);case 1:return this.UWh();case 2:return this.qdj(Ma)}S=
this.invokeMethod(S,Ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(S)};l.prototype.LKg=function(S){S=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(S,0,"Array<string>");return this.areShortcutsInUse(S)};l.prototype.UWh=function(){return this.getShortcuts()};l.prototype.qdj=function(S){S=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(S,0,"any");return this.replaceShortcuts(S)};Object(Id.a)(l,"ActionService",null,[]);var Hc=b(567);k.prototype.GWh=function(){this.cra||
(this.cra=Hc.a.Jq(fh.a.instance.Tb("Common.App.SharedFilePicker.ISharedFilePicker")));return this.cra};k.prototype.getSharedFilePickerResponse=function(S){var Ma=this;return OfficeExtension.WacRuntime.Utility.createPromise(function(Gb,hc){try{var Yc=Ma.GWh();Mh.Task.WAA.call(null,Yc).continueWith(function(){var ed=Yc.result;if(ed){var xd={};(function(){var Ed=Eh.d(S);xd=Ed.Lt;return Ed})().returnValue?ed.fdd(xd).then(function(Ed){Ed&&0<Ed.length?Gb(Ed):hc(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException",
"The picker returned null or an empty array."))}).catch(function(Ed){hc(Ed)}):hc(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException","The dialog customazation json string can not be deserialized."))}else hc(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException","The picker is resolved as null."))})}catch(ed){hc(ed)}})};k.prototype.getTypeName=function(){return"Microsoft.Office.SharedFilePicker"};k.prototype.invokePropertyGet=function(S){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(S);
};k.prototype.invokePropertyGetAsync=function(S){S=this.invokePropertyGet(S);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(S)};k.prototype.invokePropertySet=function(S){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(S);};k.prototype.invokePropertySetAsync=function(S,Ma){this.invokePropertySet(S,Ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};k.prototype.invokeMethod=function(S){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(S);
};k.prototype.invokeMethodAsync=function(S,Ma){switch(S){case 1:return this.FWh(Ma)}S=this.invokeMethod(S,Ma);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(S)};k.prototype.FWh=function(S){S=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(S,0,"string");return this.getSharedFilePickerResponse(S)};Object(Id.a)(k,"SharedFilePicker",null,[]);e.prototype.createInstance=function(S,Ma){switch(S){case "Microsoft.Office.ActionService":return new l(Ma);case "Microsoft.Office.SharedFilePicker":return new k}return null};
Object(Id.a)(e,"WacApiHost",null,[]);d.prototype.hostName=function(){return"ExcelOnline"};d.prototype.appId=function(){return this.uQb};d.prototype.createInstance=function(S){switch(S){case "Microsoft.Authentication.AuthenticationService":return fh.a.instance.resolve("Microsoft.Office.Excel.WebUI.Client.WebExtension.AuthenticationServiceFactory").create(this.hA,this.GI.Qh);case "Microsoft.Authentication.TokenParameters":return new va;case "Microsoft.ExcelServices.CustomFunctionManager":S=this.jb.ma(122);
var Ma=this.jb.ma(123);return new r(S,Ma,n(this.uQb,this.jb,this.GI));case "Microsoft.AppRuntime.AppRuntimeService":return new w(this.hA,this.GI);case "Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification":return S=Ph.a(this.jb),new m(this.uQb,this.hA,S,this.GI);case "Microsoft.DynamicRibbon.DynamicRibbon":return S=Ph.a(this.jb),new sb.DynamicRibbon(this.uQb,this.hA,this.GI,S,S.Tm(this.hA).dl);case "Microsoft.Office.Licensing.License":return new f(this.hA,this.GI);case "Microsoft.InternalService.AddinInternalService":return new B(this.hA);
default:if(this.fSc||(this.fSc=new e),Ma=this.fSc.createInstance(S,this.jyg))return Ma}ae.ULS.sendTraceTag(537163155,0,10,"Typename: {0} is an invalid parameter for the RichApiHost.CreateInstance method.",S);throw OfficeExtension.WacRuntime.Utility.createRichApiException(cg.a.generalException,cg.a.generalException);};Object(Id.a)(d,"RichApiHost",null,[]);var $c=b(408),Zc=b(28),Oc=b(119),Kc=b(34),id=b(101),pd=b(296),Md=b(42),ie=b(258),te=b(6),Te=b(67),Xe=b(205);c.prototype.dispose=function(){this.$=
this.Y8b=null};c.prototype.Lc=function(){return!1};c.prototype.Qc=function(){return!1};c.prototype.executeCommand=function(S,Ma,Gb){S=Ma.command;switch(S){case 451041795:this.re.kf(Gb[oh.a.Uf],Gb[oh.a.n3]);break;case 974713501:this.r2h(Gb[oh.a.Uf],Gb[oh.a.n3]);break;case 1237877382:this.re.Ku(Gb[oh.a.n3]);break;default:return Sf.a(S)}return Mh.Task.Ua(!0)};c.prototype.zc=function(S,Ma,Gb){if(S=!!Gb)switch(Ma.command){case 974713501:case 1237877382:case 451041795:break;default:S=!1}return S};c.prototype.r2h=
function(S,Ma){var Gb,hc=S.DdaMethod;if("undefined"===typeof hc.DispatchId)this.re.kf(Qf.a.internalError,Ma);else if(c.Wfi(S)||this.$.Cd&1){if(hc.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromPromptMethod?(new N(this.$,this,S,Ma)).start(this.se,S.DdaMethod.ControlId):hc.DispatchId===OSF.DDA.MethodDispId.dispidGetSelectedDataMethod?this.fWh(S,Ma):hc.DispatchId===OSF.DDA.MethodDispId.dispidSetSelectedDataMethod?this.isj(S,Ma):hc.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromSelectionMethod?
this.addBinding(S,this.Fcd(S.DdaMethod.ControlId),0,Ma):hc.DispatchId===OSF.DDA.MethodDispId.dispidGetBindingDataMethod?this.pIh(S,Ma):hc.DispatchId===OSF.DDA.MethodDispId.dispidSetBindingDataMethod?this.Ynj(S,Ma):hc.DispatchId===OSF.DDA.MethodDispId.dispidGetBindingMethod?this.oIh(S,Ma):hc.DispatchId===OSF.DDA.MethodDispId.dispidReleaseBindingMethod?this.S8i(S,Ma):hc.DispatchId===OSF.DDA.MethodDispId.dispidGetAllBindingsMethod?this.lHh(S,Ma):hc.DispatchId===OSF.DDA.MethodDispId.dispidLoadSettingsMethod?
this.Jsd(S,Ma):hc.DispatchId===OSF.DDA.MethodDispId.dispidSaveSettingsMethod?this.saveSettings(S,Ma):hc.DispatchId===OSF.DDA.MethodDispId.dispidAddRowsMethod?(S.DdaAddRowsColumns.IsRow=!0,this.gle(S,Ma)):hc.DispatchId===OSF.DDA.MethodDispId.dispidAddColumnsMethod?(S.DdaAddRowsColumns.IsRow=!1,this.gle(S,Ma)):hc.DispatchId===OSF.DDA.MethodDispId.dispidClearAllRowsMethod?this.Fch(S,Ma):hc.DispatchId===OSF.DDA.MethodDispId.dispidClearFormatsMethod?this.pXg(S,Ma):hc.DispatchId===OSF.DDA.MethodDispId.dispidSetFormatsMethod?
(S.DdaSetBindingFormats.IsSetFormats=!0,this.tXf(S,Ma)):hc.DispatchId===OSF.DDA.MethodDispId.dispidSetTableOptionsMethod?(S.DdaSetBindingFormats.IsSetFormats=!1,this.tXf(S,Ma)):hc.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromNamedItemMethod?this.addBinding(S,S.DdaBindingsMethod.ItemName,S.DdaBindingsMethod.FailOnCollision?2:1,Ma):hc.DispatchId===OSF.DDA.MethodDispId.dispidGetFilePropertiesMethod?this.yNh(Ma):hc.DispatchId===OSF.DDA.MethodDispId.dispidNavigateToMethod?this.pwd(S,Ma):hc.DispatchId===
OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod?this.executeRichApiRequest(S,Ma):hc.DispatchId===OSF.DDA.MethodDispId.dispidGetDocumentCopyMethod?this.xMh(S,Ma):hc.DispatchId===OSF.DDA.MethodDispId.dispidGetDocumentCopyChunkMethod?this.yMh(S,Ma):hc.DispatchId===OSF.DDA.MethodDispId.dispidReleaseDocumentCopyMethod?this.U8i(S,Ma):hc.DispatchId===OSF.DDA.MethodDispId.dispidAppCommandInvocationCompletedMethod?(OfficeExt.AddinCommandsRuntimeManager.invocationCompleted(S.DdaMethod.ControlId,S),this.re.Ku(Ma)):
hc.DispatchId===OSF.DDA.MethodDispId.dispidMessageParentMethod?ef.EwaSettings.ma(24)?this.re.kf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Ma):this.Mzi(S,Ma):hc.DispatchId===OSF.DDA.MethodDispId.dispidSendMessageMethod?ef.EwaSettings.ma(24)?this.re.kf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Ma):this.Izi(S,Ma):hc.DispatchId===OSF.DDA.MethodDispId.dispidGetAccessTokenMethod?this.getAccessToken(S,Ma):hc.DispatchId===OSF.DDA.MethodDispId.dispidGetAuthContextMethod?
this.getAuthContext(S,Ma):this.re.kf(Qf.a.sBd,Ma),ef.EwaSettings.isChangeGateEnabled("OfficeVSO:5649666_AddLogForExcelOnlineCommonAPIUsage")&&hc.DispatchId!==OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod){S=this.se.dZ(S.DdaMethod.ControlId);Ma="";if(S){Ma=Mg.DdaFacade.getSolutionId(S,this.$);var Yc=S.PrimaryMarketplace.MarketplaceType;Yc===OSF.StoreType.InMemory?S.OwnerAddinSolutionId&&S.AssetMarketplace&&(Yc=S.AssetMarketplace.MarketplaceType):Yc===OSF.StoreType.WopiCatalog&&(Yc=OSF.StoreType.OMEX);
Ma=Telemetry.PrivacyRules.GetPrivacyCompliantId(Ma,Yc,null===(Gb=S.AssetMarketplace)||void 0===Gb?void 0:Gb.SolutionId,null,null,S.PrimaryMarketplace.MarketplaceRef)}ae.ULS.sendTraceTag(537163224,344,50,"DDA method Id: {0}, AppID: {1}",hc.DispatchId,Ma)}}else this.re.kf(Qf.a.WHe,Ma)};c.prototype.pIh=function(S,Ma){var Gb=this;S.DdaGetBindingData.CoerceType=c.H2b(S.DdaGetBindingData.CoerceType);S.DdaGetBindingData.FilterType=c.PRe(S.DdaGetBindingData.FilterType);S.DdaGetBindingData.ValueFormat=c.weg(S.DdaGetBindingData.ValueFormat);
if(this.cic(S.DdaGetBindingData.CoerceType,Ma)){if(S.DdaGetBindingData){var hc=S.DdaGetBindingData;0===hc.FilterType&&(hc.FilterType=2);hc.StartCol|=0;hc.StartRow|=0;hc.ColCount=void 0===hc.ColCount?-1:hc.ColCount;hc.RowCount=void 0===hc.RowCount?-1:hc.RowCount}this.Sz.ddaGetBindingData(S.DdaMethod.ControlId,S.DdaGetBindingData.BindingId,S.DdaGetBindingData.CoerceType,S.DdaGetBindingData.ValueFormat,S.DdaGetBindingData.FilterType,S.DdaGetBindingData.StartRow,S.DdaGetBindingData.StartCol,S.DdaGetBindingData.RowCount,
S.DdaGetBindingData.ColCount,function(Yc){if(mh.a(Yc)||!Yc.Result)Gb.re.ZG(Yc,Ma);else{var ed=Gb.re.MP();ed.Data=c.xte(Yc.Result);Ma(ed)}},Ma)}};c.prototype.Ynj=function(S,Ma){var Gb=this;S.DdaSetBindingData.CoerceType=c.H2b(S.DdaSetBindingData.CoerceType);if(this.cic(S.DdaSetBindingData.CoerceType,Ma)){var hc=c.XXc(S.DdaSetBindingData.CoerceType,S.DdaSetBindingData.Data);c.hfc(hc)?this.re.kf(Qf.a.DAc,Ma):(1===hc.CoerceType&&(hc.CellFormat||(hc.CellFormat=S.DdaSetBindingData.CellFormat),hc.TableOptions||
(hc.TableOptions=S.DdaSetBindingData.TableOptions)),S.DdaSetBindingData&&(S.DdaSetBindingData.StartCol|=0,S.DdaSetBindingData.StartRow|=0),this.Sz.ddaSetBindingData(S.DdaMethod.ControlId,S.DdaSetBindingData.BindingId,S.DdaSetBindingData.StartRow,S.DdaSetBindingData.StartCol,hc,function(Yc){mh.a(Yc)?Gb.re.ZG(Yc,Ma):Gb.re.Ku(Ma)},Ma))}};c.prototype.fWh=function(S,Ma){var Gb=this;S.DdaGetBindingData.CoerceType=c.H2b(S.DdaGetBindingData.CoerceType);S.DdaGetBindingData.ValueFormat=c.weg(S.DdaGetBindingData.ValueFormat);
S.DdaGetBindingData.FilterType=c.PRe(S.DdaGetBindingData.FilterType);if(this.cic(S.DdaGetBindingData.CoerceType,Ma)){var hc=this.Fcd(S.DdaMethod.ControlId);hc?this.Sz.ddaGetSelectedData(S.DdaMethod.ControlId,S.DdaGetBindingData.CoerceType,S.DdaGetBindingData.ValueFormat,S.DdaGetBindingData.FilterType,hc,function(Yc){if(mh.a(Yc))Gb.re.ZG(Yc,Ma);else{var ed=Gb.re.MP();ed.Data=c.xte(Yc.Result);Ma(ed)}},Ma):this.re.kf(Qf.a.a1e,Ma)}};c.prototype.xMh=function(S,Ma){var Gb=this,hc=S[OSF.DDA.Marshaling.File.ParameterKeys.FileType.toString()],
Yc=S[OSF.DDA.Marshaling.File.ParameterKeys.SliceSize.toString()],ed=S.DdaMethod.ControlId,xd=A.getInstance(this.$);if(0>=Yc)ae.ULS.sendTraceTag(537163221,344,15,"Invalid slice size. It should be greater than 0."),this.re.kf(Qf.a.Cci,Ma);else if(Yc>A.pyi)ae.ULS.sendTraceTag(537163220,344,15,"Invalid slice size. It should be not greater than 4MB."),this.re.kf(Qf.a.oXe,Ma);else{var Ed=null;switch(hc){case 1:Ed="Compressed";break;case 0:Ed="Text";break;case 2:Ed="Pdf";break;default:ae.ULS.sendTraceTag(537163219,
344,15,"Requested file type {0} is not supported.",hc);this.re.kf(Qf.a.DRe,Ma);return}if("Text"===Ed)ae.ULS.sendTraceTag(537163218,344,15,"Requested file type {0} is not supported.",Ed),this.re.kf(Qf.a.DRe,Ma);else{ef.EwaSettings.isChangeGateEnabled("OfficeVSO:4182305_AddWholeWorkbookPrintOptionToGetFileAPI")?(S=new Sys.StringBuilder,S.append(uj.a(this.$,Ed)),"Pdf"===Ed&&Rj.a.Pg(S,sg.a.$Ed,"WholeWorkbook"),S=S.toString()):S=uj.a(this.$,Ed);var Xd=null,Ud=new XMLHttpRequest;Ud.onreadystatechange=function(){if(4===
Ud.readyState)if(200===Ud.status){var ne=Ud.response;if(ne){Xd=new Uint8Array(ne);ne=Gb.re.MP();for(var Qe=Xd.length,ff=A.ICi(),of={},Jf=0,kf=0;kf<Qe;kf+=Yc){for(var tf=[],xf=kf+Yc<Qe?kf+Yc:Qe,Nf=0,Ef=kf;Ef<xf;Nf++,Ef++)tf[Nf]=Xd[Ef];of[(Jf++).toString()]=tf}of=new I(ff,Qe,Yc,of);of=xd.uAg(ed,of);of!==Qf.a.success?Gb.re.kf(of,Ma):(ne[OSF.DDA.Marshaling.File.FilePropertiesKeys.Handle.toString()]=ff,ne[OSF.DDA.Marshaling.File.FilePropertiesKeys.FileSize.toString()]=Qe,ae.ULS.sendTraceTag(537163216,
344,50,"GetFileAsync get file successfully for file type {0}, the file size is {1}",Ed,Qe),Ma(ne))}else ae.ULS.sendTraceTag(537163217,344,15,"Request is successful, but respone have no data for file type {0}.",Ed),Gb.re.kf(Qf.a.internalError,Ma)}else 500===Ud.status?Gb.re.kf(Qf.a.fUe(parseInt(Ud.statusText,10)),Ma):(ae.ULS.sendTraceTag(537163215,344,15,"Request failed to obtain the file for type {0}.",Ed),Gb.re.kf(Qf.a.oCi,Ma))};Ud.open("GET",S,!0);Ud.responseType="arraybuffer";Ud.setRequestHeader("If-Modified-Since",
"0");Ud.send(null)}}};c.prototype.yMh=function(S,Ma){var Gb=S[OSF.DDA.Marshaling.File.ParameterKeys.Handle.toString()],hc=S[OSF.DDA.Marshaling.File.ParameterKeys.SliceIndex.toString()];S=S.DdaMethod.ControlId;(Gb=A.getInstance(this.$).AMh(S,Gb))?(Gb=Gb.IBj,0>hc||hc>=Object.keys(Gb).length?this.re.kf(Qf.a.h8h,Ma):(hc=Gb[hc.toString()],Gb=this.re.MP(),Gb[OSF.DDA.Marshaling.File.SlicePropertiesKeys.Data.toString()]=hc,Gb[OSF.DDA.Marshaling.File.SlicePropertiesKeys.SliceSize.toString()]=hc.length,Ma(Gb))):
this.re.kf(Qf.a.internalError,Ma)};c.prototype.U8i=function(S,Ma){var Gb=S[OSF.DDA.Marshaling.File.ParameterKeys.Handle.toString()];S=S.DdaMethod.ControlId;Gb=A.getInstance(this.$).T8i(S,Gb);Gb===Qf.a.success?this.re.Ku(Ma):this.re.kf(Gb,Ma)};c.prototype.isj=function(S,Ma){var Gb=this;S.DdaSetBindingData.CoerceType=c.H2b(S.DdaSetBindingData.CoerceType);if(this.cic(S.DdaSetBindingData.CoerceType,Ma)){var hc=this.Fcd(S.DdaMethod.ControlId);if(hc){var Yc=c.XXc(S.DdaSetBindingData.CoerceType,S.DdaSetBindingData.Data),
ed=Ng.g(this.$).ha;1===Yc.CoerceType&&(!Yc.Data&&ed.sa.l5&&(Yc.Headers||(Yc.Headers=[]),Yc.Headers.length||Yc.Headers.push([]),Yc.Headers[0].length||Array.add(Yc.Headers[0],"")),c.hfc(Yc)||(Yc.CellFormat||(Yc.CellFormat=S.DdaSetBindingData.CellFormat),Yc.TableOptions||(Yc.TableOptions=S.DdaSetBindingData.TableOptions)));if(c.hfc(Yc))this.re.kf(Qf.a.DAc,Ma);else{var xd=ed.sa.Vc.clone(),Ed=ed.sa.activeCell.clone();this.Sz.ddaSetSelectedData(S.DdaMethod.ControlId,hc,Yc,function(Xd){var Ud;if(mh.a(Xd))Gb.re.ZG(Xd,
Ma);else{Xd=xd.clone();var ne=Yc.Headers?Yc.Headers[0].length:Yc.Data[0].length;1!==Yc.CoerceType||Yc.Data?1===Yc.CoerceType&&(null===(Ud=Yc.TableOptions)||void 0===Ud?0:Ud.length)&&0==Yc.TableOptions[0]?(Xd.top+=1,Xd.bottom=Xd.top+Yc.Data.length-1):Xd.bottom=Xd.top+Yc.Data.length-(1===Yc.CoerceType?0:1):Xd.bottom=Xd.top+1;Xd.right=Xd.left+ne-1;Ud=Xd.contains(Ed)?Ed:Xd.topLeft;ed.updateSelection(Xd,Ud,0);Gb.re.Ku(Ma)}},Ma)}}else this.re.kf(Qf.a.Sve,Ma)}};c.prototype.addBinding=function(S,Ma,Gb,hc){var Yc=
this;Ma?this.Sz.ddaAddBinding(S.DdaMethod.ControlId,S.DdaBindingsMethod.BindingId,S.DdaBindingsMethod.BindingType,Ma,Gb,function(ed){if(mh.a(ed))Yc.re.ZG(ed,hc);else{var xd=Yc.re.MP();xd.Bindings=Array(1);xd.Bindings[0]=Yc.se.q0b(ed.Result);hc(xd)}},hc):this.re.kf(Qf.a.olj,hc)};c.prototype.oIh=function(S,Ma){var Gb=this;this.Sz.ddaGetBinding(S.DdaMethod.ControlId,S.DdaBindingsMethod.BindingId,function(hc){if(mh.a(hc)||!hc.Result)Gb.re.ZG(hc,Ma);else{var Yc=Gb.re.MP();Yc.Bindings=Array(1);Yc.Bindings[0]=
Gb.se.q0b(hc.Result);Ma(Yc)}},Ma)};c.prototype.yNh=function(S){var Ma=this.re.MP(),Gb={};Gb[OSF.DDA.Marshaling.FilePropertiesKeys.Url.toString()]=this.$.workbookContext.ClientUrl;Ma[OSF.DDA.Marshaling.FilePropertiesKeys.Properties.toString()]=Gb;S(Ma)};c.prototype.S8i=function(S,Ma){var Gb=this;this.Sz.ddaReleaseBinding(S.DdaMethod.ControlId,S.DdaBindingsMethod.BindingId,function(hc){mh.a(hc)?Gb.re.ZG(hc,Ma):Gb.re.Ku(Ma)},Ma)};c.prototype.lHh=function(S,Ma){var Gb=this;this.Sz.ddaGetAllBindings(S.DdaMethod.ControlId,
function(hc){if(mh.a(hc))Gb.re.ZG(hc,Ma);else{var Yc=Gb.re.MP();if(hc.Result){hc=hc.Result;Yc.Bindings=Array(hc.length);for(var ed=0;ed<hc.length;ed++)Yc.Bindings[ed]=Gb.se.q0b(hc[ed])}else Yc.Bindings=null;Ma(Yc)}},Ma)};c.prototype.Jsd=function(S,Ma){var Gb=this;this.Sz.ddaLoadSettings(S.DdaMethod.ControlId,function(hc){if(mh.a(hc))Gb.re.ZG(hc,Ma);else{var Yc=Gb.re.MP();Yc.Properties=hc.Result;Ma(Yc)}},Ma)};c.prototype.saveSettings=function(S,Ma){for(var Gb=this,hc={Settings:[]},Yc=0;Yc<S.DdaSettingsMethod.Properties.length;Yc++){var ed=
{};ed.Name=S.DdaSettingsMethod.Properties[Yc][0];ed.Value=S.DdaSettingsMethod.Properties[Yc][1];hc.Settings[Yc]=ed}this.Sz.ddaSaveSettings(S.DdaMethod.ControlId,hc,S.DdaSettingsMethod.OverwriteIfStale,function(xd){mh.a(xd)?Gb.re.ZG(xd,Ma):Gb.re.Ku(Ma)},Ma)};c.prototype.gle=function(S,Ma){var Gb=this,hc=c.XXc(1,S.DdaAddRowsColumns.Data);c.hfc(hc)?this.re.kf(Qf.a.DAc,Ma):this.Sz.ddaAddRowsColumns(S.DdaMethod.ControlId,S.DdaAddRowsColumns.BindingId,S.DdaAddRowsColumns.IsRow,hc,function(Yc){mh.a(Yc)?
Gb.re.ZG(Yc,Ma):Gb.re.Ku(Ma)},Ma)};c.prototype.Fch=function(S,Ma){var Gb=this;this.Sz.ddaDeleteAllDataValues(S.DdaMethod.ControlId,S.DdaBindingsMethod.BindingId,function(hc){mh.a(hc)?Gb.re.ZG(hc,Ma):Gb.re.Ku(Ma)},Ma)};c.prototype.pXg=function(S,Ma){var Gb=this;this.Sz.ddaClearBindingFormats(S.DdaMethod.ControlId,S.DdaClearBindingFormats.BindingId,function(hc){mh.a(hc)?Gb.re.ZG(hc,Ma):Gb.re.Ku(Ma)},Ma)};c.prototype.tXf=function(S,Ma){var Gb=this,hc={},Yc=S.DdaSetBindingFormats.IsSetFormats;Yc?hc.CellFormat=
S.DdaSetBindingFormats.CellFormat:hc.TableOptions=S.DdaSetBindingFormats.TableOptions;this.Sz.ddaSetBindingFormats(S.DdaMethod.ControlId,S.DdaSetBindingFormats.BindingId,hc,Yc,function(ed){mh.a(ed)?Gb.re.ZG(ed,Ma):Gb.re.Ku(Ma)},Ma)};c.prototype.executeRichApiRequest=function(S,Ma){var Gb=this,hc,Yc=S.ArrayData,ed={},xd=Ng.g(this.$).ha;if(Yc){if("WacPartition"===Yc[0]){this.rwh(S,Ma);return}var Ed=Object(rg.a)(Mg.DdaFacade,Ph.a(this.$));if("SetOsfControlContainerReadyForCustomFunctions"===Yc[0]){var Xd=
Ed.Tm(S.DdaMethod.ControlId);Xd&&(Xd.tod=!0,Xd.xIf())}ed.HttpMethod=Yc[1];ed.PathAndQuery=Yc[2];ed.RequestHeaders=c.FYe(Yc[3]);ed.RequestBody=Yc[4];ed.AppPermission=Yc[5];Xd=Yc[6];ed.RequestFlags=Xd;var Ud=0;if(Ch.i(this.$.pa))switch(xd.Pe){case 1:Ud=2;break;case 2:Ud=3;break;case 128:Ud=4;break;default:Ud=1}var ne=null;xd.Oa.nC&&(ne=xd.Oa.nC.Ai);ed.SheetMultiRange=zf.r(xd.sa.selectedRanges,this.$);ed.ActiveCell=zf.v(xd.sa.activeCell,this.$);ed.ActiveChartId=ne;ed.SelectionState=Ud;Ud=this.se.dZ(S.DdaMethod.ControlId);
ed.InstanceId=Ud?Ud.InstanceId:"";if(Ud&&Ud.PrimaryMarketplace){ne=Mg.DdaFacade.getSolutionId(Ud,this.$);var Qe=Ud.PrimaryMarketplace.MarketplaceType;if(Qe===OSF.StoreType.InMemory){if(!Ud.OwnerAddinSolutionId){this.re.kf(Qf.a.cyb,Ma);return}if(Ud.AssetMarketplace)Qe=Ud.AssetMarketplace.MarketplaceType;else{this.re.kf(Qf.a.cyb,Ma);return}}else Qe===OSF.StoreType.WopiCatalog&&(Qe=OSF.StoreType.OMEX);var ff=Telemetry.PrivacyRules.GetPrivacyCompliantId(ne,Qe,null===(hc=Ud.AssetMarketplace)||void 0===
hc?void 0:hc.SolutionId,null,null,Ud.PrimaryMarketplace.MarketplaceRef);ed.CompliantSolutionId=ff;ed.SolutionId=ne;ed.MarketplaceType=Qe;ed.SolutionVersion=Ud.PrimaryMarketplace.SolutionVersion;ed.StoreLocation=Ud.PrimaryMarketplace.MarketplaceRef}else ed.SolutionId=ed.MarketplaceType="",ed.CompliantSolutionId="";ed.IsEventsEnabled=void 0===Ed||null===Ed||Ed.Ri.B_b(ed.InstanceId);ed.RequestGuid=pi.a.create().toString();hc=ed.RequestBody.length;if(ef.EwaSettings.isChangeGateEnabled("OfficeVSO:4444309_RichApiPayloadSizeLimit")&&
hc>this.$.ya.ExcelRichApiMaxAllowedRequestPayloadSize){this.re.kf(Qf.a.Lej,Ma);ae.ULS.sendTraceTag(537163213,0,50,"Request payload size:{0} exceeded the limit",hc);return}ef.EwaSettings.isChangeGateEnabled("OfficeVSO:5079365_RichApiPreviewExecution")&&Xd&4096&&(hc=new M(this.$),OfficeExtension.WacRuntime.RichApi.previewExecute(hc,C,Yc),ed.RequestBody=Yc[4])}var of=c.E0e(ed.RequestHeaders);c.lCd++;var Jf=Zc.a.Ta.Jb;ef.EwaSettings.isChangeGateEnabled("OfficeVSO:4316383_RichApiLogRequestBodySize")&&
ed&&ed.RequestBody&&ae.ULS.sendTraceTag(537163212,0,50,String.format("Richapi json request body size is {0}",ed.RequestBody.length));this.Sz.executeRichApiRequest(ed,function(kf){var tf;Gb.DWf(Jf,!0,kf.ServerCorrelationId);var xf=null,Nf=null,Ef=kf.ServerCorrelationId;if(null===(tf=null===kf||void 0===kf?void 0:kf.Errors)||void 0===tf?0:tf[0])xf=kf.Errors[0].MessageIdName,Nf=kf.Errors[0].Description,ef.EwaSettings.isChangeGateEnabled("OfficeVSO:4513856_NotShowApiExceptionOnUI")&&Te.a(Gb.$).fd.eJ(kf.Errors[0].MessageId);
if(mh.a(kf)||!kf.Result)Gb.qNa(Ef,of,"Server error",xf,Nf),Gb.re.ZG(kf,Ma);else{var Gf=null;if(ef.EwaSettings.ma(259))if((tf=kf.Result)&&tf.length){for(var Fg=0;Fg<tf.length;Fg++)if(tf[Fg].RequestGuid===ed.RequestGuid){Gf=tf[Fg];break}Gf||Gb.re.ZG(kf,Ma)}else Gf=kf.Result;else Gf=kf.Result;if(!xf&&Gf&&Gf.ResponseBody&&Gf.ResponseBody[0])if(kf=Gf.ResponseBody[0],kf.startsWith('{"Error":')){1<Gf.ResponseBody.length&&(kf=kf.substring(0,kf.indexOf("}")+1),kf+="}");try{var Cf=jg.a.Th(kf);Cf.Error&&Gb.qNa(Ef,
of,"Pipeline error",Cf.Error.Code,Cf.Error.Message)}catch(qh){Gb.qNa(Ef,of,"Json deserialize error",null,"Error info cannot be deserialized.")}}else Gb.qNa(Ef,of);else Gb.qNa(Ef,of,"Server error",xf,Nf);var yg=(Cf=Gf.SheetMultiRange)?Cf.SheetName:null;kf=Gf.ActiveChartId;var Jg=Gf.SelectionState;xf=5===Jg&&!!Cf||6===Jg||7===Jg||8===Jg;if(ef.EwaSettings.isChangeGateEnabled("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")&&Gb.$.ob.mz&&xf)Gb.re.kf(Qf.a.NCc,Ma),ae.ULS.sendTraceTag(537163211,
0,50,String.format("{0} is not allowed",Jg.toString()));else if(5===Jg&&Cf){if(Gb.$.va&&yg)if(Gb.$.va.Jj(yg))Gb.ZSc(yg);else{var xj=null;xj=function(){Gb.$.va.Jj(yg)&&(ae.ULS.sendTraceTag(537163210,0,50,"Sheets item add event handler called"),Gb.ZSc(yg),Gb.$.va.$Hb(xj))};Gb.$.va.Zmb(xj);if(ef.EwaSettings.isChangeGateEnabled("OfficeVSO:3973943_RichApiFixSheetActivateOnNewWorkbookEnabled")){var Zi=null;Zi=function(){Gb.$.va.Jj(yg)&&(Gb.ZSc(yg),Gb.$.va.Ima(Zi))};Gb.$.va.Ega(Zi)}}}else if(6===Jg||7===
Jg||8===Jg||9===Jg){if(Cf){var zg=zf.g(Cf.Ranges);if(yg&&zf.cb(zg,!0))if(ef.EwaSettings.isChangeGateEnabled("OfficeVSO:4211161_RichApiUpdateSelectionWithoutExistsWorksheet")&&!Gb.$.va.Jj(yg)){var ih=null;ih=function(){Gb.Rcg(xd,zg,yg,Jg);Gb.$.va.Ima(ih)};Gb.$.va.Ega(ih)}else Gb.Rcg(xd,zg,yg,Jg)}7===Jg?(kf="38.{"+Xe.e(kf)+"}",Di.a(Gb.$).ana(0,kf,!0)):8===Jg&&Di.a(Gb.$).ana(2,kf,!0);9===Jg&&(Gb.$.ya.ApiCallToSetPageLayout=!0)}Gf.PostProcessActions?Gb.$.Kef?(Ef=jg.a.Th(Gf.PostProcessActions),Gb.tZi(Ef).then(function(){Gb.Xbb(Gf,
Ma);Gb.K$c(S.DdaMethod.ControlId,ed);return Promise.resolve(null)},function(qh){Gb.Xbb(Gf,Ma,qh);return Promise.reject(qh)})):(Gb.qNa(Ef,of,"Promise not supported",null,"Promise is not supported on this browser."),Gb.re.kf(Qf.a.internalError,Ma)):Gb.Xbb(Gf,Ma)}},function(kf){Gb.DWf(Jf,!1,null);Gb.qNa(null,of,"Web service error");Ma(kf)})};c.prototype.K$c=function(S,Ma){var Gb=Object(rg.a)(Mg.DdaFacade,Ph.a(this.$));(null===Gb||void 0===Gb?0:Gb.YKd)&&Gb.Tm(S)&&c.Zvj(Ma.RequestHeaders)&&(ae.ULS.sendTraceTag(537163209,
0,50,"ExecuteRichApiRequest(PostProcess): fire a RecordingStateChanged event to ControlId: {0}; SolutionId: {1}.",S,Ma.SolutionId),Gb.YKd.Wkh(S))};c.prototype.rwh=function(S,Ma){var Gb=this,hc=this.se.dZ(S.DdaMethod.ControlId),Yc=Mg.DdaFacade.getSolutionId(hc,this.$),ed=null;ed=Mg.DdaFacade.Fua(hc,this.$);ed=new z(ed,this.$);ed=new d(Yc,S.DdaMethod.ControlId,this.se,this.$,ed);var xd={ResponseHeaders:[]};xd.ResponseBody=Array(1);hc=c.FYe(S.ArrayData[3]);var Ed=c.E0e(hc);hc=new P(this.$.ya.CreateWorkbookMaxAllowedBase64Size,
this.Bqf);OfficeExtension.WacRuntime.RichApi.executeRichApiRequest(ed,ka,hc,S.ArrayData).then(function(Xd){if(!Xd)return Gb.ytd(!1,"The rich api executor call failed",Ed),ae.ULS.sendTraceTag(537163208,0,10,"The rich api executor call failed"),xd.ResponseStatusCode=500,Gb.Xbb(xd,Ma),null;Gb.ytd(!0,"The rich api executor call succeeded",Ed);xd.ResponseStatusCode=Xd[0];xd.ResponseBody[0]=Xd[2];Gb.Xbb(xd,Ma);return null},function(Xd){xd.ResponseStatusCode=400;xd.ResponseBody[0]=Xd.toString();Gb.ytd(!1,
"The rich api executor call failed",Ed);ae.ULS.sendTraceTag(537163207,0,10,"A Excel Rich API batch execution was failed, AppId:{0}",Yc);Gb.Xbb(xd,Ma);return null})};c.prototype.DWf=function(S,Ma,Gb){c.lCd--;S=Oc.a(Zc.a.Ta,S);ae.ULS.sendTraceTag(36763356,0,50,"Rich Api perf log -- total milliseconds used:{0}, requests pending:{1}, request result:{2}, server correlationid: {3}.",S,c.lCd,Ma?"success":"false",Gb)};c.prototype.Xbb=function(S,Ma,Gb){Gb=void 0===Gb?null:Gb;var hc=Array(3);hc[0]=S.ResponseStatusCode;
hc[1]=c.zXh(S.ResponseHeaders);var Yc=[],ed=!1;if(Gb&&S.ResponseBody){var xd=jg.a.Th(S.ResponseBody.join(""));xd.Error||(ed={},ed.Error=Gb,ed.TraceIds=xd.TraceIds,ed.ProcessedResults={},ed.ProcessedResults.Results=xd.Results,Yc[0]=jg.a.xc(ed),ed=!0)}hc[2]=ed?Yc:S.ResponseBody;S=this.re.MP();S.Data=hc;Ma(S)};c.prototype.pwd=function(S,Ma){(new H(this.$,this.re,this.Sz)).pwd(S,Ma)};c.prototype.Mzi=function(S,Ma){ae.ULS.sendTraceTag(537163206,0,50,"MessageParent API called!");var Gb=S[OSF.DDA.Marshaling.MessageParentKeys.MessageToParent],
hc=S[jf.a.WUc],Yc=S[OSF.DDA.Marshaling.MessageParentKeys.TargetOrigin];S=this.$.da.za(232).$0a.Nzi(S.DdaMethod.ControlId,Gb,hc,Yc);S===Qf.a.success?this.re.Ku(Ma):(ae.ULS.sendTraceTag(537163205,0,10,"MessageParent API Failed!"),this.re.kf(S,Ma))};c.prototype.Izi=function(S,Ma){ae.ULS.sendTraceTag(537163204,0,50,"MessageChild API called!");var Gb=S[OSF.DDA.Marshaling.SendMessageKeys.MessageContent],hc=S[jf.a.WUc],Yc=S[OSF.DDA.Marshaling.MessageParentKeys.TargetOrigin];this.$.da.za(232).$0a.mmj(S.DdaMethod.ControlId,
Gb,hc,Yc);this.re.Ku(Ma)};c.prototype.getAccessToken=function(S,Ma){function Gb(ed,xd){var Ed;if(ed===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)ed=hc.re.MP(),ed[OSF.DDA.Marshaling.SingleSignOn.AccessTokenResultKeys.AccessToken]=xd.accessToken,Ma(ed);else{xd=hc.se.dZ(S.DdaMethod.ControlId);var Xd=null!==xd.OwnerAddinStoreType?xd.OwnerAddinStoreType:xd.PrimaryMarketplace.MarketplaceType,Ud={};ae.ULS.sendTraceTag(537163202,0,10,"{0}.",(Ud.errorCode=ed.toString(),Ud.appId=Telemetry.PrivacyRules.GetPrivacyCompliantId(Mg.DdaFacade.getSolutionId(xd,
hc.$),Xd,null===(Ed=xd.AssetMarketplace)||void 0===Ed?void 0:Ed.SolutionId,null,null,xd.PrimaryMarketplace.MarketplaceRef),Ud.storeType=Xd,Ud));hc.re.kf(ed,Ma)}}var hc=this;ae.ULS.sendTraceTag(537163203,0,50,"GetAccessToken API called!");var Yc=!ef.EwaSettings.ma(24);$f.TaskExtensions.Aa(Lg.GetServiceTaskFactory.create(this.$.da,137,this.$.la,1),function(ed){var xd=hc.se.Qh,Ed=fa.getInstance();sj.AppsForOfficeSingleSignOnManager.getInstance(xd,ed.result,Ed).getAccessToken(S.DdaMethod.ControlId,Yc,
S,Gb)},this.$.la)};c.prototype.getAuthContext=function(S,Ma){var Gb=this;$f.TaskExtensions.Aa(Lg.GetServiceTaskFactory.create(this.$.da,137,this.$.la,1),function(){var hc=Gb.se.Qh.getOsfControl(S.DdaMethod.ControlId);if(!ef.EwaSettings.getBooleanFeatureGate("Microsoft.Office.OEP.Block3PGetAuthContext",!0)||hc.isFirstParty()){hc=hc.getManifest();var Yc=hc.getMarketplaceID(),ed=hc.getWebApplicationId(),xd=hc.getWebApplicationMsaId();fh.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getAuthContext(Yc).then(function(Ed){var Xd=
Gb.re.MP(),Ud={};Ud[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AppId]=ed;Ud[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.MsaAppId]=xd||ed;Ud[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Upn]=Ed.upn;Ud[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.UserId]=Ed.userId;Ud[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Authority]=Ed.authority;Ud[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthorityType]=Pj.a.YHh(Ed.authorityType);Ud[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.IsAnonymous]=
Ed.isAnonymous;Ud[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.TenantId]=Ed.tenantId;Ud[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.SupportsAuthToken]=Ed.supportsAuthToken;Xd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthContext]=Ud;Ma(Xd)},function(Ed){var Xd=Gb.re.MP(),Ud={},ne=new Pj.a;Ud[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AppId]=ed;Ud[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.MsaAppId]=xd||ed;Ud[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Upn]=
ne.upn;Ud[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.UserId]=ne.userId;Ud[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Authority]=ne.authority;Ud[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthorityType]=ne.authorityType;Ud[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.IsAnonymous]=ne.isAnonymous;Ud[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.TenantId]=ne.tenantId;Ud[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Error]=Ed;Ud[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.SupportsAuthToken]=
ne.supportsAuthToken;Xd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthContext]=Ud;Xd.Error=1;Ma(Xd)})}},this.$.la)};c.prototype.Kfi=function(S){var Ma=Ng.g(this.$).ha;return 16===Ma.Pe&&!!Ma.Oa.Yb&&!!Ma.Oa.Yb.floatingObject&&xi.a.equals(Ma.Oa.Yb.floatingObject.id,S,!0)};c.prototype.Fcd=function(S){var Ma=Ng.g(this.$).ha;return Ma.sa.sg?1===Ma.Pe||this.Kfi(S)?Ma.Xha:null:null};c.prototype.cic=function(S,Ma){return 1!==S&&2!==S&&3!==S?(this.re.kf(Qf.a.Xye,Ma),!1):!0};c.prototype.ytd=function(S,
Ma,Gb){var hc={};hc.a=this.$.ya.UserSessionId;hc.b=S;hc.c=Ma;hc.d=null;hc.e=Gb;Qi.b().Ce(37,hc)};c.prototype.qNa=function(S,Ma,Gb,hc,Yc){Gb=void 0===Gb?null:Gb;hc=void 0===hc?null:hc;Yc=void 0===Yc?null:Yc;var ed={};S&&(ed.ServerCorrelationId=S);void 0!==Ma&&null!==Ma&&(ed.Source=Ma);Gb&&(ed.ErrorType=Gb);hc&&(ed.MessageId=hc);Yc&&(ed.StatusDescription=Yc);ef.EwaSettings.isChangeGateEnabled("OfficeVSO:6144055_EUIIDataInDbxheTag")&&hc&&"ExternalDataRefreshFailed"===hc&&(ed.StatusDescription="");ae.ULS.sendTraceTag(50688452,
0,50,jg.a.xc(ed))};c.prototype.tZi=function(S){for(var Ma=new Promise(function(hc){hc(null)}),Gb=0;Gb<S.length;Gb++)Ma=this.sZi(Ma,S[Gb]);return Ma};c.prototype.sZi=function(S,Ma){var Gb=this;if(!Ma)return ae.ULS.sendTraceTag(537163201,0,10,"Null PostProcessAction."),S.then(function(){return Promise.reject(c.W2a(D.generalException,gg.a.instance.ga(1740),null))});switch(Ma.actionType){case 1:case 2:S=S.then(function(){var hc=Object(rg.a)(Mg.DdaFacade,Ph.a(Gb.$));if(hc.Tm(Ma.controlId))switch(hc.Ri.G1h(Ma),
Ma.messageType){case 14:case 100:hc.XKd.Y_b(Ma);break;case 11:case 12:hc.zhj.kob(Ma);break;case 51:case 52:hc.xhj.kob(Ma);break;case 2101:case 2102:hc.yhj.kob(Ma);break;case 2E3:hc.Ahj.Y_b(Ma);break;case 2201:Gb.$.uka&&hc.YKd.ELg(Ma);break;case 2203:hc.Bhj.FLg(Ma);break;case 2700:ef.EwaSettings.isChangeGateEnabled("OfficeVSO:4251858_RangePicker")&&hc.WKd.Y_b(Ma)}else ae.ULS.sendTraceTag(537163171,0,10,"OsfControl with instanceId[{0}] doesn't exist.",Ma.controlId);return Promise.resolve(null)});break;
case 3:S=S.then(function(){Gb.s1h(Ma);return Promise.resolve(null)});break;case 15:ef.EwaSettings.isChangeGateEnabled("OfficeVSO:4251858_RangePicker")&&(S=S.then(function(){Gb.Y2h(Ma);return Promise.resolve(null)}));break;case 4:S=S.then(function(){if(ef.EwaSettings.ma(105)){var hc=Ng.g(Gb.$).ha.sa.activeCell;hc.top!==Ma.row+1&&hc.left!==Ma.column+1&&(hc=zf.v(Ui.Range.Tc(Ma.row+1,Ma.column+1),Gb.$),Ng.g(Gb.$).gg(hc,null,null,null,3,Xi.a.obh));Bi.a(Gb.$,243,242,0,function(Yc){Yc.adb(Ma.row+1,Ma.column+
1,1,!1,!1)})}return Promise.resolve(null)});break;case 7:S=S.then(function(){Object(rg.a)(Mg.DdaFacade,Ph.a(Gb.$)).Ri.VJe(Ma.controlId,Ma.isEnableEvents);return Promise.resolve(null)});break;case 5:S=S.then(function(){return Gb.J$g(Ma)});break;case 6:S=S.then(function(){return Gb.EUi(Ma)});break;case 8:S=S.then(function(){ef.EwaSettings.isChangeGateEnabled("OfficeVSO:5333368_ClearBeforeCloseRegistrationsInWorkbookCloseApi")&&Object(rg.a)(Mg.DdaFacade,Ph.a(Gb.$)).oXg();var hc=new ie.a(te.a.Dk,5,null);
Md.a(Gb.$).Zs(hc);return Promise.resolve(null)});break;case 9:S=S.then(function(){return Gb.boj(Ma)});break;case 10:S=S.then(function(){return Gb.fXj(Ma)});break;case 11:S=S.then(function(){return Gb.eXj()});break;case 12:S=S.then(function(){return Gb.bXj()});break;case 13:S=S.then(function(){return Gb.cXj(Ma)});break;case 14:S=S.then(function(){return Gb.dXj(Ma)});break;case 16:S=S.then(function(){return Promise.resolve(Ma)});break;case 17:S=S.then(function(){return Gb.okj(Ma,Object(rg.a)(Mg.DdaFacade,
Ph.a(Gb.$)))});break;case 18:Ng.g(this.$).focus();break;case 19:this.Q3e(Ma.entryType,!1,Ma.options);break;case 20:this.Q3e(Ma.entryType,!0,Ma.options);break;default:S=S.then(function(){return Promise.reject(c.W2a(D.bJg,gg.a.instance.ga(1741),null))})}return S};c.prototype.Y2h=function(S){var Ma=Object(rg.a)(Mg.DdaFacade,Ph.a(this.$)).Tm(S.controlId);if(Ma&&!(0===S.operationType^!Ma.rda)){Ng.g(this.$).xhc=!0;switch(S.operationType){case 0:var Gb=new pd.a(document.createElement("input"));Gb.text=S.range;
Ma.nai(Ng.g(this.$).hg.f9g(Gb,new $c.a(this.$)));Ma.rda.startEdit(!0);break;case 1:Ma.xOf();this.rangePicker=null;break;case 2:Ma.rda.fdg(S.range);break;case 3:Ma.rda.fdg(S.startingRange);Ma=S.expandSelection;Gb=S.getNextDataRegionCell;var hc=0;switch(S.keyboardDirectionValue){case 2:hc=38;S=Ma&&Gb?105288353:Ma?-31900117:Gb?542791952:137938150;break;case 3:hc=40;S=Ma&&Gb?-1297307319:Ma?-1603798598:Gb?1713663844:-798660877;break;case 0:hc=37;S=Ma&&Gb?-403586027:Ma?2039316657:Gb?-2012742350:-1470715894;
break;case 1:hc=39;S=Ma&&Gb?784916030:Ma?589730764:Gb?1324884057:-1231471547;break;default:S=1461300262}Ma=this.s4b("keydown",hc,Ma,Gb);Ng.g(this.$).ZIb(Ma,new Wh.a(S,1,0,8,null))}Ng.g(this.$).xhc=!1}};c.prototype.s4b=function(S,Ma,Gb,hc){var Yc=document.createEvent("KeyboardEvent");if(ki.a.cF)Yc.initKeyboardEvent(S,!1,!1,window.self,"A",0,hc,!1,Gb,!1);else{var ed="";Gb&&(ed+="Shift");hc&&(ed+=0<ed.length?" Control":"Control");Yc.initKeyboardEvent(S,!1,!1,window.self,"A",0,ed,!1,"en-US")}S=new Sys.UI.DomEvent(Yc);
S.keyCode=Ma;return S};c.prototype.s1h=function(S){switch(S.operationType){case 1:$f.TaskExtensions.Aa(Lg.GetServiceTaskFactory.create(this.$.da,153,this.$.la,1),function(Ma){Ma.result.VJd()},this.$.la,3);break;case 2:if(S=Object(rg.a)(Mg.DdaFacade,Ph.a(this.$)).Tm(S.controlId))S.tod=!0,S.xIf()}};c.prototype.J$g=function(S){var Ma=this,Gb=S.fileBase64;return Gb&&Gb.length>this.$.ya.CreateWorkbookMaxAllowedBase64Size?Promise.reject(c.W2a(D.invalidArgument,gg.a.instance.ga(1744),"Application.CreateWorkbook")):
(new Promise(function(hc,Yc){var ed=new Ti.StandardDialog;ed.Rb=4;ed.ql(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_NewFileAPIConsentMessage,1,function(xd){2!==xd&&0!==xd||Yc(c.W2a(D.oBd,gg.a.instance.ga(1743),"Application.CreateWorkbook"));xd=new R("blank","agave",Gb?"streamBase64":"streamEmpty",Gb);Ma.Bqf.create(hc,Yc,xd).m0a()})})).then(function(hc){Ma.Y8b.set(S.fakeFileId,hc);return Promise.resolve(null)},function(hc){return hc?Promise.reject(hc):Promise.reject(c.W2a(D.generalException,
gg.a.instance.ga(1740),"Application.CreateWorkbook"))})};c.prototype.EUi=function(S){var Ma=this;return new Promise(function(Gb,hc){if(Ma.Y8b.has(S.fakeFileId)){var Yc=Ma.Y8b.get(S.fakeFileId);hc=new Ti.StandardDialog;hc.Rb=4;hc.ql(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_OpenWindowConsentMessage,1,function(ed){1===ed&&gi.HelperMethods.Ze(Yc,void 0,void 0,"DdaMethodHandler.fileUrl");Gb(null)})}else hc(c.W2a(D.generalException,gg.a.instance.ga(1740),"Document.Open"))})};c.prototype.boj=
function(S){var Ma=this;return new Promise(function(Gb){Object(rg.a)(Mg.DdaFacade,Ph.a(Ma.$)).gTf=S.runtimeCalculationMode;var hc=Ma.$.da.za(268);hc&&hc.pxd(3===S.runtimeCalculationMode);Gb(null)})};c.prototype.fXj=function(S){li.a.qAb(this.$)&&this.$.da.za(331).Ybb(0,S.urlStr,!0,!0,null);return Promise.resolve(null)};c.prototype.eXj=function(){li.a.qAb(this.$)&&this.$.da.za(331).Ybb(1,null,!0,!0,null);return Promise.resolve(null)};c.prototype.bXj=function(){li.a.qAb(this.$)&&this.$.da.za(331).SJe();
return Promise.resolve(null)};c.prototype.cXj=function(S){li.a.qAb(this.$)&&this.$.da.za(331).Ybb(5,S.urlStr,!0,!0,null);return Promise.resolve(null)};c.prototype.dXj=function(S){if(li.a.qAb(this.$)){var Ma=this.$.da.za(331);Ma=bk(Ma.kaa);for(var Gb=Ma.next();!Gb.done;Gb=Ma.next())Gb=Gb.value,Gb.IsActive&&Gb.HostEditUrl&&Gb.UrlStr===S.hostEditUrlStr&&gi.HelperMethods.Ze(Gb.HostEditUrl,"_blank")}return Promise.resolve(null)};c.prototype.okj=function(S,Ma){var Gb=Qj.a.GW;S=jg.a.Th(S.payload);var hc=
{};"eventId"in S&&"payload"in S&&(hc.eventId=S.eventId,hc.payload=S.payload);Ma.rM(2201,Gb,jg.a.xc(hc));return Promise.resolve(null)};c.prototype.Q3e=function(S,Ma,Gb){var hc=this.$.da.za(5);hc&&(S=this.RIh(S))&&(Ma?hc.removeEntry(S):hc.Ske(S,Gb))};c.prototype.RIh=function(S){switch(S){case 0:return 64}};c.prototype.ZSc=function(S){S=Object(rg.a)(id.a,this.$.va.getItemByName(S));(null===S||void 0===S?0:S.visible)&&S.activate(!0)};c.prototype.Rcg=function(S,Ma,Gb,hc){var Yc=S.sa.Vs,ed=Yc<Ma.length&&
Ma[Yc].contains(S.sa.activeCell);S=ed?S.sa.activeCell:Ma[0].topLeft;Yc=ed?Yc:0;Ng.g(this.$).aV(Ma,Yc,Gb,null,S,null,null,3,Xi.a.pbh,void 0,void 0,void 0,6===hc)};c.FYe=function(S){if(!S||!S.length)return null;for(var Ma=Array(S.length/2),Gb=0;Gb<S.length/2;Gb++)Ma[Gb]={},Ma[Gb].Name=S[2*Gb],Ma[Gb].Value=S[2*Gb+1];return Ma};c.zXh=function(S){if(!S||!S.length)return null;for(var Ma=Array(2*S.length),Gb=0;Gb<S.length;Gb++)Ma[2*Gb]=S[Gb].Name,Ma[2*Gb+1]=S[Gb].Value;return Ma};c.Y$c=function(S){if(!S||
!S.length)return null;for(var Ma=Array(S.length),Gb=0,hc=S.length;Gb<hc;Gb++){var Yc=S[Gb].length;if(Yc){Ma[Gb]=Array(Yc);for(var ed=0;ed<Yc;ed++)Ma[Gb][ed]=null==S[Gb][ed]?null:S[Gb][ed].toString()}else return null}return Ma};c.H2b=function(S){return"string"===typeof S?Kc.a.Tp(c.kbh,S,0):S};c.PRe=function(S){return"string"===typeof S?Kc.a.Tp(c.nbh,S,0):S};c.weg=function(S){return"string"===typeof S?Kc.a.Tp(c.rbh,S,0):S};c.Wfi=function(S){switch(S.DdaMethod.DispatchId){case 68:case 74:case 70:case 77:case 80:case 64:case 75:case 81:return!0}return!1};
c.XXc=function(S,Ma){var Gb={};Gb.CoerceType=S;1===Gb.CoerceType?(Gb.Data=c.Y$c(Ma.Rows),Gb.Headers=c.Y$c(Ma.Headers)):Gb.Data=c.Y$c(Ma);return Gb};c.xte=function(S){if(1===S.CoerceType){var Ma={};return Ma.Headers=S.Headers,Ma.Rows=S.Data,Ma}return S.Data};c.hfc=function(S){return 1===S.CoerceType?!S.Data&&!S.Headers:!S.Data};c.E0e=function(S){var Ma="Unknown";if(!S)return Ma;for(var Gb=0;Gb<S.length;Gb++)if(S[Gb].Name.toLowerCase()===sg.a.Chj){Ma=S[Gb].Value;break}return Ma};c.Zvj=function(S){if(!S)return!1;
for(var Ma=sg.a.JEi.toLowerCase(),Gb=0;Gb<S.length;Gb++)if(S[Gb].Name.toLowerCase()===Ma)return!0;return!1};c.W2a=function(S,Ma,Gb){var hc={};hc.Code=S;hc.Message=Ma;hc.Location=Gb;hc.ActionIndex=0;return hc};Mf.Object.defineProperties(c.prototype,{fQ:{configurable:!0,enumerable:!0,get:function(){return this.re}}});Mf.Object.defineProperties(c,{kbh:{configurable:!0,enumerable:!0,get:function(){c.xpa||(c.xpa={},c.xpa[Microsoft.Office.WebExtension.CoercionType.Table]=1,c.xpa[Microsoft.Office.WebExtension.CoercionType.Text]=
2,c.xpa[Microsoft.Office.WebExtension.CoercionType.Matrix]=3,c.xpa[Microsoft.Office.WebExtension.CoercionType.Html]=4,c.xpa[Microsoft.Office.WebExtension.CoercionType.Ooxml]=5);return c.xpa}},nbh:{configurable:!0,enumerable:!0,get:function(){c.phb||(c.phb={},c.phb[Microsoft.Office.WebExtension.FilterType.All]=1,c.phb[Microsoft.Office.WebExtension.FilterType.OnlyVisible]=2);return c.phb}},rbh:{configurable:!0,enumerable:!0,get:function(){c.qhb||(c.qhb={},c.qhb[Microsoft.Office.WebExtension.ValueFormat.Unformatted]=
2,c.qhb[Microsoft.Office.WebExtension.ValueFormat.Formatted]=1);return c.qhb}}});c.xpa=null;c.phb=null;c.qhb=null;c.lCd=0;Object(Id.a)(c,"DdaMethodHandler",null,[429,3]);var Df=Rh.a;Rk(a,Df);a.prototype.Ad=function(){var S=this,Ma=Lg.GetServiceTaskFactory.create(this.$.da,106,this.la,this.hb),Gb=Lg.GetServiceTaskFactory.create(this.$.da,165,this.la,this.hb),hc=Cb(this.la,this.hb);$f.TaskExtensions.Aa($f.TaskExtensions.Vd([Ma,Gb,hc],this.la),function(){var ed=Ma.result,xd=fh.a.instance.resolve("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory");
S.jd([new c(S.$,ed,xd)])},this.la,3);var Yc=fh.a.instance;$f.TaskExtensions.Aa(Lg.GetServiceTaskFactory.create(this.$.da,137,this.$.la,this.hb),function(){Yc.register(X,"Microsoft.Office.Excel.WebUI.Client.WebExtension.AuthenticationServiceFactory").tc().Cc(function(){return new X})},this.$.la)};a.ka=function(S){Rh.a.Qd(82,new a(S))};Object(Id.a)(a,"DdaCommandHandlerFactory",Rh.a,[]);Type.registerNamespace("Microsoft.AppRuntime");Type.registerNamespace("Microsoft.InternalService");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Agave");
Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.WebExtension");Type.registerNamespace("_Ewa");Me.a.ti("");Me.a.ti(".ewa-wx-disabled-div{position:absolute;height:100%;width:100%}.ewa-wx-container-div{position:relative}.ewa-ptp-nov2-flex .ewa-wx-container-div{flex:1}");Object(Ye.a)();Type.registerNamespace("Common.App.AppsForOfficeCommon");Object(sf.a)();(function(){qf.a.Fa(function(S){Jd.ka(S)})})();Type.registerNamespace("Common.App.AppsForOfficeCommon");Type.registerNamespace("Common.App.AppsForOfficeCommon");
Object(zj.a)();Object(aj.a)();Type.registerNamespace("CommandUI.AddInCommands");(function(){qf.a.Fa(function(S){ef.EwaSettings.ma(54)&&ha.ka(S)})})();(function(){qf.a.Fa(function(S){ef.EwaSettings.ma(122)&&ma.ka(S)})})();qf.a.Fa(ab.ka);qf.a.Fa(Wa.ka);Type.registerNamespace("Common.App.AppsForOfficeOauth");Type.registerNamespace("Common.App.SmartLookup");(function(){qf.a.Fa(function(S){V.ka(S);ra.ka(S);ba.ka(S)})})();qf.a.Fa(a.ka)},1666:function(u,E,b){function a(){this.SDc=null;this.CIc=0;this.gKc=
!1;this.$a=new e.a;this.Upg=new d.a}function c(){this.RIe=this.displayName=this.Fqb=this.to=this.qB=null;this.isUpgraded=!1}u=b(0);var d=b(202),e=b(97);c.prototype.rff=function(k,l){return this.qB.getStoreType().toLowerCase()===k.toLowerCase()&&this.qB.getSolutionId().toLowerCase()===l.toLowerCase()};Object(u.a)(c,"AddinCommandsResourceItem",null,[]);b.d(E,"a",function(){return a});a.prototype.kDg=function(k){this.$a.addHandler("AddinCommandsLoadingMessageChanged",k)};a.prototype.A$i=function(k){this.$a.removeHandler("AddinCommandsLoadingMessageChanged",
k)};a.prototype.zcb=function(k){k!==this.SDc&&(this.SDc=k,this.$a.raiseEvent("AddinCommandsLoadingMessageChanged"))};a.prototype.Xnj=function(){this.CIc++;this.yYa||this.zcb(CommonUIStrings.l_LoadingAddInsTitle)};a.prototype.zNd=function(){this.CIc--;this.Msd()&&(this.gKc?this.yYa!==CommonUIStrings.l_ErrorLoadingAddInsTitle&&this.zcb(CommonUIStrings.l_ErrorLoadingAddInsTitle):this.zcb(null))};a.prototype.kYf=function(k){this.gKc=!0;this.zcb((void 0===k?0:k)?CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg:
CommonUIStrings.l_ErrorLoadingAddInsTitle)};a.prototype.rxe=function(){this.gKc=!1;this.Msd()?this.zcb(null):this.zcb(CommonUIStrings.l_LoadingAddInsTitle)};a.prototype.Msd=function(){return 0>=this.CIc};a.prototype.Eia=function(k,l,n){n=void 0===n?0:n;for(var f=bk(this.m5a),v=f.next();!v.done;v=f.next())if(v=v.value,v.rff(k,l)&&(!v.to||v.to.nGh===n))return v;return null};a.prototype.Lke=function(k,l,n,f){var v=new c;v.qB=k;v.to=l;v.Fqb=n;v.displayName=f;this.m5a.add(v)};a.prototype.pBg=function(k,
l,n,f){var v=new c;v.qB=k;v.to=l;v.Fqb=null;v.RIe=n;v.displayName=f;this.m5a.add(v)};a.prototype.a9i=function(k,l){for(var n=0,f=bk(this.m5a),v=f.next();!v.done;v=f.next())v=v.value,v.qB.getStoreType()===k&&v.qB.getSolutionId()===l?this.m5a.removeAt(n):n++};a.getInstance=function(){a.Ma||(a.Ma=new a);return a.Ma};Mf.Object.defineProperties(a.prototype,{yYa:{configurable:!0,enumerable:!0,get:function(){return this.SDc}},m5a:{configurable:!0,enumerable:!0,get:function(){return this.Upg}}});a.Ma=null;
Object(u.a)(a,"AddinCommandsResourceManager",null,[])},944:function(u,E,b){function a(){}b.d(E,"a",function(){return a});u=b(0);var c=b(34);a.fUe=function(d){return c.a.Tp(a.Kzi,d.toString(),a.internalError)};Mf.Object.defineProperties(a,{Kzi:{configurable:!0,enumerable:!0,get:function(){var d={};return a.eae||(a.eae=(d["-2002156328"]=a.Xye,d["-1954750170"]=a.a1e,d["317650254"]=a.jZg,d["-1005263101"]=a.vci,d["1353664579"]=a.Flj,d["159671765"]=a.wci,d["1446690022"]=a.oXe,d["1150069548"]=a.DAc,d["-1409306331"]=
a.Sve,d["338507772"]=a.XEe,d["-457159301"]=a.vVi,d["-1037701970"]=a.Mah,d["-1893322318"]=a.Bci,d["965579896"]=a.Oah,d["93287890"]=a.Nah,d["358088857"]=a.Loj,d["-1223650923"]=a.XEe,d["2007306190"]=a.bVg,d["1549955423"]=a.Fse,d["-1275974171"]=a.Aci,d["382101082"]=a.HUi,d["-898776235"]=a.yBi,d["335464256"]=a.nBi,d["1677378049"]=a.zci,d["-261992848"]=a.gOj,d["-980820954"]=a.Fse,d["-931375837"]=a.GUi,d["929186550"]=a.wih,d["-982144310"]=a.q1i,d["-785741187"]=a.tci,d["2125217573"]=a.Dci,d["299124955"]=
a.uci,d["1669853884"]=a.Rhj,d["-1515932330"]=a.kZg,d["314621024"]=a.GCh,d["-300049690"]=a.fVg,d["14766835"]=a.Mtj,d["-1251992761"]=a.WHe,d["-2087635043"]=a.invalidOrTimedOutSession,d["2100961153"]=a.invalidOrTimedOutSession,d["-1218744139"]=a.invalidSheetName,d["-1468309555"]=5006,d["-315732528"]=a.invalidOrTimedOutSession,d["611268539"]=a.invalidOrTimedOutSession,d["1531005923"]=5006,d["1593924569"]=5006,d["299476328"]=a.nFa,d["49173765"]=a.nFa,d["-907155566"]=a.nFa,d["-1201603824"]=a.nFa,d["1541165282"]=
a.nFa,d["-1347753427"]=a.nFa,d["134912532"]=a.nFa,d["1780971550"]=a.responsePayloadSizeLimitExceeded,d))}}});a.success=0;a.Xye=1E3;a.a1e=1001;a.jZg=1002;a.vci=1003;a.Flj=1004;a.wci=1005;a.oXe=1008;a.DRe=1009;a.invalidSheetName=1014;a.DAc=2E3;a.Sve=2001;a.XEe=2002;a.vVi=2003;a.Mah=2004;a.Bci=2005;a.Oah=2007;a.Nah=2008;a.Loj=2009;a.bVg=2014;a.olj=3E3;a.Fse=3002;a.Aci=3004;a.HUi=3005;a.yBi=3006;a.nBi=3007;a.zci=3008;a.gOj=3009;a.GUi=3010;a.Mtj=4002;a.sBd=5E3;a.internalError=5001;a.WHe=5002;a.cyb=5004;
a.hPj=5007;a.h8h=5008;a.invalidOrTimedOutSession=5012;a.NCc=5016;a.nFa=5102;a.Lej=5103;a.responsePayloadSizeLimitExceeded=5104;a.xUg=7001;a.v4f=7002;a.wih=8E3;a.q1i=8001;a.tci=8010;a.Dci=8011;a.uci=8012;a.Rhj=8020;a.kZg=8021;a.GCh=8022;a.fVg=8023;a.qzi=11E3;a.oCi=11001;a.Cci=11002;a.eae=null;Object(u.a)(a,"DdaErrorIds",null,[])},945:function(u,E,b){function a(){}b.d(E,"a",function(){return a});u=b(0);a.generalException="GeneralException";a.invalidArgument="InvalidArgument";a.notImplemented="NotImplemented";
a.ASc="AccessDenied";a.notSupported="NotSupported";a.apiNotAvailable="ApiNotAvailable";a.notAllowed="NotAllowed";a.oBd="OperationCancelled";a.userNotSignedIn="UserNotSignedIn";a.userAborted="UserAborted";a.kPj="UnsupportedUserIdentity";a.invalidResourceUrl="InvalidResourceUrl";a.invalidGrant="InvalidGrant";a.hHg="AddinIsAlreadyRequestingToken";a.mgj="ResourceNotAllowed";a.clientError="ClientError";a.serverError="ServerError";a.d2g="ControlIdNotFound";a.bhj="RibbonApiNotAvailable";a.hostRestartNeeded=
"HostRestartNeeded";a.invalidRibbonDefinition="InvalidRibbonDefinition";a.sharedRuntimeNotAvailable="SharedRuntimeNotAvailable";Object(u.a)(a,"ErrorCodes",null,[])},947:function(u,E,b){function a(Fa,Qb){var cc=Tb.call(this)||this;cc.ea=null;cc.Lm=null;cc.Sh=null;cc.pf=[];cc.xIa=null;cc.BEe=!1;cc.dPb=!1;cc.initialized=!1;cc.disposed=!1;cc.OBa=null;cc.xoc=[];cc.wEe=[];cc.TOa=[];cc.N0a=null;cc.yCd=new Yb.a(kb.a.Ik());cc.JZb=new vb.a(kb.a.Ik());cc.LFb=[];cc.AFf=[];cc.N5b=350;cc.Mea=null;cc.cxa=null;cc.kSc=
!1;cc.cee=null;cc.$de=null;cc.dee=null;cc.bee=null;cc.fee=null;cc.Hug=null;cc.aee=null;cc.eee=null;cc.gee=null;cc.hee=null;cc.iee=null;cc.Qf=function(){cc.OBa=cc.ea.ho.WebExtensions;for(var bc=cc.pf.length-1;0<=bc;--bc){var Mc=cc.pf[bc],rd;if(rd=!cc.yAh(Mc.controlId))rd=Mc,rd=pa.EwaSettings.ma(122)?!rd.QHa:!0;rd&&(Mc.wmc(),Array.removeAt(cc.pf,bc))}if(cc.OBa)for(bc=0,Mc=cc.OBa.length;bc<Mc;bc++){rd=cc.OBa[bc];var Hd=cc.Tm(rd.WebExtensionId);Hd&&Hd.Uzd(rd)}};cc.vnc=function(bc){cc.raiseEvent("csc",
bc.getID())};cc.kzf=function(bc,Mc,rd){if(pa.EwaSettings.isChangeGateEnabled("OfficeVSO:4841553_AddinKeyboardShortcutsInTaskpane")&&Mc===OSF.AgaveHostAction.KeyboardShortcuts){var Hd=Object(Wa.a)(Object,rd);Mc={};Mc.keyCode=Hd.keyCode;Mc.type="keydown";Mc.ctrlKey=Hd.ctrlKey;Mc.shiftKey=Hd.shiftKey;Mc.altKey=Hd.altKey;Mc.metaKey=Hd.metaKey;bc=cc.Tm(bc);Hd=bc.Tga;Mc.srcElement=Object(qb.a)(528,Hd)?Hd.SFa:Qa.g(cc.$).ic;Mc=new Sys.UI.DomEvent(Mc);bc={focusedAddinId:a.Fua(bc.dl,cc.$)};Hd=new kc.a(1461300262,
1,cc.$.Jc,6,null);Qa.g(cc.$).ZIb(Mc,Hd,bc)}else if(Mc===OSF.AgaveHostAction.Select)cc.N3e(!0);else if(Mc===OSF.AgaveHostAction.UnSelect)cc.N3e(!1);else if(Mc===OSF.AgaveHostAction.CancelDialog)cc.SJ(-684355545,null);else if(Mc===OSF.AgaveHostAction.InsertAgave)bc={},rd&&(bc[Ha.a.Fra]=rd,bc[Z.a.Uf]=a.nrb(rd),cc.SJ(-741808261,bc));else if(Mc===OSF.AgaveHostAction.InsertDevManifest)bc={},rd&&(bc[Ha.a.Fra]=rd,bc[Z.a.Uf]=a.nrb(rd),cc.SJ(-741808261,bc));else if(Mc===OSF.AgaveHostAction.InsertDevManifestError)bc=
Object(Wa.a)(Object,rd),Mc={},bc=(Mc[Ha.a.VUc]=cc.Lm.getDevManifestInvalidUrlErrorString(bc.manifestUrl),Mc),cc.SJ(-2025863019,bc);else if(Mc===OSF.AgaveHostAction.NotifyHostError)bc={},bc=(bc[Ha.a.VUc]=cc.Lm.getManifestInvaildErrorString(),bc),cc.SJ(-2025863019,bc);else if(Mc===OSF.AgaveHostAction.RefreshAddinCommands)pa.EwaSettings.ma(54)&&cc.SJ(td.a.refreshAddinCommands,null);else if(Mc===OSF.AgaveHostAction.CtrlF6Exit||Mc===OSF.AgaveHostAction.CtrlF6ExitShift){if(Hd=cc.$.da.za(15)){(bc=cc.Tm(bc).Tga)&&
bc.hyc();Ka.a.Nf&&document.activeElement.blur();var ic={keyCode:117,type:"keydown",ctrlKey:!0};ic.shiftKey=Mc===OSF.AgaveHostAction.CtrlF6ExitShift;ic.srcElement=Object(qb.a)(528,bc)?bc.SFa:Qa.g(cc.$).ic;bc=new Sys.UI.DomEvent(ic);Hd.Rla(bc)}}else if(Mc===OSF.AgaveHostAction.PageIsReady){if((bc=cc.Tm(bc).Tga)&&bc.IYa===OSF.OsfControlTarget.TaskPane&&(bc=cc.$.da.za(183))&&cc.pf)for(Mc=Zb.a.ud(cc.$),Hd=bk(cc.pf),ic=Hd.next();!ic.done;ic=Hd.next())a.FLa(ic.value.gU)&&(Mc?bc.Sf(!0,!1):bc.setFocusOnToolbarFirstElement())}else if(Mc===
OSF.AgaveHostAction.TabExit){Mc=cc.Tm(bc);var Jc=Mc.Tga;if(Jc)if(Jc.IYa===OSF.OsfControlTarget.InContent)Jc.Rhf();else{if(Jc.IYa===OSF.OsfControlTarget.TaskPane)if(Zb.a.ud(cc.$))Ka.a.Nf&&document.activeElement.blur(),ob.UISurfaces.Mj().then(function(Pd){var De=Object(qb.a)(528,Jc)?Jc:null;De?De.isResizable?Pd.focusResizeHandle():Pd.focusTabbedTaskPaneArea():Pd.focusTabbedTaskPaneArea();return null});else if(bc=cc.$.da.za(183))Ka.a.Nf&&document.activeElement.blur(),(Mc=document.getElementById(cc.$.yb+
Cb.a.Glc))&&xb.DOMElementExtensions.isVisible(Mc)?xb.DOMElementExtensions.setFocus(Mc):bc.setFocusOnToolbarFirstElement()}else Mc&&4===Mc.osfControlType&&cc.Lm.notifyAgave(bc,OSF.AgaveHostAction.TabIn)}else if(Mc===OSF.AgaveHostAction.TabExitShift)(Mc=cc.Tm(bc),Hd=Mc.Tga)?Hd.IYa===OSF.OsfControlTarget.InContent?Hd.Shf():Hd.IYa===OSF.OsfControlTarget.TaskPane&&(bc=Object(qb.a)(528,Hd)?Hd:null)&&(Ka.a.Nf&&document.activeElement.blur(),bc.sYf()):Mc&&4===Mc.osfControlType&&cc.Lm.notifyAgave(bc,OSF.AgaveHostAction.TabIn);
else if(Mc===OSF.AgaveHostAction.EscExit||Mc===OSF.AgaveHostAction.ExitNoFocusable||Mc===OSF.AgaveHostAction.ExitNoFocusableShift)if(Hd=cc.Tm(bc).Tga)Hd.hyc();else{if(Mc===OSF.AgaveHostAction.EscExit){Mc=null;Hd=bk(M.w_h());for(ic=Hd.next();!ic.done;ic=Hd.next())if(ic=ic.value,ic.value.ye===bc){ic.value.dialog.hide();Mc=ic.key;break}Mc&&(bc=cc.Tm(Mc))&&4!==bc.osfControlType&&cc.Qh.notifyAgave(Mc,OSF.AgaveHostAction.TabIn)}}else if(Mc===OSF.AgaveHostAction.InstallCustomFunctions)if(pa.EwaSettings.ma(122)){bf.a(cc.$).DTe(function(){return!1});
var zd=cc.$.da;jb.TaskExtensions.Aa(Aa.GetServiceTaskFactory.Ra(zd,278,279,1),function(Pd){Pd=Pd.result;zd.za(278)||zd.Ga(278,Pd);var De=rd.osfControl.getStoreType();Pd.d$e(rd.osfControl.getSolutionId(),De,a.ALh(rd.osfControl),rd).Wma()},cc.la,3)}else ua.ULS.sendTraceTag(537170577,0,10,"DdaFacade.OnOsfNotifyHost: Cannot install Custom Functions because this feature is not enabled.");else if(Mc===OSF.AgaveHostAction.UninstallCustomFunctions)if(pa.EwaSettings.ma(122)){bf.a(cc.$).DTe(function(){return!1});
var sd=cc.$.da;jb.TaskExtensions.Aa(Aa.GetServiceTaskFactory.Ra(sd,278,279,1),function(Pd){Pd=Pd.result;sd.za(278)||sd.Ga(278,Pd);Pd.qag(rd.solutionId,rd.storeType).Wma()},cc.la,3)}else ua.ULS.sendTraceTag(537170574,0,10,"DdaFacade.OnOsfNotifyHost: Cannot uninstall Custom Functions because this feature is not enabled.");else Mc===OSF.AgaveHostAction.SendTelemetryEvent?d(rd):Mc===OSF.AgaveHostAction.SendCustomerContent?c(rd):Mc===OSF.AgaveHostAction.LaunchExtensionComponent?Xa.a.instance.yqi(rd):Mc===
OSF.AgaveHostAction.RefreshRibbonGallery?(bc=cc.$.da.za(352))&&bc.thd(rd):Mc===OSF.AgaveHostAction.RemoveAppCommandsAddin?(cc.c$i(rd.solutionId),Zb.a.ud(cc.$)||(bc=cc.$.da.za(183))&&bc.Kw(),pa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InstalledContentAddinsRibbonExperiment",!1)&&ra.AFrameworkApplication.ub.$d(td.a.JNf,2,rd.solutionId)):Mc===OSF.AgaveHostAction.GetOriginalControlId&&(bc=new sa.a(cc.$.yb,rd.ownerAddinSolutionId,new ab.a,!0),rd.originalControlId=bc?bc.OEe(rd.controlId):
rd.controlId)};cc.xmj=function(bc,Mc){var rd=Array(2);rd[0]=Mc;rd[1]=null;cc.Sh.HAh(bc,JSON.stringify(rd))};cc.ATi=function(){cc.$.pa&&Ie.o(cc.$.pa)&&cc.$.da.za(34).Dkd()};cc.Yc=function(){cc.Pjf()};cc.kR=function(bc,Mc){var rd,Hd;1===Mc.Cq&&(bc=Mc.Ef)&&(Mc=new k(Wd.toTimestamp(bc.enqueueUtcTime),Wd.toTimestamp(bc.processUtcTime),Wd.toTimestamp(bc.dequeueUtcTime),Wd.getElapsedMilliseconds(bc.enqueueUtcTime,bc.processUtcTime),Wd.getElapsedMilliseconds(bc.processUtcTime,bc.dequeueUtcTime),bc.operationCount,
(null===(Hd=null===(rd=bc.operation)||void 0===rd?void 0:rd.Wc)||void 0===Hd?0:Hd.ServerCorrelationId)?bc.operation.Wc.ServerCorrelationId:null,bc.operation?Enum.toString(Td.a,bc.operation.operationName):null,hb.a.dB(Wd.getElapsedMilliseconds(bc.enqueueUtcTime,ke.a.Ta.Jb))),rd=Sys.Serialization.JavaScriptSerializer.serialize(Mc),ua.ULS.sendTraceTag(50872916,0,50,rd))};cc.Uc=function(bc,Mc){!cc.ea.dc&&rf.a(Mc)?(Array.forEach(cc.pf,cc.Suf),Array.clear(cc.pf),cc.dPb=!1):(Mc.sH&&(ua.ULS.sendTraceTag(537170516,
0,50,"Silent Reload require reset osf controls."),cc.gSf()),cc.HK(),pa.EwaSettings.isChangeGateEnabled("OfficeVSO:4058224_ResetWorkbookContextLoadedAfterSilentReload")&&(cc.dPb=!1))};cc.qo=function(){pa.EwaSettings.isChangeGateEnabled("OfficeVSO:4441876_ResetOsfControlsAfterServerReload")&&(ua.ULS.sendTraceTag(537170515,0,50,"Load on demand occurred require reset osf controls."),cc.gSf());cc.HK();pa.EwaSettings.isChangeGateEnabled("OfficeVSO:4441876_ResetOsfControlsAfterServerReload")&&(cc.dPb=!1)};
cc.Suf=function(bc){bc.wmc();cc.raiseEvent("cd",bc.controlId)};cc.jb=Fa;cc.mVc=Qb;cc.initialize();U.ka(cc);cc.gTf=0;(Fa=(Fa=!(Ka.a.Wo||Ka.a.rka))&&(!pa.EwaSettings.isChangeGateEnabled("OfficeVSO:5763473_DisableAddinKeyboardShortcutsInFirefox")||!Ka.a.Nf))&&OfficeExt.ShortcutKeyDispatchManager.init();cc.Vpg={};return cc}function c(Fa){jc.a.sendOtelCustomerContent(Object.assign(new Wc.a,{otelEvent:Fa}))}function d(Fa){jc.a.sendOtelEvent(Object.assign(new Wc.a,{otelEvent:Fa}))}function e(Fa,Qb,cc){var bc=
Le.call(this,cc,Fa)||this;bc.hashCode=null;bc.rva=null;bc.x3b=!1;bc.Dm=function(Mc,rd){rd.Zc.hash===bc.hashCode&&bc.rva&&Object(Wa.a)(b(947).DdaFacade,bc.$.da.za(35)).mzj(bc.rva.InstanceId)};bc.ef=function(Mc,rd){switch(rd.Zc.block.state){case 1:case 3:case 5:bc.ona(rd)}};bc.xi=function(){bc.LGb(!0)};bc.mo=function(Mc,rd){bc.isVisible&&bc.iTa(rd.sF);bc.clearCache()};bc.oe=function(Mc,rd){bc.iSa(rd.pa,!!rd.sF)};bc.pN=function(){bc.$.ea.Zla()};bc.OTa=Qb;bc.domElement.classList.add(rb.a.v8b);bc.domElement.classList.add(Kd.a.Lo);
cc.tabIndex=0;bc.iSa(bc.$.pa,!1);bc.Ac.ka("mousedown",bc.pN);bc.Ac.ka("contextmenu",function(Mc){Se.g(Mc)});bc.$.va.iJ(bc.mo);bc.$.vb.iJ(bc.mo);bc.$.vb.If(bc.oe);bc.$.va.If(bc.oe);bc.Ea.Ds(bc.ef);bc.Ea.uG(bc.Dm);bc.Ea.hx(bc.xi);pa.EwaSettings.Zb()&&bc.yu(bc.fya);return bc}function k(Fa,Qb,cc,bc,Mc,rd,Hd,ic,Jc){this.dequeueUtcTime=this.processUtcTime=this.enqueueUtcTime=null;this.operationCount=this.executionDurationInMS=this.inQueueDurationInMS=0;this.UserOperationName=this.ServerCorrelationId=null;
this.IsDocumentHidden=!1;this.enqueueUtcTime=Fa;this.processUtcTime=Qb;this.dequeueUtcTime=cc;this.inQueueDurationInMS=bc;this.executionDurationInMS=Mc;this.operationCount=rd;this.ServerCorrelationId=Hd;this.UserOperationName=ic;this.IsDocumentHidden=Jc}function l(Fa,Qb,cc){this.$=Fa;this.Ri=Qb;this.runtimeCalculationMode=cc}function n(){}function f(Fa,Qb,cc){var bc=this;this.iEf=null;this.J$c=function(Mc,rd){var Hd=Fc.a.GW,ic={};ic.eventId=Mc;ic.payload=rd;bc.Ri.RZ(2201,Hd)&&bc.Sh.rM(2201,Hd,Rc.a.xc(ic))};
this.$=Fa;this.Ri=Qb;this.Sh=cc;this.P$h()}function v(Fa,Qb,cc){var bc=this;this.vHb=0;this.Xfg=!0;this.W9b=0;this.hpd=!0;this.Wwe=function(){var Mc=document.hasFocus();if(bc.Xfg!==Mc){if(Mc){var rd=Rc.a.xc({});bc.Sh.rM(2203,Fc.a.GW,rd)}bc.Xfg=Mc}};this.Xwe=function(Mc){(0<Mc.timeRemaining()||Mc.didTimeout)&&bc.Wwe();window.requestIdleCallback(bc.Xwe)};this.$=Fa;this.Ri=Qb;this.Sh=cc;window.requestIdleCallback||(this.hpd=!1)}function r(Fa,Qb,cc){var bc=this;this.uHb=0;this.D$a=this.J$a=null;this.mDf=
function(){var Mc=Qa.g(bc.$).ha.Oa.nC;if(Mc)if(bc.chf(Mc)){var rd=bc.hja();bc.L$c(rd);bc.J$a=Mc.floatingObject.id;bc.D$a=rd}else bc.J$a&&(bc.L$c(bc.D$a),bc.J$a=null,bc.D$a=null);else bc.J$a&&(bc.L$c(bc.D$a),bc.J$a=null,bc.D$a=null)};this.$=Fa;this.Ri=Qb;this.Sh=cc}function y(Fa,Qb,cc){var bc=this;this.u2b=null;this.lqd=!1;this.onPointerDown=function(Mc){if(3===Mc.lb){var rd=bc.gridView.W$b(Mc.clientPoint).z_a;bc.lqd=!!rd&&bc.gridView.ha.sa.XHe(rd)}else bc.lqd=!1;bc.u2b=Mc.clientPoint;return!1};this.$c=
function(Mc){if(bc.gridView.inRangePicker||bc.gridView.ui||bc.lqd||Mc.shiftKey||Mc.ctrlKey||Mc.Ca.button!==Sys.UI.MouseButton.leftButton||!bc.u2b||!Mc.clientPoint||Mc.clientPoint.x!==bc.u2b.x||Mc.clientPoint.y!==bc.u2b.y)return!1;var rd=bc.gridView.W$b(Mc.clientPoint);Mc=rd.z_a;rd=rd.returnValue;var Hd=Object(Wa.a)(Pb.a,bc.$.va.pa);if(rd&&Hd&&0===Hd.LF){if(!bc.gridView.ha.sa.W3.contains(Mc))return!1;Mc=new m(Hd,Mc,Va.HelperMethods.HCd(rd.x),Va.HelperMethods.HCd(rd.y));bc.UTi(Mc)}return!1};this.$=
Fa;this.gridView=Qa.g(Fa);this.Ri=Qb;this.Sh=cc;this.y8i()}function m(Fa,Qb,cc,bc){var Mc=gd.call(this)||this;Mc.sheet=Fa;Mc.ZUg=Qb;Mc.offsetX=cc;Mc.offsetY=bc;return Mc}function w(Fa,Qb,cc){var bc=this;this.tNf=this.sNf=this.uNf=this.rNf=0;this.QTi=function(Mc,rd){Mc=Object(Wa.a)(Pb.a,rd.pa);bc.Z6a(Mc)&&(rd={},rd.worksheetId=Mc.sheetId,rd=Rc.a.xc(rd),bc.Hia(11,Mc.sheetId,rd))};this.TTi=function(Mc,rd){Mc=Object(Wa.a)(Pb.a,rd.sF);bc.Z6a(Mc)&&(rd={},rd.worksheetId=Mc.sheetId,rd=Rc.a.xc(rd),bc.Hia(12,
Mc.sheetId,rd))};this.RTi=function(Mc,rd){Mc=Object(Wa.a)(Pb.a,rd.pa);bc.Z6a(Mc)&&(rd={},rd.worksheetId=Mc.sheetId,Mc=Rc.a.xc(rd),bc.Hia(11,null,Mc,!0))};this.STi=function(Mc,rd){Mc=Object(Wa.a)(Pb.a,rd.sF);bc.Z6a(Mc)&&(rd={},rd.worksheetId=Mc.sheetId,Mc=Rc.a.xc(rd),bc.Hia(12,null,Mc,!0))};this.$=Fa;this.Ri=Qb;this.Sh=cc}function B(Fa,Qb,cc){var bc=this;this.KPa=this.JPa=0;this.xGa=this.oha=null;this.awf=function(){var Mc=Qa.g(bc.$).ha.Oa.nC;if(0<bc.KPa&&bc.oha&&bc.xGa){var rd={};rd.shapeId=bc.oha;
rd.worksheetId=bc.xGa;rd=Rc.a.xc(rd);bc.fireEvent(2102,bc.oha,rd)}bc.Yli(Mc)?(bc.oha=bc.DMj(Mc),bc.xGa=bc.hja(),bc.oha&&bc.xGa)?0<bc.JPa&&(Mc={},Mc.shapeId=bc.oha,Mc.worksheetId=bc.xGa,Mc=Rc.a.xc(Mc),bc.fireEvent(2101,bc.oha,Mc)):ua.ULS.sendTraceTag(537170458,344,10,"Something goes wrong, we got invalid shape id: '{0}', or worksheet id: '{1}' from a Floating object or gridview.",bc.oha,bc.xGa):(bc.oha=null,bc.xGa=null)};this.$=Fa;this.Ri=Qb;this.Sh=cc}function A(Fa,Qb,cc){Fa=z.call(this,Fa,Qb,cc)||
this;Fa.mif=null;Fa.lif=null;return Fa}function z(Fa,Qb,cc){var bc=pc.call(this)||this;bc.wza=0;bc.vU=0;bc.Rc=function(Mc,rd){if(bc.enabled&&!(bc.fdf()||null!==rd&&void 0!==rd&&rd.Bgf)&&(Mc=Object(Wa.a)(Pb.a,bc.$.va.pa))&&0===Mc.LF){var Hd=Mc.sheetId,ic=bc.gXe(),Jc=null,zd=null;bc.Ri.qgf()&&(Jc=bc.grid.Ab.dk(bc.grid.ha.sa.activeCell),zd=Hd in bc.Iic?bc.Iic[Hd]:null);bc.Nqe(Hd,ic)&&jb.TaskExtensions.Aa(nb.Task.Ua(!0),function(){bc.U3h(Hd,ic);bc.G3h(Hd,ic,Jc,zd)},bc.la);bc.RHe(Hd,ic,Jc)}};bc.$=Fa;bc.Ri=
Qb;bc.Sh=cc;bc.grid=Qa.g(Fa);bc.QMa={};bc.Iic={};return bc}function x(Fa,Qb,cc){var bc=this;this.qNf=this.pNf=0;this.XKb=this.M$a=null;this.FGi=function(){var Mc=Qa.g(bc.$).ha.Oa.nC;if(bc.dmd(Mc)&&(Mc=bc.Z$b(Mc))){var rd={chartId:Mc};rd.worksheetId=bc.hja();rd=Rc.a.xc(rd);bc.Hia(51,Mc,rd);bc.Hia(51,bc.hja(),rd)}};this.GGi=function(){if(bc.M$a){var Mc={};Mc.chartId=bc.M$a;Mc.worksheetId=bc.XKb;Mc=Rc.a.xc(Mc);bc.Hia(52,bc.M$a,Mc);bc.Hia(52,bc.XKb,Mc)}Mc=Qa.g(bc.$).ha.Oa.nC;bc.dmd(Mc)?(bc.M$a=bc.Z$b(Mc),
bc.XKb=bc.hja()):(bc.M$a=null,bc.XKb=null)};this.$=Fa;this.Ri=Qb;this.Sh=cc}function D(){this.BYa={}}function I(Fa,Qb,cc,bc){bc=void 0===bc?!1:bc;var Mc=Ac.call(this)||this;Mc.acb=0;Mc.tE=null;Mc.Nva=!1;Mc.Zpc=null;Mc.vU=0;Mc.X0d=null;Mc.xGc=null;Mc.YUa=null;Mc.s5b=null;Mc.C8d=!1;Mc.xZd=null;Mc.rda=null;Mc.zNc=null;Mc.Rc=function(){Mc.enabled&&(Mc.wmj(),Mc.Zpc=Mb.d(Qa.g(Mc.$).ha.sa.selectedRanges))};Mc.Z3e=function(rd){rd.controlId===Mc.Jd.InstanceId&&Array.forEach(Mc.tE,function(Hd){Hd.myi(rd)&&
Hd.j1b(rd)})};Mc.Jsf=function(rd){if((rd=Object(Wa.a)(528,rd))&&!rd.Nr())if(!Mc.Jd||OSF.OsfControl.isFirstPartyStoreString(Mc.Jd.PrimaryMarketplace.MarketplaceType)||Mc.$.Rga){rd.vf=Mc.Jd;rd.ij=Mc.Eg;Mc.xZd=rd;Mc.Ivc(rd.SFa);var Hd=pa.EwaSettings.isChangeGateEnabled("OfficeVSO:5947100_createHiddenTaskpanePreload")&&Zb.a.ud(Mc.$)&&Va.HelperMethods.fw(Mc.Jd)&&Mc.Jd.Preload&&!Mc.Jd.TaskpaneVisible;Hd?rd.Izd():pa.EwaSettings.isChangeGateEnabled("OfficeVSO:5550690_FixHiddenStartupStateUnderReactPaneInfra")?
(rd.Izd(),(Mc.Jd.SharedRuntime&&1===Mc.Jd.SharedRuntime.LifeTime||Mc.Jd.SharedRuntimeId)&&!Mc.Jd.TaskpaneVisible&&rd.Zf(!1)):((Mc.Jd.SharedRuntime&&1===Mc.Jd.SharedRuntime.LifeTime||Mc.Jd.SharedRuntimeId)&&!Mc.Jd.TaskpaneVisible&&rd.Zf(!1),rd.Izd());Mc.v5a||(Zb.a.ud(Mc.$)?Hd||rd.u6():Za.a(Mc.$).result.GF(rd,!0));Mc.$.da.za(77).POf(Mc.Jsf);Mc.Tga=Object(Wa.a)(514,rd)}else ua.ULS.sendTraceTag(537170464,0,50,"Taskpane web add-in disabled by doc IRM")};Mc.onFloatingObjectControlAdded=function(rd,Hd){3===
Hd.control.floatingObject.type&&Hd.control.floatingObject.dl.InstanceId===Mc.Z0.WebExtensionId&&(Mc.Tga=Object(Wa.a)(514,Hd.control),Mc.Ivc(Hd.control.Dd.firstChild),tb.a(Mc.$).csc(Mc.onFloatingObjectControlAdded))};Mc.jb=Fa.$;Mc.Eg=Fa;Mc.Jd=cc;Mc.Jd.InstanceId=cc.SrcLocationOverrideResourceId?Fa.V2a(cc.InstanceId,cc.SrcLocationOverrideResourceId):cc.InstanceId;Mc.Sh=Qb;Mc.Z0={};Mc.Z0.WebExtensionId=cc.InstanceId;Mc.hEf="osfControl_"+cc.InstanceId;Mc.C5c="disabled_"+cc.InstanceId;Mc.Z0.BindingData=
cc.BindingData;Mc.v5a=Mc.Eg.v5a(cc.InstanceId);Mc.afc=Mc.Eg.afc(cc.InstanceId);Mc.Sbe=cc.WebExtensionOsfControlType;Mc.tHf=bc;return Mc}function F(){}function G(Fa,Qb,cc,bc,Mc,rd,Hd,ic){Fa=Kb.call(this,Fa,Qb,cc)||this;Fa.startRow=0;Fa.startColumn=0;Fa.rowCount=0;Fa.columnCount=0;Fa.startColumn=rd-bc.Reference.FirstColumn;Fa.columnCount=ic;rd=Math.max(Mc,bc.Reference.FirstRow);Mc=Math.min(Mc+Hd-1,bc.Reference.LastRow);rd>Mc?Fa.startRow=Fa.rowCount=void 0:(Fa.startRow=rd-bc.Reference.FirstRow,Fa.rowCount=
Mc-rd+1);return Fa}function T(Fa){var Qb=this;this.tE=null;this.Nva=!1;this.Rc=function(){Qb.tE.forEach(function(cc){cc.eventId===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent&&cc.j1b(new eb.a(cc.eventId,"",null))})};this.Eg=Fa}function O(Fa,Qb){this.QA=null;this.dfa=Fa;this.Lwg=Qb}function U(Fa){var Qb=this;this.Qh=this.WVc=null;this.WNi=function(cc,bc){Qb.handlers.kb(bc.controlId)&&(cc=new H(OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent,bc.controlId,null,bc.messageType,bc.messageContent,
bc.messageOrigin,bc.targetOrigin),Qb.handlers.na(bc.controlId)(cc),bc.messageType===OSF.DialogMessageType.DialogClosed&&Qb.handlers.remove(bc.controlId))};this.VNi=function(cc,bc){Qb.Lkc.kb(bc.controlId)&&(cc=new J(OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent,bc.controlId,null,bc.messageType,bc.messageContent,bc.messageOrigin,bc.targetOrigin),Qb.Lkc.na(bc.controlId)(cc))};this.handlers=new ta.a;this.Lkc=new ta.a;this.Eg=Fa;this.$0a.EFg(this.WNi);this.$0a.DFg(this.VNi)}function J(Fa,
Qb,cc,bc,Mc,rd,Hd){Fa=Ua.call(this,Fa,Qb,cc)||this;Fa.messageType=0;Fa.messageContent=null;Fa.messageOrigin=null;Fa.targetOrigin=null;Fa.messageType=bc;Fa.messageContent=Mc;Fa.messageOrigin=rd;Fa.targetOrigin=Hd;return Fa}function H(Fa,Qb,cc,bc,Mc,rd,Hd){Fa=cb.call(this,Fa,Qb,cc)||this;Fa.messageType=0;Fa.messageContent=null;Fa.messageOrigin=null;Fa.targetOrigin=null;Fa.messageType=bc;Fa.messageContent=Mc;Fa.messageOrigin=rd;Fa.targetOrigin=Hd;return Fa}function K(Fa,Qb){var cc=Na.call(this)||this;
cc.requests=[];cc.E1b=!1;cc.disposed=!1;cc.Af=function(){if(!cc.disposed){cc.grid.Wb.Nl(cc.Af);cc.E1b=!1;var bc=cc.requests;cc.requests=[];bc=bk(bc);for(var Mc=bc.next();!Mc.done;Mc=bc.next())Mc=Mc.value,cc.ddaFacade.SJ(Mc.command,Mc.properties)}};cc.ddaFacade=Fa;cc.grid=Qb;return cc}function N(){this.command=0;this.properties=null}function M(Fa){this.$a=new ba.a;this.Lm=Fa}function C(Fa,Qb,cc,bc,Mc){cc=void 0===cc?null:cc;bc=void 0===bc?"":bc;Mc=void 0===Mc?"":Mc;var rd=da.call(this)||this;rd.controlId=
Fa;rd.messageType=Qb;rd.messageContent=cc;rd.messageOrigin=bc;rd.targetOrigin=Mc;return rd}function Q(Fa,Qb,cc,bc,Mc){cc=void 0===cc?null:cc;bc=void 0===bc?"":bc;Mc=void 0===Mc?"":Mc;var rd=xa.call(this)||this;rd.controlId=Fa;rd.messageType=Qb;rd.messageContent=cc;rd.messageOrigin=bc;rd.targetOrigin=Mc;return rd}function P(){this.height=this.width=0;this.ye=this.controlId=this.pageUrl=null;this.Fdc=this.L5c=!1}function ka(){}function R(){this.dialog=this.ye=null}function fa(Fa,Qb,cc){var bc=Ga.call(this)||
this;bc.q9=null;bc.CRc="WACDialogTitleText";bc.NUa="0";bc.iRb="15px";bc.cmg="0px";bc.MUa="calc(100% - 30px)";bc.bmg="100%";bc.Ede=0;bc.$a=new ba.a;bc.Fjg=new ea;bc.Rb=5;bc.OCa=cc;bc.ye=cc;bc.UGc=Fa;bc.S3d=Qb;bc.iHc=!!ra.AFrameworkApplication.fa&&ra.AFrameworkApplication.fa.qa("OfficeAddinEnableInsertDialogAccessibilityFix");return bc}function ca(){}function ea(){}function wa(Fa,Qb){Fa=X.call(this,1,Fa,Qb)||this;Fa.N$e=OfficeExt.CommandInvokeMode.ExclusiveForNew;return Fa}function X(Fa,Qb,cc){this._id=
Fa;this.Djg=Qb;this.Olg=cc;this.N$e=OfficeExt.CommandInvokeMode.Default}b.r(E);var ja=b(0),va=b(7),ua=b(14),Xa=b(1507),aa=b(84),ba=b(97);X.prototype.execute=function(Fa,Qb,cc){var bc=this;cc=cc||{};cc.commandMode=this.N$e;Qb.invokeAppCommand(this.gHg,this.NZg,cc,function(){Fa.gOi(bc.id)})};Mf.Object.defineProperties(X.prototype,{id:{configurable:!0,enumerable:!0,get:function(){return this._id}},gHg:{configurable:!0,enumerable:!0,get:function(){return this.Djg}},NZg:{configurable:!0,enumerable:!0,
get:function(){return this.Olg}}});Object(ja.a)(X,"AddinNativeActionBase",null,[254]);Rk(wa,X);Object(ja.a)(wa,"AddinTakeSnapshotAction",X,[]);ea.prototype.E3g=function(Fa){return new X(3,Fa,this.VGh().getNativeActionName(3))};ea.prototype.VGh=function(){return OfficeExt.AddinNativeActionRuntimeManager.getInstance()};Object(ja.a)(ea,"AddinNativeActionManager",null,[248]);var oa=b(150);ca.prototype.invokeAppCommand=function(Fa,Qb,cc,bc){OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(Fa,Qb,
cc,bc)};ca.getInstance=function(){ca.Ma||(ca.Ma=new ca);return ca.Ma};ca.Ma=null;Object(ja.a)(ca,"OSFAddinCommandsRuntimeManager",null,[247]);var ra=b(4),db=b(183),Ka=b(27),Ga=oa.a;Rk(fa,Ga);fa.prototype.wFg=function(Fa){this.$a.addHandler("OnDialogClosedEventKey",Fa)};fa.prototype.Gqj=function(){this.XDa=null};fa.prototype.$C=function(){Ga.prototype.$C.call(this);this.np.style.width="100%";this.np.style.height=this.idc?this.MUa:this.bmg;this.np.style.marginTop=this.idc?this.iRb:this.cmg;this.np.style.padding=
this.NUa};fa.prototype.fO=function(){Ga.prototype.fO.call(this);this.Db.style.width=String.format("{0}px",this.UGc*window.innerWidth/100);this.Db.style.height=String.format("{0}px",this.S3d*window.innerHeight/100);this.Db.style.minWidth="0px";this.iHc&&ra.AFrameworkApplication.isRtl&&100===this.UGc&&(this.Db.style.right="0px",this.Db.style.marginRight="0px");this.q9=document.getElementById(this.$h(this.CRc));this.q9.style.position="absolute";this.q9.style.whiteSpace="nowrap";this.q9.style.textOverflow=
"ellipsis";ra.AFrameworkApplication.isRtl?(this.q9.style.right="14px",this.q9.style.left="44px"):(this.q9.style.right="44px",this.q9.style.left="14px")};fa.prototype.hv=function(Fa){Ga.prototype.hv.call(this,Fa);this.q9&&this.q9.setAttribute("title",Fa)};fa.prototype.aKd=function(){this.Db.style.width=String.format("{0}px",this.UGc*window.innerWidth/100);this.Db.style.height=String.format("{0}px",this.S3d*window.innerHeight/100);this.Db.style.overflowY="hidden";this.Db.style.overflowX="hidden";this.Db.style.marginTop=
"";this.Db.style.top="";Ka.a.X4&&ra.AFrameworkApplication.isRtl?(this.Db.style.right="",this.Db.style.marginRight=""):(this.Db.style.left="",this.Db.style.marginLeft="")};fa.prototype.hide=function(){var Fa=this;this.Fjg.E3g(this.OCa).execute(this,ca.getInstance(),{});this.Ede=window.setTimeout(function(){Fa.$a.raiseEvent("OnDialogClosedEventKey",Fa.OCa);db.a.prototype.hide.call(Fa)},500)};fa.prototype.gOi=function(Fa){3===Fa&&(window.clearTimeout(this.Ede),this.$a.raiseEvent("OnDialogClosedEventKey",
this.OCa),Ga.prototype.hide.call(this))};Mf.Object.defineProperties(fa.prototype,{Z0a:{configurable:!0,enumerable:!0,get:function(){return this.np}}});Object(ja.a)(fa,"AppsForOfficeDialog",oa.a,[229,230]);Object(ja.a)(R,"DialogInfo",null,[]);ka.url="url";ka.height="height";ka.width="width";ka.L5c="displayInIframe";ka.Fdc="hideTitle";Object(ja.a)(ka,"DialogSettings",null,[]);Object(ja.a)(P,"DisplayDialogParams",null,[]);var xa=Sys.EventArgs;Rk(Q,xa);Object(ja.a)(Q,"OnMessageDialogEventArgs",Sys.EventArgs,
[]);var da=Sys.EventArgs;Rk(C,da);Object(ja.a)(C,"OnMessageParentEventArgs",Sys.EventArgs,[]);var qa=b(41),na=b(29),ia=b(178),ta=b(100);M.prototype.EFg=function(Fa){this.$a.addHandler("OnMessageParentEventKey",Fa)};M.prototype.DFg=function(Fa){this.$a.addHandler("OnMessageDialogEventKey",Fa)};M.prototype.showDialog=function(Fa,Qb,cc,bc){if(M.h8.kb(Qb))ua.ULS.sendTraceTag(18896285,344,100,"ShowDialog: agave dialog map already has dialog info for this control."),cc(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);
else try{var Mc=qa.b(Fa),rd=Mc[ka.url];if(this.Lm.getOsfControl(Qb).checkAppDomains(rd)){var Hd=new P;Hd.width=Mc[ka.width];Hd.height=Mc[ka.height];Hd.pageUrl=rd;Hd.L5c=Mc[ka.L5c];Hd.Fdc=Mc[ka.Fdc];Hd.controlId=Qb;Hd.ye=ia.a.create().toString();var ic=new R;ic.ye=Hd.ye;var Jc=this.Lm.getOsfControl(Hd.controlId).getManifest().getDefaultDisplayName(),zd=this.Lm.getOsfControl(Hd.controlId).getStoreType().toLowerCase();Fa=null;var sd=ra.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.HideDialogTitleOption",
!1);Fa=(4===ra.AFrameworkApplication.ta.Qa.Cj&&"hardcodedpreinstall"===zd||sd&&"sdxcatalog"===zd)&&Hd.Fdc?this.createAndShowAppsForOfficeDialog(Hd.width,Hd.height,Hd.ye,!0,Jc):this.createAndShowAppsForOfficeDialog(Hd.width,Hd.height,Hd.ye,!1,Jc);var Pd=this.Lm.getOsfControl(Hd.controlId),De=Pd.getManifest();sd={};sd.id=Hd.ye;sd.solutionId=Pd.getSolutionId();sd.version=Pd.getVersion();sd.storeType=zd;sd.storeId=Pd.getStoreId();sd.assetId=Pd.getAssetId();sd.assetStoreId=Pd.getAssetStoreId();sd.ownerAddinSolutionId=
Pd.getOwnerAddinSolutionId();sd.ownerAddinStoreType=Pd.getOwnerAddinStoreType();sd.appDomains=De.getAppDomains();sd.dialogUrl=rd;sd.osfControlType=1;sd.agaveName=Jc;sd.div=Fa.Z0a;ua.ULS.sendTraceTag(542978531,344,50,"ShowDialog: asset id {0}, url hash code {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(sd.solutionId,sd.ownerAddinStoreType||sd.storeType,sd.assetId,null,null,sd.storeId),na.a.Kv(Hd.pageUrl));this.Lm.insertDialogControl(sd);Fa.wFg(Object(aa.a)(this,this.xIi,"onDialogClosed"));ic.dialog=
Fa;M.h8.ia(Hd.controlId,ic);bc&&bc(sd);cc(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}else ua.ULS.sendTraceTag(19940611,344,10,"ShowDialog: dialog url not in app domains list."),cc(OSF.DDA.ErrorCodeManager.errorCodes.ooeAppDomains)}catch(lc){ua.ULS.sendTraceTag(18371104,344,10,"ShowDialog: action failed. Exception message: {0}",lc.message),cc(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}};M.prototype.Nzi=function(Fa,Qb,cc,bc){ra.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MessageParentOriginLeaveTargetOrigin",
!1)||""===bc&&(bc=cc);try{var Mc=this.HJa(Fa);Mc&&this.$a.raiseEvent("OnMessageParentEventKey",new C(Mc,OSF.DialogMessageType.DialogMessageReceived,Qb,cc,bc))}catch(rd){return ua.ULS.sendTraceTag(555238219,344,10,"MessageParentOrigin: action failed. Exception message: {0}",rd.message),OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess};M.prototype.f0c=function(Fa,Qb){if(M.h8.kb(Fa))try{var cc=M.h8.na(Fa);cc.dialog&&cc.dialog.hide();this.Lm.purgeDialogControl(cc.ye);
M.h8.remove(Fa);Qb(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}catch(bc){ua.ULS.sendTraceTag(18371106,344,10,"CloseDialog: action failed. Exception message: {0}",bc.message),Qb(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}else ua.ULS.sendTraceTag(18896286,344,10,"CloseDialog: agave dialog map does not has dialog info for this control."),Qb(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)};M.prototype.mmj=function(Fa,Qb,cc,bc){ra.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SendMessageOriginLeaveTargetOrigin",
!1)||""===bc&&(bc=cc);if(M.h8.kb(Fa)&&(Fa=M.h8.na(Fa),Fa.dialog))try{this.$a.raiseEvent("OnMessageDialogEventKey",new Q(Fa.ye,OSF.DialogMessageType.DialogParentMessageReceived,Qb,cc,bc))}catch(Mc){ua.ULS.sendTraceTag(555045763,344,10,"SendMessageOrigin: action failed. Exception message: {0}",Mc.message)}};M.prototype.HJa=function(Fa){for(var Qb=null,cc=bk(M.h8),bc=cc.next();!bc.done;bc=cc.next())if(bc=bc.value,bc.value.ye===Fa){Qb=bc.key;break}return Qb};M.prototype.xIi=function(Fa,Qb){if(Fa=this.HJa(Qb))this.Lm.purgeDialogControl(Qb),
M.h8.remove(Fa),this.$a.raiseEvent("OnMessageParentEventKey",new C(Fa,OSF.DialogMessageType.DialogClosed,null,null,"*"))};M.prototype.createAndShowAppsForOfficeDialog=function(Fa,Qb,cc,bc,Mc){Fa=new fa(Fa,Qb,cc);Mc=bc?"":String.format(CommonUIStrings.l_ShowDialogApiInlineDialogTitle,Mc);bc&&(Fa.idc=!1,Fa.Pu=!1);Fa.initializeAndShow(Mc,null,null);Fa.Gqj();return Fa};M.w_h=function(){return M.h8};M.getInstance=function(Fa){M.Ma||(M.Ma=new M(Fa));return M.Ma};M.Ma=null;M.h8=new ta.a;Object(ja.a)(M,"AppsForOfficeDialogManager",
null,[199]);var za=b(1057),sa=b(1518),V=b(1596),Ia=b(1144),Ha=b(931),ob=b(204),ib=b(1519),La=b(120),zb=b(83),Fb=b(89),Yb=b(737),kb=b(616),vb=b(894),Wa=b(85),qb=b(440),yb=b(162),ec=b(202),Ob=b(38),Cb=b(5),ab=b(1072),ya=b(1437),ma=b(79);Object(ja.a)(N,"DdaRequestInfo",null,[]);var ha=b(944),Z=b(76),Na=ma.a;Rk(K,Na);K.prototype.wch=function(Fa,Qb){this.disposed||(this.E1b||(this.grid.Wb.tm(this.Af),this.E1b=!0),this.requests.push(Object(va.a)(new N,{command:Fa,properties:Qb})))};K.prototype.dispose=
function(){if(!this.disposed){this.disposed=!0;this.E1b&&this.grid.Wb.Nl(this.Af);var Fa=this.requests;this.requests=null;Fa=bk(Fa);for(var Qb=Fa.next();!Qb.done;Qb=Fa.next())Qb=Qb.value,(Qb=Qb.properties?Qb.properties[Z.a.n3]:null)&&this.ddaFacade.kf(ha.a.cyb,Qb);this.ddaFacade=this.grid=null;Na.prototype.dispose.call(this)}};K.QZg=function(Fa,Qb){var cc=!1;974713501===Fa&&(Qb=(Fa=Qb?Qb[Z.a.Uf]:null)?Fa.DdaMethod:null)&&Qb.DispatchId===OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod&&(cc=
Fa.ArrayData,cc=!!cc&&64===(cc[6]&64));return cc};Object(ja.a)(K,"DdaCellEditDelayRequestHandler",ma.a,[]);var eb=b(976),cb=eb.a;Rk(H,cb);Object(ja.a)(H,"DialogMessageReceivedEventArgs",eb.a,[]);var Ua=eb.a;Rk(J,Ua);Object(ja.a)(J,"DialogParentMessageReceivedEventArgs",eb.a,[]);var pa=b(1),Qa=b(21);U.prototype.addHandler=function(Fa,Qb,cc,bc){var Mc=this;if(pa.EwaSettings.ma(24))this.Eg.kf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,cc);else{ua.ULS.sendTraceTag(537170502,0,50,"DialogMessageReceivedEventManager.AddHandler called!");
var rd=function(Hd){Hd===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?(Mc.handlers.ia(Fa,Qb),Mc.Eg.Ku(cc)):(ua.ULS.sendTraceTag(537170501,0,10,"DialogMessageReceivedEventManager.AddHandler failed!"),Mc.Eg.kf(Hd,cc))};this.handlers.kb(Fa)?rd(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):this.showDialog(Fa,bc,rd)}};U.prototype.gBg=function(Fa,Qb,cc){pa.EwaSettings.ma(24)?this.Eg.kf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,cc):(ua.ULS.sendTraceTag(537170500,0,50,"DialogMessageReceivedEventManager.AddMessageChildHandler called!"),
this.Lkc.ia(Fa,Qb),this.Eg.Ku(cc))};U.prototype.removeHandler=function(Fa,Qb){var cc=this;pa.EwaSettings.ma(24)?this.Eg.kf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Qb):this.handlers.kb(Fa)?(ua.ULS.sendTraceTag(537170499,0,50,"DialogMessageReceivedEventManager.RemoveHandler called!"),this.$0a.f0c(Fa,function(bc){cc.handlers.remove(Fa);bc===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?cc.Eg.Ku(Qb):(ua.ULS.sendTraceTag(537170498,0,10,"DialogMessageReceivedEventManager.RemoveHandler failed!"),
cc.Eg.kf(bc,Qb))})):this.Eg.kf(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,Qb)};U.prototype.W9i=function(Fa,Qb){pa.EwaSettings.ma(24)?this.Eg.kf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Qb):(ua.ULS.sendTraceTag(537170497,0,50,"DialogMessageReceivedEventManager.RemoveHandler called!"),this.Lkc.remove(Fa),this.Eg.Ku(Qb))};U.prototype.showDialog=function(Fa,Qb,cc){var bc=this;try{pa.EwaSettings.isChangeGateEnabled("OfficeVSO:6254758_ExitCellEditModeDialogAPI")&&Qa.g(this.Eg.$).isEditing&&
Qa.g(this.Eg.$).wo(!0),this.$0a.showDialog(Qb,Fa,cc,function(Mc){bc.Eg.yBg(bc.DRg(Mc))})}catch(Mc){ua.ULS.sendTraceTag(537170496,0,10,"DialogMessageReceivedEventManager: show dialog failed. Exception message: {0}",Mc.message),cc(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}};U.prototype.DRg=function(Fa){var Qb={};Qb.InstanceId=Fa.id;Qb.WebExtensionType=Fa.osfControlType===OSF.OsfControlTarget.InContent?0:1;Qb.PrimaryMarketplace={};Qb.PrimaryMarketplace.SolutionId=Fa.solutionId;Qb.PrimaryMarketplace.SolutionVersion=
Fa.version;Qb.PrimaryMarketplace.MarketplaceRef=Fa.storeId;Qb.PrimaryMarketplace.MarketplaceType=Fa.storeType;return Qb};U.ka=function(Fa){if(!Fa.$.da.za(232)){var Qb=new U(Fa);Fa.$.da.Ga(232,Qb)}};Mf.Object.defineProperties(U.prototype,{$0a:{configurable:!0,enumerable:!0,get:function(){this.WVc||(this.WVc=M.getInstance(this.contextActivationMgr));return this.WVc}},contextActivationMgr:{configurable:!0,enumerable:!0,get:function(){!this.Qh&&this.Eg&&(this.Qh=this.Eg.Qh);return this.Qh}}});Object(ja.a)(U,
"DialogMessageReceivedEventManager",null,[881]);O.prototype.oZb=function(Fa){Fa&&(this.QA||(this.QA=[]),this.QA.push(Fa))};O.prototype.lsc=function(Fa){this.QA&&Array.remove(this.QA,Fa)};O.prototype.myi=function(Fa){return this.eventId!==Fa.dispid?!1:this.eventId===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||this.eventId===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent?this.targetId===Fa.ddaBinding.Name:!0};O.prototype.j1b=function(Fa){this.QA&&Array.forEach(this.QA,function(Qb){Qb(Fa)})};
O.prototype.Bma=function(){this.QA=[]};Mf.Object.defineProperties(O.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return this.dfa}},targetId:{configurable:!0,enumerable:!0,get:function(){return this.Lwg}},t4h:{configurable:!0,enumerable:!0,get:function(){return 0<this.QA.length}}});Object(ja.a)(O,"DdaEventRegistration",null,[]);T.prototype.invokeDdaMethod=function(Fa,Qb){var cc={};cc[Z.a.Uf]=Fa;cc[Z.a.n3]=Qb;this.Eg.SJ(974713501,cc)};T.prototype.registerDdaEventAsync=function(Fa,
Qb,cc,bc,Mc){T.Oyb(Fa)?(T.tmd(Fa)&&this.Zid(),this.tE||(this.tE=[]),Qb=this.Btb(Fa,cc),Qb||(Qb=new O(Fa,cc),this.tE.push(Qb)),Qb.oZb(bc),this.Eg.Ku(Mc)):this.Eg.kf(-1,Mc)};T.prototype.unregisterDdaEventAsync=function(Fa,Qb,cc,bc,Mc){T.Oyb(Fa)?((Fa=this.Btb(Fa,cc))&&Fa.lsc(bc),this.Eg.Ku(Mc)):this.Eg.kf(-1,Mc)};T.prototype.Zid=function(){this.Nva||(Qa.g(this.Eg.$).ha.UD(this.Rc),this.Nva=!0)};T.prototype.Btb=function(Fa,Qb){if(!this.tE)return null;for(var cc=0;cc<this.tE.length;cc++){var bc=this.tE[cc];
if(bc.eventId===Fa&&bc.targetId===Qb)return bc}return null};T.Oyb=function(Fa){return Fa===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent};T.tmd=function(Fa){return Fa===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent};Object(ja.a)(T,"EmbeddingPage",null,[857]);var Db=b(207),Kb=eb.a;Rk(G,Kb);G.prototype.getStartRow=function(){return this.startRow};G.prototype.getStartColumn=function(){return this.startColumn};G.prototype.getRowCount=function(){return this.rowCount};G.prototype.getColumnCount=
function(){return this.columnCount};Object(ja.a)(G,"DdaBindingSelectionEventArgs",eb.a,[]);var Ab=b(191),ub=b(24),Mb=b(45),Aa=b(51),Za=b(441),Zb=b(36),jb=b(37),Vb=b(629),Ic=b(110),Rb=b(53),kc=b(91),xb=b(12),Va=b(11),tb=b(105);F.Prh="ewa-wx-disabled-div";F.Orh="ewa-wx-container-div";F.SMe="ewa-ptp-nov2-flex";Object(ja.a)(F,"CssClassNames",null,[]);var fb=F.Prh,ac=F.Orh,Ac=Db.a;Rk(I,Ac);I.prototype.nai=function(Fa){this.rda||(this.rda=Fa)};I.prototype.xOf=function(){this.rda&&(this.rda.dispose(),this.rda=
null)};I.prototype.qkd=function(){var Fa=this;if(!OSF.OsfControl.isFirstPartyStoreString(this.Jd.PrimaryMarketplace.MarketplaceType)&&pa.EwaSettings.ma(187)){var Qb=Aa.GetServiceTaskFactory.Ra(this.$.da,5,4,0);jb.TaskExtensions.Aa(Qb,function(){Qb.result.Tf(35,null)},this.la,3);return this}if(1===this.Jd.WebExtensionType)jb.TaskExtensions.Aa(Za.a(this.$),function(Mc){Mc.result.Zqb(Fa.$.da,77,6,Fa.Jsf,1)},this.la,3);else{var cc=this.XRe(),bc=tb.a(this.$);cc||(cc={Type:3},cc.Id=this.Z0.WebExtensionId,
cc.WebExtensionData=this.Jd,cc.ContentHtml="<div/>",cc.Version=0,cc.AbsoluteLeft=0,cc.AbsoluteTop=0,cc.AbsoluteRight=0,cc.AbsoluteBottom=0,cc.Width=0,cc.Height=0,cc.ZOrder=0,cc.OriginDeltaX=0,cc.OriginDeltaY=0,cc=new Ab.a(cc),bc.b4b(cc,null),cc=bc.oq(cc.Gg()));cc?(this.Ivc(cc.Dd.firstChild),this.Tga=Object(Wa.a)(514,cc)):bc.fZb(this.onFloatingObjectControlAdded)}return this};I.prototype.a9e=function(Fa){this.Ivc(Fa);return this};I.prototype.wmc=function(){this.tHf||this.Eg.Qh.purgeOsfControl(this.controlId,
!1);this.nag(!0);var Fa=this.XRe();Fa&&tb.a(this.$).deleteFloatingObject(Fa);this.Eg.Ri.F9i(this.controlId);this.Eg.Ri.VJe(this.controlId,!0);this.zNc=null};I.prototype.Uzd=function(Fa){this.Z0=Fa};I.prototype.invokeDdaMethod=function(Fa,Qb){if(pa.EwaSettings.isChangeGateEnabled("OfficeVSO:3614837_disableDragCheck")||this.enabled){var cc={};cc[Z.a.Uf]=Fa;cc[Z.a.n3]=Qb;this.Eg.SJ(974713501,cc)}else this.Eg.kf(ha.a.cyb,Qb)};I.prototype.d7i=function(Fa,Qb,cc,bc){if(pa.EwaSettings.isChangeGateEnabled("OfficeVSO:3614837_disableDragCheck")||
this.enabled)if(!I.Wgh(Fa)||void 0!==Qb&&null!==Qb&&void 0!==this.p2a(Qb)&&null!==this.p2a(Qb))if(ua.ULS.sendTraceTag(36444195,0,50,"eventId: {0}, targetId: {1}",Fa,Qb),I.qbf(Fa)&&this.o6h(),I.tmd(Fa)&&this.Zid(),I.obf(Fa))pa.EwaSettings.ma(24)?this.Eg.kf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,bc):this.Eg.$.da.za(232).addHandler(this.controlId,cc,bc,Qb);else if(I.pbf(Fa))pa.EwaSettings.ma(24)?this.Eg.kf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,bc):this.Eg.$.da.za(232).gBg(this.controlId,
cc,bc);else{I.nbf(Fa)&&this.a4e(-1777565636,bc);this.tE||(this.tE=[]);var Mc=this.Btb(Fa,Qb);Mc||(Mc=new O(Fa,Qb),this.tE.push(Mc));Mc.Bma();Mc.oZb(cc);this.Eg.Ku(bc);Fa===OSF.DDA.EventDispId.dispidRichApiMessageEvent&&this.YUa&&(this.s5b=cc)}else this.Eg.kf(3002,bc);else this.Eg.kf(-1,bc)};I.prototype.sOj=function(Fa,Qb,cc,bc){I.obf(Fa)?pa.EwaSettings.ma(24)?this.Eg.kf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,bc):this.Eg.$.da.za(232).removeHandler(this.controlId,bc):I.pbf(Fa)?
pa.EwaSettings.ma(24)?this.Eg.kf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,bc):this.Eg.$.da.za(232).W9i(this.controlId,bc):(I.nbf(Fa)&&this.a4e(1592314317,bc),Qb=this.Btb(Fa,Qb),this.enabled?(Qb&&(Qb.lsc(cc),Qb.t4h||Array.remove(this.tE,Qb),this.tE.length?I.qbf(Fa)&&this.oag(!1):this.nag(!1)),this.Eg.Ku(bc)):this.Eg.kf(-1,bc))};I.prototype.ka=function(Fa){xb.DOMElementExtensions.getElementById(Fa,this.hEf)||Fa.appendChild(xb.DOMElementExtensions.ff(this.cy))};I.prototype.showHide=
function(Fa){xb.DOMElementExtensions.setVisible(this.cy,Fa)};I.prototype.resize=function(Fa,Qb){xb.DOMElementExtensions.rv(this.cy,Fa);xb.DOMElementExtensions.vI(this.cy,Qb)};I.prototype.SGe=function(Fa){if(!this.vU&&!xb.DOMElementExtensions.getElementById(this.cy,this.C5c)&&this.cy){var Qb=document.createElement("div");Qb.id=this.C5c;Qb.className=fb;Qb.style.backgroundImage="url("+Rb.a.current.Ro(102)+")";Qb.style.opacity=Fa?"1":"0";Qb.style.backgroundRepeat="no-repeat";Qb.style.backgroundPosition=
"center";this.cy.insertBefore(Qb,this.cy.firstChild)}this.vU++};I.prototype.Njh=function(){0<this.vU&&this.vU--;this.vU||(xb.DOMElementExtensions.ff(xb.DOMElementExtensions.getElementById(this.cy,this.C5c)),this.Nva&&!Mb.Q(this.Zpc,Qa.g(this.$).ha.sa.selectedRanges)&&this.Rc(null,null))};I.prototype.p2a=function(Fa){if(!this.Z0||!this.Z0.BindingData)return null;for(var Qb=0;Qb<this.Z0.BindingData.length;Qb++)if(this.Z0.BindingData[Qb].Name===Fa)return this.Z0.BindingData[Qb];return null};I.prototype.getDefaultIconUrl=
function(){var Fa=this.D_e();return Fa?Fa.getDefaultIconUrl():null};I.prototype.getDefaultDisplayName=function(){if(this.Jd.TaskpaneTitle)return this.Jd.TaskpaneTitle;var Fa=this.D_e();return Fa?Fa.getDefaultDisplayName():null};I.prototype.xIf=function(){if(this.YUa&&this.s5b){var Fa=new eb.a(OSF.DDA.EventDispId.dispidRichApiMessageEvent,this.controlId,null,this.YUa);this.s5b(Fa);this.s5b=this.YUa=null}};I.prototype.Zf=function(Fa){this.xZd&&this.xZd.Zf(Fa)};I.prototype.yoj=function(){var Fa=this;
this.$.ea.isNamedObjectViewMode&&this.mki()&&(this.$.da.za(34).xoj(this.cy),this.showHide(!1));if(this.Eg.qWj){if(!this.tHf){var Qb={};Qb.div=this.cy;Qb.id=this.Jd.InstanceId;Qb.solutionId=this.Jd.PrimaryMarketplace.SolutionId;Qb.version=this.Jd.PrimaryMarketplace.SolutionVersion;Qb.storeId=this.Jd.PrimaryMarketplace.MarketplaceRef;Qb.storeType=this.Jd.PrimaryMarketplace.MarketplaceType;Qb.ownerAddinSolutionId=this.Jd.OwnerAddinSolutionId;Qb.ownerAddinStoreType=this.Jd.OwnerAddinStoreType;this.Jd.AssetMarketplace&&
(Qb.assetId=this.Jd.AssetMarketplace.SolutionId,Qb.assetStoreId=this.Jd.AssetMarketplace.MarketplaceRef);Qb.settings=this.Jd.OsfPropertyBag;pa.EwaSettings.isChangeGateEnabled("OfficeVSO:5022710_EnableAgaveInitReasonControlActivation")?Qb.reason=this.v5a?Microsoft.Office.WebExtension.InitializationReason.DocumentOpened:this.afc?Microsoft.Office.WebExtension.InitializationReason.Inserted:Microsoft.Office.WebExtension.InitializationReason.ControlActivation:Qb.reason=this.v5a?Microsoft.Office.WebExtension.InitializationReason.DocumentOpened:
Microsoft.Office.WebExtension.InitializationReason.Inserted;Qb.osfControlType=0===this.Jd.WebExtensionType?OSF.OsfControlTarget.InContent:OSF.OsfControlTarget.TaskPane;Qb.isForUILessAction=4===this.Jd.WebExtensionOsfControlType;Qb.sourceLocationOverrideResourceId=this.Jd.SrcLocationOverrideResourceId;Qb.focusOnIframeWhenLoaded=this.Jd.FocusOnIframeWhenLoaded;Vb.a(this.Jd)&&(Qb.featureGates=ra.AFrameworkApplication.fa.XNh(Qb.solutionId));Qb.hostInfoFlags=0;this.QHa&&(Qb.hostInfoFlags|=2);Va.HelperMethods.fw(this.Jd)&&
(Qb.hostInfoFlags|=1);this.$.Rga||(ua.ULS.sendTraceTag(537170466,0,50,"Content web add-in disabled by doc IRM"),Qb.hostInfoFlags|=4);pa.EwaSettings.ma(639)&&(Qb.hostInfoFlags|=8);pa.EwaSettings.ma(54)&&pa.EwaSettings.ma(94)&&!this.xGc&&(Qb.virtualOsfControlActivationCallback=function(){Fa.Eg.VAd(Fa.Jd)});Qb.sharedRuntimeId=this.Jd.SharedRuntime?this.Jd.SharedRuntime.Resid:this.Jd.SharedRuntimeId;!Va.HelperMethods.fw(this.Jd)||this.Jd.Preload||Vb.a(this.Jd)||this.Eg.Qh.getOsfControl(b(947).DdaFacade.getSolutionId(this.Jd,
this.$))||(pa.EwaSettings.isChangeGateEnabled("OfficeVSO:5707326_FixBackgroundAppCrashInViewMode")?this.$.isEditMode&&this.Eg.VAd(this.Jd):this.Eg.VAd(this.Jd));Qb.initialDisplayMode=this.Jd.TaskpaneVisible?2:1;pa.EwaSettings.isChangeGateEnabled("OfficeVSO:5793296_SDXIframeTitleOverride")&&(Qb.titleOverride=this.dl.TaskpaneTitle);this.Eg.Qh.insertOsfControl(Qb)}this.vU=0}else this.SGe(!0)};I.prototype.nag=function(Fa){this.oag(Fa);this.$Nj()};I.prototype.o6h=function(){this.acb||this.Sh.oZb(this.Z3e);
this.acb++};I.prototype.oag=function(Fa){0<this.acb&&(Fa?this.acb=0:this.acb--,this.acb||this.Sh.lsc(this.Z3e))};I.prototype.Zid=function(){if(!this.Nva){var Fa=Qa.g(this.$).ha;this.Zpc=Mb.d(Qa.g(this.$).ha.sa.selectedRanges);Fa.UD(this.Rc);this.Nva=!0}};I.prototype.$Nj=function(){this.Nva&&(Qa.g(this.$).ha.ZH(this.Rc),this.Nva=!1)};I.prototype.plj=function(Fa){var Qb=new ub.Range(Fa.Reference.FirstRow+1,Fa.Reference.FirstColumn+1,Fa.Reference.LastRow+1,Fa.Reference.LastColumn+1,!1,!1);1===Fa.BindingType&&
(Fa.HasHeaders&&--Qb.top,Fa.HasTotals&&(Qb.bottom+=1));var cc=Qa.g(this.$).ha.sa.selectedRanges;Fa=Qb.byb(this.Zpc);cc=Qb.byb(cc);return(Qb=Qb.ze(Qa.g(this.$).ha.sa.activeRange))&&(Ic.e(Fa)&&!Ic.e(cc)||!Ic.e(Fa)&&!Ic.e(cc)&&!Mb.Q(Fa,cc))?Qb:null};I.prototype.wmj=function(){var Fa=this;Array.forEach(this.tE,function(Qb){if(Qb.eventId!==OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent&&Qb.eventId!==OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||Fa.Eg.Ri.B_b(Fa.controlId))if(Qb.eventId===
OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent)Qb.j1b(new eb.a(Qb.eventId,Fa.controlId,null));else if(Qb.eventId===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent){var cc=Fa.p2a(Qb.targetId);if((null===cc||void 0===cc?0:cc.IsValidRef)&&(Fa.$.ea.isNamedObjectViewMode?Fa.$.vb.pa.sheetName:Fa.$.va.pa.name)===cc.Reference.SheetName){var bc=Fa.plj(cc);bc&&Qb.j1b(new G(Qb.eventId,Fa.controlId,Fa.Eg.q0b(cc),cc,bc.top-1,bc.left-1,bc.height,bc.width))}}})};I.prototype.Btb=function(Fa,Qb){if(!this.tE)return null;
for(var cc=0;cc<this.tE.length;cc++){var bc=this.tE[cc];if(bc.eventId===Fa&&bc.targetId===Qb)return bc}return null};I.prototype.XRe=function(){for(var Fa=tb.a(this.$).OU,Qb=Fa.length-1;0<=Qb;--Qb){var cc=Fa[Qb];if(3===cc.floatingObject.type&&cc.floatingObject.dl.InstanceId===this.Z0.WebExtensionId)return cc}return null};I.prototype.mki=function(){for(var Fa=0;Fa<this.$.vb.count;Fa++)if(this.$.vb.getItem(Fa).dLa===this.Z0.WebExtensionId)return!0;return!1};I.prototype.Ivc=function(Fa){this.zNc=Fa;this.cy.id=
this.hEf;this.cy.className=ac;this.cy.dir=this.$.isChromeRtl?"rtl":"ltr";this.yoj()};I.prototype.D_e=function(){if(!this.enabled)return null;var Fa=Vb.a(this.dl)?"":this.dl.PrimaryMarketplace.SolutionVersion;return OSF.OsfManifestManager.getCachedManifest(this.dl.PrimaryMarketplace.SolutionId,Fa)};I.prototype.a4e=function(Fa,Qb){if(pa.EwaSettings.ma(24))this.Eg.kf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Qb);else try{if(ua.ULS.sendTraceTag(537170462,0,50,"HandleDialogNotificationShownInAddinEvent called!"),
4!==this.Sbe)this.Eg.kf(OSF.DDA.ErrorCodeManager.errorCodes.ooeNotUILessDialog,Qb);else{var cc={};cc[Ha.a.onb]=this.controlId;var bc=new kc.a(Fa,0,this.$.isEditMode?2:1,0,null);this.$.Ka.Kb(bc,cc);this.Eg.Ku(Qb)}}catch(Mc){ua.ULS.sendTraceTag(537170461,0,10,"HandleDialogNotificationShownInAddinEvent called. Error message: {0}.",Mc.message),this.Eg.kf(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,Qb)}};I.Wgh=function(Fa){return Fa===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||Fa===
OSF.DDA.EventDispId.dispidBindingDataChangedEvent};I.qbf=function(Fa){return Fa===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||Fa===OSF.DDA.EventDispId.dispidSettingsChangedEvent||Fa===OSF.DDA.EventDispId.dispidRichApiMessageEvent};I.tmd=function(Fa){return Fa===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||Fa===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent};I.obf=function(Fa){return Fa===OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent};I.pbf=function(Fa){return Fa===
OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent};I.nbf=function(Fa){return Fa===OSF.DDA.EventDispId.dispidDialogNotificationShownInAddinEvent};Mf.Object.defineProperties(I.prototype,{controlId:{configurable:!0,enumerable:!0,get:function(){return this.Jd.InstanceId}},controlType:{configurable:!0,enumerable:!0,get:function(){return this.Jd.WebExtensionType}},ownerAddinSolutionId:{configurable:!0,enumerable:!0,get:function(){return this.Jd.OwnerAddinSolutionId}},$:{configurable:!0,enumerable:!0,
get:function(){return this.jb}},enabled:{configurable:!0,enumerable:!0,get:function(){return!this.vU}},cy:{configurable:!0,enumerable:!0,get:function(){return this.zNc}},gU:{configurable:!0,enumerable:!0,get:function(){return this.Jd.SrcLocationOverrideResourceId?this.Eg.V2a(this.Jd.PrimaryMarketplace.SolutionId,this.Jd.SrcLocationOverrideResourceId):this.Jd.PrimaryMarketplace.SolutionId}},sourceLocationOverrideResourceId:{configurable:!0,enumerable:!0,get:function(){return this.Jd.SrcLocationOverrideResourceId}},
dl:{configurable:!0,enumerable:!0,get:function(){return this.Jd}},Tga:{configurable:!0,enumerable:!0,get:function(){return this.X0d},set:function(Fa){this.X0d=Fa}},osfControlType:{configurable:!0,enumerable:!0,get:function(){return this.Sbe}},QHa:{configurable:!0,enumerable:!0,get:function(){return this.xGc},set:function(Fa){this.xGc=Fa}},c4c:{configurable:!0,enumerable:!0,get:function(){return this.YUa},set:function(Fa){this.YUa=Fa}},focusOnIframeWhenLoaded:{configurable:!0,enumerable:!0,get:function(){return this.Jd.FocusOnIframeWhenLoaded}},
tod:{configurable:!0,enumerable:!0,get:function(){return this.C8d},set:function(Fa){this.C8d=Fa}}});Object(ja.a)(I,"OsfControl",Db.a,[880]);D.prototype.add=function(Fa){this.BYa[Fa]=!0};D.prototype.remove=function(Fa){delete this.BYa[Fa]};D.prototype.clear=function(){for(var Fa=bk(Object.keys(this.BYa)),Qb=Fa.next();!Qb.done;Qb=Fa.next())delete this.BYa[Qb.value]};D.prototype.p5e=function(){return 0<Object.keys(this.BYa).length};D.prototype.UGh=function(){return Object.keys(this.BYa)};Object(ja.a)(D,
"RichApiBeforeDocumentCloseNotificationRegistrationManager",null,[]);var Rc=b(54);x.prototype.kob=function(Fa){51===Fa.messageType?this.pNf=this.eGa(Fa.actionType,this.pNf,this.FGi):52===Fa.messageType&&(this.qNf=this.eGa(Fa.actionType,this.qNf,this.GGi))};x.prototype.eGa=function(Fa,Qb,cc){if(1===Fa)Qb||Qa.g(this.$).ha.Oa.mUc(cc),Qb++,this.hsj();else if(2===Fa){if(1>Qb)return Qb;1===Qb&&Qa.g(this.$).ha.Oa.jId(cc);Qb--}return Qb};x.prototype.Hia=function(Fa,Qb,cc){Qb&&this.Ri.RZ(Fa,Qb)&&this.Sh.rM(Fa,
Qb,cc)};x.prototype.Z$b=function(Fa){return Fa&&Fa.floatingObject?(Fa=Fa.floatingObject.id.match(RegExp("\\{\\w{8}-\\w{4}-\\w{4}-\\w{4}-\\w{12}\\}")))&&1===Fa.length?Fa[0]:null:null};x.prototype.hja=function(){var Fa=this.$.va.pa;return Fa&&0===Fa.LF?Fa.sheetId:null};x.prototype.hsj=function(){var Fa=Qa.g(this.$).ha.Oa.nC;this.dmd(Fa)&&(this.M$a=this.Z$b(Fa),this.XKb=this.hja())};x.prototype.dmd=function(Fa){return!!Fa&&!!Fa.floatingObject&&0===Fa.floatingObject.type};Object(ja.a)(x,"RichApiEventChartActivatedDeactivatedHandler",
null,[]);var Fc=b(950),wb=b(198),uc=b(708),Pb=b(101),sc=b(358),nb=b(58),pc=ma.a;Rk(z,pc);z.prototype.Y_b=function(Fa){Object(Wa.a)(sc.a,this.$.va);1===Fa.actionType?(this.wza||this.grid.ha.UD(this.Rc),this.wza++):2!==Fa.actionType||1>this.wza||(1===this.wza&&this.grid.ha.ZH(this.Rc),this.wza--)};z.prototype.tvc=function(Fa){Fa?this.vU++:(0<this.vU&&this.vU--,this.vU||this.Rc(null,new uc.a(!1)))};z.prototype.gXe=function(){return this.grid.ha.sa.selectedRanges};z.prototype.Nqe=function(Fa,Qb){return pa.EwaSettings.isChangeGateEnabled("OfficeVSO:4233860_EnableSelectionChangedEventForFirstTimeOnOpenSheet")?
(!!Fa&&wb.e(this.QMa)||Fa in this.QMa)&&!Mb.Q(this.QMa[Fa],Qb):Fa in this.QMa&&!Mb.Q(this.QMa[Fa],Qb)};z.prototype.RHe=function(Fa,Qb,cc){this.QMa[Fa]=Mb.d(Qb);this.Iic[Fa]=cc};z.prototype.fdf=function(){return this.grid.isEditing||this.grid.ui};z.prototype.xSe=function(Fa,Qb){this.Ri.RZ(14,Fa)&&this.Sh.rM(14,Fa,Qb);this.Ri.RZ(14,Fc.a.GW)&&this.Sh.rM(14,Fc.a.GW,Qb)};z.prototype.U3h=function(Fa,Qb){var cc={};cc.worksheetId=Fa;cc.address=this.cfd(Qb);Qb=Rc.a.xc(cc);this.xSe(Fa,Qb)};z.prototype.G3h=
function(Fa,Qb,cc,bc){if(this.Ri.qgf()){var Mc="",rd="";bc&&(Mc=bc.Ai);cc&&(rd=cc.Ai);bc?cc?(Qb=cc.usedRange.byb(Qb),Mc!==rd&&this.F9b(Mc,"",Fa),this.F9b(rd,this.cfd(Qb),Fa)):this.F9b(Mc,"",Fa):cc&&(Mc=cc.usedRange.byb(Qb),this.F9b(rd,this.cfd(Mc),Fa))}};z.prototype.F9b=function(Fa,Qb,cc){if(this.Ri.RZ(100,Fa)){var bc={};bc.address=Qb;bc.worksheetId=cc;this.Sh.rM(100,Fa,Rc.a.xc(bc))}};z.prototype.cfd=function(Fa){return Mb.i(Fa,",",this.$,!1)};z.prototype.dispose=function(){0<this.wza&&this.grid.ha.ZH(this.Rc);
this.Iic=this.QMa=null;this.wza=0;this.Sh=this.Ri=this.$=this.grid=null};Mf.Object.defineProperties(z.prototype,{enabled:{configurable:!0,enumerable:!0,get:function(){return!this.vU&&0<this.wza}}});Object(ja.a)(z,"RichApiEventSelectionChangedHandler",ma.a,[]);var Dc=b(354);Rk(A,z);A.prototype.gXe=function(){return Dc.a.irb(this.grid.ha.rangePicker.xK)};A.prototype.Nqe=function(Fa,Qb){return this.mif!==Fa||!Mb.Q(this.lif,Qb)};A.prototype.RHe=function(Fa,Qb){this.mif=Fa;this.lif=Mb.d(Qb)};A.prototype.fdf=
function(){return!this.grid.isEditing&&!this.grid.ui};A.prototype.xSe=function(Fa,Qb){this.Ri.RZ(2700,Fc.a.GW)&&this.Sh.rM(2700,Fc.a.GW,Qb)};Object(ja.a)(A,"RichApiEventPickedRangesChangedHandler",z,[]);B.prototype.kob=function(Fa){var Qb=Qa.g(this.$).ha;1===Fa.actionType?(this.JPa||this.KPa||Qb.Oa.mUc(this.awf),2101===Fa.messageType?this.JPa++:2102===Fa.messageType&&this.KPa++):2===Fa.actionType&&(2101===Fa.messageType?this.JPa=0<this.JPa?this.JPa-1:0:2102===Fa.messageType&&(this.KPa=0<this.KPa?
this.KPa-1:0),this.JPa||this.KPa||Qb.Oa.jId(this.awf))};B.prototype.Yli=function(Fa){return!!Fa&&!!Fa.floatingObject&&(0===Fa.floatingObject.type||7===Fa.floatingObject.type||1===Fa.floatingObject.type||3===Fa.floatingObject.type||5===Fa.floatingObject.type)};B.prototype.DMj=function(Fa){if(!Fa||!Fa.floatingObject)return null;Fa=Fa.floatingObject.id;var Qb=Fa.match(RegExp("\\{\\w{8}-\\w{4}-\\w{4}-\\w{4}-\\w{12}\\}"));Qb=Qb&&1===Qb.length?Qb[0]:null;return Qb?Qb:(ua.ULS.sendTraceTag(537170457,344,
10,"Expect get the guid like shape id from the floating object id: '{0}', but we failed.",Fa),null)};B.prototype.hja=function(){var Fa=this.$.va.pa;return Fa&&0===Fa.LF?Fa.sheetId:null};B.prototype.fireEvent=function(Fa,Qb,cc){Qb&&this.Ri.RZ(Fa,Qb)&&this.Sh.rM(Fa,Qb,cc)};Object(ja.a)(B,"RichApiEventShapeActivatedDeactivatedHandler",null,[]);w.prototype.kob=function(Fa){11===Fa.messageType?Fa.targetId===Fc.a.GW?this.HLg(Fa.actionType):this.GLg(Fa.actionType):12===Fa.messageType&&(Fa.targetId===Fc.a.GW?
this.ILg(Fa.actionType):this.JLg(Fa.actionType))};w.prototype.GLg=function(Fa){this.rNf=this.eGa(Fa,this.rNf,this.QTi)};w.prototype.JLg=function(Fa){this.uNf=this.eGa(Fa,this.uNf,this.TTi)};w.prototype.HLg=function(Fa){this.sNf=this.eGa(Fa,this.sNf,this.RTi)};w.prototype.ILg=function(Fa){this.tNf=this.eGa(Fa,this.tNf,this.STi)};w.prototype.eGa=function(Fa,Qb,cc){1===Fa?Qb=this.GWc(Qb,cc):2===Fa&&(Qb=this.n5c(Qb,cc));return Qb};w.prototype.GWc=function(Fa,Qb){Fa||this.$.va.If(Qb);Fa++;return Fa};w.prototype.n5c=
function(Fa,Qb){if(1>Fa)return Fa;1===Fa&&this.$.va.vg(Qb);Fa--;return Fa};w.prototype.Z6a=function(Fa){return!!Fa&&0===Fa.LF};w.prototype.Hia=function(Fa,Qb,cc,bc){Qb=(void 0===bc?0:bc)?Fc.a.GW:Qb;this.Ri.RZ(Fa,Qb)&&this.Sh.rM(Fa,Qb,cc)};Object(ja.a)(w,"RichApiEventSheetActivatedDeactivatedHandler",null,[]);var oc=b(245),Gc=b(13),ld=b(233),gd=Sys.EventArgs;Rk(m,gd);Object(ja.a)(m,"ClickInActiveCellEventArgs",Sys.EventArgs,[]);y.prototype.dispose=function(){this.NOj()};y.prototype.y8i=function(){for(var Fa=
bk(this.gridView.en),Qb=Fa.next();!Qb.done;Qb=Fa.next())Qb=Qb.value.domElement,oc.a.instance.ra(Gc.a.pointerDown,Qb,this.onPointerDown),ld.a.instance.ra(Gc.a.click,Qb,this.$c)};y.prototype.NOj=function(){for(var Fa=bk(this.gridView.en),Qb=Fa.next();!Qb.done;Qb=Fa.next())Qb=Qb.value.domElement,oc.a.instance.Ba(Gc.a.pointerDown,Qb,this.onPointerDown),ld.a.instance.Ba(Gc.a.click,Qb,this.$c)};y.prototype.UTi=function(Fa){var Qb=Fa.sheet;if(this.Z6a(Qb)){var cc={};cc.worksheetId=Qb.sheetId;cc.address=
Fa.ZUg.toString();cc.offsetX=Fa.offsetX;cc.offsetY=Fa.offsetY;Fa=Qb.sheetId;this.Ri.RZ(21,Fa)&&(Qb=Rc.a.xc(cc),this.Sh.rM(21,Fa,Qb));Fa=Fc.a.GW;this.Ri.RZ(21,Fa)&&(cc=Rc.a.xc(cc),this.Sh.rM(21,Fa,cc))}};y.prototype.Z6a=function(Fa){return!!Fa&&0===Fa.LF};Object(ja.a)(y,"RichApiEventSingleClickedHandler",null,[]);r.prototype.Y_b=function(Fa){2E3===Fa.messageType&&(1===Fa.actionType?(this.uHb||Qa.g(this.$).ha.Oa.mUc(this.mDf),this.uHb++,this.Foj()):2===Fa.actionType&&this.uHb&&(1===this.uHb&&Qa.g(this.$).ha.Oa.jId(this.mDf),
this.uHb--))};r.prototype.L$c=function(Fa){var Qb,cc={};cc.worksheetId=Fa;cc.revisionLoad=!1;if(pa.EwaSettings.isChangeGateEnabled("OfficeVSO:5509495_SelectedVisualIdVisualSelectionChangedEventArgs")&&(pa.EwaSettings.ma(717)||pa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartBRSChartPlayerManualPlacement",!1))){var bc=Qa.g(this.$).ha.Oa.nC;(null===(Qb=null===bc||void 0===bc?void 0:bc.floatingObject)||void 0===Qb?0:Qb.Oc)?cc.selectedVisualId=bc.floatingObject.Oc.VisualID:cc.selectedVisualId=
null}Qb=Rc.a.xc(cc);Fa&&this.Ri.RZ(2E3,Fa)&&this.Sh.rM(2E3,Fa,Qb)};r.prototype.hja=function(){var Fa=this.$.va.pa;return Fa&&0===Fa.LF?Fa.sheetId:null};r.prototype.Foj=function(){var Fa=Qa.g(this.$).ha.Oa.nC;this.chf(Fa)&&(this.J$a=Fa.floatingObject.id,this.D$a=this.hja())};r.prototype.chf=function(Fa){return!!Fa&&Fa.Eqd()};Object(ja.a)(r,"RichApiEventVisualSelectionChangedHandler",null,[]);v.prototype.FLg=function(Fa){1===Fa.actionType?(this.vHb||this.aMg(),this.vHb++):2!==Fa.actionType||1>this.vHb||
(1===this.vHb&&this.Fdh(),this.vHb--)};v.prototype.aMg=function(){if(this.Ri.RZ(2203,Fc.a.GW))if(this.hpd){var Fa={};Fa.timeout=this.$.ya.CheckFocusTimeout;this.W9b=window.requestIdleCallback(this.Xwe,Fa)}else this.W9b=window.setInterval(this.Wwe,this.$.ya.CheckFocusTimeInterval)};v.prototype.Fdh=function(){this.hpd?window.cancelIdleCallback(this.W9b):window.clearInterval(this.W9b)};Object(ja.a)(v,"RichApiEventWorkbookActivatedHandler",null,[]);var Cc;(function(Fa){Fa[Fa.none=0]="none";Fa[Fa.registerEvent=
1]="registerEvent";Fa[Fa.unregisterEvent=2]="unregisterEvent";Fa[Fa.customFunction=3]="customFunction";Fa[Fa.showCard=4]="showCard";Fa[Fa.createWorkbook=5]="createWorkbook";Fa[Fa.openWorkbook=6]="openWorkbook";Fa[Fa.enableEvents=7]="enableEvents";Fa[Fa.closeWorkbook=8]="closeWorkbook";Fa[Fa.setCalculationMode=9]="setCalculationMode";Fa[Fa.workbookLinksRequestRefresh=10]="workbookLinksRequestRefresh";Fa[Fa.workbookLinksRequestRefreshAll=11]="workbookLinksRequestRefreshAll";Fa[Fa.workbookLinksEnableContent=
12]="workbookLinksEnableContent";Fa[Fa.workbookLinksFindNextLink=13]="workbookLinksFindNextLink";Fa[Fa.workbookLinksOpenWorkbook=14]="workbookLinksOpenWorkbook";Fa[Fa.rangePicker=15]="rangePicker";Fa[Fa.enableRichApiRecording=16]="enableRichApiRecording";Fa[Fa.recordAction=17]="recordAction";Fa[Fa.focus=18]="focus";Fa[Fa.businessBarShow=19]="businessBarShow";Fa[Fa.businessBarHide=20]="businessBarHide"})(Cc||(Cc={}));Object(ja.b)("PostProcessActionType",Cc);var kd=b(257);f.prototype.ELg=function(Fa){1===
Fa.actionType?(this.$.wba=!0,Object(Wa.a)(b(947).DdaFacade,kd.a(this.$)).K$c(!0)):2===Fa.actionType&&(this.$.wba=!1);this.iEf=Fa.controlId;ua.ULS.sendTraceTag(537170456,0,50,"AttachOrDetachMacroRecorderEventHandler: actionType: {0}; controlId: {1}; this.ewaControl.IsMacroRecorderListening: {2}.",Cc[Fa.actionType],this.iEf,this.$.wba)};f.prototype.Wkh=function(Fa){Object(Wa.a)(b(947).DdaFacade,kd.a(this.$)).ASe(Fa,this.$.wba)};f.prototype.P$h=function(){var Fa=this;this.$.Aba&&jb.TaskExtensions.Aa(Aa.GetServiceTaskFactory.Ra(this.$.da,
297,298,1),function(Qb){(Qb=Qb.result)&&Qb.init(Fa.J$c)},this.$.la,3)};Object(ja.a)(f,"RichApiMacroRecorderEventHandler",null,[]);Object(ja.a)(n,"SessionRecreationInfo",null,[]);l.prototype.gCi=function(){return pa.EwaSettings.ma(260)?this.Ri.C4h()||0!==this.runtimeCalculationMode:!1};l.prototype.PQg=function(){var Fa={};Fa.eventRegistrationInfos=this.Ri.kNh();Fa.runtimeCalculationMode=this.runtimeCalculationMode;Fa=Object(va.a)(new n,{runtimeState:Fa});var Qb={HttpMethod:"POST",PathAndQuery:"RestoreRuntimeState",
RequestHeaders:null};Qb.RequestBody=JSON.stringify(Fa);Qb.RequestFlags=1;return Qb};Object(ja.a)(l,"RichApiRuntimeStateHandler",null,[]);Object(ja.a)(k,"UserOperationQueueItemsStatisticsData",null,[]);var Fd=b(341),rb=b(30),Kd=b(19),Qd=b(307),ve=b(48),Be=b(657),Ie=b(64),se=b(59),Se=b(69),Le=Fd.a;Rk(e,Le);e.prototype.dispose=function(){this.$&&(this.$.va.DK(this.mo),this.$.vb.DK(this.mo),this.$.vb.vg(this.oe),this.$.va.vg(this.oe));this.OTa&&(this.OTa.Dq(this.ef),this.OTa.YH(this.Dm),this.OTa.dv(this.xi));
pa.EwaSettings.Zb()&&this.jy(this.fya);this.clearCache();Fb.a.Ia(this.OTa);this.OTa=null;xb.DOMElementExtensions.ff(this.domElement);Le.prototype.dispose.call(this)};e.prototype.xoj=function(Fa){xb.DOMElementExtensions.ff(xb.DOMElementExtensions.getElementById(this.domElement,Fa.id));this.domElement.appendChild(Fa)};e.prototype.Dkd=function(){if(this.rva&&!this.x3b){var Fa=Object(Wa.a)(b(947).DdaFacade,kd.a(this.$)).Tm(this.rva.InstanceId);Fa&&(Fa.resize(this.rva.Width,this.rva.Height),Fa.ka(this.domElement),
Fa.showHide(!0),this.x3b=!0)}};e.prototype.a7a=function(){return!0};e.prototype.ona=function(Fa){this.rva=Fa.Zc.block.ke;this.x3b=!1;this.Dkd()};e.prototype.iTa=function(Fa){this.$.ea.QZ&&Fa&&(Fa.ou||(Fa.ou=new Qd.a),Fa.ou.Fh=new ve.a(this.domElement.scrollLeft,this.domElement.scrollTop),Fa.ou.dGb=20)};e.prototype.clearCache=function(){this.Ea.OPa(this.hashCode);this.rva=this.hashCode=null;this.x3b=!1};e.prototype.iSa=function(Fa,Qb){if(this.isVisible=!!Fa&&Ie.o(Fa))this.hashCode=this.Ea.yra(Fa,se.a.H5b,
this.hashCode),this.Wvc(Qb)};e.fGa=function(Fa){if(!Fa.da.za(34)){var Qb=Fa.tf;Fa.da.Ga(34,new e(Fa,new Be.a(Fa,Fa.ea,Fa.oa.Fk,3,0),Qb.appendChild(Qb.ownerDocument.createElement("div"))))}};Mf.Object.defineProperties(e.prototype,{Ea:{configurable:!0,enumerable:!0,get:function(){return this.OTa}}});Object(ja.a)(e,"WebExtensionView",Fd.a,[874,447,3]);var rf=b(235),af=b(564),xe=b(388),Td=b(470),Bc=b(177),qd=b(62),Jd=b(121),ad=b(47),Yd=b(44),pe=b(159),Wd=b(111),bf=b(68),ke=b(28),cf=b(31),Pe=b(295),nc=
b(22),Da=b(15),Sb=b(294),hb=b(949),Xb=b(50),jc=b(153),Wc=b(1075),fd=b(205),Tc=b(1074),td=b(25);b.d(E,"DdaFacade",function(){return a});var Tb=Ob.a;Rk(a,Tb);a.prototype.dme=function(Fa){this.addHandler("cd",Fa)};a.prototype.aaj=function(Fa){this.removeHandler("cd",Fa)};a.prototype.UDg=function(Fa){this.addHandler("csc",Fa)};a.prototype.caj=function(Fa){this.removeHandler("csc",Fa)};a.prototype.RDg=function(Fa){this.addHandler("ca",Fa)};a.prototype.$$i=function(Fa){this.removeHandler("ca",Fa)};a.prototype.SDg=
function(Fa){this.addHandler("ci",Fa)};a.prototype.TDg=function(Fa){this.addHandler("ekros",Fa)};a.prototype.baj=function(Fa){this.removeHandler("ekros",Fa)};a.prototype.aCd=function(Fa,Qb){try{return JSON.parse(Fa)[Qb].toLowerCase()}catch(cc){return""}};a.prototype.avj=function(Fa){var Qb=this.aCd(Fa,"AudienceGroup"),cc=this.aCd(Fa,"SessionOrigin");try{var bc=parseInt(this.aCd(Fa,"Ring"),10);if("automation"!==Qb&&"bluechicken"!==cc&&-2<=bc)return!0}catch(Mc){if("automation"!==Qb&&"bluechicken"!==
cc)return!0}return!1};a.prototype.q0b=function(Fa){var Qb={};Qb.Name=Fa.Name;Qb.BindingType=Fa.BindingType;Qb.HasHeaders=Fa.HasHeaders;Fa.IsValidRef&&(Qb.ColCount=Fa.Reference.LastColumn-Fa.Reference.FirstColumn+1,Qb.RowCount=Fa.Reference.LastRow-Fa.Reference.FirstRow+1);return Qb};a.prototype.Pqi=function(Fa,Qb){this.Lm.launchInsertDialog(Fa,null,this.TPg(Qb))};a.prototype.Oca=function(Fa,Qb){if(ra.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6458904_QueryEntitledAppsForStoreType"))this.ZIf(Fa,
Qb,OSF.StoreTypeEnum.MarketPlace);else{var cc={};cc.callbackFunc=Fa;cc.storeType=OSF.StoreTypeEnum.MarketPlace;cc.fromInsertDialog=!1;cc.refresh=Qb;this.Lm.queryEntitlementDetails(cc)}};a.prototype.ZIf=function(Fa,Qb,cc){var bc={};bc.callbackFunc=Fa;bc.storeType=cc;bc.fromInsertDialog=!1;bc.refresh=Qb;this.Lm.queryEntitlementDetails(bc)};a.prototype.invokeDdaMethod=function(Fa,Qb){var cc=this.Tm(Fa.DdaMethod.ControlId);cc?cc.invokeDdaMethod(Fa,Qb):this.kf(ha.a.internalError,Qb)};a.prototype.registerDdaEventAsync=
function(Fa,Qb,cc,bc,Mc){(Qb=this.Tm(Qb))?a.Oyb(Fa)?Qb.d7i(Fa,cc,bc,Mc):this.kf(ha.a.sBd,Mc):this.kf(ha.a.internalError,Mc)};a.prototype.unregisterDdaEventAsync=function(Fa,Qb,cc,bc,Mc){(Qb=this.Tm(Qb))?a.Oyb(Fa)?Qb.sOj(Fa,cc,bc,Mc):this.kf(ha.a.sBd,Mc):this.kf(ha.a.internalError,Mc)};a.prototype.dispose=function(){this.disposed||(this.$.rl(this.Yc),this.ea.wk(this.Uc),this.ea.yR(this.qo),this.ea.Bw(this.Qf),this.mVc.detach(this),this.$.userOperationManager.so(this.kR),this.xoc=this.pf=this.Sh=this.mVc=
this.jb=null,this.xIa&&(this.xIa.dispose(),this.xIa=null),Fb.a.Ia(this.XKd),Fb.a.Ia(this.WKd),this.N0a&&(this.N0a.dispose(),this.N0a=null),Tb.prototype.dispose.call(this),this.disposed=!0,ua.ULS.sendTraceTag(537170583,0,50,"DdaFacade is disposed"))};a.prototype.Icd=function(Fa){return(Fa=this.Tm(Fa))?Fa.getDefaultIconUrl():null};a.prototype.tvc=function(Fa){if(this.BEe!==Fa){this.BEe=Fa;for(var Qb=0,cc=this.pf.length;Qb<cc;Qb++){var bc=this.pf[Qb];Fa?bc.SGe(!1):bc.Njh()}this.XKd.tvc(Fa);this.WKd.tvc(Fa)}};
a.prototype.VLh=function(Fa){return(Fa=this.Tm(Fa))?Fa.getDefaultDisplayName():null};a.prototype.kf=function(Fa,Qb,cc){var bc={};bc[Z.a.Uf]=Fa;bc[Z.a.n3]=Qb;this.SJ(451041795,bc,void 0===cc?!0:cc)};a.prototype.Ku=function(Fa){var Qb={};Qb[Z.a.n3]=Fa;this.SJ(1237877382,Qb)};a.prototype.SJ=function(Fa,Qb,cc){var bc=this;cc=void 0===cc?!0:cc;var Mc=new kc.a(Fa,0,this.$.Jc,0,null),rd=Qb?Qb[Z.a.n3]:null;this.N0a&&Qa.g(this.$).isEditing&&K.QZg(Fa,Qb)?this.N0a.wch(Fa,Qb):(Fa=this.$.Ka.Kb(Mc,Qb),cc&&jb.TaskExtensions.Aa(Fa,
function(Hd){pe.a(Hd)?bc.kf(ha.a.internalError,rd,!1):Hd.result||(Qa.g(bc.$).isEditing?bc.kf(ha.a.cyb,rd,!1):bc.kf(ha.a.internalError,rd,!1))},this.la,8))};a.prototype.q1g=function(Fa){var Qb=this;return!!this.Gia(function(cc){return a.getSolutionId(cc.dl,Qb.$)===a.getSolutionId(Fa,Qb.$)&&cc.dl.PrimaryMarketplace.MarketplaceType===Fa.PrimaryMarketplace.MarketplaceType&&cc.dl.PrimaryMarketplace.MarketplaceRef===Fa.PrimaryMarketplace.MarketplaceRef&&cc.dl.PrimaryMarketplace.SolutionVersion===Fa.PrimaryMarketplace.SolutionVersion})};
a.prototype.Tm=function(Fa){return this.Gia(function(Qb){return Qb.controlId.startsWith(Fa)})};a.prototype.lAh=function(Fa){return this.Gia(function(Qb){return Qb.QHa===Fa})};a.prototype.YRe=function(Fa){return this.Gia(function(Qb){return Qb.gU===Fa&&!!Qb.QHa})};a.prototype.pSe=function(Fa,Qb,cc,bc){return this.Gia(function(Mc){return Mc.gU===Fa&&Mc.dl.PrimaryMarketplace.MarketplaceRef.toLowerCase()===Qb.toLowerCase()&&Mc.dl.PrimaryMarketplace.MarketplaceType.toLowerCase()===cc.toLowerCase()&&!!Mc.dl.SharedRuntime&&
!!Mc.dl.SharedRuntime.Resid&&!!bc&&!!bc.Resid&&Mc.dl.SharedRuntime.Resid.toLowerCase()===bc.Resid.toLowerCase()})};a.prototype.tLg=function(Fa,Qb){if(Fa=this.Tm(Fa))Fa.ka(Qb),Fa.showHide(!0)};a.prototype.mzj=function(Fa){(Fa=this.Tm(Fa))&&Fa.showHide(!1)};a.prototype.n0a=function(Fa){var Qb;if(1!==Fa.WebExtensionType||this.$.Cd&8388608&&Fa.TaskpaneVisible||this.$.Cd&8388608&&!Fa.TaskpaneVisible&&Va.HelperMethods.fw(Fa)){var cc=null;Va.HelperMethods.fw(Fa)&&(cc=a.Fua(Fa,this.$),Fa.TaskpaneWidth||(Fa.TaskpaneWidth=
this.N5b));var bc=(new I(this,this.Sh,Fa)).qkd();ua.ULS.sendTraceTag(51263011,0,50,"DdaFacade::CreateOsfControl: SolutionId: {0}, StoreType: {1}, UseShareRuntime: {2}",Telemetry.PrivacyRules.GetPrivacyCompliantId(Fa.PrimaryMarketplace.SolutionId,Fa.PrimaryMarketplace.MarketplaceType,null===(Qb=Fa.AssetMarketplace)||void 0===Qb?void 0:Qb.SolutionId,null,null,Fa.PrimaryMarketplace.MarketplaceRef),Fa.PrimaryMarketplace.MarketplaceType,Va.HelperMethods.fw(Fa));cc&&(bc.QHa=cc);this.pf.push(bc);this.cxa=
null;this.v5a(Fa.InstanceId)||(Fa=String.format("{0}|{1}|{2}|{3}|{4}",Fa.PrimaryMarketplace.SolutionId,Fa.PrimaryMarketplace.SolutionVersion,Fa.PrimaryMarketplace.MarketplaceRef,Fa.PrimaryMarketplace.MarketplaceType,Fa.WebExtensionType),this.raiseEvent("ci",Fa))}};a.prototype.VAj=function(Fa,Qb){function cc(){bc.QPa(rd.controlId);bc.Qh.purgeOsfControl(rd.controlId,!1);Qb()}var bc=this;Fa.TaskpaneWidth=this.N5b;Fa.TaskpaneVisible=!0;var Mc={};Mc.SolutionId=Fa.PrimaryMarketplace.SolutionId;Mc.TargetType=
Fa.WebExtensionType;Mc.Version=Fa.PrimaryMarketplace.SolutionVersion;Mc.StoreType=Fa.PrimaryMarketplace.MarketplaceType;Mc.StoreId=Fa.PrimaryMarketplace.MarketplaceRef;Mc.AssetId=Fa.PrimaryMarketplace.SolutionId;Mc.AssetStoreId=Fa.PrimaryMarketplace.MarketplaceRef;Mc.Width=Fa.TaskpaneWidth;var rd=new I(this,this.Sh,Fa,!0);rd.qkd();this.pf.push(rd);var Hd=null;Hd=ad.a.instance.nE(function(){rd.cy&&(Fb.a.Ia(Hd),Hd=null,bc.Qh.insertBlankControlWithErrorUX(bc.kGb(rd,Mc),cc))},100,Yd.a.mbh)};a.prototype.g5g=
function(Fa){var Qb=this;if(Fa&&Fa.length){var cc=[];Fa.forEach(function(bc){if(bc.ContainsCustomFunctions){var Mc=a.Fua(bc,Qb.$);Qb.yCd.contains(Mc)||(Qb.yCd.add(Mc),Qb.AFf.push(bc));Qb.q1g(bc)||cc.push(bc)}});cc.length&&this.KBe(cc)}};a.prototype.HDe=function(Fa,Qb){this.Tm(Fa.InstanceId)||(Qb=Qb(),Fa=(new I(this,this.Sh,Fa)).a9e(Qb),this.pf.push(Fa),this.cxa=null)};a.prototype.Iyj=function(Fa){a.H0a.kb(Fa)&&a.H0a.na(Fa).initializeAndShowWithTitle()};a.prototype.A5h=function(Fa){a.H0a.kb(Fa)&&a.H0a.na(Fa).hide()};
a.prototype.GSh=function(Fa){var Qb=this,cc=null,bc,Mc=null;var rd=a.vgd(Fa,!0);if(!rd)return ua.ULS.sendTraceTag(537170570,0,10,"DdaFacade.GetOrCreateCustomFunctionSandboxAsync: webextension data is null"),nb.Task.Ua(null);(bc=this.Lm.getOsfControl(a.getSolutionId(rd,this.$)))&&(cc=bc.getManifest())&&(Mc=cc.getSharedRuntimeForCustomFunctions("Workbook"));if(cc=Mc&&1===Mc.LifeTime?this.pSe(rd.PrimaryMarketplace.SolutionId,rd.PrimaryMarketplace.MarketplaceRef,rd.PrimaryMarketplace.MarketplaceType,
Mc):this.lAh(Fa))return nb.Task.Ua(cc.controlId);var Hd=new yb.a;Va.HelperMethods.fic(Mc)&&(rd.SharedRuntime=Mc);Fa=bc?bc.getNotificationParams():[];if(!Fa.length)return this.nCe(rd);this.S1f(Fa,function(){jb.TaskExtensions.Aa(Hd.task,function(){Qb.nCe(rd)},Qb.la,3)},function(){});return Hd.task};a.prototype.SGh=function(Fa){Fa=a.vgd(Fa,!1);if(!Fa)return ua.ULS.sendTraceTag(537170569,0,10,"DdaFacade.GetAddinCommandSandbox: webextension data is null"),null;var Qb=null,cc=this.Lm.getOsfControl(a.getSolutionId(Fa,
this.$));cc&&(cc=cc.getManifest())&&(Qb=cc.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"));return Va.HelperMethods.fic(Qb)&&(Fa=this.pSe(Fa.PrimaryMarketplace.SolutionId,Fa.PrimaryMarketplace.MarketplaceRef,Fa.PrimaryMarketplace.MarketplaceType,Qb))?Fa.controlId:null};a.prototype.D3g=function(Fa,Qb){var cc=this,bc=a.vgd(Fa,!1);if(bc){var Mc=null,rd=this.Lm.getOsfControl(a.getSolutionId(bc,this.$));rd&&(rd=rd.getManifest())&&(Mc=rd.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"));if(Va.HelperMethods.fic(Mc)){bc.SharedRuntime=
Mc;var Hd=bc.PrimaryMarketplace.SolutionId;rd=bc.PrimaryMarketplace.SolutionVersion;var ic=OSF.OsfManifestManager.getCachedManifest(Hd,rd);if(ic)if(this.JZb.kb(Fa))Mc=this.JZb.na(Fa),jb.TaskExtensions.Aa(Mc,function(sd){(sd=sd.result)&&OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(sd,Qb,cc.Sh.OJb)},this.la,3);else{var Jc={solutionId:Hd,version:rd};Jc.storeType=bc.PrimaryMarketplace.MarketplaceType;Jc.storeId=bc.PrimaryMarketplace.MarketplaceRef;Jc.assetId=Hd;Jc.assetStoreId=
null;Jc.targetType=OSF.OsfControlTarget.TaskPane;var zd=new yb.a;bc=jb.TaskExtensions.jk();bc=new ya.a(this.$,this,Jc,bc);Mc=OSF.OsfManifestManager.getSharedRuntimeManifestCacheKey(Hd,Mc.Resid);OfficeExt.AddinCommandsManifestManager.cacheManifestForAction(ic,Mc,rd);bc.createUILessSandbox(Jc,ic,function(sd,Pd){sd&&!Pd?(OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(sd,Qb,cc.Sh.OJb),zd.setResult(sd)):zd.setResult(null);cc.JZb.remove(Fa)});this.JZb.ia(Fa,zd.task)}}}else ua.ULS.sendTraceTag(537170568,
0,10,"DdaFacade.CreateAddinCommandSandboxAsync: webextension data is null")};a.prototype.Kwe=function(Fa){(Fa=this.YRe(Fa))&&(Fa.dl.SharedRuntime||this.EHb(Fa.controlId))};a.prototype.EHb=function(Fa){(Fa=this.YRe(Fa))&&this.QPa(Fa.controlId)};a.prototype.rgh=function(Fa,Qb){if(!this.pf||!Fa||!Qb)return!1;if(Fa.toLowerCase()===Qb.toLowerCase())return!0;for(var cc=null,bc=null,Mc=0,rd=this.pf.length;Mc<rd;Mc++){var Hd=this.pf[Mc];if(Hd.ownerAddinSolutionId&&(Hd.controlId===Fa&&(cc=Hd.ownerAddinSolutionId.toLowerCase()),
Hd.controlId===Qb&&(bc=Hd.ownerAddinSolutionId.toLowerCase()),cc&&bc))break}return cc&&cc===bc?!0:!1};a.prototype.yBg=function(Fa){this.Tm(Fa.InstanceId)||(Fa=new I(this,this.Sh,Fa),this.pf.push(Fa),this.cxa=null)};a.prototype.nOf=function(Fa){if(this.pf&&0<=Fa&&Fa<this.pf.length){var Qb=this.pf[Fa],cc=Qb.cy;Array.removeAt(this.pf,Fa);this.Suf(Qb);xb.DOMElementExtensions.ff(cc)}};a.prototype.QPa=function(Fa){if(this.pf)for(var Qb=0,cc=this.pf.length;Qb<cc;Qb++)if(this.pf[Qb].controlId===Fa){this.nOf(Qb);
break}};a.prototype.c$i=function(Fa){if(this.pf){Fa=Fa.toLowerCase();for(var Qb=0,cc=this.pf.length;Qb<cc;Qb++)if(Fa===this.pf[Qb].ownerAddinSolutionId.toLowerCase()){this.nOf(Qb);break}}};a.prototype.$Lg=function(Fa){Fa.Ym&&(this.Tm(Fa.floatingObject.dl.InstanceId)||(this.afc(Fa.floatingObject.dl.InstanceId)||this.xoc.push(Fa.floatingObject.dl.InstanceId),this.n0a(Fa.floatingObject.dl)),this.ea.isNamedObjectViewMode&&this.tLg(Fa.floatingObject.dl.InstanceId,Fa.Dd))};a.prototype.saa=function(Fa){if(this.pf)for(var Qb=
0,cc=this.pf.length;Qb<cc;Qb++)if(1===this.pf[Qb].controlType&&nc.a.equals(this.pf[Qb].gU,Fa,!0))return this.pf[Qb].controlId;return null};a.prototype.Nzh=function(Fa){var Qb=[];if(this.pf)for(var cc=0,bc=this.pf.length;cc<bc;cc++)nc.a.equals(this.pf[cc].gU,Fa,!0)&&Qb.push(this.pf[cc].controlId);return Qb};a.prototype.sAh=function(Fa,Qb){if(!Qb||!Fa)return null;if(this.pf)for(var cc=0,bc=this.pf.length;cc<bc;cc++)if(1===this.pf[cc].controlType&&nc.a.equals(this.pf[cc].gU,Fa,!0)&&this.pf[cc].dl.SharedRuntime&&
nc.a.equals(this.pf[cc].dl.SharedRuntime.Resid,Qb.Resid,!0))return this.pf[cc].controlId;return null};a.prototype.V2a=function(Fa,Qb){Qb=void 0===Qb?null:Qb;return Fa?Qb?String.format("{0}.{1}",Fa,Qb):Fa:""};a.prototype.Nwe=function(Fa,Qb,cc){if(this.cxa===Fa)return!0;this.cxa=Fa;var bc=null,Mc=!1;if(!bc&&this.pf)for(var rd=0,Hd=this.pf.length;rd<Hd;rd++)if(1===this.pf[rd].controlType&&nc.a.equals(this.pf[rd].gU,Fa,!0)){var ic=!1,Jc=!1;Qb?(ic=!0,Jc=!!this.pf[rd].dl.SharedRuntime&&nc.a.equals(this.pf[rd].dl.SharedRuntime.Resid,
Qb.Resid,!0)):cc&&(ic=!0,Jc=nc.a.equals(this.pf[rd].dl.SharedRuntimeId,cc,!0));if(!ic||Jc){Jc&&this.pf[rd].Zf(!0);bc=this.pf[rd].controlId;Mc=!0;this.cxa=null;break}}bc&&this.raiseEvent("ca",bc);return Mc};a.prototype.setAppRuntimeState=function(Fa,Qb){var cc;if(Fa){var bc=this.Tm(Fa);if(bc&&Va.HelperMethods.fw(bc.dl))bc.Zf(Qb),Qb&&(this.raiseEvent("ca",Fa),(null===(cc=bc.cy)||void 0===cc?0:cc.firstChild)&&(Fa=bc.cy.firstChild.title)&&0<Fa.length&&this.K_b.omj(Fa));else throw ua.ULS.sendTraceTag(537170565,
0,50,"SetAppRuntimeState: run on non-shared runtime app."),Error.invalidOperation(Da.a.instance.ga(2216));}else throw ua.ULS.sendTraceTag(537170564,0,15,"SetAppRuntimeState: Invalid controlId."),Error.invalidOperation(Da.a.instance.ga(2217));};a.prototype.getAppRuntimeState=function(Fa){if(Fa)if((Fa=this.Tm(Fa))&&Va.HelperMethods.fw(Fa.dl))Fa=Fa.dl.TaskpaneVisible;else throw ua.ULS.sendTraceTag(537170563,0,50,"GetAppRuntimeState: run on non-shared runtime app."),Error.invalidOperation(Da.a.instance.ga(2216));
else throw ua.ULS.sendTraceTag(537170562,0,15,"GetAppRuntimeState: Invalid controlId."),Error.invalidOperation(Da.a.instance.ga(2217));return Fa};a.prototype.p2a=function(Fa,Qb){return(Fa=this.Tm(Fa))?Fa.p2a(Qb):null};a.prototype.v5a=function(Fa){return this.Pwe(this.xoc,Fa)};a.prototype.afc=function(Fa){return this.Pwe(this.wEe,Fa)};a.prototype.kke=function(Fa){this.wEe.push(Fa)};a.prototype.dZ=function(Fa){return(Fa=this.Tm(Fa))?Fa.dl:null};a.prototype.rxd=function(Fa){this.raiseEvent("ekros",Fa,
this)};a.prototype.VAd=function(Fa){if(Fa){var Qb=this.Tm(Fa.InstanceId);Qb&&(Fa.SharedRuntime||Fa.SharedRuntimeId||(this.QPa(Qb.controlId),this.Qh.purgeOsfControl(Qb.controlId,!1)),Qb={},Qb.SolutionId=Fa.PrimaryMarketplace.SolutionId,Qb.TargetType=Fa.WebExtensionType,Qb.Version=Fa.PrimaryMarketplace.SolutionVersion,Qb.StoreType=Fa.PrimaryMarketplace.MarketplaceType,Qb.StoreId=Fa.PrimaryMarketplace.MarketplaceRef,Qb.AssetId=Fa.PrimaryMarketplace.SolutionId,Qb.AssetStoreId=Fa.PrimaryMarketplace.MarketplaceRef,
Qb.Width=Fa.TaskpaneWidth,Qb.SharedRuntimeId=Fa.SharedRuntimeId,this.Q9f(Qb))}};a.prototype.mia=function(){this.Sh.mia()};a.prototype.rM=function(Fa,Qb,cc){this.Sh.rM(Fa,Qb,cc)};a.prototype.ASe=function(Fa,Qb){Qb=a.P8g(Qb);Fa=this.dZ(Fa);this.Sh.E9b(Fa.InstanceId,2202,Fc.a.GW,Qb)};a.prototype.K$c=function(Fa){for(var Qb=0,cc=this.pf.length;Qb<cc;Qb++)this.ASe(this.pf[Qb].controlId,Fa)};a.prototype.DAh=function(Fa,Qb){Qb=a.i4g(Qb);this.Sh.E9b(Fa,65539,"",Qb)};a.prototype.FAh=function(Fa,Qb,cc){this.Sh.E9b(Fa,
1,Qb,cc)};a.prototype.CAh=function(Fa,Qb){this.Sh.GAh(Fa,Qb)};a.prototype.A3g=function(Fa,Qb){return[[2,1E3,"",JSON.stringify([Fa,Qb]),0,!1]]};a.prototype.jei=function(){return!!this.Tma&&this.Tma.p5e()};a.prototype.oXg=function(){this.Tma&&this.Tma.clear()};a.prototype.EAh=function(){if(this.Tma&&this.Tma.p5e()){var Fa=this.Tma.UGh();Fa=bk(Fa);for(var Qb=Fa.next();!Qb.done;Qb=Fa.next()){Qb=this.Nzh(Qb.value);Qb=bk(Qb);for(var cc=Qb.next();!cc.done;cc=Qb.next())this.Sh.E9b(cc.value,65540,"","{}")}}};
a.prototype.X6i=function(Fa){this.Tma.add(Fa)};a.prototype.pOj=function(Fa){this.Tma.remove(Fa)};a.prototype.Gia=function(Fa){if(!this.pf)return null;for(var Qb=bk(this.pf),cc=Qb.next();!cc.done;cc=Qb.next())if(cc=cc.value,Fa(cc))return cc;return null};a.prototype.nCe=function(Fa){var Qb=this,cc=new yb.a,bc=a.Fua(Fa,this.$);if(Va.HelperMethods.fw(Fa))ua.ULS.sendTraceTag(537170531,0,50,"Shared runtime custom function agave is started."),this.xFf(Fa,function(rd){rd?(Fa.InstanceId=rd.InstanceId,Fa.WebExtensionOsfControlType=
3,Fa.TaskpaneVisible=!1,Qb.n0a(Fa),cc.setResult(Fa.InstanceId)):(ua.ULS.sendTraceTag(537170530,0,10,"InsertAgaveTaskPane for customfunction: {0} failed",Telemetry.PrivacyRules.GetPrivacyCompliantId(Fa.PrimaryMarketplace.SolutionId,Fa.PrimaryMarketplace.MarketplaceType,null,null,null,Fa.PrimaryMarketplace.MarketplaceRef)),cc.setException(Error.create("Null insert data")))});else{a.H0a.ia(Fa.InstanceId,new V.a);var Mc=a.H0a.na(Fa.InstanceId).Z0a;this.f5g(Fa,Mc,bc);this.xFf(Fa,null);cc.setResult(Fa.InstanceId)}return cc.task};
a.prototype.f5g=function(Fa,Qb,cc){this.Tm(Fa.InstanceId)||(Fa=new I(this,this.Sh,Fa),Fa.QHa=cc,Fa.a9e(Qb),this.pf.push(Fa),this.cxa=null)};a.prototype.xFf=function(Fa,Qb){var cc=a.Fua(Fa,this.$);if(!this.yCd.contains(cc))this.LFb.push(Fa),1<=this.LFb.length&&this.yFf(Fa,Qb);else if(Qb){Fa=bk(this.AFf);for(var bc=Fa.next();!bc.done;bc=Fa.next())if(bc=bc.value,a.Fua(bc,this.$)===cc){Qb(bc,0);break}}};a.prototype.yFf=function(Fa,Qb){function cc(sd){sd&&!Pe.a(sd)||ua.ULS.sendTraceTag(537170527,0,10,
"InsertAgaveTaskPane for addin {0} finish with errors: {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(Hd.SolutionId,Hd.StoreType,Hd.AssetId,null,null,Hd.StoreId),cf.a.Ec(sd.Errors));Mc.LFb.shift();0<Mc.LFb.length&&Mc.yFf(Mc.LFb[0],Qb)}function bc(sd){sd=Jd.a.Mf(sd.data);ua.ULS.sendTraceTag(537170528,0,10,"DdaFacade.CreateCustomFunctionSandbox failed on InsertAgaveTaskpane for persistenting CustomFunctions. errors: {0}",cf.a.Ec(sd))}var Mc=this,rd=null,Hd={};Hd.SolutionId=a.getSolutionId(Fa,this.$);
Hd.TargetType=Fa.WebExtensionType;Hd.Version=Fa.PrimaryMarketplace.SolutionVersion;Hd.StoreType=Fa.PrimaryMarketplace.MarketplaceType;Hd.StoreId=Fa.PrimaryMarketplace.MarketplaceRef;Hd.AssetId=Fa.PrimaryMarketplace.SolutionId;Hd.AssetStoreId=Fa.PrimaryMarketplace.MarketplaceRef;Hd.Width=Fa.TaskpaneWidth;Hd.ContainsCustomFunctions=!0;Va.HelperMethods.fw(Fa)&&(Hd.SharedRuntimeId=Fa.SharedRuntime.Resid);var ic=this.$.oa.xa;Fa=this.$.oa.xa.Pb();var Jc=ic.Na(9,Fa);Jc.sharedInfo=Hd;if(Qb){var zd=function(sd){var Pd=
sd.Result;(rd=Pd?Pd.AgaveData:null)||Qb(null,sd.Errors?sd.Errors[0].ErrorCause:5001);Qb(rd,0)};Fa=function(sd,Pd,De){return qd.g(ic,"InsertAgaveTaskpane",Jc,Sb.b(sd,cc,zd),Sb.a(Pd,bc),De,null,0)}}else Fa=function(sd,Pd,De){return qd.g(ic,"InsertAgaveTaskpane",Jc,Sb.b(sd,cc),Sb.a(Pd,bc),De,null,0)};pa.EwaSettings.Zb()?xe.a(this.$.userOperationManager,Fa,function(sd){return new Bc.a(519,0,sd,64)},null):xe.a(this.$.userOperationManager,Fa,function(sd){return new af.a(519,0,sd)},null)};a.prototype.Svj=
function(){return this.$.Jf.get(35)};a.prototype.PHd=function(Fa){Fa=this.Tm(Fa);(null===Fa||void 0===Fa?0:Fa.rda)&&Fa.xOf()};a.prototype.tDi=function(Fa){var Qb=this.Gia(function(cc){return a.FLa(cc.gU)});Qb&&(Qb=this.Qh.getOsfControl(Qb.controlId))&&Qb.notifyAgave(OSF.AgaveHostAction.SendMessage,Fa)};a.prototype.Wei=function(){return!!this.Gia(function(Fa){return 1===Fa.controlType&&a.FLa(Fa.gU)})};a.prototype.Vei=function(){var Fa=this.Gia(function(Qb){return a.FLa(Qb.gU)});return Fa?Fa.cy?xb.DOMElementExtensions.isVisible(Fa.cy):
!1:!1};a.prototype.ypj=function(){var Fa=this.Gia(function(Qb){return a.FLa(Qb.gU)});Fa&&(Fa.Zf(!0),this.raiseEvent("ca",Fa.controlId))};a.prototype.initialize=function(){var Fa=b(1566).DdaEventDispatch,Qb=void 0===this.$||null===this.$||pa.EwaSettings.ma(260);void 0!==this.$&&null!==this.$||ua.ULS.sendTraceTag(537170525,0,50,"VSO#2693929: Initialize is called. EwaControl is null");Qb&&ua.ULS.sendTraceTag(537170524,0,50,"VSO#2693929: Initialize is called. this.initialized is "+this.initialized);this.initialized||
(e.fGa(this.$),this.ea=this.$.ea,this.Sh=new Fa(this.$),this.$.Tk(this.Yc),this.ea.Vj(this.Uc),this.ea.QL(this.qo),this.ea.zu(this.Qf),this.$.userOperationManager.zr(this.kR),this.Pjf(),this.ENi(),this.b$h(),this.$.da.Ga(35,this),this.mVc.ka(this),Qb&&ua.ULS.sendTraceTag(537170522,0,50,"VSO#2693929: SessionIdChanged event is registered"),this.cee=new Fc.a,Qb&&ua.ULS.sendTraceTag(537170521,0,50,"VSO#2693929: RichApiEventRegistration is constructed"),this.fee=new w(this.$,this.Ri,this.Sh),this.Hug=
new y(this.$,this.Ri,this.Sh),this.dee=new z(this.$,this.Ri,this.Sh),this.bee=new A(this.$,this.Ri,this.Sh),this.aee=new x(this.$,this.Ri,this.Sh),this.eee=new B(this.$,this.Ri,this.Sh),this.gee=new r(this.$,this.Ri,this.Sh),this.hee=new v(this.$,this.Ri,this.Sh),this.$.Aba&&(this.iee=new f(this.$,this.Ri,this.Sh)),pa.EwaSettings.ma(191)&&(this.N0a=new K(this,Qa.g(this.$))),pa.EwaSettings.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled")&&(this.$de=new D),this.initialized=
!0,ua.ULS.sendTraceTag(537170520,0,50,"DdaFacade is initialized"))};a.prototype.yAh=function(Fa){if(!this.OBa)return null;for(var Qb=0,cc=this.OBa.length;Qb<cc;Qb++)if(Fa.startsWith(this.OBa[Qb].WebExtensionId))return this.OBa[Qb];return null};a.prototype.Pjf=function(){var Fa,Qb=this.ea;if(Qb.dc&&!this.dPb){if(Qb.workbookContext){if(this.kSc=this.$.ea.Jg.get(22),null===(Fa=Qb.workbookContext.WebExtensions)||void 0===Fa?0:Fa.length){Fa=Qb.workbookContext.WebExtensions;Qb=!1;for(var cc={},bc=Fa.length-
1;0<=bc;cc={wPb:cc.wPb},bc--){if(!this.ea.isNamedObjectViewMode){this.xoc.push(Fa[bc].InstanceId);if(1!==Fa[bc].WebExtensionType){Array.removeAt(Fa,bc);continue}if(Va.HelperMethods.fw(Fa[bc])&&0!==Fa[bc].SharedRuntime.State)1===Fa[bc].SharedRuntime.State?Fa[bc].TaskpaneVisible=!1:2===Fa[bc].SharedRuntime.State?Fa[bc].TaskpaneVisible=!0:ua.ULS.sendTraceTag(537170519,0,10,"The sharedRuntime state is invalid");else if(!Fa[bc].ContainsCustomFunctions&&!Fa[bc].TaskpaneVisible&&!Vb.a(Fa[bc])){Array.removeAt(Fa,
bc);continue}}var Mc=OSF.OsfControl.isFirstPartyStoreString(Fa[bc].PrimaryMarketplace.MarketplaceType);pa.EwaSettings.ma(187)&&!Mc&&(Array.removeAt(Fa,bc),Qb||(Qb=!0,cc.wPb=Aa.GetServiceTaskFactory.Ra(this.$.da,5,4,3),jb.TaskExtensions.Aa(cc.wPb,function(rd){return function(){rd.wPb.result.Tf(35,null)}}(cc),this.la,3)));pa.EwaSettings.isChangeGateEnabled("OfficeVSO:3937070_RemoveChartTaskPaneExtensionDuringLoad")&&Fa[bc].PrimaryMarketplace&&a.FLa(Fa[bc].PrimaryMarketplace.SolutionId)&&(ua.ULS.sendTraceTag(537170518,
0,50,"chart task pane info stored in workbook context webextensions"),Array.removeAt(Fa,bc))}this.KBe(Fa)}}else this.kSc=!1;this.dPb=!0}};a.prototype.N3e=function(Fa){var Qb=Qa.g(this.$),cc=Qb.ha.Oa.Yb;if(cc&&Fa){Fa=!1;if(this.pf)for(var bc=bk(this.pf),Mc=bc.next();!Mc.done;Mc=bc.next())if(Mc=Mc.value,a.FLa(Mc.gU)||a.bii(Mc.gU)){Fa=!0;break}Fa||Qb.ha.Oa.NG(cc)}};a.prototype.ENi=function(){this.Qh&&this.ea.isNamedObjectViewMode&&this.$.pa&&Ie.o(this.$.pa)&&(this.$.da.za(34).JQ?this.$.da.za(34).Dkd():
this.$.da.za(34).yu(this.ATi))};a.prototype.KBe=function(Fa){var Qb=this,cc=null;cc=function(rd){function Hd(){Qb.TOa.shift();0<Qb.TOa.length&&cc(Qb.TOa[0])}var ic=rd.WebExtensionData,Jc=rd.IsTaskPane,zd=rd.RecordHandler;if(Qb.saa(ic.PrimaryMarketplace.SolutionId))Hd();else{Jc&&(ic.WebExtensionOsfControlType=1);var sd=Vb.a(ic);if(!Jc||ic.TaskpaneVisible||sd||ic.SharedRuntime&&0!==ic.SharedRuntime.State||ic.ContainsCustomFunctions){var Pd=new I(Qb,Qb.Sh,ic,!Jc);ua.ULS.sendTraceTag(537170517,0,50,"DdaFacade::CreateAllOsfControls: SolutionId: {0}, StoreType: {1}, UseShareRuntime: {2}",
Telemetry.PrivacyRules.GetPrivacyCompliantId(ic.PrimaryMarketplace.SolutionId,ic.PrimaryMarketplace.MarketplaceType,null,null,null,ic.PrimaryMarketplace.MarketplaceRef),ic.PrimaryMarketplace.MarketplaceType,Va.HelperMethods.fw(ic));Pd.qkd();Va.HelperMethods.fw(ic)&&(Pd.QHa=a.Fua(ic,Qb.$),ic.TaskpaneWidth=Qb.N5b);sd&&(ic.WebExtensionToolTip="");Jc&&ic.TaskpaneVisible&&!sd&&(ic.TaskpaneWidth=Qb.N5b);Qb.pf.push(Pd);var De=Qb.cxa=null;De=ad.a.instance.nE(function(){Pd.cy&&(Fb.a.Ia(De),De=null,zd&&zd(rd,
Pd),Hd())},100,Yd.a.lbh)}else Hd()}};for(var bc={},Mc=0;Mc<Fa.length;bc={a1:bc.a1},Mc++)if(!this.Tm(Fa[Mc].InstanceId))if(1!==Fa[Mc].WebExtensionType)this.n0a(Fa[Mc]);else if(!pa.EwaSettings.ma(54))this.jmb(Fa[Mc],cc);else if(this.$.Cd&8388608||Fa[Mc].TaskpaneVisible)bc.a1={},bc.a1.marketplaceId=Fa[Mc].PrimaryMarketplace.SolutionId,bc.a1.marketplaceVersion=Fa[Mc].PrimaryMarketplace.SolutionVersion,bc.a1.storeType=Fa[Mc].PrimaryMarketplace.MarketplaceType,bc.a1.storeId=Fa[Mc].PrimaryMarketplace.MarketplaceRef,
bc.a1.targetData=Fa[Mc],this.Qh.isAddinCommandsAsync(bc.a1,function(rd){return function(Hd,ic,Jc){if(Hd){var zd=Jc.targetData;if(ic){if(pa.EwaSettings.ma(88))if(rd.a1.storeType.toLowerCase()!==OSF.StoreType.OMEX.toLowerCase())Hd=rd.a1.storeType.toLowerCase()===OSF.StoreType.UploadFileDevCatalog.toLowerCase(),ic=rd.a1.storeType.toLowerCase()===OSF.StoreType.PrivateCatalog.toLowerCase(),(Hd||ic)&&Va.HelperMethods.fw(zd)&&Qb.jmb(zd,cc);else if(pa.EwaSettings.isChangeGateEnabled("OfficeVSO:4484894_FixBackgroundAppNotLoadForUploadFileCatalog"))Qb.D2h(Jc,
cc);else{var sd=!1;Qb.Oca(function(Pd){if(!Pd.errorCode){if(Pd.value){Pd=bk(Pd.value);for(var De=Pd.next();!De.done&&!sd;De=Pd.next())sd=fd.e(De.value[1])===fd.e(zd.PrimaryMarketplace.SolutionId)}sd?Va.HelperMethods.fw(zd)&&Qb.jmb(zd,cc):(Pd={},Pd.SolutionId=Jc.marketplaceId,Pd.TargetType=zd.WebExtensionType,Pd.Version=Jc.marketplaceVersion,Pd.StoreType=zd.PrimaryMarketplace.MarketplaceType,Pd.StoreId=Jc.storeId,Pd.AssetId=Jc.marketplaceId,Pd.AssetStoreId=Jc.storeId,Pd.Width=zd.TaskpaneWidth,zd.TaskpaneVisible=
!0,Qb.Wie(Pd,zd,cc))}},!0)}}else Qb.jmb(zd,cc)}else Hd=Jc.targetData,ua.ULS.sendTraceTag(542185164,220,15,"Judging AddinCommands failed for {0} from {1} during document loading",Telemetry.PrivacyRules.GetPrivacyCompliantId(Hd.PrimaryMarketplace.SolutionId,Hd.PrimaryMarketplace.MarketplaceType,null,null,null,Hd.PrimaryMarketplace.MarketplaceRef),Hd.PrimaryMarketplace.MarketplaceType)}}(bc))};a.prototype.D2h=function(Fa,Qb){var cc=this,bc=!1;this.Oca(function(Mc){var rd=Fa.targetData;if(!Mc.errorCode){if(Mc.value){Mc=
bk(Mc.value);for(var Hd=Mc.next();!Hd.done&&!bc;Hd=Mc.next())bc=fd.e(Hd.value[1])===fd.e(rd.PrimaryMarketplace.SolutionId)}bc?Va.HelperMethods.fw(rd)&&cc.jmb(rd,Qb):(Mc={},Mc.SolutionId=Fa.marketplaceId,Mc.TargetType=rd.WebExtensionType,Mc.Version=Fa.marketplaceVersion,Mc.StoreType=rd.PrimaryMarketplace.MarketplaceType,Mc.StoreId=Fa.storeId,Mc.AssetId=Fa.marketplaceId,Mc.AssetStoreId=Fa.storeId,Mc.Width=rd.TaskpaneWidth,rd.TaskpaneVisible=!0,cc.Wie(Mc,rd,Qb))}},!0)};a.prototype.jmb=function(Fa,Qb){var cc=
{};cc.WebExtensionData=Fa;cc.IsTaskPane=!0;this.TOa.push(cc);1===this.TOa.length&&Qb(cc)};a.prototype.Wie=function(Fa,Qb,cc){var bc=this,Mc={};Mc.ActivationInfo=Fa;Mc.WebExtensionData=Qb;Mc.IsTaskPane=!1;Mc.RecordHandler=function(rd,Hd){var ic=rd.ActivationInfo;bc.Qh.insertBlankControlWithErrorUX(bc.kGb(Hd,ic),function(){bc.QPa(Hd.controlId);bc.Qh.purgeOsfControl(Hd.controlId,!1);bc.Q9f(ic)})};this.TOa.push(Mc);1===this.TOa.length&&cc(Mc)};a.prototype.Q9f=function(Fa){var Qb={};Qb.solutionId=Fa.SolutionId;
Qb.version=Fa.Version;Qb.storeType=Fa.StoreType;Qb.storeId=Fa.StoreId;Qb.assetId=Fa.AssetId;Qb.assetStoreId=Fa.AssetStoreId;Qb.targetType=Fa.TargetType;Qb.sharedRuntimeId=Fa.SharedRuntimeId;Fa=new ec.a;Fa.add(Qb);Qb={};Qb[Ha.a.knb]=Fa;Qb[Ha.a.mP]=3;Fa=new kc.a(td.a.mBb,0,this.$.Jc,0,null);this.$.Ka.Kb(Fa,Qb)};a.prototype.kGb=function(Fa,Qb){var cc={};cc.div=Fa.cy;cc.id=Fa.controlId;cc.solutionId=Qb.SolutionId;cc.version=Qb.Version;cc.storeId=Qb.StoreId;cc.storeType=Qb.StoreType;cc.osfControlType=
OSF.OsfControlTarget.TaskPane;return cc};a.prototype.gSf=function(){var Fa=this;if(pa.EwaSettings.isChangeGateEnabled("OfficeVSO:3935411_RemoveOsfControlsAferSilentReload")){for(var Qb=[],cc=0;cc<this.pf.length;cc++){var bc=this.pf[cc];0!==bc.osfControlType&&3!==bc.osfControlType&&4!==bc.osfControlType||Qb.push(bc)}cc=!1;for(bc=0;bc<Qb.length;bc++){var Mc=Qb[bc];this.QPa(Mc.controlId);!cc&&Mc&&Mc.dl&&(cc=Va.HelperMethods.fw(Mc.dl))}cc&&(Qb={},Qb=(Qb.DynamicAddinCommandsMethodDispatchId=4,Qb),this.SJ(-1014260128,
Qb))}pa.EwaSettings.ma(402)&&jb.TaskExtensions.Aa(Aa.GetServiceTaskFactory.Ra(this.$.da,278,279,3),function(rd){rd&&(rd=rd.result)&&(Fa.$.da.za(278)||Fa.$.da.Ga(278,rd),rd.g$e().Wma())},this.la,3)};a.prototype.HK=function(){var Fa=this,Qb=new l(this.$,this.Ri,this.gTf);void 0===this.$||null===this.$?ua.ULS.sendTraceTag(537170514,0,50,"VSO#2693929: ResetStateForWorkbookReload is called. EwaControl is null"):pa.EwaSettings.ma(260)&&ua.ULS.sendTraceTag(537170513,0,50,"VSO#2693929: ResetStateForWorkbookReload is called. RichAPiEventRegistration is null: "+
(void 0===this.Ri||null===this.Ri));if(Qb.gCi()){var cc=function(){},bc=function(Hd){Hd=Jd.a.Mf(Hd.data);ua.ULS.sendTraceTag(537170511,0,10,"ResetStateForWorkbookReload: Failed to recreate event registration information. Errors: {0}.",cf.a.Ec(Hd))},Mc=Qb.PQg();Qb=function(Hd,ic,Jc){return qd.g(Fa.$.oa.xa,"ExecuteRichApiRequest",Fa.QQg(Mc),Sb.b(Hd,cc),Sb.a(ic,bc),Jc,null,0)};var rd=a.Ced(Mc);pa.EwaSettings.Zb()?this.$.userOperationManager.Ot(new Bc.a(507,0,Qb,rd|64)):this.$.userOperationManager.Ot(new af.a(507,
0,Qb,rd))}};a.prototype.QQg=function(Fa){var Qb=this.$.oa.xa.Na(1);Qb.request=Fa;return Qb};a.prototype.Pwe=function(Fa,Qb){if(Fa)for(var cc=0;cc<Fa.length;cc++)if(nc.a.equals(Fa[cc],Qb,!0))return!0;return!1};a.prototype.TPg=function(Fa){var Qb={};Qb.navigationMode=OSF.OsfNavigationMode.DefaultMode;Qb.assetId=null;Qb.category=null;if(!Fa||3>Fa.length)return Qb;if(Fa[0]){var cc=parseInt(Fa[0],10);isNaN(parseInt(cc,10))||(Qb.navigationMode=cc)}Fa[1]&&(Qb.assetId=Fa[1]);Fa[2]&&(Qb.category=Fa[2]);return Qb};
a.prototype.b$h=function(){if(pa.EwaSettings.ma(62)){var Fa=this.$.workbookContext.FullDocumentInfo.EmbeddingPageOrigin;if(Fa&&"*"!==Fa.trim()){this.xIa=OsfRuntime.Embedded.createOrReplaceEmbeddingEndpoint(new T(this),Fa,this.$.workbookContext.FullDocumentInfo.EmbeddingPageSessionInfo,this.$.Jf.get(2));try{this.xIa.init()}catch(Qb){try{this.xIa.dispose()}catch(cc){}this.xIa=null;ua.ULS.sendTraceTag(537170510,0,10,"EmbeddingEnpoint failed to initialize. Error message: "+Qb.message)}Fa={};Fa.a=this.$.ya.UserSessionId;
Xb.b().Ce(39,Fa)}}};a.prototype.S1f=function(Fa,Qb,cc){var bc=this,Mc=a.fPg(Fa[0]),rd=Mc.lha,Hd=Mc.bia;Mc.lha=function(){rd&&rd();var ic=Mc.iLa!==OSF.InfoType.Error?Qb:null;Fa.shift();Fa.length?bc.S1f(Fa,ic,cc):ic&&ic()};Mc.bia=function(){Hd&&Hd();cc&&Mc.iLa!==OSF.InfoType.Error&&cc()};Ia.a.GQd(Mc)};a.prototype.tPh=function(){var Fa={};Fa.AddinRibbonControlsOverriddenByApi=pa.EwaSettings.isChangeGateEnabled("OfficeVSO:4373039_AddinRibbonControlsOverriddenByApi").toString();Fa.AddinActionDefinitionHybridMode=
pa.EwaSettings.ma(642).toString();Fa.UseActionIdForUILessCommand=pa.EwaSettings.ma(645).toString();Fa.AllowStorageAccessByUserActivationOnIFrame=pa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.AllowStorageAccessByUserActivationOnIFrame",!1).toString();Fa.RequirementSetRibbonApiOnePointTwo=pa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.RequirementSetRibbonApiOnePointTwo",!1).toString();Fa.flightingTreatmentVariables=ra.AFrameworkApplication.fa.O9b;Fa.ShortcutInfoArrayInUserPreferenceData=
pa.EwaSettings.isChangeGateEnabled("OfficeVSO:5232658_ShortcutInfoArrayInUserPreferenceData").toString();return Fa};a.getSolutionId=function(Fa){var Qb=Fa.PrimaryMarketplace.SolutionId;pa.EwaSettings.ma(294)&&Fa.OwnerAddinSolutionId&&(Qb=Fa.OwnerAddinSolutionId);return Qb};a.Ced=function(Fa){var Qb=0;pa.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")?Fa.RequestFlags&1&&256!==(Fa.RequestFlags&256)||(Qb=16):Qb=Fa.RequestFlags&1?0:16;return Qb};a.Fua=function(Fa,
Qb){Qb=a.getSolutionId(Fa,Qb);return a.kXe(Qb,Fa.PrimaryMarketplace.SolutionVersion,Fa.PrimaryMarketplace.MarketplaceType,Fa.PrimaryMarketplace.MarketplaceRef)};a.P8g=function(Fa){var Qb={};Fa=(Qb.recording=Fa,Qb);return JSON.stringify(Fa)};a.i4g=function(Fa){var Qb={};Qb.visibility=Fa?"Visible":"Hidden";return JSON.stringify(Qb)};a.ALh=function(Fa){var Qb=Fa.getSolutionId(),cc=Fa.getVersion(),bc=Fa.getStoreType();Fa=Fa.getStoreId();return a.kXe(Qb,cc,bc,Fa)};a.kXe=function(Fa,Qb,cc,bc){return String.format("{0}|{1}|{2}|{3}|{4}|||",
"2",Fa,Qb,a.xXh(cc).toString(),bc)};a.vgd=function(Fa,Qb){var cc=Fa.split("|");if(7>cc.length)return ua.ULS.sendTraceTag(537170509,0,10,"DdaEventDispatch.GetWebExtensionDataFromAddinId: Unexpected customFunctionAddinId."),null;if("2"!==cc[0])return ua.ULS.sendTraceTag(537170508,0,10,"DdaEventDispatch.GetWebExtensionDataFromAddinId: Unexpected format='{0}'.",cc[0]),null;var bc=cc[1],Mc=cc[2],rd=a.yXh(cc[3]),Hd=cc[4];cc=cc[5];bc&&bc.length||(bc=cc);cc={};cc.InstanceId=String.format("{{{0}}}",ia.a.create().toString());
cc.WebExtensionOsfControlType=4;cc.WebExtensionType=1;cc.PrimaryMarketplace={};cc.PrimaryMarketplace.SolutionId=bc;cc.PrimaryMarketplace.SolutionVersion=Mc;cc.PrimaryMarketplace.MarketplaceRef=Hd;cc.PrimaryMarketplace.MarketplaceType=rd;cc.ContainsCustomFunctions=Qb?!0:!1;Qb&&(cc.OsfPropertyBag=[["customFunctionAddinId",Fa]]);return cc};a.yXh=function(Fa){Fa=parseInt(Fa,10);return Fa===OSF.StoreTypeEnum.MarketPlace?OSF.StoreType.OMEX:Fa===OSF.StoreTypeEnum.Catalog?OSF.StoreType.SPCatalog:Fa===OSF.StoreTypeEnum.SPApp?
OSF.StoreType.SPApp:Fa===OSF.StoreTypeEnum.Exchange?OSF.StoreType.Exchange:Fa===OSF.StoreTypeEnum.FileSystem?OSF.StoreType.FileSystem:Fa===OSF.StoreTypeEnum.Registry?OSF.StoreType.Registry:Fa===OSF.StoreTypeEnum.PrivateCatalog?OSF.StoreType.PrivateCatalog:Fa===OSF.StoreTypeEnum.HardCodedPreinstall?OSF.StoreType.HardCodedPreinstall:Fa===OSF.StoreTypeEnum.FirstParty?OSF.StoreType.FirstParty:Fa===OSF.StoreTypeEnum.UploadFileDevCatalog?OSF.StoreType.UploadFileDevCatalog:Fa===OSF.StoreTypeEnum.WopiCatalog?
OSF.StoreType.WopiCatalog:null};a.xXh=function(Fa){return Fa===OSF.StoreType.OMEX?OSF.StoreTypeEnum.MarketPlace:Fa===OSF.StoreType.SPCatalog?OSF.StoreTypeEnum.Catalog:Fa===OSF.StoreType.SPApp?OSF.StoreTypeEnum.SPApp:Fa===OSF.StoreType.Exchange?OSF.StoreTypeEnum.Exchange:Fa===OSF.StoreType.FileSystem?OSF.StoreTypeEnum.FileSystem:Fa===OSF.StoreType.Registry?OSF.StoreTypeEnum.Registry:Fa===OSF.StoreType.PrivateCatalog?OSF.StoreTypeEnum.PrivateCatalog:Fa===OSF.StoreType.HardCodedPreinstall?OSF.StoreTypeEnum.HardCodedPreinstall:
Fa===OSF.StoreType.FirstParty?OSF.StoreTypeEnum.FirstParty:Fa===OSF.StoreType.UploadFileDevCatalog?OSF.StoreTypeEnum.UploadFileDevCatalog:Fa===OSF.StoreType.WopiCatalog?OSF.StoreTypeEnum.WopiCatalog:-1};a.nrb=function(Fa){var Qb={};Qb.Version=Fa.version;Qb.AssetId=Fa.assetId;Qb.AssetStoreId=null!==Fa.assetStoreId?Fa.assetStoreId.toString():null;Qb.StoreType=Fa.storeType;Qb.Height=Fa.height;Qb.SolutionId=Fa.solutionId;Qb.StoreId=Fa.storeId;Qb.TargetType=Fa.targetType;Qb.Width=1===Qb.TargetType?0:Fa.width;
Qb.SharedRuntimeId=Fa.sharedRuntimeId;return Qb};a.Oyb=function(Fa){return Fa===OSF.DDA.EventDispId.dispidSettingsChangedEvent||Fa===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent||Fa===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||Fa===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||Fa===OSF.DDA.EventDispId.dispidRichApiMessageEvent||Fa===OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent||Fa===OSF.DDA.EventDispId.dispidDialogNotificationShownInAddinEvent||Fa===OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent};
a.fPg=function(Fa){return Object(va.a)(new Tc.a,{iLa:Fa.infoType,id:Fa.id,title:Fa.title,description:Fa.description,buttonText:Fa.buttonTxt,lha:Fa.buttonCallback,Gdc:Fa.highPriority,bia:Fa.dismissCallback,errorCode:Fa.errorCode,i8e:Fa.iframeNotificationUrl})};a.FLa=function(Fa){var Qb="FA000000014"===Fa;Qb||(Qb="907DD90F-A82F-4BBF-B4F2-FCD4868A5E14ButtonId1"===Fa);return Qb};a.bii=function(Fa){return"FA000000005"===Fa};Mf.Object.defineProperties(a.prototype,{K_b:{configurable:!0,enumerable:!0,get:function(){return this.Mea||
(this.Mea=new ib.a(this.$.Ov))}},Qh:{configurable:!0,enumerable:!0,get:function(){if(!this.Lm){var Fa={},Qb=!(this.$.Cd&1),cc=Rb.a.current.CN,bc=this.$.workbookContext,Mc=La.a.bL+La.a.V2b;Fa.pageBaseUrl=cc.LayoutsContentUrlPrefix;Fa.appName=OSF.AppName.ExcelWebApp;Fa.appVersion="16";Fa.appSettings=this.tPh();Fa.singleSignOnSettings=za.AppsForOfficeSingleSignOnManager.bXh();Fa.clientMode=Qb?OSF.ClientMode.ReadOnly:OSF.ClientMode.ReadWrite;Fa.appUILocale=this.$.ya.UICultureTag;Fa.dataLocale=this.$.ya.DataCultureTag;
Fa.docUrl=bc.ClientUrl;Fa.hostControl=this;Fa.formFactor=OSF.FormFactor.Default;Fa.lcid=this.$.aG.toString();Fa.localizedScriptsUrl=La.a.bL+La.a.a1c;Fa.localizedImagesUrl=Mc;Fa.localizedStylesUrl=La.a.bL+La.a.Lze;Fa.localizedResourcesUrl=Mc;Fa.osfOmexBaseUrl=cc.OsfOmexBaseUrl;Fa.firstPartyManifestCDNUrl=cc.FirstPartyAddInManifestCDN;Fa.sdxAssetsToPrefetchMapping=ra.AFrameworkApplication.fa.Wa("SdxAssetsToPrefetchMapping");Fa.sdxCdnUrl=cc.SdxCdnUrl;Fa.sdxDmsUrl=cc.SdxDmsUrl;Fa.devCatalogUrl=cc.DevCatalogUrl;
Fa.controlStatusChanged=this.vnc;Fa.notifyHost=this.kzf;Fa.allowExternalMarketplace=this.$.ea.Jg.get(27)&&a.J1c;Fa.enableAddinCommands=pa.EwaSettings.ma(54);Fa.enableBlackForestRedirect=pa.EwaSettings.ma(89);Fa.enableMyOrg=this.$.ea.Jg.get(33);Fa.enableMyApps=this.$.ea.Jg.get(34);Fa.enableDevCatalog=pa.EwaSettings.ma(45);Fa.enablePrivateCatalog=this.Svj();Fa.enableTaskpaneUpgradeToAppCommand=pa.EwaSettings.ma(94);Fa.showSignOutFromPrivateCatalogMessage=this.$.ea.Jg.get(36);Fa.enableUploadFileDevCatalog=
pa.EwaSettings.ma(54)&&!pa.EwaSettings.ma(283);Fa.userNameHashCode=na.a.Kv(ra.AFrameworkApplication.userName);Fa.envCode=this.$.ya.OfficeAddinTelemetryDataSourceCode.toString();Fa.enableSingleSignOnForAddin=!pa.EwaSettings.ma(24)&&ra.AFrameworkApplication.isAppsForOfficeSingleSignOnSupportedOnHost;Fa.enableDisplayBlockedMinorError=pa.EwaSettings.ma(184);Fa.hideAppsExtensionUrl=ra.AFrameworkApplication.hideAppsExtensionUrl;Fa.enableAnonymousUseLegacyCatalogService=pa.EwaSettings.ma(174);Fa.enableInsertDialogAccessibilityFix=
pa.EwaSettings.ma(181);Fa.disableAppsForOfficeThirdParty=pa.EwaSettings.ma(187);Fa.enableFirstPartySSO=pa.EwaSettings.ma(199);Fa.wacSessionId=this.$.ya.UserSessionId;Fa.disableLogging=!this.$.ya.AriaLoggingIsEnabled;Fa.enableFirstPartySDXErrorMessages=pa.EwaSettings.ma(212);Fa.enableRichApiCellEditDelay=pa.EwaSettings.ma(191);Fa.isHostDocumentDomain=pa.EwaSettings.ma(227);Fa.loggableUserId=ra.AFrameworkApplication.fa.Wa("LoggableUserId");Fa.sessionStartInfoJson=ra.AFrameworkApplication.fa.Wa("SessionStartInfoJson");
Fa.wopiHostOriginFromPostMessage=ra.AFrameworkApplication.wopiHostOriginFromPostMessage;Fa.wopiHostOriginFromWacPropBag=ra.AFrameworkApplication.fa.Wa("PostMessageOrigin");Fa.wacIsEmbedded=ra.AFrameworkApplication.fa.qa("IsEmbedded");Fa.accessibilityAllowFocusAddinTaskpane=ra.AFrameworkApplication.fa.qa("AccessibilityAllowFocusAddinTaskpane");Fa.enableRemoveAppCommandsAddin=ra.AFrameworkApplication.fa.qa("RemoveAppCommandsAddinIsEnabled");Fa.isHostFrameTrustCheckEnabledForAddIns=ra.AFrameworkApplication.fa.qa("HostFrameTrustCheckIsEnabledForAddIns");
Fa.isHostFrameTrusted=ra.AFrameworkApplication.isHostFrameTrusted;Fa.agaveAddinUploadEnabled=pa.EwaSettings.ma(47);Fa.hostAllowedOfficeStore=ra.AFrameworkApplication.fa.qa("HostAllowedOfficeStore");Fa.hostAllowedSdxEmbedding=ra.AFrameworkApplication.fa.qa("HostAllowedSdxEmbedding");Fa.hostInstallAddIns=ra.AFrameworkApplication.fa.Wa("HostInstallAddIns");Fa.hostInstallAddInsIsEnabled=ra.AFrameworkApplication.fa.qa("HostInstallAddInsIsEnabled");Fa.approvedAddIns=ra.AFrameworkApplication.fa.Wa("ApprovedAddIns");
Fa.addinEnforceHttpsIsEnabled=this.avj(Fa.sessionStartInfoJson);Fa.hostFeatureGateFlag=0;Fa.isUpnCheckEnabled=ra.AFrameworkApplication.fa.qa("IsUpnCheckEnabled");Fa.wacUpn=ra.AFrameworkApplication.fa.Wa("UserPrincipalName");Fa.isReactRibbonEnabled=Zb.a.isReactRibbonEnabled();Fa.enableSetFocusOnTaskpaneOnUserAction=pa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.SetFocusOnTaskpaneOnUserActionIsEnabled",!1);Fa.isSafariWithIndexedDBDisabled=pa.EwaSettings.isChangeGateEnabled("OfficeVSO:5280064_IDBBuggedInSafari")&&
Ka.a.nMa;Fa.isIndexedDBDisabled=pa.EwaSettings.isChangeGateEnabled("OfficeVSO:5280064_IDBBuggedInSafari")&&Ka.a.nMa||pa.EwaSettings.isChangeGateEnabled("OfficeVSO:5735286_IDBBuggedInFirefox")&&Ka.a.Nf;Fa.enableCustomShortcuts=pa.EwaSettings.isChangeGateEnabled("OfficeVSO:5325526_EnableCustomShortcuts");Fa.changeGetModifierKeyStringOutputOrder=pa.EwaSettings.isChangeGateEnabled("OfficeVSO:5426302_ChangeGetModifierKeyStringOutputOrder");Fa.officeJsUrl=ra.AFrameworkApplication.NK("OfficeJs/excel.js",
5);Fa.enableOfficeJsUrlParam=pa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnableOfficeJsUrlParam",!1);this.Lm=new OSF.ContextActivationManager(Fa);Fa={};this.Lm.setIframeAttributeBag((Fa.frameborder=0,Fa.marginheight=0,Fa.marginwidth=0,Fa));this.Lm.setWSA(ra.AFrameworkApplication.Hm);this.Lm&&"undefined"!==typeof this.Lm.hostCheckReadyHandler&&ra.AFrameworkApplication.QEg(Object(aa.a)(this.Lm,this.Lm.hostCheckReadyHandler,"hostCheckReadyHandler"));try{var rd=zb.a.instance.resolve("Common.App.OAuth.IOAuthManager");
this.Lm.setOAuthManager(rd)}catch(Hd){}}return this.Lm}},qWj:{configurable:!0,enumerable:!0,get:function(){return this.kSc}},Ri:{configurable:!0,enumerable:!0,get:function(){return this.cee}},Tma:{configurable:!0,enumerable:!0,get:function(){return this.$de}},XKd:{configurable:!0,enumerable:!0,get:function(){return this.dee}},WKd:{configurable:!0,enumerable:!0,get:function(){return this.bee}},zhj:{configurable:!0,enumerable:!0,get:function(){return this.fee}},xhj:{configurable:!0,enumerable:!0,get:function(){return this.aee}},
yhj:{configurable:!0,enumerable:!0,get:function(){return this.eee}},Ahj:{configurable:!0,enumerable:!0,get:function(){return this.gee}},Bhj:{configurable:!0,enumerable:!0,get:function(){return this.hee}},YKd:{configurable:!0,enumerable:!0,get:function(){return this.iee}},jV:{configurable:!0,enumerable:!0,get:function(){return this.Vpg}},$:{configurable:!0,enumerable:!0,get:function(){return this.jb}}});Mf.Object.defineProperties(a,{J1c:{configurable:!0,enumerable:!0,get:function(){return a.Y2d},set:function(Fa){a.Y2d=
Fa}}});a.H0a=new ta.a;a.Y2d=!0;Object(ja.a)(a,"DdaFacade",Ob.a,[473,855,793,856,857,3])},950:function(u,E,b){function a(){this.kHd=0;this.qW={};this.Nsa={}}b.d(E,"a",function(){return a});u=b(0);var c=b(14),d=b(113);a.prototype.MSh=function(e,k){return this.qW[a.ZXc(e,k)]};a.prototype.VJe=function(e,k){k||void 0!==this.Nsa[e]&&null!==this.Nsa[e]?k&&void 0!==this.Nsa[e]&&null!==this.Nsa[e]&&delete this.Nsa[e]:this.Nsa[e]=1};a.prototype.B_b=function(e){return void 0===this.Nsa[e]||null===this.Nsa[e]};
a.prototype.G1h=function(e){var k=a.ZXc(e.messageType,e.targetId);1===e.actionType?this.c3h(e.controlId,e.messageType,k):2===e.actionType&&this.N3h(e.controlId,e.messageType,k)};a.prototype.F9i=function(e){if(e){var k=Object.keys(this.qW);if(!(void 0===k||null===k||0>=k.length)){k=bk(k);for(var l=k.next();!l.done;l=k.next()){l=l.value;var n=this.qW[l];n[e]&&(delete n[e],Object.keys(n).length||delete this.qW[l])}}}};a.prototype.RZ=function(e,k){e=a.ZXc(e,k);e=this.qW[e];return!!e&&0<Object.keys(e).length};
a.prototype.C4h=function(){return!d.a.isEmpty(this.qW)};a.prototype.qgf=function(){return 0<this.kHd};a.prototype.kNh=function(){var e=[],k=this.qW,l;for(l in k){var n=l,f=k[l],v;for(v in f){f=v;var r={};r.eventType=parseInt(n.split("#")[0],10);r.targetId=n.split("#")[1];r.addinId=f;e.push(r)}}return e};a.prototype.c3h=function(e,k,l){if(this.qW[l])l=this.qW[l],l[e]=l[e]?l[e]+1:1;else{var n={};n[e]=1;this.qW[l]=n}100===k&&this.kHd++};a.prototype.N3h=function(e,k,l){if(this.qW[l]){var n=this.qW[l];
if(e){var f=n[e];1===f?(delete n[e],Object.keys(n).length||delete this.qW[l]):n[e]=f-1;100===k&&this.kHd--}else c.ULS.sendTraceTag(537170459,0,50,"The OsfControl[{0}] doesn't register event with key[{1}].",e,l)}else c.ULS.sendTraceTag(537170460,0,50,"The event with key[{0}] that will be unregistered doesn't exist.",l)};a.ZXc=function(e,k){return String.format("{0}#{1}",e,k)};a.GW="Workbook";Object(u.a)(a,"RichApiEventRegistration",null,[])},976:function(u,E,b){function a(c,d,e,k){this.ddaBinding=
null;this.dispid=0;this.ArrayData=this.controlId=null;this.dispid=c;this.controlId=d;this.ddaBinding=e;this.ArrayData=void 0===k?null:k}b.d(E,"a",function(){return a});u=b(0);a.prototype.getDispid=function(){return this.dispid};a.prototype.getDdaBinding=function(){return this.ddaBinding};Object(u.a)(a,"DdaEventArgs",null,[])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.agave.js.map/f6102dce8dff6b539a40dbaea6d0104b/EwaDS.agave.js.map