(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[58],{1628:function(u,E,b){function a($a){var $b=Ug.call(this)||this;$b.$=$a;$b.Eb();return $b}function c(){}function d($a){var $b=nh.call(this)||this;$b.gi=null;$b.Wg=null;$b.$=$a;$b.Eb();return $b}function e($a,$b,wc){var Sc=Tg.call(this,$a)||this;Sc.de=null;Sc.zye=null;Sc.lp=!1;Sc.ju=0;Sc.Fc=function(yc,Dd){Dd.jg||Sc.Zf(!1)};Sc.Qj=function(){Sc.Zf(!1);Sc.raiseEvent("PQTPC");return!0};Sc.$=$b;Sc.taskPaneManager=wc;Ic.a($b).Lh(Sc);
Sc.$.Bk(Sc.Fc);return Sc}function k(){}function l($a){return lg.call(this,$a)||this}function n($a,$b){this.Ipc=null;this.$=$a;this.BZi=$b}function f($a,$b){var wc=this;this.Hpc=this.lma=this.Xyc=this.powerQueryTaskPane=null;this.JGf=this.zEf=this.yf=!1;this.onQuerySelected=function(Sc){if(dd.EwaSettings.isChangeGateEnabled("OfficeVSO:5138260_ActivateQueryTargetWhenQuerySelected"))for(var yc=bk(wc.powerQueryManager.queries),Dd=yc.next();!Dd.done;Dd=yc.next())if(Dd=Dd.value,Dd.FillObjectName&&Dd.Name===
Sc){3!==Dd.FillObjectType&&2!==Dd.FillObjectType||Pd.a.contains(Dd.FillObjectName,"!",!0)||Mb.ULS.sendTraceTag(537154438,0,15,"PowerQueryPaneManager.OnQuerySelected: Selection Query of type : {0} and no ! on FillObjectName",Zf[Dd.FillObjectType]);3===Dd.FillObjectType?(Sc=Dd.PivotChartSheetRange,Sc.SheetName=Dd.FillObjectName.split("!")[0],yc=Dd.FillObjectName.split("!")[1],Pb.g(wc.$).ha.Oa.vsa(Sc,yc,0).continueWith(function(Sd){Sd.result||Mb.ULS.sendTraceTag(537154437,0,15,"PowerQueryPaneManager.OnQuerySelected: Selection of PivotChart Failed")})):
(Sc=2===Dd.FillObjectType?Dd.FillObjectName.split("!")[1]:Dd.FillObjectName,(Sc=wc.$.vb.getItemByName(Sc))&&Sc.activate());break}};this.FEb=function(){wc.hideTaskPane();dd.EwaSettings.isChangeGateEnabled("OfficeVSO:5138260_ActivateQueryTargetWhenQuerySelected")&&wc.$.vb.vg(wc.oe)};this.onCancelQueryRefresh=function(Sc){wc.powerQueryManager.uUg(Sc)&&wc.lma.G5f([Sc])};this.onQueryRefresh=function(Sc){wc.powerQueryManager.EGd(Sc)};this.Yod=function(Sc){return wc.powerQueryManager.zK.kb(Sc)};this.Jwf=
function(){wc.tLi()};this.oe=function(Sc,yc){yc.pa&&2===yc.pa.type&&wc.ZTd.kb(yc.pa.name)&&wc.updateTaskPane(null,null,wc.ZTd.getItem(yc.pa.name))};this.mAf=function(Sc,yc){Sc=[];for(var Dd=bk(wc.powerQueryManager.zK.values),Sd=Dd.next();!Sd.done;Sd=Dd.next())if(Sd=Sd.value,yc===Sd.ConnectionName&&(Sd=Sd.QueryName,wc.powerQueryManager.qhc(Sd))){Array.add(Sc,Sd);break}wc.lma.X4f(Sc)};this.rOa=function(Sc,yc){if(yc&&yc.Result){Sc=dd.EwaSettings.isChangeGateEnabled("OfficeVSO:6635492_ChangeRefreshResult")?
yc.Result.ConnectionName:yc.Result;yc=[];for(var Dd=bk(wc.powerQueryManager.zK.values),Sd=Dd.next();!Sd.done;Sd=Dd.next())if(Sd=Sd.value,Sc===Sd.ConnectionName&&(Sd=Sd.QueryName,wc.powerQueryManager.qhc(Sd))){Array.add(yc,Sd);break}wc.lma.G5f(yc)}};this.$=$a;this.powerQueryManager=$b;this.ZTd=new Dc.a(!0);this.cai($a);pe.a(this.$).QUc(this.rOa);pe.a(this.$).rne(this.mAf);this.powerQueryManager.TGg(this.Jwf);Mb.ULS.sendTraceTag(542228699,0,15,"PowerQueryPaneManager.ShowPowerQueryTaskPane()")}function v($a,
$b){var wc=this;this.wva=new Dc.a(!1);this.vva=new Dc.a(!0);this.r4a=new Dc.a(!0);this.s4a=this.R_=null;this.vMf=0;this.handleQueryGroupOperation=function(Sc,yc){var Dd={};Dd.Id=yc.id;Dd.Name=yc.name;Dd.Description=yc.description;Dd.ParentId=yc.parentId;wc.Tya.handleQueryGroupOperation(Sc,Dd)};this.handleQueryAction=function(Sc,yc){var Dd={},Sd=wc.$.da.za(470);Dd.Name=yc.name;Dd.ExtraData=yc.extraData;Dd.Formulas=Sd.formulas;Sd.handleQueryAction(Sc,Dd)};this.$=$a;this.Tya=$b;this.isVisible=!1;this.zab=
new Dc.a(!0);this.IGd={}}function r(){this.name=null;this.rowsLoaded=0;this.lastRefresh=null;this.fillObjectType=0;this.loadedToDataModel=!1;this.queryError=0;this.groupKey=null;this.rowsWithError=this.nestingDepth=0;this.refreshEnabled=this.inRefresh=!1}function y(){this.callbacks=this.selectedQueryKey=this.groups=this.queries=this.type=null}function m(){this.handleQueryAction=this.onCancelQueryRefresh=this.handleQueryGroupOperation=this.onQueryRefresh=this.onQuerySelected=null}function w(){this.name=
this.key=null;this.startIndex=this.count=0;this.data=this.children=null;this.level=0}function B($a){var $b=Bg.call(this)||this;$b.$=$a;$b.Eb();return $b}function A($a,$b){var wc=this;this.stateId=0;this.VEe=!1;this.c6d=null;this.F8d=!1;this.Q5d=null;this.Qf=function(){var Sc=wc.$.ea.ho.PowerQueryStateId;Mb.ULS.sendTraceTag(537154444,0,50,"PowerQueryManager.OnWorkbookMetadataChanged: powerQueriesStateId: {0}, this.stateId: {1}",Sc,wc.stateId);Sc>wc.stateId&&wc.k2a().continueWith(function(yc){yc.result?
wc.stateId=Sc:Mb.ULS.sendTraceTag(537154443,0,15,"PowerQueryManager.OnWorkbookMetadataChanged failed to update the local state")})};this.qo=function(){wc.k2a()};this.zRj=function(Sc){if(Sc&&!se.a(Sc)){Sc=Sc.Result;if(Sc.Queries){wc.$$a.clear();for(var yc=bk(Sc.Queries),Dd=yc.next();!Dd.done;Dd=yc.next()){Dd=Dd.value;try{wc.$$a.add(Dd.Name,Dd)}catch(Fe){Mb.ULS.sendTraceTag(523534750,0,10,"PowerQueryManager.OnGetQueriesSuccess: more than one query with the same name in queryInfo.")}}}wc.c6d=Sc.QueryGroups;
Mb.ULS.sendTraceTag(537154441,0,50,"PowerQueryManager.OnGetQueriesSuccess: no. queries: {0}",wc.queries?wc.queries.length.toString():"null");if(Sc.PowerQueryConnectionsInfo){wc.zK.clear();yc=[];Dd=bk(Sc.PowerQueryConnectionsInfo);for(var Sd=Dd.next();!Sd.done;Sd=Dd.next()){Sd=Sd.value;try{wc.zK.add(Sd.QueryName,Sd)}catch(Fe){Mb.ULS.sendTraceTag(523534749,0,10,"PowerQueryManager.OnGetQueriesSuccess: same query with more than one connection."),yc.push(Sd.QueryName)}}dd.EwaSettings.isChangeGateEnabled("OfficeVSO:6212633_BlockRefreshForQueriesWithoutConnection")&&
yc.forEach(function(Fe){wc.zK.remove(Fe)})}wc.Q5d=Sc.Formulas;wc.VEe=!0}};this.vzd=function(){Mb.ULS.sendTraceTag(537154439,0,15,"PowerQueryManager.OnGetQueriesFailure")};this.aDf=function(Sc){wc.Pa.raiseEvent("OnUpdatePowerQueryDataKeySucceeded",Sc)};this.eTi=function(Sc){wc.Pa.raiseEvent("OnUpdatePowerQueryDataFailed",Sc)};this.rOa=function(Sc,yc){if(yc&&yc.Result&&yc.Result.PowerQueryRefreshChallengeResult){if(!yc.Result.ConnectionName)throw Error.argumentNull;wc.dgj(yc.Result.PowerQueryRefreshChallengeResult,
yc.Result.ConnectionName)}};this.dgj=function(Sc,yc){Mb.ULS.sendTraceTag(520710282,0,50,"PowerQueryManager:resolveChallenge: Starting challenge resolve");Qd.TaskExtensions.Aa(z(wc.$.oa.xa,function(Dd){0<(null===Dd||void 0===Dd?void 0:Dd.Errors.length)||(Dd=Dd.Result,Dd=null===Dd||void 0===Dd?void 0:Dd.find(function(Sd){return Sd.K===Sc.Kind&&Sd.P===Sc.Path}),Mb.ULS.sendTraceTag(520710281,0,50,"PowerQueryManager:resolveChallenge: data source connection exists: {0}",!!Dd),Dd&&wc.H6i(yc))},function(){Mb.ULS.sendTraceTag(520710280,
0,50,"PowerQueryManager:resolveChallenge: Read Roaming failed")},null,null),function(){},wc.$.la,3)};this.$=$a;this.xDb=$b;this.$$a=new Dc.a(!1);this.Ntg=new Dc.a(!1);this.Pa=new Ee.a;this.$.ea.zu(this.Qf);dd.EwaSettings.isChangeGateEnabled("OfficeVSO:6242825_RegisterLoadOnDemandOccurredOnPQManager")&&this.$.ea.QL(this.qo);this.$.ea.ho&&(this.stateId=this.$.ea.ho.PowerQueryStateId);dd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryAuthenticateRefresh",!1)&&pe.a(this.$).QUc(this.rOa);
Ya.a.instance.Tb("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(Sc){Sc.isFeatureEnabled("ExcelPowerQuery",!1).then(function(yc){wc.F8d=yc;return null})})}function z($a,$b,wc,Sc,yc,Dd){Dd=$a.Na(1,void 0===Dd?null:Dd);return ac.g($a,"ReadPowerQueryRoaming",Dd,$b,wc,Sc,yc,4)}function x($a,$b,wc,Sc,yc,Dd,Sd,Fe){Fe=$a.Na(1,void 0===Fe?null:Fe);Fe.queryAction=$b;Fe.queryActionPayload=wc;return ac.g($a,"PowerQueryQueryAction",Fe,Sc,yc,Dd,Sd,0)}function D($a){return Pf.call(this,
$a)||this}function I($a){var $b=Kf.call(this)||this;$b.lpc=null;$b.wab=!1;$b.jza=null;$b.FGd=!1;$b.Pa=new Ee.a;$b.mx=null;$b.cug=new Map;$b.WOa=new Map;$b.u6i=!1;$b.tVb=[];$b.vz=function(Sc,yc){2===yc.Cq?$b.WOa.clear():1===yc.Cq&&$b.WOa&&$b.WOa.forEach(function(Dd,Sd){yc.Ef==Dd&&$b.WOa.delete(Sd)})};$b.jci=function(Sc){$b.yWc(Sc.Ea)};$b.yTg=function(){$b.gOd(0);$b.sMf(!0,null,!1)};$b.ZOi=function(Sc){Sc.RequestId||($b.t$a=null,$b.$.ea.fp(Sc.Errors))};$b.$Oi=function(Sc){$b.t$a=null;Sc=zd.a.Mf(Sc.data);
$b.$.ea.fp(Sc)};$b.jAf=function(Sc){$b.kAf(Sc);if(Sc.DepartableWebMethodOperationCompleted||Sc.Errors&&0<Sc.Errors.length)$b.u6i=!1,$b.Pa.raiseEvent("refreshAllCompleted",Sc,$b)};$b.yLi=function(Sc){Sc&&!se.a(Sc)&&(!(Sc=Sc.Result)||1>Sc.length||($b.mx&&$b.mx.cancel(),$b.mx=new Rf.a,$b.c$f(Sc,0,$b.mx.token)))};$b.xLi=function(Sc){Mb.ULS.sendTraceTag(537163298,306,50,"DataRefreshManager::OnGetSensitivityLabelsFailedCallback");Sc=zd.a.Mf(Sc.data);$b.$.ea.fp(Sc)};$b.Rc=function(){$b.pld()};$b.mF=function(){dd.EwaSettings.isChangeGateEnabled("OfficeVSO:6013906_MarkRefreshRangeInvalidWhenCurrentSheetIsChanged")&&
$b.pld()};$b.Y8a=function(Sc,yc){var Dd=yc.Zc.block,Sd=Dd.ke.PeriodicRefreshExpiryInSeconds;void 0!==Sd&&$b.yZf(Sd);Sd=Pb.g($b.$);5===Dd.state&&Sc===Sd.Ea&&((Sc=(Sc=Sd.cG(yc.Zc.hash))?Sc.jf:null)&&!Sc.xd(Sd.ha.sa.activeCell)||$b.pld())};$b.Uc=function(){$b.$.ea.dc||$b.clear()};$b.$=$a;$b.xCd=-1;$b.t$a=null;$a=Pb.g($b.$);var wc=$a.ha;wc.UD($b.Rc);wc.Bga($b.Rc);$a.Ea.Cga($b.Y8a);$b.$.va.Cra($b.mF);$b.$.vb.Cra($b.mF);dd.EwaSettings.isChangeGateEnabled("OfficeVSO:6399807_AddOperationDequeueOnRefreshCancel")&&
$b.$.userOperationManager.zr($b.vz);$b.yWc($a.Ea);$b.yWc(ke.a($b.$).Ea);$b.$.da.Za(36,$b.jci);$b.$.ea.Vj($b.Uc);$a=$b.$.ya.StartupDelayMultiplierForLabelsOnRefreshOnOpen*$b.$.ya.TimeToWaitForApplyingSensitivityLabels;Mb.ULS.sendTraceTag(537163332,306,50,"DataRefreshManager async call to UpdateSensitivityLabels after {0} ms.",$a);Be.a.instance.create(function(){$b.yBc()},$a,Ie.a.Sah,!0,!0);return $b}function F($a,$b,wc,Sc,yc,Dd,Sd,Fe,ze){var Ce=Fe?"RefreshAllDirtyDataSources":"RefreshAll";ze=$a.Na(1,
ze);var Ue=ze.context;Ue.RequestId=wc;Ue.CompleteResponseTimeout=Sc;ze.periodic=$b;return ac.g($a,Ce,ze,yc,Dd,Sd,Fe,$b?8:0)}function G($a,$b){return Cg.call(this,$a,G.tQ($b))||this}function T($a,$b,wc,Sc,yc,Dd){yc=void 0===yc?Xf.a.W4c:yc;return pf.call(this,$a,$b,wc,Sc,yc,void 0===Dd?null:Dd)||this}function O($a,$b){this.pivotTableName=this.pivotTableId=null;this.pivotTableId=$a;this.pivotTableName=$b}function U($a){return ue.call(this,$a)||this}function J($a){var $b=Vc.call(this)||this;$b.gi=null;
$b.Wg=null;$b.$=$a;$b.Eb();return $b}function H($a,$b,wc){var Sc=tc.call(this,$a)||this;Sc.de=null;Sc.Cye=null;Sc.ju=0;Sc.Hr=!1;Sc.Fc=function(yc,Dd){Dd.jg||Sc.Zf(!1)};Sc.Qj=function(){Sc.Zf(!1);Sc.raiseEvent("PivotTableSettingsTaskPaneClosed");return!0};Sc.$=$b;Sc.taskPaneManager=wc;Sc.$.Bk(Sc.Fc);Sc.ha=Pb.g(Sc.$).ha;Ic.a($b).Lh(Sc);return Sc}function K(){}function N($a){var $b=wd.call(this)||this;$b.$=$a;$b.Eb();return $b}function M($a){var $b=this;this.ppc=this.WFb=this.pivotTableSettingsTaskPane=
null;this.yf=!1;this.Lca="";this.Yya=!1;this.rHf=0;this.f3=this.mma=this.Q4b=this.qHf=null;this.Hr=this.QNa=!1;this.ePi=function(wc,Sc){if(se.a(wc)){var yc=wc.Errors[0].Description;wc=wc.Errors[0].MessageId;var Dd=Sc.OFf;Sc=Sc.PFf;var Sd=$b.qja();if(!Sd||Sc!==Sd.Eca)if($b.mma&&Sc===$b.mma.Eca)Sd=$b.mma;else{Mb.ULS.sendTraceTag(537154689,0,50,"OnPivotTableSettingsChanged Cannot Find PivotTable for opType: {0}",Dd);return}switch(Dd){case 1:Sd.pivotTableName=$b.Lca;break;case 2:Sd.rwGrandTotalOn=$b.Yya;
break;case 3:Sd.colGrandTotalOn=$b.Yya;break;case 12:Sd.errorString=$b.Lca;break;case 13:Sd.nullString=$b.Lca;break;case 14:Sd.saveSourceDataWithFile=$b.Yya;break;case 15:Sd.refreshOnLoad=$b.Yya;break;case 16:Sd.altText=$b.Lca;break;case 17:Sd.altTextSummary=$b.Lca;break;case 20:Sd.indentIncrement=$b.rHf}Mb.ULS.sendTraceTag(537154688,0,50,"OnPivotTableSettingsChangedSuccessCallback encounters error {0} {1} for opType: {2}",wc,yc,Dd);$b.updateTaskPane($b.qja())}};this.GEb=function(){$b.hideTaskPane(!0)};
this.Cla=function(){var wc=$b.gridView.inRangePicker||$b.gridView.ui||!!($b.ha.Pe&470);Fa.a.ud($b.$)?($b.Vo()&&!wc&&$b.vbg(),$b.EBc()):$b.yf&&!wc&&($b.vbg(),$b.f3!==$b.mma&&$b.f3&&$b.updateTaskPane($b.qja(),!0))};this.Aq=function(){Fa.a.ud($b.$)?($b.Vo()&&($b.f3=$b.qja()),$b.EBc()):$b.yf&&($b.f3=$b.qja(),$b.updateTaskPane($b.f3))};this.$=$a;this.gridView=Pb.g(this.$);this.bai($a);this.ha=this.gridView.ha;this.ha.hJ(this.Cla);this.gridView.QD(this.Cla);this.gridView.iP(this.Aq);this.HL=Array(6);for($a=
0;$a<this.HL.length;$a++)this.HL[$a]=!1}function C(){this.enabled=!1;this.caption=this.sheet=this.name=null}function Q(){this.pivotTableName=null;this.rwGrandTotalOn=this.colGrandTotalOn=!1;this.indentIncrement=0;this.displayNullString=this.displayErrorString=this.showItemsWithNoDataOnCol=this.showItemsWithNoDataOnRw=this.showDrillIndicators=this.autoFormatOnUpdate=!1;this.nullString=this.errorString=null;this.refreshOnLoad=this.saveSourceDataWithFile=!1;this.slicerConnections=this.altTextSummary=
this.altText=null}function P($a,$b){this.$=$a;this.pivotTableSettingsPaneManager=$b}function ka(){this.onSettingChange=this.settingsInfo=this.type=null;this.hasLessThanTwoRowFields=this.expandAllByDefault=this.isNativePivotTable=this.isRangeChanged=!1;this.onSaveSectionCollapseState=this.sectionCollapseStates=null;this.needFocusOnFirstElement=!1}function R(){this.OFf=0;this.PFf=null}function fa($a,$b,wc,Sc,yc){this.pivotTableName=this.activeCell=null;this.opType=0;this.userInputText=null;this.userInputInt=
0;this.activeCell=$a;this.pivotTableName=$b;this.opType=wc;this.userInputText=Sc;this.userInputInt=yc}function ca($a){return cd.call(this,$a)||this}function ea($a){var $b=this;this.activeCell=this.rc=null;this.ARi=function(wc){se.a(wc)||((wc=$b.$.va.getItemByName(wc.Result.toString()))&&wc.activate(),wc=document.querySelector(".ewa-stb-tabs .tab-active"),$b.PLj(wc))};this.jLi=function(wc){wc&&!le.a.Qg(wc.Errors)&&$b.asd(wc.Result)};this.iLi=function(){};this.lLi=function(wc){wc&&!le.a.Qg(wc.Errors)&&
$b.bsd(wc.Result)};this.kLi=function(){};this.hLi=function(wc,Sc){wc&&!le.a.Qg(wc.Errors)&&$b.Yrd(wc.Result,Sc)};this.gLi=function(){};this.$=$a;this.ha=Pb.g(this.$).ha}function wa(){var $a=We.call(this)||this;$a.Eb();return $a}function X($a,$b){return He.call(this,$a,$b)||this}function ja($a,$b,wc,Sc){var yc=Lc.call(this,$b,$a,!1)||this;yc.F0d=null;yc.Mi=null;yc.dwc=new Dc.a(!0);yc.l3=new Dc.a(!0);yc.ita=null;yc.K0a=null;yc.xIb=null;yc.MOb=!1;yc.PAb=null;yc.hashCode=null;yc.Yzc=!1;yc.jSa=null;yc.WAb=
jc.a.Ta.Jb;yc.businessBar=null;yc.rOa=function(Dd,Sd){Sd&&Sd.Result&&(Dd=Sd.Result,Dd.DataConnections&&Dd.DataConnections.DataConnections&&yc.wMf(Dd.DataConnections))};yc.ef=function(Dd,Sd){switch(Sd.Zc.block.state){case 1:case 3:case 5:yc.ona(Sd)}};yc.Dm=function(){};yc.mo=function(Dd,Sd){yc.s7c();Sd.pa&&yc.isVisible&&yc.dri(!qd.j(Sd.pa));yc.clearCache();yc.JQ=!1};yc.nN=function(Dd){switch(Dd.Pt){case 1:yc.Yzc&&yc.P$b(yc.Mi)}};yc.Yc=function(Dd,Sd){Sd.tV||(yc.s7c(),Dd=yc.$,yc.rtb=Sb.d(Dd.mg),Dd.ea.UBa.getTime()>
yc.UBa.getTime()&&(yc.o2b(),yc.UBa=Dd.ea.UBa),yc.Pwa&&yc.P$b(yc.Mi))};yc.oe=function(){yc.iSa(!1)};yc.pN=function(){yc.$.ea.Zla()};yc.onKeyDown=function(Dd){Dd=yc.$.shortcutKeyManager.Qt(Dd);yc.executeRibbonCommand(Dd)};yc.Oi=function(){yc.Mi&&yc.Mi.pTa()};yc.s6=function(){yc.Adc();yc.vJ.yba=!0};yc.r6=function(){yc.vJ.Ozb||yc.vJ.sAb||yc.JNb();yc.vJ.yba=!1};yc.syf=function(){yc.Adc();yc.vJ.yba=!0};yc.Yx=function(){yc.vJ.Ozb||yc.vJ.sAb||yc.JNb();yc.vJ.yba=!1};yc.GAf=function(){yc.vJ.Ozb=yc.TIb.dN&&
yc.TIb.mYi;yc.vJ.Ozb?yc.Adc():yc.vJ.yba||yc.vJ.sAb||yc.JNb()};yc.Qzf=function(){switch(Ze.a(yc.$).state){case 0:case 1:case 2:case 4:yc.vJ.Ozb||yc.vJ.yba||yc.JNb();yc.vJ.sAb=!1;break;case 5:case 3:case 7:case 8:case 6:yc.Adc(),yc.vJ.sAb=!0}};yc.lKi=function(Dd,Sd){if(yc.lMa(3)||yc.Pwa){var Fe=Dd.Result;Dd=yc.Pwa;if(null===Fe||void 0===Fe?0:Fe.ReportData)yc.xIb=Fe.ReportData;if(Fe&&Fe.DataConnectionsInfo)if(Fe=Fe.DataConnectionsInfo,1===Fe.DataConnections.length&&Fe.DataConnections[0].StreamingFailed)yc.o2b(),
yc.iSa(!0);else{var ze=!0;yc.K0a=Fe.DataSources;for(var Ce=bk(Fe.DataConnections),Ue=Ce.next();!Ue.done;Ue=Ce.next())if(Ue=Ue.value,Ue.IsReady||0>Ue.SourceIndex){var Oe=Ue.ConnectionName.toLowerCase();yc.l3.getItem(Oe)||yc.l3.add(Oe,Ue)}else{Sd.okh();ze=!1;break}ze&&(Dd?yc.wMf(Fe):(yc.Mi.HZ=4,yc.Neb(Sd,null)))}else yc.Mi.HZ=1}};yc.zLi=function(Dd){Dd&&yc.$.ea.fp(Dd.Errors)};yc.n5a=new Vd.a($a,$a.ea,$a.oa.Fk,4,0);yc.UBa=$a.ea.UBa;yc.rtb=!$a.hc.refreshConfirmationRequired||Sb.d($a.mg);yc.yLe=!1;yc.domElement.classList.add(nd.a.v8b);
yc.domElement.style.overflow="hidden";yc.domElement.tabIndex=0;yc.iSa(!1);yc.Ac.ka("mousedown",yc.pN);yc.Ac.ka("keydown",yc.onKeyDown);$a.va.iJ(yc.mo);$a.vb.iJ(yc.mo);$a.vb.If(yc.oe);$a.va.If(yc.oe);$a.sA(yc.Oi);$a.ob.IZb(yc.s6);$a.ob.HZb(yc.r6);$a.Ka.Ime(yc.syf);$a.Ka.rYa(yc.Yx);Ze.a($a).gq(yc.Qzf);yc.Ea.Ds(yc.ef);yc.Ea.uG(yc.Dm);pe.a($a).bne(yc.rOa);$a.Tk(yc.Yc);dd.EwaSettings.Zb()&&yc.yu(yc.fya);je.a($a).qQ(Pa.a.idle).gq(yc.nN);yc.TIb=wc;yc.TIb.VD(yc.GAf);yc.vJ=new va;yc.Q0b=Sc;oa.ka($a,yc);return yc}
function va(){this.sAb=this.yba=this.Ozb=!1}function ua($a,$b){this.Hxc=$a;this.Z8b=$b}function Xa($a,$b,wc,Sc,yc){var Dd=this;this.interactiveReportContent=this.wpc=this.hG=null;this.l$e=!1;this.eYi=function(){Dd.interactiveReportView.P$b(Dd)};this.s7d=$a;this.Ypg=wc;this.$=yc;this.hG=Sc?new aa($b):new ba($b,wc);this.HZ=this.hG.m9e;this.pTa()}function aa($a){this.d5a=document.createElement("img");Fc.DOMElementExtensions.setVisible(this.d5a,!0);this.d5a.setAttribute("style","height: 80%; width: auto");
this.J6b=document.createElement("div");this.J6b.id=$a;this.J6b.appendChild(this.d5a)}function ba($a,$b){var wc=this;this.iframe=document.createElement("iframe");this.iframe.src=$b;this.iframe.frameBorder="0";this.iframe.scrolling="no";this.iframe.id=$a;this.sia=re.a.instance.Sd(this.iframe);this.sia.ka("load",function(){InteractiveReportAPI.SetHost(wc.contentWindow,$b)})}function oa($a){this.interactiveReportView=$a}function ra($a){return Ec.call(this,$a)||this}function db($a){this.activeCell=this.rc=
null;this.$=$a;this.ha=Pb.g(this.$).ha}function Ka($a,$b,wc){var Sc=dc.call(this,$a)||this;Sc.$3f=null;Sc.xbi=function(yc,Dd){1===yc?(yc=Dd.indices,Mb.ULS.sendTraceTag(537155741,0,50,"InsertSlicerDialog.ClickedOK: User clicked OK, inserting {0} Slicers",yc.length),0<yc.length&&Sc.Zdh(yc)):Mb.ULS.sendTraceTag(537155740,0,50,"InsertSlicerDialog.Dismissed: User dismissed the dialog")};Sc.TKi=function(yc){Sc.$3f=yc.Result;yc={};yc=(yc.id=Sc.nc,yc.singleDimFields=Sc.$3f,yc);Sc.initializeAndShow(uc.a.instance.ga(2124),
Sc.xbi,yc)};Sc.gridView=Pb.g($a);Sc.sa=Sc.gridView.ha.sa;Sc.ha=Pb.g($a).ha;Sc.pivotTableName=$b;Sc.GCd=wc;Pb.g($a).Ab.Qo(Sc.ha.sa.activeCell);Mb.ULS.sendTraceTag(543511326,0,50,"InsertSlicerDialog.Constructor: User Opened Insert Slicer Dialog");Sc.Pai();return Sc}function Ga($a){return hd.call(this,$a)||this}function xa($a){var $b=this;this.yjd=!1;this.Q9=this.h7h=null;this.$=$a;this.gridView=Pb.g($a);Ya.a.instance.Tb("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(wc){$b.Q9=
wc;wc.isFeatureEnabled(xa.e8e,!1).then(function(Sc){return $b.yjd=Sc});$b.h7h=wc.yma(xa.e8e,function(Sc){$b.yjd=Sc.isEnabled})})}function da($a,$b){var wc=xc.call(this,$a,new qa($a))||this;wc.bSa=null;wc.Vxa=null;wc.jaa=null;wc.destinationRange=null;wc.tUd=null;wc.OAa=!1;wc.Fu=0;wc.JCj="";wc.nGe="";wc.X9e=function(Sc,yc){wc.hide();if(1===Sc){var Dd=Sc="";2!==wc.Fu&&(Sc=da.XBd(yc[da.Oxc],wc.$.va),wc.ICj(Sc,wc.$)&&Mb.ULS.sendTraceTag(537155781,0,50,"InsertPivotTableDialog.InsertPivotTableDialogHandler - Source does not have enough entries"));
1!==wc.Fu&&yc[da.t9c]&&(Dd=da.XBd(yc[da.Z5b],wc.$.va));2===wc.Fu&&Dd===wc.nGe||wc.Oai(Sc,Dd)}else wc.FLb(!0,!0),Mb.ULS.sendTraceTag(537155780,0,50,"InsertPivotTableDialog.InsertPivotTableDialogHandler - cancel was clicked.")};wc.au=function(){wc.QNb()};wc.xmc=function(){wc.destinationRange.disabled=!wc.jaa.checked;wc.QNb();return!1};wc.Wuf=function(){wc.QNb();return!1};wc.hCf=function(){wc.QNb();return!1};wc.Jzd=function(Sc){if(se.a(Sc))wc.FLb(!0,!0),Mb.ULS.sendTraceTag(537155742,0,50,"InsertPivotTableDialog.OnInsertPivotTableDone - failed.");
else if(Mb.ULS.sendTraceTag(537155743,0,50,"InsertPivotTableDialog.OnInsertPivotTableDone - success."),Sc=Sc.Result){var yc=wc.$.va.getItemByName(Sc.SheetName);yc&&(yc.activate(),wc.gridView.gg(Sc,null,null,null,3,bf.a.wbi),wc.FLb(!0,!1),0===wc.Fu&&wc.ppj(),Sc=fb.a.Hqc,Sc!==Gd.a(wc.$).Ql.wB&&(Gd.a(wc.$).HGb(2),Gd.a(wc.$).Ql.activateRibbonTab(Sc)))}else wc.FLb(!0,!1)};wc.gridView=Pb.g(wc.$);wc.FQ=lb.a.instance;wc.yv=!1;-1128516639===$b?(wc.Fu=1,Mb.ULS.sendTraceTag(537155785,0,50,"InsertPivotTableDialog.InsertPivotTableDialog - for PivotTable Operation Change data Source")):
-63037693===$b?(wc.Fu=2,Mb.ULS.sendTraceTag(537155784,0,50,"InsertPivotTableDialog.InsertPivotTableDialog - for PivotTable Operation Move PivotTable")):Mb.ULS.sendTraceTag(537155783,0,50,"InsertPivotTableDialog.InsertPivotTableDialog");return wc}function qa($a){return mc.call(this,$a)||this}function na($a,$b){this.destinationRange=this.sourceRange=null;this.sourceRange=$a;this.destinationRange=$b}function ia($a,$b,wc,Sc,yc,Dd,Sd){Sd=$a.Na(1,void 0===Sd?null:Sd);Sd.activeCell=$b;return ac.g($a,"GetDataSourceRangeForPivotTable",
Sd,wc,Sc,yc,Dd,0)}function ta($a,$b,wc,Sc,yc,Dd,Sd,Fe,ze){ze=$a.Na(41,void 0===ze?null:ze);ze.activeCell=$b;ze.newRange=wc;ze.isDataSource=Sc;return ac.g($a,"ChangePivotLocation",ze,yc,Dd,Sd,Fe,0)}function za($a,$b){this.title=$a;this.Vf=$b}function sa($a,$b){this.bXb=$a;this.Stg=$b;this.uqc=null}function V(){}function Ia(){this.$5b=this.sourceRange=this.Lda=null}function Ha($a){var $b=$e.call(this)||this;$b.$=$a;$b.Eb();return $b}function ob($a,$b,wc){var Sc;var yc=me.call(this,$a)||this;yc.h$c=
300;yc.g$c=250;yc.jQ=new Cb;yc.kQ=new Cb;yc.y5c={};yc.Ij=null;yc.Kj=null;yc.kua=null;yc.tdh=0;yc.Z9b=!1;yc.R0b=!1;yc.Zob=!1;yc.currentState=ya.j4b();yc.bGa=null;yc.csa=null;yc.Iba=0;yc.Ond=!1;yc.FNd=!1;yc.jua=null;yc.yf=!1;yc.n6a=!1;yc.L6=null;yc.VGb=null;yc.vye=null;yc.YGb=-1;yc.kW=[];yc.UGb=!1;yc.uPa=null;yc.JFd=!1;yc.NKf=!1;yc.TGb=!1;yc.SGb="";yc.tPa=null;yc.K6=0;yc.J6="";yc.HFd=!1;yc.LKf=null;yc.Vi=!1;yc.ju=0;yc.w4i=function(Dd,Sd){yc.Kj&&yc.xka&&(Dd=qb(yc.Kj.FieldListItems,Dd,!0))&&(Mb.ULS.sendTraceTag(554317778,
0,50,"React Field List: check/uncheck a field."),yc.woi(Dd,Sd))};yc.n4i=function(Dd){yc.Kj&&(Dd=qb(yc.Kj.FieldListItems,Dd,!0))&&Dd.IsCollapsible&&(5===Dd.TypeTag&&Dd.IsCollapsed&&!Dd.Children.length?(Array.clear(yc.kW),yc.kW.push(Dd),yc.x9c()):(Dd.IsCollapsed=!Dd.IsCollapsed,yc.yf&&yc.s$b(0,-1,!1,!1,!1,!1)))};yc.m4i=function(Dd){yc.Kj&&(Mb.ULS.sendTraceTag(554317777,0,50,"React Field List: expand/collapse all fields."),0<yc.kW.length&&Array.clear(yc.kW),yc.JKf(yc.Kj.FieldListItems,Dd)?yc.x9c():yc.yf&&
yc.s$b(0,-1,!1,!1,!1,!1))};yc.p4i=function(Dd,Sd,Fe){if(yc.Kj){var ze=document.getElementById(Sd);if(ze&&(Dd=qb(yc.Kj.FieldListItems,Dd,!0))){ze={domElement:ze,fieldItem:Dd};ze.versionkey=yc.Mrb;ze.isChart=!!yc.chartId;ze.isPpm=yc.Kj.IsPpm;ze.isOlap=yc.currentState.wka;ze.supportsImplicitMeasures=yc.Kj.SupportsImplicitMeasures;ze.isKeyboardInput=Fe;yc.uPa=Sd;Sd=new Od.a(330754562,0,yc.$.Jc,30,null);var Ce;yc.UGb=!bd.a(Ce=yc.$.Ka.Kb(Sd,ze))&&(6!==Ce.status||Ce.result)}}};yc.h4i=function(Dd){Mb.ULS.sendTraceTag(554317775,
0,50,"React Field List: change field list sort order.");var Sd=ob.grb(yc.currentState);yc.$.userOperationManager.Sb(new ic.a(251,0,function(Fe,ze,Ce){var Ue=yc.$.oa.xa,Oe=ac.M(Ue,yc.currentState.Dw,yc.currentState.externalSourceIndex,Sd);Oe.isAscending=Dd;return ac.g(Ue,"ChangePivotFieldListSortOrder",Oe,Fe,ze,Ce,null,0)}),null)};yc.P4i=function(Dd){yc.pde=Dd};yc.q4i=function(Dd){Dd!==yc.J6&&(Mb.ULS.sendTraceTag(537162715,0,50,"React Field List: change search input."),yc.J6=Dd,yc.s$b(0,-1,!1,!0,!1,
!1))};yc.Vzf=function(){if(yc.UGb&&yc.uPa){var Dd=document.getElementById(yc.uPa);Dd&&Dd.classList.add("fieldItemMenuOpen")}};yc.Uzf=function(){if(yc.UGb&&yc.uPa){var Dd=document.getElementById(yc.uPa);Dd&&(Dd.classList.remove("fieldItemMenuOpen"),Dd.classList.contains("fieldItemOnHover")||Dd.classList.contains("fieldItemOnFocus")||(Dd.style.visibility="hidden"))}yc.UGb=!1;yc.uPa=null};yc.Qj=function(){yc.BNd(!0,null);yc.hideTaskPane();return!0};yc.$ga=function(){if(yc.$)if(je.a(yc.$).ALa&&yc.isVisible&&
yc.currentState.dMa&&yc.$.ea.dc){if(yc.jQ.kl&&!yc.jQ.request){var Dd=yc.jQ;var Sd=yc.$.oa.xa;var Fe=yc.currentState.GJ,ze=yc.currentState.wrc,Ce=yc.currentState.wB,Ue=yc.DKi,Oe=yc.EKi,Ta=yc.jQ.zqf(),Ba=ac.M(Sd,yc.currentState.Dw,yc.currentState.externalSourceIndex,ob.grb(yc.currentState));Ba.type=1;Ba.version=Fe;Ba.relatedGroup=ze;Ba.selectedTab=Ce;Sd=ac.g(Sd,"GetPivotFieldListData",Ba,Ue,Oe,null,Ta,4);Dd.request=Sd}yc.kQ.kl&&!yc.kQ.request&&(Dd=yc.kQ,Sd=yc.$.oa.xa,Fe=yc.currentState.lQ,ze=yc.GKi,
Ce=yc.HKi,Ue=yc.kQ.zqf(),Oe=ac.M(Sd,yc.currentState.Dw,yc.currentState.externalSourceIndex,ob.grb(yc.currentState)),Oe.type=1,Oe.version=Fe,Sd=ac.g(Sd,"GetPivotFieldManagerData",Oe,ze,Ce,null,Ue,4),Dd.request=Sd)}else ob.vY(yc.jQ),ob.vY(yc.kQ)};yc.DKi=function(Dd,Sd){yc.dHf(Dd,Sd,yc.jQ)&&(Dd=Dd.Result)&&(yc.currentState.GJ=Dd.FieldListVersion,yc.jQ.kl=!1,yc.Ybg(Dd));pe.a(yc.$).yBc();yc.refresh()};yc.EKi=function(Dd){yc.Ruf(Dd,yc.jQ)};yc.GKi=function(Dd,Sd){yc.dHf(Dd,Sd,yc.kQ)&&(Dd=Dd.Result)&&(yc.currentState.lQ=
Dd.FieldWellVersion,yc.kQ.kl=!1,yc.Pbg(Dd));yc.refresh()};yc.HKi=function(Dd){yc.Ruf(Dd,yc.kQ)};yc.KFi=function(Dd){if(le.a.Qg(Dd.Errors)){yc.Zob=!1;yc.bGa=null;for(var Sd=0,Fe=Dd.Errors.length;Sd<Fe;++Sd)if(1244452614===Dd.Errors[Sd].MessageId){dd.EwaSettings.isChangeGateEnabled("OfficeVSO:4354463_UpdateSelectionAfterApplyPivot")&&(Dd=Pb.g(yc.$),Sd=Dd.Ab.Qo(Dd.ha.sa.activeCell))&&(Sd=rd.Range.Tc(Sd.xTf+1,Sd.left),Sd=xe.v(Sd,yc.$),Dd.gg(Sd,null,null,null,3,bf.a.qyh));yc.currentState.GJ=-1;yc.currentState.lQ=
-1;yc.refresh();break}}yc.Z9b=!0};yc.oJi=function(Dd){yc.R0b=!1;if(!le.a.Qg(Dd.Errors)){if(0<yc.kW.length)for(Dd=0;Dd<yc.kW.length;++Dd)yc.kW[Dd].IsCollapsed=!1;yc.currentState.GJ=-1;yc.refresh()}};yc.Cla=function(){var Dd=Pb.g(yc.$).ha;Dd.Oa.eod&&Dd.Pe&470||Pb.g(yc.$).inRangePicker||Pb.g(yc.$).ui||yc.jHb(!0,!0)};yc.Qf=function(){yc.refresh();yc.$.ea.ho.FieldListForceOnTop&&yc.exc(!1,null,!0)};yc.Lmc=function(){yc.jHb(!0,!0)};yc.Yc=function(){yc.jHb(!0,!1)};yc.uh=function(Dd,Sd){Dd=qd.e(Sd.sF)||qd.e(Sd.pa);
yc.jHb(!0,Dd)};yc.Aq=function(Dd,Sd){Dd=bk(Sd.wTj);for(Sd=Dd.next();!Sd.done;Sd=Dd.next())yc.Zbg(Sd.value);yc.Ond&&(yc.Ond=!1,yc.Fka||yc.taskPaneManager.xg&&1===yc.taskPaneManager.xg.taskPane.Ng||yc.taskPaneManager.GF(yc,!0));yc.jHb(!1,!0)};yc.Nwf=function(Dd,Sd){Pb.g(yc.$).gp||yc.Zbg(Sd.Zc.hash)};yc.QDb=function(){yc.refresh()};yc.Uc=function(){yc.HK()};yc.qo=function(){yc.HK()};yc.wCf=function(){yc.refresh()};yc.xDf=function(){yc.$ga()};yc.$=$b;yc.mg=$b.mg;yc.taskPaneManager=wc;yc.taskPaneManager.VD(yc.wCf);
yc.kli=dd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RichPivotAll",!1)&&dd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RichPivotFieldList",!1);yc.Fka=Fa.a.ud(yc.$);yc.pde=.5;yc.jua=new vb(yc.$,yc);yc.$.Ka.Ime(yc.Vzf);yc.$.Ka.rYa(yc.Uzf);yc.h$c=400;yc.g$c=400;yc.Fka||($a.style.width=Fd.HelperMethods.jc(yc.h$c));Pd.a.equals("rtl",$a.dir,!0)&&(yc.Vi=!0);yc.tyh=[4,2,1,8];yc.$.Tk(yc.Yc);$a=Pb.g(yc.$);$a.Ea.Ds(yc.Nwf);$a.iP(yc.Aq);ke.a(yc.$).Ea.Ds(yc.QDb);$a.ha.hJ(yc.Cla);$a.QD(yc.Cla);
$a.ha.Oa.qEg(yc.Lmc);null===(Sc=Zd.a(yc.$))||void 0===Sc?void 0:Sc.zZb(yc.Lmc);yc.$.va.If(yc.uh);yc.$.ea.zu(yc.Qf);yc.$.ea.Vj(yc.Uc);yc.$.ea.QL(yc.qo);je.a(yc.$).kUc(yc.xDf);Ic.a(yc.$).Lh(yc);yc.refresh();return yc}function ib(){this.valuesWellItems=this.rowsWellItems=this.columnsWellItems=this.filtersWellItems=null}function La(){this.id=0;this.name=null}function zb(){this.searchRestoreValue=null;this.searchWithNoMatch=this.needSearchReset=this.needSearchRestore=!1}function Fb(){this.id=0;this.name=
null;this.type=0;this.showSeparator=this.showMenu=this.showCheckBox=this.canDrag=this.isMoreFields=this.isChecked=this.isCollapsed=this.isCollapsible=!1;this.children=null;this.isBolded=!1}function Yb($a,$b,wc,Sc){this.activeCell=this.additionalInformation=this.pivotData=this.pivotName=null;this.pivotName=$a;this.pivotData=$b;this.additionalInformation=wc;this.activeCell=Sc}function kb($a,$b,wc){this.cachedItemIndex=this.cachedSourceAxis=0;this.cachedItemName=null;this.cachedSourceAxis=$a;this.cachedItemIndex=
$b;this.cachedItemName=wc}function vb($a,$b){this.$=$a;this.fieldManagerPane=$b}function Wa(){this.type=null;this.dataUpdateType=0;this.fieldWellsItems=this.fieldListItems=null;this.isSortAscending=this.isPivotChart=this.isOlap=this.isDataModel=!1;this.focusResetId=this.focusResetType=this.fieldListSizePercentage=this.selectedTab=0;this.onFieldListItemMenuClickV2=this.onFieldWellItemMenuClickV2=this.onFieldCheckedChanged=this.onFieldExpandCollapse=this.onFieldMove=this.onExpandCollapseAll=this.onSortOrderChanged=
this.onSelectedTabChanged=this.onSaveFieldListSizePercentage=null;this.isRichPivotFieldList=!1;this.onSearchInputChanged=this.fieldListSearchInfo=null}function qb($a,$b,wc){if($a)for(var Sc=0,yc=$a.length;Sc<yc;Sc++){var Dd=$a[Sc];if(Dd.ClientId===$b||wc&&(Dd=qb(Dd.Children,$b,wc)))return Dd}return null}function yb($a,$b,wc,Sc){$a=bk($a);for(var yc=$a.next();!yc.done;yc=$a.next())if(yc=yc.value,yc.PivotCacheIndex===$b&&(yc.TypeTag===wc||0===wc)||Sc&&(yc=yb(yc.Children,$b,wc,Sc)))return yc;return null}
function ec($a,$b,wc){if($a)for(var Sc=0,yc=$a.length;Sc<yc;Sc++){var Dd=$a[Sc];Dd.ClientId=wc++;Dd.ClientParentId=$b;wc=ec(Dd.Children,Dd.ClientId,wc)}return wc}function Ob(){}function Cb(){this.xD=0;this.request=null;this.kl=!0}function ab($a){var $b=td.call(this)||this;$b.$=$a;$b.Eb();return $b}function ya($a,$b){this.wka=this.Cod=this.vka=this.$gc=!1;this.anchorType=-1;this.confirmationRequiredForDataOps=!1;this.chartId=this.pivotTableName=null;this.Dde=-1;this.Xee=1;this.eDa=this.k5d=this.j5d=
-1;this.Zqa=null;if($a&&(this.wB=$b,this.vka=this.$gc=!1,$a.pa)){var wc=Pb.g($a),Sc=$b=null;if(qd.f($a.pa)){var yc=ke.a($a);yc.Oc&&yc.Oc.Attributes&4&&(this.chartId=yc.chartId,$b=yc.Oc)}else qd.i($a.pa)&&((yc=wc.ha.Oa.Yb)?(wc=yc.floatingObject)&&0===wc.type&&wc.Oc&&wc.Oc.Attributes&4&&(this.chartId=yc.floatingObject.id,$b=wc.Oc):wc.ha.sa.activeCell&&(yc=pe.a($a).aKa(),Object(Zb.a)(Bc.PivotTableRange,yc)&&(Sc=yc)));$b?(this.vka=!0,this.Cod=!!($b.Attributes&256),this.anchorType=7,this.wka=!!($b.Attributes&
128),this.confirmationRequiredForDataOps=!!($b.Attributes&64),this.eDa=$b.ExternalSourceIndex,this.GJ=$b.FieldListVersion,this.lQ=$b.FieldWellVersion,$b=this.Zqa={},$a.Lj($b),$b.FirstColumn=$b.FirstRow=-1):Sc&&(this.$gc=!0,this.Cod=Sc.isActionable,this.anchorType=0,this.wka=Sc.isOlap,this.confirmationRequiredForDataOps=Sc.confirmationRequiredForDataOps,this.eDa=Sc.externalSourceIndex,this.GJ=Sc.lyh,this.lQ=Sc.uyh,this.pivotTableName=Sc.pivotTableName,this.Zqa=xe.o(Sc,$a))}}function ma($a){return fd.call(this,
$a)||this}function ha($a,$b,wc){$b||Mb.ULS.sendTraceTag(537162718,0,15,"FieldManagerPane is null on FieldListCommandHandler creation");this.$=$a;this.fieldManagerPane=$b;this.kzg=wc}function Z($a,$b){var wc=Pe.call(this)||this;wc.gridView=null;wc.callout=null;wc.dIi=function(Sc){if(Sc.isLoaded){wc.state=1;Sc=wc.$;var yc=Pb.g(Sc);wc.XLg(yc);Sc.Bk(wc.Fc);Sc.sA(wc.Oi);yc.yu(wc.iR);ke.a(Sc).yu(wc.RDb);Sc.userOperationManager.zr(wc.eDf);Jd.a.h2(1529658657,Wd.a.Mv,0,1);Sc.Ka.i2(wc)}else wc.dispose()};wc.tya=
function(Sc,yc){wc.allow&&0===yc.w4&&(Sc=wc.gridView.ha.Pe,1===Sc?(wc.c0c(),wc.VW()):2!==Sc||wc.ny.PZ||(wc.ny.reset(),wc.Jx()))};wc.Dh=function(){wc.Jx()};wc.Fc=function(){wc.Jx()};wc.$c=function(Sc,yc){wc.callout||wc.showCallout(3===Sc.lb,yc)};wc.Ayd=function(){wc.callout.zza(wc.Ayd);wc.callout=null;wc.Jh.hide()};wc.Oi=function(){wc.callout?wc.Jx():wc.j6a()&&wc.Jh.hide()};wc.RDb=function(){3===wc.state&&(wc.state=1)};wc.iR=function(){3===wc.state&&wc.QJe()};wc.eDf=function(Sc,yc){(Sc=yc.Ef?yc.Ef.operation:
null)&&Sc.flags&4&&(wc.allow&&0===yc.Cq?(wc.state=3,wc.Jx()):3===wc.state&&1===yc.Cq&&(yc=Sc.Wc?Sc.Wc.Errors:null)&&0<yc.length&&wc.QJe())};wc.QJe=function(){wc.state=1;wc.VW()};wc.$=$a;wc.state=2;wc.ny=new Na($a);wc.Jh=new eb($a,wc.$c,$b);Ic.a(wc.$).Lh(wc);Ab.a.Sjd($a.domElement.ownerDocument,Gc.a.current.Ro(95),wc.dIi);return wc}function Na($a){this.Ygb=!1;this.eDa=0;this.Zqa=this.bOc=this.aOc=this.Cib=null;this.$=$a;this.reset()}function eb($a,$b,wc){var Sc=af.call(this)||this;Sc.$=$a;Sc.aha=wc.x4b($a,
null,$b,tb.a.k8b,Gc.a.Se(9),uc.a.instance.ga(1170),"BIXPointerDown");return Sc}function cb($a,$b,wc,Sc){var yc=rf.call(this,$a,uc.a.instance.ga(1169),!0,4)||this;yc.Y$=null;yc.$Fc=null;yc.$B=null;yc.kNa=null;yc.JT=null;yc.fieldListSelector=null;yc.K7d=!1;yc.FKi=function(Dd,Sd){if(yc.domElement&&(yc.kNa.zdb(),!se.a(Dd))){var Fe=Dd.Result;Fe&&yc.jEj(Fe,Sd);rf.prototype.Xx.call(yc,Dd,null,"")}};yc.Nzj=function(){Fc.DOMElementExtensions.jv(yc.r0b,uc.a.instance.ga(1171));var Dd=yc.aea.querySelector("."+
Kb.FLe);Dd.tabIndex=-1;Fc.DOMElementExtensions.setFocus(Dd)};yc.X8a=function(){yc.close(1);return!0};yc.domElement.id=$a.domElement.id+"_BIExploreCallout";yc.ny=$b;yc.targetElement=wc;yc.zSf=!1;yc.domElement.classList.remove(yc.rtl?Va.a.i8c:Va.a.h8c);yc.domElement.classList.remove(tb.a.Gp);yc.domElement.classList.add(yc.rtl?Kb.qmh:Kb.pmh);(yc.touchMode=Sc)||yc.domElement.classList.add(Kb.omh);yc.aea.className=Kb.tmh;yc.aea.style.backgroundImage="";yc.boa.className=Kb.smh;yc.Oy.parentNode.className=
Kb.FLe;$a=yc.Gb;$a.className="";$b=String.format('<div id="{0}"class="{1}">{2}</div><div class="{3}"><div id="{4}" class="{5}"></div><div id="{6}" class="{7}"></div></div>',"bix-subtitle",Kb.rmh,yc.ny.J6h,Kb.imh,"bix-fieldlistselector",Kb.umh,"bix-drilldetails",Kb.nmh);Fc.DOMElementExtensions.jv($a,$b);yc.r0b=$a.lastChild;yc.wdc();return yc}function Ua($a,$b,wc,Sc,yc){var Dd=rb.call(this,$b)||this;Dd.v0c=0;Dd.Hxa=new Dc.a(!1);Dd.Auc=-1;Dd.aWf=null;Dd.tM=null;Dd.sI=null;Dd.$c=function(Ue){Ue.zb&&Dd.iqc(Ue.zb);
return!0};Dd.pN=function(Ue){Ue.button===Sys.UI.MouseButton.leftButton&&Ue.target&&(Dd.iqc(Ue.target),wb.g(Ue))};Dd.onDoubleClick=function(Ue){if(Ue.button===Sys.UI.MouseButton.leftButton&&Ue.target){var Oe=Dd.tSe(Ue.target);var Ta=Oe.QXb;0!==Oe.returnValue&&(wb.g(Ue),(Ue=Dd.fZe(Ta))&&Ue.isCollapsible&&Dd.hNb(Ue))}};(Dd.touchMode=yc)?nb.a.instance.ra(kc.a.click,Dd.domElement,Dd.$c):(Dd.Ac.ka("mousedown",Dd.pN),Dd.Ac.ka("dblclick",Dd.onDoubleClick));Dd.L3f=!pc.a.zli&&!yc;if($a.isChromeRtl){var Sd=
"padding-right:{0}px;";Dd.v0c=39}else Sd="padding-left:{0}px;",Dd.v0c=37;var Fe=new oc.a(Sc.ExcludeHierarchies);Fe.V9.sort(function(Ue,Oe){return Ue-Oe});var ze=-1,Ce=null;$a=function(){var Ue=Dd.d9e(wc.FieldListItems,Fe,ze,Ce,Sc.Context);ze=Ue.gBb;Ce=Ue.fe;return Ue}().returnValue;if(!$a)return Dd;1===$a.length&&($a=Array.clone($a[0].Children),$a.forEach(function(Ue){Ue.ClientParentId=-1}));if(!$a.length)return Dd;Dd.fieldListItems=[];$a.forEach(function(Ue){Dd.fieldListItems.push(new Qa(Dd,Ue,Sd,
tb.a.esh,tb.a.fsh))});Ce||(Ce=Ua.Rzh($a,Sc.Context.DimensionCaption)||$a[0]);Dd.fe=Dd.Zdd(Ce.ClientId);Dd.IG();return Dd}function pa($a,$b){var wc=kd.call(this)||this;wc.Y5h=$a;wc.caption=$b;return wc}function Qa($a,$b,wc,Sc,yc){var Dd=this;this._element=null;this.OI=this.visible=!0;this.fieldListSelector=$a;this.oFc=$b.Name||"";this.clientId=$b.ClientId;this.ADa=$b.IsCollapsible;this.parentId=$b.ClientParentId;this.otg=$b.PivotCacheIndex;this.type=$b.TypeTag;this.Udg=$b.UserRank;this.K6h=wc;this.sEe=
Sc;this.U$g=yc;this.fieldListSelector.JCg(this.clientId,this);this.children=[];$b.Children.forEach(function(Sd){Dd.children.push(new Qa($a,Sd,wc,Sc,yc))})}function Db($a,$b,wc,Sc,yc,Dd){var Sd=sc.call(this,$b)||this;Sd.o6c=["bix-drill-action-down","bix-drill-action-up","bix-drill-action-to"];Sd.X4b=-1;Sd.wsb=null;Sd.usb=null;Sd.vsb=null;Sd.uua=null;Sd.$c=function(Fe){for(var ze=Sd.domElement,Ce=Fe.target;Ce!==ze;){if(Ce.id.startsWith("bix-drill-action")){Sd.drillTo(Sd.X4b,Ce.id);wb.g(Fe);break}Ce=
Ce.parentNode}};Sd.sBf=function(Fe,ze){Fe=-1===Sd.X4b;var Ce=ze.Y5h;Sd.X4b=Ce;var Ue=null;Ce===Sd.Gse.HierarchyId?(Sd.fYf(!1),Sd.drillUp||Sd.drillDown?(Sd.gYf(!0),Fc.DOMElementExtensions.setVisible(Sd.domElement,!0),Ue=Sd.usb||Sd.wsb):Fc.DOMElementExtensions.setVisible(Sd.domElement,!1)):(Sd.gYf(!1),Ue=Sd.vsb,Db.Toj(Ue,ze.caption,uc.a.instance.ga(1172)),Sd.fYf(!0),Fc.DOMElementExtensions.setVisible(Sd.domElement,!0));Fe||Sd.rYf(Ue)};Sd.$=$a;Sd.ny=wc;Sd.Gse=Sc.Context;$a=Sc.DrillContext;Sd.drillUp=
$a.DrillUp;Sd.drillDown=$a.DrillDown;Sd.Mid=yc;Sd.bJ=Dd;yc.IFg(Sd.sBf);Sd.IG();return Sd}function Kb(){}b.r(E);var Ab=b(559),ub=b(0),Mb=b(14),Aa=b(89),Za=b(85),Zb=b(440),jb=b(79),Vb=b(48),Ic=b(272),Rb=b(245),kc=b(13),xb=b(939),Va=b(71);Kb.pmh="ewa-bix-ltr";Kb.qmh="ewa-bix-rtl";Kb.tmh="ewa-bix-titlebar";Kb.rmh="ewa-bix-subtitle";Kb.smh="ewa-bix-title";Kb.FLe="ewa-bix-close";Kb.IA="clip16x16";Kb.imh="ewa-bix-body";Kb.nmh="ewa-bix-drilldetails";Kb.kmh="ewa-bix-DrillButton";Kb.omh="ewa-bix-hover";Kb.lmh=
"ewa-bix-DrillLabel1";Kb.mmh="ewa-bix-DrillLabel2";Kb.umh="ewa-bixfl";Kb.GLe="ewa-bixfl-NoFocus";Kb.xmh="ewa-bixfl-ItemSelected";Kb.vmh="ewa-bixfl-Icon";Kb.wmh="ewa-bixfl-Item";Kb.jmh="ewa-bix-calloutBackground";Kb.d8b="ewa-ipad";Object(ub.a)(Kb,"CssClassNames",null,[]);var tb=b(19),fb=b(5),ac=b(62),Ac=b(29),Rc=b(244),Fc=b(12),wb=b(69),uc=b(15),Pb=b(21),sc=Rc.a;Rk(Db,sc);Db.prototype.dispose=function(){this.Mid&&this.Mid.vbj(this.sBf);this.o6c=this.wsb=this.usb=this.vsb=this.uua=this.bJ=this.drillUp=
this.drillDown=this.Gse=this.ny=this.bJ=this.Mid=this.$=null;sc.prototype.dispose.call(this)};Db.prototype.focus=function(){this.setFocus(!0)};Db.prototype.hasFocus=function(){var $a=Fc.DOMElementExtensions.Ip(this.domElement);if(!$a)return!1;$a=$a.id;return!!$a&&$a.startsWith("bix-drill-action")};Db.prototype.onKeyDown=function($a){var $b=$a.keyCode;$a=$a.shiftKey;if(this.hasFocus()){var wc=!1;13===$b?(this.drillTo(this.X4b,this.uua.id),wc=!0):9===$b&&((wc=this.s_(!$a))||this.TFe());return wc}return 9===
$b?this.setInitialFocus(!$a):!1};Db.prototype.setFocus=function($a){return this.hasFocus()?this.s_($a):this.setInitialFocus($a)};Db.prototype.IG=function(){Fc.DOMElementExtensions.gu(this.domElement,fb.a.J_b,null,null);var $a='<button id="{0}" class="'+Kb.kmh+'" tabIndex="-1" title="{1}" style="display:none" onkeyup="return false;" onkeypress="return false;" role="menuitem" aria-describedby="{2} {4}"><div id="{2}"class="'+Kb.lmh+'">{3}</div><div id="{4}" class="'+Kb.mmh+'">{5}</div></button>',$b=
"";if(this.drillDown){var wc=uc.a.instance.ga(1174);var Sc=this.drillDown.Caption;var yc=String.format("{0} ({1})",wc,Sc?Ac.a.yZ(Sc):"");Sc=Sc?Ac.a.zg(Sc):"";$b+=String.format($a,"bix-drill-action-down",yc,"bixdddl_1",wc,"bixdddl_2",Sc)}this.drillUp&&(wc=uc.a.instance.ga(1173),Sc=this.drillUp.Caption,yc=String.format("{0} ({1})",wc,Sc?Ac.a.yZ(Sc):""),Sc=Sc?Ac.a.zg(Sc):"",$b+=String.format($a,"bix-drill-action-up",yc,"bixddul_1",wc,"bixddul_2",Sc));$b+=String.format($a,"bix-drill-action-to","","bixddtl_1",
uc.a.instance.ga(1172),"bixddtl_2","");$a=this.domElement;Fc.DOMElementExtensions.jv($a,$b);this.wsb=this.getElementById("bix-drill-action-up");this.usb=this.getElementById("bix-drill-action-down");this.vsb=this.getElementById("bix-drill-action-to");this.Ac.ka("click",this.$c);$a.setAttribute(fb.a.z2,"");Fc.DOMElementExtensions.setVisible($a,!1)};Db.prototype.drillTo=function($a,$b){var wc=this;switch($b){case "bix-drill-action-up":var Sc=this.drillUp.Id;break;case "bix-drill-action-down":Sc=this.drillDown.Id;
break;case "bix-drill-action-to":Sc=1;break;default:return}Pb.g(this.$).wo(!0);this.bJ.o_g(function(yc,Dd,Sd){var Fe=wc.ny,ze=wc.$.oa.xa,Ce=Fe.confirmationRequiredForDataOps,Ue=Sc;Fe=ac.M(ze,Fe.Dw,Fe.externalSourceIndex,wc.ny.qR);Fe.requiresConfirmation=Ce;Fe.hierarchyId=$a;Fe.levelId=Ue;return ac.g(ze,"BixDrill",Fe,yc,Dd,Sd,null,0)})};Db.prototype.s_=function($a){var $b=0;if(this.uua)switch(this.uua.id){case "bix-drill-action-down":$b=0;break;case "bix-drill-action-up":$b=1;break;case "bix-drill-action-to":$b=
2}return this.kZf($a?$b+1:$b-1,$a)};Db.prototype.TFe=function(){var $a=this.uua;$a&&($a.blur(),this.domElement.setAttribute(fb.a.z2,""));this.uua=null};Db.prototype.fYf=function($a){this.vsb&&Fc.DOMElementExtensions.setVisible(this.vsb,$a)};Db.prototype.gYf=function($a){this.wsb&&Fc.DOMElementExtensions.setVisible(this.wsb,$a);this.usb&&Fc.DOMElementExtensions.setVisible(this.usb,$a)};Db.prototype.rYf=function($a){$a!==this.uua&&this.TFe();if(!$a)return!1;$a.tabIndex=0;Fc.DOMElementExtensions.setFocus($a);
this.domElement.setAttribute(fb.a.z2,$a.id);this.uua=$a;return!0};Db.prototype.setInitialFocus=function($a){return this.kZf($a?0:this.o6c.length-1,$a)};Db.prototype.kZf=function($a,$b){for(var wc=this.o6c;0<=$a&&$a<wc.length;){var Sc=Fc.DOMElementExtensions.getElementById(this.domElement,wc[$a]);if(Sc&&Fc.DOMElementExtensions.isVisible(Sc))return this.rYf(Sc);$a=$b?$a+1:$a-1}return!1};Db.Toj=function($a,$b,wc){wc=String.format("{0} ({1})",wc,$b);$a.setAttribute("title",wc);$a.lastChild.innerText=
$b};Object(ub.a)(Db,"BixDrillDetails",Rc.a,[]);var nb=b(233),pc=b(27),Dc=b(34),oc=b(219),Gc=b(53),ld=Kb.wmh,gd=Kb.xmh,Cc='<div id="{0}" class="'+Kb.vmh+'" style="{1}"><div class="'+tb.a.IA+'"><img id="{2}" class="{3}" role="{4}" src="{5}"/></div></div>';Qa.prototype.dispose=function(){this.children&&(Aa.a.oc(this.children),this.children=null);this._element=null};Qa.prototype.Yye=function(){for(var $a=bk(this.children),$b=$a.next();!$b.done;$b=$a.next())$b=$b.value,$b.visible=!1,$b.ADa&&($b.OI=!0,
$b.p_f(),0<$b.children.length&&$b.Yye())};Qa.prototype.Ape=function($a,$b){this.visible=!$a;var wc=11*$a,Sc=String.format('aria-labelledby="{0}" aria-selected="false" aria-level="{1}"',this.Rua(Qa.SGf),$a+1);this.ADa&&(Sc+=String.format('aria-expanded="false" aria-owns="{0}"',this.Rua(Qa.RGf)));this.ADa?(this.OI=!0,wc=String.format(Cc,this.Rua(Qa.QGf),this.VYe(wc+4),this.Rua(Qa.mDd),this.sEe,fb.a.Gs,Gc.a.Se(9))):wc=String.format('<div style="{0}"></div>',this.VYe(wc+23));var yc=String.format('<span id="{0}">{1}</span>',
this.Rua(Qa.SGf),Ac.a.zg(this.oFc));$b+=String.format('<div id="{0}" class="{1}" tabIndex="-1" title="{2}" role="treeitem" {3}><table cellspacing="0" cellPadding="0" role="presentation"><tr><td style="width: 8px">{4}</td><td>{5}</td></tr></table></div>',this.Rua(Qa.E$a),ld,Ac.a.yZ(this.oFc),Sc,wc,yc);this.ADa&&(++$a,$b+=String.format('<div id="{0}" role="group" style="display:none;">',this.Rua(Qa.RGf)),this.children.forEach(function(Dd){$b=Dd.Ape($a,$b)}),$b+="</div>");return $b};Qa.prototype.R5b=
function(){this.element.blur();this.element.tabIndex=-1};Qa.prototype.Twh=function(){this.children.forEach(function($a){$a.visible=!0})};Qa.prototype.rXe=function($a,$b){for(var wc=this.children,Sc=bk(wc),yc=Sc.next();!yc.done;yc=Sc.next())if(yc=yc.value,!yc.ADa&&5===yc.type&&yc.Udg>$b&&($a=yc,$b=yc.Udg,3===$b))return{returnValue:$a,xof:$b};wc=bk(wc);for(yc=wc.next();!yc.done&&(Sc=yc.value,!Sc.ADa||($a=Sc.rXe($a,$b),$b=$a.xof,$a=$a.returnValue,3!==$b));yc=wc.next());return{returnValue:$a,xof:$b}};
Qa.prototype.IVh=function(){for(var $a=this;-1!==$a.parentId;)$a=this.fieldListSelector.Zdd($a.parentId);return $a};Qa.prototype.Jfc=function($a){for(var $b=this;-1!==$b.parentId;){if($a.clientId===$b.parentId)return!0;$b=this.fieldListSelector.Zdd($b.parentId)}return!1};Qa.prototype.setFocus=function(){this.element.tabIndex=0;Fc.DOMElementExtensions.setFocus(this.element)};Qa.prototype.p_f=function(){var $a=Fc.DOMElementExtensions.getElementById(this.element,this.Rua(Qa.mDd));if($a){var $b=this.element.nextSibling;
Fc.DOMElementExtensions.doa($a,this.OI,this.sEe,this.U$g);this.element.setAttribute(fb.a.jY,this.OI?fb.a.Vq:fb.a.Wj);Fc.DOMElementExtensions.setVisible($b,!this.OI)}};Qa.prototype.Zsj=function(){var $a=String.format(".{0}",gd);$a=this.fieldListSelector.domElement.querySelectorAll($a);for(var $b=0;$b<$a.length;$b++){var wc=$a[$b];wc.classList.remove(gd);wc.setAttribute(fb.a.Sga,"false")}this.element.classList.add(gd);this._element.setAttribute(fb.a.Sga,"true")};Qa.prototype.hNb=function(){(this.OI=
!this.OI)?this.Yye():this.Twh();this.p_f()};Qa.prototype.Rua=function($a){return $a+this.clientId};Qa.prototype.VYe=function($a){return String.format(this.K6h,$a.toString())};Mf.Object.defineProperties(Qa.prototype,{caption:{configurable:!0,enumerable:!0,get:function(){return this.oFc}},element:{configurable:!0,enumerable:!0,get:function(){return this._element||(this._element=this.fieldListSelector.getElementById(Qa.E$a+this.clientId))}},w4h:{configurable:!0,enumerable:!0,get:function(){return-1!==
this.parentId}},isCollapsed:{configurable:!0,enumerable:!0,get:function(){return this.OI}},isCollapsible:{configurable:!0,enumerable:!0,get:function(){return this.ADa}},isVisible:{configurable:!0,enumerable:!0,get:function(){return this.visible}},GFf:{configurable:!0,enumerable:!0,get:function(){return this.otg}}});Qa.QGf="bixflec_";Qa.mDd="bixfleci_";Qa.E$a="bixfli_";Qa.SGf="bixflil_";Qa.RGf="bixflg_";Object(ub.a)(Qa,"BixFieldListItem",null,[3]);var kd=Sys.EventArgs;Rk(pa,kd);Object(ub.a)(pa,"BixHierarchySelectionChangedEventArgs",
Sys.EventArgs,[]);var Fd=b(11),rb=Rc.a;Rk(Ua,rb);Ua.prototype.IFg=function($a){this.get_events().addHandler("SelectionChanged",$a)};Ua.prototype.vbj=function($a){this.get_events().removeHandler("SelectionChanged",$a)};Ua.prototype.dispose=function(){this.touchMode&&(nb.a.instance.Ba(kc.a.click,this.domElement,this.$c),this.touchMode=!1);this.sI=null;this.fieldListItems&&(Aa.a.oc(this.fieldListItems),this.fieldListItems=null);this.Hxa=null;rb.prototype.dispose.call(this)};Ua.prototype.focus=function(){this.setFocus(!0)};
Ua.prototype.JCg=function($a,$b){this.Hxa.add($a.toString(),$b)};Ua.prototype.Zdd=function($a){$a=$a.toString();return this.Hxa.kb($a)?this.Hxa.getItem($a):null};Ua.prototype.hasFocus=function(){var $a=Fc.DOMElementExtensions.Ip(this.sI);return $a?($a=$a.id)&&$a.startsWith(Qa.E$a)&&this.tM?!0:!1:!1};Ua.prototype.onKeyDown=function($a){$a=$a.keyCode;if(this.hasFocus()){var $b=!1;38===$a||40===$a?(this.s_(40===$a),$b=!0):37===$a||39===$a?($a=$a===this.v0c,$b=this.tM,$b.isCollapsible&&$b.isCollapsed!==
$a?this.hNb($b):$a&&$b.w4h&&this.s_(!1),$b=!0):13===$a||32===$a?(($a=this.tM)&&this.select($a),$b=!0):9===$a&&this.UFe(!0);return $b}return 9===$a?this.tM?this.EKb(this.tM):this.setInitialFocus(!0):!1};Ua.prototype.Qnj=function(){this.sI.setAttribute(fb.a.Sqe,"bix-drilldetails")};Ua.prototype.setFocus=function($a){return this.sI.firstChild?this.hasFocus()?this.s_($a):this.tM?this.EKb(this.tM):this.setInitialFocus($a):!1};Ua.prototype.start=function(){this.fe&&(this.select(this.fe.IVh()),this.tM&&
this.scroll(this.tM,!0))};Ua.prototype.IG=function(){var $a="";this.fieldListItems.forEach(function($b){$a=$b.Ape(0,$a)});this.sI=this.domElement;Fc.DOMElementExtensions.jv(this.sI,$a.toString());Fc.DOMElementExtensions.gu(this.sI,fb.a.L_b,null,null,null);this.sI.setAttribute(fb.a.Bt,uc.a.instance.ga(1175));this.sI.classList.add(tb.a.Lo);this.sI.style.position="relative"};Ua.prototype.aQh=function($a){for(;$a&&$a!==this.sI;){var $b=$a.id;if($b&&$b.startsWith(Qa.E$a))return $a;$a=$a.parentNode}return null};
Ua.prototype.d9e=function($a,$b,wc,Sc,yc){var Dd=this,Sd=wc;if(!$a||!$a.length)return{returnValue:null,gBb:wc,fe:Sc};for(var Fe=0,ze={},Ce=0,Ue=$a.length;Ce<Ue;ze={HO:ze.HO},Ce++)if(ze.HO=$a[Ce],Ua.sii($b,ze.HO))$a[Ce]=null,++Fe;else{ze.HO.ClientParentId=Sd;ze.HO.ClientId=++wc;if(ze.HO.IsCollapsible&&(ze.HO.Children=function(Oe){return function(){var Ta=Dd.d9e(Oe.HO.Children,$b,wc,Sc,yc);wc=Ta.gBb;Sc=Ta.fe;return Ta}}(ze)().returnValue,!ze.HO.Children)){$a[Ce]=null;++Fe;continue}5!==ze.HO.TypeTag&&
3!==ze.HO.TypeTag||ze.HO.PivotCacheIndex!==yc.HierarchyId||(ze.HO.UserRank=3,Sc=ze.HO)}return Fe?Fe===$a.length?{returnValue:null,gBb:wc,fe:Sc}:{returnValue:Ua.Z9i($a),gBb:wc,fe:Sc}:{returnValue:$a,gBb:wc,fe:Sc}};Ua.prototype.UFe=function($a){var $b=this.tM;$b&&($b.R5b(),this.sI.setAttribute(fb.a.z2,""));this.R5b();$a||(this.tM=null)};Ua.prototype.R5b=function(){this.L3f&&this.sI.classList.add(Kb.GLe)};Ua.prototype.s_=function($a){var $b=this.tM;if(!$b)return this.setInitialFocus($a);var wc=this.Hxa.values,
Sc=wc.length,yc=Array.indexOf(wc,$b);for(yc=$a?++yc:--yc;0<=yc&&yc<Sc;){$b=wc[yc];if($b.isVisible)return this.EKb($b),this.scroll($b,$a),!0;yc=$a?++yc:--yc}return!1};Ua.prototype.scroll=function($a,$b){var wc=$a.element;$a=wc.offsetHeight;wc=wc.offsetTop;var Sc=this.sI,yc=Sc.scrollTop,Dd=(Math.floor(Sc.clientHeight/$a)-3)*$a,Sd=Sc.scrollTop;$b?wc>yc+$a+Dd&&(Sd=wc-($a+Dd)):wc<yc+$a&&(Sd=wc-$a);Sc.scrollTop=Sd};Ua.prototype.setInitialFocus=function($a){for(var $b=this.Hxa.count,wc=$a?0:$b-1;0<=wc&&
wc<$b;){var Sc=this.Hxa.Wf(wc);if(Sc.isVisible)return this.EKb(Sc),this.scroll(Sc,!0),!0;wc=$a?++wc:--wc}return!1};Ua.prototype.EKb=function($a){this.tM&&$a!==this.tM&&this.UFe(!1);if(!$a)return!1;this.sI.setAttribute(fb.a.z2,$a.element.id);this.tM=$a;-1!==this.Auc&&($a.setFocus(),this.L3f&&this.sI.classList.remove(Kb.GLe));return!0};Ua.prototype.tSe=function($a){for(;$a&&$a!==this.sI;){var $b=$a.id;if($b.startsWith(Qa.E$a))return{returnValue:1,QXb:$a};if($b.startsWith(Qa.QGf)||$b.startsWith(Qa.mDd))return{returnValue:2,
QXb:$a};$a=$a.parentNode}return{returnValue:0,QXb:null}};Ua.prototype.fZe=function($a){if(!$a.id||!$a.id.startsWith(Qa.E$a)&&($a=this.aQh($a),!$a))return null;$a=$a.id.split("_")[1];return Dc.a.yc(this.Hxa.Zt,$a)};Ua.prototype.iqc=function($a){var $b=this.tSe($a);$a=$b.QXb;$b=$b.returnValue;if(0!==$b&&($a=this.fZe($a)))switch($b){case 2:this.hNb($a);break;case 1:this.select($a)}};Ua.prototype.select=function($a){if($a){$a.Zsj();this.EKb($a);if($a.isCollapsible&&($a=$a.rXe(null,-1).returnValue,!$a))return;
this.fe=$a;this.Auc!==$a.GFf&&(this.Auc=$a.GFf,this.aWf=$a.caption,this.raiseEvent("SelectionChanged",new pa(this.Auc,this.aWf)),this.hasFocus()||this.R5b())}};Ua.prototype.hNb=function($a){$a.hNb();$a.isCollapsed&&this.fe&&this.fe.Jfc($a)&&this.select($a);this.scroll($a,!$a.isCollapsed)};Ua.Rzh=function($a,$b){$a=bk($a);for(var wc=$a.next();!wc.done;wc=$a.next())if(wc=wc.value,11===wc.TypeTag&&wc.Name===$b)return wc;return null};Ua.sii=function($a,$b){switch($b.TypeTag){case 5:case 3:break;default:return!1}return 0<=
Fd.HelperMethods.jx($a,0,$a.nja(),$b.PivotCacheIndex,function(wc,Sc){return wc-Sc})};Ua.Z9i=function($a){for(var $b=null,wc=0;wc<$a.length;wc++)$a[wc]&&($b||($b=[]),$b.push($a[wc]));return $b};Mf.Object.defineProperties(Ua.prototype,{Nli:{configurable:!0,enumerable:!0,get:function(){return!!this.fieldListItems}}});Object(ub.a)(Ua,"BixFieldListSelector",Rc.a,[826]);var Kd=b(51),Qd=b(37),ve=b(218),Be=b(47),Ie=b(44),se=b(295),Se=b(294),Le=b(63),rf=xb.a;Rk(cb,rf);cb.prototype.eji=function($a){$a=document.getElementById($a);
return Fc.DOMElementExtensions.isVisible($a)?(this.Y$.setFocus(!0),!0):!1};cb.prototype.o_g=function($a){this.$Fc=$a;Pb.g(this.$).wo(!0);this.K7d=!0;this.close(2)};cb.prototype.dispose=function(){Aa.a.oc([this.$B,this.kNa,this.Y$,this.fieldListSelector]);this.ny=this.Y$=this.fieldListSelector=this.kNa=this.$B=null;this.Erc();this.$Fc=this.targetElement=this.r0b=null;rf.prototype.dispose.call(this)};cb.prototype.takeFocus=function(){this.setFocus()};cb.prototype.close=function($a){this.Erc();rf.prototype.close.call(this,
$a)};cb.prototype.gf=function($a){var $b=this;$a=void 0===$a?!1:$a;Qd.TaskExtensions.Aa(Kd.GetServiceTaskFactory.Ra(this.$.da,12,477,0),function(wc){$b.zSf||($b.kNa=wc.result.orb($b.Gb,500,null,null,739),$b.kNa.fSa())},this.$.la);return Qd.TaskExtensions.ts(Qd.TaskExtensions.Aa(Kd.GetServiceTaskFactory.create(this.$.da,84,this.la,0),function(wc){$b.$B=wc.result;$b.$B.init($b.domElement,$b.targetElement,document.body,$b.$.pa.displayRtl);$b.$B.uAe=8;$b.$B.Moe=!0;$b.$B.cGb=cb.M_h();$b.rTc();$b.$B.pn()},
this.la,3),function(){return ve.a.prototype.gf.call($b,$a)},this.la,3,Le.a.current)};cb.prototype.Jy=function(){return this.$Fc};cb.prototype.hha=function(){var $a=this;return function($b,wc,Sc){var yc=$a.$.oa.xa;$b=$a.cja($b);wc=$a.Caa(wc);var Dd=ac.M(yc,$a.ny.Dw,$a.ny.externalSourceIndex,$a.ny.qR);return ac.g(yc,"GetBixAnalysis",Dd,$b,wc,Sc,null,4)}};cb.prototype.onShow=function(){this.$B.qLd();rf.prototype.onShow.call(this)};cb.prototype.Xx=function($a){var $b=this,wc=$a.Result;if($a.Errors&&!$a.Errors.length&&
wc&&-1===wc.Context.HierarchyId)this.zSf=!0,this.kNa&&this.kNa.zdb(),Be.a.instance.create(this.Nzj,1,Ie.a.ANg,!0,!0),rf.prototype.Xx.call(this,$a,null,"");else{var Sc=function(yc){yc.wB=0;$b.pLa(169,function(Dd,Sd,Fe){var ze=$b.$.oa.xa,Ce=yc.GJ,Ue=yc.wrc,Oe=yc.wB;Dd=Se.b(Dd,$b.FKi);var Ta=ac.M(ze,yc.Dw,yc.externalSourceIndex,yc.N7g());Ta.type=4;Ta.version=Ce;Ta.relatedGroup=Ue;Ta.selectedTab=Oe;return ac.g(ze,"GetPivotFieldListData",Ta,Dd,Sd,Fe,wc,4)},16)};Qd.TaskExtensions.Aa(Kd.GetServiceTaskFactory.create(this.$.da,
110,this.la,0),function(yc){Sc(yc.result)},this.la,3)}};cb.prototype.onKeyDown=function($a){var $b=this.IVe();if($a.altKey&&85===$a.keyCode)this.close(1),wb.g($a);else if(117===$a.keyCode&&$a.ctrlKey)this.close(1),wb.g($a);else if(0===$b)13===$a.keyCode?this.close(1):rf.prototype.onKeyDown.call(this,$a);else{for(var wc=!1,Sc=0;3>Sc&&!wc;Sc++)2===$b?(wc=this.fieldListSelector.onKeyDown($a))||($b=1):1===$b&&((wc=this.Y$.onKeyDown($a))||($b=2));wc?wb.g($a):rf.prototype.onKeyDown.call(this,$a)}};cb.prototype.setFocus=
function(){(this.Y$||this.fieldListSelector)&&this.gLg(this.IVe())};cb.prototype.gLg=function($a){for(var $b=!1,wc=0;2>wc&&!$b;wc++)1===$a&&this.Y$?($b=this.Y$.setFocus(!0))||($a=2):2===$a&&this.fieldListSelector&&(($b=this.fieldListSelector.setFocus(!0))||($a=1))};cb.prototype.IVe=function(){if(!this.fieldListSelector||!this.Y$)return 0;var $a=this.fieldListSelector.hasFocus(),$b=this.Y$.hasFocus();return!$a&&!$b||$b?1:2};cb.prototype.jEj=function($a,$b){var wc=this.getElementById("bix-fieldlistselector");
this.fieldListSelector=new Ua(this.$,wc,$a,$b,this.touchMode);this.fieldListSelector.Nli?(this.r0b.setAttribute(fb.a.D_b,"true"),wc=this.getElementById("bix-drilldetails"),this.Y$=new Db(this.$,wc,this.ny,$b,this.fieldListSelector,this),this.fieldListSelector.Qnj(),this.fieldListSelector.start(),this.setFocus(),this.r0b.setAttribute(fb.a.D_b,"false")):(this.fieldListSelector.dispose(),this.fieldListSelector=null,Fc.DOMElementExtensions.jv(this.Gb,uc.a.instance.ga(1171)))};cb.prototype.rTc=function(){var $a=
this.JT=document.createElement("div");$a.classList.add(Kb.jmh);Rb.a.instance.ra(kc.a.pointerDown,$a,this.X8a);this.domElement.ownerDocument.body.appendChild($a)};cb.prototype.Erc=function(){this.JT&&(Rb.a.instance.Ba(kc.a.pointerDown,this.JT,this.X8a),Fc.DOMElementExtensions.ff(this.JT),this.JT=null)};cb.M_h=function(){return cb.cGb||(cb.cGb=[0,1,4,5])};Mf.Object.defineProperties(cb.prototype,{nc:{configurable:!0,enumerable:!0,get:function(){return"BIExploreCallout"}},kei:{configurable:!0,enumerable:!0,
get:function(){return this.K7d}},Fsa:{configurable:!0,enumerable:!0,get:function(){return 6}},sv:{configurable:!0,enumerable:!0,get:function(){return 561}}});cb.cGb=null;Object(ub.a)(cb,"BIExploreCallout",xb.a,[809,476]);var af=jb.a;Rk(eb,af);eb.prototype.dispose=function(){this.aha.dispose();this.$=null;af.prototype.dispose.call(this)};eb.prototype.getButton=function($a){return this.aha.getButton($a)};eb.prototype.Qzj=function($a,$b,wc,Sc){this.aha.hp($a+this.R1b,$b+this.R1b,wc,Sc)};eb.prototype.Rzj=
function(){var $a=Pb.g(this.$).ha.sa.activeCell,$b=Pb.g(this.$).eb.dj($a);($a=Pb.g(this.$).fg($a,$b))&&0<=$a.x&&0<=$a.y?this.hp($a.bottomRight.x+this.dz,$a.bottomRight.y+this.dz,Pb.g(this.$).rtl,$b):this.hide()};eb.prototype.hp=function($a,$b,wc,Sc){this.aha.hp($a,$b,wc,Sc)};eb.prototype.hide=function(){this.aha.hide()};eb.prototype.domElement=function($a){return this.aha.domElement($a)};eb.prototype.K1a=function($a){this.aha.K1a($a)};Mf.Object.defineProperties(eb.prototype,{dz:{configurable:!0,enumerable:!0,
get:function(){return this.aha.dz}},R1b:{configurable:!0,enumerable:!0,get:function(){return this.aha.R1b}}});Object(ub.a)(eb,"BIExploreLaunchButton",jb.a,[]);var xe=b(45);Na.prototype.reset=function(){this.Cib="";this.Zqa=this.bOc=this.aOc=null};Na.prototype.irj=function($a,$b){this.reset();this.Ygb=$b.confirmationRequiredForDataOps;this.eDa=$b.externalSourceIndex;this.bOc=$b.pivotTableName;this.Zqa=xe.o($a,this.$);$a.xd($b.HW)||$a.xd($b.fM)?($b=Pb.g(this.$).Ub($a),this.Cib=Ac.a.zg($b.text)):($a=
$a.top-$b.top,$b.dLd&&$b.dLd.length>$a&&(this.Cib=$b.dLd[$a]))};Na.prototype.koj=function($a,$b,wc){this.reset();this.eDa=$b.ExternalSourceIndex;this.Ygb=!!($b.Attributes&64);this.Cib=Ac.a.zg(wc.ValueString);this.aOc={};this.qR.ChartId=$a;this.qR.AnchorValue2=-1;switch(wc.Type){case 1:case 2:0<=wc.CategoryIndex?(this.qR.AnchorType=2,this.qR.AnchorValue1=wc.CategoryIndex):(this.qR.AnchorType=1,this.qR.AnchorValue1=wc.SeriesIndex);break;default:0>wc.CategoryIndex&&0<=wc.SeriesIndex?(this.qR.AnchorType=
1,this.qR.AnchorValue1=wc.SeriesIndex):(this.qR.AnchorType=3,this.qR.AnchorValue1=wc.SeriesIndex,this.qR.AnchorValue2=wc.CategoryIndex)}this.Zqa={};this.$.Lj(this.Dw);this.Dw.FirstRow=-1;this.Dw.FirstColumn=-1};Mf.Object.defineProperties(Na.prototype,{confirmationRequiredForDataOps:{configurable:!0,enumerable:!0,get:function(){return this.Ygb}},externalSourceIndex:{configurable:!0,enumerable:!0,get:function(){return this.eDa}},J6h:{configurable:!0,enumerable:!0,get:function(){return this.Cib}},PZ:{configurable:!0,
enumerable:!0,get:function(){return!!this.qR}},sbf:{configurable:!0,enumerable:!0,get:function(){return!!this.Dw}},qR:{configurable:!0,enumerable:!0,get:function(){return this.aOc}},pivotTableName:{configurable:!0,enumerable:!0,get:function(){return this.bOc}},Dw:{configurable:!0,enumerable:!0,get:function(){return this.Zqa}}});Object(ub.a)(Na,"BixSelectionContext",null,[]);var Td=b(1E3),Bc=b(234),qd=b(64),Jd=b(328),ad=b(253),Yd=b(918),pe=b(492),Wd=b(3),bf=b(95),ke=b(565),cf=b(58),Pe=jb.a;Rk(Z,Pe);
Z.prototype.$xe=function(){this.showCallout(!1)};Z.prototype.dispose=function(){this.gridView&&(this.gridView.qb.hIb(this.tya),this.gridView.Wb&&this.gridView.Wb.vk(this.Dh));if(this.$){var $a=this.$;$a.userOperationManager.so(this.eDf);$a.Ol(this.Fc);$a.gD(this.Oi);Pb.g($a).jy(this.iR);ke.a($a).jy(this.RDb)}Aa.a.Ia(this.Jh);this.ny=this.$=this.gridView=this.callout=this.Jh=null;Pe.prototype.dispose.call(this)};Z.prototype.Lc=function($a,$b){if(1529658657===$b&&(8===$a||!this.ny.sbf))return!0;1247109494!==
$b&&-498523270!==$b||this.Jx();return!1};Z.prototype.executeCommand=function($a,$b){this.callout?this.Jx():(this.scrollIntoView(),this.showCallout(3===$b.method));return cf.Task.Ua(!0)};Z.prototype.zc=function($a,$b){return 1529658657===$b.command};Z.prototype.Qc=function(){return!1};Z.prototype.Jx=function(){this.c0c();this.Jh.hide()};Z.prototype.Sf=function($a,$b){this.callout&&!$b&&this.callout.takeFocus();return!$b};Z.prototype.$g=function($a){return Fc.DOMElementExtensions.nf(this.ic,$a)};Z.prototype.ej=
function(){};Z.prototype.Aj=function(){};Z.prototype.oIf=function($a,$b,wc,Sc,yc){this.ny.reset();if(this.allow&&!qd.e(this.$.pa))if(wc&&wc.Attributes&512&&Sc&&$b){var Dd=this.$.cJ;this.c0c();this.ny.koj($b,wc,Sc);this.j6a()?($b=ke.a(this.$).domElement,wc=Fc.DOMElementExtensions.getLocation($b),Sc=Math.abs($b.scrollLeft),this.$.isChromeRtl&&(Sys.Browser.agent===Sys.Browser.Safari&&(Sc=$b.scrollWidth-$b.offsetWidth-Sc),Sc*=-1),$a=new Vb.a($a.x-wc.x+Sc,$a.y-wc.y+$b.scrollTop),Dd&&($a.x=$b.offsetWidth-
$a.x)):($b=this.gridView.Cf(yc).view.Fh,$a=Yd.a.hs($b,this.gridView.Cf(yc).domElement,new Sys.UI.Point(Math.round($a.x),Math.round($a.y)),Dd));this.Jh.Qzj($a.x,$a.y,Dd,yc)}else this.Jx()};Z.prototype.XLg=function($a){$a&&(this.gridView=$a,this.gridView.qb.fnb(this.tya),this.gridView.Wb.Ak(this.Dh))};Z.prototype.VW=function(){this.Ywj()?this.Jh.Rzj():this.Jh.hide()};Z.prototype.Ywj=function(){this.ny.reset();if(!this.allow||this.gridView.ha.Oa.Yb)return!1;var $a=pe.a(this.$).aKa();if(Object(Zb.a)(Bc.PivotTableRange,
$a)&&$a.supportsBIExplore){var $b=this.gridView.ha.sa.activeCell,wc=this.gridView.Ub($b);if($b&&wc&&this.gridView.ha.sa.l5){var Sc=$b.left-$a.left,yc=$b.top-$a.top;if(!($a.FZg&1<<Sc||$a.Whj&1<<yc||$a.zZg&1<<Sc||$a.Shj&1<<yc||wc.hasAutoFilter)&&(Sc=$b.xd($a.HW)||$b.xd($a.fM),yc=!1,$a.HW&&$a.fM?yc=$b.top<$a.HW.top&&$b.left<$a.fM.left||$b.top<$a.fM.top:$a.fM&&(yc=$b.top<$a.fM.top),!Sc&&!yc&&0<wc.text.length||Sc&&(0<wc.text.length||wc.Kwa||wc.s6a)))return this.ny.irj($b,$a),!0}}return!1};Z.prototype.showCallout=
function($a,$b){var wc=this;$b=void 0===$b?1:$b;pe.a(this.$).rx(this.ny.confirmationRequiredForDataOps,function(Sc){Sc&&wc.ny.sbf&&(wc.callout=new cb(wc.$,wc.ny,wc.Jh.domElement($b),$a),wc.callout.initialize(),wc.Jh.K1a($b),wc.callout.jP(wc.Ayd),wc.callout.gf());wc.Jh.getButton(1).obb()})};Z.prototype.c0c=function(){this.Jh.getButton(1).obb();this.callout&&!this.callout.kei&&(this.callout.zza(this.Ayd),this.callout.It(),this.callout=null)};Z.prototype.scrollIntoView=function(){var $a=this.gridView.ha;
if(1===$a.Pe){$a=$a.sa.activeCell;var $b=this.gridView.view.visibleArea,wc=this.gridView.fg($a);$b&&wc&&!$b.contains(wc)&&this.gridView.fr($a,3,bf.a.BNg)}};Z.prototype.j6a=function(){return this.$.ea.isNamedObjectViewMode&&qd.f(this.$.pa)};Z.ka=function($a,$b){Td.a($a)||$a.da.Ga(2,new Z($a,$b))};Mf.Object.defineProperties(Z.prototype,{ic:{configurable:!0,enumerable:!0,get:function(){return this.callout?this.callout.domElement:null}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return!!this.callout}},
Yd:{configurable:!0,enumerable:!0,get:function(){return ad.a.rXc}},qZe:{configurable:!0,enumerable:!0,get:function(){Mb.ULS.shipAssertTag(537170304,8,!Pb.g(this.$).eb.Ji,"GetLaunchMonocleButton is not supported in freeze pane");return Object(Za.a)(Sys.UI.Control,this.Jh.getButton(1))}},LZe:{configurable:!0,enumerable:!0,get:function(){return this.callout}},allow:{configurable:!0,enumerable:!0,get:function(){return this.$.Jf.get(6)&&1===this.state&&this.$.hc.x2(135200)}}});Object(ub.a)(Z,"BIExploreManager",
jb.a,[429,779,448,3,780]);var nc=b(10),Da=b(905),Sb=b(103),hb=b(520),Xb=b(151),jc=b(28),Wc=b(186);ha.prototype.Lc=function($a,$b){return(2140436015===$b||-1006032470===$b)&&!(new Xb.a(this.kzg)).Ud(8192)};ha.prototype.executeCommand=function($a,$b,wc,Sc){$a=$b.command;Sc=Sc.tja();switch($a){case 2140436015:case -1006032470:this.fieldManagerPane&&(this.fieldManagerPane.exc(!Sb.f(this.$.mg),$b,!1),Mb.ULS.sendTraceTag(537162717,0,50,"{0} Field List",2140436015===$a?"Show":"Hide"));break;case 589118293:case -1687560254:return this.M6b(!0,
!1,Sc);case 1176256599:return this.M6b(!1,!1,Sc);case -1751201991:return this.M6b(!0,!0,Sc);case -232434744:return this.M6b(!1,!0,Sc);default:return Wc.a($a)}return cf.Task.Ua(!0)};ha.prototype.zc=function($a,$b){$a=!1;switch($b.command){case 2140436015:case -1006032470:$a=!0;break;case 589118293:case -1687560254:case 1176256599:case -1751201991:case -232434744:$a=!0}return $a};ha.prototype.Qc=function(){return!1};ha.prototype.M6b=function($a,$b,wc){var Sc=this,yc=jc.a.Ta.Jb,Dd=Pb.g(this.$).ha.sa.activeCell;
return Qd.TaskExtensions.Aa(Kd.GetServiceTaskFactory.Ra(this.$.da,12,477,wc),function(){pe.a(Sc.$).rx(!1,function(Sd){if(Sd){Pb.g(Sc.$).wo(!0);var Fe=xe.o(Dd,Sc.$);Sc.$.Sb(-867563466,function(ze,Ce,Ue){return ac.K(Sc.$.oa.xa,Fe,0,!1,!1,!1,$a,$b,ze,Ce,Ue,null,null)},yc,0,6,161,function(){return new hb.a(Fe,$b)})}})},this.$.la,3)};ha.q0a=function($a,$b,wc){var Sc={};$a.Lj(Sc);Sc.FirstRow=$b;Sc.FirstColumn=wc;return Sc};Object(ub.a)(ha,"FieldListCommandHandler",null,[429]);var fd=Da.a;Rk(ma,fd);ma.prototype.Ad=
function(){var $a=this;Qd.TaskExtensions.Aa(Kd.GetServiceTaskFactory.Ra(this.$.da,16,74,this.hb),function($b){$a.jd([new ha($a.$,$b.result,$a.$.va)])},this.la,3)};ma.ka=function($a){Da.a.Qd(75,new ma($a))};Object(ub.a)(ma,"FieldListCommandHandlerFactory",Da.a,[]);var Tc=b(232);ya.prototype.N7g=function(){var $a={};$a.AnchorType=this.anchorType;7===this.anchorType&&($a.ChartId=this.chartId);$a.AnchorValue1=$a.AnchorValue2=-1;return $a};ya.j4b=function(){return new ya(null,-1)};ya.create=function($a,
$b){return new ya($a,$b)};ya.sgf=function($a,$b){return $a.dMa!==$b.dMa||$a.anchorType!==$b.anchorType||$a.chartId!==$b.chartId||$a.pivotTableName!==$b.pivotTableName||!!$a.Dw&&!!$b.Dw&&$a.Dw.SheetName!==$b.Dw.SheetName};ya.yni=function($a,$b){return ya.sgf($a,$b)||$a.wrc!==$b.wrc||$a.wB!==$b.wB};Mf.Object.defineProperties(ya.prototype,{wrc:{configurable:!0,enumerable:!0,get:function(){return this.Dde},set:function($a){this.Dde=$a}},wB:{configurable:!0,enumerable:!0,get:function(){return this.Xee},
set:function($a){this.Xee=$a}},GJ:{configurable:!0,enumerable:!0,get:function(){return this.j5d},set:function($a){this.j5d=$a}},lQ:{configurable:!0,enumerable:!0,get:function(){return this.k5d},set:function($a){this.k5d=$a}},dMa:{configurable:!0,enumerable:!0,get:function(){return this.vka||this.$gc}},Zji:{configurable:!0,enumerable:!0,get:function(){return this.dMa&&!this.Cod}},externalSourceIndex:{configurable:!0,enumerable:!0,get:function(){return this.eDa}},Dw:{configurable:!0,enumerable:!0,get:function(){return this.Zqa}},
sheetName:{configurable:!0,enumerable:!0,get:function(){return this.Dw?this.Dw.SheetName:null}},Mrb:{configurable:!0,enumerable:!0,get:function(){return this.chartId+"_"+this.pivotTableName+"_"+this.GJ+"_"+this.lQ}}});Object(ub.a)(ya,"FieldListRequestState",null,[807]);var td=Tc.a;Rk(ab,td);ab.prototype.create=function(){var $a=ya.create(this.$,-1);this.pb($a)};ab.prototype.dispose=function(){this.$=null;td.prototype.dispose.call(this)};ab.ka=function($a){$a.da.Ga(110,new ab($a))};Object(ub.a)(ab,
"FieldListRequestStateFactory",Tc.a,[]);var Tb=b(441),Fa=b(36),Qb=b(1001),cc=b(109),bc=b(4),Mc=b(86);Cb.prototype.zqf=function(){return this.xD=this.correlationId+1};Mf.Object.defineProperties(Cb.prototype,{correlationId:{configurable:!0,enumerable:!0,get:function(){return this.xD}}});Object(ub.a)(Cb,"DataRequestInfo",null,[]);Ob.Coh="ewa-flp-react-pane";Ob.Boh="ewa-flp-react-header";Ob.Doh="ewa-flp-react-title";Ob.zoh="ewa-flp-react-body";Ob.Aoh="ewa-flp-react-close-button";Ob.xoh="ewa-flp-border-ltr";
Ob.yoh="ewa-flp-border-rtl";Ob.qMe="ewa-flp-nov2";Object(ub.a)(Ob,"CssClassNames",null,[]);var rd=b(24),Hd=b(644),ic=b(177),Jc=b(255),zd=b(121),sd=b(620),Pd=b(22),De=b(7),lc=b(204),Pc=b(1521),md=b(951);Object(ub.a)(Wa,"FieldListTaskPaneProps",null,[]);vb.prototype.mI=function($a){var $b=this;lc.UISurfaces.Mj().then(function(wc){wc.showTaskPane("FieldListTaskPane",$b.Rv($a,-1,null,null,!1,-1,!1,0,-1,!1,null));return null})};vb.prototype.Mw=function($a,$b,wc,Sc,yc,Dd,Sd,Fe,ze,Ce,Ue){var Oe=this;lc.UISurfaces.Mj().then(function(Ta){Ta.updateTaskPane("FieldListTaskPane",
Oe.Rv($a,$b,wc,Sc,yc,Dd,Sd,Fe,ze,Ce,Ue));return null})};vb.prototype.Wza=function(){lc.UISurfaces.Mj().then(function($a){$a.setSelectedTaskPane("FieldListTaskPane");return null})};vb.prototype.JM=function(){lc.UISurfaces.Mj().then(function($a){$a.hideTaskPane("FieldListTaskPane",2);return null})};vb.prototype.Rv=function($a,$b,wc,Sc,yc,Dd,Sd,Fe,ze,Ce,Ue){var Oe=this;$b=Object(De.a)(new Wa,{type:"FieldListTaskPaneProps",fieldListItems:wc,fieldWellsItems:Sc,dataUpdateType:$b,isDataModel:yc,selectedTab:Dd,
isSortAscending:Sd,focusResetType:Fe,focusResetId:ze,isRichPivotFieldList:Ce,fieldListSearchInfo:Ue,isOlap:this.fieldManagerPane.wka,isPivotChart:this.fieldManagerPane.vka,fieldListSizePercentage:this.fieldManagerPane.r4i,onFieldExpandCollapse:this.fieldManagerPane.n4i,onExpandCollapseAll:this.fieldManagerPane.m4i,onFieldCheckedChanged:this.fieldManagerPane.w4i,onFieldListItemMenuClickV2:this.fieldManagerPane.p4i,onSortOrderChanged:this.fieldManagerPane.h4i,onSaveFieldListSizePercentage:this.fieldManagerPane.P4i,
onSearchInputChanged:this.fieldManagerPane.q4i,onSelectedTabChanged:function(Ta){Oe.fieldManagerPane.i4i(Ta)},onFieldMove:function(Ta,Ba,Jb,yd){Oe.fieldManagerPane.z4i(Ta,Ba,Jb,yd)},onFieldWellItemMenuClickV2:function(Ta,Ba,Jb,yd){Oe.fieldManagerPane.s4i(Ta,Ba,Jb,yd)}});if(Fa.a.ud(this.$))return Object(De.a)(new Pc.a,{contentProps:$b,onOpen:function(){Oe.fieldManagerPane.Wzf()},onClose:function(){Oe.fieldManagerPane.APi()},onManualClose:function(){Oe.fieldManagerPane.BPi()},title:this.fieldManagerPane.vka?
uc.a.instance.ga(1160):uc.a.instance.ga(1159),width:400,enableResize:!0,minResizeWidth:400,maxResizeWidth:950});$a=Object(De.a)(new md.a,{type:"ExcelLegacyTaskPaneProps",container:$a,paneProps:$b});return Object(De.a)(new Pc.a,{contentProps:$a,onOpen:function(){Oe.fieldManagerPane.Wzf()}})};Object(ub.a)(vb,"FieldListReactTaskPane",null,[823]);Object(ub.a)(kb,"MacroRecorderPivotTablePivotedAdditionalInformation",null,[]);Yb.prototype.getActiveCell=function(){return this.activeCell};Object(ub.a)(Yb,
"MacroRecorderPivotTablePivotedPayload",null,[438]);var bd=b(159),Od=b(91),le=b(31),dd=b(1),Zd=b(105),je=b(67),Ke=b(914);Object(ub.a)(Fb,"FieldListItem",null,[]);Object(ub.a)(zb,"FieldListSearchInfo",null,[]);Object(ub.a)(La,"FieldWellItem",null,[]);Object(ub.a)(ib,"FieldWellsItems",null,[]);var lf=b(618),nf=b(70),me=Rc.a;Rk(ob,me);ob.prototype.kP=function($a){this.get_events().addHandler(ob.vRe,$a)};ob.prototype.zR=function($a){this.get_events().removeHandler(ob.vRe,$a)};ob.prototype.VD=function($a){this.addHandler(ob.xtb,
$a)};ob.prototype.BF=function($a){this.removeHandler(ob.xtb,$a)};ob.prototype.mme=function($a){this.addHandler(ob.tRe,$a)};ob.prototype.jPf=function($a){this.removeHandler(ob.tRe,$a)};ob.prototype.lme=function($a){this.addHandler(ob.sRe,$a)};ob.prototype.iPf=function($a){this.removeHandler(ob.sRe,$a)};ob.prototype.lzj=function(){this.csa&&this.L6&&Fc.DOMElementExtensions.setVisible(this.L6,!1)};ob.prototype.qH=function(){this.lzj();this.domElement.classList.remove(this.$.isChromeRtl?ob.oyh:ob.nyh);
this.domElement.style.width=Fd.HelperMethods.jc(this.g$c);this.domElement.classList.add(ob.CBh)};ob.prototype.Zf=function(){};ob.prototype.Vo=function(){return this.MYa&&(!Sb.f(this.mg)||this.$.El)};ob.prototype.Nr=function(){var $a=ya.create(this.$,this.YGb);return $a.dMa&&!$a.Zji&&(this.$.El||!Sb.f(this.mg))};ob.prototype.mR=function(){};ob.prototype.xle=function($a,$b){($a=yb(this.Kj.FieldListItems,$a,this.currentState.wka?5:17,!0))&&$a.CanDrag&&this.AJ($a,$b,0,null,null)};ob.prototype.AJ=function($a,
$b,wc,Sc,yc){var Dd=this;if(Sc&&!Pd.a.equals(Sc,this.Mrb,!1))alert(uc.a.instance.Xa(18));else{var Sd=this.MVe($a.PivotCacheIndex,$a.PivotTableIndex);Sc=Sd.axis;var Fe=Sd.pos;var ze=Sd.NFf;if(-1!==$a.PivotTableIndex)var Ce=Sc;else Fe=Ce=0,ze=$a.PivotCacheIndex;if(0===Ce){if(7===$a.TypeTag&&($a=0<=$a.ClientParentId?qb(this.Kj.FieldListItems,$a.ClientParentId,!0):null,!$a))return;Fe=0;ze=$a.PivotCacheIndex}if(Ce!==$b||0===$b||Fe!==wc&&Fe!==wc-1){var Ue=new kb(Sc,$a.PivotCacheIndex,$a.Name);pe.a(this.$).rx(this.currentState.confirmationRequiredForDataOps,
function(Oe){Oe&&Dd.applyPivot(Dd.currentState,Ce,Fe,$a.TypeTag,ze,$b,wc,yc,Pb.g(Dd.$),Ue,$a)})}}};ob.prototype.z4i=function($a,$b,wc,Sc){if(this.Kj&&this.Ij){var yc=null;switch($b){case 0:yc=qb(this.Kj.FieldListItems,$a,!0);break;case 1:yc=qb(this.Ij.RowAxis,$a,!1);break;case 2:yc=qb(this.Ij.ColumnAxis,$a,!1);break;case 4:yc=qb(this.Ij.FilterAxis,$a,!1);break;case 8:yc=qb(this.Ij.DataAxis,$a,!1)}yc&&(Mb.ULS.sendTraceTag(554317779,0,50,"React Field List: drag and drop a field."),this.AJ(yc,wc,Sc,
null,null))}};ob.prototype.JKf=function($a,$b){var wc=!1;for(var Sc=0;Sc<$a.length;Sc++){var yc=$a[Sc];$b&&yc.IsCollapsible&&5===yc.TypeTag&&yc.IsCollapsed&&!yc.Children.length?(this.kW.push(yc),wc=!0):$b&&yc.IsCollapsible&&yc.IsCollapsed?yc.IsCollapsed=!1:$b||!yc.IsCollapsible||yc.IsCollapsed||(yc.IsCollapsed=!0);yc.IsCollapsible&&yc.Children&&0<yc.Children.length&&this.JKf(yc.Children,$b)&&(wc=!0)}return wc};ob.prototype.s$b=function($a,$b,wc,Sc,yc,Dd){if(this.Kj){var Sd=!1,Fe=!1,ze=!1,Ce=null;
ze=null;var Ue=$a;Sc&&0<this.kW.length&&Array.clear(this.kW);Ce=this.xbd(this.Kj.FieldListItems,Sc,!1);Fe=Ce.Kwb;ze=Ce.WHa;Sd=Ce.isRichPivotFieldList;Ce=Ce.returnValue;ze?this.R0b||this.x9c():(ze=new zb,ze.needSearchReset=Dd,ze.needSearchRestore=!Dd&&yc,ze.searchRestoreValue=ze.needSearchRestore?this.J6:"",ze.searchWithNoMatch=""!==this.J6&&!Fe,ze.searchWithNoMatch&&Sc&&Qd.TaskExtensions.Aa(Kd.GetServiceTaskFactory.Ra(this.$.da,211,212,0),function(Oe){Oe.result.readText(uc.a.instance.ga(777))},this.$.la,
3),""!==this.J6&&2===$a&&(ze.searchWithNoMatch?Ue=1:wc&&Ce&&0<Ce.length&&($b=Ce[0].id)),this.jua.Mw(this.csa,0,Ce,null,this.Kj.IsPpm,this.Kj.SelectedTab,this.Kj.IsSortAscending,Ue,$b,Sd,ze))}};ob.prototype.i4i=function($a){Mb.ULS.sendTraceTag(554317776,0,50,"React Field List: change All/Active tab.");this.YGb=$a;this.CGj()};ob.prototype.s4i=function($a,$b,wc,Sc){if(this.Ij){var yc=document.getElementById(wc);if(yc){var Dd=null,Sd=-1;switch($b){case 4:Dd=qb(this.Ij.FilterAxis,$a,!1);Sd=this.Ij.FilterAxis.length;
break;case 2:Dd=qb(this.Ij.ColumnAxis,$a,!1);Sd=this.Ij.ColumnAxis.length;break;case 1:Dd=qb(this.Ij.RowAxis,$a,!1);Sd=this.Ij.RowAxis.length;break;case 8:Dd=qb(this.Ij.DataAxis,$a,!1),Sd=this.Ij.DataAxis.length}if(Dd){$b={};this.currentState.vka?($b.AnchorType=8,$b.ChartId=this.currentState.chartId):$b.AnchorType=9;$b.AnchorValue1=Dd.PivotTableIndex;$b.AnchorValue2=Dd.PivotCacheIndex;$a=this.MVe(Dd.PivotCacheIndex,Dd.PivotTableIndex);var Fe=$a.axis;var ze=$a.pos;$a=new Od.a(-1453503574,0,this.$.Jc,
30,null);yc={domElement:yc};yc.fieldItem=Dd;yc.zoneCount=Sd;yc.sourceAxis=Fe;yc.sourceAxisPos=ze;yc.optionalPivotMenuAnchorParameter=$b;yc.isOlap=this.currentState.wka;yc.isPpm=this.Kj.IsPpm;yc.versionkey=this.Mrb;yc.isKeyboardInput=Sc;yc.cell=this.currentState.Dw;yc.externalSourceIndex=this.externalSourceIndex;Sc=!1;dd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ImplicitMeasureSupport",!1)&&this.currentState.wka&&!this.Kj.IsPpm&&this.Kj.SupportsImplicitMeasures&&(Dd=yb(this.Kj.FieldListItems,
Dd.PivotCacheIndex,5,!0),Sc=!!Dd&&!Dd.IsCollapsible);yc.fieldItemsupportsImplicitMeasures=Sc;this.uPa=wc;var Ce;this.UGb=!bd.a(Ce=this.$.Ka.Kb($a,yc))&&(6!==Ce.status||Ce.result)}}}};ob.prototype.o4i=function($a){var $b=this;$a&&Qd.TaskExtensions.Aa(Kd.GetServiceTaskFactory.Ra(this.$.da,103,104,0),function(wc){var Sc=wc.result,yc=Pb.g($b.$),Dd=xe.v(rd.Range.Tc(1,1),$b.$).SheetName;wc=Sc.mfb(yc);if(wc){Sc=wc.Fe;var Sd=Sc.jf.top;var Fe=Sc.jf.left;var ze=wc.xI.x;var Ce=wc.xI.y}else Sd=Fe=1,wc=Sc.nKa(yc),
ze=wc.x,Ce=wc.y;$b.$.userOperationManager.Sb(new ic.a(203,0,function(Ue,Oe,Ta){return Jc.s($b.$.oa.xa,Dd,$b.pivotName,$a.PivotCacheIndex,0,Sd,Fe,ze,Ce,Ue,Oe,Ta,null)},void 0,function(){return new Hd.a(Dd,$b.pivotName,$a.PivotCacheIndex,0)}),null)},this.$.la,8)};ob.prototype.dispose=function(){var $a;if(this.$){this.$.rl(this.Yc);this.$.Ka.BPf(this.Vzf);this.$.Ka.bIb(this.Uzf);Array.clear(this.kW);var $b=Pb.g(this.$);$b&&($b.EK(this.Aq),$b.yF(this.Cla),$b.ha&&($b.ha.PN(this.Cla),$b.ha.Oa.uaj(this.Lmc)),
$b.Ea&&$b.Ea.Dq(this.Nwf));null===($a=Zd.a(this.$))||void 0===$a?void 0:$a.usc(this.Lmc);$a=ke.a(this.$);(null===$a||void 0===$a?0:$a.Ea)&&$a.Ea.Dq(this.QDb);this.$.va&&this.$.va.vg(this.uh);if($a=this.$.ea)$a.Bw(this.Qf),$a.wk(this.Uc),$a.yR(this.qo);je.a(this.$)&&je.a(this.$).Zrc(this.xDf)}this.taskPaneManager&&this.taskPaneManager.BF(this.wCf);this.L6&&(nb.a.instance.Ba(kc.a.click,this.L6,this.Qj),cc.KeyInputManager.instance.pv(this.L6,this.vye));this.hideTaskPane();this.taskPaneManager=this.$=
this.jua=null;me.prototype.dispose.call(this)};ob.prototype.Sf=function($a,$b){if(!$b){$a=Fc.DOMElementExtensions.Cl(this.domElement.querySelectorAll(Fc.DOMElementExtensions.er));if(!$a)return!1;Fc.DOMElementExtensions.setFocus($a)}return!$b};ob.prototype.$g=function($a){return Fc.DOMElementExtensions.nf(this.ic,$a)};ob.prototype.ej=function(){};ob.prototype.Aj=function(){};ob.prototype.CGj=function(){this.refresh()};ob.prototype.woi=function($a,$b){$a&&$a.CanDrag&&this.AJ($a,$b?-1:0,-1,null,null)};
ob.prototype.k6=function(){this.Fka&&this.Vo()&&this.Nr()&&(this.isVisible=!0)};ob.prototype.Wzf=function(){this.JFd=!0;this.refresh()};ob.prototype.APi=function(){this.hideTaskPane()};ob.prototype.BPi=function(){this.BNd(!0,null);this.hideTaskPane()};ob.prototype.K9h=function(){this.n6a=this.yf=!0;this.Fka||this.hai();this.jua.mI(this.csa)};ob.prototype.showTaskPane=function(){this.isVisible=!0;""!==this.J6&&(this.HFd=!0);this.yf?this.Fka?this.jua.Wza():this.taskPaneManager.GF(this,!0):(this.yf=
!0,this.jua.mI(this.csa),this.Fka||this.taskPaneManager.GF(this,!0))};ob.prototype.hideTaskPane=function(){this.isVisible=this.JFd=this.yf=!1;this.jua.JM()};ob.prototype.exc=function($a,$b,wc){this.BNd($a,$b);this.Ond=wc;this.FNd=!$a&&!!$b||wc;$a?this.hideTaskPane():this.showTaskPane()};ob.prototype.x9c=function(){var $a=this;pe.a(this.$).rx(this.currentState.confirmationRequiredForDataOps,function($b){$b&&$a.expandPivotFieldListLevels($a.currentState)})};ob.prototype.AQ=function(){return!1};ob.prototype.KJg=
function(){var $a=document.getElementsByTagName("head")[0];if($a){var $b=document.createElement("link");$b.setAttribute("rel","stylesheet");$b.setAttribute("type","text/css");$b.setAttribute("href",Fc.DOMElementExtensions.jZ(this.domElement,"data-cssfile",null));$a.appendChild($b)}};ob.prototype.hai=function(){var $a=document.getElementById(this.$.yb+fb.a.uRe);if($a){this.KJg();$a.classList.add(ob.G4i);var $b=this.N8g();$a.appendChild($b);$b=Ke.b("div",ob.D4i,ob.C4i);$a.appendChild($b);this.csa=$b}};
ob.prototype.N8g=function(){var $a=Ke.b("div",ob.I4i,ob.H4i);this.VGb=Ke.b("span",ob.K4i,ob.J4i);this.VGb.innerText=this.titleText;this.L6=Qb.a.nb(ob.E4i,ob.F4i,uc.a.instance.ga(10),"ClosePaneGlyph_16x16x32",!1);this.L6.classList.add(bc.AFrameworkApplication.isRtl?fb.a.vaa:fb.a.waa);nb.a.instance.ra(kc.a.click,this.L6,this.Qj);this.vye=cc.KeyInputManager.instance.Xr(this.L6,this.Qj,Mc.a.Oh);this.$.El&&Fc.DOMElementExtensions.setVisible(this.L6,!1);$a.appendChild(this.VGb);$a.appendChild(this.L6);
return $a};ob.prototype.Ybg=function($a){if(this.Kj=$a)this.currentState.GJ=this.Kj.FieldListVersion,this.Iba=ec(this.Kj.FieldListItems,-1,this.Iba);if(this.Kj)if(this.yf){this.YGb=this.currentState.wB=this.Kj.SelectedTab;this.usi();$a=-1;var $b=0,wc=!1;this.FNd?(this.Kj.FieldListItems&&0<this.Kj.FieldListItems.length&&($a=this.Kj.FieldListItems[0].ClientId,$b=2,wc=!0),this.FNd=!1):this.Z9b&&0===this.K6&&(this.tPa||this.TGb?this.Kj.FieldListItems&&0<this.Kj.FieldListItems.length&&($a=this.TGb?this.Kj.FieldListItems[0].ClientId:
this.tPa.ClientId,$b=2,wc=this.TGb):this.NKf&&($a=this.Kj.FieldListItems[0].ClientId,$b=1),this.g2b());var Sc=!1;this.LKf!==this.Kj.PivotXluid&&(this.LKf=this.Kj.PivotXluid,Sc=!0,this.J6="");this.s$b($b,$a,wc,!1,!Sc&&this.HFd&&""!==this.J6,Sc);this.HFd=!1}else this.g2b()};ob.prototype.g2b=function(){this.K6=0;this.tPa=null;this.SGb="";this.Z9b=this.TGb=this.NKf=!1};ob.prototype.kxj=function($a){return 7===$a.TypeTag?!1:$a.ShowFilterArrow||$a.ShowCheckBox};ob.prototype.yoi=function($a){return $a.IsCollapsible&&
(!$a.IsCollapsed||2===$a.Image)&&!!$a.Children&&0<$a.Children.length};ob.prototype.Kwb=function($a,$b){var wc=$b.length;return 2<wc&&'"'===$b.charAt(0)&&'"'===$b.charAt(wc-1)?Pd.a.contains($a,$b.substring(1,wc-1),!0):Pd.a.b0a($b,"*")||Pd.a.b0a($b,"?")?($b=$b.replace(RegExp("[.*+?|()\\[\\]{}\\\\]","g"),"\\\\$&"),$b="^"+Pd.a.XPa(Pd.a.XPa($b,"\\\\?",".",!0),"\\\\*",".*",!0)+"$",0<=$a.search(new RegExp($b,"i"))):Pd.a.contains($a,$b,!0)};ob.prototype.xbd=function($a,$b,wc){var Sc,yc,Dd;var Sd=Dd=yc=Sc=
!1;for(var Fe=[],ze=0;ze<$a.length;ze++){var Ce=$a[ze],Ue=!1,Oe=!1,Ta=!1,Ba=[];if(""===this.J6){if(this.yoi(Ce)){Ba=this.xbd(Ce.Children,$b,!1);Oe=Ba.Kwb;var Jb=Ba.c6e;Ue=Ba.isRichPivotFieldList;Ba=Ba.returnValue;Ce.ShowCheckBox||(Ce.IsChecked=Jb)}}else if(2!==Ce.Image&&this.Kwb(Ce.Name,this.J6)&&(Sd=Ta=!0,$b&&Ce.IsCollapsible&&Ce.IsCollapsed&&(5!==Ce.TypeTag||Ce.Children.length?Ce.IsCollapsed=!1:(this.kW.push(Ce),Sc=!0))),$b&&wc&&Ce.IsCollapsible&&Ce.IsCollapsed&&(5!==Ce.TypeTag||Ce.Children.length?
Ce.IsCollapsed=!1:(this.kW.push(Ce),Sc=!0)),Ce.IsCollapsible&&Ce.Children&&0<Ce.Children.length){Ba=this.xbd(Ce.Children,$b,Ta||wc);Oe=Ba.Kwb;Jb=Ba.WHa;var yd=Ba.c6e;Ue=Ba.isRichPivotFieldList;Ba=Ba.returnValue;Ce.ShowCheckBox||(Ce.IsChecked=yd);Oe&&(Sd=!0,$b&&(Ce.IsCollapsed=!1));Jb&&(Sc=!0)}this.kli&&(Ue||66===Ce.TypeTag)&&(Dd=!0);Ce.IsChecked&&(yc=!0);if(""===this.J6||Ta||Oe||wc)Ue=new Fb,Ue.id=Ce.ClientId,Ue.name=Ce.Name,Ue.type=Ce.TypeTag,Ue.isCollapsible=Ce.IsCollapsible,Ue.showCheckBox=Ce.ShowCheckBox,
Ue.isMoreFields=2===Ce.Image,Ue.canDrag=Ce.CanDrag&&7!==Ce.TypeTag,Ue.showSeparator=Ce.ShowSeparator,Ue.showMenu=this.kxj(Ce),Ue.isCollapsed=Ce.IsCollapsed,Ue.isChecked=Ce.IsChecked,Ue.isBolded=Ce.IsBolded,Ue.children=Ba,Fe.push(Ue)}return{returnValue:Fe,Kwb:Sd,WHa:Sc,c6e:yc,isRichPivotFieldList:Dd}};ob.prototype.z$b=function($a){for(var $b=Array($a.length),wc=0;wc<$a.length;wc++){var Sc=$a[wc],yc=new La;yc.id=Sc.ClientId;yc.name=Sc.Name;$b[wc]=yc}return $b};ob.prototype.djj=function(){this.BUf(this.Kj.FieldListItems,
"")};ob.prototype.usi=function(){this.Ujf(this.Kj.FieldListItems,"")};ob.prototype.g9b=function($a,$b){return $a.Name+"_"+$a.UniqueName+"_"+$a.TypeTag+"_"+($b||this.Kah)};ob.prototype.BUf=function($a,$b){if($a)for(var wc=0,Sc=$a.length;wc<Sc;wc++){var yc=$a[wc],Dd="";if(yc.IsCollapsible||yc.Children)Dd=this.g9b(yc,$b),yc.IsCollapsible&&(this.y5c[Dd]=!!yc.IsCollapsed),yc.Children&&this.BUf(yc.Children,Dd);this.tPa&&yc.ClientId===this.tPa.ClientId&&(this.SGb=Dd||this.g9b(yc,$b))}};ob.prototype.Ujf=
function($a,$b){if($a)for(var wc=0,Sc=$a.length;wc<Sc;wc++){var yc=$a[wc],Dd="";if(yc.IsCollapsible||yc.Children)Dd=this.g9b(yc,$b),yc.IsCollapsible&&Dd in this.y5c&&(yc.IsCollapsed=Dc.a.wg(this.y5c,Dd)),yc.Children&&this.Ujf(yc.Children,Dd);this.SGb&&Pd.a.equals(this.SGb,Dd||this.g9b(yc,$b),!1)&&(this.tPa=yc,this.SGb="")}};ob.prototype.Pbg=function($a){if(this.Ij=$a)this.currentState.lQ=this.Ij.FieldWellVersion,this.Iba=ec(this.Ij.FilterAxis,-1,this.Iba),this.Iba=ec(this.Ij.ColumnAxis,-1,this.Iba),
this.Iba=ec(this.Ij.RowAxis,-1,this.Iba),this.Iba=ec(this.Ij.DataAxis,-1,this.Iba);this.kua?Array.clear(this.kua):this.kua=[];if(this.Ij)if(this.kua.push(this.Ij.FilterAxis),this.kua.push(this.Ij.ColumnAxis),this.kua.push(this.Ij.RowAxis),this.kua.push(this.Ij.DataAxis),this.yf){$a=-1;var $b=0;if(this.Z9b&&0!==this.K6){switch(this.K6){case 1:0<this.Ij.RowAxis.length&&($a=this.Ij.RowAxis[0].ClientId,$b=3);break;case 2:0<this.Ij.ColumnAxis.length&&($a=this.Ij.ColumnAxis[0].ClientId,$b=3);break;case 4:0<
this.Ij.FilterAxis.length&&($a=this.Ij.FilterAxis[0].ClientId,$b=3);break;case 8:0<this.Ij.DataAxis.length&&($a=this.Ij.DataAxis[0].ClientId,$b=3)}this.g2b()}var wc=new ib;wc.filtersWellItems=this.z$b(this.Ij.FilterAxis);wc.columnsWellItems=this.z$b(this.Ij.ColumnAxis);wc.rowsWellItems=this.z$b(this.Ij.RowAxis);wc.valuesWellItems=this.z$b(this.Ij.DataAxis);this.jua.Mw(this.csa,1,null,wc,!1,-1,!1,$b,$a,!1,null)}else this.g2b()};ob.prototype.yQj=function(){this.VGb&&(this.VGb.innerText=this.currentState.vka?
uc.a.instance.ga(1160):this.titleText)};ob.prototype.refresh=function(){if(this.JFd){var $a=ya.create(this.$,this.YGb);this.KMf($a)}};ob.prototype.KMf=function($a,$b){$b=void 0===$b?!1:$b;if(this.isVisible&&(this.Fka||this.csa)){$a=$a||ya.create(this.$,this.YGb);var wc=this.currentState;this.Kj&&this.djj();this.currentState=$a;if(ya.yni(wc,$a)||$b){if(this.Zob=!1,this.jQ.kl=$a.dMa,ob.vY(this.jQ),ya.sgf(wc,$a)||$b)this.kQ.kl=$a.dMa,ob.vY(this.kQ),this.Ybg(null),this.Pbg(null),this.yQj()}else wc.GJ<
$a.GJ?(this.jQ.kl=!0,ob.vY(this.jQ)):this.currentState.GJ=wc.GJ,wc.lQ<$a.lQ?(this.Zob=!1,this.kQ.kl=!0,ob.vY(this.kQ)):this.currentState.lQ=wc.lQ}Be.a.instance.create(this.$ga,0,Ie.a.myh,!0,!0)};ob.prototype.BNd=function($a,$b){this.applyPivotFieldManagerHiddenState($a,$b);this.mg=Fd.HelperMethods.bO($a,this.mg,4);this.refresh();this.raiseEvent(ob.xtb);this.Fka&&this.$.hf()};ob.prototype.applyPivotFieldManagerHiddenState=function($a,$b){var wc=this;this.$.userOperationManager.Sb(new ic.a(144,0,function(Sc,
yc,Dd){var Sd=xe.o(Pb.g(wc.$).ha.sa.activeCell,wc.$),Fe=wc.$.oa.xa,ze=Fe.Na(9);ze.hidden=$a;ze.activeCell=Sd;return ac.g(Fe,"ApplyPivotFieldManagerHiddenStateV2",ze,Sc,yc,Dd,null,0)},16),$b)};ob.prototype.dHf=function($a,$b,wc){wc.kl=!1;if(!wc.request||$b!==wc.correlationId)return!1;wc.request=null;return le.a.Qg($a.Errors)?(this.$.ea.fp($a.Errors),!1):!0};ob.prototype.Ruf=function($a,$b){var wc=zd.a.Mf($a.data);this.$.ea.fp(wc);$b.request=null;10!==$a.data.status&&($b.kl=!1);this.$ga()};ob.prototype.applyPivot=
function($a,$b,wc,Sc,yc,Dd,Sd,Fe,ze,Ce,Ue){var Oe=this;0<ze.getRangeInformation(ze.ha.sa.activeCell).length?this.Zob=!0:(this.jQ.kl=!0,this.kQ.kl=!0);$a.$gc&&(this.bGa=$a.pivotTableName);var Ta=ob.grb($a),Ba={FieldListType:1};Ba.FieldListVersion=$a.GJ;Ba.FieldWellVersion=$a.lQ;Ba.SourceAxis=$b;Ba.SourceAxisPosition=wc;Ba.ItemType=Sc;Ba.ItemIndex=yc;Ba.DestinationAxis=Dd;Ba.DestinationAxisPosition=Sd;this.rSj(Ue,$b,Dd);$b=new ic.a(145,0,function(Jb,yd,Nd){var Je=Oe.$.oa.xa;Jb=Se.b(Jb,Oe.KFi);var Re=
ac.M(Je,$a.Dw,$a.externalSourceIndex,Ta);Re.pivotFieldApplyData=Ba;return ac.g(Je,"ApplyPivot",Re,Jb,yd,Nd,null,0)},4,function(){return new Yb(Oe.pivotName,Ba,Ce,$a.Dw)});this.$.userOperationManager.Sb($b,Fe);this.tdh=Dd};ob.prototype.rSj=function($a,$b,wc){if(this.Kj&&this.Ij)if(0===$b)this.K6=0,this.tPa=$a;else if(0!==wc)this.K6=wc;else switch(this.K6=0,this.TGb=!0,$b){case 1:1<this.Ij.RowAxis.length&&(this.K6=1);break;case 2:1<this.Ij.ColumnAxis.length&&(this.K6=2);break;case 4:1<this.Ij.FilterAxis.length&&
(this.K6=4);break;case 8:1<this.Ij.DataAxis.length&&(this.K6=8)}};ob.prototype.expandPivotFieldListLevels=function($a){var $b=this,wc=ob.grb($a);this.R0b=!0;this.$.userOperationManager.Sb(new ic.a(146,0,function(Sc,yc,Dd){var Sd=$b.$.oa.xa;Sc=Se.b(Sc,$b.oJi);var Fe=ac.M(Sd,$a.Dw,$a.externalSourceIndex,wc);Fe.type=1;return ac.g(Sd,"ExpandPivotFieldListLevels",Fe,Sc,yc,Dd,null,0)}),null)};ob.prototype.MVe=function($a,$b){for(var wc,Sc,yc=ob.ggg;yc<=ob.hgg;yc++){var Dd=this.kua[yc];for(wc=Dd.length-
1;0<=wc;wc--)if(Sc=Dd[wc],Sc.PivotCacheIndex===$a&&(-1===$b||Sc.PivotTableIndex===$b))return $a=this.jTh(yc),Sc=Sc.PivotTableIndex,{returnValue:!0,axis:$a,pos:wc,NFf:Sc}}return{returnValue:!1,axis:0,pos:-1,NFf:-1}};ob.prototype.koi=function($a){return $a>=ob.ggg&&$a<=ob.hgg};ob.prototype.clear=function(){this.currentState=ya.j4b();this.refresh()};ob.prototype.jTh=function($a){return this.koi($a)?this.tyh[$a]:0};ob.prototype.jHb=function($a,$b){$a&&(this.bGa=null);this.refresh();$b&&(this.Fka?!this.yf&&
this.Nr()&&this.Vo()?this.showTaskPane():!this.yf||this.Vo()&&this.Nr()||this.hideTaskPane():this.raiseEvent(ob.xtb))};ob.prototype.JGh=function(){var $a=Pb.g(this.$),$b=null;$a=$a.getRangeInformation($a.ha.sa.activeCell);for(var wc=0,Sc=$a.length;wc<Sc;++wc){var yc=$a[wc];if(Object(Zb.a)(Bc.PivotTableRange,yc)){$b=yc.pivotTableName;break}}return $b};ob.prototype.Zbg=function($a){var $b=Pb.g(this.$),wc=$b.Ea.ll($a);if(wc){if(this.bGa){$a=wc.ranges;if(!$a)return;for(wc=$a.length-1;0<=wc;--wc){var Sc=
$a[wc];if(Object(Zb.a)(Bc.PivotTableRange,Sc)&&Pd.a.equals(Sc.pivotTableName,this.bGa,!1)){$a=this.JGh();$a&&Pd.a.equals($a,this.bGa,!1)||($a=xe.v(Sc.topLeft,this.$),$b.gg($a,null,null,null,0,bf.a.ryh));this.bGa=null;break}}}Pb.g(this.$).gp||this.refresh()}else Mb.ULS.sendTraceTag(537162690,0,15,"Block {0} was removd from BlockManager",$a)};ob.prototype.HK=function(){this.clear()};ob.wLg=function($a,$b,wc){var Sc=sd.a($a);if(!Sc){var yc=document.getElementById($a.yb+fb.a.uRe);yc?Sc=$a.da.Ga(16,new ob(yc,
$a,$b,wc)):Mb.ULS.sendTraceTag(537162688,0,15,"FieldManagerPane creation fails: FieldManagerPaneDiv is null.")}return Sc};ob.grb=function($a){var $b={};$b.AnchorType=$a.anchorType;7===$a.anchorType&&($b.ChartId=$a.chartId,$b.AnchorValue1=$b.AnchorValue2=-1);return $b};ob.vY=function($a){$a.request&&(bc.AFrameworkApplication.qd.ku($a.request.Dt),$a.request=null)};Mf.Object.defineProperties(ob.prototype,{pivotName:{configurable:!0,enumerable:!0,get:function(){return this.currentState.pivotTableName}},
chartId:{configurable:!0,enumerable:!0,get:function(){return this.currentState.chartId}},Dw:{configurable:!0,enumerable:!0,get:function(){return this.currentState.Dw}},wka:{configurable:!0,enumerable:!0,get:function(){return this.currentState.wka}},vka:{configurable:!0,enumerable:!0,get:function(){return this.currentState.vka}},confirmationRequiredForDataOps:{configurable:!0,enumerable:!0,get:function(){return this.currentState.confirmationRequiredForDataOps}},externalSourceIndex:{configurable:!0,
enumerable:!0,get:function(){return this.currentState.externalSourceIndex}},GJ:{configurable:!0,enumerable:!0,get:function(){return this.currentState.GJ}},lQ:{configurable:!0,enumerable:!0,get:function(){return this.currentState.lQ}},Mrb:{configurable:!0,enumerable:!0,get:function(){return this.currentState.Mrb}},isRtl:{configurable:!0,enumerable:!0,get:function(){return this.Vi}},TPd:{configurable:!0,enumerable:!0,get:function(){return this.MYa&&!this.$.El}},xka:{configurable:!0,enumerable:!0,get:function(){return!(!this.isVisible||
this.jQ.kl||this.kQ.kl||this.R0b||this.Zob)}},parentElement:{configurable:!0,enumerable:!0,get:function(){return this.$.El?null:this.$.domElement}},ic:{configurable:!0,enumerable:!0,get:function(){return this.domElement}},isVisible:{configurable:!0,enumerable:!0,get:function(){return Object(nf.a)(ob.prototype,this,"isVisible")},set:function($a){$a=this.NYa&&$a;!$a||this.csa||this.n6a||this.K9h();$a!==Object(nf.a)(ob.prototype,this,"isVisible")&&(Object(nf.b)(ob.prototype,this,"isVisible",$a),this.raiseEvent(ob.xtb));
this.KMf(null,$a)}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return this.isVisible}},Yd:{configurable:!0,enumerable:!0,get:function(){return ad.a.pyh}},Ng:{configurable:!0,enumerable:!0,get:function(){return 1}},Jk:{configurable:!0,enumerable:!0,get:function(){return tb.a.lth}},MM:{configurable:!0,enumerable:!0,get:function(){return uc.a.instance.ga(1046)}},ko:{configurable:!0,enumerable:!0,get:function(){return this.$.El?this.g$c:this.h$c}},isResizable:{configurable:!0,enumerable:!0,
get:function(){return!0}},titleText:{configurable:!0,enumerable:!0,get:function(){return uc.a.instance.ga(1159)}},r4i:{configurable:!0,enumerable:!0,get:function(){return this.pde}},SF:{configurable:!0,enumerable:!0,get:function(){var $a=this;return this.taskPaneManager.Cua(this.ic,this.titleText,this.ko,this.isResizable,function(){$a.isVisible=!0},function(){$a.isVisible=!1},function(){$a.isVisible=!0},function(){$a.isVisible=!1},this.ko)}},MYa:{configurable:!0,enumerable:!0,get:function(){return this.$.hc.x2(36896)&&
this.NYa}},NYa:{configurable:!0,enumerable:!0,get:function(){var $a=new Xb.a(this.$.va);return this.$.isEditMode&&$a.Ud(8192)||!$a.fj}},Kah:{configurable:!0,enumerable:!0,get:function(){return(this.pivotName||"")+(this.chartId||"")}}});ob.xtb="fieldListPaneVisibilityChanged";ob.tRe="FieldListPaneChanging";ob.sRe="FieldListPaneChanged";ob.vRe="FieldManagerRemovePaneEventKey";ob.CBh=lf.a.qMe;ob.oyh=Ob.yoh;ob.nyh=Ob.xoh;ob.ggg=0;ob.hgg=3;ob.I4i="FieldListReactPaneHeaderId";ob.D4i="FieldListReactPaneBodyId";
ob.K4i="FieldListReactPaneTitleId";ob.E4i="FieldListReactPaneCloseButtonId";ob.G4i=Ob.Coh;ob.H4i=Ob.Boh;ob.J4i="cui-taskPaneTitle "+Ob.Doh;ob.C4i=Ob.zoh;ob.F4i=Ob.Aoh;Object(ub.a)(ob,"FieldManagerPane",Rc.a,[806,406,3,494,448]);var $e=Tc.a;Rk(Ha,$e);Ha.prototype.create=function(){var $a=this,$b=Kd.GetServiceTaskFactory.Ra(this.$.da,12,477,this.hb),wc=Tb.a(this.$),Sc=[$b,wc];if(!Fa.a.ud(this.$)){var yc=Kd.GetServiceTaskFactory.create(this.$.da,203,this.la,this.hb),Dd=Kd.GetServiceTaskFactory.create(this.$.da,
155,this.la,this.hb);Sc.push(yc);Sc.push(Dd)}Qd.TaskExtensions.Aa(Qd.TaskExtensions.Vd(Sc,this.la),function(){var Sd=ob.wLg($a.$,wc.result,$b.result);Sd&&(Fa.a.ud($a.$)||wc.result.GQ(Sd),Sd.k6());$a.pb(Sd)},this.la,3)};Ha.prototype.dispose=function(){this.$=null;$e.prototype.dispose.call(this)};Ha.ka=function($a){$a.da.Ga(74,new Ha($a))};Object(ub.a)(Ha,"FieldManagerTaskPaneFactory",Tc.a,[]);var we=b(162),Ya=b(83),h=b(564);Object(ub.a)(Ia,"SelectedRangeForPivot",null,[]);var lb=b(617),Ub=b(202),zc=
b(324),vc=b(150),ud=b(180);Mf.Object.defineProperties(V,{Vf:{configurable:!0,enumerable:!0,get:function(){return vc.a.No(V.vbi,ud.a.ga(66),ud.a.ga(67),ud.a.ga(68),ud.a.ga(69),ud.a.ga(70),ud.a.ga(71),ud.a.ga(72))}}});V.vbi="<div class='DataSourceDiv' id='DataSourceDiv'> <div class='WACDialogRow' id='dataAnalyzeTitle'> <label id='dataChoice' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRowNoBreak' id='sourceRadio'> <label id='sourceSelectLabel' class='WACDialogLabel' >{1}</label> </div> <div class='ewa-insertpt-dlg-sourceRange WACDialogRowNoBreak' id='sourceRangeText'> <label id='tableOrRange' class='ewa-insertpt-dlg-label' for='SourceRange' >{2}</label> <input type='text' id='sourceRange' class='WACDialogInput ewa-insertpt-dlg-input' aria-describedby=\"dataChoice . sourceSelectLabel\" maxlength=\"1024\" spellcheck=\"false\" autocomplete=\"off\" autocomplete=\"off\"/> </div> </div> <div class='PivotDestinationDiv' id='PivotDestinationDiv'> <div class='WACDialogRow' id='destinationTitle'> <label id='destinationLabel' class='WACDialogLabel' >{3}</label> </div> <div class='WACDialogRowNoBreak' id='destinationPickNewWorksheet'> <input type='radio' id='newWorksheet' name='destinationRadio' class='WACDialogRadio ewa-insertpt-label' alt='{4}' aria-describedby=destinationLabel title='{4}'></input> <label id='newWorksheetLabel' class='WACDialogLabel' for='newWorksheet' >{4}</label> </div> <div class='WACDialogRowNoBreak' id='destinationPickExistingWorksheet'> <input type='radio' id='existingWorksheet' name='destinationRadio' class='WACDialogRadio ewa-insertpt-label' alt='{5}' aria-describedby=destinationLabel title='{5}'></input> <label id='existingWorksheetLabel' class='WACDialogLabel' for='existingWorksheet' >{5}</label> <div class='WACDialogRowNoBreak' id='destinationRangeText'> <label id='Location' class='ewa-insertpt-dlg-label' for='DestinationRange' >{6}</label> <input type='text' id='destinationRange' class='WACDialogInput ewa-insertpt-dlg-input' maxlength=\"1024\" spellcheck=\"false\" autocomplete=\"off\" autocomplete=\"off\"/> </div> </div>";
Object(ub.a)(V,"InsertPivotTableDialogHtml",null,[]);var Gd=b(168),od=b(388);sa.prototype.bindAction=function($a){this.cab&&$a&&(this.uqc=$a,this.cab.GDg(this.uqc))};sa.prototype.LNj=function(){this.cab&&this.uqc&&this.cab.P$i(this.uqc)};sa.prototype.isValid=function(){return!!this.cab&&!!this.textBox};Mf.Object.defineProperties(sa.prototype,{textBox:{configurable:!0,enumerable:!0,get:function(){return this.bXb}},cab:{configurable:!0,enumerable:!0,get:function(){return this.Stg}}});Object(ub.a)(sa,
"TextBoxRadioButtonPair",null,[834]);var Ae=b(1080),Ne=b(296);Object(ub.a)(za,"DialogData",null,[]);Object(ub.a)(na,"MacroRecorderPivotTableCreatedPayload",null,[438]);var gf=b(408),Ja=b(169),Lb=b(225),mc=gf.a;Rk(qa,mc);qa.prototype.V3a=function($a){var $b=mc.prototype.V3a.call(this,$a);var wc=$b.Qhc;$b=$b.returnValue;if(!$b){var Sc=Object(Za.a)(Lb.a,this.$.vb);Sc&&Sc.Jj($a)&&($b=($a=Sc.getItemByName($a))&&1!==$a.type?2===$a.type?Ja.a($a):$a.usedRange:null,wc=2===$a.type)}return{returnValue:$b,Qhc:wc}};
Object(ub.a)(qa,"PivotTableRangeHighlightPolicy",gf.a,[]);var xc=zc.a;Rk(da,xc);da.prototype.dispose=function(){Mb.ULS.sendTraceTag(537155782,0,50,"InsertPivotTableDialog.Dispose");this.AAc();xc.prototype.dispose.call(this)};da.prototype.bja=function(){var $a;return $a=new Ub.a,$a.add(da.Oxc),$a.add(da.Z5b),$a};da.prototype.Kdh=function(){var $a=!1;2!==this.Fu&&($a=da.Mdh(this.bSa.value));$a||1===this.Fu||($a=da.Ldh(this.jaa.checked,this.destinationRange.value));return $a};da.prototype.oec=function($a){Mb.ULS.sendTraceTag(537155779,
0,50,"InsertPivotTableDialog.InitAndShow");var $b=this.dMh();this.Vf=$b.Vf;var wc="";2!==this.Fu&&(wc=da.XBd($a.Lda,this.$.va));var Sc=da.XYe(wc,$a.$5b);1===this.Fu?this.JCj=wc:2===this.Fu&&(this.nGe=$a.$5b);this.FLb(!1,!1);this.initializeAndShow($b.title,this.X9e,Sc);this.nTd();this.Apj();this.QNb();Mb.ULS.sendTraceTag(537155778,0,50,"InsertPivotTableDialog.InitAndShow completed.")};da.prototype.ICj=function($a,$b){$b=(new qa($b)).V3a($a);$a=$b.Qhc;$b=$b.returnValue;return!!$b&&$b.m5&&!$a};da.prototype.QNb=
function(){this.Mob.disabled=this.Kdh()};da.prototype.nTd=function(){this.FQ.ra(kc.a.change,this.Vxa,this.xmc);this.FQ.ra(kc.a.change,this.jaa,this.xmc);this.FQ.ra(kc.a.Gd,this.bSa,this.hCf);this.FQ.ra(kc.a.Gd,this.destinationRange,this.Wuf);this.CDg(this.au);this.OAa=!0};da.prototype.AAc=function(){this.OAa&&(this.FQ.Ba(kc.a.change,this.Vxa,this.xmc),this.FQ.Ba(kc.a.change,this.jaa,this.xmc),this.FQ.Ba(kc.a.Gd,this.bSa,this.hCf),this.FQ.Ba(kc.a.Gd,this.destinationRange,this.Wuf),this.M$i(this.au),
this.OAa=!1)};da.prototype.Apj=function(){2===this.Fu?this.destinationRange.focus():this.bSa.focus()};da.prototype.q6f=function(){var $a=new Ne.a(this.destinationRange),$b=new Ae.a(this.jaa,!1);this.tUd=new sa($a,$b);this.pTd(this.tUd)};da.prototype.Wag=function(){this.bXd(this.tUd)};da.prototype.Dl=function(){xc.prototype.Dl.call(this);Mb.ULS.sendTraceTag(537155777,0,50,"InsertPivotTableDialog.InitializeDialogElements");this.bSa=document.getElementById(da.Oxc);this.Vxa=document.getElementById(da.Iqf);
this.jaa=document.getElementById(da.t9c);this.destinationRange=document.getElementById(da.Z5b);switch(this.Fu){case 0:case 2:this.destinationRange.value?da.a_f(this.jaa,this.Vxa):(this.destinationRange.disabled=!0,da.a_f(this.Vxa,this.jaa));Sb.k(this.$.mg)&&(this.Vxa.checked=!1,this.Vxa.disabled=!0,this.destinationRange.value="",this.jaa.checked=!0);if(2===this.Fu){this.bSa.disabled=!0;var $a=document.getElementById(da.Tah);$a.style.visibility="hidden";$a.style.display="none"}break;case 1:this.destinationRange.disabled=
!0,this.Vxa.disabled=!0,this.jaa.disabled=!0,$a=document.getElementById(da.CXi),$a.style.visibility="hidden",$a.style.display="none"}};da.prototype.Oai=function($a,$b){var wc=this;Mb.ULS.sendTraceTag(537155744,0,50,"InsertPivotTableDialog.InitiateInsertPivotTableOperation");var Sc=this.$.oa.xa,yc=1,Dd=Sc.Pb(),Sd=xe.o(Pb.g(this.$).ha.sa.activeCell,this.$),Fe=null,ze=null;switch(this.Fu){case 0:yc=132;Fe=function(Ce,Ue,Oe){Ce=Se.b(Ce,wc.Jzd);var Ta=Sc.Na(41,void 0===Dd?null:Dd);Ta.sheetRange=$a;Ta.destinationRange=
$b;return ac.g(Sc,"InsertPivotTable",Ta,Ce,Ue,Oe,null,0)};ze=function(){return new na($a,$b)};break;case 2:yc=219;Fe=function(Ce,Ue,Oe){return ta(Sc,Sd,$b,!1,Se.b(Ce,wc.Jzd),Ue,Oe,null,Dd)};break;case 1:yc=219,Fe=function(Ce,Ue,Oe){return ta(Sc,Sd,$a,!0,Se.b(Ce,wc.Jzd),Ue,Oe,null,Dd)}}od.a(this.$.userOperationManager,Fe,function(Ce){return new ic.a(yc,0,Ce,void 0,ze)},null)};da.prototype.dMh=function(){var $a=0;switch(this.Fu){case 0:$a=65;break;case 1:$a=2127;break;case 2:$a=2123}return new za(uc.a.instance.ga($a),
V.Vf)};da.prototype.ppj=function(){var $a=this.$.da.za(16);$a&&$a.exc(!1,null,!0)};da.prototype.FLb=function($a,$b){var wc=!$a,Sc=this.$.da.za(183);Sc&&Sc.z2f(wc,$b);$a&&this.gridView.hg&&this.gridView.hg.vo(fb.a.m4)};da.XYe=function($a,$b){var wc=!$b,Sc={};return Sc[da.Oxc]=$a,Sc[da.Z5b]=$b,Sc[da.Iqf]=wc,Sc[da.t9c]=!wc,Sc};da.a_f=function($a,$b){$a.tabIndex=da.kCh;$b.tabIndex=da.YCi};da.XBd=function($a,$b){$a=$a.startsWith("=")?$a.substring(1,$a.length):$a;var wc=xe.Z($a,$b);var Sc=wc.sheetName;
var yc=wc.range;wc.returnValue&&yc&&(Sc||(Sc=$b.pa.name),$a=xe.x(yc,Sc,!1,!0));return $a};da.Mdh=function($a){return Pd.a.tq($a)};da.Ldh=function($a,$b){return $a&&Pd.a.tq($b)};Mf.Object.defineProperties(da.prototype,{nc:{configurable:!0,enumerable:!0,get:function(){return"InsertPivotTableDialog"}},cellPickerSupportOnlyRanges:{configurable:!0,enumerable:!0,get:function(){return!0},set:function($a){Object(nf.b)(da.prototype,this,"cellPickerSupportOnlyRanges",$a)}},nwe:{configurable:!0,enumerable:!0,
get:function(){return!0}},mwe:{configurable:!0,enumerable:!0,get:function(){return!0}},onCommitDialogHandler:{configurable:!0,enumerable:!0,get:function(){var $a=this;return function(){var $b=$a.destinationRange.value;1!==$a.Fu&&$a.destinationRange.disabled&&($b="");$a.X9e(1,da.XYe($a.bSa.value,$b))}},set:function($a){Object(nf.b)(da.prototype,this,"onCommitDialogHandler",$a)}}});da.OJe="";da.kCh=0;da.YCi=-1;da.Oxc="sourceRange";da.Z5b="destinationRange";da.Iqf="newWorksheet";da.t9c="existingWorksheet";
da.Tah="DataSourceDiv";da.CXi="PivotDestinationDiv";Object(ub.a)(da,"InsertPivotTableDialog",zc.a,[]);xa.prototype.Lc=function(){return!1};xa.prototype.executeCommand=function($a,$b,wc){var Sc=this,yc;$a=Qd.TaskExtensions.jk();var Dd=$b.command,Sd=new we.a;$b=this.gridView.ha.sa;switch(Dd){case 2137617149:$a=dd.EwaSettings.isChangeGateEnabled("OfficeVSO:6557360_PTPSFixMinifyBug")?null!==(yc=wc.Oig)&&void 0!==yc?yc:$b.selectedRanges:"StartingRanges"in wc?Array.isArray(wc.StartingRanges)?wc.StartingRanges:
null:$b.selectedRanges;this.yUh($a,Sd);if(this.$.Jf.get(29)&&dd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.Ideas",!1)&&this.yjd){var Fe=new we.a;Sd.task.Io(function(Oe){wc.SourceSelection=bd.b(Oe)&&Oe.result&&Oe.result.Lda?Oe.result.Lda:"";return Sc.$.Fd(-1444574190,0,0,wc).continueWith(function(Ta){bd.b(Ta)&&Ta.result||(ze=new da(Sc.$,Dd),ze.oec(Oe.result));Fe.setResult(!0)})});$a=Fe.task}else{var ze=new da(this.$,Dd);$a=Sd.task.continueWith(function(){ze.oec(Sd.task.result)})}break;
case -1128516639:var Ce=this.$.oa.xa.Pb(),Ue=xe.o($b.activeCell,this.$);yc=function(Oe,Ta,Ba){return ia(Sc.$.oa.xa,Ue,Se.b(Oe,function(Jb){Sc.xwf(Jb,Sd,!1)}),Se.a(Ta,function(){xa.wwf(Sd,Sc.$)}),Ba,null,Ce)};yc=dd.EwaSettings.Zb()?new ic.a(554,0,yc,88):new h.a(554,0,yc,24);yc.pna(function(){return!0});this.$.userOperationManager.Sb(yc,null);ze=new da(this.$,Dd);$a=Sd.task.continueWith(function(){ze.oec(Sd.task.result)});break;case -63037693:yc=new Ia;if($b=this.gridView.Ab.Qo($b.activeCell))$b=rd.Range.Tc($b.xTf+
1,$b.left),yc.$5b=xe.h($b,this.$,!0,void 0,!0);Sd.setResult(yc);ze=new da(this.$,Dd);$a=Sd.task.continueWith(function(){ze.oec(Sd.task.result)})}return $a};xa.prototype.xwf=function($a,$b,wc){var Sc=$a.Result,yc=new Ia;if(wc||Sc){var Dd=this.gridView.ha.sa.sg;se.a($a)?Dd&&(yc.Lda=this.gridView.ha.Z0e(!0)):(yc.Lda=Sc,Dd&&wc&&this.Jjh()&&!this.gridView.Ab.dk(this.gridView.ha.sa.Vc)&&(yc.$5b=this.gridView.ha.Kbd(!0,!0)))}else if($a=this.gridView.Ab.Qo(this.gridView.ha.sa.activeCell))yc.Lda=$a.dataSource;
$b.setResult(yc)};xa.prototype.Jjh=function(){var $a=this.gridView.ha.sa.activeCell;$a=new rd.Range($a.top,$a.left,$a.top+1,$a.left+1,!1,!1);$a=this.gridView.Xj("InsertPivotTableCommandHandler.EmptySquareAdjToActiveCell",$a);try{for($a.$$rst();$a.$$mn();)if($a.$$cu().text)return!1}finally{$a&&$a.dispose()}return!0};xa.prototype.yUh=function($a,$b){var wc=this;if(1!==$a.length)$b.setResult(Object(De.a)(new Ia,{Lda:""}));else{$a=$a[0];var Sc=this.gridView.Ab.dk($a);if(Sc)$b.setResult(Object(De.a)(new Ia,
{Lda:Sc.name,sourceRange:Sc.usedRange}));else{var yc=this.$.oa.xa.Pb(),Dd=xe.o($a,this.$),Sd=xe.v($a,this.$);$a=function(Fe,ze,Ce){function Ue(Oe){return Oe(wc.$.oa.xa,Sd,Dd,Se.b(Fe,function(Ta){wc.xwf(Ta,$b,!0)}),Se.a(ze,function(){xa.wwf($b,wc.$)}),Ce,null,yc)}return Kd.GetServiceTaskFactory.Ra(wc.$.da,482,483,1).Io(function(Oe){bd.b(Oe)&&Ue(Oe.result.getExpandedRangeForPivotTable)})};$a=dd.EwaSettings.Zb()?new ic.a(511,0,$a,88):new h.a(511,0,$a,24);$a.pna(function(){return!0});this.$.userOperationManager.Sb($a,
null)}}};xa.prototype.zc=function($a,$b){$a=!1;switch($b.command){case -1128516639:case -63037693:case 2137617149:$a=!0}return $a};xa.prototype.Qc=function(){return!1};xa.wwf=function($a,$b){Mb.ULS.sendTraceTag(537155786,0,50,"OnGetExpandedRangeForPivotTableFailedCallback: Failure. failing over to the selected range.");Pb.g($b).ha.sa.sg?$a.setResult(Object(De.a)(new Ia,{Lda:Pb.g($b).ha.Xha})):$a.setResult(Object(De.a)(new Ia,{Lda:""}))};xa.e8e="ExcelIdeas";Object(ub.a)(xa,"InsertPivotTableCommandHandler",
null,[429]);var hd=Da.a;Rk(Ga,hd);Ga.prototype.Ad=function(){var $a=this,$b=Kd.GetServiceTaskFactory.create(this.$.da,128,this.la,this.hb);Qd.TaskExtensions.Aa(Qd.TaskExtensions.Vd([$b],this.la),function(){$a.jd([new xa($a.$)])},this.la,3)};Ga.ka=function($a){Da.a.Qd(91,new Ga($a))};Object(ub.a)(Ga,"InsertPivotTableCommandHandlerFactory",Da.a,[]);var Cd=b(389),dc=Cd.a;Rk(Ka,dc);Ka.prototype.Zdh=function($a){var $b=this;Qd.TaskExtensions.Aa(Kd.GetServiceTaskFactory.Ra(this.$.da,103,104,0),function(wc){var Sc=
wc.result,yc=Pb.g($b.$),Dd=Sc.mfb(yc);if(Dd){var Sd=Dd.Fe;wc=Sd.jf.top;Sd=Sd.jf.left;Sc=Dd.xI.x;Dd=Dd.xI.y}else wc=Sd=1,Dd=Sc.nKa(yc),Sc=Dd.x,Dd=Dd.y;yc=0;for(var Fe=bk($a),ze=Fe.next();!ze.done;ze=Fe.next())$b.ybi(parseInt(ze.value,10),wc,Sd,Sc+yc,Dd+yc),yc+=22},this.$.la,8)};Ka.prototype.ybi=function($a,$b,wc,Sc,yc){var Dd=this,Sd=new ic.a(203,0,function(Fe,ze,Ce){var Ue=Dd.$.oa.xa.Pb();return Jc.s(Dd.$.oa.xa,Dd.GCd,Dd.pivotTableName,$a,0,$b,wc,Sc,yc,Fe,ze,Ce,Ue)},void 0,function(){return new Hd.a(Dd.GCd,
Dd.pivotTableName,$a,0)});this.$.userOperationManager.Sb(Sd,null)};Ka.prototype.Pai=function(){var $a=this,$b=new ic.a(596,0,function(wc,Sc,yc){var Dd=$a.$.oa.xa.Pb();return Jc.i($a.$.oa.xa,$a.pivotTableName,$a.GCd,Se.b(wc,$a.TKi),Sc,yc,Dd)},16);this.$.userOperationManager.Sb($b,null)};Mf.Object.defineProperties(Ka.prototype,{nc:{configurable:!0,enumerable:!0,get:function(){return"InsertSlicerDialog"}}});Object(ub.a)(Ka,"InsertSlicerDialog",Cd.a,[]);db.prototype.Lc=function(){return!1};db.prototype.executeCommand=
function($a,$b){$a=Qd.TaskExtensions.jk();$b=$b.command;this.activeCell=this.ha.sa.activeCell;switch($b){case -1924368815:(this.rc=Pb.g(this.$).Ab.Qo(this.activeCell))&&!this.rc.isOlap&&new Ka(this.$,this.rc.pivotTableName,this.$.va.pa.sheetName)}return $a};db.prototype.zc=function($a,$b){$a=!1;switch($b.command){case -1924368815:$a=!0}return $a};db.prototype.Qc=function(){return!1};Object(ub.a)(db,"InsertSlicerCommandHandler",null,[429]);var Ec=Da.a;Rk(ra,Ec);ra.prototype.Ad=function(){this.jd([new db(this.$)])};
ra.ka=function($a){Da.a.Qd(353,new ra($a))};Object(ub.a)(ra,"InsertSlicerCommandHandlerFactory",Da.a,[]);var gb=b(81),Bb=b(392),qc=b(615),Nc=b(341),nd=b(30),Vd=b(657),oe=b(59),qe=b(197),ee=b(119);oa.prototype.executeCommand=function($a,$b){return cf.Task.Ua(this.interactiveReportView.refreshSelectedConnection($b))};oa.prototype.zc=function($a,$b){return 32===$a&&2054778433===$b.command};oa.prototype.Qc=function(){return!1};oa.prototype.Lc=function($a,$b){return 32===$a&&(1588554917===$b||1891435765===
$b||2054778433===$b&&!this.interactiveReportView.phc)};oa.ka=function($a,$b){$a.Ka.i2(new oa($b))};Object(ub.a)(oa,"InteractiveReportCommandHandler",null,[429]);var re=b(129);ba.prototype.eRa=function(){};ba.prototype.setVisible=function($a){this.iframe&&this.iframe.style&&(this.iframe.style.visibility=$a?"visible":"hidden")};ba.prototype.dispose=function(){Aa.a.Ia(this.sia);this.sia=null};Mf.Object.defineProperties(ba.prototype,{C$:{configurable:!0,enumerable:!0,get:function(){return this.iframe}},
m9e:{configurable:!0,enumerable:!0,get:function(){return 1}},contentWindow:{configurable:!0,enumerable:!0,get:function(){return this.iframe.contentWindow}}});Object(ub.a)(ba,"IFrameContentElement",null,[869,3]);aa.prototype.eRa=function($a){this.d5a&&(this.d5a.src="data:image/png;charset=utf-8;base64,"+$a,Fc.DOMElementExtensions.setVisible(this.d5a,!0))};aa.prototype.setVisible=function($a){Fc.DOMElementExtensions.setVisible(this.J6b,$a)};aa.prototype.dispose=function(){};Mf.Object.defineProperties(aa.prototype,
{C$:{configurable:!0,enumerable:!0,get:function(){return this.J6b}},m9e:{configurable:!0,enumerable:!0,get:function(){return 7}},contentWindow:{configurable:!0,enumerable:!0,get:function(){return null}}});Object(ub.a)(aa,"ImageContentElement",null,[869,3]);Xa.prototype.eRa=function($a){this.hG.eRa($a)};Xa.prototype.pTa=function(){this.interactiveReportView.isVisible&&this.C$&&this.C$.style&&(Fc.DOMElementExtensions.vI(this.C$,this.interactiveReportView.domElement.clientHeight),Fc.DOMElementExtensions.rv(this.C$,
this.interactiveReportView.domElement.clientWidth))};Xa.prototype.setVisible=function($a){this.hG.setVisible($a)};Xa.prototype.okh=function(){Aa.a.Ia(this.wpc);this.wpc=Be.a.instance.create(this.eYi,2E3,Ie.a.aci)};Xa.prototype.dispose=function(){Fc.DOMElementExtensions.ff(this.hG.C$);Aa.a.oc([this.wpc,this.hG]);this.s7d=this.hG=this.wpc=null};Mf.Object.defineProperties(Xa.prototype,{interactiveReportView:{configurable:!0,enumerable:!0,get:function(){return this.s7d}},awa:{configurable:!0,enumerable:!0,
get:function(){return this.Ypg}},iXj:{configurable:!0,enumerable:!0,get:function(){return this.$.workbookContext.WorkbookUri}},C$:{configurable:!0,enumerable:!0,get:function(){return this.hG.C$}},contentWindow:{configurable:!0,enumerable:!0,get:function(){return this.hG.contentWindow}}});Object(ub.a)(Xa,"InteractiveReportFrameInfo",null,[3]);Object(ub.a)(ua,"InteractiveReportSheetData",null,[]);Object(ub.a)(va,"SheetVisibilityStateData",null,[]);var Ze=b(42),mf=b(56),Pa=b(6),Wb=b(41),Lc=Nc.a;Rk(ja,
Lc);ja.prototype.a7a=function(){return!0};ja.prototype.dispose=function(){if(this.$){var $a=this.$;$a.va.DK(this.mo);$a.vb.DK(this.mo);$a.vb.vg(this.oe);$a.va.vg(this.oe);Ze.a($a).Eq(this.Qzf);$a.gD(this.Oi);$a.ob.zsc(this.s6);$a.ob.ysc(this.r6);$a.Ka.BPf(this.syf);$a.Ka.bIb(this.Yx);this.TIb.BF(this.GAf);this.TIb=null}this.n5a&&(this.n5a.Dq(this.ef),this.n5a.YH(this.Dm));dd.EwaSettings.Zb()&&this.jy(this.fya);Array.contains(ja.$ja,this)&&Array.remove(ja.$ja,this);this.clearCache();Aa.a.oc([this.jSa,
this.n5a,this.Mi]);this.Mi=this.n5a=this.jSa=null;Fc.DOMElementExtensions.ff(this.domElement);this.dwc.clear();this.l3.clear();this.Q0b=this.businessBar=this.PAb=this.ita=this.K0a=this.xIb=null;Lc.prototype.dispose.call(this)};ja.prototype.refreshSelectedConnection=function($a){var $b=this.U0e();if($b){var wc=$b.IsEmbedded?-1:$b.SourceIndex;pe.a(this.$).kHb($b.ConnectionName,wc,$a);return!0}return!1};ja.prototype.P$b=function($a){var $b=this;Mb.ULS.sendTraceTag(537155663,0,15,"InteractiveReportView.GetBootstrapData()");
var wc=this.$,Sc=this.xIb;if(mf.c(wc))Mb.ULS.sendTraceTag(537155662,0,50,"InteractiveReportView.GetBootstrapData: During RenderCachedContent");else if(je.a(wc).ii.activityName!==Pa.a.idle)this.Yzc=!0;else{this.Yzc=!1;var yc=function(Dd,Sd,Fe){var ze=wc.oa.xa.Pb(),Ce=wc.oa.xa;Dd=Se.b(Dd,$b.lKi);ze=Ce.Na(1,ze);ze.connectionsOnly=!!Sc;return ac.g(Ce,"GetInteractiveReportBootstrapData",ze,Dd,Sd,Fe,$a,0)};dd.EwaSettings.Zb()?wc.userOperationManager.Sb(new ic.a(512,0,yc,64),null):wc.userOperationManager.Sb(new h.a(512,
0,yc),null)}};ja.prototype.U0e=function(){for(var $a=0;$a<this.l3.count;++$a)for(var $b=this.l3.Wf($a),wc=bk($b.SlidesIds),Sc=wc.next();!Sc.done;Sc=wc.next())if(Sc.value===this.ita)return $b;return null};ja.prototype.Xzg=function($a,$b){this.hashCode=this.Ea.yra($a,$b,this.hashCode)};ja.prototype.clearCache=function(){this.Ea.OPa(this.hashCode);this.hashCode=null};ja.prototype.Z$e=function(){this.s7c();var $a=this.$.pa;return this.isVisible=!!$a&&qd.j($a)};ja.prototype.WAg=function(){Array.contains(ja.$ja,
this)||ja.$ja.push(this)};ja.prototype.sUg=function(){Aa.a.Ia(this.jSa);this.jSa=null};ja.prototype.iSa=function($a){var $b=this;this.Z$e()&&(this.WAg(),this.sUg(),Qd.TaskExtensions.Aa(this.ape,function(){var wc=6===$b.ape.status;wc&&!$b.yLe&&($b.Vbi(),$b.yLe=!0);$b.Z$e()&&($b.lsi($a||!wc),wc||$b.E2i(),$b.$.dba||$b.focus())},this.kEj,0))};ja.prototype.s7c=function(){var $a=this.$.workbookContext.WorkbookFileVersionId;$a&&(this.PAb||(this.PAb=$a),this.PAb!==$a&&this.o2b())};ja.prototype.wMf=function($a){this.K0a=
$a.DataSources;$a=bk($a.DataConnections);for(var $b=$a.next();!$b.done;$b=$a.next()){$b=$b.value;var wc=$b.ConnectionName.toLowerCase(),Sc=this.l3.getItem(wc);Sc&&(Sc.ConnectionString!==$b.ConnectionString||new Date(Sc.RefreshTimestampUTC)<new Date($b.RefreshTimestampUTC))&&($b.IsEmbedded&&this.s5i($b.SecurityToken),this.E6i($b.DataSourceName),this.l3.remove(wc));this.l3.add(wc,$b)}this.lMa(8)&&this.isVisible&&this.Neb(this.Mi,null)};ja.prototype.s5i=function($a){if(this.Pwa){var $b=bc.AFrameworkApplication.qd.r7a,
wc=this.$.ea.sessionId;try{InteractiveReportAPI.Rebind(this.Mi.contentWindow,this.Mi.awa,this.K0a,$a,$b,wc)}catch(Sc){Mb.ULS.sendTraceTag(537155657,0,10,"RebindInteractiveReport: Failed to call Rebind: {0}",Sc.message)}}};ja.prototype.E6i=function($a){if(this.Pwa){var $b=bc.AFrameworkApplication.qd.r7a,wc=this.$.ea.sessionId;try{InteractiveReportAPI.Refresh(this.Mi.contentWindow,this.Mi.awa,0,$a,$b,wc)}catch(Sc){Mb.ULS.sendTraceTag(537155655,0,10,"RefreshInteractiveReport: Failed to call Refresh: {0}",
Sc.message)}}};ja.prototype.ona=function($a){if($a.Zc.block.pa.active){$a=$a.Zc.block.ke;var $b=new ua($a.SlideId,$a.FallbackImage);this.dwc.add(this.fYb,$b);this.Mi.interactiveReportContent||(this.Mi.interactiveReportContent=$a);this.Neb(this.Mi,$b)}};ja.prototype.dri=function($a){if(this.Pwa)try{InteractiveReportAPI.LeaveSlide(this.Mi.contentWindow,this.Mi.awa)}catch($b){Mb.ULS.sendTraceTag(537155651,0,10,"LeaveInteractiveReport(): Failed to call LeaveSlide: {0}",$b.message)}this.ita=null;$a&&(this.Mi.setVisible(!1),
this.$.isEditMode&&this.mFd(!0))};ja.prototype.o2b=function(){Aa.a.Ia(this.Mi);this.Mi=null;this.l3.clear();this.dwc.clear();this.xIb=this.K0a=this.ita=null;this.Yzc=this.MOb=!1;this.PAb=this.$.workbookContext.WorkbookFileVersionId;this.clearCache()};ja.prototype.JNb=function(){if(this.Mi&&this.MOb&&qd.j(this.$.pa))try{InteractiveReportAPI.UnHideWindowedElements(this.Mi.contentWindow,this.Mi.awa),this.MOb=!1}catch($a){Mb.ULS.sendTraceTag(537155618,0,10,"UnHideInteractiveReport: UnHideWindowedElements failed - {0}",
$a.message)}};ja.prototype.Adc=function(){if(this.Mi&&!this.MOb&&qd.j(this.$.pa))try{InteractiveReportAPI.HideWindowedElements(this.Mi.contentWindow,this.Mi.awa),this.MOb=!0}catch($a){Mb.ULS.sendTraceTag(537155617,0,10,"HideInteractiveReport: HideWindowedElements failed - {0}",$a.message)}};ja.prototype.lsi=function($a){var $b=this.$;if(this.Mi)this.JNb(),this.Mi.pTa(),this.Mi.setVisible(!0);else{try{InteractiveReportAPI.ClearState()}catch(Dd){}var wc=this.domElement.id+"_irframe",Sc=document.getElementById(wc);
Sc&&this.domElement.removeChild(Sc);Sc=$b.hc;$a=$a||!(Sc.allowFiltering&&Sc.allowSorting&&Sc.allowInteractivity);var yc=this.eci;yc&&(Sc.allowHyperlinks||(yc+=ja.Zbi),Sc.inEmbedView&&(yc+=ja.$bi),Sc.isBiPreviewOverride&&(yc+=ja.Wbi));this.Mi=new Xa(this,wc,yc,$a||!this.rtb,$b);this.domElement.appendChild(this.Mi.C$);$a||this.rtb||(this.Mi.HZ=8)}(this.Pwa||this.lMa(1)||this.lMa(7))&&this.Neb(this.Mi,this.eYb);this.Xzg($b.pa,oe.a.H5b)};ja.prototype.lAe=function($a){var $b=this;$a.HZ=2;pe.a(this.$).rx(!0,
function(wc){$a.HZ=8;wc&&($b.rtb=!0,$b.o2b(),$b.iSa(!1))})};ja.prototype.BUi=function($a){for(var $b=this.l3.count,wc=Array($b),Sc=0;Sc<$b;++Sc){var yc=this.l3.Wf(Sc),Dd={};Dd.Name=yc.ConnectionName;Dd.UXj=yc.ConnectionString;Dd.SecurityToken=yc.SecurityToken;Dd.DataSourceName=yc.DataSourceName;Dd.hYj=0>yc.SourceIndex&&yc.IsEmbedded;wc[Sc]=Dd}$b=bc.AFrameworkApplication.qd.r7a;Sc=this.$.ea.sessionId;yc=this.eYb.Hxc;try{InteractiveReportAPI.OpenReport($a.contentWindow,$a.awa,this.xIb,null,yc,this.K0a,
wc,$a.iXj,$b,Sc),this.$.isEditMode&&this.mFd()}catch(Sd){Mb.ULS.sendTraceTag(537155605,0,10,"OnGetBootstrapDataSuccess: Failed to call OpenReport: {0}",Sd.message);return}$a.HZ=5;this.ita=yc;this.Neb($a,null)};ja.prototype.Neb=function($a,$b){switch($a.HZ){case 6:this.eRa(this.Mi,$b);break;case 1:this.rtb?(this.P$b($a),$a.HZ=3):this.lAe($a);break;case 4:$a.l$e&&$a.interactiveReportContent&&this.BUi($a);break;case 5:this.TBi($a,$b);break;case 8:this.PXf($b);this.lAe($a);break;case 7:this.PXf($b)}};
ja.prototype.Vbi=function(){try{InteractiveReportAPI.RegisterEvent("Initialized",ja.dci),InteractiveReportAPI.RegisterEvent("UserInteractivity",ja.ici),InteractiveReportAPI.RegisterEvent("GetFallbackImage",ja.bci),InteractiveReportAPI.RegisterEvent("HostKeyPressed",ja.cci),dd.EwaSettings.ma(34)&&InteractiveReportAPI.RegisterEvent("UserModifiedPV",ja.Ybi)}catch($a){}};ja.prototype.LOb=function($a){return!!this.Mi&&!!this.Mi.C$&&this.Mi.contentWindow===$a};ja.prototype.PMi=function($a){this.LOb($a)&&
(this.Mi.l$e=!0,this.lMa(5)?this.Mi.HZ=4:this.lMa(6)&&(this.Mi.HZ=1),this.isVisible&&this.Neb(this.Mi,this.eYb))};ja.prototype.QMi=function($a){if(this.isVisible&&this.LOb($a)&&ee.a(jc.a.Ta,this.WAb)>=ja.ppi&&this.$.ea.dc){this.WAb=jc.a.Ta.Jb;$a=this.$.oa.xa;var $b=this.zLi,wc=$a.Na(1,null);ac.g($a,"GetSessionInformation",wc,$b,null,null,null,4)}};ja.prototype.NMi=function($a,$b){if(this.LOb($a)){var wc=this.$,Sc=$b.SessionId;$b.VXj&&($a=function(yc,Dd,Sd){var Fe=wc.oa.xa.Pb(),ze=wc.oa.xa;yc=Se.b(yc);
Fe=ze.Na(9,Fe);Fe.sessionId=Sc;return ac.g(ze,"InteractiveReportDataWasModified",Fe,yc,Dd,Sd,null,0)},dd.EwaSettings.Zb()?wc.userOperationManager.Sb(new ic.a(513,0,$a,64),null):wc.userOperationManager.Sb(new h.a(513,0,$a),null))}};ja.prototype.kMi=function($a,$b){if(this.LOb($a)&&$b){$a=[];$b.mYj&&$a.push("Control");$b.nYj&&$a.push("Meta");$b.lYj&&$a.push("Alt");$b.oYj&&$a.push("Shift");var wc=document.createEvent("KeyboardEvent");wc.initKeyboardEvent("keypress",!0,!0,null,String.fromCharCode($b.jYj),
0,$a.join(" "),!1);$b=new Sys.UI.DomEvent(wc);$b=this.$.shortcutKeyManager.Qt($b);this.executeRibbonCommand($b)}};ja.prototype.executeRibbonCommand=function($a){1461300262!==$a&&($a=new Od.a($a,1,1,6,null),this.$.Ka.Kb($a))};ja.prototype.OMi=function($a){this.LOb($a)&&(this.Mi.HZ=6,this.eRa(this.Mi,this.eYb))};ja.prototype.PXf=function($a){this.isVisible&&$a&&$a.Z8b&&this.Mi.eRa($a.Z8b)};ja.prototype.eRa=function($a,$b){if(this.isVisible&&$b&&$b.Z8b)try{InteractiveReportAPI.SetFallbackImage($a.contentWindow,
$a.awa,$b.Z8b)}catch(wc){}};ja.prototype.TBi=function($a,$b){if(this.isVisible){if($b&&(!this.ita||$b.Hxc!==this.ita)){var wc=bc.AFrameworkApplication.qd.r7a,Sc=this.$.ea.sessionId;try{this.$.isEditMode&&this.mFd(),InteractiveReportAPI.Navigate($a.contentWindow,$a.awa,$b.Hxc,wc,Sc)}catch(yc){Mb.ULS.sendTraceTag(537155593,0,10,"NavigateToActiveSheetSlide: Failed to call InteractiveReportApi.Navigate: {0}",yc.message);return}this.ita=$b.Hxc}this.LGb(!0)}};ja.prototype.lMa=function($a){return!!this.Mi&&
this.Mi.HZ===$a};ja.prototype.mFd=function($a){var $b=this;$a=void 0===$a?!1:$a;this.businessBar?$a?this.businessBar.removeEntry(19):this.businessBar.Tf(19,null):this.Q0b&&Qd.TaskExtensions.Aa(this.Q0b.value,function(wc){wc=wc.result;$b.businessBar=wc;$b.Q0b=null;$a?wc.removeEntry(19):wc.Tf(19,null)},this.$.la)};ja.fGa=function($a){if(!$a.da.za(36)){var $b=new qc.a(function(){return Kd.GetServiceTaskFactory.Ra($a.da,5,4,1)}),wc=Kd.GetServiceTaskFactory.create($a.da,168,$a.la,1);Qd.TaskExtensions.Aa(wc,
function(){var Sc=$a.tf;Sc=new ja($a,Sc.appendChild(Sc.ownerDocument.createElement("div")),wc.result,$b);$a.da.Ga(36,Sc)},$a.la)}};ja.Ybi=function($a,$b){ja.$ja.forEach(function(wc){wc.NMi($a,$b)})};ja.dci=function($a){ja.$ja.forEach(function($b){$b.PMi($a)})};ja.ici=function($a){ja.$ja.forEach(function($b){$b.QMi($a)})};ja.bci=function($a){ja.$ja.forEach(function($b){$b.OMi($a)})};ja.cci=function($a,$b){ja.$ja.forEach(function(wc){wc.kMi($a,$b)})};ja.e4g=function($a){$a=dd.EwaSettings.ma(24)?ja.n9g($a.workbookContext.FullDocumentInfo.InteractiveReportsApiUrl).task:
Gc.a.loadScript(79,4,1,!0);return Qd.TaskExtensions.Aa($a,function(){try{InteractiveReportAPI.InitScript(Wb.c,Wb.b)}catch($b){throw $b;}},Gc.a.la)};ja.n9g=function($a){var $b=new we.a;if(!$a)return Mb.ULS.sendTraceTag(537155588,0,10,"InteractiveReportView.CreateApiLoadAndInitializeTask: interactive report api url is null"),$b.setException(Error.create("apiUrl is null")),$b;Bb.a.sKe($a,function(wc,Sc){Sc.succeeded?$b.setResult(!0):($b.setException(Error.create("Network")),Mb.ULS.sendTraceTag(537155585,
0,10,"InteractiveReportView.CreateApiLoadAndInitializeTask: script {0} failed to load successfully",$a))},4,!0);return $b};Mf.Object.defineProperties(ja.prototype,{Ea:{configurable:!0,enumerable:!0,get:function(){return this.n5a}},Pe:{configurable:!0,enumerable:!0,get:function(){return 32}},phc:{configurable:!0,enumerable:!0,get:function(){if(this.Pwa){var $a=this.U0e();return!!$a&&-1!==$a.SourceIndex}return!1}},kEj:{configurable:!0,enumerable:!0,get:function(){this.jSa=this.jSa||new qe.a;return this.jSa.token}},
ape:{configurable:!0,enumerable:!0,get:function(){return this.F0d||(this.F0d=ja.e4g(this.$))}},fYb:{configurable:!0,enumerable:!0,get:function(){return this.$.pa.index.toString()}},eYb:{configurable:!0,enumerable:!0,get:function(){return this.dwc.getItem(this.fYb)}},eci:{configurable:!0,enumerable:!0,get:function(){if(dd.EwaSettings.ma(24)){var $a=gb.a.sT(this.$.workbookContext.FullDocumentInfo.InteractiveReportsServiceUrl,ja.kci,this.$.workbookContext.FullDocumentInfo.WorkbookPath);$a=gb.a.sT($a,
ja.fci,ja.gci);$a=gb.a.sT($a,ja.Xbi,this.$.ya.DataCultureTag);return $a=gb.a.sT($a,ja.hci,this.$.ya.UICultureTag)}return Gc.a.current.CN.InteractiveReportServiceUrl}},Pwa:{configurable:!0,enumerable:!0,get:function(){return this.lMa(5)}}});ja.Zbi="&EnableHyperlinks=false";ja.$bi="&EmbeddedView=true";ja.Wbi="&BIPreview=true";ja.kci="WORKBOOKURL";ja.fci="ServiceName";ja.gci="ExcelServices";ja.Xbi="culture";ja.hci="uiculture";ja.ppi=3E4;ja.$ja=[];Object(ub.a)(ja,"InteractiveReportView",Nc.a,[]);var jd=
b(115),Ad=b(1181),de=b(216),ce=b(82),He=jd.a;Rk(X,He);X.prototype.execute=function($a){var $b=Object(Za.a)(4,$a.ue),wc=Gc.a.current.CN;$a.activityState[ce.a.LL]=ce.a.C8a;$a.activityState[ce.a.e2]=X.E5g($b,wc.OfferPowerBiTrialUrl,wc.OfferPowerBiTrialCompleteSignUpParameter);$a.activityState[ce.a.eTc]=!0;$b.Nk.Dy("PowerBiTrial");return 3};X.E5g=function($a,$b,wc){$a=new Sys.StringBuilder($a.isEditMode?$a.workbookContext.FullDocumentInfo.HostEditUrl:$a.workbookContext.FullDocumentInfo.HostViewUrl);de.a.Pg($a,
Ad.a.W1i,"1");$a=encodeURIComponent($a.toString());return String.format("{0}&{1}={2}{3}",$b,"ru",wc,encodeURIComponent(String.format("?{0}={1}","returnUrl",$a)))};Object(ub.a)(X,"OfferPowerBiTrialActivity",jd.a,[]);var We=Tc.a;Rk(wa,We);wa.prototype.create=function(){this.pb(new X(Pa.a.HSd,Pa.a.u_))};wa.ka=function($a){$a.da.Ga(79,new wa)};Object(ub.a)(wa,"OfferPowerBiTrialFactory",Tc.a,[]);var Sa=b(1493),Eb=b(76),gc=b(54),Qc=b(645);ea.prototype.Lc=function(){return!1};ea.prototype.executeCommand=
function($a,$b,wc){var Sc=this;$a=Qd.TaskExtensions.jk();var yc=$b.command,Dd=this.$.oa.xa,Sd=null,Fe=1,ze=this.$.oa.xa.Pb();this.activeCell=xe.o(this.ha.sa.activeCell,this.$);this.rc=Pb.g(this.$).Ab.Qo(this.ha.sa.activeCell);switch(yc){case 498319061:Mb.ULS.sendTraceTag(537154699,0,50,"PivotCommand.ExecuteCommand: PivotTableShowExpandButton is triggered");if(!this.rc)return $a;Sd=function(Ce,Ue,Oe){var Ta=Sc.activeCell,Ba=!Sc.rc.showDrillIndicators,Jb=Dd.Na(41,void 0===ze?null:ze);Jb.activeCell=
Ta;Jb.showDrillInIndicator=Ba;return ac.g(Dd,"PivotTableShowExpandButton",Jb,Ce,Ue,Oe,null,0)};Fe=218;break;case 1529441790:Qd.TaskExtensions.Aa(Kd.GetServiceTaskFactory.Ra(this.$.da,441,442,0),function(Ce){(Ce=Ce.result)&&Ce.pzj()},this.$.la,3);break;case -1556797033:this.rc&&this.Qed(this.jLi,this.iLi);break;case -1611233597:this.rc&&this.Qed(this.lLi,this.kLi);break;case 786260386:this.rc&&(wc=Number.parseInvariant(wc.MenuItemId),this.Qed(this.hLi,this.gLi,wc));break;case 1771091375:this.showDetails();
break;default:$a=Wc.a(yc)}Sd&&($a=od.a(this.$.userOperationManager,Sd,function(Ce){return new ic.a(Fe,0,Ce,void 0,null)},$b));return $a};ea.prototype.zc=function($a,$b){$a=!1;switch($b.command){case 498319061:case 1529441790:case -1556797033:case 786260386:case -1611233597:$a=!0;break;case 1771091375:$a=dd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PivotTableShowDetails",!1)}return $a};ea.prototype.Qc=function(){return!1};ea.prototype.dispose=function(){this.$=null};ea.prototype.showDetails=
function(){var $a=this;od.a(this.$.userOperationManager,function($b,wc,Sc){var yc=$a.$.oa.xa,Dd=$a.activeCell;$b=Se.b($b,$a.ARi);var Sd=yc.Na(41,null);Sd.activeCell=Dd;return ac.g(yc,"PivotTableShowDetails",Sd,$b,wc,Sc,null,0)},function($b){return new ic.a(262,0,$b,void 0,null)},null)};ea.prototype.PLj=function($a){var $b=Ya.a.instance.Tb("Common.ISystemInitiatedFeedback");$b&&$a?($b.execute(function(wc){wc.logActivity("TeachingUIForShowDetails",null)}),Mb.ULS.sendTraceTag(523613786,0,50,"TeachingUIForShowDetails triggered an LPP activity")):
Mb.ULS.sendTraceTag(523613787,0,15,"TeachingUIForShowDetails failed to get a sifFuture")};ea.prototype.Qed=function($a,$b,wc){var Sc=this;wc=void 0===wc?0:wc;this.$.userOperationManager.Sb(new ic.a(1016,0,function(yc,Dd,Sd){return ac.r(Sc.$.oa.xa,Sc.activeCell,Sc.rc.externalSourceIndex,Sc.rc.pivotTableName,Sc.$.domElement.id,Sc.$.isChromeRtl,Sc.$.workbookContext.NovMode,Se.b(yc,$a),Se.a(Dd,$b),Sd,0!==wc?wc:null,null,!0)},16),null)};ea.prototype.asd=function($a){if(this.wqd($a))if(this.xqd($a)){var $b=
$a.PivotFields[0];if(this.sqd($b)){var wc={};wc.FieldId=$b.IdString;wc.Location=this.activeCell;wc.DataSourceIndex=this.rc.externalSourceIndex;wc.SelectedFieldIndex=$b.SortByValueIndex;var Sc=$b.DisplayString;Sc.length>Sa.n&&(Sc=Sc.substring(0,Sa.n)+"...");wc.ColumnName=Ac.a.zg(Sc);wc.SortAscend=$b.IsSortedAscending&&$b.IsSortedByValue;$a=Object(De.a)(new Qc.a,{pivotName:this.rc.pivotTableName,cMb:wc,mta:this.ija($a.PivotDataItems,!1),nta:this.ija($a.PivotDataItems,!0)});$b={};this.$.Fd(-1681601147,
Eb.a.Cb,0,($b.launchSortByValueDialogCommandData=$a,$b))}else this.hj(157,"AutoFilterSortByValueIncorrectSelection")}else this.hj(753,"SortByValueNoDataFields")};ea.prototype.bsd=function($a){if(this.wqd($a))if(this.xqd($a)){var $b=$a.PivotFields[0];if(this.sqd($b)){var wc={};wc.FilterType=Sa.e;wc.AdvancedFilter=$a.AdvancedFiltering;wc.Location=this.activeCell;wc.DataSourceIndex=this.rc.externalSourceIndex;wc.MaxCount=Sa.a;wc.Title=$b.DisplayString;wc.IsPivotFilter=!0;wc.FieldId=$b.IdString;wc.AnchorType=
0;($b=$b.FilterParameter)?(wc.Count=0<$b.FilterValue?$b.FilterValue.toString():"",wc.Top=$b.IsTopFilter,wc.Type=$b.FilterType,wc.SelectedFieldIndex=Sa.g($a.PivotDataFields,$b.DataFieldId)):(wc.Count=Sa.b,wc.Top=!0,wc.Type=1,wc.SelectedFieldIndex=Sa.o);$b=new Od.a(856841605,Eb.a.Cb,this.$.Jc,0,null);wc={Top10FilterParameters:wc};wc.PivotName=this.rc.pivotTableName;wc.DataFieldIds=this.ija($a.PivotDataFields,!1);wc.DataFieldNames=this.ija($a.PivotDataFields,!0);$a={};$a[Eb.a.Uf]=gc.a.xc(wc);this.$.Ka.Kb($b,
$a)}}else this.hj(248,"ValueFilterNoDataFields")};ea.prototype.wqd=function($a){return 1===$a.PivotFields.length};ea.prototype.xqd=function($a){return 0<$a.PivotDataFields.length&&0<$a.PivotDataItems.length};ea.prototype.sqd=function($a){return!$a.IsDataField&&!$a.IsFieldInPageFilterArea};ea.prototype.Yrd=function($a,$b){if(this.wqd($a))if(Sa.m($b)&&!this.xqd($a))this.hj(248,"ValueFilterNoDataFields");else{var wc=$a.PivotFields[0];if(this.sqd(wc)){var Sc=this.Wzh(wc.PivotFilterParameters,$b),yc={};
yc.ActiveCompareType=this.tah($b);yc.ShowDataFields=Sa.m($b);yc.FilterType=this.JNh($b);yc.ValueTypeText=Sa.j($b);yc.Location=this.activeCell;yc.ColumnName=wc.DisplayString;yc.IsPivotFilter=!0;yc.IsTimeSlicer=!1;yc.NonNumericCaptionFilteringEnabled=wc.IsNonnumericCaptionFilteringEnabled;yc.FieldId=wc.IdString;yc.AnchorType=0;yc.ControlGroupOrder=Sa.h();yc.ShowWholeDays=wc.IsDateField&&!Sa.m($b);yc.EnabledWholeDays=wc.IsEnabledWholeDays;yc.WholeDays=wc.IsWholeDays;yc.MemberProperties=!1;yc.SelectedFieldIndex=
Sa.o;Sc&&(Sa.m($b)||wc.IsDataField?(yc.Value1=Sc.FilterValue1.toString(),yc.Value2=Sc.FilterValue2.toString(),Sa.m($b)&&(yc.SelectedFieldIndex=Sa.g($a.PivotDataFields,Sc.DataFieldId))):(yc.Value1=Sc.FilterString1,yc.Value2=Sc.FilterString2));$b=new Od.a(-2042011094,Eb.a.Cb,this.$.Jc,0,null);yc={CustomFilterParameters:yc};yc.FieldId=wc.IdString;yc.PivotName=this.rc.pivotTableName;yc.DataFieldIds=this.ija($a.PivotDataFields,!1);yc.DataFieldNames=this.ija($a.PivotDataFields,!0);$a={};$a[Eb.a.Uf]=gc.a.xc(yc);
this.$.Ka.Kb($b,$a)}}};ea.prototype.ija=function($a,$b){for(var wc=[],Sc=0;Sc<$a.length;++Sc)$b?wc.push($a[Sc].DisplayString):wc.push($a[Sc].IdString);return wc};ea.prototype.tah=function($a){switch($a){case 4:case 18:case 26:return 0;case 5:case 19:case 62:return 1;case 6:return 2;case 7:return 3;case 8:return 4;case 9:return 5;case 10:return 6;case 11:return 7;case 12:case 20:case 28:return 8;case 13:case 21:case 64:return 9;case 14:case 22:case 27:return 10;case 15:case 23:case 63:return 11;case 16:case 24:case 29:return 12;
case 17:case 25:case 65:return 13}return 14};ea.prototype.JNh=function($a){return Sa.j($a)?Sa.c:Sa.m($a)?Sa.f:Sa.k($a)?Sa.d:""};ea.prototype.Wzh=function($a,$b){for(var wc=0;wc<$a.length;++wc)if($a[wc].FilterType===$b)return $a[wc];return null};ea.prototype.hj=function($a,$b){$a=le.a.Xc(1,0,0,$a,0,0,$b);Ze.a(this.$).hj($a)};Object(ub.a)(ea,"PivotCommandHandler",null,[429,3]);var cd=Da.a;Rk(ca,cd);ca.prototype.Ad=function(){var $a=this,$b=Kd.GetServiceTaskFactory.create(this.$.da,128,this.la,this.hb);
this.$.bB(function(){dd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PivotTableShowDetails",!1)?Qd.TaskExtensions.Aa(Qd.TaskExtensions.Vd([$b],$a.la),function(){$a.jd([new ea($a.$)])},$a.la,3):$a.jd([new ea($a.$)])})};ca.ka=function($a){$a.da.Ga(345,new ca($a))};Object(ub.a)(ca,"PivotCommandHandlerFactory",Da.a,[]);fa.prototype.getActiveCell=function(){return this.activeCell};Object(ub.a)(fa,"MacroRecorderPivotTableSettingsPaneOperationsPayload",null,[438]);Object(ub.a)(R,"PivotTableSettingsPaneOperationsUserContext",
null,[]);Object(ub.a)(ka,"PivotTableSettingsTaskPaneProps",null,[]);P.prototype.mI=function($a){var $b=this;lc.UISurfaces.Mj().then(function(wc){wc.showTaskPane("PivotTableSettingsTaskPane",$b.Rv(null,$a,!1,!1,!1,null,!1));return null})};P.prototype.Mw=function($a,$b,wc,Sc,yc,Dd,Sd){var Fe=this;lc.UISurfaces.Mj().then(function(ze){ze.updateTaskPane("PivotTableSettingsTaskPane",Fe.Rv($a,$b,wc,Sc,yc,Dd,Sd));return null})};P.prototype.JM=function(){lc.UISurfaces.Mj().then(function($a){$a.hideTaskPane("PivotTableSettingsTaskPane",
2);return null})};P.prototype.Rv=function($a,$b,wc,Sc,yc,Dd,Sd){var Fe=this;$a=Object(De.a)(new ka,{type:"PivotTableSettingsTaskPaneProps",settingsInfo:$a,isRangeChanged:wc,isNativePivotTable:Sc,expandAllByDefault:!0,hasLessThanTwoRowFields:yc,sectionCollapseStates:this.pivotTableSettingsPaneManager.sectionCollapseStates,needFocusOnFirstElement:Sd,onSaveSectionCollapseState:function(ze,Ce){Fe.pivotTableSettingsPaneManager.onSaveSectionCollapseState(ze,Ce)},onSettingChange:function(ze,Ce,Ue){Fe.pivotTableSettingsPaneManager.dPi(ze,
Ce,Ue,Dd)}});if(Fa.a.ud(this.$))return Object(De.a)(new Pc.a,{contentProps:$a,onOpen:function(){Fe.pivotTableSettingsPaneManager.Zx()},onClose:function(){Fe.pivotTableSettingsPaneManager.pB()},onManualClose:function(){Fe.pivotTableSettingsPaneManager.iAd()},title:uc.a.instance.ga(1055),width:320,enableResize:!0,minResizeWidth:320,maxResizeWidth:900});$b=Object(De.a)(new md.a,{type:"ExcelLegacyTaskPaneProps",container:$b,paneProps:$a});return Object(De.a)(new Pc.a,{contentProps:$b,onOpen:function(){Fe.pivotTableSettingsPaneManager.Zx()}})};
Object(ub.a)(P,"PivotTableSettingsReactTaskPane",null,[824]);Object(ub.a)(Q,"PivotTableSettingsInfo",null,[]);Object(ub.a)(C,"SlicerConnectionItem",null,[]);M.prototype.pzj=function(){var $a=this;if(Fa.a.ud(this.$))this.yf?(this.Hr=!1,this.hideTaskPane(!0)):(this.Hr=!0,this.showTaskPane(!0)),this.$.hf();else if(this.pivotTableSettingsTaskPane)this.pivotTableSettingsTaskPane.Zf(!this.yf),this.yf?this.hideTaskPane(!0):this.showTaskPane(!0);else{var $b=Kd.GetServiceTaskFactory.Ra(this.$.da,346,347,0),
wc=Tb.a(this.$);Qd.TaskExtensions.Aa(Qd.TaskExtensions.Vd([$b,wc],this.$.la),function(){$a.pivotTableSettingsTaskPane=$b.result;wc.result.GQ($a.pivotTableSettingsTaskPane);$a.k6();$a.pivotTableSettingsTaskPane.Zf(!0);$a.showTaskPane(!0)},this.$.la,3)}};M.prototype.onSaveSectionCollapseState=function($a,$b){this.HL&&0<=$a&&$a<this.HL.length&&(this.HL[$a]=$b)};M.prototype.dPi=function($a,$b,wc,Sc){function yc(Ce,Ue,Oe){var Ta=new R;Ta.OFf=$a;Ta.PFf=Sc;var Ba=Sd.$.oa.xa,Jb=Fe,yd=$b;Ce=Se.b(Ce,Sd.ePi);
var Nd=Ba.Na(41,null);Nd.activeCell=Jb;Nd.option=$a;Nd.userInputText=yd;Nd.userInputInt=wc;return ac.g(Ba,"PivotTableSettingsPaneOperations",Nd,Ce,Ue,Oe,Ta,0)}function Dd(){return new fa(Fe,ze.pivotTableName,$a,$b,wc)}var Sd=this,Fe=this.Q4b,ze=this.f3;if(!ze||Sc!==ze.Eca)if(this.mma&&Sc===this.mma.Eca)ze=this.mma,Fe=this.qHf;else{Mb.ULS.sendTraceTag(537154690,0,50,"OnPivotTableSettingsChanged Cannot Find PivotTable for opType: {0}",$a);return}switch($a){case 1:this.Lca=ze.pivotTableName;$b=255<$b.length?
$b.substring(0,255):$b;ze.pivotTableName=$b;break;case 2:this.Yya=ze.rwGrandTotalOn;ze.rwGrandTotalOn=!!wc;break;case 3:this.Yya=ze.colGrandTotalOn;ze.colGrandTotalOn=!!wc;break;case 6:ze.autoFormatOnUpdate=!!wc;break;case 7:ze.showDrillIndicators=!!wc;break;case 8:ze.showItemsWithNoDataOnRw=!!wc;break;case 9:ze.showItemsWithNoDataOnCol=!!wc;break;case 10:ze.displayErrorString=!!wc;break;case 11:ze.displayNullString=!!wc;break;case 12:this.Lca=ze.errorString;ze.errorString=$b;break;case 13:this.Lca=
ze.nullString;ze.nullString=$b;break;case 14:this.Yya=ze.saveSourceDataWithFile;ze.saveSourceDataWithFile=!!wc;break;case 15:this.Yya=ze.refreshOnLoad;ze.refreshOnLoad=!!wc;break;case 16:this.Lca=ze.altText;ze.altText=$b;break;case 17:this.Lca=ze.altTextSummary;ze.altTextSummary=$b;break;case 20:this.rHf=ze.indentIncrement,ze.indentIncrement=wc}Mb.ULS.sendTraceTag(595125196,0,50,"OnPivotTableSettingsChanged for opType: {0}",$a);dd.EwaSettings.Zb()?this.$.userOperationManager.Sb(new ic.a(225,0,yc,
64,Dd),null):this.$.userOperationManager.Sb(new h.a(225,0,yc,void 0,Dd),null)};M.prototype.bai=function($a){this.WFb=new P($a,this)};M.prototype.k6=function(){this.ppc=this.pivotTableSettingsTaskPane.iM();this.pivotTableSettingsTaskPane.RL(this.GEb)};M.prototype.dispose=function(){this.ha.PN(this.Cla);this.gridView.yF(this.Cla);this.gridView.EK(this.Aq);this.$=this.gridView=this.ha=null;this.hideTaskPane();this.pivotTableSettingsTaskPane&&(this.pivotTableSettingsTaskPane.QN(this.GEb),this.pivotTableSettingsTaskPane=
this.ppc=null);this.HL=this.WFb=null};M.prototype.Zx=function(){this.Q4b=xe.o(this.ha.sa.activeCell,this.$);this.f3=this.qja();this.updateTaskPane(this.qja())};M.prototype.pB=function(){this.hideTaskPane()};M.prototype.iAd=function(){this.Hr=!1;this.hideTaskPane(!0);this.$.hf()};M.prototype.Vo=function(){return this.MYa&&this.Hr};M.prototype.Nr=function(){var $a=Pb.g(this.$).Ab.Qo(this.ha.sa.activeCell);return!(this.ha.Pe&470)&&!!$a&&!$a.W6a(!0)&&this.Hr};M.prototype.showTaskPane=function($a){if(void 0===
$a?0:$a)this.QNa=!0,Mb.ULS.sendTraceTag(537154659,0,50,"PivotTable settings pane is opened by the user.");this.yf=!0;this.WFb.mI(this.ppc)};M.prototype.updateTaskPane=function($a,$b){$b=void 0===$b?!1:$b;if(this.yf&&$a&&!$a.W6a(!0)){var wc=new Q;wc.pivotTableName=$a.wFd;wc.colGrandTotalOn=$a.colGrandTotalOn;wc.rwGrandTotalOn=$a.rwGrandTotalOn;wc.indentIncrement=$a.indentIncrement;wc.autoFormatOnUpdate=$a.autoFormatOnUpdate;wc.showDrillIndicators=$a.showDrillIndicators;wc.showItemsWithNoDataOnRw=$a.showItemsWithNoDataOnRw;
wc.showItemsWithNoDataOnCol=$a.showItemsWithNoDataOnCol;wc.displayErrorString=$a.displayErrorString;wc.errorString=$a.errorString;wc.displayNullString=$a.displayNullString;wc.nullString=$a.nullString;wc.saveSourceDataWithFile=$a.saveSourceDataWithFile;wc.refreshOnLoad=$a.refreshOnLoad;wc.altText=$a.altText;wc.altTextSummary=$a.altTextSummary;wc.slicerConnections=this.LBj($a.slicerConnections);this.WFb.Mw(wc,this.ppc,$b,!$a.isOlap,!$a.JK||2>$a.JK.length,$a.Eca,this.QNa);this.QNa=!1}};M.prototype.hideTaskPane=
function($a){$a=void 0===$a?!1:$a;this.yf=!1;this.WFb.JM();$a&&Mb.ULS.sendTraceTag(537154658,0,50,"PivotTable settings pane is closed by the user.")};M.prototype.LBj=function($a){var $b=new Ub.a;if($a)for(var wc=0;wc<$a.length;wc++){var Sc=$a[wc],yc=new C;yc.name=Sc.Name;yc.caption=Sc.Caption;yc.sheet=Sc.WorksheetName;yc.enabled=Sc.Enabled||!1;$b.add(yc)}return $b.toArray()};M.prototype.qja=function(){return this.gridView.Ab.Qo(this.ha.sa.activeCell)};M.prototype.EBc=function(){this.Vo()&&this.Nr()?
this.yf?this.f3!==this.mma&&this.f3&&this.updateTaskPane(this.qja(),!0):this.showTaskPane():this.yf&&this.hideTaskPane()};M.prototype.vbg=function(){this.qHf=this.Q4b;this.mma=this.f3;this.Q4b=xe.o(this.ha.sa.activeCell,this.$);this.f3=this.qja()};Mf.Object.defineProperties(M.prototype,{sectionCollapseStates:{configurable:!0,enumerable:!0,get:function(){return this.HL}},MYa:{configurable:!0,enumerable:!0,get:function(){return this.$.hc.x2(4128)&&this.NYa}},NYa:{configurable:!0,enumerable:!0,get:function(){var $a=
new Xb.a(this.$.va);return this.$.isEditMode&&$a.Ud(8192)||!$a.fj}}});Object(ub.a)(M,"PivotTableSettingsPaneManager",null,[808,3]);var wd=Tc.a;Rk(N,wd);N.prototype.create=function(){this.pb(this.$.da.za(441)||this.$.da.Ga(441,new M(this.$)))};N.ka=function($a){$a.da.Ga(442,new N($a))};Object(ub.a)(N,"PivotTableSettingsPaneManagerFactory",Tc.a,[]);K.yqh="ewa-ptsp-pane";K.xqh="ewa-ptsp-header";K.zqh="ewa-ptsp-title";K.vqh="ewa-ptsp-body";K.wqh="ewa-ptsp-close-button";Object(ub.a)(K,"CssClassNames",
null,[]);var Ld=K.yqh,ge=K.xqh,fe="cui-taskPaneTitle "+K.zqh,ye=K.vqh,Rd=K.wqh,tc=Rc.a;Rk(H,tc);H.prototype.kP=function($a){this.get_events().addHandler("PivotTableSettingsTaskPaneRemoved",$a)};H.prototype.zR=function($a){this.get_events().removeHandler("PivotTableSettingsTaskPaneRemoved",$a)};H.prototype.RL=function($a){this.addHandler("PivotTableSettingsTaskPaneClosed",$a)};H.prototype.QN=function($a){this.removeHandler("PivotTableSettingsTaskPaneClosed",$a)};H.prototype.qH=function(){};H.prototype.Vo=
function(){return this.MYa&&this.Hr};H.prototype.Nr=function(){var $a=Pb.g(this.$).Ab.Qo(this.ha.sa.activeCell);return!(this.ha.Pe&470)&&!!$a&&!$a.W6a(!0)&&this.Hr};H.prototype.mR=function(){};H.prototype.ej=function(){};H.prototype.Aj=function(){};H.prototype.AQ=function(){return!1};H.prototype.dispose=function(){this.$&&this.$.Ol(this.Fc);this.de&&(nb.a.instance.Ba(kc.a.click,this.de,this.Qj),cc.KeyInputManager.instance.pv(this.de,this.Cye));this.de=this.taskPaneManager=this.$=null;tc.prototype.dispose.call(this)};
H.prototype.Sf=function($a,$b){if(!$b){$a=Fc.DOMElementExtensions.getElementById(this.domElement,"PivotTableName");if(!$a&&($a=Fc.DOMElementExtensions.Cl(this.domElement.querySelectorAll(Fc.DOMElementExtensions.er)),!$a))return!1;Fc.DOMElementExtensions.setFocus($a)}return!$b};H.prototype.$g=function($a){return Fc.DOMElementExtensions.nf(this.ic,$a)};H.prototype.Zf=function($a){this.Hr=$a;var $b=this.taskPaneManager;this.isVisible=$a;this.taskPaneManager.Kw();var wc=!!this.taskPaneManager.xg&&14===
this.taskPaneManager.xg.taskPane.Ng;$a&&0<$b.Mz.length&&(!wc||$b.isCollapsed)&&$b.GF(this,!0);this.$.hf()};H.prototype.iM=function(){var $a=document.getElementById(this.$.yb+fb.a.FCd),$b=this.HG();$a.appendChild($b);$b=Ke.b("div","PivotTableSettingsPaneBodyId",ye);$a.appendChild($b);return $b};H.prototype.HG=function(){var $a=Ke.b("div","PivotTableSettingsPaneHeaderId",ge),$b=Ke.b("span","PivotTableSettingsPaneTitleId",fe);$b.innerText=this.titleText;this.de=Qb.a.nb("PivotTableSettingsPaneCloseButtonId",
Rd,uc.a.instance.ga(10),"ClosePaneGlyph_16x16x32",!1);this.de.classList.add(bc.AFrameworkApplication.isRtl?fb.a.vaa:fb.a.waa);nb.a.instance.ra(kc.a.click,this.de,this.Qj);this.Cye=cc.KeyInputManager.instance.Xr(this.de,this.Qj,Mc.a.Oh);$a.appendChild($b);$a.appendChild(this.de);return $a};H.ka=function($a,$b){var wc=$a.yb,Sc=document.getElementById(wc+fb.a.FCd);Sc||(Sc=document.createElement("div"),Sc.id=$a.yb+fb.a.FCd,Sc.classList.add(Ld),document.getElementById(wc+fb.a.gR).appendChild(Sc));wc=$a.da;
return wc.za(346)||wc.Ga(346,new H(Sc,$a,$b))};Mf.Object.defineProperties(H.prototype,{isVisible:{configurable:!0,enumerable:!0,get:function(){return Object(nf.a)(H.prototype,this,"isVisible")},set:function($a){Object(nf.a)(H.prototype,this,"isVisible")!==$a&&Object(nf.b)(H.prototype,this,"isVisible",$a)}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return this.isVisible}},Yd:{configurable:!0,enumerable:!0,get:function(){return ad.a.LXi}},Ng:{configurable:!0,enumerable:!0,get:function(){return 14}},
Jk:{configurable:!0,enumerable:!0,get:function(){return tb.a.jPe}},MM:{configurable:!0,enumerable:!0,get:function(){return uc.a.instance.ga(1055)}},titleText:{configurable:!0,enumerable:!0,get:function(){return uc.a.instance.ga(1055)}},ko:{configurable:!0,enumerable:!0,get:function(){return 320}},isResizable:{configurable:!0,enumerable:!0,get:function(){return!0}},ic:{configurable:!0,enumerable:!0,get:function(){return this.domElement}},height:{configurable:!0,enumerable:!0,get:function(){return this.taskPaneManager.oO.offsetHeight}},
MYa:{configurable:!0,enumerable:!0,get:function(){return this.$.hc.x2(4128)&&this.NYa}},NYa:{configurable:!0,enumerable:!0,get:function(){var $a=new Xb.a(this.$.va);return this.$.isEditMode&&$a.Ud(8192)||!$a.fj}}});Object(ub.a)(H,"PivotTableSettingsTaskPane",Rc.a,[805,3,494,448]);var Vc=Tc.a;Rk(J,Vc);J.prototype.create=function(){var $a=this,$b=Kd.GetServiceTaskFactory.create(this.$.da,203,this.la,this.hb),wc=Kd.GetServiceTaskFactory.create(this.$.da,155,this.la,this.hb);Qd.TaskExtensions.Aa(Qd.TaskExtensions.ts(Qd.TaskExtensions.Vd([$b,
wc],this.la),function(){return $a.WC},this.la),function(){$a.pb($a.Wg)},this.la,3)};J.prototype.dispose=function(){this.Wg=this.gi=this.$=null;Vc.prototype.dispose.call(this)};J.ka=function($a){$a.da.Ga(347,new J($a))};Mf.Object.defineProperties(J.prototype,{WC:{configurable:!0,enumerable:!0,get:function(){var $a=this;this.gi||(this.gi=Qd.TaskExtensions.Aa(Tb.a(this.$),function($b){$a.Wg=H.ka($a.$,$b.result)},this.la,3));return this.gi}}});Object(ub.a)(J,"PivotTableSettingsTaskPaneFactory",Tc.a,[]);
var ue=Da.a;Rk(U,ue);U.prototype.Ad=function(){var $a=this;Qd.TaskExtensions.Aa(Kd.GetServiceTaskFactory.create(this.$.da,472,this.la,this.hb),function(){var $b=$a.$.da.za(13);$a.jd([$b])},this.$.la,3)};U.ka=function($a){Da.a.Qd(78,new U($a))};Object(ub.a)(U,"BICommandHandlerFactory",Da.a,[]);var Rf=b(738),Ee=b(38),vf=b(1029),Ge=b(330),Of=b(466),If=b(443);Object(ub.a)(O,"MacroRecorderPivotTableRefreshedPayload",null,[438]);var Xf=b(419),pf=Xf.a;Rk(T,pf);Mf.Object.defineProperties(T.prototype,{operationWorkingState:{configurable:!0,
enumerable:!0,get:function(){return 4}},gJb:{configurable:!0,enumerable:!0,get:function(){return!!(this.flags&64)}}});Object(ub.a)(T,"DepartableRefreshWebMethodOperation",Xf.a,[]);var Yf=b(160),Cg=Yf.ErrorDialog;Rk(G,Cg);G.prototype.pn=function(){Cg.prototype.pn.call(this);this.fBa=String.format(uc.a.instance.Xa(7),null)};G.tQ=function($a){var $b=le.a.Xc(12,1,0,0,0,1243883867,"ConfirmDataRefresh");$b.Description=$a;$b.HelpDescription=uc.a.instance.ga(1300);$b.HelpTopicId=vf.a.k1c;return $b};Object(ub.a)(G,
"DataRefreshConfirmationDialog",Yf.ErrorDialog,[]);var Rg=b(356),Kf=jb.a;Rk(I,Kf);I.prototype.bne=function($a){this.Pa.addHandler("refreshCompleted",$a)};I.prototype.rne=function($a){this.Pa.addHandler("singleRefreshStarted",$a)};I.prototype.SPf=function($a){this.Pa.removeHandler("singleRefreshStarted",$a)};I.prototype.QUc=function($a){this.Pa.addHandler("singleRefreshCompleted",$a)};I.prototype.NId=function($a){this.Pa.removeHandler("singleRefreshCompleted",$a)};I.prototype.Lc=function(){return!1};
I.prototype.executeCommand=function($a,$b,wc,Sc){$a=$b.command;switch($a){case -1193102612:this.sMf(!1,$b,"m_excelWebRenderer_ewaCtl_DataSourceDirtinessButton"===wc.SourceControlId);break;case 2054778433:this.refreshSelected($b,Sc);break;default:return Wc.a($a)}return cf.Task.Ua(!0)};I.prototype.zc=function($a,$b){$a=!1;switch($b.command){case 2054778433:case -1193102612:$a=!0}return $a};I.prototype.Qc=function(){return!1};I.prototype.dispose=function(){if(this.$){var $a=Pb.g(this.$),$b=$a.ha;$b.ZH(this.Rc);
$b.Fma(this.Rc);this.$.vb.yza(this.mF);this.$.va.yza(this.mF);dd.EwaSettings.isChangeGateEnabled("OfficeVSO:6399807_AddOperationDequeueOnRefreshCancel")&&this.$.userOperationManager.so(this.vz);$a.Ea.Dq(this.Y8a);$a.Ea.Nab(this.Y8a);ke.a(this.$).Ea.Dq(this.Y8a);this.$.da.za(36)&&this.$.da.za(36).Ea.Dq(this.Y8a);this.$.ea&&this.$.ea.wk(this.Uc)}this.clear();Aa.a.oc([this.lpc,this.Pa]);this.$=this.Pa=null;Kf.prototype.dispose.call(this)};I.prototype.kHb=function($a,$b,wc){var Sc=this;if(this.$.ea.dc){var yc=
function(Sd){var Fe=null;if(Sc.jza&&Object(Zb.a)(Bc.PivotTableRange,Sc.jza)){var ze=Sc.jza;Fe=function(){return new O(ze.Eca,ze.pivotTableName)}}Fe=Sc.$.userOperationManager.Sb(new T(50,0,function(Ce,Ue,Oe,Ta){var Ba=Sc.$.oa.xa.Pb();Ba.FlightHolder=Sc.$.ya.FlightHolder;null==Ce&&Sc.zGd.set($a,Ba.ClientRequestId);var Jb=Sc.$.oa.xa;Ue=Se.b(Ue,Sc.RUh($a));Ba=Jb.Na(1,Ba);var yd=Ba.context;yd.RequestId=Ce;yd.CompleteResponseTimeout=2E3;Ba.connectionName=$a;Ba.externalSourceIndex=$b;Ba.userAadToken=Sd;
return ac.g(Jb,"Refresh",Ba,Ue,Oe,Ta,null,0)},68,250,Fe),wc);Sc.WOa.set($a,Fe);Sc.HRi($a)};if(dd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryAuthenticateRefresh",!1)){var Dd=Kd.GetServiceTaskFactory.Ra(this.$.da,470,471,0);Qd.TaskExtensions.Aa(Dd,function(Sd){Sd.result.DTh($a).then(function(Fe){yc(Fe)},function(Fe){Mb.ULS.sendTraceTag(520680469,0,10,"DataRefreshManager.RefreshConnection: failed to get power query aad token {0}",Fe)})},this.$.la,3)}else yc(null)}};I.prototype.rx=
function($a,$b){var wc=this;var Sc=void 0===Sc?null:Sc;if(this.confirmationRequired&&$a)if(this.wab)$b(!0);else if(Sc=Sc||I.Txi,dd.EwaSettings.kz()){$a=le.a.Xc(12,1,0,0,0,1243883867,"ConfirmDataRefresh");$a.Caption=uc.a.instance.Xa(7);$a.Description=Sc;$a.HelpDescription=uc.a.instance.ga(1300);$a.HelpTopicId=vf.a.k1c;var yc=new Rg.a(this.$,$a);yc.jP(function(){wc.wab=2===yc.returnValue;$b(wc.wab)})}else{var Dd=new G(this.$,Sc);Dd.jP(function(){Dd.hide();wc.wab=2===Dd.returnValue;$b(wc.wab)});Dd.gf()}else $b(!0)};
I.prototype.aKa=function(){if(!this.FGd){var $a=Pb.g(this.$);$a=$a.getRangeInformation($a.ha.sa.activeCell);for(var $b=0,wc=$a.length;$b<wc;++$b){var Sc=$a[$b];if(Object(Zb.a)(Of.a,Sc)){this.jza=Sc;break}}this.FGd=!0}return this.jza};I.prototype.yBc=function(){var $a=this.$.oa.xa.Pb(),$b=this.$.oa.xa,wc=this.yLi,Sc=this.xLi;$a=$b.Na(1,$a);ac.g($b,"GetSensitivityLabelsForPowerBIDatasets",$a,wc,Sc,null,null,4)};I.prototype.i$f=function($a){return this.WOa.has($a)?(this.$.userOperationManager.uta(this.WOa.get($a)),
!0):!1};I.prototype.vAe=function(){if(dd.EwaSettings.ma(131)){var $a=this.$.hc;if(!$a||$a.inEmbedView||$a.inWebPart||$a.inViewerFromWebPart)return!1;$a=Pb.g(this.$);for(var $b=$a.ha.sa.selectedRanges,wc=0;wc<$b.length;wc++)if($a.Ab.Zod($b[wc]))return!0}return!1};I.prototype.Ozj=function(){var $a=le.a.Xc(1,0,0,1483,0,-853845742,"ErrorConnectingToDataSource");Ze.a(this.$).nr([$a])};I.prototype.sMf=function($a,$b,wc){var Sc=this;if(this.$.ea.dc){this.l9i();if(dd.EwaSettings.isChangeGateEnabled("OfficeVSO::5788995_RemoveHasLegacyConnections")&&
0<this.$.workbookContext.LegacyConnections.length||!dd.EwaSettings.isChangeGateEnabled("OfficeVSO::5788995_RemoveHasLegacyConnections")&&this.$.workbookContext.HasLegacyConnections){var yc=le.a.Xc(32,2,1629,1642,0,-73730134,"BB_LegacyConnectionsWarning");yc.HelpDescription=uc.a.instance.ga(1624);yc.HelpTopicId=Ge.a.jri;var Dd=Kd.GetServiceTaskFactory.Ra(this.$.da,5,4,0);Qd.TaskExtensions.Aa(Dd,function(){var Sd=Dd.result;Sd&&Sd.Tf(33,yc)},this.$.la,3)}$a?($a=this.$.oa.xa.Pb(),this.t$a=F(this.$.oa.xa,
!0,null,0,Se.b(this.ZOi,this.jAf),this.$Oi,null,null,$a)):this.$.userOperationManager.Sb(new T(51,0,function(Sd,Fe,ze,Ce){var Ue=Sc.$.oa.xa.Pb();Ue.FlightHolder=Sc.$.ya.FlightHolder;var Oe=null;wc&&(Oe={});return F(Sc.$.oa.xa,!1,Sd,2E3,Se.b(Fe,Sc.jAf),ze,Ce,Oe,Ue)},68,250,function(){return new If.a}),$b)}};I.prototype.refreshSelected=function($a,$b){if(this.$.ea.dc&&qd.i(this.$.pa)&&!this.pyb()){var wc=this.aKa();if(!this.vAe()||wc&&Object(Zb.a)(Bc.PivotTableRange,wc))wc?this.kHb(this.jza.T0g,this.jza.externalSourceIndex,
$a):this.Ozj();else{var Sc;$a=Kd.GetServiceTaskFactory.Ra(this.$.da,271,272,$b.tja());Qd.TaskExtensions.Aa($a,function(yc){(Sc=yc.result)&&Sc.refreshLinkedEntitiesInRange()},this.$.la,3)}}};I.prototype.clear=function(){this.gOd(0);this.wab=!1;this.xCd=-1;I.nMc=null;this.t$a&&(bc.AFrameworkApplication.qd.ku(this.t$a.Dt),this.t$a=null)};I.prototype.Rki=function(){var $a=!1,$b=Pb.g(this.$).ha;2===$b.Pe&&($a=$b.Oa.Yb,$b=(null===$a||void 0===$a?0:$a.floatingObject)?$a.floatingObject.Oc:null,$a=$a.my&&
!!$b&&!!($b.Attributes&4));return $a};I.prototype.pyb=function(){return 2===Pb.g(this.$).ha.Pe};I.prototype.pld=function(){this.FGd=!1;this.jza=null};I.prototype.gOd=function($a){var $b=0<$a;!$b||this.$.ea.dc&&this.$.hc.allowPeriodicDataRefresh||($b=!1);Aa.a.Ia(this.lpc);this.lpc=null;$b&&(this.lpc=Be.a.instance.nE(this.yTg,$a,Ie.a.Qah))};I.prototype.kAf=function($a){$a.RequestId||this.Pa.raiseEvent("refreshCompleted",$a,this);this.yBc()};I.prototype.RUh=function($a){var $b=this;return function(wc){$b.kAf(wc);
wc&&(wc.DepartableWebMethodOperationCompleted||wc.Errors&&0<wc.Errors.length)&&(Array.remove($b.tVb,$a),dd.EwaSettings.isChangeGateEnabled("OfficeVSO:6635492_ChangeRefreshResult")?wc.Result.ConnectionName=$a:wc.Result=$a,$b.Pa.raiseEvent("singleRefreshCompleted",wc,$b))}};I.prototype.HRi=function($a){Array.contains(this.tVb,$a)||this.tVb.push($a);this.Pa.raiseEvent("singleRefreshStarted",$a,this)};I.prototype.c$f=function($a,$b,wc){var Sc=this,yc=Kd.GetServiceTaskFactory.Ra(this.$.da,274,275,0),Dd=
!1;wc.YJ?Mb.ULS.sendTraceTag(537163297,306,50,"DataRefreshManager::TryAutoApplyOrRecommendPowerBILabel: Task was cancelled."):Qd.TaskExtensions.Aa(yc,function(){if(function(){var Fe=yc.result.MWc($a,Dd);Dd=Fe.N5a;return Fe}().returnValue)Mb.ULS.sendTraceTag(537163293,306,50,"DataRefreshManager::TryAutoApplyOrRecommendPowerBILabel: Completed successfully on the {0} attempt.",$b);else if(Dd&&3>$b)if(wc.YJ)Mb.ULS.sendTraceTag(537163296,306,50,"DataRefreshManager::TryAutoApplyOrRecommendPowerBILabel: Task was cancelled before waiting.");
else{var Sd=Sc.$.ya.TimeToWaitForApplyingSensitivityLabels;Mb.ULS.sendTraceTag(537163295,306,100,"DataRefreshManager::TryAutoApplyOrRecommendPowerBILabel: retry async call to AutoApplyOrRecommendPowerBILabel after {0} ms on the {0} attempt.",Sd,$b);Be.a.instance.create(function(){Sc.c$f($a,$b+1,wc)},Sd,Ie.a.Rah,!0,!0)}else Mb.ULS.sendTraceTag(537163294,306,50,"DataRefreshManager::TryAutoApplyOrRecommendPowerBILabel: No Sensitivity Labels applied on the {0} attempt.  Not scheduling anymore retries.",
$b)},wc,3)};I.prototype.yWc=function($a){$a.Ds(this.Y8a);$a=$a.jXi;0<$a&&this.yZf($a)};I.prototype.yZf=function($a){var $b=this.$.ea.Ue;$b>this.xCd&&(this.xCd=$b,this.gOd(1E3*$a))};I.prototype.l9i=function(){var $a=Kd.GetServiceTaskFactory.Ra(this.$.da,5,4,0);Qd.TaskExtensions.Aa($a,function(){var $b=$a.result;$b&&$b.QLa(57)&&$b.removeEntry(57)},this.$.la,3)};I.ka=function($a){$a.da.Ga(13,new I($a))};Mf.Object.defineProperties(I.prototype,{phc:{configurable:!0,enumerable:!0,get:function(){return!!this.aKa()||
this.vAe()||this.Rki()}},MMf:{configurable:!0,enumerable:!0,get:function(){return this.tVb}},zGd:{configurable:!0,enumerable:!0,get:function(){return this.cug}},confirmationRequired:{configurable:!0,enumerable:!0,get:function(){return this.$.hc.refreshConfirmationRequired}}});Mf.Object.defineProperties(I,{Txi:{configurable:!0,enumerable:!0,get:function(){return I.nMc||(I.nMc=uc.a.instance.Xa(8)+"<br /><br />"+uc.a.instance.Xa(10))}}});I.nMc=null;Object(ub.a)(I,"DataRefreshManager",jb.a,[9,429]);var Pf=
Da.a;Rk(D,Pf);D.prototype.Ad=function(){var $a=this;Qd.TaskExtensions.Aa(Kd.GetServiceTaskFactory.Ra(this.$.da,470,471,this.hb),function($b){$a.jd([$b.result])},this.$.la,3)};D.ka=function($a){Da.a.Qd(472,new D($a))};Object(ub.a)(D,"PowerQueryManagerCommandHandlerFactory",Da.a,[]);var Ff=b(1081);A.prototype.TGg=function($a){this.Pa.addHandler("OnUpdatePowerQueryDataKeySucceeded",$a)};A.prototype.xcj=function($a){this.Pa.removeHandler("OnUpdatePowerQueryDataKeySucceeded",$a)};A.prototype.qhc=function($a){if(this.$$a.kb($a)){var $b=
this.$$a.getItem($a);if(1!==$b.FillObjectType&&!$b.LoadedToDataModel&&(!dd.EwaSettings.isChangeGateEnabled("OfficeVSO:6212633_BlockRefreshForQueriesWithoutConnection")||this.zK.kb($a)))return!0}else Mb.ULS.sendTraceTag(537154446,0,10,"Query not presesnt in the queryNameToQueryInfo dictionary");return!1};A.prototype.k2a=function(){var $a=this,$b=new we.a;this.$.userOperationManager.Sb(new ic.a(587,0,function(wc,Sc,yc){return Ff.c($a.$.oa.xa,Se.b(wc,$a.zRj,$a.aDf,function(){$b.setResult(!0)}),Se.a(Sc,
$a.vzd,$a.eTi,function(){$b.setResult(!0)}),yc,null)},80,function(){return new If.a}),null);return $b.task};A.prototype.uUg=function($a){if(this.zK.kb($a)){$a=this.zK.getItem($a).ConnectionName;var $b=pe.a(this.$).zGd;if($b&&$b.has($a))Mb.ULS.sendTraceTag(525342226,0,50,"PowerQueryManager.cancelRefreshQuery: sending cancellation request"),$a=$b.get($a),ac.h(this.$.oa.xa,$a,null,null,null);else if(!pe.a(this.$).i$f($a))return Mb.ULS.sendTraceTag(525342225,0,15,"PowerQueryManager.cancelRefreshQuery: cannot find canceled connection on running requests map"),
!1}return!0};A.prototype.EGd=function($a){this.qhc($a)&&(!dd.EwaSettings.isChangeGateEnabled("OfficeVSO:5842290_HandlePowerQueryRefreshFailedErrors")||this.XTg($a))&&this.zK.kb($a)&&($a=this.zK.getItem($a),pe.a(this.$).kHb($a.ConnectionName,$a.ExternalSourceIndex,null))};A.prototype.handleQueryAction=function($a,$b){var wc=this;this.zlh($a,$b);this.$.userOperationManager.Sb(new ic.a(1023,0,function(Sc,yc,Dd){return x(wc.$.oa.xa,$a,$b,Se.b(function(Sd){0<Sd.Errors.length&&wc.k2a()},Sc),Se.a(function(){wc.k2a()},
yc),Dd,null)},68),null)};A.prototype.zlh=function($a,$b){switch($a){case 2:this.Alh($b);break;default:return}this.aDf(void 0,void 0,void 0)};A.prototype.Alh=function($a){var $b=this.zK.getItem($a.Name);$b.ConnectionName="Query - "+$a.ExtraData;$b.QueryName=$a.ExtraData;this.queries.find(function(wc){return wc.Name===$a.Name}).Name=$a.ExtraData;this.zK.remove($a.Name);this.zK.add($a.ExtraData,$b)};A.prototype.Qc=function(){return!1};A.prototype.Lc=function(){return!1};A.prototype.executeCommand=function($a,
$b){$a=Qd.TaskExtensions.jk();return-1193102612===$b.command?(this.t6i(),$a):Wc.a($b.command)};A.prototype.zc=function($a,$b){switch($b.command){case -1193102612:return!0}return!1};A.prototype.DTh=function($a){return this.f0e($a)?this.XHh():Promise.resolve(null)};A.prototype.dispose=function(){Aa.a.oc([this.Pa]);dd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryAuthenticateRefresh",!1)&&pe.a(this.$).NId(this.rOa);dd.EwaSettings.isChangeGateEnabled("OfficeVSO:6242825_RegisterLoadOnDemandOccurredOnPQManager")&&
(this.$.ea.Bw(this.Qf),this.$.ea.yR(this.qo),this.$=null)};A.prototype.Syj=function($a,$b){var wc=le.a.Xc(1,2,2179,0,0,$a,"PowerQueryRefreshValidationFailed");switch($a){case -1543585732:wc.MessageIdName="PowerQueryRefreshProtectedSheetFailed";wc.Description=String.format(uc.a.instance.Xa(697),$b,uc.a.instance.ga(2180));break;case 165156185:wc.MessageIdName="PowerQueryRefreshSheetViewFailed";wc.Description=String.format(uc.a.instance.Xa(697),$b,uc.a.instance.ga(2181));break;default:Mb.ULS.sendTraceTag(529069344,
0,10,"PowerQueryManager.showEwaErrorDialog: unhandled error id {0}",$a)}dd.EwaSettings.kz()?new Rg.a(this.$,wc):($a=new Yf.ErrorDialog(this.$,wc),$a.initialize(),$a.gf())};A.prototype.XTg=function($a){var $b=this.$$a.getItem($a);return $b?($b=this.hNh($b))?(this.Syj($b,$a),!1):!0:(Mb.ULS.sendTraceTag(529069343,0,10,"PowerQueryManager.getErrorMessageIdForQueryRefresh: Query not in the queryNameToQueryInfo dictionary"),!1)};A.prototype.hNh=function($a){if(($a=this.LWh($a))&&$a.fj)return-1543585732;
if($a&&$a.Md.Qx)return 165156185};A.prototype.LWh=function($a){var $b=void 0,wc=void 0;if(3===$a.FillObjectType||2===$a.FillObjectType)$b=$a.FillObjectName.split("!")[0];else if(0==$a.FillObjectType){if(!$a.FillObjectName)return Mb.ULS.sendTraceTag(523534751,0,15,"PowerQueryManager.getSheetFromLoadDestination: FillObjectName is undefined for Query loaded to table."),wc;($a=this.$.vb.getItemByName($a.FillObjectName))?$b=$a.sheetName:Mb.ULS.sendTraceTag(527743194,0,15,"PowerQueryManager.getSheetFromLoadDestination: cannot find namedObject for query")}$b&&
(wc=this.$.va.getItemByName($b));return wc};A.prototype.t6i=function(){var $a=this;this.VEe?this.tMf(this.queries):this.k2a().continueWith(function($b){$b.result?$a.tMf($a.queries):Mb.ULS.sendTraceTag(537154445,0,10,"PowerQueryManager.RefreshAllQueries failed to fatch queries")})};A.prototype.tMf=function($a){$a=bk($a);for(var $b=$a.next();!$b.done;$b=$a.next())this.EGd($b.value.Name)};A.prototype.H6i=function($a){$a=this.f0e($a);if(!$a)throw Error.argumentNull;this.EGd($a)};A.prototype.f0e=function($a){for(var $b=
bk(this.queries),wc=$b.next();!wc.done;wc=$b.next())if(wc=wc.value,this.zK.getItem(wc.Name).ConnectionName===$a)return wc.Name;return null};A.prototype.XHh=function(){if(!dd.EwaSettings.isChangeGateEnabled("OfficeVSO:6601217_PowerQueryGetAuthToken"))return Promise.resolve(null);Mb.ULS.sendTraceTag(520734801,0,50,"PowerQueryManager:GetToken: Token requested for PQO service");try{return this.xDb.xO("PowerQueryWeb",this.$.ya.PowerQueryAudienceUri).then(function($a){if($a.IsSuccess)return Mb.ULS.sendTraceTag(520734800,
0,50,"PowerQueryManager.getAuthToken: successfully fetch token."),$a.Token;Mb.ULS.sendTraceTag(520734799,0,15,"PowerQueryManager.getAuthToken: failed to get token. Error code: {0}, Error message : {1}",$a.ErrorCode,$a.ErrorMessage);return Promise.resolve(null)},function(){Mb.ULS.sendTraceTag(520734798,0,15,"PowerQueryManager.getAuthToken: got rejected promise, use fallback value");return Promise.resolve(null)})}catch($a){return Mb.ULS.sendTraceTag(520734797,0,10,"PowerQueryManager.getAuthToken: Exception thrown when fetching token, Exception: {0}",
$a),Promise.resolve(null)}};Mf.Object.defineProperties(A.prototype,{aki:{configurable:!0,enumerable:!0,get:function(){return this.F8d}},queries:{configurable:!0,enumerable:!0,get:function(){return this.$$a.values}},groups:{configurable:!0,enumerable:!0,get:function(){return this.c6d}},formulas:{configurable:!0,enumerable:!0,get:function(){return this.Q5d}},zK:{configurable:!0,enumerable:!0,get:function(){return this.Ntg}}});Object(ub.a)(A,"PowerQueryManager",null,[891,429,3]);var dh=b(911),Bg=Tc.a;
Rk(B,Bg);B.prototype.create=function(){var $a=this,$b=this.$.da;dd.EwaSettings.isChangeGateEnabled("OfficeVSO:6601217_PowerQueryGetAuthToken")?Qd.TaskExtensions.Aa(Kd.GetServiceTaskFactory.Ra($b,349,350,this.hb),function(wc){$a.pb(Object(dh.c)($b,470,function(){return new A($a.$,wc.result)}))},this.$.la,3):this.pb($b.za(470)||$b.Ga(470,new A(this.$,null)))};B.ka=function($a){$a.da.Ga(471,new B($a))};Object(ub.a)(B,"PowerQueryManagerFactory",Tc.a,[]);var Zf;(function($a){$a[$a.null=-1]="null";$a[$a.table=
0]="table";$a[$a.connectionOnly=1]="connectionOnly";$a[$a.pivotTable=2]="pivotTable";$a[$a.pivotChart=3]="pivotChart"})(Zf||(Zf={}));Object(ub.b)("FillObjectType",Zf);var bg=b(276),pg=b(357),kh=b(110);Object(ub.a)(w,"GroupInfo",null,[]);Object(ub.a)(m,"PowerQueryTaskPaneCallbacks",null,[]);Object(ub.a)(y,"PowerQueryTaskPaneProps",null,[]);Object(ub.a)(r,"QueryInfo",null,[]);v.prototype.mI=function($a){var $b=this;this.isVisible=!0;lc.UISurfaces.Mj().then(function(wc){wc.showTaskPane("PowerQueryTaskPane",
$b.q2c($a));return null})};v.prototype.Mw=function($a,$b,wc,Sc){var yc=this;wc=void 0===wc?null:wc;Sc=void 0===Sc?null:Sc;if(this.isVisible){var Dd=this.q2c($a,$b,wc,Sc);lc.UISurfaces.Mj().then(function(Sd){Sd.updateTaskPane("PowerQueryTaskPane",Dd||yc.q2c($a,$b,wc,Sc));return null})}else this.edg($b,wc)};v.prototype.JM=function(){this.isVisible=!1;lc.UISurfaces.Mj().then(function($a){$a.hideTaskPane("PowerQueryTaskPane",2);return null})};v.prototype.X4f=function($a){if(!bg.a.fh($a)){for(var $b=bk(this.R_),
wc=$b.next();!wc.done;wc=$b.next())wc=wc.value,Array.contains($a,wc.name)&&(this.zab.add(wc.name,wc),this.IGd[wc.name]=++this.vMf,Mb.ULS.sendTraceTag(537154401,0,50,"Refresh started for query #: {0}",this.vMf));this.Mw(null,null,null)}};v.prototype.G5f=function($a){if(!bg.a.fh($a)){for(var $b=bk(this.R_),wc=$b.next();!wc.done;wc=$b.next())wc=wc.value,Array.contains($a,wc.name)&&(wc.name in this.IGd&&Mb.ULS.sendTraceTag(537154400,0,50,"Refresh stoped for query #: {0}",this.IGd[wc.name]),this.zab.remove(wc.name));
this.Mw(null,null,null)}};v.prototype.edg=function($a,$b){$a=void 0===$a?null:$a;$b=void 0===$b?null:$b;dd.EwaSettings.Bef()&&$b&&$b.length&&$a?(this.vva.clear(),this.wva.clear(),this.r4a.clear(),this.R_=[],this.s4a=[],this.d_i($b),this.l_i($a),this.s4a=this.M2c("root",-1).children,this.s4a=this.s4a.concat(this.M2c("Other Queries",0))):$a&&(this.vva.clear(),this.wva.clear(),this.r4a.clear(),this.s4a=this.R_=null,this.R_=this.CDe($a,0));this.m_i()};v.prototype.q2c=function($a,$b,wc,Sc){var yc=this;
Sc=void 0===Sc?null:Sc;this.edg(void 0===$b?null:$b,void 0===wc?null:wc);$b=Object(De.a)(new m,{onQuerySelected:this.Tya.onQuerySelected,onQueryRefresh:this.Tya.onQueryRefresh,onCancelQueryRefresh:this.Tya.onCancelQueryRefresh,handleQueryGroupOperation:this.handleQueryGroupOperation,handleQueryAction:this.handleQueryAction});Sc=Object(De.a)(new y,{type:"PowerQueryTaskPaneProps",callbacks:$b,queries:this.R_,groups:this.s4a,selectedQueryKey:Sc});if(Fa.a.ud(this.$))return Object(De.a)(new Pc.a,{contentProps:Sc,
onOpen:function(){yc.Tya.Zx()},onClose:function(){yc.Tya.pB()},width:320,title:uc.a.instance.ga(2171)});$a=Object(De.a)(new md.a,{container:$a,paneProps:Sc});return Object(De.a)(new Pc.a,{contentProps:$a,onOpen:function(){yc.Tya.Zx()}})};v.prototype.m_i=function(){if(this.R_)for(var $a=0;$a<this.R_.length;$a++){var $b=!1,wc=this.R_[$a],Sc=this.zab.getItem(wc.name);null!=Sc&&($b=new Date(wc.lastRefresh),($b=(new Date(Sc.lastRefresh)).getTime()===$b.getTime())||this.zab.remove(Sc.name));wc.inRefresh=
$b;wc.refreshEnabled=this.Tya.Yod(wc.name)}};v.prototype.d_i=function($a){$a=bk($a);for(var $b=$a.next();!$b.done;$b=$a.next()){$b=$b.value;var wc=$b.HasParent?$b.ParentId:"root";this.wva.add($b.Id,$b);this.upe($b,wc)}$a={};$a.Name=uc.a.instance.ga(2174);$a.Id="Other Queries";$a.Order=pg.a.tS;this.wva.add("Other Queries",$a);this.wva.add("root",{Name:"root",Id:"root",Order:0})};v.prototype.l_i=function($a){$a=bk($a);for(var $b=$a.next();!$b.done;$b=$a.next()){var wc=$b.value;$b=wc.GroupID||"Other Queries";
var Sc=this.vva.getItem($b);if("Other Queries"!==$b&&Sc&&Sc.length){Sc="SubGroupOtherQueries-"+$b;if(!this.wva.kb(Sc)){var yc={Name:Sc,Id:Sc};yc.Order=pg.a.tS;this.wva.add(Sc,yc);this.upe(yc,$b)}$b=Sc;wc.GroupID=Sc}wc=[wc];this.r4a.kb($b)&&(wc=wc.concat(this.r4a.getItem($b)));this.r4a.add($b,wc)}};v.prototype.upe=function($a,$b){$a=[$a];this.vva.kb($b)&&($a=$a.concat(this.vva.getItem($b)));this.vva.add($b,$a)};v.prototype.n6g=function($a,$b){var wc=[];if(this.vva.kb($a)){$a=this.vva.getItem($a);$a.sort(function(yc,
Dd){return Fd.HelperMethods.NC(yc.Order,Dd.Order)});$a=bk($a);for(var Sc=$a.next();!Sc.done;Sc=$a.next())wc=wc.concat(this.M2c(Sc.value.Id,$b+1))}return wc};v.prototype.M2c=function($a,$b){var wc=this.wva.getItem($a),Sc=this.r4a.getItem($a),yc=Object(De.a)(new w,{});yc.key=wc.Id;yc.name=wc.Name;yc.data=wc.Description;wc=this.n6g($a,$b);yc.children=this.jye(wc);yc.level=$b;yc.count=0;yc.children.length&&(yc.startIndex=yc.children[0].startIndex,yc.count+=kh.g(yc.children,function(Dd){return Dd.count}));
Sc&&(yc.startIndex=this.R_.length,yc.count+=Sc.length,this.R_=this.R_.concat(this.CDe(Sc,$a.includes("SubGroupOtherQueries-")?$b:$b+1)));return yc};v.prototype.CDe=function($a,$b){var wc=[];$a=bk($a);for(var Sc=$a.next();!Sc.done;Sc=$a.next())Sc=Sc.value,Sc=this.zab.kb(Sc.Name)&&!dd.EwaSettings.isChangeGateEnabled("OfficeVSO:5830384_StopRefreshIndicationOnLastUpdateChangesV2")?this.zab.getItem(Sc.Name):this.A8g(Sc,$b),wc.push(Sc);return wc};v.prototype.A8g=function($a,$b){var wc=new r;wc.name=$a.Name;
wc.rowsLoaded=$a.RowsLoaded;wc.lastRefresh=$a.LastRefresh;wc.fillObjectType=$a.FillObjectType;wc.loadedToDataModel=$a.LoadedToDataModel;wc.queryError=$a.QueryError;wc.nestingDepth=$b;wc.rowsWithError=$a.RowsWithError;wc.groupKey=$a.GroupID;return wc};v.prototype.jye=function($a){var $b=[];$a=bk($a);for(var wc=$a.next();!wc.done;wc=$a.next()){wc=wc.value;var Sc=Object(De.a)(new w,{});Sc.key=wc.key;Sc.name=wc.name;Sc.count=wc.count;Sc.startIndex=wc.startIndex;Sc.data=wc.data;Sc.children=this.jye(wc.children);
Sc.level=wc.level;$b.push(Sc)}return $b};Object(ub.a)(v,"PowerQueryReactTaskPane",null,[832]);f.prototype.gAj=function(){var $a=this;if(Fa.a.ud(this.$))this.showTaskPane();else if(this.powerQueryTaskPane||this.JGf)this.powerQueryTaskPane&&(this.powerQueryTaskPane.Zf(!0),this.showTaskPane());else{this.JGf=!0;var $b=Kd.GetServiceTaskFactory.Ra(this.$.da,408,409,0),wc=Tb.a(this.$);Qd.TaskExtensions.Aa(Qd.TaskExtensions.Vd([$b,wc],this.$.la),function(){$a.powerQueryTaskPane=$b.result;wc.result.GQ($a.powerQueryTaskPane);
$a.k6();$a.powerQueryTaskPane.Zf(!0);$a.showTaskPane()},this.$.la,3)}};f.prototype.cai=function($a){this.lma=new v($a,this)};f.prototype.k6=function(){this.Hpc=this.powerQueryTaskPane.iM();this.powerQueryTaskPane.RL(this.FEb)};f.prototype.dispose=function(){pe.a(this.$).NId(this.rOa);pe.a(this.$).SPf(this.mAf);this.powerQueryManager.xcj(this.Jwf);this.$=null;this.hideTaskPane();this.powerQueryTaskPane&&(this.powerQueryTaskPane.QN(this.FEb),this.powerQueryTaskPane=this.Hpc=null);this.lma=null};f.prototype.Zx=
function(){this.powerQueryManager.k2a();dd.EwaSettings.isChangeGateEnabled("OfficeVSO:5138260_ActivateQueryTargetWhenQuerySelected")&&this.$.vb.If(this.oe);Fa.a.ud(this.$)||dd.EwaSettings.isChangeGateEnabled("OfficeVSO:5159002_FixPowerQueryPaneFocusOnOpen")||this.powerQueryTaskPane.Sf(!0,!1)};f.prototype.pB=function(){this.yf=!1};f.prototype.handleQueryGroupOperation=function($a,$b){var wc=this;od.a(this.$.userOperationManager,function(Sc,yc,Dd){var Sd=wc.$.oa.xa,Fe=Sd.Na(1,null);Fe.groupOperation=
$a;Fe.groupOperationPayload=$b;return ac.g(Sd,"EditPowerQueryGroup",Fe,Sc,yc,Dd,null,0)},function(Sc){return new ic.a(1021,0,Sc)},null)};f.prototype.showTaskPane=function(){this.yf||(dd.EwaSettings.isChangeGateEnabled("OfficeVSO:5252502_AddHealthMetricsForPQTP")&&(this.Xyc=this.$.Fb.sc("UserAction","PowerQueryTaskPaneInitialLoadTime")),this.yf=!0,this.lma.mI(this.Hpc))};f.prototype.updateTaskPane=function($a,$b,wc){this.lma.Mw(this.Hpc,$a,$b,wc);this.Xyc&&dd.EwaSettings.isChangeGateEnabled("OfficeVSO:5252502_AddHealthMetricsForPQTP")&&
(this.Xyc.stop(),this.Xyc=null);for($a=0;$a<this.powerQueryManager.queries.length;$a++)$b=this.powerQueryManager.queries[$a],0===$b.FillObjectType&&this.ZTd.add($b.FillObjectName,$b.Name),$b.LastRefresh||Mb.ULS.sendTraceTag(537154436,0,15,"PowerQueryPaneManager.UpdateTaskPane: Invalid date for last refreshed.")};f.prototype.hideTaskPane=function(){this.yf=!1;this.lma.JM()};f.prototype.tLi=function(){this.updateTaskPane(this.powerQueryManager.queries,this.powerQueryManager.groups,null);this.zEf||(this.dOi(pe.a(this.$).MMf),
this.zEf=!0)};f.prototype.dOi=function($a){var $b=[];$a=bk($a);for(var wc=$a.next();!wc.done;wc=$a.next()){wc=wc.value;for(var Sc=bk(this.powerQueryManager.zK.values),yc=Sc.next();!yc.done;yc=Sc.next())if(yc=yc.value,wc===yc.ConnectionName&&(yc=yc.QueryName,this.powerQueryManager.qhc(yc))){Array.add($b,yc);break}}this.lma.X4f($b)};Object(ub.a)(f,"PowerQueryPaneManager",null,[822]);n.prototype.Qc=function(){return!1};n.prototype.Lc=function(){return!1};n.prototype.executeCommand=function($a,$b){this.Ipc||
(this.Ipc=new f(this.$,this.BZi));$a=Qd.TaskExtensions.jk();return 1156885807===$b.command?(this.Ipc.gAj(),$a):Wc.a($b.command)};n.prototype.dispose=function(){this.$=this.Ipc=null};n.prototype.zc=function($a,$b){$a=!1;switch($b.command){case 1156885807:$a=dd.EwaSettings.isChangeGateEnabled("OfficeVSO:6320032_PowerQueryTaskPane")}return $a};Object(ub.a)(n,"PowerQueryPaneCommandHandler",null,[429,3]);var lg=Da.a;Rk(l,lg);l.prototype.Ad=function(){var $a=this;this.$.bB(function(){dd.EwaSettings.isChangeGateEnabled("OfficeVSO:5751619_PowerQueryManagerWebClient")?
Qd.TaskExtensions.Aa(Kd.GetServiceTaskFactory.Ra($a.$.da,470,471,1),function($b){$a.jd([new n($a.$,$b.result)])},$a.$.la,3):$a.jd([new n($a.$,null)])})};l.ka=function($a){Da.a.Qd(407,new l($a))};Object(ub.a)(l,"PowerQueryPaneCommandHandlerFactory",Da.a,[]);var ig=b(143);k.dqh="ewa-pqtp-pane";k.cqh="ewa-pqtp-header";k.eqh="ewa-pqtp-title";k.aqh="ewa-pqtp-body";k.bqh="ewa-pqtp-close-button";Object(ub.a)(k,"CssClassNames",null,[]);var th=k.dqh,mg=k.cqh,fg=k.aqh,Sg=k.eqh,yf=fb.a.Odb+k.bqh,Tg=Rc.a;Rk(e,
Tg);e.prototype.kP=function($a){this.get_events().addHandler("PQTPR",$a)};e.prototype.zR=function($a){this.get_events().removeHandler("PQTPR",$a)};e.prototype.RL=function($a){this.addHandler("PQTPC",$a)};e.prototype.QN=function($a){this.removeHandler("PQTPC",$a)};e.prototype.qH=function(){};e.prototype.Vo=function(){return this.lp};e.prototype.Nr=function(){return this.lp};e.prototype.mR=function(){};e.prototype.AQ=function(){return!1};e.prototype.ej=function(){};e.prototype.Aj=function(){};e.prototype.dispose=
function(){this.$&&this.$.Ol(this.Fc);this.de&&(nb.a.instance.Ba(kc.a.click,this.de,this.Qj),cc.KeyInputManager.instance.pv(this.de,this.zye));this.de=this.taskPaneManager=this.$=null;Tg.prototype.dispose.call(this)};e.prototype.Sf=function($a,$b){$b||($a=Fc.DOMElementExtensions.getElementById(this.domElement,"PowerQueryContainerId-1"),$a||($a=this.de),Fc.DOMElementExtensions.setFocus($a));return!$b};e.prototype.$g=function($a){return Fc.DOMElementExtensions.nf(this.ic,$a)};e.prototype.Zf=function($a){this.lp=
$a;var $b=this.taskPaneManager;this.isVisible=$a;this.taskPaneManager.Kw();$a&&0<$b.Mz.length&&(!$b.xg||17!==$b.xg.taskPane.Ng||$b.isCollapsed)&&$b.GF(this,!0)};e.prototype.iM=function(){var $a=document.getElementById(this.$.yb+fb.a.iDd);$a.setAttribute(ig.a.ariaLabel,uc.a.instance.ga(2171));var $b=this.HG();$a.appendChild($b);$b=Ke.b("div","PowerQueryPaneBodyId",fg);$a.appendChild($b);return $b};e.prototype.HG=function(){var $a=Ke.b("div","PowerQueryPaneHeaderId",mg),$b=Ke.b("span","PowerQueryPaneTitleId",
Sg);$b.innerText=this.titleText;this.de=Qb.a.nb("PowerQueryPaneCloseButtonId",yf,uc.a.instance.ga(10),"ClosePaneGlyph_16x16x32",!1);this.de.classList.add(bc.AFrameworkApplication.isRtl?fb.a.vaa:fb.a.waa);nb.a.instance.ra(kc.a.click,this.de,this.Qj);this.zye=cc.KeyInputManager.instance.Xr(this.de,this.Qj,Mc.a.Oh);$a.appendChild($b);$a.appendChild(this.de);return $a};e.ka=function($a,$b){var wc=$a.yb,Sc=document.getElementById(wc+fb.a.iDd);Sc||(Sc=document.createElement("div"),Sc.id=$a.yb+fb.a.iDd,
Fa.a.ud($a)||document.getElementById(wc+fb.a.gR).appendChild(Sc));Sc.classList.add(th);wc=$a.da;return wc.za(408)||wc.Ga(408,new e(Sc,$a,$b))};Mf.Object.defineProperties(e.prototype,{isVisible:{configurable:!0,enumerable:!0,get:function(){return Object(nf.a)(e.prototype,this,"isVisible")},set:function($a){Object(nf.a)(e.prototype,this,"isVisible")!==$a&&Object(nf.b)(e.prototype,this,"isVisible",$a)}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return this.isVisible}},Yd:{configurable:!0,
enumerable:!0,get:function(){return ad.a.AZi}},Ng:{configurable:!0,enumerable:!0,get:function(){return 17}},Jk:{configurable:!0,enumerable:!0,get:function(){return tb.a.qth}},MM:{configurable:!0,enumerable:!0,get:function(){return uc.a.instance.ga(2171)}},titleText:{configurable:!0,enumerable:!0,get:function(){return uc.a.instance.ga(2171)}},ko:{configurable:!0,enumerable:!0,get:function(){return 320}},ic:{configurable:!0,enumerable:!0,get:function(){return this.domElement}},height:{configurable:!0,
enumerable:!0,get:function(){return this.taskPaneManager.oO.offsetHeight}},isResizable:{configurable:!0,enumerable:!0,get:function(){return!1}}});Object(ub.a)(e,"PowerQueryTaskPane",Rc.a,[804,3,494,448]);var nh=Tc.a;Rk(d,nh);d.prototype.create=function(){var $a=this,$b=Kd.GetServiceTaskFactory.create(this.$.da,203,this.la,this.hb),wc=Kd.GetServiceTaskFactory.create(this.$.da,155,this.la,this.hb);Qd.TaskExtensions.Aa(Qd.TaskExtensions.ts(Qd.TaskExtensions.Vd([$b,wc],this.la),function(){return $a.WC},
this.la),function(){$a.pb($a.Wg)},this.la,3)};d.prototype.dispose=function(){this.Wg=this.gi=this.$=null;nh.prototype.dispose.call(this)};d.ka=function($a){$a.da.Ga(409,new d($a))};Mf.Object.defineProperties(d.prototype,{WC:{configurable:!0,enumerable:!0,get:function(){var $a=this;this.gi||(this.gi=Qd.TaskExtensions.Aa(Tb.a(this.$),function($b){$a.Wg=e.ka($a.$,$b.result)},this.la,3));return this.gi}}});Object(ub.a)(d,"PowerQueryTaskPaneFactory",Tc.a,[]);c.prototype.getExpandedRangeForPivotTable=function($a,
$b,wc,Sc,yc,Dd,Sd,Fe){Fe=$a.Na(1,void 0===Fe?null:Fe);Fe.sheetRange=$b;Fe.activeCell=wc;return ac.g($a,"GetExpandedRangeForPivotTable",Fe,Sc,yc,Dd,Sd,0)};Object(ub.a)(c,"ExpandRange",null,[803]);var Ug=Tc.a;Rk(a,Ug);a.ka=function($a){$a.da.Ga(483,new a($a))};a.prototype.create=function(){var $a;this.pb(null!==($a=this.$.da.za(482))&&void 0!==$a?$a:this.$.da.Ga(482,new c))};Object(ub.a)(a,"ExpandRangeFactory",Tc.a,[]);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.InsertPivotTable");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.PivotCommand");
Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.PowerQuery");Type.registerNamespace("_Ewa");Ab.a.ti(".ewa-insertpt-dlg-input{position:relative;width:50%;padding-left:3px}.ewa-insertpt-dlg-label{margin-left:50px;margin-right:5px}.ewa-insertpt-label{vertical-align:text-top}.ewa-insertpt-dlg-sourceRange{white-space:nowrap}");Ab.a.ti('.ewa-ptsp-pane{background:#edebe9;height:100%;display:flex;flex-direction:column;overflow:hidden}.ewa-ptsp-header{position:relative;overflow:hidden;padding:16px;background:#edebe9}.ewa-ptsp-title{position:relative;display:inline-block;text-overflow:ellipsis;overflow:hidden;height:22px;font-weight:normal;font-size:16px;color:#252423;font-family:"Segoe UI Semibold","Segoe UI Web Semibold","Arial Semibold","Verdana Semibold","sans-serif Semibold";background:#edebe9}.ewa-ptsp-body{background:#edebe9;padding:0 16px;height:100%;display:flex;flex-direction:column;justify-content:flex-start;align-items:stretch;overflow-y:auto;overflow-x:hidden}.ewa-ptsp-close-button{display:inline-block;padding:1px;font-size:16px}.ewa-filterconnections-dlg-hr{margin:8px -14px 0 -14px;border:none;height:1.5px;background-color:#e1e1e1}.ewa-filterconnections-dlg-table{border-spacing:1px}.ewa-filterconnections-dlg-table thead tr{display:block;cursor:default;pointer-events:none}.ewa-filterconnections-dlg-table tbody{border:1px solid #e1e1e1;display:block;max-height:120px;overflow-y:auto}.ewa-filterconnections-dlg-table td{text-align:left;width:100px}.ewa-filterconnections-dlg-table tbody tr{display:block}.ewa-filterconnections-dlg-level{width:20px}.ewa-filterconnections-dlg-column{width:100px}');
Ab.a.ti('.ewa-pqtp-pane{height:100%;display:flex;flex-direction:column;overflow:hidden;background-color:#f5f5f5}.ewa-pqtp-header{position:relative;overflow:hidden;padding:16px}.ewa-pqtp-title{height:22px;display:inline-block;color:#252423;font-size:16px;font-family:"Segoe UI Semibold","Segoe UI Web",Arial,Verdana,sans-serif}.ewa-pqtp-body{height:100%;display:flex;flex-direction:column;justify-content:flex-start;align-items:stretch;overflow-x:hidden;overflow-y:auto}.ewa-pqtp-close-button{height:22px;width:22px;color:#252423;display:inline-block}.ewa-pqtp-close-button .clip16x16{top:2px;left:2px}');
(function(){nc.a.Fa(function($a){Qd.TaskExtensions.Aa(Kd.GetServiceTaskFactory.Ra($a.da,12,477,1),function($b){Z.ka($a,$b.result)},$a.la)})})();(function(){nc.a.Fa(function($a){Ha.ka($a);ab.ka($a);ma.ka($a)})})();nc.a.Fa(Ga.ka);(function(){nc.a.Fa(function($a){ra.ka($a)})})();nc.a.Fa(ja.fGa);nc.a.Fa(wa.ka);(function(){nc.a.Fa(function($a){ca.ka($a);J.ka($a);N.ka($a)})})();(function(){nc.a.Fa(function($a){I.ka($a);U.ka($a)})})();(function(){nc.a.Fa(function($a){l.ka($a);D.ka($a);d.ka($a);B.ka($a)})})();
(function(){nc.a.Fa(function($a){a.ka($a)})})()}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.bi.js.map/28fb087ac631bfb81223274dc2a64f86/EwaDS.bi.js.map