(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[6],{1018:function(u,E,b){function a(M,C,Q){this.DQb=null;this.uF={};this.vRb=this.Zw=null;l.ULS.sendTraceTag(537159566,0,50,"BorderFormatManager: Request new instance");this.$=M;this.g3d=a.K4c;this.h3d=a.borderStyleSolidLine;this.Fg=C;this.Va=Q;B.EwaSettings.isChangeGateEnabled("OfficeVSO:5680290_AddBorderFormatManagerFactory")||this.$.da.Ga(296,this);this.yU=new c(this.$,this.Fg);this.JC=B.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",
!1);l.ULS.sendTraceTag(537159565,0,50,"BorderFormatManager: register BorderFormatManager with ServiceName {0}","296")}function c(M,C){var Q=this;this.qGb=this.ribbonCommandInfo=this.cellFormat=this.Ar=this.qb=this.ha=null;this.nrc=!1;this.BHf=this.lLa=this.JHf=this.U6d=this.Zya=this.nma=null;this.C0b=this.Lta=this.IHf=0;this.borderStyle=this.EZa=this.borderColor=null;this.fB=!1;this.F0a=this.K$a=null;this.d0=function(){if(!Q.fB||K.g(Q.$).gz)Q.fB=!1,K.g(Q.$).gz=!1,Q.Lta=0,K.g(Q.$).hg.vo(v.a.m4),1===
Q.$.Ka.bH()&&(K.g(Q.$).aV(z.a.clone(Q.JHf),Q.IHf,Q.$.pa?Q.$.pa.sheetName:null,null,Q.BHf.clone(),null,null,0,H.a.Bhh,!0),K.g(Q.$).NRa(!0)),Q.qv(),Q.PWd(),Q.Tj(),Q.nrc=!1,Q.nma=null,Q.Zya=null,Q.Ar&&(Q.Ar.cancel(),Q.Ar.dispose()),l.ULS.sendTraceTag(537159516,0,50,"DrawBorderBehavior.ResetBehavior : Ending ResetBehavior ")};this.onPointerDown=function(P){try{if(P=Q.Rd(P),K.g(Q.$).gz=!0,Q.nma={},Q.Zya={},Q.K$a=null,Q.Qob(Q.C0b),2===P.lb){var ka=K.g(Q.$).ha.Kn(P.clientPoint,P.zb,5,void 0,void 0,!1);ka&&
(Q.lLa=ka,Q.F0a=ka,Q.j7i())}}catch(R){K.g(Q.$).gz=!1}return!0};this.ai=function(P){try{P=Q.Rd(P);var ka=K.g(Q.$).ha.Kn(P.clientPoint,P.zb,5,void 0,void 0,!1),R=K.g(Q.$).Ea.Jr(ka);if(!Q.qGb||R&&(R.WJ!==Q.qGb.WJ||R.VJ!==Q.qGb.VJ))if(Q.fB=!0,Q.qGb=R,ka){var fa=new G.Range(Q.lLa.top,Q.lLa.left,Q.lLa.top,Q.lLa.left,!0,!1);fa.union(ka);fa=K.g(Q.$).ha.rUh(fa);Q.G0b(ka);Q.FSf(Q.K$a,fa);if(Q.bottomRightCorner(fa.bottom,fa.right))return l.ULS.sendTraceTag(537159515,0,15,"DrawBorderBehavior.OnPointerMove - Bottom-right corner of sheet reached, cannot expand further."),
!1;var ca=new G.Range(fa.top,fa.left,fa.bottom+1,fa.right+1,!0,!1),ea=K.g(Q.$).K$("DrawBorderBehavior.OnPointerMove",[ca]);if(Q.nma&&Q.Zya)for(;ea.$$mn();){var wa=ea.$$cu(),X=wa.cell.getRange().toString();X in Q.nma&&1!==Q.Lta||(Q.nma[X]=wa,Q.Zya[X]=wa.cell.wM())}Q.K$a=ca;Q.F0a=fa;K.g(Q.$).aV([fa],0,Q.$.pa.sheetName,null,fa.topLeft,null,null,0,H.a.yhh,!0);Q.Fg.Kda(K.g(Q.$),-1690267012,Q.cellFormat,!0,null,[fa])}return!0}catch(ja){return K.g(Q.$).gz=!1}};this.Bf=function(P){P=Q.Rd(P);(P=K.g(Q.$).ha.Kn(P.clientPoint,
P.zb,5,void 0,void 0,!1))?Q.fB&&(Q.G0b(P),Q.lLa.union(P),3===Q.Lta?Q.Qob(0):Q.Qob(Q.C0b),K.g(Q.$).aV([Q.lLa],0,Q.$.pa.sheetName,null,null,null,null,0,H.a.zhh,!0),Q.Fg.formatCells(-1690267012,Q.cellFormat,Q.ribbonCommandInfo)):(3===Q.Lta?Q.Qob(0):Q.Qob(Q.C0b),K.g(Q.$).aV([Q.F0a],0,Q.$.pa.sheetName,null,null,null,null,0,H.a.Ahh,!0),Q.Fg.formatCells(-1690267012,Q.cellFormat,Q.ribbonCommandInfo));Q.fB=!1;Q.PWd();Q.nma=null;Q.Zya=null;return!0};this.onKeyDown=function(P){P=Q.Rd(P);if(Q.fB||Array.contains([17,
16,18,20],P.Ca.keyCode))return!0;Q.d0();return!1};this.onKeyUp=function(P){P=Q.Rd(P);if(P.Ca.keyCode===x.a.jL&&Q.fB)return Q.fB=!1,Q.FSf(Q.K$a,Q.F0a,!0),Q.PWd(),!0;if(Q.fB||P.Ca.keyCode===x.a.Z7||P.Ca.keyCode===x.a.V_d||P.Ca.keyCode===x.a.U_d||Array.contains([17,16,18,20,37,39,38,40,33,34,9,13],P.Ca.keyCode)||P.Ca.keyCode===x.a.njg||P.Ca.keyCode===x.a.jjg||P.Ca.keyCode===x.a.fjg)return!0;Q.d0();return!1};this.hR=function(P,ka){K.g(Q.$).gz&&!Array.contains(Q.n7h,ka.Ed.command)&&(l.ULS.sendTraceTag(537159512,
0,50,"DrawBorderBehavior.OnCommandExecutionStarting : Command Triggered : {0} ",ka.Ed),Q.d0())};this.$=M;this.Fg=C}function d(M){M.lNf()}function e(){this.iconName=this.title=this.key=null}function k(M,C,Q,P,ka,R,fa,ca){this.Okg=M;this.Pkg=C;this.Nkg=Q;this.oga=P;this.swg=ka;this.Asg=R;this.njb=fa;this.zrg=ca}b.r(E);u=b(0);var l=b(14),n=b(1025),f=b(936),v=b(5),r=b(76),y=b(53),m=b(203),w=b(34),B=b(1),A=b(15);k.sPg=function(){return new k("BorderStyleSolidLine",1933,1,"1","",1,8,0)};k.oPg=function(){return new k("BorderStyleDashedLine",
1934,3,"1","5,3",1,8,0)};k.pPg=function(){return new k("BorderStyleDottedLine",1935,4,"1","1,1",1,8,0)};k.rPg=function(){return new k("BorderStyleMediumLine",1936,2,"2","",1,8,0)};k.tPg=function(){return new k("BorderStyleThickLine",1937,5,"3","",1,8,0)};k.qPg=function(){return new k("BorderStyleDoubleLine",1938,6,"1","",2,8,3)};Mf.Object.defineProperties(k.prototype,{cte:{configurable:!0,enumerable:!0,get:function(){return this.Okg}},A0b:{configurable:!0,enumerable:!0,get:function(){return this.Pkg}},
bte:{configurable:!0,enumerable:!0,get:function(){return this.Nkg}},width:{configurable:!0,enumerable:!0,get:function(){return this.oga}},kFj:{configurable:!0,enumerable:!0,get:function(){return this.swg}},rEi:{configurable:!0,enumerable:!0,get:function(){return this.Asg}},lineHeight:{configurable:!0,enumerable:!0,get:function(){return this.njb}},Gri:{configurable:!0,enumerable:!0,get:function(){return this.zrg}}});Object(u.a)(k,"BorderLineStyleProperties",null,[]);Object(u.a)(e,"BorderLineStyleProps",
null,[]);d.prototype.getBorderLineStyleProps=function(){var M=b(1018).BorderFormatManager.DZa,C=Array(Object.keys(M).length),Q=0,P;for(P in M){var ka=P,R=M[P];C[Q]=new e;C[Q].key=ka;ka=R;C[Q].title=A.a.instance.ga(ka.A0b);C[Q].iconName=ka.cte;Q++}return C};Object(u.a)(d,"BorderMenuController",null,[751]);var z=b(276),x=b(86),D=b(245),I=b(13),F=b(109),G=b(24),T=b(47),O=b(44),U=b(217),J=b(11),H=b(95),K=b(21),N=b(33);c.prototype.Zyg=function(M){l.ULS.sendTraceTag(537159517,0,50,"DrawBorderBehavior.ActivateBehavior : Starting ActivateBehavior ");
this.ha=K.g(this.$).ha;this.qb=K.g(this.$).qb;this.ribbonCommandInfo=M;this.JHf=z.a.clone(this.ha.sa.selectedRanges);this.IHf=this.ha.sa.Vs;this.BHf=this.ha.sa.activeCell.clone();this.qb&&this.qb.Hid();this.av();this.Pi()};c.prototype.dispose=function(){this.d0();this.qGb=this.ribbonCommandInfo=this.cellFormat=null};c.prototype.Qob=function(M){var C=b(1018).BorderFormatManager;this.cellFormat={};var Q={};this.borderColor=this.borderColor||C.K4c;var P=m.a.XG(this.borderColor,!1);Q.Color=[P,P,P,P];
B.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1)&&this.EZa&&(Q.ThemeBorderColor=[this.EZa,this.EZa,this.EZa,this.EZa],Q.ColorTypeOption=1);P=b(1018).BorderFormatManager.DZa;this.borderStyle=this.borderStyle||C.borderStyleSolidLine;C=P[this.borderStyle].bte;Q.LineStyle=[C,C,C,C];this.cellFormat.BorderFormat=Q;this.cellFormat.ValidMembers=128;this.cellFormat.Border=M};c.prototype.av=function(){for(var M=bk(K.g(this.$).en),C=M.next();!C.done;C=M.next())D.a.instance.ra(I.a.pointerDown,
C.value.domElement,this.onPointerDown);F.KeyInputManager.instance.ra(I.a.Lb,document.documentElement,this.onKeyDown);F.KeyInputManager.instance.ra(I.a.Gd,document.documentElement,this.onKeyUp)};c.prototype.j7i=function(){for(var M=bk(K.g(this.$).en),C=M.next();!C.done;C=M.next())C=C.value,D.a.instance.ra(I.a.Rj,C.domElement,this.ai),D.a.instance.ra(I.a.Df,C.domElement,this.Bf);D.a.instance.ra(I.a.Df,document.documentElement,this.Bf);D.a.instance.ra(I.a.fy,document.documentElement,this.Bf);this.nrc=
!0};c.prototype.qv=function(){try{for(var M=bk(K.g(this.$).en),C=M.next();!C.done;C=M.next())D.a.instance.Ba(I.a.pointerDown,C.value.domElement,this.onPointerDown);F.KeyInputManager.instance.Ba(I.a.Lb,document.documentElement,this.onKeyDown);F.KeyInputManager.instance.Ba(I.a.Gd,document.documentElement,this.onKeyUp)}catch(Q){K.g(this.$).gz=!1,l.ULS.sendTraceTag(537159514,0,10,"DrawBorderBehavior.UnregisterHandlers: Unregistering of Handlers failed with Exception {0}",Q)}};c.prototype.PWd=function(){if(this.nrc)try{this.nrc=
!1;for(var M=bk(K.g(this.$).en),C=M.next();!C.done;C=M.next()){var Q=C.value;D.a.instance.Ba(I.a.Rj,Q.domElement,this.ai);D.a.instance.Ba(I.a.Df,Q.domElement,this.Bf)}D.a.instance.Ba(I.a.Df,document.documentElement,this.Bf);D.a.instance.Ba(I.a.fy,document.documentElement,this.Bf)}catch(P){K.g(this.$).gz=!1,l.ULS.sendTraceTag(537159513,0,10,"DrawBehavior.UnregisterDrawHandlersForMouse: Unregistering of Handlers failed with Exception {0}",P)}};c.prototype.Pi=function(){this.$.va.If(this.d0);K.g(this.$).Wb.Ak(this.d0);
K.g(this.$).QD(this.d0);this.$.Ka.xFa(this.hR)};c.prototype.Tj=function(){this.$.va.vg(this.d0);K.g(this.$).Wb.vk(this.d0);K.g(this.$).yF(this.d0);this.$.Ka.Aza(this.hR)};c.prototype.FSf=function(M,C,Q){Q=void 0===Q?!1:Q;if(M&&this.nma&&this.Zya)for(M=K.g(this.$).K$("DrawBorderBehavior.ApplyBordersOnPreviewCells",[M]);M.$$mn();){var P=M.$$cu().cell.getRange();if(Q||!C.contains(P)||1===this.Lta){P=P.toString();var ka=w.a.yc(this.nma,P);if(ka){var R=w.a.yc(this.Zya,P);this.setBorders(ka,R);delete this.nma[P];
delete this.Zya[P]}}}};c.prototype.setBorders=function(M,C){var Q=M.cell,P=Q.getRange();Q.Iab();P.right!==this.K$a.right&&(Q=new G.Range(P.top,P.left-1,P.bottom,P.left-1,!0,!1),K.g(this.$).Ea.Jr(Q).NPa(3));P.bottom!==this.K$a.bottom&&(Q=new G.Range(P.top-1,P.left,P.top-1,P.right,!0,!1),K.g(this.$).Ea.Jr(Q).NPa(1));if(null===C||void 0===C?0:C.Borders.length){var ka={};Q=0;for(var R=Array(4),fa=Array(4),ca=0;4>ca;ca++)R[ca]=1,fa[ca]=0;C=bk(C.Borders);for(ca=C.next();!ca.done;ca=C.next()){ca=ca.value;
var ea=ca.BorderPosition;R[ea]=ca.BorderLineStyle;var wa=new U.a(ca.Color.Red,ca.Color.Green,ca.Color.Blue);fa[ea]=wa.iS();Q|=J.HelperMethods.g3a(ca.BorderPosition)}ka.LineStyle=R;ka.Color=fa;ka={BorderFormat:ka};ka.Border=Q;this.Fg.qrj(M,ka,P)}};c.prototype.G0b=function(M){var C=this,Q=new G.Range(Math.max(1,M.top-1),Math.max(1,M.left-1),M.bottom+1,M.right+1,!1,!1);K.g(this.$).QQ(Q)||this.Ar&&this.Ar.Lp||(this.Ar=T.a.instance.create(function(){K.g(C.$).fr(Q,60,H.a.whh)},40,O.a.xhh))};c.prototype.bottomRightCorner=
function(M,C){return 1048576<=M||16384<=C?!0:!1};c.prototype.Rd=function(M){return N.a(this.$).Rd(M)};Mf.Object.defineProperties(c.prototype,{n7h:{configurable:!0,enumerable:!0,get:function(){return this.U6d||(this.U6d=[1256700402,-1756763834,-1418159950,-236759591,-2118943501,1981159862,395594266,-1502853784,-111689794,-1059615499,-1027730316,-1104934572,1872288872,2045211913,1504715724,46555851,-70383382,-28797232])}}});Object(u.a)(c,"DrawBorderBehavior",null,[3]);b.d(E,"BorderFormatManager",function(){return a});
a.prototype.P3e=function(M,C){l.ULS.sendTraceTag(537159564,0,50,"HandleBorderCommand : Begin handling, Command being executed: {0}",C.command.toString());var Q={},P={};var ka=m.a.XG(this.g3,!1);P.Color=[ka,ka,ka,ka];this.JC&&this.dta&&(P.ThemeBorderColor=[this.dta,this.dta,this.dta,this.dta],P.ColorTypeOption=1);M=-600086683===C.command?"OutsideBorders":M[r.a.Nc];P.LineStyle=w.a.yc(a.MGf,M);P.LineStyle?l.ULS.sendTraceTag(537159562,0,50,"RibbonCommand.Border is using the BorderFormat information, the predefined borderStyle requested is {0}",
M):(ka=a.DZa[this.DHa].bte,P.LineStyle=[ka,ka,ka,ka],l.ULS.sendTraceTag(537159563,0,50,"RibbonCommand.Border is using the BorderFormat information, the custom borderStyle requested is {0}",this.DHa));ka=w.a.Tp(a.qOg,M,0);l.ULS.sendTraceTag(40732555,0,50,"RibbonCommand.Border is using the BorderFormat information, the border type requested is {0}, the border color selected is {1}",M,this.g3);Q.BorderFormat=P;4!==ka&&8!==ka||!this.$.pa.displayRtl||(ka=4===ka?8:4);Q.ValidMembers=128;Q.Border=ka;this.Fg.formatCells(-1690267012,
Q,C);l.ULS.sendTraceTag(537159561,0,50,"HandleBorderCommand : Successfully handled, Command executed: {0}",C.command.toString());return!0};a.prototype.Vgd=function(M,C,Q){l.ULS.sendTraceTag(537159560,0,50,"RibbonCommand:{0} is being executed, the previous border color is {1}",M.toString(),this.g3);if(this.JC){if((C.SqmControlId||"").includes("ThemeColorPicker")){var P=this.themesManager.getThemeColor(C.Color);var ka=P.themeIndex;var R=P.aBa;P.returnValue?(this.vRb={},this.dta.ThemeColorIndex=ka,this.dta.ThemeColorRow=
R):this.vRb=null}else this.vRb=null;this.yU.EZa=this.dta}this.g3d=-1803452024===M?a.K4c:C.Color;this.yU.borderColor=this.g3;this.TJe(Q);this.$.hf();l.ULS.sendTraceTag(40944211,0,50,"RibbonCommand:{0} is being executed, the updated border color is {1}",M.toString(),this.g3);return!0};a.prototype.K2h=function(M){l.ULS.sendTraceTag(537159559,0,50,"RibbonPopulateCommand.PopulateBorderStyle command Invoked");var C=this.Va.jq(),Q=this.Va.Bc();C.pc.push(Q);var P=this.Va.lC("StyleDashGallery",1,"Size120by20");
Q.buttons.push(P);Q=a.DZa;for(var ka in Q){var R=ka,fa=Q[ka],ca=A.a.instance.ga(fa.A0b);P.zt(R,-2118943501,"QueryBorderStyle",fa.A0b,R,R,void 0,void 0,ca)}l.ULS.sendTraceTag(537159557,0,50,"RibbonPopulateCommand, Invoke BuildMenuProps");M.MenuItems=C.$D();l.ULS.sendTraceTag(537159556,0,50,"RibbonPopulateCommand handled")};a.prototype.h1h=function(M,C){l.ULS.sendTraceTag(537159555,0,50,"RibbonCommand.BorderStyle: Begin handling, Current Border Style is {0}",this.DHa);M=M[r.a.Nc];if(a.Ini(M))this.h3d=
M,l.ULS.sendTraceTag(537159554,0,50,"RibbonCommand.BorderStyle: Updated Border Style is {0}",this.DHa);else return l.ULS.sendTraceTag(537159553,0,15,"RibbonCommand.BorderStyle: Invalid Border Style encountered, Requested Border Style : {0}",M),!0;this.yU.borderStyle=this.DHa;this.TJe(C);this.$.hf();l.ULS.sendTraceTag(40944220,0,50,"RibbonCommand.BorderStyle: Successfully handled Current Border Style is {0}",this.DHa);return!0};a.prototype.Zgd=function(M){l.ULS.sendTraceTag(537159552,0,50,"HandleDrawBorderCommand : Begin handling, Command being executed: {0}",
M.command.toString());this.LSc(M,64,this.g3,107,1);return!0};a.prototype.$gd=function(M){l.ULS.sendTraceTag(537159523,0,50,"HandleDrawBorderGridCommand : Begin handling, Command being executed: {0}",M.command.toString());this.LSc(M,112,this.g3,108,2);return!0};a.prototype.c4e=function(M){l.ULS.sendTraceTag(537159522,0,50,"HandleEraseBorderCommand : Begin handling, Command being executed: {0}",M.command.toString());this.LSc(M,112,"white",109,3);return!0};a.prototype.O2h=function(M){this.Zpj(this.sOg,
M,M.MenuItemId?M.MenuItemId:a.borderStyleSolidLine)};a.prototype.Zpj=function(M,C,Q){Q in M?(M=M[Q],l.ULS.sendTraceTag(537159521,0,50,"HandleQueryBorderStyleCommand:SetIcon command {0}",Q),this.aqj(C,M)):l.ULS.sendTraceTag(537159520,0,15,"HandleQueryBorderStyleCommand: cannot find dashes '{0}' in BorderLineStyleButtons dictionary",Q)};a.prototype.Z2h=function(M,C){var Q=M[r.a.Nc];return"DrawBorder"===Q?this.Zgd(C):"DrawBorderGrid"===Q?this.$gd(C):"EraseBorder"===Q?this.c4e(C):this.P3e(M,C)};a.prototype.lNf=
function(){this.DQb||this.uPg()};a.prototype.CIh=function(){return new d(this)};a.prototype.uPg=function(){this.DQb={};var M=0,C=a.DZa,Q={},P;for(P in C){Q.yea=C[P];var ka=Q.yea.cte;A.a.instance.ga(Q.yea.A0b);var R=function(fa){return function(){return appChrome.buildBorderStyleIconNew(fa.yea.kFj,fa.yea.width,fa.yea.rEi,fa.yea.lineHeight,fa.yea.Gri)}}(Q);this.DQb[ka]=ka;this.Aab(ka,R);M++;Q={yea:Q.yea}}};a.prototype.Aab=function(M,C){if(!(M in this.uF)){var Q={};C=C();Q[M]=C;appChrome.api.registerIconProvider(function(){return Q});
this.uF[M]=!0}return M};a.prototype.aqj=function(M,C){M.MenuItemId&&(M[n.a.On]=M.MenuItemId===this.DHa,M[f.a.Icon]=C)};a.prototype.LSc=function(M,C,Q,P,ka){l.ULS.sendTraceTag(537159519,0,50,"BorderFormatManager.ActivateDrawBorderBehavior : Starting ActivateDrawBorderBehavior ");this.lWg(M,ka)?(l.ULS.sendTraceTag(537159518,0,50,"BorderFormatManager.CheckDrawBorderBehaviorTriggered : Toggled Ribbon menu button "),this.yU.d0()):(K.g(this.$).gz&&this.yU.d0(),y.a.current&&(P=String.format(v.a.jta,y.a.current.Ro(P)),
K.g(this.$).hg.vo(P)),this.yU.C0b=C,this.yU.borderColor=Q,K.g(this.$).gz=!0,this.yU.Zyg(M),this.yU.Lta=ka)};a.prototype.TJe=function(M){if(M)switch(this.yU.Lta){case 2:this.$gd(M);break;default:this.Zgd(M)}};a.prototype.lWg=function(M,C){return this.yU.Lta===C&&-236759591!==M.command&&-2118943501!==M.command?!0:!1};a.Ini=function(M){return M?M in a.MGf||M in a.DZa:!1};Mf.Object.defineProperties(a.prototype,{DHa:{configurable:!0,enumerable:!0,get:function(){return this.h3d}},g3:{configurable:!0,enumerable:!0,
get:function(){return this.g3d}},dta:{configurable:!0,enumerable:!0,get:function(){return this.vRb}},themesManager:{configurable:!0,enumerable:!0,get:function(){this.Zw||(this.Zw=this.$.da.za(422));return this.Zw}},sOg:{configurable:!0,enumerable:!0,get:function(){this.lNf();return this.DQb}}});Mf.Object.defineProperties(a,{DZa:{configurable:!0,enumerable:!0,get:function(){var M={};return a.t1d||(a.t1d=(M.BorderStyleSolidLine=k.sPg(),M.BorderStyleDashedLine=k.oPg(),M.BorderStyleDottedLine=k.pPg(),
M.BorderStyleMediumLine=k.rPg(),M.BorderStyleThickLine=k.tPg(),M.BorderStyleDoubleLine=k.qPg(),M))}},qOg:{configurable:!0,enumerable:!0,get:function(){var M={};return a.s1d||(a.s1d=(M.NoBorder=0,M.BottomBorder=1,M.TopBorder=2,M.LeftBorder=4,M.RightBorder=8,M.OutsideBorders=64,M.AllBorders=112,M.ThickOutsideBorders=64,M.InsideBorders=48,M.InsideHorizontalBorders=16,M.InsideVerticalBorders=32,M.BottomDoubleBorder=1,M.ThickBottomBorder=1,M.TopBottomBorder=3,M.TopThickBottomBorder=3,M.TopDoubleBottomBorder=
3,M))}},MGf:{configurable:!0,enumerable:!0,get:function(){var M={};return a.Lce||(a.Lce=(M.ThickOutsideBorders=[2,2,2,2],M.BottomDoubleBorder=[1,6,1,1],M.ThickBottomBorder=[1,2,1,1],M.TopBottomBorder=a.$bh,M.TopThickBottomBorder=[1,2,1,1],M.TopDoubleBottomBorder=[1,6,1,1],M))}}});a.s1d=null;a.t1d=null;a.Lce=null;a.K4c="black";a.borderStyleSolidLine="BorderStyleSolidLine";a.$bh=[1,1,1,1];Object(u.a)(a,"BorderFormatManager",null,[742])},1048:function(u,E,b){function a(z,x,D){window.performance.measure(z,
x,D);x=window.performance.getEntriesByName(z);x.length||v.ULS.sendTraceTag(537167063,0,10,"ContextMenuHelper.MeasureTime: measure name [{0}] returned no measures.",z);return x[x.length-1]?x[x.length-1].duration:-1}function c(){if(r.a.Lob){var z=a("OnContextMenuHandling","ContextMenuPerf.A","ContextMenuPerf.B"),x=a("PrepInfraWork","ContextMenuPerf.B","ContextMenuPerf.C1"),D=a("EWAPopulation","ContextMenuPerf.C2","ContextMenuPerf.D");v.ULS.sendTraceTag(537167064,0,50,"ContextMenuHelper.ReportPerformanceIfSupported: OnContextMenuHandling=[{0}], PrepInfraWork=[{1}], EWAPopulation =[{2}]",
z,x,D)}}function d(z,x){B.HelperMethods.RXc&&window.performance.mark(x)}function e(z){z=A.g(z).ha.sa;return z.sg&&(z.Vc.isRow||z.Vc.Te)}function k(z){return z.Ab.d5(z.ha.sa.activeCell)}function l(z,x,D,I,F){z=I.Xj("ContextMenuHelper.FindFirstCellInViewportArea",z,x,D);try{for(z.$$rst();z.$$mn();){var G=z.$$cu();if(G&&n(G,I,F))return G.cell}}finally{z&&z.dispose()}return null}function n(z,x,D){var I=x.rtl,F=D.isChromeRtl;z=z.cell;return(D=A.g(D).LJ(z))?(D=D.topLeft,I=D.x+=I===F?z.offsetWidth:0,F=D.y+=
z.offsetHeight,x.view.visibleArea.contains(new m.a(I,F,0,0))):!1}function f(z,x){var D=z.Ub(null);if((null===D||void 0===D?0:D.cell.sk)&&n(D,z,x))return z.getCellBounds(D.cell);D=z.ha.sa.activeCell;return(x=l(new w.Range(D.top,D.left,y.a.sh,D.left,!1,!1),2,!0,z,x)||l(new w.Range(1,D.left,D.top,D.left,!1,!1),2,!1,z,x)||l(new w.Range(D.top,D.right,D.top,y.a.Bh,!1,!1),1,!0,z,x)||l(new w.Range(D.top,1,D.top,D.right,!1,!1),1,!1,z,x)||null)&&x.sk?z.getCellBounds(x):Sys.UI.DomElement.getBounds(z.K4a.ic)}
b.d(E,"i",function(){return"ContextMenuPerf.A"});b.d(E,"b",function(){return"ContextMenuPerf.B"});b.d(E,"d",function(){return"ContextMenuPerf.C1"});b.d(E,"a",function(){return"ContextMenuPerf.C2"});b.d(E,"c",function(){return"ContextMenuPerf.D"});b.d(E,"e",function(){return f});b.d(E,"f",function(){return k});b.d(E,"g",function(){return e});b.d(E,"h",function(){return d});b.d(E,"j",function(){return c});var v=b(14),r=b(333),y=b(8),m=b(60),w=b(24),B=b(11),A=b(21)},1049:function(u,E,b){function a(){}
b.d(E,"a",function(){return a});u=b(0);a.edit="Edit";a.clipboard="Clipboard";a.copy="Copy";a.color="Color";a.uMg="AutoFill";a.Thj="RowOperations";a.BZg="ColumnOperations";a.DVj="ViewModeRowOperations";a.CVj="ViewModeColumnOperations";a.hyperlink="Hyperlink";a.openHyperlink="OpenHyperlink";a.cuj="ShapeStyle";a.oBh="FloatingObjectClipboard";a.KFf="PivotTableCopyDelete";a.MFf="PivotTableFieldListActions";a.jwe="CellFloatie";a.Ztj="ShapeFloatie";a.contextMenu="ContextMenu";a.r0h="GridContextMenu";a.EXi=
"PivotTableContextMenu";a.pBh="FloatingObjectContextMenu";a.oVg="CellRTEFloatie";a.S_f="ShapeRTEFloatie";Object(u.a)(a,"FloatieGroupIdentifiers",null,[])},1050:function(u,E,b){function a(y,m,w){var B=r.call(this,m)||this;B.XQ=!1;B.tjc=!1;B.eNa=null;B._selectedRowListBox=null;B.Gn=null;B.Dxf=function(A){return B.onItemClick(A)};B.Nzd=function(A){f.g(A.Ca);B.raiseEvent(a.i4a);B.raiseEvent(a.mNd);return!0};B.onScroll=function(A){f.g(A);B.jFd();B.raiseEvent(a.i4a)};B.onBlur=function(A){f.g(A);B.jFd()};
B.onPointerDown=function(){B.jFd();B.raiseEvent(a.i4a);B.raiseEvent(a.aPa);return!1};B.rEb=function(A){var z=A.Ca;if(z.button===Sys.UI.MouseButton.leftButton||z.button===Sys.UI.MouseButton.rightButton||l.EwaSettings.isChangeGateEnabled("OfficeVSO:6154487_EnableTouchInputInDVDropDown")&&z.type.includes("touch"))B.Ok=B.cac(z),B.onPointerDown(A);B.raiseEvent(a.Qqd);return!1};B.jb=y;B.xBb=w;B.MAa(!0);return B}b.d(E,"a",function(){return a});u=b(0);var c=b(89),d=b(233),e=b(13),k=b(245);E=b(244);var l=
b(1),n=b(12),f=b(69),v=b(21),r=E.a;Rk(a,r);a.prototype.D9=function(y){this.get_events().addHandler(a.i4a,y)};a.prototype.eda=function(y){this.get_events().removeHandler(a.i4a,y)};a.prototype.iZb=function(y){this.get_events().addHandler(a.Ajd,y)};a.prototype.hsc=function(y){this.get_events().removeHandler(a.Ajd,y)};a.prototype.gnb=function(y){this.get_events().addHandler(a.mNd,y)};a.prototype.iIb=function(y){this.get_events().removeHandler(a.mNd,y)};a.prototype.enb=function(y){this.get_events().addHandler(a.aPa,
y)};a.prototype.fIb=function(y){this.get_events().removeHandler(a.aPa,y)};a.prototype.tUc=function(y){this.get_events().addHandler(a.Qqd,y)};a.prototype.pId=function(y){this.get_events().removeHandler(a.Qqd,y)};a.prototype.dispose=function(){this.D7(!1);this.MAa(!1);c.a.oc([this.eNa]);this.eNa=null;r.prototype.dispose.call(this)};a.prototype.cac=function(y){return n.DOMElementExtensions.hdd(y.target,"tr",!0)};a.prototype.lB=function(y){if(y){if(!this.Ok){var m=this.Gn;if(!m||!m.rows.length)return;
this.Ok=m.rows[0];0<y?y--:y++}m=this.Ok;for(var w=0,B=Math.abs(y);w<B;w++)if(0>y){if(!m.previousSibling)break;m=m.previousSibling}else{if(!m.nextSibling)break;m=m.nextSibling}m&&(this.Ok=m)}};a.prototype.Mmb=function(y,m){n.DOMElementExtensions.toggleCssClass(y,this.xBb.ListTableClassInTouch,m)};a.prototype.D7=function(y){var m=this.Gn;m&&(y&&!this.tjc?(d.a.instance.ra(e.a.click,m,this.Dxf),d.a.instance.ra(e.a.$j,m,this.Nzd),k.a.instance.ra(e.a.pointerDown,m,this.rEb),this.tjc=!0):this.tjc&&(d.a.instance.Ba(e.a.click,
m,this.Dxf),d.a.instance.Ba(e.a.$j,m,this.Nzd),k.a.instance.Ba(e.a.pointerDown,m,this.rEb),this.tjc=!1))};a.prototype.gBa=function(y){var m=null;y&&(m=n.DOMElementExtensions.zj(y,this.xBb.ListCellClass))&&m.classList.toggle(this.xBb.ListCellSelectedClass);return m};a.prototype.MAa=function(y){this.Pf&&(y&&!this.XQ?(this.eNa=this.je.Sd(this.Pf),this.eNa.ka("scroll",this.onScroll),this.eNa.ka("blur",this.onBlur),k.a.instance.ra(e.a.pointerDown,this.domElement,this.onPointerDown),this.XQ=!0):this.XQ&&
(c.a.Ia(this.eNa),this.eNa=null,k.a.instance.Ba(e.a.pointerDown,this.domElement,this.onPointerDown),this.XQ=!1))};a.prototype.onItemClick=function(y){return this.Nzd(y)};a.prototype.nuc=function(y){if(y){var m=y.offsetTop,w=this.Pf.scrollTop;m<w?this.zVf(!0):m+y.offsetHeight>w+this.Pf.clientHeight&&this.zVf(!1)}};a.prototype.zVf=function(y){this.Pf.scrollTop=y?this.Ok.offsetTop:this.Ok.offsetTop+this.Ok.offsetHeight-this.Pf.clientHeight};a.prototype.jFd=function(){v.g(this.$).isEditing&&this.raiseEvent(a.Ajd)};
Mf.Object.defineProperties(a.prototype,{Ok:{configurable:!0,enumerable:!0,get:function(){return this._selectedRowListBox},set:function(y){this.gBa(this._selectedRowListBox);y?(this._selectedRowListBox=y,this.gBa(this._selectedRowListBox),this.nuc(y)):this._selectedRowListBox=null}},i_:{configurable:!0,enumerable:!0,get:function(){return this.xBb.ListCellClass}},Uba:{configurable:!0,enumerable:!0,get:function(){return this.xBb.ListTableClass}},JH:{configurable:!0,enumerable:!0,get:function(){return 8}},
qCb:{configurable:!0,enumerable:!0,get:function(){return 5}},sjc:{configurable:!0,enumerable:!0,get:function(){return 24}},rjc:{configurable:!0,enumerable:!0,get:function(){return 35}},Pf:{configurable:!0,enumerable:!0,get:function(){return this.domElement}},$:{configurable:!0,enumerable:!0,get:function(){return this.jb}}});a.i4a="GotFocus";a.Ajd="IgnoreBlur";a.mNd="SetCell";a.aPa="PointerDown";a.Qqd="ItemPointerDown";Object(u.a)(a,"ListBox",E.a,[566,3])},1116:function(u,E,b){function a(){}b.d(E,
"a",function(){return a});u=b(0);var c=b(22);a.prototype.compare=function(d,e){return c.a.compare(d,e,!0)};Object(u.a)(a,"IgnoreCaseComparer",null,[594])},1117:function(u,E,b){function a(k,l){this.Ea=k;this.j2a=l}b.d(E,"a",function(){return a});u=b(0);var c=b(24),d=b(11),e=b(206);a.prototype.jKb=function(k,l,n){var f=l.Border;l=l.BorderFormat;var v=0,r=!1;if(0===f)k.cell.Iab(),this.BHb(k.cell.getRange());else{for(var y=0;3>=y;y++)a.nvj(k,n,y,f)&&(v|=d.HelperMethods.g3a(y),this.jXd(k.cell.getRange(),
y,l),r=!0);d.HelperMethods.OQ(f,16)&&!e.c(k,0,n)&&(v|=2,this.jXd(k.cell.getRange(),0,l),r=!0);d.HelperMethods.OQ(f,32)&&!e.c(k,2,n)&&(v|=4,this.jXd(k.cell.getRange(),2,l),r=!0);r&&(n=k.cell.Rt.jf,d.HelperMethods.OQ(v,2)&&this.j1f(k,n,0)&&(v&=-3),d.HelperMethods.OQ(v,1)&&this.i1f(k,n,1)&&(v&=-2),d.HelperMethods.OQ(v,4)&&this.j1f(k,n,2)&&(v&=-5),d.HelperMethods.OQ(v,8)&&this.i1f(k,n,3)&&(v&=-9),k.cell.setBorders(l,v,!1))}};a.prototype.rQ=function(k,l){k=a.rVe(k,l);return k.isValidRange?(k=this.Ea.Eua(k))&&
k.length?k:null:null};a.prototype.BHb=function(k){for(var l=0;3>=l;l++){var n=a.rVe(k,l);if(n.isValidRange&&(n=this.Ea.Eua(n))&&n.length)for(var f=a.w_e(l),v=0;v<n.length;v++)n[v].NPa(f)}};a.prototype.jXd=function(k,l,n){if(k=this.rQ(k,l))for(var f=a.w_e(l),v=d.HelperMethods.g3a(f),r=0;r<k.length;r++){var y=k[r];this.tei(y,f)&&a.setBorders(y,n,v,l,f)}};a.prototype.tei=function(k,l){var n=k.Rt.jf,f=k.getRange();f=this.rQ(f,l);var v=!1,r=!1,y=!1,m=!1;f&&(v=a.e6a(f,!0),r=a.e6a(f,!1),m=a.bod(f),y=1===
f.length?!0:!1);switch(l){case 0:return a.Ldi(k,n,m,r,y);case 1:return a.Idi(k,n,m,v,y);case 2:return a.Jdi(k,n,m,v,y);case 3:return a.Kdi(k,n,m,r,y)}return!1};a.prototype.j1f=function(k,l,n){if(!k.cell.QM)return!1;var f=k.range,v=this.rQ(f,n),r=e.c(k,n,l),y=!1;l=0===n?f.top<l.top:f.left<l.left;!a.ozb(k.cell)&&v&&1!==v.length&&(y=(0===n?a.e6a(v,!0):a.e6a(v,!1))?!1:!0);return!r&&y||l?!0:!1};a.prototype.i1f=function(k,l,n){var f=k.cell,v=this.rQ(f.getRange(),n);k=e.c(k,n,l);l=!1;if(v){var r=a.e6a(v,
!0),y=a.e6a(v,!1),m=r&&!y;y=y&&!r;1!==n||a.mAb(f)?3!==n||a.ezb(f)||a.uvj(f,v,y,m)&&(l=!0):a.tvj(f,v,r,y)&&(l=!0)}return!k&&l||a.ozb(f)?!0:!1};a.nPg=function(k,l,n){var f={};f.LineStyle=Array(4);f.LineStyle[n]=k.LineStyle[l];f.Color=Array(4);f.Color[n]=k.Color[l];return f};a.yaf=function(k,l,n,f,v){return d.HelperMethods.OQ(k,v)&&e.c(l,n,f)};a.nvj=function(k,l,n,f){return a.yaf(f,k,n,l,d.HelperMethods.g3a(n))||a.yaf(f,k,n,l,64)||112===f};a.setBorders=function(k,l,n,f,v){l=a.nPg(l,f,v);k.setBorders(l,
n,!1)};a.rVe=function(k,l){switch(l){case 0:return new c.Range(k.top-1,k.left,k.top-1,k.right,!1,!1);case 2:return new c.Range(k.top,k.left-1,k.bottom,k.left-1,!1,!1);case 1:return new c.Range(k.bottom+1,k.left,k.bottom+1,k.right,!1,!1);case 3:return new c.Range(k.top,k.right+1,k.bottom,k.right+1,!1,!1)}return k};a.w_e=function(k){switch(k){case 0:return 1;case 2:return 3;case 1:return 0;default:return 2}};a.e6a=function(k,l){for(var n=0;n<k.length;n++){var f=k[n];if(f.QM)return l?a.ezb(f):a.mAb(f)}return!1};
a.ozb=function(k){var l=k.Rt.jf,n=k.getRange();return k.QM&&(n.top<l.top||n.bottom>l.bottom||n.left<l.left||n.right>l.right)?!0:!1};a.bod=function(k){for(var l=0;l<k.length;l++)if(a.ozb(k[l]))return!0;return!1};a.tvj=function(k,l,n,f){if(!k.QM){if(!n||a.bod(l))return!0}else if(a.ezb(k)&&(1===l.length&&a.zKg(k,l[0])||!n))return!0;return f};a.uvj=function(k,l,n,f){if(!k.QM){if(!n||a.bod(l))return!0}else if(a.mAb(k)&&(1===l.length&&a.AKg(k,l[0])||!n))return!0;return k.Cka||f};a.Ldi=function(k,l,n,f,
v){var r=k.getRange();return a.ezb(k)?a.ozb(k)||v:l.top===r.top||!f||n};a.Idi=function(k,l,n,f,v){var r=k.getRange();return a.ezb(k)?l.bottom===r.bottom&&v:f&&!n||l.bottom===r.bottom};a.Jdi=function(k,l,n,f,v){var r=k.getRange();return a.mAb(k)?a.ozb(k)||v:l.left===r.left||!f||n};a.Kdi=function(k,l,n,f,v){var r=k.getRange();return k.Cka?!1:a.mAb(k)?l.right===r.right&&v:f&&!n||l.right===r.right};a.ezb=function(k){return 0<k.getRange().right-k.getRange().left};a.mAb=function(k){return 0<k.getRange().bottom-
k.getRange().top};a.AKg=function(k,l){k=k.getRange();l=l.getRange();return k.top===l.top&&k.bottom===l.bottom};a.zKg=function(k,l){k=k.getRange();l=l.getRange();return k.left===l.left&&k.right===l.right};Object(u.a)(a,"BorderModelAccessorHelper",null,[])},1119:function(u,E,b){function a(n,f){var v=l.call(this,f.textBox.domElement)||this;v.OWc=null;v.SFi=function(){v.nyd()};v.vvf=function(r,y){v.Af(r,y)};v.zvf=function(r,y){v.Dh(r,y)};v.jb=n;v.DI=f;f.lY&&(f.lY.add(v),f.Ak(v.zvf),f.tm(v.vvf));return v}
b.d(E,"a",function(){return a});u=b(0);var c=b(89);E=b(94);var d=b(47),e=b(44),k=b(69),l=E.a;Rk(a,l);a.prototype.dispose=function(){var n=this.DI;if(null===n||void 0===n?0:n.lY)n.lY.remove(this),n.vk(this.zvf),n.Nl(this.vvf);c.a.Ia(this.OWc);this.DI=null;l.prototype.dispose.call(this)};a.prototype.Hh=function(n,f){switch(f){case -1470715894:case -1231471547:this.$T(!1);break;default:if(this.NEd(n,f))return k.g(n),!0;a.rji(f)||this.$T(!1)}return!1};a.prototype.$T=function(){c.a.Ia(this.OWc);this.OWc=
d.a.instance.create(this.SFi,10,e.a.Ori)};a.prototype.Dh=function(){this.$T(!1)};a.rji=function(n){switch(n){case 137938150:case -798660877:case 742457698:case 2091832999:return!0}return!1};Mf.Object.defineProperties(a.prototype,{$:{configurable:!0,enumerable:!0,get:function(){return this.jb}},Ya:{configurable:!0,enumerable:!0,get:function(){return this.DI}}});Object(u.a)(a,"ListAutoCompleteBehavior",E.a,[559,3])},1281:function(u,E,b){function a(){c.a.ti('.ewa-ac{position:absolute;z-index:102;margin-top:1px;width:auto}.ewa-ac .ewa-ac-param{white-space:nowrap;margin-bottom:3px;direction:ltr}.ewa-ac .ewa-ac-param function_param_table{position:absolute}.ewa-ac .ewa-ac-param .ewa-function-help-link{text-decoration:underline}.ewa-lb{position:absolute;border:1px solid #a2a6ab;overflow-x:hidden;overflow-y:auto;cursor:default;background-color:#fff;color:#262626;font-size:12px;font-family:"Segoe UI";z-index:102;height:auto;margin:0 8px;touch-action:manipulation;vertical-align:middle}.ewa-lb.ewa-fb-refactor{position:relative;margin:0}.ewa-lb table{left:0;right:0;border-collapse:collapse}.ewa-lb table td{white-space:nowrap}.ewa-lb table td div.clip16x16{margin:0 0 0 2px}.ewa-lb table td.list-item{height:24px;padding:0 8px}.ewa-lb table td.list-item-selected{background-color:#d3f0e0}@media screen and (-ms-high-contrast:active){.ewa-lb table td.list-item-selected{border:2px solid #fff}}.ewa-lb table.list-table-touch td.list-item{height:35px}div#suggested_cells_list_box{margin:0}div#suggested_cells_list_box .list-table .ewa-suggested-cell-name{float:left;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}@font-face{font-family:"Segoe UI Semibold";font-weight:600;src:local("Segoe UI Semibold"),local("Segoe UI")}.ewa-lb table td.columnName-header{color:#666;font-size:12px;font-family:"Segoe UI Semibold";text-align:left;padding:3px 8px;text-overflow:ellipsis}.ewa-tt{background-color:#f7f7f7;border:1px solid #a2a6ab;color:#444;height:auto;vertical-align:middle;width:auto;z-index:102;font-size:8pt;margin:0;padding-bottom:3px;padding-top:2px}.ewa-root-ltr .ewa-tt{text-align:left;padding-left:5px;padding-right:7px}.ewa-root-rtl .ewa-tt{text-align:right;padding-left:7px;padding-right:5px}.ewa-dlg-function-link-container .ewa-fdb-help-link,.ewa-tt-rtl .ewa-fdb-help-link,.ewa-tt-ltr .ewa-fdb-help-link{color:#00f;text-decoration:underline}.ewa-function-link-container .ewa-function-udf-name,.ewa-function-link-container-udf .ewa-function-help-link{display:none}.ewa-root.rtl .ewa-function-link-container{text-align:left}')}
b.d(E,"a",function(){return a});var c=b(559)},1282:function(u,E,b){function a(c,d){this.command=0;this.selectedRanges=null;this.command=c;this.selectedRanges=d}b.d(E,"a",function(){return a});u=b(0);a.prototype.Qt=function(){return this.command};Object(u.a)(a,"MacroRecorderRangeOperationAppliedPayload",null,[438])},1283:function(u,E,b){function a(){c.a.ti(".TabsContainer{width:100%}.TabTitlesContainer{width:100%;display:table;table-layout:fixed;padding:0}.TabTitlesContainer>.TabTitle{display:table-cell;text-align:center}.TabTitlesContainer>.TabTitle:hover:not(.TabTitleActive){font-weight:bold}.TabTitleText{text-decoration:none}div#dataFieldCustomLabel,div#dataFieldSourceLabel{font-weight:600;padding-left:10px}div#summarizeValuesByControlBody{background-color:#fff;padding:10px}.valueFielsSettingsControlTitle{font-weight:bold;border-bottom:1px solid #a2a6ab}div#summarizeValuesByControlBody>.summarizeValuesByControlDescription{font-weight:600}div#summarizeValuesByControlBody>select{width:100%}div#showValueAsControlBody{background-color:#fff;padding:10px}select#showValueAsSelect{width:100%;margin-bottom:5px}select#showValueAsBaseFieldSelect{width:100%}select#showValueAsBaseItemSelect{width:100%;overflow:hidden}div#showValueAsControlBody>.showValueAsControlSelectRegion{width:48%;display:inline-block;position:relative}div#showValueAsControlBody>.showValueAsControlSelectRegionSeparator{width:4%;display:inline-block}.showValueAsControlSelectRegion>div{width:100%}input#valueFieldsSettingsFieldName{width:273px}div#valueFieldSettingTabs{width:380px}")}
b.d(E,"a",function(){return a});var c=b(559)},1284:function(u,E,b){b.d(E,"a",function(){return"FieldInfoListContextLoaded"});b.d(E,"k",function(){return"GetFieldInfoListContextOperationFailed"});b.d(E,"f",function(){return"Days from Today"});b.d(E,"i",function(){return"Total Weekdays from Today"});b.d(E,"j",function(){return"Years from Today"});b.d(E,"e",function(){return"Day of the Week"});b.d(E,"h",function(){return"Month of the Year"});b.d(E,"g",function(){return"End of Month"});b.d(E,"c",function(){return"Next Month"});
b.d(E,"d",function(){return"Next Week"});b.d(E,"b",function(){return"Next Day"})},1285:function(u,E,b){function a(){c.a.ti(".ewa-dv{position:relative;z-index:100;width:auto}.ewa-dv-buttonarea{position:absolute;border:0;padding:1;z-index:100;margin:0;overflow:hidden;width:auto;height:auto}.ewa-dv-listbutton{margin:0;cursor:pointer}.ewa-dv-listbutton span.clip17x17{display:inline-block;margin:0}.ewa-dlb{position:absolute;border:1px solid #a2a6ab;overflow-x:hidden;overflow-y:auto;cursor:default;background-color:#fff;color:#444;font-size:11px;z-index:100;height:auto;margin:0}.ewa-dlb table{left:0;right:0;border-collapse:collapse;empty-cells:show}.ewa-dlb table td{white-space:nowrap;padding:0 2px 0 2px}.ewa-dlb table.list-table td.list-item{height:24px}.ewa-dlb table.list-table td.list-item-selected{height:24px;background-color:#d3f0e0;color:#444}.ewa-dlb table.list-table-touch td.list-item{height:35px}.ewa-dlb table.list-table-touch td.list-item-selected{height:35px;background-color:#d3f0e0;color:#444}@media screen and (-ms-high-contrast:active){.ewa-dlb table.list-table td.list-item-selected{background-color:highlight;-ms-high-contrast-adjust:none;color:highlighttext}}.ewa-dpb{position:absolute;border:1px solid #a2a6ab;cursor:default;background-color:#fff;color:#444;font-size:11px;z-index:99;margin:0;max-width:230px}.ewa-dpb p{padding:0 2px 0 2px;margin:0;border-collapse:collapse;width:230px}.ewa-dv-ltr .ewa-dpb p{text-align:left}.ewa-dv-rtl .ewa-dpb p{text-align:right}.ewa-dpb p.dv-prompt-title{font-weight:bold}.ewa-dpb p.dv-prompt-message{word-wrap:break-word;overflow:hidden}")}
b.d(E,"a",function(){return a});var c=b(559)},1286:function(u,E,b){function a(){c.a.ti(".DataValidationDialogPanel{min-width:0}.DataValidationDialogPanel .TabTitlesContainer{width:300px}.DataValidationDialogPanel div#WACDialogBodyPanel{height:312px}.TabTitlesContainer{border-bottom:solid 1px #c3cbd0}.TabTitle{text-align:center;cursor:default}.TabTitleText{display:inline-block}.TabTitleActive{color:#217346;font-weight:bold}.TabTitleActive>.TabTitleText{padding-bottom:10px;border-bottom:solid 4px}.DataValidationEditTabContent{padding-top:7px}.DataValidationButtonPanel{float:none}.AppRtl .DataValidationButtonPanel{float:none}.DataValidationButtonClearAll{float:left;margin-left:0;margin-right:10px}.AppRtl .DataValidationButtonClearAll{float:right;margin-left:10px;margin-right:0}.DataValidationRow{margin-bottom:10px;display:table}.DataValidationNonBorderRow{margin-bottom:8px;display:table}.DataValidationEditElementLabel{width:95px;display:inline-block;margin-top:4px;margin-bottom:4px;vertical-align:top}.DataValidationEditElement{display:inline-block;margin-top:0;margin-bottom:0;padding:1px;font-size:9pt;font:inherit;border:solid 1px #c3cbd0}.DataValidationEditNoBorderElement{display:inline-block;margin-top:0;margin-bottom:0;font-size:9pt;font:inherit;width:210px;height:22px}.DataValidationEditSelect{width:calc(210px + 4px);height:calc(22px + 4px);padding:0;color:#000}.DataValidationEditSelect:disabled{color:graytext}.DataValidationEditSelectFocus:focus{outline:-webkit-focus-ring-color auto 5px !important}.DataValidationEditInput{width:210px;height:22px}.DataValidationEditTextArea{width:210px;height:50px;resize:none;overflow-y:auto;overflow-x:hidden}.DataValidationEditErrorMessage{margin-bottom:-15px;margin-top:-6px;font-size:9pt;color:#d90000;width:300px;height:65px}.DataValidationEditCheckBoxWithText{margin-top:0;margin-bottom:0;display:inline-block}.DataValidationEditCheckBoxNoText{margin-top:6px;margin-bottom:0;display:inline-block}.DataValidationEditRadio{margin-top:0;margin-bottom:0}.DataValidationEditLabel{margin-top:5px;margin-bottom:0;display:inline-block}div#listDescriptionSubDivID{height:37px;width:210px}label#listDescriptionLabelId{font-size:8pt;margin-top:0}div#ignoreBlankCheckboxDivID{margin-bottom:8px}")}
b.d(E,"a",function(){return a});var c=b(559)},1288:function(u,E,b){function a(){c.a.ti(".ewa-facp-text-box{position:absolute}")}b.d(E,"a",function(){return a});var c=b(559)},1289:function(u,E,b){b.d(E,"b",function(){return"MinorThemeFont"});b.d(E,"a",function(){return"MajorThemeFont"})},1291:function(u,E,b){function a(){c.a.ti('.ewa-sharedUi-launchButton,.ewa-sharedUi-launchButtonWithText{cursor:pointer;position:absolute;overflow:hidden;z-index:96;border:1px solid #abafb2;background-color:#fff;padding:2px;cursor:default;width:fit-content}.ewa-sharedUi-launchButton:hover{background-color:#c6c6c6}.ewa-sharedUi-launchButtonClick,.ewa-sharedUi-launchButton:active,.ewa-sharedUi-launchButtonWithTextClick{cursor:pointer;position:absolute;overflow:hidden;z-index:96;border:1px solid #abafb2;background-color:#b1b1b1;padding:1px;cursor:default;width:fit-content}@media(forced-colors:active){.ewa-sharedUi-launchButtonClick,.ewa-sharedUi-launchButton:active,.ewa-sharedUi-launchButtonWithTextClick{background-color:Highlight;color:HighlightText;border-color:CanvasText;forced-color-adjust:none}.ewa-sharedUi-launchButtonClick svg>path.OfficeIconColors_HighContrast,.ewa-sharedUi-launchButton:active svg>path.OfficeIconColors_HighContrast,.ewa-sharedUi-launchButtonWithTextClick svg>path.OfficeIconColors_HighContrast{fill:HighlightText}}.ewa-sharedUi-launchButtonWithText .clip16x16,.ewa-sharedUi-launchButtonWithTextClick .clip16x16{float:left}.ewa-sharedUi-launchButton input{cursor:default}.ewa-sharedUi-launchButton .clip16x16,.ewa-sharedUi-launchButtonClick .clip16x16{padding:0}.ewa-sharedUi-launchButtonText{font-family:"Segoe UI",Tahoma,Thonburi,Arial,Verdana,sans-serif;font-size:10pt;overflow:hidden;padding-left:2px;cursor:pointer}')}
b.d(E,"a",function(){return a});var c=b(559)},1292:function(u,E,b){function a(r){var y=v.call(this,document.createElement("div"))||this;y.gIa=!1;y.hIa=!1;y.fIa=!1;y.dIa=!1;y.eIa=!1;y.XQ=!1;y.DI=null;y.visible=void 0;y.Pmc=function(m,w){y.Xs(m,w)};y.cLa=function(){y.Ya.textBox.UJ=!0};y.uya=function(){y.Hy(!0)};y.ctf=function(){y.Ya.textBox.focus()};y.Ch=function(){l.g(y.$).inRangePicker||(y.isListVisible=!1)};y.$=r;l.g(r)&&l.g(r).ha&&l.g(y.$).ha.hJ(y.Ch);y.Ck=d.a.I4();y.R5a=e.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FixKeydownLayoutTrashingBottleneck",
!1);return y}b.d(E,"a",function(){return a});u=b(0);E=b(244);var c=b(5),d=b(36),e=b(1),k=b(11),l=b(21),n=b(33),f=b(4),v=E.a;Rk(a,v);a.prototype.get_visible=function(){return this.R5a?void 0!==this.visible?this.visible:this.visible=v.prototype.get_visible.call(this):v.prototype.get_visible.call(this)};a.prototype.set_visible=function(r){if(!this.R5a)return v.prototype.set_visible.call(this,r);if(this.visible===r)return r;this.visible=r;return v.prototype.set_visible.call(this,r)};a.prototype.Xs=function(){this.vBa(!1);
this.Ft.Xs()};a.prototype.dispose=function(){this.$&&l.g(this.$)&&l.g(this.$).ha&&l.g(this.$).ha.PN(this.Ch);this.$=null;v.prototype.dispose.call(this)};a.prototype.Hh=function(r,y,m){r=!1;if((this.w0a||(void 0===m?0:m))&&!this.zwa()&&this.get_visible()&&this.isListVisible)switch(this.Ck&&this.LAc(y),y){case 1872288872:this.isListVisible=!1;r=!0;break;case -798660877:this.Ft.lB(1);r=!0;break;case 137938150:this.Ft.lB(-1);r=!0;break;case 2091832999:this.Ft.lB(this.JH-1);r=!0;break;case 742457698:this.Ft.lB(-(this.JH-
1));r=!0;break;case 125627505:r=this.Hy(!1);break;case 267796030:d.a.I4()&&(r=this.Hy(!1))}return r};a.prototype.vBa=function(r){if(this.isListVisible||r){var y=l.g(this.$);r=y.domElement;var m=this.DI.textBox.domElement,w=n.a(this.$).hi(m.offsetHeight),B=n.a(this.$).hi(m.offsetTop),A=n.a(this.$).hi(m.offsetWidth);m=n.a(this.$).hi(m.offsetLeft);y=y.pj;var z=f.AFrameworkApplication.ta&&f.AFrameworkApplication.ta.Qa.Of,x=$get(this.$.yb+c.a.A_a,this.$.domElement);z&&(x=document.getElementById("EditorContainer"));
var D=new Sys.UI.Point(y?this.Ft.i$b:0,y?this.YCh:a.O0h);w=x.offsetTop+D.y+(d.a.RM(this.$)&&y?0:w+B);this.$.sba||(B=$get(c.a.$Fa,this.$.domElement),w+=B&&!z?B.offsetHeight:0);B=this.domElement;B.style.top=k.HelperMethods.jc(w);m=x.offsetLeft+m+D.x;!d.a.RM(this.$)&&this.$.isChromeRtl?B.style.right=k.HelperMethods.jc(y?this.Ft.i$b:r.offsetLeft+r.offsetWidth-m-A):B.style.left=k.HelperMethods.jc(m)}};a.prototype.pSa=function(r){this.Ft&&(r&&!this.XQ?(this.Ft.D9(this.ctf),this.Ft.iZb(this.cLa),this.Ft.gnb(this.uya),
this.XQ=!0):this.XQ&&(this.Ft.eda(this.ctf),this.Ft.hsc(this.cLa),this.Ft.iIb(this.uya),this.XQ=!1))};a.prototype.LAc=function(r){switch(r){case -798660877:case 137938150:case 2091832999:case 742457698:this.gIa=!0;break;case 125627505:this.fIa=!0;break;case 267796030:d.a.I4()&&(this.dIa=!0)}};Mf.Object.defineProperties(a.prototype,{JH:{configurable:!0,enumerable:!0,get:function(){return this.Ft.JH}},isListVisible:{configurable:!0,enumerable:!0,get:function(){return this.Ft.isListVisible},set:function(r){this.Ft.isListVisible=
r}},Ya:{configurable:!0,enumerable:!0,get:function(){return this.DI},set:function(r){(this.DI=r)&&this.DI.nZd.add(this)}},YCh:{configurable:!0,enumerable:!0,get:function(){return d.a.RM(this.$)?-5:-40}}});a.i$b=0;a.O0h=1;Object(u.a)(a,"AutoCompleteControl",E.a,[522])},1293:function(u,E,b){function a(d,e,k,l){e=void 0===e?0:e;k=void 0===k?"":k;l=void 0===l?"":l;var n=c.call(this)||this;n.length=d;n.selectedIndex=e;n.JF=k;n.description=l;return n}b.d(E,"a",function(){return a});u=b(0);var c=Sys.EventArgs;
Rk(a,c);Object(u.a)(a,"ListEventArgs",Sys.EventArgs,[])},1294:function(u,E,b){function a(B,A){B=w.call(this,B,A,new m.a(e.a.listItem,e.a.yBb,e.a.BBb,e.a.CBb))||this;B.Ecc=!1;B.mq=null;B.glb=null;B.XTe=!1;B.visible=void 0;B.MAa(!0);B.XTe=v.EwaSettings.isChangeGateEnabled("OfficeVSO:5893822_FixFormulaBarXOffsetCrash");B.R5a=v.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FixKeydownLayoutTrashingBottleneck",!1);return B}b.d(E,"a",function(){return a});u=b(0);var c=b(14),d=b(27);E=b(1050);
var e=b(986),k=b(5),l=b(76),n=b(36),f=b(12),v=b(1),r=b(117),y=b(21),m=b(1118),w=E.a;Rk(a,w);a.prototype.Oxa=function(){var B=460,A=y.g(this.$),z=A.domElement,x=this.NSa.style,D=this.Pf.offsetTop+this.Ok.offsetHeight*this.Ok.sectionRowIndex-this.Pf.scrollTop;x.width="auto";x.whiteSpace="nowrap";x.position="absolute";var I=z.offsetLeft+z.offsetWidth-(this.domElement.offsetLeft+this.Pf.offsetLeft+this.Pf.offsetWidth+3);z=this.domElement.offsetLeft-3-(z.offsetLeft+this.i$b);B=Math.min(this.NSa.offsetWidth,
B,Math.max(I,z));f.DOMElementExtensions.rv(this.NSa,B);x.whiteSpace="";x.position="absolute";D+3>this.Pf.offsetTop+this.Pf.offsetHeight||D<this.Pf.offsetTop||(B=this.Pf.offsetLeft-3-this.NSa.offsetWidth,x=this.Pf.offsetLeft+this.Pf.offsetWidth+3,f.DOMElementExtensions.updatePosition(this.NSa,z>I!==A.rtl?B:x,D,!1))};a.prototype.lB=function(B){w.prototype.lB.call(this,B);this.Oxa()};a.prototype.Xs=function(){this.Oxa()};a.prototype.Gra=function(){var B=this.Gn,A=this.Pf,z=3===l.a.Cb||d.a.Wo,x=z?this.qCb:
this.JH;this.isListVisible=!0;A.style.height="auto";this.hGa.set_visible(!0);this.Mmb(B,z);this.mq.length>x?(f.DOMElementExtensions.vI(A,Math.floor(A.offsetHeight*x/this.mq.length)),A.style.overflowY="auto"):v.EwaSettings.wzb()||(A.style.height="auto",A.style.overflowY="hidden");f.DOMElementExtensions.rv(A,B.offsetWidth+(this.mq.length>x?r.a.ev:0))};Mf.Object.defineProperties(a.prototype,{i$b:{configurable:!0,enumerable:!0,get:function(){if(n.a.RM(this.$)){var B=document.getElementById(this.$.yb+
k.a.WTe);return!this.XTe||B?f.DOMElementExtensions.getBoundingClientRect(B).x:0}B=v.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AddNamedRange",!1)?document.getElementById(k.a.iwd):document.getElementById(this.$.yb+k.a.iwd+"-"+k.a.$pf);c.ULS.shipAssertTag(537170323,0,!!B||this.$.TM,"AutoCompleteListBox.FormulaBarXOffset : Can't find the name box combobox element.");return B?B.offsetWidth:0}},fe:{configurable:!0,enumerable:!0,get:function(){return this.glb},set:function(B){this.glb=B}},
isListVisible:{configurable:!0,enumerable:!0,get:function(){return this.R5a?void 0!==this.visible?this.visible&&0<this.mq.length:(this.visible=f.DOMElementExtensions.isVisible(this.Pf))&&0<this.mq.length:f.DOMElementExtensions.isVisible(this.Pf)&&0<this.mq.length},set:function(B){this.R5a&&this.visible===B||(f.DOMElementExtensions.setVisible(this.Pf,B),f.DOMElementExtensions.setVisible(this.NSa,B),this.R5a&&(this.visible=B));var A=y.g(this.$).view;B?this.Ecc||(A.Es(this.hGa.Pmc),this.Ecc=!0):(Array.clear(this.mq),
this.Ecc&&(A.Fq(this.hGa.Pmc),this.Ecc=!1))}}});Object(u.a)(a,"AutoCompleteListBox",E.a,[])},1295:function(u,E,b){function a(m,w,B,A,z,x,D,I,F,G){var T=y.call(this,document.createElement("a"))||this;T.ul=!1;T.$c=function(O){T.raiseEvent("ClickButton",O);return!0};T.onKeyDown=function(O){T.raiseEvent("KeyDown",O);return!1};T.ow=function(){T.hovered=!0;T.raiseEvent("PointerOver");return!1};T.uN=function(){T.hovered=!1;T.raiseEvent("PointerOut");return!1};T.onBlur=function(O){r.g(O);T.focused=!1;T.raiseEvent("Blur")};
T.onFocus=function(O){r.g(O);T.focused=!0;T.raiseEvent("Focus")};T.Ujh=I;T.dfh=F;T.MI=a.nb(T.domElement,w,B,A,z,x,D,G);T.Ac.ka("contextmenu",function(O){r.g(O)});T.enable();T.hovered=!1;T.focused=!1;m.appendChild(T.domElement);return T}b.d(E,"a",function(){return a});u=b(0);var c=b(233),d=b(13),e=b(109),k=b(245);E=b(244);var l=b(618),n=b(5),f=b(53),v=b(12),r=b(69),y=E.a;Rk(a,y);a.prototype.jUc=function(m){this.get_events().addHandler("ClickButton",m)};a.prototype.cId=function(m){this.get_events().removeHandler("ClickButton",
m)};a.prototype.vUc=function(m){this.get_events().addHandler("KeyDown",m)};a.prototype.qId=function(m){this.get_events().removeHandler("KeyDown",m)};a.prototype.wZb=function(m){this.get_events().addHandler("PointerOver",m)};a.prototype.BId=function(m){this.get_events().removeHandler("PointerOver",m)};a.prototype.vZb=function(m){this.get_events().addHandler("PointerOut",m)};a.prototype.AId=function(m){this.get_events().removeHandler("PointerOut",m)};a.prototype.Smb=function(m){this.get_events().addHandler("Blur",
m)};a.prototype.SHb=function(m){this.get_events().removeHandler("Blur",m)};a.prototype.D9=function(m){this.get_events().addHandler("Focus",m)};a.prototype.eda=function(m){this.get_events().removeHandler("Focus",m)};a.prototype.enable=function(){this.domElement&&(this.domElement.classList.remove(l.a.jU),this.domElement.style.cursor="",c.a.instance.ra(d.a.click,this.domElement,this.$c),e.KeyInputManager.instance.ra(d.a.Lb,this.domElement,this.onKeyDown),k.a.instance.ra(d.a.pointerOver,this.domElement,
this.ow),k.a.instance.ra(d.a.pointerOut,this.domElement,this.uN),this.Ac.Ym("blur")||this.Ac.ka("blur",this.onBlur),this.Ac.Ym("focus")||this.Ac.ka("focus",this.onFocus),this.domElement.title=this.Ujh,this.ul=!0)};a.prototype.disable=function(){this.domElement&&(this.domElement.classList.add(l.a.jU),this.domElement.style.cursor="",this.isEnabled&&(c.a.instance.Ba(d.a.click,this.domElement,this.$c),e.KeyInputManager.instance.Ba(d.a.Lb,this.domElement,this.onKeyDown),k.a.instance.Ba(d.a.pointerOver,
this.domElement,this.ow),k.a.instance.Ba(d.a.pointerOut,this.domElement,this.uN)),this.domElement.title=this.dfh,this.ul=!1)};a.prototype.dispose=function(){this.isEnabled&&(c.a.instance.Ba(d.a.click,this.domElement,this.$c),e.KeyInputManager.instance.Ba(d.a.Lb,this.domElement,this.onKeyDown),k.a.instance.Ba(d.a.pointerOver,this.domElement,this.ow),k.a.instance.Ba(d.a.pointerOut,this.domElement,this.uN),this.ul=!1);v.DOMElementExtensions.setVisible(this.domElement,!1);y.prototype.dispose.call(this)};
a.nb=function(m,w,B,A,z,x,D,I){m.removeAttribute("Href");m.setAttribute(n.a.Hd,n.a.Fs);m.className=w;m.tabIndex=I;w=document.createElement("span");w.className=D;w.classList.add(B);w.tabIndex=-1;m.appendChild(w);m=document.createElement("img");m.src=f.a.Se(A);m.className=z;m.alt=x;m.tabIndex=-1;w.appendChild(m);return m};Mf.Object.defineProperties(a.prototype,{ol:{configurable:!0,enumerable:!0,get:function(){return this.MI}},isEnabled:{configurable:!0,enumerable:!0,get:function(){return this.ul}}});
Object(u.a)(a,"ListButton",E.a,[538,3])},1336:function(u,E,b){function a(){m.initData();Ec.a.Fa(function(gb){r.ka(gb);c.ka(gb);m.ka(gb);d.ka(gb)})}function c(gb){var Bb=dc.call(this)||this;Bb.$=gb;Bb.Eb();return Bb}function d(gb,Bb,qc){var Nc=this;this.Bxc={};this.Bd=!1;this.Il=function(nd,Vd){Nc.showContextMenu(void 0===Vd?null:Vd)};this.Huf=function(nd,Vd){Vd.xzi===d.s0h&&Za.g(Nc.$).focus()};this.hR=function(nd,Vd){nd=Nc.$.Ka.Faa(Vd.Ed.command);(null===nd||void 0===nd?0:nd.dismissesContextualUI)&&
Nc.q3()};this.Z5=function(){Nc.$.da.tU(342);Z.TaskExtensions.Aa(ya.GetServiceTaskFactory.create(Nc.$.da,338,Nc.$.la,3),function(nd){nd=nd.result;for(var Vd=bk(Nc.Bxc),oe=Vd.next();!oe.done;oe=Vd.next())oe.value.VMf(nd)},Nc.$.la)};this.$=gb;this.contextMenuController=qc;this.o5d=new e(this.$);gb.da.Ga(8,this);for(qc=0;qc<Bb.length;qc++)this.Bxc[d.S1g[qc]]=Bb[qc];this.ha=Za.g(gb).ha;this.ha.$Yb(this.Il);this.$.Ka.rYa(this.Huf);Ja.a.instance.qsj();Kb.EwaSettings.isChangeGateEnabled("OfficeVSO:4728637_DissmissContextualUIFromContextMenuManager")&&
this.$.Ka.xFa(this.hR);Kb.EwaSettings.isChangeGateEnabled("OfficeVSO:4932179_RemoveControllerRecreationOnModeSwitch")||this.$.ea.o2(this.Z5)}function e(gb){this.MRe=null;this.$=gb;this.n8a=new n;Kb.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")&&Kb.EwaSettings.isChangeGateEnabled("OfficeVSO:5035623_autofiltersHitTest")||(this.MRe=new k(this.$))}function k(gb){var Bb=this;this.pZa=null;this.iQd=!1;this.pBb=0;this.a8c=1;this.vLe=0;this.nEb=function(qc){Bb.uJf(qc.domElement,qc.hashCode)};
this.kNf=function(qc){for(var Nc=0;window.performance.now()-qc<Bb.Mlh&&0<Bb.pZa.length;)Bb.Yke(Bb.pZa.shift()),Nc++;V.ULS.sendTraceTag(537167052,1,50,"FilterMenuManager.RegisterQueuedAutoFilterEventHandler: Batch number: {0}, Events Registered in this frame: {1}, Events in queue: {2}",Bb.a8c,Nc,Bb.pZa.length);0<Bb.pZa.length?Bb.pBb=window.requestAnimationFrame(Bb.kNf):(V.ULS.sendTraceTag(537167051,1,50,"FilterMenuManager.RegisterQueuedAutoFilterEventHandler: Finished batch number: {0}, Total time in MS: {1}",
Bb.a8c,window.performance.now()-Bb.vLe),Bb.a8c++,Bb.pBb=0)};this.onPointerDown=function(qc){bc.a.slim(qc.Ca.rawEvent);return!1};this.$=gb;this.gridView=Za.g(this.$);this.E8h();this.Mlh=this.$.ya.AutoFilterEventRegistrationTimeLimit}function l(){this.Kd=this.Zre=this.cell=null}function n(){this.ndc={}}function f(){this.menuModel=null;this.lEe=0}function v(){this.dictionary=this.Ed=null}function r(gb){var Bb=gf.call(this)||this;Bb.f9e=!1;Bb.rkd=function(){var qc;(qc=Bb.$.da.za(342))?Bb.pb(qc):Bb.$.bB(function(Nc){Nc.pec().then(function(nd){(qc=
Bb.$.da.za(342))?Bb.pb(qc):(qc=new y(Bb.$,nd),Bb.pb(Bb.$.da.Ga(342,qc)))})})};Bb.$=gb;Bb.Eb();return Bb}function y(gb,Bb){this.Gqb=Bb;this.$=gb}function m(gb){return ud.call(this,gb)||this}function w(gb,Bb,qc,Nc){gb=Ub.call(this,gb,"PopulateTimeSlicerLevelMenu",-227942804,1634477200,w.GIj,!0,!1,w.YIb,Bb,qc,!1,Nc)||this;gb.A0a=0;gb.tsa=null;gb.WJa=null;gb.cJe=null;return gb}function B(gb,Bb,qc){this.type=gb;this.N1g=Bb;this.mr=qc}function A(gb,Bb,qc,Nc){return lb.call(this,gb,"PopulateSlicerContextMenu",
-1920954846,723126814,"SlicerContextMenu",!0,!1,"SlicerContextMenuRootName",Bb,qc,!0,Nc)||this}function z(gb,Bb,qc,Nc){gb=Ya.call(this,gb,"PopulateSheetOpsContextMenu",274207288,-1497523576,we,!0,!1,"SheetTabContextMenuRootName",Bb,qc,!1,Nc)||this;gb.lgc=!1;gb.Nhc=!1;return gb}function x(gb,Bb,qc,Nc){Bb=nf.call(this,gb,"PopulateRichTextContextMenu",679816325,1151222423,lf,!0,!1,lf,Bb,qc,!0,Nc)||this;Bb.grid=Za.g(gb);return Bb}function D(gb,Bb,qc,Nc){Bb=Ke.call(this,gb,"PopulateTableFieldListContextMenu",
-751848458,-1085236154,je,!0,!1,"TableFieldListContextMenuRoot",Bb,qc,!1,Nc)||this;Bb.Z4b=null;Bb.Exd=0;Bb.qEa=null;Bb.grid=Za.g(gb);return Bb}function I(){}function F(gb,Bb,qc,Nc){var nd=Pc.call(this,gb,"PopulatePivotTableContextMenu",-1475408662,1114549926,Jc,!0,!1,"PivotTableContextMenuRootName",Bb,qc,!0,Nc)||this;nd.rc=null;nd.activeCell=null;nd.EZd=null;nd.Xhc=!1;nd.cnd=!1;nd.expandCollapse=!1;nd.refresh=!1;nd.$Y=!1;nd.De=null;nd.Qz=null;nd.d0a=null;nd.rb=null;nd.H$a=null;nd.yba=!1;nd.nLi=function(Vd){Vd&&
!Qa.a.Qg(Vd.Errors)&&nd.rc&&(nd.rc.Fo=Vd.Result,nd.nKb());nd.showPivotTableContextMenu()};nd.mLi=function(){};nd.YOi=function(){nd.pbb()};nd.XOi=function(){nd.pbb()};nd.RFi=function(){nd.pbb()};nd.QFi=function(){nd.pbb()};nd.Yx=function(){nd.$Wd();nd.yba=!1};nd.Aq=function(){if(nd.yba){V.ULS.sendTraceTag(537167E3,0,50,"PivotTableContextMenu.OnAfterAllBlocksUpdated: Context menu was closed after changes were made by other users");var Vd=nd.rc;nd.grid.Ab.Qo(nd.grid.ha.sa.activeCell)!==Vd&&(nd.pbb(),
nd.K5h())}};nd.chh=new DOMParser;nd.xvj=!0;nd.grid=Za.g(gb);nd.Dkc=!0;return nd}function G(gb,Bb,qc,Nc){return ka.call(this,gb,"PopulatePivotContextMenu",2123758504,912277356,Bb,qc,Nc)||this}function T(gb,Bb,qc,Nc){gb=Tb.call(this,gb,"PopulateFieldWellContextMenu",1374696078,495005930,td,!0,!1,td,Bb,qc,!1,Nc)||this;gb.cell=null;gb.co=null;gb.ro=null;gb.externalSourceIndex=-1;gb.$Zd=-1;gb.aSa=0;gb.Nxc=-1;gb.kL=null;gb.isOlap=!1;gb.qV=!1;gb.m2a=!1;return gb}function O(gb,Bb,qc,Nc,nd,Vd,oe,qe,ee){var re=
Tc.call(this,nd,ub.a.instance.mb(61),!0,2,!0)||this;re.O1f=!0;re.$he=null;re.QRa=null;re.Afa=null;re.Jrb=null;re.n4c=null;re.XQc=null;re.LFi=function(Ze){Yd.a.any(Ze.Errors,function(mf){return-103190598===mf.MessageId})&&re.tSa.Agj()};re.XLi=function(Ze){Ze&&!Db.a(Ze)&&(Ze=Ze.Result,re.n4c.innerHTML=ub.a.instance.ga(1078)+pe.a.zg(Ze.ValueFieldSourceName),re.isOlap&&!re.qV?(re.tSa.enabled=!1,re.Afa.activeTab=re.Afa.Myc-1):(re.tSa.enabled=!0,re.Afa.activeTab=0),re.tSa.jrj(Ze.PivotValueFieldSettingsSummarizeValueByInfo),
re.QRa.krj(Ze.PivotValueFieldShowValueAsInitialInfo),re.gf())};re.cell=gb;re.ro=Bb;re.externalSourceIndex=qc;re.ueg=Nc;re.Ed=Vd;re.Mha=oe;re.isOlap=qe;re.qV=ee;return re}function U(gb){gb=Xb.call(this,gb)||this;gb.zce=null;gb.get_visible=gb.Aja;gb.set_visible=gb.sna;gb.Uja();return gb}function J(){}function H(gb,Bb,qc,Nc,nd,Vd,oe,qe){var ee=Sb.call(this,gb)||this;ee.gF=null;ee.y5b=null;ee.l0b=null;ee.f1d=null;ee.g1d=null;ee.w3d=null;ee.Ouf=function(){var re=parseInt(ee.m3.fe.value,10);ee.$Tg(re)?
(ee.KT.Rp.disabled=!0,ee.qP.Rp.disabled=!0,ee.qP.clear(),H.uaf(re)?(ee.KT.Rp.disabled=!1,ee.RNb(!0)):H.vaf(re)?(ee.KT.Rp.disabled=!1,ee.qP.Rp.disabled=!1,ee.RNb(!0),ee.Mjf()):ee.RNb(!1)):(re=Qa.a.Xc(1,0,0,1108,0,7896227,"FormatRequiresBaseFieldsOrBaseItems"),nc.a(ee.$).nr([re]),ee.m3.Egj())};ee.WFi=function(){0>ee.KT.selectedIndex||ee.qP.Rp.disabled||(ee.RNb(!0),ee.Mjf())};ee.YLi=function(re){ee.gF.zdb();ee.qP.Rp.style.overflowY="scroll";if(re&&!Db.a(re)){re=re.Result;ee.qP.clear();for(var Ze=bk(re.BaseItems),
mf=Ze.next();!mf.done;mf=Ze.next())mf=mf.value,ee.qP.ML(mf.DisplayString,mf.Id.toString(),mf.Id===re.SelectedBaseItem);ee.RNb(!1)}};ee.get_visible=ee.Aja;ee.set_visible=ee.sna;ee.$=Bb;ee.cell=qc;ee.ro=Nc;ee.externalSourceIndex=nd;ee.Ed=Vd;ee.Mha=oe;ee.qji=qe;ee.KRj=Kb.EwaSettings.isChangeGateEnabled("OfficeVSO:4859461_DisableOKButtonWhenLoadingIndictorIsOn");ee.Uja();return ee}function K(){}function N(gb,Bb,qc,Nc,nd){this.externalSourceIndex=0;this.pivotFieldTitle=this.activeCell=null;this.summarizeBy=
0;this.showAsValueParameters=null;this.externalSourceIndex=gb;this.activeCell=Bb;this.pivotFieldTitle=qc;this.summarizeBy=Nc;this.showAsValueParameters=nd}function M(gb,Bb,qc){this.baseItemIndex=this.baseFieldIndex=this.dataFormat=0;this.dataFormat=gb;this.baseFieldIndex=Bb;this.baseItemIndex=qc}function C(){}function Q(){}function P(gb,Bb,qc,Nc){return ka.call(this,gb,"PopulateFieldListPivotMenu",-1793121409,1378457149,Bb,qc,Nc,ad)||this}function ka(gb,Bb,qc,Nc,nd,Vd,oe,qe){qe=void 0===qe?qd:qe;
var ee=Jd.call(this,gb,Bb,qc,Nc,qe,!0,!1,"PivotFilterMenuRootName",nd,Vd,!1,oe)||this;ee.U4b=null;ee.gif=null;ee.$lb=null;ee.pivotData=null;ee.Oxd=null;ee.Slc=null;ee.yDb=0;ee.S1b=0;ee.iY=0;ee.urb=null;ee.bLi=function(re,Ze){if(Ze)if(Db.a(re))ee.Tud(Ze,!1);else if(re=re.Result){ee.gsb=fa.jed(Ze,ee.$,ee.pivotData.cell,ee.iY);var mf=ee.Kof(re.MenuModel.Sections);ee.urb=mf;ka.cN.set(ee.pivotData.cell,Ze,mf,ee.iY);Td.a(ee.$).$Ej(re);ee.Tud(Ze,!0)}};ee.aLi=function(re,Ze){ee.Tud(Ze,!1)};ee.ef=function(re,
Ze){ka.cN.g7b(Ze.Zc.hash)};ee.Dm=function(re,Ze){ka.cN.g7b(Ze.Zc.hash)};ee.nza=null;ee.Pxd=ee.yDb=-1;ee.Ewe=ee.S1b=-1;ee.Joe=ee.iY=0;ee.Ox=Kb.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");ka.cN||(ka.cN=new fa(ee.$),Za.g(ee.$).Ea.Ds(ee.ef),Za.g(ee.$).Ea.uG(ee.Dm),Za.g(ee.$).Ea.Cga(ee.ef));return ee}function R(){this.cell=null;this.dataSourceIndex=0;this.ro=this.pivotName=null}function fa(gb){this.$=gb;this.cN={}}function ca(gb,Bb,qc,Nc){gb=Le.call(this,gb,"PopulateFieldListContextMenu",
-1045020714,-170383950,Se,!0,!1,Se,Bb,qc,!1,Nc)||this;gb.co=null;gb.kL=null;gb.PZ=!1;gb.qV=!1;gb.isOlap=!1;gb.ATd=!1;return gb}function ea(gb,Bb,qc,Nc){gb=wa.call(this,gb,Bb,qc,Nc,"PopulateChartContextMenu",-498523270,1640762262,Ie)||this;gb.yAa=!1;gb.Iva=!1;gb.$Y=!1;gb.refresh=!1;gb.isPivotChart=!1;return gb}function wa(gb,Bb,qc,Nc,nd,Vd,oe,qe,ee,re){qe=void 0===qe?Fb.a.L1g:qe;gb=rb.call(this,gb,void 0===nd?"PopulateFloatingObjectContextMenu":nd,void 0===Vd?-2017893763:Vd,void 0===oe?1350204367:
oe,qe,void 0===ee?!0:ee,void 0===re?!1:re,qe,Bb,qc,!0,Nc)||this;gb.floatingObject=null;gb.lb=0;gb.Dkc=!0;return gb}function X(gb,Bb,qc,Nc){gb=Gc.call(this,gb,"PopulateAutoFilterFieldListContextMenu",474690375,216058793,X.kyh,!0,!1,X.YIb,Bb,qc,!1,Nc)||this;gb.cm=null;return gb}function ja(){}function va(gb,Bb){gb=ua.call(this,gb,2,0,null)||this;gb.Yre=Bb;return gb}function ua(gb,Bb,qc,Nc){this.dsg=gb;this.tmg=Bb;this.xmg=qc;this.Bwg=Nc}function Xa(){}function aa(gb,Bb,qc,Nc){var nd=wb.call(this,gb,
"PopulateAutoFilterContextMenu",1675506831,1651433993,Fc,!0,!1,"AutoFilterContextMenuRoot",Bb,qc,!1,Nc)||this;nd.urb=null;nd.sheetName=null;nd.QSa=null;nd.QVc=null;nd.gkf=!1;nd.n2a=!1;nd.gGb=null;nd.aMb=null;nd.k9c=null;nd.xbc=null;nd.UOa=null;nd.CEe=null;nd.l$a=null;nd.M3c=null;nd.KV=function(){nd.Lxc();nd.$.ea.mn(nd.KV)};nd.IKi=function(Vd){function oe(Wb,Lc,jd){nd.M3c=ab.o(nd.$.oa.xa,re,Aa.b(Wb,Ze),nd.n2a?Aa.a(Lc,mf):Lc,jd,null,Pa);return nd.M3c}nd.n2a||Zb.b(nd.$).yd(yb.a.zwf,nd.dm(),void 0,!0);
var qe={};nd.$.Lj(qe);var ee=nd.$.ea.isNamedObjectViewMode,re=Wa.a.Th(nd.QVc);re.SheetName=ee?qe.NamedObjectName:qe.SheetName;re.NamedObjectView=ee;qe=!!Vd.searchText;ee=586;nd.n2a&&(qe&&(re.ItemListOptions=nd.r4g(Vd.searchText),ee=597),Vd={},Zb.b(nd.$).yd(yb.a.zwf,(Vd.UserOperation=ee.toString(),Vd),void 0,!0));var Ze=nd.uzd(qe),mf=nd.JKi(),Pa=nd.$.oa.xa.Pb();nd.CEe=Pa.RequestId;nd.n2a&&nd.xbc&&!nd.xbc.dequeueUtcTime&&(nd.$.userOperationManager.uta(nd.xbc),nd.lUg());Vd=Kb.EwaSettings.Zb()?new Cb.a(ee,
0,oe,80):new Ob.a(ee,0,oe,16);nd.xbc=nd.$.userOperationManager.Sb(Vd,null);nd.l$a=nd.M3c;nd.UOa=nd.CEe};nd.onMenuItemClick=function(Vd,oe,qe){Zb.b(nd.$).yd(yb.a.CPi,nd.dm(),void 0,!0);var ee={};oe=(ee.CommandValueId=oe,ee.MenuItemId=oe,ee.InputMethod=qe,ee.TopCellAddress=nd.QSa,ee);ee=new cb.a(Vd,qe,nd.$.isEditMode?2:1,19,null);nd.$.Ka.Kb(ee,oe);V.ULS.sendTraceTag(537167131,0,50,"AutoFilterContextMenu::OnMenuItemClick {0}, {1}",Vd,qe)};nd.HFi=function(Vd){if(Vd.checkedItems&&Vd.checkedItems.length){Zb.b(nd.$).yd(yb.a.Ssf,
nd.dm(),void 0,!0);var oe=Wa.a.Th(nd.QVc),qe={};nd.$.Lj(qe);qe.FirstRow=0;qe.FirstColumn=oe.Column;var ee=nd.$.ea.isNamedObjectViewMode;oe.NamedObjectView=ee;oe.SheetName=ee?qe.NamedObjectName:qe.SheetName;var re=function(Pa){if(jb.a.Iwc(Pa)){var Wb=jb.a.O$b(Pa);nd.fMa?jb.a.ZPa(Vb.a.applyItemFilter,Wb.MessageIdName,Rb.a.Yra,!0,jb.a.isSessionEndingError(Wb.MessageId)):V.ULS.sendTraceTag(537167129,0,10,"AutoFilterContextMenu::OnApplyFilterByValue failed with AutoFilterException -{0}",Wb.MessageIdName)}Db.a(Pa)||
(V.ULS.sendTraceTag(537167128,0,50,"AutoFilterContextMenu::OnApplyFilterByValue service call succeeded"),Zb.b(nd.$).yd(yb.a.twf,nd.dm(),void 0,!0),Pa=Object(sa.a)(new xa,{isSuccess:!0}),nd.aMb.onApplyFilterByValueFinish(Pa),nd.hL(nd.QSa))},Ze=nd.r2c(oe,qe),mf=new Cb.a(208,0,function(Pa,Wb,Lc){return ab.a(nd.$.oa.xa,Ze,Vd.checkedItems,Aa.b(Pa,re),Wb,Lc,null,null)},6,function(){return new qb.a(Vd.checkedItems,Ze)});nd.L2f(function(){nd.$.userOperationManager.Sb(mf,null)})}else V.ULS.sendTraceTag(537167130,
0,15,"AutoFilterContextMenu::OnApplyFilterByValue Received Zero checked items to apply filter on")};nd.jKg=function(Vd){var oe=ec.o(nd.QSa,nd.$),qe=ec.v(nd.QSa,nd.$),ee=Object(sa.a)(new ib.a,{SortConditionType:Vd.type,RowColOffset:oe.FirstColumn-qe.FirstColumn,SortColor:Vd.color,SortIconSet:Vd.icon.IconSet,SortIcon:Vd.icon.Icon,IsAscending:!0}),re={SortOptions:Object(sa.a)(new La.a,{OperationType:1,ActiveCell:oe,SelectedRange:qe,SortConditions:[ee],SortTopToBottom:!0,GuessHeader:!0,IsCaseSensitive:!1}),
SelectedRange:qe,OriginalActiveCell:oe,ShouldRestoreSelection:!1};re.ShouldPromptNamedSheetViewTeachingDialog=Kb.EwaSettings.isChangeGateEnabled("OfficeVSO:6170028_HandleSheetProtectionForSortFeatures");V.ULS.sendTraceTag(537167119,0,50,"AutoFilterContextMenu.ApplySortByColorOrIcon: Aplying Sort, type: {0}",Vd.type);Kb.EwaSettings.isChangeGateEnabled("OfficeVSO:6170028_HandleSheetProtectionForSortFeatures")?(Vd={},nd.$.Fd(-1089513346,vb.a.Cb,19,(Vd.CustomSortCommandData=re,Vd))):nd.L2f(function(){var Ze=
{};nd.$.Fd(1659552324,vb.a.Cb,19,(Ze.CustomSortCommandData=re,Ze))})};nd.fMa=jb.a.Ild();nd.Ox=Kb.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");return nd}function ba(){this.top=this.left=0}function oa(){this.onMenuItemClick=this.applyFilterByValueRequest=this.getFilterByValueItemsRequest=null;this.autoFilterMenuWidth=0;this.applySortByColorOrIconRequest=null}function ra(){this.autoFilterMenu=this.targetPoint=null}function db(){this.filterByValueItems=null;this.hasMoreRecords=!1;
this.searchText=null}function Ka(){this.selectedSortIcon=this.selectedSortFontColor=this.selectedSortCellColor=this.getColorName=this.icons=this.fontColors=this.cellColors=null}function Ga(){this.displayText=null;this.state=0;this.children=this.parent=this.key=null;this.indentationLevel=0;this.expanded=!1}function xa(){this.isSuccess=!1}function da(){this.Title=this.MenuItems=this.Id=null;this.DisplayType=0}function qa(){this.Disabled=!1;this.RibbonCommand=this.Identifier=this.Type=0;this.SubMenu=
this.Label=this.CommandData=null;this.IsChecked=!1;this.TooltipText=this.Id=this.IconName=null}function na(){this.Sections=this.Id=null}var ia=b(0),ta=b(905),za=b(155),sa=b(7),V=b(14),Ia=b(83),Ha=b(4),ob=b(162),ib=b(1275),La=b(1273),zb=b(928),Fb=b(5),Yb=b(495),kb=b(624),vb=b(76),Wa=b(54),qb=b(1115),yb=b(133),ec=b(45),Ob=b(564),Cb=b(177),ab=b(62),ya=b(51),ma=b(962),ha=b(151),Z=b(37),Na=b(121),eb=b(217),cb=b(91),Ua=b(69),pa=b(34),Qa=b(31),Db=b(295),Kb=b(1),Ab=b(186),ub=b(15),Mb=b(61),Aa=b(294),Za=b(21),
Zb=b(134),jb=b(983),Vb=b(984),Ic=b(126),Rb=b(112),kc=b(50),xb=b(33),Va=b(446);Object(ia.a)(na,"AutoFilterMenu",null,[]);Object(ia.a)(qa,"MenuItem",null,[]);Object(ia.a)(da,"MenuSection",null,[]);Object(ia.a)(xa,"ApplyFilterByValueResponse",null,[]);Object(ia.a)(Ga,"FilterByValueItem",null,[]);Object(ia.a)(Ka,"GetColorsAndIconsResponse",null,[]);Object(ia.a)(db,"GetFilterByValueItemsResponse",null,[]);Object(ia.a)(ra,"ShowSortFilterMenuParams",null,[]);Object(ia.a)(oa,"SortFilterControllerFactoryParams",
null,[]);Object(ia.a)(ba,"TargetPoint",null,[]);var tb=b(58),fb=b(256),ac=b(36),Ac=b(163),Rc=b(223),Fc=Fb.a.F1g,wb=zb.a;Rk(aa,wb);aa.prototype.executeCommand=function(gb,Bb,qc){var Nc=this;gb=Bb.command;switch(gb){case 1701016594:return zb.a.uwh(qc),tb.Task.Ua(!0);case 966232027:if(Kb.EwaSettings.xl()){var nd=new ob.a;Z.TaskExtensions.Aa(ya.GetServiceTaskFactory.Ra(this.$.da,8,9,0),function(Vd){Nc.a5e(Bb,qc,Vd.result);nd.setResult(!0)},this.la,3).continueWith(function(){nd.setResult(!1)},5,this.la,
Rc.a.instance);return nd.task}this.a5e(Bb,qc);return tb.Task.Ua(!0);default:return Ab.a(gb)}};aa.prototype.a5e=function(gb,Bb,qc){var Nc=this,nd=Bb.domEvent;if(Ua.e(nd.rawEvent)&&(Ua.g(nd),nd.target)){var Vd=new ha.a(this.$.va);if(Vd.Ud(4096)||Vd.Ud(2048)){var oe=Wa.a.Th(Bb[vb.a.Uf]);this.k1f(oe)&&(this.gkf?this.Esc(nd,nd.target,oe,gb,qc):(this.gGb=function(){Nc.k1f(oe)&&(Nc.uai(),Nc.Esc(nd,nd.target,oe,gb,qc),Nc.n2a=Kb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FilterByValueSearch",
!1),Nc.gkf=!0)},this.Lxc()))}}};aa.prototype.zc=function(gb,Bb,qc){if(gb=!!qc)switch(Bb.command){case 1701016594:case 966232027:Kb.EwaSettings.xl()||Yb.a(this.$)||(gb=!1,V.ULS.sendTraceTag(537167137,0,15,"AutoFilterContextMenu.CanExecuteCommand: ContextMenuManager is not ready. RibbonCommand was {0}",kc.b().ei(Bb.command)));break;default:gb=!1}return gb};aa.prototype.QCd=function(gb){Array.addRange(gb.MenuSectionList,this.urb)};aa.prototype.uai=function(){var gb=this;Va.a(function(){gb.aMb=sortFilter.SortFilterControllerFactoryGlobal.createSortFilterController(Object(sa.a)(new oa,
{getFilterByValueItemsRequest:gb.IKi,applyFilterByValueRequest:gb.HFi,onMenuItemClick:gb.onMenuItemClick,autoFilterMenuWidth:aa.Xre,applySortByColorOrIconRequest:gb.jKg}))});this.k9c=Ia.a.instance.mh("Common.IExternalUICommandDefinitionMapping")||new kb.a(this.$.yb,this.$)};aa.prototype.Esc=function(gb,Bb,qc,Nc,nd){Zb.b(this.$).yd(yb.a.Esc,this.dm(),void 0,!0);V.ULS.shipAssertTag(537167135,0,!!qc,"Attempt at opening AutoFilterContextMenu failed, autoFilterData is null.");gb=this.bIh(qc,nd);Nc=Sys.UI.DomElement.getBounds(Bb);
Bb=Nc.x+Nc.width;Nc=Nc.y;if(this.Ox&&!qc.IsHeaderSnapped){if(Kb.EwaSettings.isChangeGateEnabled("OfficeVSO:6053383_EnsureContextMenuCellInView")&&!zb.a.kmd(this.$,qc.Cell))return;qc=zb.a.xcd(this.$,qc.Cell,!0);Bb=qc.x;Nc=qc.y}qc=Za.g(this.$).rtl?new Sys.UI.Point(Bb-xb.a(this.$).PFa(aa.Xre),Nc):new Sys.UI.Point(Bb,Nc);qc=xb.a(this.$).rja(qc);qc=Object(sa.a)(new ra,{targetPoint:Object(sa.a)(new ba,{left:qc.x,top:qc.y}),autoFilterMenu:gb});this.aMb.showSortFilterMenu(qc);this.$.Fd(-544117314,-1,0,null)};
aa.prototype.k1f=function(gb){return Kb.EwaSettings.isChangeGateEnabled("OfficeVSO:5819197_CheckActiveItemBeforeRenderingAutofilterMenu")&&gb.Cell.SheetName?Za.g(this.$).a5?gb.Cell.SheetName===this.$.pa.name:gb.Cell.SheetName===this.$.pa.sheetName:!0};aa.prototype.bIh=function(gb,Bb){return(gb=this.cIh(gb,Bb))?this.nIf(gb):null};aa.prototype.nIf=function(gb){for(var Bb=[],qc=bk(gb.Sections),Nc=qc.next();!Nc.done;Nc=qc.next())Nc=Nc.value,Object(Ac.f)(this.$)&&Kb.EwaSettings.isChangeGateEnabled("OfficeVSO:6122433_NSVTitleEnabled")&&
Nc.Title===ub.a.instance.ga(1926)||(Nc=this.u0i(Nc),Bb.push(Nc));return Object(sa.a)(new na,{Id:gb.Id,Sections:Bb})};aa.prototype.u0i=function(gb){for(var Bb=[],qc=bk(gb.MenuItems),Nc=qc.next();!Nc.done;Nc=qc.next())if(Nc=Nc.value,2===Nc.Identifier)this.QVc=Nc.CommandData;else switch(Nc.Type){case 3:case 2:Bb.push(this.s0i(Nc,2===Nc.Type));break;case 1:Bb.push(this.t0i(Nc))}return Object(sa.a)(new da,{MenuItems:Bb,DisplayType:gb.DisplayType,Id:this.pFh(gb)})};aa.prototype.t0i=function(gb){var Bb=
this.UUe(gb);var qc=Bb.label;var Nc=Bb.ZKa;Bb=this.nIf(gb.SubMenu);var nd=this.KUe(gb);Nc=this.k9c.Kac(Nc);qc=qc||gb.Label;return Object(sa.a)(new qa,{Disabled:gb.Disabled,Type:gb.Type,Identifier:gb.Identifier,Id:nd,CommandData:gb.CommandData,Label:qc,SubMenu:Bb,IsChecked:gb.IsChecked,IconName:"MissingIcon_20"===Nc?null:Nc})};aa.prototype.s0i=function(gb,Bb){var qc=this.y$b(gb,Bb&&gb.IsChecked);Bb=qc.label;var Nc=qc.ZKa;qc=qc.mr;var nd=this.vbd(gb,Bb);Nc=this.k9c.Kac(Nc);return Object(sa.a)(new qa,
{Disabled:gb.Disabled,Type:gb.Type,Identifier:gb.Identifier,Id:nd,RibbonCommand:qc,CommandData:gb.CommandData,Label:Bb||gb.Label,SubMenu:null,IsChecked:gb.IsChecked,IconName:"MissingIcon_20"===Nc?null:Nc})};aa.prototype.cIh=function(gb,Bb){var qc;this.QSa=qc=ec.C(gb.Cell);this.sheetName=this.$.pa.sheetName;Bb=Bb||Yb.a(this.$);if(gb.IsHeaderSnapped)qc=Bb.n9b.mPh(qc);else{Bb=Za.g(this.$).Ea.YJa(qc);if(!Bb)return this.fMa?jb.a.ZPa(Vb.a.FKf,Ic.a.B0h,Rb.a.qZa,!0,!1):V.ULS.sendTraceTag(537167134,0,10,"AutoFilterContextMenu.GetAutoFilterMenuProps: gridModelCellProxy that is supposed to hold model is null. Range requested {0}, visible range: {1}",
qc,Za.g(this.$).view.visibleArea),null;qc=Bb.autoFilterMenu}if(!qc)return this.fMa?jb.a.ZPa(Vb.a.FKf,Ic.a.tzi,Rb.a.qZa,!0,!1):V.ULS.sendTraceTag(537167133,0,10,"AutoFilterContextMenu.GetMenuPropsFromCachedBlock: a cell that's supposed to have an autofilter menu returned a null menu."),null;this.gsb=gb.Cell.FirstRow+"_"+gb.Cell.FirstColumn;return qc};aa.prototype.Lxc=function(){var gb=this;if(this.$.ea.Tg){var Bb=ya.GetServiceTaskFactory.Ra(this.$.da,283,284,1);Z.TaskExtensions.Aa(Bb,function(){gb.fMa?
Bb.result.tn.loadScript("sortFilter").then(function(){gb.gGb()},function(qc){Mb.a.gk(qc,"AutoFilterContextMenu.SortFilterScriptLoad");jb.a.ZPa(Vb.a.Lxc,Ic.a.yCj,Rb.a.qZa,!1,!1)}):Z.TaskExtensions.Aa(fb.c(Bb.result.tn.loadScript("sortFilter")),function(){gb.gGb()},gb.$.la,3)},this.$.la,3)}else this.$.ea.il(this.KV)};aa.prototype.r4g=function(gb){var Bb={};Bb.SearchText=gb;Bb.Page=1;Bb.DateNodeType=-1;return Bb};aa.prototype.lUg=function(){this.UOa&&(V.ULS.sendTraceTag(537167132,0,15,"AutoFilterContextMenu.CancelGetAutoFilterItemListWebRequest Cancelling pending getAutoFilterItemList request with ID={0}",
this.UOa),ab.h(this.$.oa.xa,this.UOa,null,null,null),this.UOa=null);this.l$a&&(Ha.AFrameworkApplication.qd.ku(this.l$a.Dt),this.l$a=null)};aa.prototype.uzd=function(gb){var Bb=this;return function(qc){Bb.UOa=null;Bb.l$a=null;if(jb.a.Iwc(qc)){var Nc=jb.a.O$b(qc);Bb.fMa?jb.a.ZPa(gb?Vb.a.searchAutoFilterItemList:Vb.a.getAutoFilterItemList,Nc.MessageIdName,Rb.a.qZa,!0,!0):V.ULS.sendTraceTag(537167127,0,10,"AutoFilterContextMenu::OnGetFilterByValueItemsSuccessCallback failed with AutoFilterException -{0}",
Nc.MessageIdName)}if(!Db.a(qc)){V.ULS.sendTraceTag(537167126,0,50,"AutoFilterContextMenu::OnGetFilterByValueItems service call succeeded");qc=qc.Result;Nc=new pa.a(!0);var nd=qc.AutoFilterDateNodes?!0:!1;qc.AutoFilterItems&&Nc.add("AutoFilterItemsCount",qc.AutoFilterItems.length);nd&&Nc.add("AutoFilterDateItemsCount",qc.AutoFilterDateNodes.length);Nc.add("Location","contextMenu");Zb.b(Bb.$).yd(yb.a.uzd,Nc.Zt,void 0,!0);Nc=Bb.n2a?Object(sa.a)(new db,{filterByValueItems:Bb.XAe(qc),hasMoreRecords:qc.ItemListMaxExceeded,
searchText:qc.SearchText}):Object(sa.a)(new db,{filterByValueItems:Bb.XAe(qc),hasMoreRecords:qc.ItemListMaxExceeded});Bb.aMb.onGetFilterByValueItemsFinish(Nc);gb||(V.ULS.shipAssertTag(529063959,0,null!==qc.FontColors&&null!==qc.CellColors&&null!==qc.Icons&&null!==qc.SelectedSortFontColors&&null!==qc.SelectedSortCellColors&&null!==qc.SelectedSortIcons,"AutoFilterContextMenu.onGetFilterByValueItemsSuccessCallback: SortByColor items should not be null"),qc=Object(sa.a)(new Ka,{fontColors:qc.FontColors,
cellColors:qc.CellColors,icons:qc.Icons,selectedSortFontColor:0<qc.SelectedSortFontColors.length?qc.SelectedSortFontColors[0]:null,selectedSortCellColor:0<qc.SelectedSortCellColors.length?qc.SelectedSortCellColors[0]:null,selectedSortIcon:0<qc.SelectedSortIcons.length?qc.SelectedSortIcons[0]:null,getColorName:Bb.getColorName}),Bb.aMb.onGetColorsAndIconsFinish(qc))}}};aa.prototype.JKi=function(){var gb=this;return function(Bb){gb.UOa=null;gb.l$a=null;Bb=Na.a.Mf(Bb.data);V.ULS.sendTraceTag(537167125,
0,10,"AutoFilterContextMenu.OnGetFilterByValueItemsFailureCallback Errors: [{0}].",Qa.a.Ec(Bb))}};aa.prototype.XAe=function(gb){var Bb=this.g2g(gb),qc=this.n2g(gb.AutoFilterItems),Nc=[],nd=0;gb.HasBlanks&&(gb=aa.F2c(ub.a.instance.ga(781),gb.IsBlanksSelected?1:0,Fb.a.Wre),Nc[nd++]=gb);Bb=bk(Bb);for(gb=Bb.next();!gb.done;gb=Bb.next())gb=gb.value,Nc[nd++]=gb;qc=bk(qc);for(gb=qc.next();!gb.done;gb=qc.next())Bb=gb.value,Nc[nd++]=Bb;return Nc};aa.prototype.g2g=function(gb){var Bb=[];if(!gb.AutoFilterDateNodes||
!gb.AutoFilterDateNodes.length)return Bb;for(var qc=[this.G3a(gb.YearKeys,gb.YearValues),this.G3a(gb.MonthKeys,gb.MonthValues),this.G3a(gb.DayKeys,gb.DayValues),this.G3a(gb.HourKeys,gb.HourValues),this.G3a(gb.MinuteKeys,gb.MinuteValues),this.G3a(gb.SecondKeys,gb.SecondValues)],Nc=!1,nd=!1,Vd=0,oe=null,qe=Array(6),ee=null,re=bk(gb.AutoFilterDateNodes),Ze=re.next();!Ze.done;Ze=re.next()){Ze=Ze.value;qe[0]&&(ee.Year!==Ze.Year?(Nc=!0,Vd=0,oe=null):ee.Month!==Ze.Month?(nd=!0,Vd=1,oe=qe[0]):ee.Day!==Ze.Day?
(Vd=2,oe=qe[1]):gb.ShowTime&&(ee.Hour!==Ze.Hour?(Vd=3,oe=qe[2]):ee.Minute!==Ze.Minute?(Vd=4,oe=qe[3]):(Vd=5,oe=qe[4])));for(;6>Vd;){switch(Vd){case 0:var mf=Ze.Year;ee=qc[0].getItem(mf.toString());break;case 1:mf=Ze.Month;ee=qc[1].getItem(mf.toString());break;case 2:mf=Ze.Day;ee=qc[2].getItem(mf.toString());break;case 3:mf=Ze.Hour;ee=qc[3].getItem(mf.toString());break;case 4:mf=Ze.Minute;ee=qc[4].getItem(mf.toString());break;case 5:mf=Ze.Second;ee=qc[5].getItem(mf.toString());break;default:throw Error.invalidOperation("Unknown AutoFilterDateNodeType.");
}ee=aa.F2c(ee,-1!==Ze.NodeType&&Vd>=Ze.NodeType?1:0,oe?oe.key+";"+mf:Fb.a.RWc+mf,!1,[]);oe=oe?oe.children:Bb;oe=oe[oe.length]=ee;qe[Vd]=ee;switch(Vd){case 5:Vd=6;break;case 2:Vd=gb.ShowTime?Vd+1:6;break;default:Vd++}}ee=Ze}Nc||(qe[0].expanded=!0,nd||(qe[1].expanded=!0));return Bb};aa.prototype.n2g=function(gb){var Bb=[];if(!gb)return Bb;var qc=0;gb=bk(gb);for(var Nc=gb.next();!Nc.done;Nc=gb.next())Nc=Nc.value,Bb[qc++]=aa.F2c(Nc.DisplayString,Nc.Selected?1:0,Fb.a.SWc+Nc.DisplayString);return Bb};aa.prototype.G3a=
function(gb,Bb){var qc=new pa.a(!0);if(!gb||!Bb)return qc;for(var Nc=gb.length<Bb.length?gb.length:Bb.length,nd=0;nd<Nc;nd++)qc.add(gb[nd].toString(),Bb[nd]);return qc};aa.prototype.r2c=function(gb,Bb){var qc={};qc.Location=Bb;qc.FieldId=gb.Id.toString();qc.DataSourceIndex=-1;qc.FilterType=gb.AutoFilterType;qc.AnchorType=0;qc.ChartId=null;qc.AnchorValue1=-1;qc.AnchorValue2=-1;qc.Property=gb.RichProperty;return qc};aa.prototype.hL=function(gb){ac.a.Bba(this.$)&&Z.TaskExtensions.Aa(ya.GetServiceTaskFactory.Ra(this.$.da,
430,431,1),function(Bb){Bb.result.eea(gb);V.ULS.sendTraceTag(537167123,306,50,"AutoFilterContextMenu:TriggerPivotTableHandRaise Trigger hand raise from filter context menu.")},this.$.la,3)};aa.prototype.dm=function(){var gb={};return gb.Location="contextMenu",gb};aa.prototype.getColorName=function(gb){return ma.a.XJa(eb.a.WG(gb))};aa.prototype.L2f=function(gb){Z.TaskExtensions.Aa(ya.GetServiceTaskFactory.Ra(this.$.da,309,310,3),function(Bb){Bb.result.BAa().continueWith(function(qc){qc.result&&gb()})},
this.$.la,3)};aa.F2c=function(gb,Bb,qc,Nc,nd){gb=void 0===gb?null:gb;Bb=void 0===Bb?0:Bb;qc=void 0===qc?null:qc;Nc=void 0===Nc?!1:Nc;nd=void 0===nd?null:nd;return Object(sa.a)(new Ga,{displayText:gb?zb.a.qh(gb):gb,state:Bb,key:qc,parent:null,children:nd,indentationLevel:0,expanded:Nc})};Mf.Object.defineProperties(aa.prototype,{uw:{configurable:!0,enumerable:!0,get:function(){return"PopulateAutoFilterContextMenu"}},sB:{configurable:!0,enumerable:!0,get:function(){return Fb.a.DKf}}});aa.Xre=268;Object(ia.a)(aa,
"AutoFilterContextMenu",zb.a,[]);var uc=b(936),Pb=b(85),sc=b(202),nb=b(66),pc=b(19);Xa.IRe=26;Xa.o$c=[230,231,0,99,0,95,94];Object(ia.a)(Xa,"Constants",null,[]);Mf.Object.defineProperties(ua.prototype,{Wii:{configurable:!0,enumerable:!0,get:function(){return 3===this.J4b}},Cmi:{configurable:!0,enumerable:!0,get:function(){return 4===this.J4b&&!!this.subMenu}},subMenu:{configurable:!0,enumerable:!0,get:function(){return this.Bwg}},Oof:{configurable:!0,enumerable:!0,get:function(){return this.dsg}},
J4b:{configurable:!0,enumerable:!0,get:function(){return this.tmg}},a4c:{configurable:!0,enumerable:!0,get:function(){return this.xmg}}});Object(ia.a)(ua,"FiltersMenuData",null,[]);Rk(va,ua);Object(ia.a)(va,"AutoFilterFiltersMenuData",ua,[]);ja.FHj=[new ua(100,2,0,null),new ua(101,2,1,null),new ua(0,3,0,null),new ua(172,2,2,null),new ua(174,2,4,null),new ua(0,3,0,null),new ua(176,2,6,null),new ua(177,2,7,null),new ua(0,3,0,null),new ua(108,0,0,null)];ja.fEi=[new ua(100,2,0,null),new ua(101,2,1,null),
new ua(0,3,0,null),new ua(102,2,8,null),new ua(103,2,10,null),new ua(104,2,12,null),new ua(0,3,0,null),new ua(105,1,0,null),new va(106,1),new va(107,2),new ua(0,3,0,null),new ua(108,0,0,null)];ja.dbh=[new ua(100,2,0,null),new ua(0,3,0,null),new ua(112,2,10,null),new ua(113,2,8,null),new ua(104,2,12,null),new ua(0,3,0,null),new va(110,8),new va(109,9),new va(111,10),new ua(0,3,0,null),new va(115,11),new va(114,12),new va(116,13),new ua(0,3,0,null),new va(117,14),new va(118,15),new va(119,16),new ua(0,
3,0,null),new va(120,17),new va(121,18),new va(122,19),new ua(0,3,0,null),new va(123,20),new va(124,21),new va(125,22),new ua(0,3,0,null),new va(126,23),new ua(127,2,12,[new va(128,24),new va(129,25),new va(130,26),new va(131,27),new ua(0,3,0,null),new va(132,28),new va(133,29),new va(134,30),new va(135,31),new va(136,32),new va(137,33),new va(138,34),new va(139,35),new va(140,36),new va(141,37),new va(142,38),new va(143,39)]),new ua(0,3,0,null),new ua(108,0,0,null)];Object(ia.a)(ja,"Constants",null,
[]);var Dc=b(1116),oc=b(77),Gc=zb.a;Rk(X,Gc);X.prototype.executeCommand=function(gb,Bb,qc){gb=Bb.command;switch(gb){case -699941697:this.applyAutoFilterFieldList(Bb,qc);break;case 216058793:String.format("TableFieldListContextMenu:AutoFilterFieldListContextMenuClose");break;case -1494291901:break;default:return Ab.a(gb)}return tb.Task.Ua(!0)};X.prototype.ocd=function(gb,Bb){return!gb||gb.length<=Bb?(V.ULS.sendTraceTag(537167117,0,10,"AutoFilterFieldListContextMenu:GetCommandId - incomplete id list"),
-1):parseInt(gb[Bb],10)};X.prototype.vEd=function(gb,Bb,qc,Nc,nd,Vd){var oe=this.ocd(nd,Vd);0>oe&&V.ULS.sendTraceTag(537167116,0,10,"AutoFilterFieldListContextMenu:ProcessCommand - command id not found");switch(Xa.o$c[oe]){case 99:gb=new cb.a(-2058042992,Bb.method,Bb.mode,Bb.Le,Bb.tabName);this.cm.zG.otb(this.$,Nc,0,gb);break;case 230:gb=new cb.a(504133448,Bb.method,Bb.mode,Bb.Le,Bb.tabName);this.cm.zG.otb(this.$,Nc,0,gb);break;case 231:gb=new cb.a(-798968736,Bb.method,Bb.mode,Bb.Le,Bb.tabName);this.cm.zG.otb(this.$,
Nc,0,gb);break;case 235:gb=new cb.a(-1677817820,Bb.method,Bb.mode,Bb.Le,Bb.tabName);this.cm.zG.otb(this.$,Nc,0,gb);break;case 95:this.DIf(gb,Bb,Nc,qc,nd,Vd+1);break;case 94:this.cm.zG.Bqi(this.$,Nc)}};X.prototype.DIf=function(gb,Bb,qc,Nc,nd,Vd){var oe=this.ocd(nd,Vd);0>oe&&V.ULS.sendTraceTag(537167115,0,10,"AutoFilterFieldListContextMenu:ProcessSubMenuCommand - command id not found");if(!Nc||oe>=Nc.length)V.ULS.sendTraceTag(537167114,0,15,"AutoFilterFieldListContextMenu:ProcessSubMenuCommand() - no menuData.");
else switch(Nc=Nc[oe],Nc.J4b){case 1:this.cm.zG.Vqi(this.$,qc);break;case 2:(nd=Object(Pb.a)(va,Nc))?(gb=new cb.a(-2058042992,Bb.method,Bb.mode,Bb.Le,Bb.tabName),this.cm.zG.otb(this.$,qc,nd.Yre,gb)):this.cm.zG.Wif(this.$,gb,qc,Nc.a4c);break;case 0:this.cm.zG.Wif(this.$,gb,qc,Nc.a4c);break;case 4:this.DIf(gb,Bb,qc,Nc.subMenu,nd,Vd+1)}};X.prototype.applyAutoFilterFieldList=function(gb,Bb){var qc=Bb[uc.a.OF];if(qc)if(qc=qc.split(nb.a.xU),3>qc.length)V.ULS.sendTraceTag(537167112,0,15,"AutoFilterFieldListContextMenu:ApplyAutoFilterFieldList() - unexpected SourceIdControl string.");
else{var Nc=this.ocd(qc,1),nd=this.LJa(Nc),Vd=this.Jof(Nc).returnValue;Vd?this.vEd(Bb,gb,Vd,nd,qc,2):V.ULS.sendTraceTag(537167111,0,15,"AutoFilterFieldListContextMenu:ApplyAutoFilterFieldList() - menu data not found for index "+Nc.toString()+nb.a.xU)}else V.ULS.sendTraceTag(537167113,0,15,"AutoFilterFieldListContextMenu:ApplyAutoFilterFieldList() - SourceIdControl string is null.")};X.prototype.zc=function(gb,Bb){if(gb=this.$.isEditMode)switch(Bb.command){case 216058793:break;case -699941697:break;
case -1494291901:gb=!0;break;default:gb=!1}return gb};X.prototype.x0=function(gb,Bb,qc){this.$.isEditMode&&((this.cm=Object(Pb.a)(590,qc))||V.ULS.sendTraceTag(537167110,0,10,"AutoFilterFieldListContextMenu:ShowDropDown() - filterInfoManager not found."),this.IY(),Gc.prototype.x0.call(this,gb,Bb,null,null,!0))};X.prototype.z2c=function(){if(!this.cm||!this.cm.Gk||1!==this.cm.Gk.length)return V.ULS.sendTraceTag(537167109,0,15,"AutoFilterFieldListContextMenu:CreateContextMenuItemList() - incorrect fields list."),
null;var gb=this.cm.Gk[0],Bb=new sc.a;Bb.add(ub.a.instance.ga(251));Bb=oc.OBc(oc.concat(Bb,oc.select(oc.asEnumerable(gb.FieldInfoDataList),function(qc){return qc.Name})),function(qc){return qc},new Dc.a);return oc.toArray(Bb)};X.prototype.fieldIndex=function(gb){if(!this.cm||!this.cm.Gk||1!==this.cm.Gk.length||!this.cm.Gk[0].FieldInfoDataList)return-1;for(var Bb=0;Bb<this.cm.Gk[0].FieldInfoDataList.length;++Bb)if(this.cm.Gk[0].FieldInfoDataList[Bb].Name===gb)return Bb;return-1};X.prototype.LJa=function(gb){return 0>
gb||!this.cm||!this.cm.Gk||1!==this.cm.Gk.length||!this.cm.Gk[0].FieldInfoDataList||this.cm.Gk[0].FieldInfoDataList.length<gb?null:this.cm.Gk[0].FieldInfoDataList[gb].Name};X.prototype.IY=function(){var gb=this,Bb=this.z2c();if(!Bb||!Bb.length)return null;for(var qc=this.Va,Nc=qc.Bc(),nd={},Vd=0;Vd<Bb.length;nd={Hfb:nd.Hfb},++Vd){var oe=Bb[Vd];nd.Hfb=0<Vd?this.fieldIndex(oe):-1;for(var qe=X.p4f+nd.Hfb.toString()+nb.a.xU,ee=null,re=this.cm.zG.m4h(0<Vd?oe:null),Ze=this.I2c(qc,re,X.p4f+nd.Hfb.toString(),
oe),mf={},Pa=0;Pa<Xa.o$c.length;mf={uPb:mf.uPb,Gfb:mf.Gfb},++Pa){var Wb=Xa.o$c[Pa],Lc=qe+Pa.toString();ee||(ee=qc.Bc());switch(Wb){case 230:ee.buttons.push(qc.Pc(223,Lc,-699941697,this.cm.zG.nmi(0<Vd?oe:null)?pc.a.s8b:pc.a.GIa,8,230,!1,null));break;case 231:ee.buttons.push(qc.Pc(224,Lc,-699941697,this.cm.zG.omi(0<Vd?oe:null)?pc.a.t8b:pc.a.HIa,8,231,!1,null));break;case 235:ee.buttons.push(qc.Pc(225,Lc,-699941697,pc.a.q8b,1,235,!1,null));break;case 99:Wb=this.LQg(oe);Lc=qc.qHa(Lc+(re?".enabled":".disabled"),
Wb,-699941697,null,"None",null,!re,void 0,!0);Lc.XR("Image16by16",8,pc.a.$1a);ee.buttons.push(Lc);break;case 95:mf.uPb=void 0;mf.Gfb=void 0;var jd=function(Ad,de){return function(){var ce=gb.Jof(Ad.Hfb);de.uPb=ce.RRe;de.Gfb=ce.isChecked;return ce}}(nd,mf)().returnValue;if(!jd)return null;Wb=this.I2c(qc,mf.Gfb&&re,Lc,mf.uPb);Lc=this.ZUe(Wb.menu,qc,Lc+nb.a.xU,jd,mf.Gfb&&re);Wb.menu.pc.push(Lc);ee.buttons.push(Wb);break;case 0:ee&&(Ze.menu.pc.push(ee),ee=null);break;default:Lc=qc.qHa(Lc,ub.a.instance.ga(Wb),
-699941697,null,"None",null,!1,void 0,!0),this.EXf(Lc,re&&94===Wb&&this.cm.zG.filter(),ub.a.instance.ga(Wb)),ee.buttons.push(Lc)}}Ze.menu.pc.push(ee);Nc.buttons.push(Ze)}Bb=qc.jq(this.menuId);Bb.pc.push(Nc);return Bb};X.prototype.ZUe=function(gb,Bb,qc,Nc,nd){for(var Vd=null,oe=0;oe<Nc.length;++oe){var qe=Nc[oe],ee=qc+oe.toString(),re=!1;switch(qe.J4b){case 1:re=nd&&this.cm.zG.Gh.IsTop10;break;case 2:re=Object(Pb.a)(va,qe);re=nd&&this.cm.zG.Gfi(re?re.Yre:0,qe.a4c);break;case 0:re=nd&&this.cm.zG.Gh.IsCustomSupportedAndNotPresent}Vd||
(Vd=Bb.Bc());if(qe.Wii)Vd&&(gb.pc.push(Vd),Vd=null);else if(qe.Cmi){var Ze=ub.a.instance.ga(qe.Oof);Ze=this.I2c(Bb,re,ee,Ze);Ze.menu.pc.push(this.ZUe(Ze.menu,Bb,ee+nb.a.xU,qe.subMenu,re));Vd.buttons.push(Ze)}else qe=ub.a.instance.ga(qe.Oof),ee=Bb.qHa(ee,qe,-699941697,null,"None",null,!1,void 0,!0),this.EXf(ee,re,qe),Vd.buttons.push(ee)}return Vd};X.prototype.EXf=function(gb,Bb,qc){Bb?gb.XR("Image16by16",8,pc.a.dua):gb.XR("None",0,null);gb.VR(qc);gb.label=qc};X.prototype.I2c=function(gb,Bb,qc,Nc){return Bb?
gb.A2c(qc,this.menuId,Nc,798637440,8,pc.a.dua):gb.Qv(qc,this.menuId,Nc,798637440)};X.prototype.fh=function(gb){return!gb||!gb.length};X.prototype.Jof=function(gb){var Bb=0>gb?0:this.cm.Gk[0].FieldInfoDataList[gb].MajorityDataTypeForField;var qc=null;gb=this.cm.zG.l4h(Bb);switch(Bb){case 0:qc=96;Bb=ja.FHj;break;case 1:qc=95;Bb=ja.fEi;break;case 2:qc=97;Bb=ja.dbh;break;default:return V.ULS.sendTraceTag(537167108,0,10,"AutoFilterFieldListContextMenu:MenuDataForDataType() - unknown data type."),{returnValue:null,
RRe:qc,isChecked:gb}}qc=ub.a.instance.ga(qc);return{returnValue:Bb,RRe:qc,isChecked:gb}};X.prototype.LQg=function(gb){!gb||this.fh(gb.trim())?gb=ub.a.instance.ga(98):gb.length>Xa.IRe?(gb=gb.substring(0,Xa.IRe),gb=String.format(ub.a.instance.mb(155),gb)):gb=String.format(ub.a.instance.mb(156),gb);return gb};Mf.Object.defineProperties(X.prototype,{uw:{configurable:!0,enumerable:!0,get:function(){return"PopulateAutoFilterFieldListContextMenu"}},sB:{configurable:!0,enumerable:!0,get:function(){return Fb.a.EKf}}});
X.kyh=Fb.a.E1g;X.YIb="AutoFilterFieldListContextMenuRoot";X.p4f="ApplyAutoFilterFieldList.";Object(ia.a)(X,"AutoFilterFieldListContextMenu",zb.a,[]);var ld=b(611),gd=b(1049),Cc=b(11),kd=b(122),Fd=b(390),rb=zb.a;Rk(wa,rb);wa.prototype.executeCommand=function(gb,Bb,qc){gb=Object(Pb.a)(ld.a,qc.eventArgs);switch(Bb.command){case -1372040782:qc=Za.g(this.$).ha.Oa.Yb;V.ULS.shipAssertTag(537167048,0,!!qc);qc&&(this.floatingObject=qc.floatingObject,this.lb=Bb.method,Bb=this.oac(gb),this.hp(Bb,!0,gb.lb));
break;case 848910589:gb&&(Bb=[gd.a.S_f],gb=new Sys.UI.Point(gb.Ca.clientX,gb.Ca.clientY),this.showFloatie(Bb,new Sys.UI.Bounds(gb.x,gb.y,0,0),2))}return tb.Task.Ua(!0)};wa.prototype.zc=function(gb,Bb,qc){switch(Bb.command){case -1372040782:return!!qc&&this.kgf(gb);case 848910589:return gb=Za.g(this.$).ha.Oa.Yb,!!qc&&!!gb&&gb.isEditing;default:return!1}};wa.prototype.kgf=function(gb){switch(gb){case 8:case 2:case 64:case 4:case 256:return!0;default:return!1}};wa.prototype.uTc=function(gb,Bb,qc){Fd.a(this.$)?
Za.g(this.$).eb.Ji||(xb.a(this.$).wQd()?qc.buttons.push(gb.nb(265)):qc.buttons.push(gb.nb(264))):(this.$.isEditMode&&3===this.lb&&!this.S9b()&&qc.buttons.push(gb.nb(101)),5!==this.floatingObject.type||kd.a.uH(this.floatingObject.xb)||this.floatingObject.xb.IsGroup||(Kb.EwaSettings.isChangeGateEnabled("OfficeVSO:5449286_ShapeTextEditContextMenu")&&this.wpd()?qc.buttons.push(gb.nb(186)):qc.buttons.push(gb.nb(147))),this.S9b()||this.wpd()||qc.buttons.push(gb.nb(146)),Kb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChangeFOZOrder",
!1)&&(this.rEh(qc),this.TFh(qc)),Kb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneData",!1)&&0===this.floatingObject.type&&qc.buttons.push(gb.nb(287)),Kb.EwaSettings.ma(167)&&0===this.floatingObject.type&&qc.buttons.push(gb.nb(249)),5===this.floatingObject.type&&Za.g(this.$).ha.Oa.Yb.h5()&&this.$.uka&&this.$.Rga&&qc.buttons.push(gb.nb(273)))};wa.prototype.NJa=function(gb){var Bb=[];if(Fd.a(this.$))return Bb;3===gb?(gb=!!this.$.Jf.get(5)&&this.floatingObject.yTd(),this.S9b()||
(this.$.isEditMode?(gb&&Bb.push(gd.a.oBh),5===Za.g(this.$).ha.Oa.nC.floatingObject.type&&Bb.push(gd.a.cuj)):gb&&Bb.push(gd.a.copy)),Bb.push(gd.a.pBh)):2===gb&&(Kb.EwaSettings.isChangeGateEnabled("OfficeVSO:4840604_JsCrashInGetFloatieGroupsForSelection")?Za.g(this.$).ha.Oa.Yb&&this.MZe(Za.g(this.$).ha.Oa.Yb,Bb):this.MZe(Za.g(this.$).ha.Oa.nC,Bb));return Bb};wa.prototype.IY=function(){var gb=this.Va,Bb=gb.jq(this.menuId),qc=Fd.a(this.$);if(this.$.isEditMode){var Nc=gb.Bc();this.uTc(gb,Bb,Nc);Bb.pc.push(Nc)}this.$.Jf.get(5)&&
this.floatingObject.yTd()&&!this.S9b()&&!qc&&(Nc=gb.Bc(),this.pAg(gb,Nc),Bb.pc.push(Nc));(Nc=this.$.va.pa)&&Nc.Md&&(Nc=Nc.Md.Qx||Nc.Md.bK,!Kb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)||0!==this.floatingObject.type||this.$.ea.isNamedObjectViewMode||qc||this.$.isMobileMode||Nc||(qc=gb.Bc(),this.jCg(gb,qc),Bb.pc.push(qc)));return Bb};wa.prototype.oac=function(gb){var Bb=Za.g(this.$).ha.Oa.Yb;gb=gb&&1!==gb.lb&&gb.clientPoint?gb.clientPoint:Sys.UI.DomElement.getLocation(Bb.domElement);
var qc=this.$.domElement,Nc=Za.g(this.$).rtl;(Bb=Cc.HelperMethods.zC(Bb.ag.domElement,qc,Nc))?(gb.y=Math.max(gb.y,Bb.y),gb.x=Math.max(gb.x,Bb.x)):V.ULS.sendTraceTag(537167047,5,15,"FloatingObjectContextMenu.GetContextMenuClientPoint sheetContentDivLocation is null if the offset parent is null. IsShuttingdown : {0}",Ha.AFrameworkApplication.Ag);return gb};wa.prototype.wpd=function(){var gb=Za.g(this.$).ha.Oa.Yb;return!!gb&&gb.isEditing};wa.prototype.pAg=function(gb,Bb){if(this.$.isEditMode){Bb.buttons.push(gb.nb(42));
Bb.buttons.push(gb.nb(43));var qc=this.$.da.za(254,!0);(qc&&2===qc.aBb()||Kb.EwaSettings.isChangeGateEnabled("OfficeVSO:5449286_ShapeTextEditContextMenu")&&this.wpd())&&Bb.buttons.push(gb.nb(44))}else Bb.buttons.push(gb.nb(43))};wa.prototype.jCg=function(gb,Bb){Bb.buttons.push(gb.nb(274))};wa.prototype.S9b=function(){return Kb.EwaSettings.ma(467)&&!!Za.g(this.$).ha.Oa.xo};wa.prototype.MZe=function(gb,Bb){5===gb.floatingObject.type?Kb.EwaSettings.isChangeGateEnabled("OfficeVSO:5449286_ShapeTextEditContextMenu")&&
gb.isEditing?Bb.push(gd.a.S_f):Bb.push(gd.a.Ztj):Bb.push(zb.a.XSe)};wa.prototype.rEh=function(gb){var Bb=this.Va.Bc();Bb.buttons.push(this.Va.nb(282));Bb.buttons.push(this.Va.nb(281));var qc=this.Va.Qv("BringToFront","BringToFrontMenuId",ub.a.instance.ga(821),-1777747317);qc.menu.pc.push(Bb);gb.buttons.push(qc)};wa.prototype.TFh=function(gb){var Bb=this.Va.Bc();Bb.buttons.push(this.Va.nb(284));Bb.buttons.push(this.Va.nb(283));var qc=this.Va.Qv("SendToBack","SendToBackMenuId",ub.a.instance.ga(822),
-1777747317);qc.menu.pc.push(Bb);gb.buttons.push(qc)};Mf.Object.defineProperties(wa.prototype,{uw:{configurable:!0,enumerable:!0,get:function(){return"PopulateFloatingObjectContextMenu"}},sB:{configurable:!0,enumerable:!0,get:function(){return Fb.a.MKf}}});Object(ia.a)(wa,"FloatingObjectContextMenu",zb.a,[]);var Kd=b(1E3),Qd=b(103),ve=b(620),Be=b(565),Ie=Fb.a.H1g;Rk(ea,wa);ea.prototype.executeCommand=function(gb,Bb,qc){var Nc=this.$;this.lb=Bb.method;Bb=qc[ea.a_c];if(!(gb&68)){if(!Bb){if(8===gb)Bb=
Be.a(Nc).Oc;else{var nd=Za.g(Nc).ha.Oa.Yb;if(null===nd||void 0===nd?0:nd.floatingObject)Bb=nd.floatingObject.Oc}if(!Bb)return tb.Task.Ua(!0)}this.isPivotChart=!!(Bb.Attributes&4)}if(this.isPivotChart||Nc.isEditMode)if(this.refresh=this.$Y=this.Iva=this.yAa=!1,nd=Za.g(this.$).ha.Oa.Yb,V.ULS.shipAssertTag(537167107,0,!!nd),nd){this.floatingObject=nd.floatingObject;nd=ve.a(Nc);if(null===nd||void 0===nd?0:nd.TPd)this.yAa=nd=Qd.f(Nc.mg),this.Iva=!nd;nd=Nc.hc;this.$Y=!!Kd.a(Nc)&&!!Bb&&!!(Bb.Attributes&
512)&&!(gb&8)&&nd.x2(32768);nd.allowManualDataRefresh&&nd.allowInteractivity&&(this.refresh=!0);gb=this.oac(Object(Pb.a)(ld.a,qc.eventArgs));this.hp(gb,!0)}return tb.Task.Ua(!0)};ea.prototype.zc=function(gb,Bb,qc){return-149612405===Bb.command&&!!qc&&this.kgf(gb)};ea.prototype.uTc=function(gb,Bb,qc){this.isPivotChart&&(this.refresh&&qc.buttons.push(gb.nb(100)),this.$Y&&qc.buttons.push(gb.nb(99)),this.yAa?qc.buttons.push(gb.nb(59)):this.Iva&&qc.buttons.push(gb.nb(58)));wa.prototype.uTc.call(this,gb,
Bb,qc)};Mf.Object.defineProperties(ea.prototype,{uw:{configurable:!0,enumerable:!0,get:function(){return"PopulateChartContextMenu"}},sB:{configurable:!0,enumerable:!0,get:function(){return Fb.a.GKf}}});Mf.Object.defineProperties(ea,{a_c:{configurable:!0,enumerable:!0,get:function(){return"chartMetaData"}}});Object(ia.a)(ea,"ChartContextMenu",wa,[]);var se=b(12),Se=Fb.a.J1g,Le=zb.a;Rk(ca,Le);ca.prototype.executeCommand=function(gb,Bb,qc){gb=Bb.command;switch(gb){case 330754562:Bb=qc.domElement;this.isOlap=
qc.isOlap;this.kL=qc.versionkey;this.co=qc.fieldItem;this.PZ=qc.isChart;this.qV=qc.isPpm;this.ATd="supportsImplicitMeasures"in qc?qc.supportsImplicitMeasures:!1;Za.g(this.$).wo(!0);Bb=se.DOMElementExtensions.getBounds(Bb);Bb=new Sys.UI.Point(Bb.x+Bb.width,Bb.y+Bb.height/2);"isKeyboardInput"in qc&&qc.isKeyboardInput?this.hp(Bb,!1,1):this.hp(Bb,!1);break;case 926905850:this.ATd&&this.co&&5===this.co.TypeTag&&!this.co.IsCollapsible&&V.ULS.sendTraceTag(537167057,0,50,"Add implicit measurement from field list.");
ve.a(this.$).AJ(this.co,8,-1,this.kL,Bb);break;case -67292059:ve.a(this.$).AJ(this.co,1,-1,this.kL,Bb);break;case 745182485:ve.a(this.$).AJ(this.co,2,-1,this.kL,Bb);break;case 359279088:ve.a(this.$).AJ(this.co,4,-1,this.kL,Bb);break;case 547535945:ve.a(this.$).o4i(this.co);break;default:return Ab.a(gb)}return tb.Task.Ua(!0)};ca.prototype.zc=function(gb,Bb,qc){gb=!1;switch(Bb.command){case 330754562:gb=!!qc;break;case 926905850:case -67292059:case 745182485:case 359279088:case 547535945:gb=!0}return gb};
ca.prototype.IY=function(){var gb=this.Va.jq(this.menuId);this.PYi(gb);this.PZ||this.isOlap||this.OYi(gb);return gb};ca.prototype.PYi=function(gb){var Bb=this.Va,qc=Bb.Bc(),Nc=!1;Kb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ImplicitMeasureSupport",!1)&&(Nc=this.isOlap&&!this.qV&&this.ATd&&5===this.co.TypeTag&&!this.co.IsCollapsible);3!==this.co.TypeTag&&37!==this.co.TypeTag||this.co.IsSet?17===this.co.TypeTag||this.qV?(qc.buttons.push(Bb.nb(79)),qc.buttons.push(Bb.nb(this.PZ?91:80)),
qc.buttons.push(Bb.nb(this.PZ?92:81)),qc.buttons.push(Bb.nb(82))):13===this.co.TypeTag||this.co.IsSet?(qc.buttons.push(Bb.nb(83)),qc.buttons.push(Bb.nb(this.PZ?91:80)),qc.buttons.push(Bb.nb(this.PZ?92:81)),qc.buttons.push(Bb.nb(86))):(qc.buttons.push(Bb.nb(79)),qc.buttons.push(Bb.nb(this.PZ?91:80)),qc.buttons.push(Bb.nb(this.PZ?92:81)),qc.buttons.push(Bb.nb(Nc?82:86))):(qc.buttons.push(Bb.nb(83)),qc.buttons.push(Bb.nb(this.PZ?93:84)),qc.buttons.push(Bb.nb(this.PZ?94:85)),qc.buttons.push(Bb.nb(82)));
gb.pc.push(qc)};ca.prototype.OYi=function(gb){var Bb=this.Va.Bc();Bb.buttons.push(this.Va.nb(78));gb.pc.push(Bb)};Mf.Object.defineProperties(ca.prototype,{uw:{configurable:!0,enumerable:!0,get:function(){return"PopulateFieldListContextMenu"}},sB:{configurable:!0,enumerable:!0,get:function(){return Fb.a.FFd}}});Object(ia.a)(ca,"FieldListContextMenu",zb.a,[]);var rf=b(440),af=b(64);fa.prototype.get=function(gb,Bb,qc){var Nc=this.n$f(gb,"PivotFilterContextMenuCache.Get");return Nc&&this.cN[Nc]?this.cN[Nc][fa.jed(Bb,
this.$,gb,qc)]:null};fa.prototype.set=function(gb,Bb,qc,Nc){var nd=this.n$f(gb,"PivotFilterContextMenuCache.Set");nd&&(this.cN[nd]||(this.cN[nd]={}),this.cN[nd][fa.jed(Bb,this.$,gb,Nc)]=qc)};fa.prototype.g7b=function(gb){gb in this.cN&&this.cN[gb]&&(this.cN[gb]=null)};fa.prototype.n$f=function(gb,Bb){return af.f(this.$.pa)?this.$.activeItemName:(gb=this.tMj(gb,Bb))?gb.Kd:null};fa.prototype.tMj=function(gb,Bb){gb=ec.C(gb);gb=Za.g(this.$).Ea.Zua(gb,this.$.activeItemName);V.ULS.shipAssertTag(537167008,
0,!!gb,"PivotFilterContextMenuBase.TryGetBlockModelProxyFromCell: Can't query the menuCache as block wasn't found in the BlockManager (returned null). Called from: {0}",Bb);return gb};fa.jed=function(gb,Bb,qc,Nc){return Kb.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")&&0===Nc?Bb.pa.index+"_"+gb.id+"_"+qc.FirstRow.toString()+"_"+qc.FirstColumn.toString():Bb.pa.index+"_"+gb.id};Object(ia.a)(fa,"PivotFilterContextMenuCache",null,[]);Object(ia.a)(R,"ShowPivotFilterData",null,[]);
var xe=b(492),Td=b(1495),Bc=b(53),qd=Fb.a.KAe,Jd=zb.a;Rk(ka,Jd);ka.prototype.q9c=function(gb,Bb){var qc=this,Nc=gb.rawEvent,nd=gb.cell,Vd=gb.requiresConfirmation;xe.a(this.$).rx(Vd,function(oe){if(oe){oe=Nc?new Sys.UI.DomEvent(Nc):null;qc.pivotData=new R;qc.pivotData.pivotName=gb.pivotName;qc.pivotData.dataSourceIndex=gb.dataSourceIndex;qc.pivotData.cell=nd;qc.pivotData.ro=gb.optionalPivotMenuAnchorParameter;if(qc.pivotData.ro&&0<qc.pivotData.ro.AnchorType){qc.Slc=gb.objectId;qc.yDb=gb.objectVersion;
var qe=qc.pivotData.ro.AnchorType;if(4===qe||5===qe||6===qe||11===qe||9===qe||10===qe||8===qe)qc.$lb=gb.location}else qc.Oxd=qc.Slc=null,qc.Pxd=qc.yDb=-1;Za.g(qc.$).wo(!0);qc.$.Lj(nd);qc.x0(oe,oe?oe.target:gb.domElement,qc.pivotData,Bb,qc.JLa())}});return!0};ka.prototype.x0=function(gb,Bb,qc,Nc){var nd=this;if(Object(rf.a)(R,qc)){this.pivotData=qc;this.U4b=Bb;this.gif=gb;this.S1b=this.pivotData.ro?this.pivotData.ro.AnchorValue1:-1;this.iY=this.pivotData.ro?this.pivotData.ro.AnchorType:0;var Vd=!1,
oe=null;oe=ka.cN.get(this.pivotData.cell,Bb,this.iY);Vd=!!oe;var qe=!0;switch(this.iY){case 4:case 5:case 6:this.nza=new Sys.UI.Point(this.$lb.x,this.$lb.y);qe=!1;break;case 7:var ee=Sys.UI.DomElement.getBounds(Bb);qe=ee.x+(0<=ee.x?0:ee.width);ee=ee.y+(0<=ee.y?0:ee.height);this.nza=new Sys.UI.Point(0<=qe?qe:0,0<=ee?ee:0);qe=!1;break;case 8:case 10:case 9:case 11:this.nza=new Sys.UI.Point(this.$lb.x,this.$lb.y);break;default:this.nza=null}Vd&&this.Slc===this.Oxd&&this.yDb===this.Pxd&&this.S1b===this.Ewe&&
this.iY===this.Joe?(V.ULS.sendTraceTag(537167042,0,50,"PivotFilterContextMenuBase.ShowDropDown: rendering pivot filter context menu from menu cache"),this.urb=oe,this.nza?this.hp(this.nza,this.JLa()):this.Ox?(!Kb.EwaSettings.isChangeGateEnabled("OfficeVSO:6053383_EnsureContextMenuCellInView")||zb.a.kmd(this.$,this.pivotData.cell))&&this.hp(zb.a.xcd(this.$,this.pivotData.cell,!1),this.JLa()):Jd.prototype.x0.call(this,gb,Bb,qc,Nc,this.JLa())):1!==ka.wNh(Bb)&&(qe&&(Bb.parentNode.menuFetchStates=1,this.Doj(Bb),
this.mXf(!0)),this.$.userOperationManager.Sb(new Cb.a(126,0,function(re,Ze,mf){var Pa=nd.$;return ab.q(Pa.oa.xa,nd.pivotData.cell,nd.pivotData.dataSourceIndex,nd.pivotData.pivotName,Pa.domElement.id,Pa.isChromeRtl,Pa.workbookContext.NovMode,Aa.b(re,nd.bLi),Aa.a(Ze,nd.aLi),mf,Bb,nd.pivotData.ro)},16),Nc))}};ka.prototype.QCd=function(gb){Array.addRange(gb.MenuSectionList,this.urb)};ka.prototype.Tud=function(gb,Bb){gb.parentNode.menuFetchStates=2;this.mXf(!1);if(Bb){if(this.U4b!==gb||this.uzi())this.hp(this.nza,
this.JLa());else if(this.Ox&&!this.nza){if(Kb.EwaSettings.isChangeGateEnabled("OfficeVSO:6053383_EnsureContextMenuCellInView")&&!zb.a.kmd(this.$,this.pivotData.cell))return;this.hp(zb.a.xcd(this.$,this.pivotData.cell,!1),this.JLa())}else Jd.prototype.x0.call(this,this.gif,gb,null,null,this.JLa());this.Oxd=this.Slc;this.Pxd=this.yDb;this.Joe=this.iY;this.Ewe=this.S1b}};ka.prototype.JLa=function(){return 8!==this.iY&&9!==this.iY&&10!==this.iY&&11!==this.iY};ka.prototype.uzi=function(){switch(this.pivotData.ro?
this.pivotData.ro.AnchorType:0){case 1:case 2:case 3:case 4:case 5:case 6:case 7:return!0;default:return!1}};ka.prototype.mXf=function(gb){var Bb=this.U4b;if(Bb){if(Kb.EwaSettings.isChangeGateEnabled("OfficeVSO:5041973_FixDropdownImageDisappearing")){var qc=se.DOMElementExtensions.jZ(Bb,"ewaprevsrc","");qc=!!qc&&"null"!==qc}else qc=!!se.DOMElementExtensions.jZ(Bb,"ewaprevsrc","");gb&&qc||!gb&&!qc||(gb?(Bb.setAttribute("ewaprevsrc",Bb.src),Bb.src=Bc.a.current.Ro(98)):(gb=se.DOMElementExtensions.jZ(Bb,
"ewaprevsrc",""),Bb.src=gb,Bb.setAttribute("ewaprevsrc",null)))}};ka.prototype.Doj=function(gb){this.U4b=gb};ka.wNh=function(gb){var Bb=gb.parentNode.menuFetchStates;void 0===Bb&&(gb.parentNode.menuFetchStates=0);return Bb};ka.cN=null;Object(ia.a)(ka,"PivotFilterContextMenuBase",zb.a,[]);var ad="FieldList"+Fb.a.KAe;Rk(P,ka);P.prototype.executeCommand=function(gb,Bb,qc){return this.q9c(qc,Bb)?tb.Task.Ua(!0):Ab.a(Bb.command)};P.prototype.zc=function(gb,Bb,qc){return-1065117584===Bb.command&&!!qc};Mf.Object.defineProperties(P.prototype,
{uw:{configurable:!0,enumerable:!0,get:function(){return"PopulateFieldListPivotMenu"}},sB:{configurable:!0,enumerable:!0,get:function(){return Fb.a.KKf}}});Object(ia.a)(P,"FieldListPivotContextMenu",ka,[]);var Yd=b(276),pe=b(29),Wd=b(89),bf=b(939);Object(ia.a)(Q,"PivotValueFieldSettingsApplyData",null,[]);C.Jah="dataFieldCustomLabel";C.TEe="dataFieldSourceLabel";C.GRd="showValueAsSelect";C.ERd="showValueAsBaseFieldSelect";C.FRd="showValueAsBaseItemSelect";C.QYd="valueFieldsSettingsFieldName";C.veg=
"valueFieldSettingTabs";Object(ia.a)(C,"CssElementIds",null,[]);var ke=b(118);Object(ia.a)(M,"MacroRecorderPivotFieldShowValueAsParameters",null,[]);N.prototype.getActiveCell=function(){return this.activeCell};Object(ia.a)(N,"MacroRecorderPivotValueFieldSettingAppliedPayload",null,[438]);var cf=b(244);Object(ia.a)(K,"PivotValueFieldShowValueAsApplyData",null,[]);var Pe=b(938),nc=b(42),Da="<div id='showValueAsControlBody'><label for='"+C.GRd+"' class='"+ke.a.Cn+" valueFielsSettingsControlTitle'>{0}</label><div><select size=1 id='"+
C.GRd+"' class='"+ke.a.vC+"'></select></div><div class='showValueAsControlSelectRegion'><label for='"+C.ERd+"'>{1}</label><div><select size=6 id='"+C.ERd+"' class='"+ke.a.vC+"'></select></div></div><div class='showValueAsControlSelectRegionSeparator'></div><div class='showValueAsControlSelectRegion'><label for='"+C.FRd+"'>{2}</label><div><select size=6 id='"+C.FRd+"' class='"+ke.a.vC+"'></select></div></div></div>",Sb=cf.a;Rk(H,Sb);H.prototype.Aja=function(){return this.isVisible};H.prototype.sna=
function(gb){return this.isVisible=gb};H.prototype.setFocus=function(){se.DOMElementExtensions.setFocus(this.m3.Rp)};H.prototype.render=function(gb){gb.appendChild(this.domElement)};H.prototype.dispose=function(){Wd.a.oc([this.m3,this.KT,this.qP,this.y5b,this.l0b]);Sb.prototype.dispose.call(this)};H.prototype.krj=function(gb){Wd.a.oc([this.y5b,this.l0b]);this.m3.clear();for(var Bb=bk(gb.DataFormatTypes),qc=Bb.next();!qc.done;qc=Bb.next())qc=qc.value,this.m3.ML(H.HLh(qc),qc.toString(),qc===gb.SelectedDataFormat);
this.y5b=this.je.Sd(this.m3.domElement);this.y5b.ka("change",this.Ouf);this.KT.clear();Bb=bk(gb.BaseFieldList);for(qc=Bb.next();!qc.done;qc=Bb.next())qc=qc.value,this.KT.ML(qc.DisplayString,qc.Id.toString(),qc.Id===gb.SelectedBaseField);this.l0b=this.je.Sd(this.m3.domElement);this.l0b.ka("change",this.WFi);this.gF=this.Mha.orb(this.qP.Rp.parentNode,1E3,null,"",739);this.Ouf(null)};H.prototype.DQ=function(gb){this.m3.DQ(gb);this.KT.DQ(gb);this.qP.DQ(gb)};H.prototype.Uja=function(){this.domElement.innerHTML=
String.format(Da,ub.a.instance.ga(1097),ub.a.instance.ga(1098),ub.a.instance.ga(1099));this.w3d=new Pe.a(se.DOMElementExtensions.getElementById(this.domElement,C.GRd),!1);this.f1d=new Pe.a(se.DOMElementExtensions.getElementById(this.domElement,C.ERd),!1);this.g1d=new Pe.a(se.DOMElementExtensions.getElementById(this.domElement,C.FRd),!1)};H.prototype.$Tg=function(gb){return this.qji||!H.uaf(gb)&&!H.vaf(gb)?!0:!!this.KT.count};H.prototype.getValueFieldSettingsShowValueAsBaseItemsInfo=function(){var gb=
this;this.$.userOperationManager.Sb(new Cb.a(108,0,function(Bb,qc,Nc){var nd=gb.$.oa.xa,Vd=parseInt(gb.KT.fe.value,10);Bb=Aa.b.call(null,Bb,gb.YLi);var oe=ab.M(nd,gb.cell,gb.externalSourceIndex,gb.ro);oe.selectedBaseField=Vd;return ab.g(nd,"GetPivotValueFieldSettingsShowValueAsBaseItems",oe,Bb,qc,Nc,null,4)},16),this.Ed)};H.prototype.Mjf=function(){this.qP.clear();this.KT.fe&&(this.gF.fSa(),this.qP.Rp.style.overflowY="hidden",this.getValueFieldSettingsShowValueAsBaseItemsInfo())};H.prototype.RNb=
function(gb){var Bb=document.getElementById("WACDialogActionButton");this.KRj&&Bb&&(Bb.disabled=gb)};H.HLh=function(gb){switch(gb){case 0:return ub.a.instance.ga(1100);case 1:return ub.a.instance.ga(1101);case 2:return ub.a.instance.ga(1102);case 3:return ub.a.instance.ga(1103);case 4:return ub.a.instance.ga(1104);case 5:return ub.a.instance.ga(1105);case 6:return ub.a.instance.ga(1106);case 7:return ub.a.instance.ga(1107);case 8:return ub.a.instance.ga(1109);case 9:return ub.a.instance.ga(1110);
case 10:return ub.a.instance.ga(1111);case 11:return ub.a.instance.ga(1112);case 12:return ub.a.instance.ga(1113);case 13:return ub.a.instance.ga(1114);case 14:return ub.a.instance.ga(1115);default:return""}};H.uaf=function(gb){return 11===gb||12===gb||14===gb||13===gb||4===gb};H.vaf=function(gb){return 1===gb||3===gb||2===gb};Mf.Object.defineProperties(H.prototype,{title:{configurable:!0,enumerable:!0,get:function(){return ub.a.instance.ga(1096)}},Gvb:{configurable:!0,enumerable:!0,get:function(){var gb=
this.m3.fe?parseInt(this.m3.fe.value,10):-1,Bb=this.KT.fe?parseInt(this.KT.fe.value,10):-1,qc=this.qP.fe?parseInt(this.qP.fe.value,10):-1;return Object(sa.a)(new K,{SelectedDataFormat:0<=gb?gb:-1,SelectedBaseField:Bb,SelectedBaseItem:qc})}},KT:{configurable:!0,enumerable:!0,get:function(){return this.f1d}},qP:{configurable:!0,enumerable:!0,get:function(){return this.g1d}},m3:{configurable:!0,enumerable:!0,get:function(){return this.w3d}}});Object(ia.a)(H,"ShowValueAsControl",cf.a,[550,3]);Object(ia.a)(J,
"PivotValueFieldSummarizeValueByApplyData",null,[]);var hb="<div id='summarizeValuesByControlBody'><label class='"+(ke.a.Cn+" valueFielsSettingsControlTitle' for='pivotDataFieldSelect'>{0}</label><div id='pivotDataFieldSelectDescription' class='")+(ke.a.Cn+" summarizeValuesByControlDescription'>{1}</div><div><select class='")+(ke.a.vC+"' size=6 id='pivotDataFieldSelect' style='width: 100%' "+Fb.a.xG+"='pivotDataFieldSelectDescription'></select></div></div>"),Xb=cf.a;Rk(U,Xb);U.prototype.Aja=function(){return this.isVisible};
U.prototype.sna=function(gb){return this.isVisible=gb};U.prototype.setFocus=function(){se.DOMElementExtensions.setFocus(this.Zk.Rp)};U.prototype.render=function(gb){gb.appendChild(this.domElement)};U.prototype.dispose=function(){Wd.a.Ia(this.Zk);Xb.prototype.dispose.call(this)};U.prototype.focus=function(){se.DOMElementExtensions.setFocus(this.Zk.Rp)};U.prototype.jrj=function(gb){this.Zk.CSd();for(var Bb=bk(gb.AggregationTypes),qc=Bb.next();!qc.done;qc=Bb.next()){qc=qc.value;var Nc=qc===gb.SelectedAggregation;
this.Zk.sTc(U.jHh(qc),qc.toString(),Nc,"")}this.Zk.c7c();this.Zk.Rp.disabled=gb.AggregationsDisabled};U.prototype.Agj=function(){this.Zk.Bgj()};U.prototype.Uja=function(){this.domElement.innerHTML=String.format(hb,ub.a.instance.ga(1080),ub.a.instance.ga(1081));this.zce=new Pe.a(se.DOMElementExtensions.getElementById(this.domElement,U.HFf),!1)};U.jHh=function(gb){switch(gb){case 0:return ub.a.instance.ga(1083);case 1:return ub.a.instance.ga(1084);case 2:return ub.a.instance.ga(1085);case 3:return ub.a.instance.ga(1086);
case 4:return ub.a.instance.ga(1087);case 5:return ub.a.instance.ga(1088);case 6:return ub.a.instance.ga(1089);case 7:return ub.a.instance.ga(1090);case 8:return ub.a.instance.ga(1091);case 9:return ub.a.instance.ga(1092);case 10:return ub.a.instance.ga(1093);case 11:return ub.a.instance.ga(1094);default:return""}};Mf.Object.defineProperties(U.prototype,{Gvb:{configurable:!0,enumerable:!0,get:function(){var gb=this.Zk.fe?parseInt(this.Zk.fe.value,10):-1;return Object(sa.a)(new J,{Aggregation:0<=gb?
gb:-1})}},title:{configurable:!0,enumerable:!0,get:function(){return ub.a.instance.ga(1095)}},enabled:{configurable:!0,enumerable:!0,get:function(){return!this.Zk.Rp.disabled},set:function(gb){this.Zk.Rp.disabled=!gb}},Zk:{configurable:!0,enumerable:!0,get:function(){return this.zce}}});U.HFf="pivotDataFieldSelect";Object(ia.a)(U,"SummarizeValuesByControl",cf.a,[550,3]);var jc=b(218),Wc=b(498),fd=b(1440),Tc=bf.a;Rk(O,Tc);O.prototype.dispose=function(){this.n4c=this.Jrb=this.QRa=this.XQc=null;Wd.a.Ia(this.Afa);
this.Afa=null;Tc.prototype.dispose.call(this)};O.prototype.initialize=function(){var gb="<div id='"+C.TEe+"' class='"+ke.a.Cn+"'></div><div id='"+C.Jah+"' class='"+ke.a.Cn+"'><label for='"+C.QYd+"'>{0}</label><input type='text' id='"+C.QYd+"' value='{1}' class='"+ke.a.vC+" UIFont' /></div><div id='"+C.veg+"'></div>";gb=String.format(gb,ub.a.instance.ga(1079),pe.a.zg(this.ueg));this.Gb.innerHTML=gb;this.Ae||(this.n2(),this.Dl());this.$he=[-103190598];this.RZh();Tc.prototype.initialize.call(this)};
O.prototype.close=function(gb){1===gb&&(this.O1f=!1);Tc.prototype.close.call(this,gb)};O.prototype.UGe=function(gb){this.KQ=gb;this.domElement.disabled=gb;for(var Bb=["input","option","select"],qc=0,Nc=Bb.length;qc<Nc;++qc)for(var nd=this.domElement.getElementsByTagName(Bb[qc]),Vd=0;Vd<nd.length;++Vd)nd[Vd].disabled=gb};O.prototype.Dl=function(){this.Jrb=document.getElementById(C.QYd);this.n4c=se.DOMElementExtensions.getElementById(this.Gb,C.TEe);var gb=se.DOMElementExtensions.getElementById(this.Gb,
C.veg);this.XQc=new U(document.createElement("div"));this.QRa=new H(document.createElement("div"),this.$,this.cell,this.ro,this.externalSourceIndex,this.Ed,this.Mha,!this.isOlap);var Bb;this.Afa=new fd.a(gb,(Bb=new sc.a,Bb.add(this.tSa),Bb.add(this.QRa),Bb));this.Afa.bQf()};O.prototype.bDd=function(){var gb=new O(this.cell,this.ro,this.externalSourceIndex,this.ueg,this.$,this.Ed,this.Mha,this.isOlap,this.qV);gb.initialize();gb.gf()};O.prototype.ifb=function(){var gb=new Wc.a;if(!this.O1f)return gb.isValid=
!0,gb;this.Jrb.value.length?gb.isValid=!0:(this.UGe(!0),gb.error=Qa.a.Xc(1,0,754,769,0,1783218700,"PivotTableValueFieldNoBlank"),this.KQ=!0,this.Ae||(this.Oy.disabled=!0),gb.isValid=!1);return gb};O.prototype.d4e=function(){this.KQ=!1;this.Ae||(this.Oy.disabled=!1);this.UGe(!1)};O.prototype.gya=function(gb){var Bb=new cb.a(2105621672,0,this.$.Jc,30,null);this.$.Ka.Kb(Bb);this.uW(5,gb.lb,"Number Format");return!0};O.prototype.pn=function(){this.fBa=String.format(ub.a.instance.mb(61),null);Tc.prototype.pn.call(this)};
O.prototype.setFocus=function(){if(this.Ae){var gb=se.DOMElementExtensions.getElementById(this.Gb,U.HFf);jc.a.jAc(gb)}else this.Afa.setFocus()};O.prototype.Zi=function(){var gb=this,Bb=this.QRa.Gvb,qc=new M(Bb.SelectedDataFormat,Bb.SelectedBaseField,Bb.SelectedBaseItem);return function(){return new N(gb.externalSourceIndex,gb.cell,gb.Jrb.value,gb.tSa.Gvb.Aggregation,qc)}};O.prototype.Jy=function(){var gb=this,Bb=Object(sa.a)(new Q,{PivotValueFieldSummarizeValueByApplyData:this.tSa.Gvb,PivotValueFieldShowValueAsApplyData:this.QRa.Gvb,
PivotValueFieldTitle:this.Jrb.value});return function(qc,Nc,nd){var Vd=gb.$.oa.xa;qc=Aa.b(qc,gb.LFi);var oe=ab.M(Vd,gb.cell,gb.externalSourceIndex,gb.ro);oe.pivotValueFieldSettingsApplyData=Bb;return ab.g(Vd,"ApplyPivotValueFieldSettings",oe,qc,Nc,nd,null,0)}};O.prototype.DQ=function(gb){var Bb=this;this.$.da.Za(40,function(){Bb.QRa.DQ(gb)})};O.prototype.RZh=function(){var gb=this;this.$.userOperationManager.Sb(new Cb.a(123,0,function(Bb,qc,Nc){var nd=gb.$.oa.xa;Bb=Aa.b.call(null,Bb,gb.XLi);var Vd=
ab.M(nd,gb.cell,gb.externalSourceIndex,gb.ro);return ab.g(nd,"GetPivotValueFieldSettingsInitial",Vd,Bb,qc,Nc,null,4)},16),this.Ed)};Mf.Object.defineProperties(O.prototype,{nc:{configurable:!0,enumerable:!0,get:function(){return"ValueFieldSettingsDialog"}},sea:{configurable:!0,enumerable:!0,get:function(){return this.$he}},UCb:{configurable:!0,enumerable:!0,get:function(){return this.Afa}},tSa:{configurable:!0,enumerable:!0,get:function(){return this.XQc}},sv:{configurable:!0,enumerable:!0,get:function(){return 560}}});
Object(ia.a)(O,"ValueFieldSettingsDialog",bf.a,[]);var td=Fb.a.K1g,Tb=zb.a;Rk(T,Tb);T.prototype.executeCommand=function(gb,Bb,qc,Nc){var nd=this;gb=Bb.command;switch(gb){case -1453503574:Nc=qc.domElement;this.co=qc.fieldItem;this.$Zd=qc.zoneCount;this.aSa=qc.sourceAxis;this.Nxc=qc.sourceAxisPos;this.ro=qc.optionalPivotMenuAnchorParameter;this.kL=qc.versionkey;this.isOlap=qc.isOlap;this.qV=qc.isPpm;this.m2a="fieldItemsupportsImplicitMeasures"in qc?qc.fieldItemsupportsImplicitMeasures:!1;this.cell=
qc.cell;this.externalSourceIndex=qc.externalSourceIndex;Za.g(this.$).wo(!0);Nc=se.DOMElementExtensions.getBounds(Nc);gb=new Sys.UI.Point(Nc.x,Nc.y+Nc.height);this.$.isChromeRtl&&(gb.x+=Nc.width);"isKeyboardInput"in qc&&qc.isKeyboardInput?this.hp(gb,!1,1):this.hp(gb,!1);break;case 495005930:break;case -1170196828:ve.a(this.$).AJ(this.co,this.aSa,this.Nxc-1,this.kL,Bb);break;case -889576107:ve.a(this.$).AJ(this.co,this.aSa,this.Nxc+2,this.kL,Bb);break;case 2033235475:ve.a(this.$).AJ(this.co,this.aSa,
this.$Zd,this.kL,Bb);break;case 389774337:ve.a(this.$).AJ(this.co,this.aSa,0,this.kL,Bb);break;case -96230454:ve.a(this.$).AJ(this.co,4,-1,this.kL,Bb);break;case 74086617:ve.a(this.$).AJ(this.co,1,-1,this.kL,Bb);break;case 1529312473:ve.a(this.$).AJ(this.co,2,-1,this.kL,Bb);break;case 563292088:this.m2a&&V.ULS.sendTraceTag(537167056,0,50,"Move a field into values area as implicit measurement.");ve.a(this.$).AJ(this.co,8,-1,this.kL,Bb);break;case -1092351914:ve.a(this.$).AJ(this.co,0,-1,this.kL,Bb);
break;case -2141589616:var Vd=ya.GetServiceTaskFactory.Ra(this.$.da,12,477,Nc.tja());return Z.TaskExtensions.Aa(Vd,function(){(new O(nd.cell,nd.ro,nd.externalSourceIndex,nd.co.Name,nd.$,Bb,Vd.result,nd.isOlap,nd.qV)).initialize()},this.la);default:return Ab.a(gb)}return tb.Task.Ua(!0)};T.prototype.zc=function(gb,Bb,qc){gb=!1;switch(Bb.command){case -1453503574:gb=!!qc;break;case 495005930:case -1170196828:case -889576107:case 2033235475:case 389774337:case -96230454:case 74086617:case 1529312473:case 563292088:case -1092351914:case -2141589616:gb=
!0}return gb};T.prototype.IY=function(){var gb=this.Va.jq(this.menuId);this.WYi(gb,this.Nxc,this.$Zd);this.XYi(gb,this.aSa);this.YYi(gb);8===this.aSa&&this.UYi(gb);return gb};T.prototype.WYi=function(gb,Bb,qc){var Nc=this.Va,nd=Nc.Bc();Bb||Bb!==qc-1?!Bb&&Bb<qc-1?(nd.buttons.push(Nc.nb(64)),nd.buttons.push(Nc.nb(61)),nd.buttons.push(Nc.nb(66)),nd.buttons.push(Nc.nb(63))):0<Bb&&Bb<qc-1?(nd.buttons.push(Nc.nb(60)),nd.buttons.push(Nc.nb(61)),nd.buttons.push(Nc.nb(62)),nd.buttons.push(Nc.nb(63))):0<Bb&&
Bb===qc-1&&(nd.buttons.push(Nc.nb(60)),nd.buttons.push(Nc.nb(65)),nd.buttons.push(Nc.nb(62)),nd.buttons.push(Nc.nb(67))):(nd.buttons.push(Nc.nb(64)),nd.buttons.push(Nc.nb(65)),nd.buttons.push(Nc.nb(66)),nd.buttons.push(Nc.nb(67)));gb.pc.push(nd)};T.prototype.XYi=function(gb,Bb){var qc=this.Va,Nc=qc.Bc(),nd=1!==Bb&&(!this.isOlap||this.qV||8!==Bb||this.m2a),Vd=2!==Bb&&(!this.isOlap||this.qV||8!==Bb||this.m2a),oe=8!==Bb&&-2!==this.co.PivotTableIndex&&(!this.isOlap||this.qV||this.m2a);Nc.buttons.push(qc.nb(4===
Bb||this.co.IsSet||-2===this.co.PivotTableIndex||this.isOlap&&!this.qV&&8===Bb&&!this.m2a?72:68));8===this.ro.AnchorType||10===this.ro.AnchorType?(Nc.buttons.push(qc.nb(nd?95:97)),Nc.buttons.push(qc.nb(Vd?96:98))):(Nc.buttons.push(qc.nb(nd?69:73)),Nc.buttons.push(qc.nb(Vd?70:74)));Nc.buttons.push(qc.nb(oe?71:75));gb.pc.push(Nc)};T.prototype.YYi=function(gb){var Bb=this.Va.Bc();Bb.buttons.push(this.Va.nb(76));gb.pc.push(Bb)};T.prototype.UYi=function(gb){var Bb=this.Va.Bc();Bb.buttons.push(this.Va.nb(77));
gb.pc.push(Bb)};Mf.Object.defineProperties(T.prototype,{uw:{configurable:!0,enumerable:!0,get:function(){return"PopulateFieldWellContextMenu"}},sB:{configurable:!0,enumerable:!0,get:function(){return Fb.a.GFd}}});Object(ia.a)(T,"FieldWellContextMenu",zb.a,[]);var Fa=b(1418);Rk(G,ka);G.prototype.executeCommand=function(gb,Bb,qc){var Nc=!1,nd=Bb.command;switch(nd){case 37023044:Nc=this.q9c(qc,Bb);break;case 541421805:case -569786022:Nc=this.Bhd(gb,Bb)}return Nc?tb.Task.Ua(!0):Ab.a(nd)};G.prototype.zc=
function(gb,Bb,qc){gb=!1;switch(Bb.command){case 37023044:gb=!!qc;break;case 541421805:case -569786022:gb=!0}return gb};G.prototype.Bhd=function(gb,Bb){var qc=8===gb,Nc=this.$,nd=Be.a(Nc),Vd=Za.g(Nc).ha.Oa.Yb,oe=gb=null;qc&&nd?(gb=nd.chartId,oe=nd.Oc):!qc&&Vd&&(gb=Vd.floatingObject.id,oe=Vd.floatingObject.Oc);return G.Iqe(oe,260)?(qc={},Nc.Lj(qc),qc.FirstColumn=qc.FirstRow=-1,Nc={},oe=(Nc.rawEvent=null,Nc.pivotName=null,Nc.cell=qc,Nc.requiresConfirmation=G.Iqe(oe,64),Nc.dataSourceIndex=oe.ExternalSourceIndex,
Nc),Vd?(nd=Vd.floatingObject,oe.domElement=Vd.domElement,oe.objectId=nd.id,oe.objectVersion=nd.version):nd&&(oe.domElement=nd.ol,oe.objectId=nd.chartId,oe.objectVersion=nd.Gwe),Vd={AnchorType:7},Vd.ChartId=gb,Vd.AnchorValue1=-1,Vd.AnchorValue2=-1,oe.optionalPivotMenuAnchorParameter=Vd,this.q9c(oe,Bb)):!1};G.Iqe=function(gb,Bb){return(gb.Attributes&Bb)===Bb};Mf.Object.defineProperties(G.prototype,{uw:{configurable:!0,enumerable:!0,get:function(){return"PopulatePivotContextMenu"}},sB:{configurable:!0,
enumerable:!0,get:function(){return Fb.a.QKf}}});Object(ia.a)(G,"PivotFilterContextMenu",ka,[]);var Qb=b(1493),cc=b(1048),bc=b(154),Mc=b(388),rd=b(255),Hd=b(28),ic=b(22),Jc=Fb.a.O1g,zd=Jc+".RemoveField",sd=Jc+".Subtotal",Pd=Jc+".ClearFilter",De=Jc+".LayoutSameColumn",lc=Jc+".LayoutNextColumn",Pc=zb.a;Rk(F,Pc);F.prototype.executeCommand=function(gb,Bb,qc){Bb=Bb.command;gb=null;this.grid=Za.g(this.$);this.activeCell=ec.o(this.grid.ha.sa.activeCell,this.$);if(this.$.isEditMode&&(this.rc=this.grid.Ab.Qo(this.grid.ha.sa.activeCell),
!this.rc))return V.ULS.sendTraceTag(537167007,0,10,"No PivotTable range found."),Z.TaskExtensions.Saa();this.EZd=this.$.oa.xa;this.d0a=Object(Pb.a)(ld.a,qc.eventArgs);switch(Bb){case 671488277:this.fxj()?this.lTh():(this.pbb(),this.showPivotTableContextMenu());break;case 1801458190:this.performPivotTableOperation(1801458190,1);break;case -2016405815:this.performPivotTableOperation(-2016405815,6);break;case 671485366:this.performPivotTableOperation(671485366,7);break;case 772221736:this.performPivotTableOperation(772221736,
8);break;case 1600778266:this.performPivotTableOperation(1600778266,2);break;case -556893687:this.performPivotTableOperation(-556893687,3);break;case -1966978671:this.performPivotTableOperation(-1966978671,4);break;case -1951357930:this.performPivotTableOperation(-1951357930,5);break;case -1390365353:this.performPivotTableOperation(-1390365353,9);break;case -1457478532:this.performPivotTableOperation(-1457478532,10);break;case -771066011:this.Qz.PivotValueFieldSummarizeValueByApplyData.Aggregation=
2;this.applyValueFieldSettingsToPivotTable(-771066011,!0);break;case 1746132849:this.Qz.PivotValueFieldSummarizeValueByApplyData.Aggregation=1;this.applyValueFieldSettingsToPivotTable(1746132849,!0);break;case 1475494885:this.Qz.PivotValueFieldSummarizeValueByApplyData.Aggregation=6;this.applyValueFieldSettingsToPivotTable(1475494885);break;case 376946683:this.Qz.PivotValueFieldSummarizeValueByApplyData.Aggregation=11;this.applyValueFieldSettingsToPivotTable(376946683,!0);break;case 835007294:this.Qz.PivotValueFieldSummarizeValueByApplyData.Aggregation=
3;this.applyValueFieldSettingsToPivotTable(835007294,!0);break;case 929115636:this.Qz.PivotValueFieldSummarizeValueByApplyData.Aggregation=4;this.applyValueFieldSettingsToPivotTable(929115636,!0);break;case 1935475057:this.Qz.PivotValueFieldSummarizeValueByApplyData.Aggregation=5;this.applyValueFieldSettingsToPivotTable(1935475057,!0);break;case 588680636:this.Qz.PivotValueFieldSummarizeValueByApplyData.Aggregation=7;this.applyValueFieldSettingsToPivotTable(588680636);break;case -910892852:this.Qz.PivotValueFieldSummarizeValueByApplyData.Aggregation=
8;this.applyValueFieldSettingsToPivotTable(-910892852);break;case -1255320719:this.Qz.PivotValueFieldSummarizeValueByApplyData.Aggregation=0;this.applyValueFieldSettingsToPivotTable(-1255320719,!0);break;case 1668427539:this.Qz.PivotValueFieldSummarizeValueByApplyData.Aggregation=9;this.applyValueFieldSettingsToPivotTable(1668427539);break;case -1751371357:this.Qz.PivotValueFieldSummarizeValueByApplyData.Aggregation=10;this.applyValueFieldSettingsToPivotTable(-1751371357);break;case -841863025:this.qRa(0,
0);this.applyValueFieldSettingsToPivotTable(-841863025);break;case -178796371:this.qRa(7,0);this.applyValueFieldSettingsToPivotTable(-178796371);break;case 786592977:this.qRa(6,0);this.applyValueFieldSettingsToPivotTable(786592977);break;case 767774849:this.qRa(5,0);this.applyValueFieldSettingsToPivotTable(767774849);break;case 282586693:this.qRa(9,0);this.applyValueFieldSettingsToPivotTable(282586693);break;case -1067664355:this.qRa(10,0);this.applyValueFieldSettingsToPivotTable(-1067664355);break;
case -2031744961:qc=Number.parseInvariant(qc.MenuItemId.split(".")[2]);this.qRa(11,qc);this.applyValueFieldSettingsToPivotTable(-2031744961);break;case -1007663920:this.applyPivotSort(1);break;case 234234584:this.applyPivotSort(2);break;case 1194992911:this.$.Fd(-1556797033,vb.a.Cb,8,null);break;case 1514686611:this.Iqi();break;case 1217404289:case -743135194:case 771421327:case 1015867427:case 1105960559:qc=Number.parseInvariant(qc.MenuItemId);this.QXg(qc);break;case 1778578888:qc=Number.parseInvariant(qc.MenuItemId);
this.VJg(qc);break;case 2059542618:this.performPivotTableOperation(2059542618,11);break;case 713270357:this.performPivotTableOperation(713270357,12);break;case -1842411134:this.performPivotTableOperation(-1842411134,13);break;case 2054968064:this.performPivotTableOperation(2054968064,14);break;default:gb=Ab.a(Bb)}return gb||Z.TaskExtensions.Saa()};F.prototype.zc=function(gb,Bb){gb=!1;switch(Bb.command){case 671488277:gb=cc.f(this.grid);break;case 1801458190:case -2016405815:case 671485366:case 772221736:gb=
!0;break;case 1600778266:gb=!0;break;case -556893687:gb=!0;break;case -1966978671:gb=!0;break;case -1951357930:gb=!0;break;case -1390365353:case -1457478532:gb=!0;break;case -249874296:case -771066011:case 1746132849:case 1475494885:case 376946683:case 835007294:case 929115636:case 1935475057:case 588680636:case -910892852:case -1255320719:case 1668427539:case -1751371357:gb=!0;break;case -1128612833:case -841863025:case -178796371:case 767774849:case 786592977:case 282586693:case -1067664355:case -2031744961:gb=
!0;break;case -1007663920:case 234234584:case 1194992911:gb=!0;break;case 1514686611:case 1217404289:case -743135194:case 771421327:case 1015867427:case 1105960559:case 1778578888:gb=!0;break;case 2059542618:case 713270357:case -1842411134:case 2054968064:gb=Kb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ManualDragDropInPivotTables",!1)}return gb};F.prototype.fxj=function(){if(!this.$.isEditMode||this.rc.Vfc)return!1;var gb=this.M0f(!1);return Kb.EwaSettings.isChangeGateEnabled("OfficeVSO:6214209_EnableFullRightClickMenuForExtNativePT")?
!this.rc.isOlap||gb:!this.rc.rod()||gb};F.prototype.Lc=function(gb,Bb){var qc=!1;switch(Bb){case -249874296:case -1128612833:case 1801458190:case -1951357930:case -1390365353:case -1457478532:case 1600778266:case -556893687:case -1966978671:case 1514686611:case 1778578888:qc=this.ZR();break;case -1007663920:case 234234584:qc=this.Nvj()||this.ZR();break;case 1194992911:qc=this.Ovj()||this.ZR();break;case 1217404289:qc=!Qb.j(this.rb.LabelOrDateFilterType)||this.ZR();break;case -743135194:qc=!Qb.m(this.rb.ValueFilterType)&&
!Qb.l(this.rb.ValueFilterType)||this.ZR();break;case 771421327:qc=0===this.rb.LabelOrDateFilterType&&0===this.rb.ValueFilterType&&!this.rb.HasManualFilter||this.ZR();break;case 1015867427:qc=!Qb.i(this.rb.LabelOrDateFilterType)||this.ZR();break;case 1105960559:qc=!Qb.k(this.rb.LabelOrDateFilterType)||this.ZR()}return qc||Pc.prototype.Lc.call(this,gb,Bb)};F.prototype.pbb=function(){this.H$a=this.rb=this.De=null};F.prototype.mTd=function(){this.grid.iP(this.Aq);this.$.Ka.rYa(this.Yx)};F.prototype.$Wd=
function(){this.grid.EK(this.Aq);this.$.Ka.bIb(this.Yx)};F.prototype.nKb=function(){if(this.rc&&this.rc.Fo){this.De=this.rc.Fo;this.rb=this.rc.sac();if(this.A1f()){var gb=this.rc.JK[4===this.De.CellType?this.rc.p4c-1:this.De.CurrentFieldIndex-1];gb&&(this.H$a=-2===gb.Index?this.rc.YEe:gb.Caption)}this.v9h();this.rb&&8===this.De.CellArea&&(this.Qz.PivotValueFieldSummarizeValueByApplyData.Aggregation=this.rb.DataFieldAggregationType,this.Qz.PivotValueFieldShowValueAsApplyData.SelectedDataFormat=this.rb.DataFieldFormatType,
this.Qz.PivotValueFieldShowValueAsApplyData.SelectedBaseField=this.rb.BaseFieldIndex,this.Qz.PivotValueFieldTitle=this.rb.Caption)}};F.prototype.M0f=function(gb){return this.rc?this.rc.isOlap&&!this.rc.W6a(!gb):!1};F.prototype.Vvj=function(){var gb=Kb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ImplicitMeasureSupport",!1);return 1!==this.rb.MeasureType&&(!this.rc.Zef||gb&&2===this.rb.MeasureType)};F.prototype.IY=function(){var gb=this.Va.jq(this.menuId),Bb=this.Va.Bc(),qc=Za.g(this.$).Ub(null);
if(this.rc)this.De&&this.rc.Fo&&this.De!==this.rc.Fo&&V.ULS.shipAssertTag(537167006,0,!1,"CurrentCellInfo is out of sync with cell info from PivotTable Range"),this.rb&&this.rb!==this.rc.sac()&&V.ULS.shipAssertTag(537167005,0,!1,"CurrentField is out of sync with field from PivotTable Range");else return gb;this.vEh(gb);if(this.$.isEditMode){this.refresh&&this.MFh(gb);if(this.De&&this.rb){var Nc=this.Va.Bc();this.aGh(Nc);this.KEh(Nc);gb.pc.push(Nc)}this.$Y&&Bb.buttons.push(this.Va.nb(99));this.De&&
this.rb&&this.hFh(gb);if(this.expandCollapse){Nc=this.Va.Qv("ContextMenu.PivotExpandCollapse",null,ub.a.instance.ga(1144),589118293);var nd=this.Va.Bc();nd.buttons.push(this.Va.nb(243));nd.buttons.push(this.Va.nb(244));nd.buttons.push(this.Va.nb(245));nd.buttons.push(this.Va.nb(246));Nc.menu.pc.push(nd);Nc&&0<nd.buttons.length&&Bb.buttons.push(Nc)}this.De&&(Nc=this.Va.Bc(),Kb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ManualDragDropInPivotTables",!1)&&this.sFh(Nc),this.NFh(Nc),0<Nc.buttons.length&&
gb.pc.push(Nc));this.De&&this.rb&&8===this.De.CellArea&&8!==this.De.CellType&&(Nc=this.Va.Bc(),this.Vvj()&&this.cGh(Nc),3!==this.De.CellType&&this.YFh(Nc),gb.pc.push(Nc));!this.rc.isOlap&&""!==(null===qc||void 0===qc?void 0:qc.text)&&this.De&&0===this.De.CellType&&Kb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PivotTableShowDetails",!1)&&this.XFh(gb);this.$ji()?Bb.buttons.push(this.Va.nb(257)):Bb.buttons.push(this.Va.nb(258));this.cnd?Bb.buttons.push(this.Va.nb(59)):Bb.buttons.push(this.Va.nb(58))}gb.pc.push(Bb);
return gb};F.prototype.AQd=function(){return this.rb&&this.rb.Caption?20<this.rb.Caption.length:!1};F.prototype.cdd=function(gb){return this.rb&&this.rb.Caption?gb?this.rb.Caption.substring(0,20)+"...":this.rb.Caption:""};F.prototype.$ua=function(gb){return Kb.EwaSettings.isChangeGateEnabled("OfficeVSO:5548525_FixLoggingColumnNameInButtonId")?ic.a.hashCode(gb).toString():gb};F.prototype.aGh=function(gb){if(this.De&&this.rb&&4!==this.De.CellArea){var Bb=this.Zia(this.$G("PivotTableContextMenu.Sort",
this.$ua(this.rb.Caption)),-1777747317,0,0!==this.rb.SortInfo,ub.a.instance.ga(229)),qc=this.Va.Bc();qc.buttons.push(this.Pd("PivotTableContextMenu.SortAscending",-1007663920,0,1===this.rb.SortInfo,ub.a.instance.ga(230)));qc.buttons.push(this.Pd("PivotTableContextMenu.SortDescending",234234584,0,2===this.rb.SortInfo,ub.a.instance.ga(231)));1!==this.De.CellArea&&2!==this.De.CellArea||qc.buttons.push(this.Pd("PivotTableContextMenu.SortByValue",1194992911,0,3===this.rb.SortInfo||4===this.rb.SortInfo,
ub.a.instance.ga(156)));Bb.menu.pc.push(qc);Bb&&0<qc.buttons.length&&gb.buttons.push(Bb)}};F.prototype.KEh=function(gb){if(this.De&&this.rb&&(1===this.De.CellArea||2===this.De.CellArea)){var Bb=this.exj(),qc=this.Zia(this.$G("PivotTableContextMenu.Filter",this.$ua(this.rb.Caption)),-1777747317,0,Bb,ub.a.instance.ga(654)),Nc=this.Va.Bc(),nd="",Vd=this.AQd(),oe=String.format(ub.a.instance.mb(156),this.cdd(Vd));Vd&&(nd=String.format(ub.a.instance.mb(156),this.rb.Caption));Bb=this.$ua(this.rb.Caption)+
"."+(Bb?"enabled":"disabled");nd=this.Pd(this.$G(Pd,Bb),771421327,0,!1,oe,"0",nd,8,pc.a.$1a);Bb=this.$ua(this.rb.Caption)+"."+this.rb.LabelOrDateFilterType.toString();this.rb.IsDateField?(oe=this.Zia(this.$G("PivotTableContextMenu.DateFilter",Bb),-1777747317,0,0!==this.rb.LabelOrDateFilterType,ub.a.instance.ga(97)),this.yEh(oe.menu)):(oe=this.Zia(this.$G("PivotTableContextMenu.LabelFilter",Bb),-1777747317,0,0!==this.rb.LabelOrDateFilterType,ub.a.instance.ga(652)),this.gFh(oe.menu));Bb=this.$ua(this.rb.Caption)+
"."+this.rb.ValueFilterType.toString();Bb=this.Zia(this.$G("PivotTableContextMenu.ValueFilter",Bb),-1777747317,0,0!==this.rb.ValueFilterType,ub.a.instance.ga(653));this.oGh(Bb.menu);Vd=this.Va.Bc();Vd.buttons.push(this.Pd("PivotTableContextMenu.ManualFilter",1514686611,0,this.rb.HasManualFilter,ub.a.instance.ga(94)));Nc.buttons.push(nd);Nc.buttons.push(oe);Nc.buttons.push(Bb);qc.menu.pc.push(Nc);qc.menu.pc.push(Vd);qc&&0<Nc.buttons.length&&gb.buttons.push(qc)}};F.prototype.yEh=function(gb){gb.pc.push(this.Qac(!0,
!1));gb.pc.push(this.LLh());gb.pc.push(this.KLh());gb.pc.push(this.BNh());gb.pc.push(this.ENh());gb.pc.push(this.CNh());gb.pc.push(this.DNh());gb.pc.push(this.FNh());gb.pc.push(this.GNh());gb.pc.push(this.yLh())};F.prototype.nEh=function(gb){gb.pc.push(this.Qac(!0,!0));gb.pc.push(this.kUh());gb.pc.push(this.wRh())};F.prototype.gFh=function(gb){gb.pc.push(this.Qac(!0,!1));gb.pc.push(this.MXe(!0));gb.pc.push(this.hIh());gb.pc.push(this.IKh());gb.pc.push(this.MWe(!0));gb.pc.push(this.UVe(!0))};F.prototype.oGh=
function(gb){gb.pc.push(this.Qac(!1,!1));gb.pc.push(this.MXe(!1));gb.pc.push(this.MWe(!1));gb.pc.push(this.UVe(!1));gb.pc.push(this.MYh())};F.prototype.MYh=function(){var gb=this.Va.Bc();gb.buttons.push(this.Pd("PivotTableContextMenu.Top10",-1611233597,0,Qb.l(this.rb.ValueFilterType),ub.a.instance.ga(105)));return gb};F.prototype.IKh=function(){var gb=this.Va.Bc();this.rb&&(gb.buttons.push(this.Pd("PivotTableContextMenu.Contains",786260386,0,10===this.rb.LabelOrDateFilterType,ub.a.instance.ga(655),
"10")),gb.buttons.push(this.Pd("PivotTableContextMenu.DoesNotContain",786260386,0,11===this.rb.LabelOrDateFilterType,ub.a.instance.ga(656),"11")));return gb};F.prototype.hIh=function(){var gb=this.Va.Bc();this.rb&&(gb.buttons.push(this.Pd("PivotTableContextMenu.BeginsWith",786260386,0,6===this.rb.LabelOrDateFilterType,ub.a.instance.ga(657),"6")),gb.buttons.push(this.Pd("PivotTableContextMenu.DoesNotBeginWith",786260386,0,7===this.rb.LabelOrDateFilterType,ub.a.instance.ga(658),"7")),gb.buttons.push(this.Pd("PivotTableContextMenu.EndsWith",
786260386,0,8===this.rb.LabelOrDateFilterType,ub.a.instance.ga(659),"8")),gb.buttons.push(this.Pd("PivotTableContextMenu.DoesNotEndWith",786260386,0,9===this.rb.LabelOrDateFilterType,ub.a.instance.ga(660),"9")));return gb};F.prototype.MXe=function(gb){var Bb=this.Va.Bc();if(this.rb){var qc=gb?Qb.c:Qb.f;Bb.buttons.push(this.Pd(this.$G("PivotTableContextMenu.Equals",qc),786260386,0,gb?4===this.rb.LabelOrDateFilterType:18===this.rb.ValueFilterType,ub.a.instance.ga(100),gb?"4":"18"));Bb.buttons.push(this.Pd(this.$G("PivotTableContextMenu.DoesNotEqual",
qc),786260386,0,gb?5===this.rb.LabelOrDateFilterType:19===this.rb.ValueFilterType,ub.a.instance.ga(101),gb?"5":"19"))}return Bb};F.prototype.MWe=function(gb){var Bb=this.Va.Bc();if(this.rb){var qc=gb?Qb.c:Qb.f;Bb.buttons.push(this.Pd(this.$G("PivotTableContextMenu.GreaterThan",qc),786260386,0,gb?12===this.rb.LabelOrDateFilterType:20===this.rb.ValueFilterType,ub.a.instance.ga(102),gb?"12":"20"));Bb.buttons.push(this.Pd(this.$G("PivotTableContextMenu.GreaterThanOrEqualTo",qc),786260386,0,gb?13===this.rb.LabelOrDateFilterType:
21===this.rb.ValueFilterType,ub.a.instance.ga(661),gb?"13":"21"));Bb.buttons.push(this.Pd(this.$G("PivotTableContextMenu.LessThan",qc),786260386,0,gb?14===this.rb.LabelOrDateFilterType:22===this.rb.ValueFilterType,ub.a.instance.ga(103),gb?"14":"22"));Bb.buttons.push(this.Pd(this.$G("PivotTableContextMenu.LessThanOrEqualTo",qc),786260386,0,gb?15===this.rb.LabelOrDateFilterType:23===this.rb.ValueFilterType,ub.a.instance.ga(662),gb?"15":"23"))}return Bb};F.prototype.UVe=function(gb){var Bb=this.Va.Bc();
if(this.rb){var qc=gb?Qb.c:Qb.f;Bb.buttons.push(this.Pd(this.$G("PivotTableContextMenu.Between",qc),786260386,0,gb?16===this.rb.LabelOrDateFilterType:24===this.rb.ValueFilterType,ub.a.instance.ga(104),gb?"16":"24"));Bb.buttons.push(this.Pd(this.$G("PivotTableContextMenu.NotBetween",qc),786260386,0,gb?17===this.rb.LabelOrDateFilterType:25===this.rb.ValueFilterType,ub.a.instance.ga(663),gb?"17":"25"))}return Bb};F.prototype.Qac=function(gb,Bb){var qc=this.Va.Bc();if(this.rb){var Nc=ub.a.instance.ga(98),
nd=gb?this.rb.LabelOrDateFilterType.toString():this.rb.ValueFilterType.toString(),Vd=["PivotTableContextMenu.ClearFilter",this.$ua(this.rb.Caption),nd];gb=gb?this.rb.IsDateField?Bb?1015867427:1105960559:1217404289:-743135194;Vd.push(gb.toString());Vd=Vd.join(".");Nc=this.Pd(Vd,gb,0,!1,Nc,nd,Nc,8,pc.a.$1a);qc.buttons.push(Nc)}return qc};F.prototype.LLh=function(){var gb=this.Va.Bc();this.rb&&gb.buttons.push(this.Pd(this.$G("PivotTableContextMenu.Equals",Qb.d),786260386,0,26===this.rb.LabelOrDateFilterType,
ub.a.instance.ga(100),"26"));return gb};F.prototype.KLh=function(){var gb=this.Va.Bc();this.rb&&(gb.buttons.push(this.Pd("PivotTableContextMenu.Before",786260386,0,27===this.rb.LabelOrDateFilterType,ub.a.instance.ga(112),"27")),gb.buttons.push(this.Pd("PivotTableContextMenu.After",786260386,0,28===this.rb.LabelOrDateFilterType,ub.a.instance.ga(113),"28")),gb.buttons.push(this.Pd("PivotTableContextMenu.Between",786260386,0,29===this.rb.LabelOrDateFilterType,ub.a.instance.ga(104),"29")));return gb};
F.prototype.BNh=function(){var gb=this.Va.Bc();this.rb&&(gb.buttons.push(this.Pd("PivotTableContextMenu.Tomorrow",1778578888,0,30===this.rb.LabelOrDateFilterType,ub.a.instance.ga(110),"30")),gb.buttons.push(this.Pd("PivotTableContextMenu.Today",1778578888,0,31===this.rb.LabelOrDateFilterType,ub.a.instance.ga(109),"31")),gb.buttons.push(this.Pd("PivotTableContextMenu.Yesterday",1778578888,0,32===this.rb.LabelOrDateFilterType,ub.a.instance.ga(111),"32")));return gb};F.prototype.ENh=function(){var gb=
this.Va.Bc();this.rb&&(gb.buttons.push(this.Pd("PivotTableContextMenu.NextWeek",1778578888,0,33===this.rb.LabelOrDateFilterType,ub.a.instance.ga(115),"33")),gb.buttons.push(this.Pd("PivotTableContextMenu.ThisWeek",1778578888,0,34===this.rb.LabelOrDateFilterType,ub.a.instance.ga(114),"34")),gb.buttons.push(this.Pd("PivotTableContextMenu.LastWeek",1778578888,0,35===this.rb.LabelOrDateFilterType,ub.a.instance.ga(116),"35")));return gb};F.prototype.CNh=function(){var gb=this.Va.Bc();this.rb&&(gb.buttons.push(this.Pd("PivotTableContextMenu.NextMonth",
1778578888,0,36===this.rb.LabelOrDateFilterType,ub.a.instance.ga(117),"36")),gb.buttons.push(this.Pd("PivotTableContextMenu.ThisMonth",1778578888,0,37===this.rb.LabelOrDateFilterType,ub.a.instance.ga(118),"37")),gb.buttons.push(this.Pd("PivotTableContextMenu.LastMonth",1778578888,0,38===this.rb.LabelOrDateFilterType,ub.a.instance.ga(119),"38")));return gb};F.prototype.DNh=function(){var gb=this.Va.Bc();this.rb&&(gb.buttons.push(this.Pd("PivotTableContextMenu.NextQuarter",1778578888,0,39===this.rb.LabelOrDateFilterType,
ub.a.instance.ga(120),"39")),gb.buttons.push(this.Pd("PivotTableContextMenu.ThisQuarter",1778578888,0,40===this.rb.LabelOrDateFilterType,ub.a.instance.ga(121),"40")),gb.buttons.push(this.Pd("PivotTableContextMenu.LastQuarter",1778578888,0,41===this.rb.LabelOrDateFilterType,ub.a.instance.ga(122),"41")));return gb};F.prototype.FNh=function(){var gb=this.Va.Bc();this.rb&&(gb.buttons.push(this.Pd("PivotTableContextMenu.NextYear",1778578888,0,42===this.rb.LabelOrDateFilterType,ub.a.instance.ga(123),"42")),
gb.buttons.push(this.Pd("PivotTableContextMenu.ThisYear",1778578888,0,43===this.rb.LabelOrDateFilterType,ub.a.instance.ga(124),"43")),gb.buttons.push(this.Pd("PivotTableContextMenu.LastYear",1778578888,0,44===this.rb.LabelOrDateFilterType,ub.a.instance.ga(125),"44")));return gb};F.prototype.GNh=function(){var gb=this.Va.Bc();if(this.rb){gb.buttons.push(this.Pd("PivotTableContextMenu.YearToDate",1778578888,0,45===this.rb.LabelOrDateFilterType,ub.a.instance.ga(126),"45"));var Bb=this.Zia("PivotTableContextMenu.AllDatesInThePeriod",
1778578888,0,Qb.i(this.rb.LabelOrDateFilterType),ub.a.instance.ga(127));this.nEh(Bb.menu);gb.buttons.push(Bb)}return gb};F.prototype.yLh=function(){var gb=this.Va.Bc();this.rb&&gb.buttons.push(this.Pd("PivotTableContextMenu.CustomFilter",786260386,0,this.bxj(this.rb.LabelOrDateFilterType),ub.a.instance.ga(108),"26"));return gb};F.prototype.kUh=function(){var gb=this.Va.Bc();this.rb&&(gb.buttons.push(this.Pd("PivotTableContextMenu.Quarter1",1778578888,0,46===this.rb.LabelOrDateFilterType,ub.a.instance.ga(128),
"46")),gb.buttons.push(this.Pd("PivotTableContextMenu.Quarter2",1778578888,0,47===this.rb.LabelOrDateFilterType,ub.a.instance.ga(129),"47")),gb.buttons.push(this.Pd("PivotTableContextMenu.Quarter3",1778578888,0,48===this.rb.LabelOrDateFilterType,ub.a.instance.ga(130),"48")),gb.buttons.push(this.Pd("PivotTableContextMenu.Quarter4",1778578888,0,49===this.rb.LabelOrDateFilterType,ub.a.instance.ga(131),"49")));return gb};F.prototype.wRh=function(){var gb=this.Va.Bc();this.rb&&(gb.buttons.push(this.Pd("PivotTableContextMenu.January",
1778578888,0,50===this.rb.LabelOrDateFilterType,ub.a.instance.ga(132),"50")),gb.buttons.push(this.Pd("PivotTableContextMenu.February",1778578888,0,51===this.rb.LabelOrDateFilterType,ub.a.instance.ga(133),"51")),gb.buttons.push(this.Pd("PivotTableContextMenu.March",1778578888,0,52===this.rb.LabelOrDateFilterType,ub.a.instance.ga(134),"52")),gb.buttons.push(this.Pd("PivotTableContextMenu.April",1778578888,0,53===this.rb.LabelOrDateFilterType,ub.a.instance.ga(135),"53")),gb.buttons.push(this.Pd("PivotTableContextMenu.May",
1778578888,0,54===this.rb.LabelOrDateFilterType,ub.a.instance.ga(136),"54")),gb.buttons.push(this.Pd("PivotTableContextMenu.June",1778578888,0,55===this.rb.LabelOrDateFilterType,ub.a.instance.ga(137),"55")),gb.buttons.push(this.Pd("PivotTableContextMenu.July",1778578888,0,56===this.rb.LabelOrDateFilterType,ub.a.instance.ga(138),"56")),gb.buttons.push(this.Pd("PivotTableContextMenu.August",1778578888,0,57===this.rb.LabelOrDateFilterType,ub.a.instance.ga(139),"57")),gb.buttons.push(this.Pd("PivotTableContextMenu.September",
1778578888,0,58===this.rb.LabelOrDateFilterType,ub.a.instance.ga(140),"58")),gb.buttons.push(this.Pd("PivotTableContextMenu.October",1778578888,0,59===this.rb.LabelOrDateFilterType,ub.a.instance.ga(141),"59")),gb.buttons.push(this.Pd("PivotTableContextMenu.November",1778578888,0,60===this.rb.LabelOrDateFilterType,ub.a.instance.ga(142),"60")),gb.buttons.push(this.Pd("PivotTableContextMenu.December",1778578888,0,61===this.rb.LabelOrDateFilterType,ub.a.instance.ga(143),"61")));return gb};F.prototype.hFh=
function(gb){var Bb=this.Va.Bc();if(this.A1f()){var qc=this.rc.JK[4===this.De.CellType?this.rc.p4c-1:this.De.CurrentFieldIndex-1];if(qc&&this.H$a){var Nc=this.Va.Qv("ContextMenu.PivotTableLayout",null,ub.a.instance.ga(650),-1777747317);var nd=this.Va.Bc(),Vd=String.format(ub.a.instance.mb(165),this.H$a),oe=String.format(ub.a.instance.mb(166),this.H$a);nd.buttons.push(this.Pd(lc,-1457478532,0,!qc.IsCompactLayout,Vd));nd.buttons.push(this.Pd(De,-1390365353,0,qc.IsCompactLayout,oe));Nc.menu.pc.push(nd);
Nc&&Bb.buttons.push(Nc)}}if(1===this.De.CellArea||2===this.De.CellArea)this.rb.Caption&&(qc="",nd=this.AQd(),Nc=String.format(ub.a.instance.mb(159),this.cdd(nd)),nd&&(qc=String.format(ub.a.instance.mb(159),this.rb.Caption)),1===this.De.CellArea?(qc=this.Zia("ContextMenu.PivotTableSubtotal",1801458190,0,this.rb.ShowSubtotal,Nc),Nc=this.Va.Bc(),Nc.buttons.push(this.Va.nb(259)),Nc.buttons.push(this.Pd("ContextMenu.PivotTableSubtotalOnTop",671485366,642,this.rb.ShowSubtotal&&this.rb.ShowSubtotalAtTop)),
Nc.buttons.push(this.Pd("ContextMenu.PivotTableSubtotalOnBottom",772221736,643,this.rb.ShowSubtotal&&!this.rb.ShowSubtotalAtTop)),qc.menu.pc.push(Nc),qc&&0<Nc.buttons.length&&Bb.buttons.push(qc)):(nd=nd?this.$G(sd,this.$ua(Nc)):sd,Bb.buttons.push(this.Pd(nd,1801458190,0,this.rb.ShowSubtotal,Nc,null,qc)))),Bb.buttons.push(this.Pd("ContextMenu.RepeatItemLabels",-556893687,645,this.rb.RepeatItemLabels));1===this.De.CellArea&&Bb.buttons.push(this.Pd("ContextMenu.PivotBlankLineAfterEachItem",1600778266,
644,this.rb.ShowBlankLineAfterEachItem));gb.pc.push(Bb)};F.prototype.XFh=function(gb){var Bb=this.Va.Bc();Bb.buttons.push(this.Va.nb(247));gb.pc.push(Bb)};F.prototype.sFh=function(gb){if(this.$.isEditMode&&this.grid){var Bb=this.grid.ha.sa.activeRange;if(Bb.top===Bb.bottom&&Bb.left===Bb.right&&0!==this.De.MoveItemsMenuState){Bb=this.Zia("PivotTableContextMenu.Move",-1777747317,0,!1,ub.a.instance.ga(73));var qc=this.Va.Bc();this.x$b(qc,"PivotTableContextMenu.MoveToBeginning",2059542618,String.format(ub.a.instance.mb(162),
this.De.MoveItemName),0===(this.De.MoveItemsMenuState&1));this.x$b(qc,"PivotTableContextMenu.MoveUp",713270357,String.format(ub.a.instance.mb(163),this.De.MoveItemName),0===(this.De.MoveItemsMenuState&2));this.x$b(qc,"PivotTableContextMenu.MoveDown",-1842411134,String.format(ub.a.instance.mb(160),this.De.MoveItemName),0===(this.De.MoveItemsMenuState&4));this.x$b(qc,"PivotTableContextMenu.MoveToEnd",2054968064,String.format(ub.a.instance.mb(161),this.De.MoveItemName),0===(this.De.MoveItemsMenuState&
8));Bb.menu.pc.push(qc);gb.buttons.push(Bb)}}};F.prototype.NFh=function(gb){var Bb="",qc="",Nc=!1;3===this.De.CellType?Bb=ub.a.instance.ga(647):8===this.De.CellType?this.rc&&(Bb=String.format(ub.a.instance.mb(164),this.rc.YEe)):this.rb&&((Nc=this.AQd())&&(qc=String.format(ub.a.instance.mb(164),this.rb.Caption)),Bb=String.format(ub.a.instance.mb(164),this.cdd(Nc)));Bb&&(Nc=Nc?this.$G(zd,this.$ua(Bb)):zd,Bb=this.Pd(Nc,-1951357930,0,!1,Bb,null,qc,8,pc.a.P8c),gb.buttons.push(Bb))};F.prototype.vEh=function(gb){var Bb=
this.Va.Bc();Bb.buttons.push(this.Va.nb(43));this.rb&&this.De&&this.$.isEditMode&&(0===this.De.CellType||4===this.De.CellType)&&Bb.buttons.push(this.Va.nb(136));gb.pc.push(Bb)};F.prototype.MFh=function(gb){var Bb=this.Va.Bc();Bb.buttons.push(this.Va.nb(100));gb.pc.push(Bb)};F.prototype.cGh=function(gb){var Bb=2===this.rb.MeasureType&&!this.rb.IsNumeric,qc=this.Va.Qv("ContextMenu.SummarizeValuesBy",null,ub.a.instance.ga(648),-249874296),Nc=this.Va.Bc();Nc.buttons.push(this.Pd("ContextMenu.SummarizeValuesBySum",
-1255320719,1083,0===this.rb.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,Bb));Nc.buttons.push(this.Pd("ContextMenu.SummarizeValuesByCount",1746132849,1084,1===this.rb.DataFieldAggregationType));Nc.buttons.push(this.Pd("ContextMenu.SummarizeValuesByAverage",-771066011,1085,2===this.rb.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,Bb));Nc.buttons.push(this.Pd("ContextMenu.SummarizeValuesByMax",835007294,1086,3===this.rb.DataFieldAggregationType,void 0,void 0,void 0,void 0,
void 0,Bb));Nc.buttons.push(this.Pd("ContextMenu.SummarizeValuesByMin",929115636,1087,4===this.rb.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,Bb));Nc.buttons.push(this.Pd("ContextMenu.SummarizeValuesByProduct",1935475057,1088,5===this.rb.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,this.M0f(!0)||Bb));2!==this.rb.MeasureType&&(Nc.buttons.push(this.Pd("ContextMenu.SummarizeValuesByCountNumbers",1475494885,1089,6===this.rb.DataFieldAggregationType)),Nc.buttons.push(this.Pd("ContextMenu.SummarizeValuesByStdDeviation",
588680636,1090,7===this.rb.DataFieldAggregationType)),Nc.buttons.push(this.Pd("ContextMenu.SummarizeValuesByStdDeviationPercent",-910892852,1091,8===this.rb.DataFieldAggregationType)),Nc.buttons.push(this.Pd("ContextMenu.SummarizeValuesByVariant",1668427539,1092,9===this.rb.DataFieldAggregationType)),Nc.buttons.push(this.Pd("ContextMenu.SummarizeValuesByVariantPercent",-1751371357,1093,10===this.rb.DataFieldAggregationType)));this.rc&&this.rc.rod()&&Nc.buttons.push(this.Pd("ContextMenu.SummarizeValuesByDistinctCountPPM",
376946683,1094,11===this.rb.DataFieldAggregationType));qc.menu.pc.push(Nc);gb.buttons.push(qc)};F.prototype.YFh=function(gb){var Bb=this.Va.Qv("ContextMenu.ShowValuesAs",null,ub.a.instance.ga(649),-1128612833),qc=this.Va.Bc();qc.buttons.push(this.Pd("ContextMenu.ShowValuesAsNoCalculation",-841863025,1100,0===this.rb.DataFieldFormatType));qc.buttons.push(this.Pd("ContextMenu.ShowValuesAsPercentOfGrandTotal",-178796371,1107,7===this.rb.DataFieldFormatType));qc.buttons.push(this.Pd("ContextMenu.ShowValuesAsPercentOfColumnTotal",
786592977,1106,6===this.rb.DataFieldFormatType));qc.buttons.push(this.Pd("ContextMenu.ShowValuesAsPercentOfRowTotal",767774849,1105,5===this.rb.DataFieldFormatType));qc.buttons.push(this.Pd("ContextMenu.ShowValuesAsPercentOfParentRowTotal",282586693,1110,9===this.rb.DataFieldFormatType));qc.buttons.push(this.Pd("ContextMenu.ShowValuesAsParentColumnTotal",-1067664355,1111,10===this.rb.DataFieldFormatType));if(this.rc&&this.rc.JK&&0<this.rc.JK.length||this.rc.y$&&0<this.rc.y$.length){for(var Nc=this.Zia("ContextMenu.ShowValuesAsPercentOfParentTotal",
-1128612833,1112,11===this.rb.DataFieldFormatType),nd=this.Va.Bc(),Vd=this.bGh(),oe=0;oe<Vd.length;oe++){var qe=Vd[oe];nd.buttons.push(this.Pd("ContextMenu.ShowValuesAsPercentOfParentTotal."+qe.Caption,-2031744961,1112,11===this.rb.DataFieldFormatType&&this.rb.BaseFieldIndex===qe.Index,qe.Caption,"ContextMenu.ShowValuesAsPercentOfParentTotal."+qe.Index))}Nc.menu.pc.push(nd);qc.buttons.push(Nc)}Bb.menu.pc.push(qc);gb.buttons.push(Bb)};F.prototype.showPivotTableContextMenu=function(){this.cnd=!0;this.expandCollapse=
this.$Y=this.refresh=!1;var gb=this.$,Bb=Za.g(gb),qc=xe.a(gb).aKa();if(qc){var Nc=ve.a(gb);if(null===Nc||void 0===Nc?0:Nc.TPd)this.cnd=Qd.f(gb.mg);Nc=gb.hc;this.$Y=qc.supportsBIExplore&&!!Kd.a(gb)&&Nc.x2(32768);Nc.allowInteractivity&&(gb=Bb.Ub(null),(null===gb||void 0===gb?0:gb.cell)&&(gb.cell.TYc||gb.cell.x1f)&&(this.expandCollapse=!0),Nc.allowManualDataRefresh&&(this.refresh=!0))}gb=null;qc=1;this.d0a&&1!==this.d0a.lb?(gb=new Sys.UI.Point(this.d0a.clientPoint.x,this.d0a.clientPoint.y),qc=this.d0a.lb):
(Bb=cc.e(Bb,this.$))&&(gb=new Sys.UI.Point(Bb.x+(this.$.isChromeRtl?0:Bb.width),Bb.y+Bb.height));vb.a.Cb=qc;this.Xhc=3===qc;this.hp(gb,!0,qc);this.yba=!0;this.mTd()};F.prototype.K5h=function(){var gb=new cb.a(1114549926,0,this.$.Jc,19,null);this.$.Ka.Kb(gb)};F.prototype.lTh=function(){var gb=this;if(this.rc&&this.rc.Fo){var Bb=this.rc.Fo.CurrentCol;if(this.rc.Fo.CurrentRow===this.activeCell.FirstRow&&Bb===this.activeCell.FirstColumn){this.nKb();this.showPivotTableContextMenu();return}}Bb=new Cb.a(228,
0,function(qc,Nc,nd){return rd.k(gb.$.oa.xa,gb.activeCell,Aa.b(qc,gb.nLi),Aa.a(Nc,gb.mLi),nd,null)},16);this.$.userOperationManager.Sb(Bb,null)};F.prototype.$ji=function(){if(ac.a.ud(this.$)){var gb=this.$.da.za(441);if(gb)return gb.Hr}else if(gb=this.$.da.za(346))return gb.Hr;return!1};F.prototype.$G=function(gb,Bb){return gb+"."+Bb};F.prototype.performPivotTableOperation=function(gb,Bb){var qc=this,Nc=Hd.a.Ta.Jb;if(!this.rc||!this.rb&&this.De&&3!==this.De.CellType)this.hj();else{var nd=this.rc.isOlap;
xe.a(this.$).rx(nd,function(Vd){Vd&&qc.$.Sb(gb,function(oe,qe,ee){var re=qc.EZd,Ze=qc.activeCell,mf=qc.rb?qc.rb.Caption:null,Pa=qc.H$a;oe=Aa.b(oe,qc.YOi);qe=Aa.a(qe,qc.XOi);var Wb=qc.$.oa.xa.Pb();Wb=re.Na(41,void 0===Wb?null:Wb);Wb.activeCell=Ze;Wb.operationType=Bb;Wb.fieldCaption=mf;Wb.prevFieldCaption=Pa;return ab.g(re,"ExecutePivotTableOperation",Wb,oe,qe,ee,null,0)},Nc,0,4,229)})}};F.prototype.applyValueFieldSettingsToPivotTable=function(gb,Bb){var qc=this;Bb=void 0===Bb?!1:Bb;var Nc=Hd.a.Ta.Jb;
this.rc&&this.rb?(Bb&&2===this.rb.MeasureType&&V.ULS.sendTraceTag(537167002,0,50,"change aggregation type for an implicit measure from right click context menu."),Bb=this.rc.isOlap,xe.a(this.$).rx(Bb,function(nd){nd&&qc.$.Sb(gb,function(Vd,oe,qe){var ee=qc.EZd,re=qc.activeCell,Ze=qc.Qz;Vd=Aa.b(Vd,qc.RFi);oe=Aa.a(oe,qc.QFi);var mf=qc.$.oa.xa.Pb();mf=ee.Na(41,void 0===mf?null:mf);mf.activeCell=re;mf.pivotValueFieldSettingsApplyData=Ze;return ab.g(ee,"ApplyValueFieldSettingsToPivotTable",mf,Vd,oe,qe,
null,0)},Nc,0,4,231)})):this.hj()};F.prototype.Pd=function(gb,Bb,qc,Nc,nd,Vd,oe,qe,ee,re){nd=void 0===nd?null:nd;Vd=void 0===Vd?null:Vd;oe=void 0===oe?null:oe;qe=void 0===qe?8:qe;ee=void 0===ee?null:ee;re=void 0===re?!1:re;Nc&&(gb+=".Checked");re&&(gb+=".Disabled");this.Va.Qld(gb)&&this.Va.uHd(gb);qc=nd||ub.a.instance.ga(qc);gb=this.Va.qHa(gb,qc,Bb,null,"None",Vd,re,null);gb.ovc(null);oe&&gb.VR(oe);Nc?gb.XR("Image16by16",3,pc.a.gaa):ee?gb.XR("Image16by16",qe,ee):gb.i2b();return gb};F.prototype.Zia=
function(gb,Bb,qc,Nc,nd){qc=(void 0===nd?null:nd)||ub.a.instance.ga(qc);this.Va.Qld(gb)?this.Va.uHd(gb):this.Va.uHd(gb+".Checked");Nc&&(gb+=".Checked");this.xvj&&(qc=this.chh.parseFromString(qc,"text/html").body.innerText);gb=this.Va.A2c(gb,null,qc,Bb,3,pc.a.gaa);gb.u8e=Nc;!Nc&&Kb.EwaSettings.isChangeGateEnabled("OfficeVSO:4877664_HidePivotTableContextMenuFlyoutCheckmark")&&gb.i2b();return gb};F.prototype.v9h=function(){this.Qz=Object(sa.a)(new Q,{PivotValueFieldSummarizeValueByApplyData:Object(sa.a)(new J,
{Aggregation:-1}),PivotValueFieldShowValueAsApplyData:Object(sa.a)(new K,{SelectedDataFormat:-1,SelectedBaseField:-1,SelectedBaseItem:-1}),PivotValueFieldTitle:null})};F.prototype.qRa=function(gb,Bb){this.Qz.PivotValueFieldShowValueAsApplyData.SelectedDataFormat=gb;this.Qz.PivotValueFieldShowValueAsApplyData.SelectedBaseField=Bb;this.Qz.PivotValueFieldShowValueAsApplyData.SelectedBaseItem=-1};F.prototype.bGh=function(){var gb=[];if(this.rc&&this.rc.y$&&0<this.rc.y$.length)for(var Bb=bk(this.rc.y$),
qc=Bb.next();!qc.done;qc=Bb.next())(qc=qc.value)&&gb.push(qc);if(this.rc&&this.rc.JK&&0<this.rc.JK.length)for(Bb=bk(this.rc.JK),qc=Bb.next();!qc.done;qc=Bb.next())(qc=qc.value)&&gb.push(qc);gb.sort(function(Nc,nd){return Nc.Index-nd.Index});return gb};F.prototype.A1f=function(){if(!this.De||!this.rc||!this.rc.JK)return!1;var gb=1===this.De.CellArea||4===this.De.CellType&&this.De.IsRowAxis,Bb=4===this.De.CellType?0<this.rc.p4c:0<this.De.CurrentFieldIndex;return 1<this.rc.JK.length&&gb&&Bb};F.prototype.NJa=
function(gb){var Bb=[];3===gb?this.$.isEditMode?Array.addRange(Bb,[gd.a.KFf,gd.a.MFf,gd.a.EXi]):Array.addRange(Bb,[gd.a.copy]):2===gb&&Bb.push(gd.a.jwe);return Bb};F.prototype.hj=function(){var gb=Qa.a.Xc(1,0,0,651,0,104573951,"PivotTableContextMenuOperationFailure");nc.a(this.$).hj(gb)};F.prototype.exj=function(){return this.rb?0!==this.rb.LabelOrDateFilterType||0!==this.rb.ValueFilterType||this.rb.HasManualFilter:!1};F.prototype.bxj=function(gb){return 62<=gb&&65>=gb};F.prototype.Iqi=function(){if(this.activeCell&&
this.rb&&this.rc){var gb={};gb.cell=this.activeCell;gb.dataSourceIndex=this.rc.externalSourceIndex;gb.fieldId=this.rb.Index.toString();gb.isOlap=this.rc.isOlap;gb.confirmationRequired=this.rc.confirmationRequiredForDataOps;this.$.Fd(492140419,vb.a.Cb,19,{showPivotFilterDialogCommandData:gb})}};F.prototype.QXg=function(gb){var Bb=this;this.activeCell&&this.rb&&this.rc&&this.$.userOperationManager.Sb(new Cb.a(153,0,function(qc,Nc,nd){return ab.B(Bb.$.oa.xa,Bb.activeCell,Bb.rc.externalSourceIndex,Bb.rb.Index.toString(),
gb,qc,Nc,nd,null,null)}),null)};F.prototype.VJg=function(gb){var Bb=this;!(30>gb||61<gb)&&this.activeCell&&this.rb&&this.rc&&this.$.userOperationManager.Sb(new Cb.a(152,0,function(qc,Nc,nd){return ab.e(Bb.$.oa.xa,Bb.activeCell,Bb.rc.externalSourceIndex,Bb.rb.Index.toString(),gb,qc,Nc,nd,null,null)}),null)};F.prototype.applyPivotSort=function(gb){var Bb=this;if(this.rc&&this.rb&&this.activeCell&&this.De){var qc=1===this.De.CellArea||2===this.De.CellArea;8===this.De.CellArea?Mc.a(this.$.userOperationManager,
function(Nc,nd,Vd){return rd.b(Bb.$.oa.xa,Bb.activeCell,gb,Bb.rb.Caption,Nc,nd,Vd,null)},function(Nc){return new Cb.a(1015,0,Nc,void 0,null)},null):qc&&(qc=1===this.De.CellArea?1:2,this.$.ma(696)?bc.a.naps(this.$.domElement,this.activeCell.FirstRow,this.activeCell.FirstColumn,this.rc.externalSourceIndex,this.rb.Index.toString(),this.rb.Caption,this.rc.isOlap?"":this.rb.Caption,qc,1===gb):bc.a.aps(this.$.domElement,this.activeCell.FirstRow,this.activeCell.FirstColumn,this.rc.externalSourceIndex,this.rb.Index.toString(),
1===gb))}};F.prototype.ZR=function(){return!this.rc||!this.rc.isActionable};F.prototype.Nvj=function(){return(this.De||this.rc)&&4!==this.De.CellType&&(0!==this.De.CellType||8!==this.De.CellArea||this.rc.y$&&this.rc.y$.length||this.rc.JK&&this.rc.JK.length)?!1:!0};F.prototype.Ovj=function(){return this.De&&this.rc&&(1===this.De.CellArea||2===this.De.CellArea)&&this.rc.IOb&&this.rc.IOb.length?!1:!0};F.prototype.x$b=function(gb,Bb,qc,Nc,nd){gb.buttons.push(this.Pd(Bb,qc,0,!1,Nc,null,null,8,null,nd))};
Mf.Object.defineProperties(F.prototype,{uw:{configurable:!0,enumerable:!0,get:function(){return"PopulatePivotTableContextMenu"}},sB:{configurable:!0,enumerable:!0,get:function(){return Fb.a.RKf}}});Object(ia.a)(F,"PivotTableContextMenu",zb.a,[]);I.prototype.compare=function(gb,Bb){return(gb||"").localeCompare(Bb||"",void 0,{numeric:!0,sensitivity:"accent"})};Object(ia.a)(I,"DigitsAsNumberComparer",null,[594]);var md=b(1284),bd=b(160),Od=b(356),le=b(274),dd=b(24),Zd=b(187),je=Fb.a.Q1g,Ke=zb.a;Rk(D,
Ke);D.prototype.executeCommand=function(gb,Bb,qc){gb=Bb.command;switch(gb){case 639960842:this.applyTableFieldList(qc);this.yK.nda();break;case -1085236154:qc=String.format("TableFieldListContextMenu:TableFieldListContextMenuClose, ColWithEntities, {0}",this.Exd);V.ULS.sendTraceTag(537166999,0,50,qc);this.yK.nda();break;case 1833782813:this.yK.showCallout();break;default:return Ab.a(gb)}return tb.Task.Ua(!0)};D.prototype.applyTableFieldList=function(gb){var Bb=gb.MenuItemId.toString();Kb.EwaSettings.isChangeGateEnabled("OfficeVSO:5239502_UpdatePulloutFieldNameContainingSplChars")&&
(Bb=Bb.replace("'","''"),Bb=Bb.replace("[","'["),Bb=Bb.replace("]","']"));var qc=Object(Pb.a)(String,gb.SourceControlId),Nc={};Nc.PulloutField=Bb;Nc.PulloutCardPath=gb.SourceCardKeyPath;Nc.PulloutCardSourceRow=gb.SourceCardRow;Nc.PulloutCardSourceColumn=gb.SourceCardColumn;if(this.yK.WM){V.ULS.sendTraceTag(38887748,0,50,"Table Pullout operation started");Nc.ParameterType=2;gb=gb.ColumnIndex;if(void 0===gb||null===gb){if(void 0===qc||null===qc){V.ULS.shipAssertTag(537166998,0,!1,"TableFieldListContextMenu: ApplyTableFieldList, must specifiy ColumnIndex or SourceControlId");
return}gb=0<=this.yK.UIf?this.yK.UIf:parseInt(qc.substring(20+Bb.length+1,qc.length),10);if(isNaN(gb)){Nc=String.format("TableFieldListContextMenu:ApplyTableFieldListMalformatHTMLAttribute, Attribute, {0}",qc);V.ULS.shipAssertTag(537166997,0,!1,Nc);return}}Nc.PulloutRichColumnSourceIndex=gb;if(this.qEa.uHg){this.jIg(Bb,Nc);return}}else V.ULS.sendTraceTag(38887749,0,50,"Grid Pullout operation started"),Nc.ParameterType=4,qc=this.yK.selectedRange.right,ac.a.Byb()&&this.qEa.smd&&(Nc.ParameterType=8,
gb=this.yK.tla.top,gb=dd.Range.GP(qc)+gb,Bb==md.f?(Bb="=DAYS("+gb+", TODAY())",Zd.a("DateFormulaPulledOut_DaysFromToday")):Bb==md.i?(Bb="=IF(TODAY() < "+gb+", NETWORKDAYS(TODAY(), "+gb+"), NETWORKDAYS("+gb+", TODAY()))",Zd.a("DateFormulaPulledOut_WeekdaysFromToday")):Bb==md.j?(Bb="=IF(TODAY() < "+gb+", DATEDIF(TODAY(), "+gb+', "Y"), DATEDIF('+gb+', TODAY(), "Y"))',Zd.a("DateFormulaPulledOut_YearsFromToday")):Bb==md.e?(Bb="=TEXT("+gb+', "dddd")',Zd.a("DateFormulaPulledOut_DayOfWeek")):Bb==md.h?(Bb=
"=TEXT("+gb+', "mmmm")',Zd.a("DateFormulaPulledOut_MonthOfYear")):Bb==md.g?(Bb="EOMONTH("+gb+", 0)",Bb="=DATE(YEAR("+Bb+"), MONTH("+Bb+"), DAY("+Bb+"))",Zd.a("DateFormulaPulledOut_EndOfMonth")):Bb==md.c?(Bb="EDATE("+gb+", 1)",Bb="=DATE(YEAR("+Bb+"), MONTH("+Bb+"), DAY("+Bb+"))",Zd.a("DateFormulaPulledOut_AddOneMonth")):Bb==md.d?(Bb="="+gb+" + 7",Zd.a("DateFormulaPulledOut_AddOneWeek")):Bb==md.b&&(Bb="="+gb+" + 1",Zd.a("DateFormulaPulledOut_AddOneDay"))),void 0!==Nc.PulloutCardSourceColumn&&null!==
Nc.PulloutCardSourceColumn&&(qc=Nc.PulloutCardSourceColumn+1),Nc.PulloutRichColumnSourceIndex=qc;this.CNd(Bb,Nc)};D.prototype.CNd=function(gb,Bb,qc){qc=void 0===qc?0:qc;var Nc=String.format("TableFieldListContextMenu:ApplyTableFieldList, ColWithEntities, {0}, SelectedColumnIndex, {1}",this.Exd,Bb.PulloutRichColumnSourceIndex);V.ULS.sendTraceTag(537166996,0,50,Nc);String.format("TableFieldListContextMenu:ApplyTableFieldList, richValueParameterType, {0}, PulloutRichColumnSourceIndex, {1}",Bb.ParameterType,
Bb.PulloutRichColumnSourceIndex);gb=Object(sa.a)(new le.a,{Text:gb});this.grid.setCell(gb,this.yK.tla,0,127,Bb,qc);this.grid.focus();this.Z4b=null;this.yK.nda();this.yK.zfj()};D.prototype.zc=function(gb,Bb,qc){if(gb=this.$.isEditMode&&Kb.EwaSettings.ma(136)&&!!this.yK)switch(Bb.command){case -1085236154:break;case 639960842:gb=!!qc;break;case 1833782813:gb=this.yK.ewa&&this.yK.oBb;break;default:gb=!1}return gb};D.prototype.x0=function(gb,Bb,qc){this.$.isEditMode&&(this.Z4b=this.nFh(Object(Pb.a)(589,
qc)),Ke.prototype.x0.call(this,gb,Bb,null,null,!1))};D.prototype.IY=function(){return this.Z4b};D.prototype.z2c=function(gb){if(!this.yK||!gb||!gb.Gk)return V.ULS.shipAssertTag(537166994,0,!!this.yK,"TableFieldListContextMenu:CreateContextMenuItemList PulloutManager null"),V.ULS.shipAssertTag(537166993,0,!!gb,"TableFieldListContextMenu:CreateContextMenuItemList fieldInfoManager null"),gb&&V.ULS.shipAssertTag(537166992,0,!!gb.Gk,"TableFieldListContextMenu:CreateContextMenuItemList fieldInfoManager.FieldInfoListContextList null"),
null;var Bb=new sc.a;gb=bk(gb.Gk);for(var qc=gb.next();!qc.done;qc=gb.next()){var Nc=qc.value;qc=new sc.a;qc.add(Nc.ColumnName);qc.add(Nc.ColumnIndex.toString());var nd=new sc.a,Vd=null;ac.a.Byb()&&this.qEa.smd?nd=oc.toList(oc.select(oc.asEnumerable(Nc.FieldInfoDataList),function(oe){return oe.Name})):(Vd=Kb.EwaSettings.isChangeGateEnabled("OfficeVSO:5860557_CompareDigitsAsNumberRichDataProperties")?new I:new Dc.a,nd=oc.OBc(oc.concat(nd,oc.select(oc.asEnumerable(Nc.FieldInfoDataList),function(oe){return oe.Name})),
function(oe){return oe},Vd));Nc=new sc.a;Nc.add(oc.toArray(oc.concat(qc,nd)));Bb=oc.toList(oc.concat(Bb,Nc))}return oc.toArray(Bb)};D.prototype.nFh=function(gb){var Bb=this.z2c(gb);if(!Bb||!Bb.length)return this.Z4b=null;gb=this.Va;var qc=gb.jq(this.menuId),Nc=gb.Bc(),nd=1<Bb.length,Vd=ac.a.Byb()&&this.qEa.smd;this.Exd=Bb.length;Bb=bk(Bb);for(var oe=Bb.next();!oe.done;oe=Bb.next()){var qe=oe.value;Vd?Nc.title="Calculate Date Information":nd||(Nc.title=qe[0]);oe=gb.Bc();for(var ee=2,re=qe.length;ee<
re;++ee)!Vd||qe[ee]!=md.f&&qe[ee]!=md.g||(qc.pc.push(Nc),Nc=gb.Bc()),(nd?oe.buttons:Nc.buttons).push(gb.qHa("ApplyTableFieldList."+qe[ee]+"."+qe[1],qe[ee],639960842,null,"None",qe[ee],!1,void 0,!0));nd&&(qe=gb.Qv("ApplyTableFieldList."+qe[0],this.menuId,qe[0],798637440),qe.menu.pc.push(oe),Nc.buttons.push(qe))}qc.pc.push(Nc);return qc};D.prototype.jIg=function(gb,Bb){var qc=this,Nc=Qa.a.Xc(12,1,0,897,0,2007340793,"RichValuePulloutIntoNonEmptyRange");if(Kb.EwaSettings.kz()){var nd=new Od.a(this.$,
Nc);nd.jP(function(){2===nd.returnValue&&qc.CNd(gb,Bb,8)})}else{var Vd=new bd.ErrorDialog(this.$,Nc);Vd.jP(function(){2===Vd.returnValue&&qc.CNd(gb,Bb,8)});Vd.gf()}};Mf.Object.defineProperties(D.prototype,{uw:{configurable:!0,enumerable:!0,get:function(){return"PopulateTableFieldListContextMenu"}},sB:{configurable:!0,enumerable:!0,get:function(){return Fb.a.TKf}},yK:{configurable:!0,enumerable:!0,get:function(){this.qEa||(this.qEa=this.$.da.za(261));return this.qEa}}});Object(ia.a)(D,"PulloutFieldListContextMenu",
zb.a,[]);var lf=Fb.a.VKf,nf=zb.a;Rk(x,nf);x.prototype.zc=function(gb,Bb,qc){return-1687037502===Bb.command&&!!qc&&this.grid.isEditing};x.prototype.executeCommand=function(gb,Bb,qc){this.showRichTextFloatie(qc);return tb.Task.Ua(!0)};x.prototype.NJa=function(){return[gd.a.oVg]};x.prototype.showRichTextFloatie=function(gb){var Bb=Object(Pb.a)(ld.a,gb.eventArgs);Bb&&(gb=this.NJa(Bb.lb),Bb=new Sys.UI.Point(Bb.Ca.clientX,Bb.Ca.clientY),this.showFloatie(gb,new Sys.UI.Bounds(Bb.x,Bb.y,0,0),2))};Mf.Object.defineProperties(x.prototype,
{uw:{configurable:!0,enumerable:!0,get:function(){return"PopulateRichTextContextMenu"}},sB:{configurable:!0,enumerable:!0,get:function(){return Fb.a.VKf}}});Object(ia.a)(x,"RichTextContextMenu",zb.a,[]);var me=b(101),$e=b(638),we=Fb.a.P1g,Ya=zb.a;Rk(z,Ya);z.prototype.executeCommand=function(gb,Bb,qc){if(Fd.a(this.$))return tb.Task.Ua(!0);this.$.isEditMode&&(gb=qc[Fb.a.r0f],gb=gb.x&&gb.y?new Sys.UI.Point(gb.x+(this.$.isChromeRtl?10:-10),gb.y):se.DOMElementExtensions.getLocation(qc[Fb.a.s0f]),this.hp(gb,
!1));return tb.Task.Ua(!0)};z.prototype.zc=function(gb,Bb,qc){return-1075099431===Bb.command&&!!qc};z.prototype.IY=function(){var gb=this.Va.jq(this.menuId),Bb=this.$.isEditMode;this.JSj();this.cFh(gb,Bb);this.SEh(gb);this.WFh(gb);return gb};z.prototype.LYb=function(gb,Bb,qc,Nc){gb.push(this.Va.nb(Bb?qc:Nc))};z.prototype.cFh=function(gb,Bb){var qc=this.Va,Nc=qc.Bc();Nc.buttons.push(qc.nb(54));this.LYb(Nc.buttons,this.Nhc,127,56);Nc.buttons.push(qc.nb(55));Bb&&this.LYb(Nc.buttons,this.Nhc,126,125);
Nc.buttons.push(qc.nb(158));this.$.ea.YKb&&(Kb.EwaSettings.isChangeGateEnabled("OfficeVSO:6540166_CheckIsSdxAllowedForProtectionPane")?Ha.AFrameworkApplication.vpd($e.a):this.$.ya.ExcelSheetProtectionSettingsEnabled)&&(Bb=Object(Pb.a)(me.a,this.$.pa))&&af.p(Bb)&&this.$.isEditMode&&(Nc.buttons.push(qc.nb(277)),Bb.isLockPausedInSession?Nc.buttons.push(qc.nb(279)):Bb.fj&&Nc.buttons.push(qc.nb(278)));Bb=qc.Qv("ContextMenu.TabColor",null,ub.a.instance.ga(521),1841703919);qc=qc.w2c(467002767,1549407384,
544,-221093529,this.sB);Bb.menu.pc.push(qc);Nc.buttons.push(Bb);gb.pc.push(Nc)};z.prototype.SEh=function(gb){var Bb=this.Va.Bc();this.LYb(Bb.buttons,this.Nhc,114,112);this.LYb(Bb.buttons,!this.lgc,115,113);gb.pc.push(Bb)};z.prototype.WFh=function(gb){if(Kb.EwaSettings.ma(482)&&!af.e(this.$.va.pa)){var Bb=this.Va,qc=Bb.Bc();qc.buttons.push(Bb.nb(263));gb.pc.push(qc)}};z.prototype.JSj=function(){var gb=this.$.h2c();var Bb=gb.i2c;gb=gb.DBe;this.Nhc=1===Bb;this.lgc=0<gb};Mf.Object.defineProperties(z.prototype,
{uw:{configurable:!0,enumerable:!0,get:function(){return"PopulateSheetOpsContextMenu"}},sB:{configurable:!0,enumerable:!0,get:function(){return Fb.a.WKf}}});Object(ia.a)(z,"SheetOpsContextMenu",zb.a,[]);var h=b(566),lb=zb.a;Rk(A,lb);A.prototype.Lc=function(gb,Bb){var qc=!0;switch(Bb){case -231711729:qc=!1;break;case -1909381757:qc=this.Qbc();qc=!!qc&&qc.Wgi;break;case 1312363469:qc=!0}return!qc||lb.prototype.Lc.call(this,gb,Bb)};A.prototype.executeCommand=function(gb,Bb,qc){if(!this.$.isEditMode)return Z.TaskExtensions.Saa();
gb=Bb.command;Bb=this.Qbc();var Nc=null;switch(gb){case 2108047455:Bb&&Bb.aye();break;case -231711729:V.ULS.shipAssertTag(537166990,0,!1,"Shouldn't be hitting Slicer Refresh - NYI");break;case -1909381757:Bb&&Bb.r2b();break;case 1312363469:this.showSlicerContextMenu(qc);break;default:Nc=Ab.a(gb)}return Nc||Z.TaskExtensions.Saa()};A.prototype.zc=function(gb,Bb,qc){gb=!1;switch(Bb.command){case -231711729:case 2108047455:case -1909381757:gb=!0;break;case 1312363469:gb=!!qc}return gb};A.prototype.IY=
function(){var gb=this.Va.jq(this.menuId),Bb=this.Va.Bc();Bb.buttons.push(this.Va.nb(252));Bb.buttons.push(this.Va.nb(253));Bb.buttons.push(this.Va.nb(254));gb.pc.push(Bb);Bb=this.Va.Bc();this.lmi()?Bb.buttons.push(this.Va.nb(266)):Bb.buttons.push(this.Va.nb(267));gb.pc.push(Bb);return gb};A.prototype.lmi=function(){if(ac.a.ud(this.$)){var gb=this.$.da.za(439);if(gb)return gb.Hr}else if(gb=this.$.da.za(371))return gb.Hr;return!1};A.prototype.showSlicerContextMenu=function(gb){var Bb=Object(Pb.a)(ld.a,
gb.eventArgs);gb=this.oac(Object(Pb.a)(ld.a,gb.eventArgs));Bb=Bb.lb;vb.a.Cb=Bb;this.hp(gb,!1,Bb)};A.prototype.YUe=function(gb){var Bb=this.Va.Bc(),qc=this.Va.Bc();qc.buttons.push(this.Va.nb(255));qc.buttons.push(this.Va.nb(256));var Nc=this.Va.A2c("ContextMenu.SlicerSort",null,ub.a.instance.ga(2149),-814639094,0,pc.a.UNe);Nc.menu.pc.push(qc);Bb.buttons.push(Nc);gb.pc.push(Bb)};A.prototype.uxj=function(gb){return Kb.EwaSettings.isChangeGateEnabled("OfficeVSO:5103035_SlicerCornerResizePointContextMenuUseOnlyClientPoint")&&
gb.zb.className===pc.a.y8c||Kb.EwaSettings.isChangeGateEnabled("OfficeVSO:5185773_SlicerShortcutContextMenuSkipFramePoint")&&1===gb.lb};A.prototype.oac=function(gb){var Bb=Za.g(this.$).ha.Oa.Yb,qc=gb&&1!==gb.lb&&gb.clientPoint?gb.clientPoint:Sys.UI.DomElement.getLocation(Bb.domElement);if(this.uxj(gb)){var Nc=this.Qbc();Nc&&(gb.zb.className===pc.a.y8c&&(qc=Cc.HelperMethods.Jub(gb.Ca)),1===gb.lb&&(qc=xb.a(this.$).rja(se.DOMElementExtensions.getLocation(Nc.frame))))}else if(gb=this.Qbc())gb=this.AOh(gb.frame),
(Nc=Cc.HelperMethods.zC(this.$.tf,this.$.domElement,Za.g(this.$).rtl,!1))?(gb.x=xb.a(this.$).hi(gb.x-Nc.x)+Nc.x,gb.y=xb.a(this.$).hi(gb.y-Nc.y)+Nc.y):V.ULS.sendTraceTag(537166989,0,15,"Cannot get constant pane size."),qc.y+=gb.y,qc.x+=gb.x;gb=this.$.domElement;Nc=Za.g(this.$).rtl;Bb=Cc.HelperMethods.zC(Bb.ag.domElement,gb,Nc);qc.y=Math.max(qc.y,Bb.y);qc.x=Math.max(qc.x,Bb.x);return qc};A.prototype.Qbc=function(){var gb=Za.g(this.$).ha.Oa.Yb;V.ULS.shipAssertTag(537166988,0,!!gb);return h.a(this.$).hH(gb.floatingObject.id)};
A.prototype.AOh=function(gb){var Bb=new Sys.UI.Point(gb.offsetParent.offsetLeft,gb.offsetParent.offsetTop),qc=Za.g(this.$);if(!qc)return Bb;var Nc=Za.g(this.$).rtl;Bb=Cc.HelperMethods.zC(gb,this.$.Tq.ownerDocument.body,Nc);qc.uBe(Bb);Bb.x=Nc?this.$.Tq.clientWidth-Bb.x-gb.clientWidth:Bb.x;gb=qc.view.Kob;qc=Nc?-qc.LR.ica(gb.x):gb.x;Bb.x-=qc;Bb.y-=gb.y;return Bb};Mf.Object.defineProperties(A.prototype,{uw:{configurable:!0,enumerable:!0,get:function(){return"PopulateSlicerContextMenu"}},sB:{configurable:!0,
enumerable:!0,get:function(){return Fb.a.XKf}}});Object(ia.a)(A,"SlicerContextMenu",zb.a,[]);Object(ia.a)(B,"TimeSlicerRibbonButtonParameter",null,[]);var Ub=zb.a;Rk(w,Ub);w.prototype.executeCommand=function(gb,Bb,qc){gb=Bb.command;switch(gb){case 2000085697:gb=qc.DOMElement;this.tsa=qc.ChangeLevelCallback;this.WJa=qc.GetLevelLabelCallback;this.A0a=qc.CurrentLevel;var Nc=qc.DomEvent;Ua.g(Nc);var nd=qc.location;qc=qc.levelLabelText;this.cJe=se.DOMElementExtensions.hz(document.activeElement,"iframe")&&
qc?qc.parentNode:null;qc=Sys.UI.DomElement.getBounds(qc);qc.x=nd.x;qc.y=nd.y;this.x0(Nc,gb,qc,Bb,!0);break;case -649826274:this.tsa(0);break;case 149600865:this.tsa(1);break;case -2012435159:this.tsa(2);break;case -1979934975:this.tsa(3);break;case 1634477200:se.DOMElementExtensions.setFocus(this.cJe);break;default:return Ab.a(gb)}return tb.Task.Ua(!0)};w.prototype.zc=function(gb,Bb,qc){gb=!1;switch(Bb.command){case 2000085697:gb=!!qc;break;case -649826274:case 149600865:case -2012435159:case -1979934975:case 1634477200:gb=
!0}return gb};w.prototype.x0=function(gb,Bb,qc){gb=Sys.UI.DomElement.getBounds(Bb);qc.x=xb.a(this.$).hi(qc.x);qc.y=xb.a(this.$).hi(qc.y);gb.x=xb.a(this.$).hi(gb.x);gb.y=xb.a(this.$).hi(gb.y);gb=new Sys.UI.Point(gb.x+qc.x,gb.y+qc.y);this.showContextMenu(new Sys.UI.Bounds(gb.x,gb.y-qc.height,qc.width,qc.height))};w.prototype.IY=function(){for(var gb=this.Va,Bb=gb.jq(this.menuId),qc=gb.Bc(),Nc=0;3>=Nc;Nc++){var nd=this.WJa(Nc),Vd=w.UIh(Nc);Vd=gb.O3g(Vd.N1g,Vd.mr,this.A0a===Nc,w.exe);Vd.label=nd;Vd.VR(nd);
this.A0a===Nc?Vd.XR("Image16by16",8,w.exe):Vd.i2b();qc.buttons.push(Vd)}Bb.pc.push(qc);return Bb};w.UIh=function(gb){var Bb=null;switch(gb){case 0:Bb=new B(87,"ContextMenu.TimeSlicerLevelYear",-649826274);break;case 1:Bb=new B(88,"ContextMenu.TimeSlicerLevelQuater",149600865);break;case 2:Bb=new B(89,"ContextMenu.TimeSlicerLevelMonth",-2012435159);break;case 3:Bb=new B(90,"ContextMenu.TimeSlicerLevelDay",-1979934975)}return Bb};Mf.Object.defineProperties(w.prototype,{uw:{configurable:!0,enumerable:!0,
get:function(){return"PopulateTimeSlicerLevelMenu"}},sB:{configurable:!0,enumerable:!0,get:function(){return Fb.a.$Kf}}});w.GIj=Fb.a.R1g;w.YIb="TimeSlicerLevelMenuRootName";w.exe=pc.a.dua;Object(ia.a)(w,"TimeSlicerLevelMenu",zb.a,[]);var zc=b(328),vc=b(3),ud=ta.a;Rk(m,ud);m.prototype.Ad=function(){var gb=this,Bb=this.$,qc=Rc.a.AHa(kc.b(),this.la,"Task","IRootUser"),Nc=za.a(Bb),nd=null;nd=function(qe,ee){Nc.FPf(nd);qc.setResult(ee.E3b)};Nc.Pme(nd);Nc.z_e();var Vd=ya.GetServiceTaskFactory.create(Bb.da,
102,Bb.la,this.hb),oe=ya.GetServiceTaskFactory.Ra(Bb.da,342,338,this.hb);Z.TaskExtensions.Aa(Z.TaskExtensions.Vd([qc.task,Vd,oe],this.la),function(){var qe=Vd.result,ee=qc.task.result,re=oe.result;gb.jd([new aa(Bb,ee,qe,re),new ea(Bb,ee,qe,re),new ca(Bb,ee,qe,re),new P(Bb,ee,qe,re),new T(Bb,ee,qe,re),new wa(Bb,ee,qe,re),new Fa.GridContextMenu(Bb,ee,qe,re),new G(Bb,ee,qe,re),new z(Bb,ee,qe,re),new w(Bb,ee,qe,re),new D(Bb,ee,qe,re),new X(Bb,ee,qe,re),new F(Bb,ee,qe,re),new A(Bb,ee,qe,re),new x(Bb,ee,
qe,re)])},Bb.la,3)};m.initData=function(){var gb=zc.a.h2;gb(2000085697,20479,0,0);gb(-227942804,vc.a.wc|24576,0,0);gb(1634477200,vc.a.wc|131072,0,0);gb(-649826274,4095,0,0);gb(149600865,4095,0,0);gb(-2012435159,4095,0,0);gb(-1979934975,4095,0,0);gb(1247109494,vc.a.wc|24576,0,0);gb(-2064931494,vc.a.wc|131072,0,0);gb(-1396319072,vc.a.Ha,128,0);gb(-425234874,vc.a.Ha,128,0);gb(-1253126584,vc.a.Ha,0,0);gb(274207288,vc.a.wc|24576,0,0);gb(-1497523576,vc.a.wc|131072,0,0);gb(-498523270,vc.a.wc|24576,64,0);
gb(1640762262,vc.a.wc|131072,64,0);gb(-2017893763,vc.a.wc|24576,0,0);gb(1350204367,vc.a.wc|131072,0,0);gb(-889576107,vc.a.Mv,128,0);gb(-1170196828,vc.a.Mv,128,0);gb(389774337,vc.a.Mv,128,0);gb(1529312473,vc.a.Mv,128,0);gb(2033235475,vc.a.Mv,128,0);gb(-96230454,vc.a.Mv,128,0);gb(74086617,vc.a.Mv,128,0);gb(563292088,vc.a.Mv,128,0);gb(-1092351914,vc.a.Mv,128,0);gb(-2141589616,vc.a.Mv|16384,128,0);gb(745182485,vc.a.Mv,0,0);gb(359279088,vc.a.Mv,128,0);gb(-67292059,vc.a.Mv,128,0);gb(926905850,vc.a.Mv,128,
0);gb(547535945,vc.a.Mv,128,0);gb(1374696078,vc.a.wc|24576,0,0);gb(495005930,vc.a.wc|212992,0,0);gb(-1045020714,vc.a.wc|24576,0,0);gb(-170383950,vc.a.wc|212992,0,0);gb(324156914,vc.a.Ha,0,0);gb(-1085236154,vc.a.Cu,0,0);gb(-751848458,vc.a.jl|16384,0,0);gb(216058793,vc.a.Cu,0,0);gb(474690375,vc.a.jl|16384,0,0);gb(-1920954846,vc.a.wc|24576,0,0);gb(723126814,vc.a.wc|131072,0,0);gb(2108047455,128,128,0);gb(-231711729,128,128,0);gb(-1909381757,128,128,0);gb(-814639094,128,128,0);gb(1701016594,vc.a.wc|3072,
128,0);gb(-1475408662,vc.a.wc|24576,0,0);gb(1114549926,vc.a.wc|131072,32,0)};m.ka=function(gb){ta.a.Qd(10,new m(gb))};Object(ia.a)(m,"ContextMenuCommandHandlerFactory",ta.a,[]);var Gd=b(232),od=b(1601),Ae=b(92),Ne=b(264);y.prototype.dispose=function(){};y.prototype.U$=function(){this.Gqb.q3()};y.prototype.rC=function(){this.Gqb.rC()};y.prototype.SQd=function(gb,Bb,qc){cc.h(this.$,cc.b);this.Gqb.showContextMenu(Object(sa.a)(new od.a,{x:Bb.x,y:Bb.y}),qc,gb);Ae.EventHandlerManager.instance.Cad()};y.prototype.bxc=
function(gb,Bb,qc){cc.h(this.$,cc.b);this.Gqb.showFloatie(Object(sa.a)(new od.a,{x:Bb.x,y:Bb.y}),gb,qc);Ne.a(function(){Ae.EventHandlerManager.instance.Cad()},this.$.la)};y.prototype.RQd=function(gb,Bb,qc,Nc){cc.h(this.$,cc.b);this.Gqb.RQd(Object(sa.a)(new od.a,{x:Bb.x,y:Bb.y}),gb,qc,Nc)};Object(ia.a)(y,"ReactContextMenuController",null,[605,3]);var gf=Gd.a;Rk(r,gf);r.prototype.dispose=function(){this.f9e&&this.$&&this.$.ea.mn(this.rkd);gf.prototype.dispose.call(this)};r.prototype.create=function(){this.$.ea.Tg?
(V.ULS.sendTraceTag(537167065,0,50,"ContextMenuControllerFactory.InitReactUISurfacesAndRegisterControllerIfNeeded: GFI = {0}",this.$.ea.Tg),this.rkd(null,null)):(this.f9e=!0,this.$.ea.il(this.rkd))};r.ka=function(gb){gb.da.Ga(338,new r(gb))};Object(ia.a)(r,"ContextMenuControllerFactory",Gd.a,[]);var Ja=b(161);Object(ia.a)(v,"RibbonCommandParams",null,[]);Object(ia.a)(f,"HeaderSnappedAutoFilterMenuCacheEntry",null,[]);n.prototype.fJh=function(gb){return(gb=this.ndc[gb.toString()])?gb.menuModel:null};
n.prototype.ySg=function(gb,Bb){this.ndc[Bb.toString()]=Object(sa.a)(new f,{menuModel:gb,lEe:Cc.HelperMethods.Qb()})};n.prototype.g7b=function(gb){this.ndc[gb.toString()]=null};n.prototype.DYh=function(gb){return(gb=this.ndc[gb.toString()])?gb.lEe:-1};Object(ia.a)(n,"FilterMenuCache",null,[]);var Lb=b(13),mc=b(195),xc=b(233);Object(ia.a)(l,"AutoFilterEventRegistrationArgs",null,[]);k.prototype.dispose=function(){window.cancelAnimationFrame(this.pBb);this.gridView&&this.gridView.gsc(this.nEb);this.gridView=
null};k.prototype.E8h=function(){if(this.iQd=Cc.HelperMethods.r6a)this.pZa=[];this.JBg();this.gridView.hZb(this.nEb)};k.prototype.JBg=function(){for(var gb=bk(this.gridView.en),Bb=gb.next();!Bb.done;Bb=gb.next()){Bb=Bb.value.LBa;for(var qc in Bb){var Nc=Bb[qc];this.uJf(Nc.domElement,Nc.hashCode)}}};k.prototype.uJf=function(gb,Bb){if(Za.g(this.$).Ea.gm.j1a(Bb))if(gb){gb=gb.querySelectorAll('[id^="'+Fb.a.n$c+'"]');for(var qc=0;qc<gb.length;qc++){var Nc=gb[qc],nd=Nc.getAttribute(Fb.a.rzh),Vd=Nc.getAttribute(Fb.a.kzh);
V.ULS.shipAssertTag(537167053,0,!!nd&&!!Vd,"FilterMenuManager.QueuePointerHandlerRegistrationsToFiltersInBlock: Row and Column attributes should exist in AF input element. AutoFilterId: {0}, BlockHash: {1}",Nc.id,Bb);nd=dd.Range.Tc(parseInt(nd,10),parseInt(Vd,10));Nc=Object(sa.a)(new l,{cell:nd,Zre:Nc,Kd:Bb});this.iQd?(this.pZa.push(Nc),this.pBb||(this.vLe=window.performance.now(),this.pBb=window.requestAnimationFrame(this.kNf))):this.Yke(Nc)}}else V.ULS.sendTraceTag(537167054,0,50,"FilterMenuManager.QueuePointerHandlerRegistrationsToFiltersInBlock: Block DOM element is null. BlockHash: {0}",
Bb);else V.ULS.sendTraceTag(537167055,0,50,"FilterMenuManager.QueuePointerHandlerRegistrationsToFiltersInBlock: Block model does not exist yet. Handlers will be added when block is rendered. BlockHash: {0}",Bb)};k.prototype.Yke=function(gb){var Bb=this.gridView.Ea.YJa(gb.cell,gb.Kd);Bb?this.IBg(gb.Zre,Bb):V.ULS.sendTraceTag(537167050,1,10,"FilterMenuManager.AddPointerHandlersToAutoFilterInCell: GetModelCellFromRange returned null. BlockHash: {0}, AutoFilter Cell: {1}",gb.Kd,gb.cell)};k.prototype.IBg=
function(gb,Bb){Bb.hasAutoFilter?this.Lzg(gb,Bb.ytb):Bb.q4?this.GBg(gb,Bb.ytb,Bb.Eod):V.ULS.sendTraceTag(537167049,1,50,"FilterMenuManager.AddPointerEventHandlersToAutoFilter: Cell must have either AutoFilter or PivotFilter if reached here!");Ja.a.instance.ra(Lb.a.rf,gb,this.onPointerDown);mc.a.instance.ra(Lb.a.Rxa,gb,this.onPointerDown)};k.prototype.Lzg=function(gb,Bb){xc.a.instance.ra(Lb.a.click,gb,function(qc){Bb&&bc.a.hrc(qc.Ca.rawEvent,966232027,Bb,null);return!0})};k.prototype.GBg=function(gb,
Bb,qc){var Nc=Wa.a.Th(Bb);xc.a.instance.ra(Lb.a.click,gb,function(nd){qc?bc.a.spf(document.getElementById(Nc.EwaElementId),Nc.Cell,Nc.DataSourceIndex,Nc.FieldId,Nc.IsOlap,Nc.RequiresConfirmation,nd.Ca.rawEvent,Nc.OptionalPivotMenuAnchor):bc.a.spfm(nd.Ca.rawEvent,Nc.RequiresConfirmation,Nc.Cell,Nc.DataSourceIndex,Nc.PivotName,Nc.OptionalPivotMenuAnchor);return!1})};Object(ia.a)(k,"FilterMenuPointerEventsManager",null,[3]);e.prototype.dispose=function(){Kb.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")&&
Kb.EwaSettings.isChangeGateEnabled("OfficeVSO:5035623_autofiltersHitTest")||this.MRe.dispose();this.$=null};e.prototype.mPh=function(gb){var Bb=Za.g(this.$).Ea.b$(gb,this.$.activeItemName);return Bb&&Bb.blockPresentInViewportTimeStamp>this.n8a.DYh(gb.left)?Bb.Kr(gb).autoFilterMenu:this.n8a.fJh(gb.left)};e.prototype.gMi=function(gb,Bb,qc){this.n8a&&this.n8a.ySg(gb.menuModel[Bb],qc)};e.prototype.hMi=function(gb){this.n8a&&this.n8a.g7b(gb)};Object(ia.a)(e,"FilterMenuManager",null,[601,3]);var hd=b(211),
Cd=b(174);d.prototype.wcd=function(gb){return pa.a.yc(this.Bxc,gb)};d.prototype.dispose=function(){this.Bd?V.ULS.sendTraceTag(537167062,1,50,"ContextMenuManager.Dispose: Dispose has been called more than once"):(this.Bd=!0,this.$&&(this.$.rl(d.Yc),this.$.da.tU(8),this.ha&&this.ha.Yrc(this.Il),this.$.Ka.bIb(this.Huf),Kb.EwaSettings.isChangeGateEnabled("OfficeVSO:4728637_DissmissContextualUIFromContextMenuManager")&&this.$.Ka&&this.$.Ka.Aza(this.hR),Kb.EwaSettings.isChangeGateEnabled("OfficeVSO:4932179_RemoveControllerRecreationOnModeSwitch")||
this.$.ea.b0(this.Z5)),this.$=this.ha=null,this.n9b.dispose(),this.Bxc=this.o5d=null)};d.prototype.showContextMenu=function(gb,Bb,qc){Bb=void 0===Bb?null:Bb;qc=void 0===qc?null:qc;this.axj(gb)&&(cc.h(this.$,cc.i),gb=this.Z4g(gb,Bb,qc),this.$.Ka.Kb(gb.Ed,gb.dictionary))};d.prototype.q3=function(){this.contextMenuController?this.contextMenuController.U$():V.ULS.sendTraceTag(537167061,1,10,"ContextMenuManager.DismissContextualUI: Context menu controller is null.")};d.prototype.axj=function(gb){return nc.a(this.$).Kp()?
(V.ULS.sendTraceTag(537167060,1,50,"ContextMenuManager.OnContextMenu: Ignoring ContextMenu event because it is not allowed in partial interactivity mode"),nc.a(this.$).iW(Cd.a.grid,hd.a.showContextMenu),!1):!this.$.Ka.Nwh&&(!gb||gb.zb!==Za.g(this.$).domElement&&!ic.a.equals(gb.zb.tagName,"INPUT",!0))};d.prototype.Z4g=function(gb,Bb,qc){Bb=void 0===Bb?null:Bb;var Nc={};qc=(Nc.eventArgs=gb,Nc.creationParams=void 0===qc?null:qc,Nc);gb=gb?gb.lb:-1;Nc=this.ha.Oa.Yb;var nd=1441131127;Nc?(Bb=Nc.floatingObject,
V.ULS.shipAssertTag(537167059,0,!!Bb,"floatingObj shouldn't be null."),d.Rpd(Bb)?nd=1312363469:d.isPivotChart(Bb)?(qc[ea.a_c]=Bb?Bb.Oc:null,nd=-149612405):nd=-1372040782):d.yef(Bb)?(qc[ea.a_c]=Bb,nd=-149612405):!cc.g(this.$)&&cc.f(Za.g(this.$))&&(nd=671488277);Bb=new cb.a(nd,gb,this.$.Jc,30,null);return Object(sa.a)(new v,{Ed:Bb,dictionary:qc})};d.ka=function(gb){gb.Tk(d.Yc)};d.isPivotChart=function(gb){return!!gb&&0===gb.type&&d.yef(gb.Oc)};d.Rpd=function(gb){return!!gb&&2===gb.type};d.yef=function(gb){return!!gb&&
!!(gb.Attributes&4)};Mf.Object.defineProperties(d.prototype,{n9b:{configurable:!0,enumerable:!0,get:function(){return this.o5d}}});d.S1g="autoFilter chart fieldList fieldListPivotFilter fieldWell floatingObject grid pivotFilter sheetOps timeSlicerLevel tableFieldList autoFilterRichFieldList slicer richText".split(" ");d.s0h="GridContextMenu";d.Yc=function(gb){(gb=Object(Pb.a)(4,gb))&&ya.GetServiceTaskFactory.create(gb.da,9,gb.la,0)};Object(ia.a)(d,"ContextMenuManager",null,[593,3]);var dc=Gd.a;Rk(c,
dc);c.prototype.create=function(){var gb=this,Bb=this.$,qc=Bb.hc;if(qc.allowSelection||qc.allowEdits||qc.allowFiltering||qc.allowSorting||qc.allowPivotSpecificOperations){var Nc=ya.GetServiceTaskFactory.create(Bb.da,10,Bb.la,this.hb),nd=ya.GetServiceTaskFactory.Ra(Bb.da,342,338,this.hb);Z.TaskExtensions.Aa(Z.TaskExtensions.Vd([Nc,nd],this.la),function(){gb.pb(Yb.a(Bb)||new d(Bb,Nc.result,nd.result))},this.$.la,3)}else V.ULS.sendTraceTag(537167058,0,15,"ContextMenuManagerFactory.Create: no client permissions to allow creating ConetxtMenuManager. Returning null."),
Bb.da.tU(8),this.pb(null)};c.ka=function(gb){gb.da.Ga(9,new c(gb))};Object(ia.a)(c,"ContextMenuManagerFactory",Gd.a,[]);var Ec=b(10);b.d(E,"a",function(){return a})},1337:function(u,E,b){function a(){V.a.Fa(function(Ja){Ka.ka(Ja);ra.ka(Ja);c.ka(Ja)})}function c(Ja){var Lb=gf.call(this)||this;Lb.$=Ja;Lb.Eb();return Lb}function d(Ja,Lb,mc,xc,hd,Cd,dc){var Ec=this;this.$=Ja;this.functionInfoManager=Lb;this.calcManager=mc;this.pluginScheduler=xc;this.formulaAssistanceUIControl=hd;this.formulaAssistanceTelemetryManager=
Cd;this.Ig=dc;this.CRa=!0;this.CLa=this.isCellContentOnlyEqualDuringEdit=!1;this.Oka=null;this.SMa=-1;this.ZV=0;this.rba=ha.EwaSettings.isChangeGateEnabled("OfficeVSO:6409372_isGroupwisePluginOperationsUsed");this.uzb=ha.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NotifyActiveCellOnEditStarted",!1);this.Ch=function(gb,Bb){Ec.gridView.isEditing||Ec.gridView.ui||Ec.TNa(null===Bb||void 0===Bb?void 0:Bb.cell)};this.Dh=function(gb,Bb){Ec.TNa(null===Bb||void 0===Bb?void 0:Bb.Pia)};this.onFunctionInfoLoaded=
function(){Ec.functionInfoManager.Rab(Ec.onFunctionInfoLoaded);Ec.ySj();Ec.lda()};this.Usf=function(){Ec.CRa=!1};this.btf=function(gb,Bb){var qc=Ec.Ya;gb=qc.text;qc=qc.textBox.caretPosition;0<Ec.ZV&&Ec.formulaAssistanceTelemetryManager.nY.commitWhileRequestPending++;Ec.formulaAssistanceTelemetryManager.iO(["argumentAssistanceComputation","argumentAssistanceOverall"]);Bb.shouldRequestAutocompleteOnCommit?Ec.pWf(gb,qc):Ec.JJd(gb,qc)};this.Af=function(){Ec.k2&&(Ec.isCellContentOnlyEqualDuringEdit&&(Ec.formulaAssistanceTelemetryManager.uM.isCellContentOnlyEqualDuringEditCounter++,
Ec.isCellContentOnlyEqualDuringEdit=!1),Ec.CLa&&(Ec.formulaAssistanceTelemetryManager.uM.isCellContentFormulaCounter++,Ec.CLa=!1));Ec.CRa=!0;ha.EwaSettings.isChangeGateEnabled("OfficeVSO:6103891_dismissControlOnEditEnded")&&Ec.t6b()};this.a6=function(gb,Bb){Ec.nLd(Bb.newValue)};this.xi=function(){Ec.Lbg()};this.Lbg=function(){Ec.pluginScheduler.notifier().setDefinedNamesInfo(Ec.Q5b.RFe)};this.wdd=function(gb,Bb){gb=Ec.pluginScheduler.syncRequester().formulaHighlighting({content:gb,caretPosition:null===
Bb||void 0===Bb?void 0:Bb.index,selectionLength:null===Bb||void 0===Bb?void 0:Bb.length});if(isNullOrUndefined(gb)||isNullOrUndefined(gb.formulaHighlights))La.ULS.sendTraceTag(521211933,0,10,"FormulaAssistanceManager.getFormulaHighlights: formulaHighlightingResult is null or undefined, formulaHighlights array is null:{0}",!isNullOrUndefined(gb));else return gb};this.functionInfoManager=Lb;this.formulaAssistanceUIControl=hd;this.pluginScheduler=xc;this.gridView=Ob.g(this.$);this.Wdf=ha.EwaSettings.isChangeGateEnabled("OfficeVSO:5951570_sendingNamedObjectsAutocompleteRequest");
this.H4=ha.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ArgumentAssistanceDismiss",!1);this.oxd=ha.EwaSettings.isChangeGateEnabled("OfficeVSO:5656143_SendCellFormatOnCellChanged");this.k2=ha.EwaSettings.isChangeGateEnabled("OfficeVSO:6352308_addTelemetryAtFormulaAssistance");this.wXc=ha.EwaSettings.isChangeGateEnabled("OfficeVSO:6488306_BlockFormulasuggestionInPivotTable");this.$gi=ha.EwaSettings.isChangeGateEnabled("OfficeVSO:6646054_FixNoPreviewBugEnabled");this.Wdf&&(this.Q5b=new ea(Ja),
this.gridView.Ea.hx(this.xi),this.Lbg());this.Rpa=new n(this.$,this.formulaAssistanceUIControl,this.formulaAssistanceTelemetryManager);this.H8=new l(this.$,this.formulaAssistanceUIControl,this.formulaAssistanceTelemetryManager);this.vhi=ab.a.S4(Ja);this.Uwa=ab.a.Uwa(Ja);this.T4=ab.a.T4(Ja);this.vhi&&(this.ZCh=new e(this.$));Ja.da.Ga(464,this);this.calcManager=mc;ab.a.mV()&&this.Mkd();this.k2&&this.gridView.$b.tm(this.Af);this.H4&&(this.k2||this.gridView.$b.tm(this.Af),this.Rpa.$Dg(this.Usf));this.mmd=
ha.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertToSheetGridCell",!1)}function e(Ja){this.$=Ja}function k(Ja,Lb){var mc=this,xc,hd;this.Ig=Ja;this.$=Lb;this.iya=function(){mc.e9b.resolve(mc.Ig.Gk);mc.fag()};this.ywf=function(){mc.e9b.reject(null);mc.fag()};this.Af=function(){mc.Ig.qbb();mc.wrd=null};null===(hd=null===(xc=Ob.g(this.$))||void 0===xc?void 0:xc.$b)||void 0===hd?void 0:hd.tm(this.Af);this.vBj=ha.EwaSettings.isChangeGateEnabled("OfficeVSO:6476169_skipGetFieldInfoListContextIfContextLoaded")}
function l(Ja,Lb,mc){var xc=od.call(this,l.wJa())||this;xc.$=Ja;xc.formulaAssistanceUIControl=Lb;xc.formulaAssistanceTelemetryManager=mc;xc.Ya=null;xc.dr=null;xc.gIa=!1;xc.hIa=!1;xc.fIa=!1;xc.dIa=!1;xc.eIa=!1;xc.Et=null;xc.LW=0;xc.Gq=null;xc.Fv=!1;xc.rfa=!1;xc.GAa=!1;xc.ZRa=!1;xc.YRa=!1;xc.HNb=Gd.Dismissed;xc.onRestoreFocus=function(){};xc.dismiss=function(){xc.Fv=!1;xc.Usd();xc.wH&&xc.Ya.isEditing&&xc.Ema();xc.Gq=null;xc.formulaAssistanceUIControl&&(xc.formulaAssistanceUIControl.dismiss(xc.domElement),
xc.dr.canReceiveFocus=!1,xc.HNb=Gd.Dismissed)};xc.Tgd=function(){xc.raiseEvent("FAFocusOnSmartSuggestionsCard",null)};xc.tca=function(hd,Cd){0==Cd.Cq&&(170==Cd.Ef.operation.operationName&&xc.formulaAssistanceTelemetryManager.cjc++,xc.$.userOperationManager.so(xc.tca))};xc.pOa=function(hd,Cd){0==Cd.Cq&&(12==Cd.Ef.operation.operationName&&xc.$.userOperationManager.zr(xc.tca),xc.$.userOperationManager.so(xc.pOa))};xc.EIi=function(){xc.dismiss();Ob.g(xc.$).Gi.textBox.focus()};xc.SQa=function(){var hd=
{};xc.GDf?hd[qb.a.NU]="SmartSuggestionsCard":hd[qb.a.NU]="FunctionAndSmartSuggestionsCard";xc.$.Fd(802602464,0,8,hd)};xc.Af=function(){xc.Zyb&&xc.cIg()};xc.Oyd=function(hd,Cd){xc.Web(Cd);xc.hIa=!0};xc.Rc=function(){xc.visible=!1};xc.Nyd=function(hd){xc.eIa=!0;xc.mqb(hd)};xc.uh=function(){xc.dismiss()};xc.Xs=function(){void 0!==xc.Gq&&null!==xc.Gq&&xc.Gq()};xc.dr=new ka(xc.$,xc.formulaAssistanceUIControl,1,Bc.a.Mad,xc.Tgd);Ob.g(xc.$).view.Es(xc.Xs);Ob.g(xc.$).ha.vG(xc.Rc);xc.$.va.If(xc.uh);xc.Zyb=
ha.EwaSettings.isChangeGateEnabled("OfficeVSO:5523443_FormulaSuggestionsCardUserInteractionTelemetry");xc.y9=ha.EwaSettings.isChangeGateEnabled("OfficeVSO:6378161_addKeptSmartSuggestionsMetric");xc.Zyb&&Ob.g(xc.$).$b.tm(xc.Af);ha.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceNoLayer",!1)&&xc.$.domElement.appendChild(xc.domElement);xc.Lii=ha.EwaSettings.isChangeGateEnabled("OfficeVSO:6312266_RedesignListBoxEvents");return xc}function n(Ja,Lb,mc){var xc=ud.call(this,n.wJa())||
this;xc.$=Ja;xc.formulaAssistanceUIControl=Lb;xc.formulaAssistanceTelemetryManager=mc;xc.y2=0;xc.dr=null;xc.Gq=null;xc.Nka=null;xc.Fv=!1;xc.LQ=!1;xc.Rc=function(){xc.visible=!1};xc.onCardModeChange=function(hd){xc.TNb(hd);1===hd?xc.formulaAssistanceTelemetryManager.U9.argumentAssistanceCollapseCounter++:xc.formulaAssistanceTelemetryManager.U9.argumentAssistanceExpandCounter++};xc.SQa=function(hd){var Cd={};Cd[qb.a.NU]="ArgumentAssistanceCard";var dc={};dc.FunctionName=hd.functionName;Cd[qb.a.T9c]=
dc;xc.$.Fd(802602464,0,8,Cd)};xc.Xs=function(){void 0!==xc.Gq&&null!==xc.Gq&&xc.Gq()};xc.onDismissClick=function(){xc.formulaAssistanceTelemetryManager.U9.argumentAssistanceDismissCounter++;xc.dismiss();xc.raiseEvent("DC");xc.LQ&&xc.OG.clear();0===xc.y2&&xc.TNb(1)};xc.Af=function(){xc.LQ&&xc.OG.clear()};xc.H4=ha.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ArgumentAssistanceDismiss",!1);xc.PNd();xc.dr=new ka(xc.$,xc.formulaAssistanceUIControl,0,Bc.a.Jad);Ob.g(xc.$).view.Es(xc.Xs);Ob.g(xc.$).ha.vG(xc.Rc);
xc.LQ=ha.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceDismiss",!1)&&ha.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceDrag",!1);xc.LQ&&(xc.OG=new J(xc.formulaAssistanceUIControl,xc.formulaAssistanceTelemetryManager),Ob.g(xc.$).$b.tm(xc.Af));ha.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceNoLayer",!1)&&xc.$.domElement.appendChild(xc.domElement);return xc}function f(Ja,Lb,mc,xc,hd,Cd,dc,Ec,gb){var Bb=vc.call(this,
Ja)||this;Bb.functionInfoManager=Lb;Bb.calcManager=xc;Bb.instantaneousSupportInformationManager=hd;Bb.formulaAssistanceUIControl=dc;Bb.formulaAssistanceTelemetryManager=Ec;Bb.pluginScheduler=gb;Bb.rdc=!1;Bb.dr=null;Bb.iGa=null;Bb.pg=null;Bb.wV=null;Bb.Pqd=null;Bb.p5=null;Bb.Q2a=0;Bb.r$b=0;Bb.u3=0;Bb.eIe=0;Bb.osb=0;Bb.Mdb=0;Bb.b5b=0;Bb.Gwc=!1;Bb.Cia=null;Bb.Xoc=null;Bb.columnName="";Bb.c5c=!1;Bb.Cve=!1;Bb.mJa=[];Bb.RP=null;Bb.XRa=[];Bb.Gq=null;Bb.jbd=null;Bb.k8=null;Bb.rfa=!1;Bb.GAa=!1;Bb.ZRa=!1;Bb.YRa=
!1;Bb.isCellContentOnlyEqualDuringEdit=!1;Bb.CLa=!1;Bb.Oka=null;Bb.SMa=0;Bb.U0d=null;Bb.FCb=0;Bb.Hld=!1;Bb.onRestoreFocus=function(){};Bb.pfb=void 0;Bb.rba=ha.EwaSettings.isChangeGateEnabled("OfficeVSO:6409372_isGroupwisePluginOperationsUsed");Bb.Ddf=ha.EwaSettings.isChangeGateEnabled("OfficeVSO:6592409_startArgumentAssistanceTimerBeforeAutocompleteCalculation");Bb.uzb=ha.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NotifyActiveCellOnEditStarted",!1);Bb.Tgd=function(){Bb.Ck&&Bb.raiseEvent(f.oad,
null)};Bb.HRe=function(){Bb.Cia=!1;Bb.wV=Bb.Ya.text;Bb.dh.$Ia(Bb.Et,Bb.wV,!0,Bb.columnName,void 0,!1);1===Bb.dh.mq.length&&1===Bb.dh.dW.length?(Bb.set_visible(!1),Bb.Cve||Bb.Tjd()):Bb.show()};Bb.NLi=function(qc){if(Xb.a(qc))-315732528!==qc.Errors[0].MessageId&&La.ULS.sendTraceTag(537162013,0,10,"FormulaAssistanceControl.OnGetTableColHeadersSuccess - Webservice call failed with Unexpected error : {0}",we.a.Ec(qc.Errors));else if((qc=qc.Result)&&qc.length){Bb.pg.mO||(Bb.pg.mO={},Bb.pg.mO.HeadersList=
[]);Bb.pg.mO.IsFullTableHeaders=!0;for(var Nc=0;Nc<qc.length;++Nc)Bb.pg.mO.HeadersList[Nc]={},Bb.pg.mO.HeadersList[Nc].Index=Nc,Bb.pg.mO.HeadersList[Nc].Name=qc[Nc];Bb.qGf(!0);Bb.wV=Bb.S1e();Bb.dh.$Ia(Bb.Et,Bb.wV,!0,void 0,void 0,!0);Bb.show()}else La.ULS.sendTraceTag(537162012,0,10,"FormulaAssistanceControl.OnGetTableColHeadersSuccess - Webservice call returned no results")};Bb.MLi=function(qc){qc=oc.a.Mf(qc.data);La.ULS.sendTraceTag(537162011,0,10,"FormulaAssistanceControl.OnGetTableColHeadersFailure - Webservice call failed with Errors: {0}",
we.a.Ec(qc))};Bb.wsf=function(qc,Nc){Bb.gridView.isEditing||Bb.gridView.ui||Bb.TNa(null===Nc||void 0===Nc?void 0:Nc.cell)};Bb.Dh=function(qc,Nc){Bb.TNa(null===Nc||void 0===Nc?void 0:Nc.Pia)};Bb.a6=function(qc,Nc){Bb.nLd(Nc.newValue)};Bb.Rc=function(){(ha.EwaSettings.isChangeGateEnabled("OfficeVSO:6518663_FlightRemovalAutocompleteTableColumnHeaders")||Bb.Ck)&&Bb.set_visible(!1)};Bb.qwf=function(){Bb.iGa=null;Bb.k8=null};Bb.uh=function(){Bb.Ck&&Bb.e1a()};Bb.onFunctionInfoLoaded=function(){Bb.$nb()};
Bb.iya=function(){Bb.Rja?(Bb.k8=null,Bb.iGa=null,Bb.$nb()):Bb.Ig.Gk&&Bb.kre()};Bb.qca=function(){Bb.RP&&za(Bb.$,Bb.RP.HelpId,Bb.RP.IsDynamicUdf);return!0};Bb.tca=function(qc,Nc){0==Nc.Cq&&(170==Nc.Ef.operation.operationName&&Bb.formulaAssistanceTelemetryManager.cjc++,Bb.$.userOperationManager.so(Bb.tca))};Bb.pOa=function(qc,Nc){0==Nc.Cq&&(12==Nc.Ef.operation.operationName&&Bb.$.userOperationManager.zr(Bb.tca),Bb.$.userOperationManager.so(Bb.pOa))};Bb.e1a=function(){Bb.Ck&&Bb.Usd();Bb.wH&&Bb.Ya.isEditing&&
Bb.Ema();Bb.Gq=null;Bb.formulaAssistanceUIControl&&(Bb.formulaAssistanceUIControl.dismiss(Bb.c0b),Bb.dr.canReceiveFocus=!1);Bb.Hld=!1};Bb.oBf=function(){Bb.wH&&Bb.Ema();Bb.b3f();1===Bb.$Vf.type&&ha.EwaSettings.tb()&&!Bb.Ya.text.includes("\n")&&Bb.IDd(Bb.$Vf)};Bb.onDismiss=function(){Bb.isListVisible=!1;Bb.gridView.Gi.textBox.focus()};Bb.SQa=function(){var qc={};Bb.dh.Lhc?qc[qb.a.NU]="SmartSuggestionsCard":qc[qb.a.NU]="FunctionAndSmartSuggestionsCard";Bb.$.Fd(802602464,0,8,qc)};Bb.Oyd=function(qc,
Nc){Bb.dh.Qcg(Nc);Bb.Ck&&(Bb.hIa=!0)};Bb.Nyd=function(qc){Bb.Ck&&(Bb.eIa=!0);Bb.wH?(Bb.Fze(),Bb.y9&&Bb.yUf(),Bb.gridView.Gi.endEdit(!0,"FormulaAssistanceControl.OnCompletionItemClicked",0)):qc.textEdit?Bb.mqb(qc.textEdit):Bb.Hy(!0)};Bb.Mq=Ob.g(Ja);Bb.domElement.className=Le.a.CLe;Bb.Ig=Cd.E2c(Ja,mc);Bb.Q5b=new ea(Ja);Bb.Kwg=mc;f.ojd||(f.ojd=f.wJa());Bb.domElement.innerHTML=f.ojd;Bb.Nxd=RegExp("\\d+");lb.d(Bb.style,Bb.$.isChromeRtl);Bb.Qia=new U(Bb.$,Bb.domElement,Bb.functionInfoManager,Bb.formulaAssistanceUIControl,
Bb.formulaAssistanceTelemetryManager,Bb.pluginScheduler);Lb=$get(sa.gbd,Bb.domElement);mc=$get(sa.cbd,Bb.domElement);xc=$get(sa.ibd,Bb.domElement);Bb.jog=new z(Bb.$,Lb,xc,mc,Bb);Bb.Ig.eZb(Bb.iya);Bb.functionInfoManager.mYa(Bb.onFunctionInfoLoaded);Bb.functionInfoManager.vEg(Bb.qwf);Bb.c0b=Bb.domElement;Bb.Ck&&(Bb.$.va.If(Bb.uh),Bb.dh.IUc(Bb.oBf),ha.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceNoLayer",!1)&&(Bb.c0b=document.createElement("div")));Bb.pSa(!0);Bb.t6f(!0);
Bb.$.domElement.appendChild(Bb.c0b);Bb.NPc=0;(mc=me.a(Ja))&&Bb.mJa.push(new T(Ja,mc,Bb,Bb.formulaAssistanceTelemetryManager));Bb.mJa.push(new T(Ja,Bb.Mq.Wb,Bb,Bb.formulaAssistanceTelemetryManager));Bb.aub=Bb.mJa[0];Bb.ypb=Bb.mJa[Bb.mJa.length-1];Ja.da.Ga(221,Bb);Bb.instantaneousSupportInformationManager||Bb.$.da.Za(268,function(qc){Bb.instantaneousSupportInformationManager=qc});Bb.ZQe=ha.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.LETAutocomplete",!1);ha.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.MockSetActiveCell",
0)&&(void 0===Bb.formulaAssistanceTelemetryManager.Cda.anyPluginInitialized?La.ULS.sendTraceTag(523511372,0,15,"FormulaAssistanceControl - tried to initiailize mockSetActiveCellExperimentStage before pluginInitialized data is set."):Bb.formulaAssistanceTelemetryManager.Cda.anyPluginInitialized||(Bb.FCb=ha.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.MockSetActiveCell",0)));Bb.FAa=ab.a.T4(Bb.$);Bb.Ixc=ab.a.Uwa(Bb.$);Bb.oxd=ha.EwaSettings.isChangeGateEnabled("OfficeVSO:5656143_SendCellFormatOnCellChanged");
Bb.k2=ha.EwaSettings.isChangeGateEnabled("OfficeVSO:6352308_addTelemetryAtFormulaAssistance");Bb.wXc=ha.EwaSettings.isChangeGateEnabled("OfficeVSO:6488306_BlockFormulasuggestionInPivotTable");ab.a.mV()&&Bb.Mkd();ab.a.RM(Bb.$)&&Lb.classList.add("ewa-fb-refactor");Bb.Ck?Bb.gridView.ha.vG(Bb.Rc):Bb.gridView.ha.lP(Bb.Rc);Bb.dr=new ka(Bb.$,Bb.formulaAssistanceUIControl,1,Bc.a.Mad,Bb.Tgd);Bb.mmd=ha.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertToSheetGridCell",!1);Bb.y9=ha.EwaSettings.isChangeGateEnabled("OfficeVSO:6378161_addKeptSmartSuggestionsMetric");
Bb.Ubf=ha.EwaSettings.isChangeGateEnabled("OfficeVSO:6279033_logAutocompletionStatistics");Bb.Jhi=ha.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceGridView",!1);Bb.lcf=ha.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FixKeydownLayoutTrashingBottleneck",!1)&&ha.EwaSettings.isChangeGateEnabled("OfficeVSO:6347847_FormulaAssistanceLayoutFix");return Bb}function v(){}function r(){this.callbacks=this.completionItems=null;this.activeItemIndex=0}function y(){this.onRestoreFocus=
this.onDismiss=this.onFeedback=this.onCompletionItemCommitted=this.onCompletionItemSelected=null}function m(){this.r9=this._name=null}function w(){this._name=null}function B(){this._name=null}function A(){this.r9=this._name=null}function z(Ja,Lb,mc,xc,hd){Ja=nf.call(this,Ja,Lb)||this;Ja.$qa=null;Ja.Buc=0;Ja.ZLb=0;Ja.c3b=null;Ja.rUe=mc;Ja.iub=xc;Ja.formulaAssistanceControl=hd;Ja.mq=[];Ja.dW=[];Ja.Ck=ab.a.I4();Ja.Ydf=Ja.Ck&&ha.EwaSettings.isChangeGateEnabled("OfficeVSO:5931218_FaAvoidDomOperations");
return Ja}function x(){this.textEdit=this.label=null;this.kind=0;this.shouldRequestAutocompleteOnCommit=this.isPrefixed=this.detail=this.type=null}function D(Ja,Lb){this.$=Ja;this.items=Lb;this.T4=ab.a.T4(this.$)}function I(Ja,Lb){this.F_i=Ja;this.Cqf=Lb}function F(){}function G(Ja){this.index=Ja}function T(Ja,Lb,mc,xc){Ja=Pd.call(this,Ja,Lb)||this;Ja.formulaAssistanceControl=mc;Ja.formulaAssistanceTelemetryManager=xc;Ja.FDf=!1;Ja.GRa=null;Ja.Zjd=0;Ja.kFc=null;Ja.OHa=null;Ja.SP=0;Ja.lob=Lb.textBox;
Ja.Ck=ab.a.I4();Ja.M9i=ha.EwaSettings.tb();Ja.k2=ha.EwaSettings.isChangeGateEnabled("OfficeVSO:6352308_addTelemetryAtFormulaAssistance");return Ja}function O(){this.Dha=this.Csa=this.Dsa=!1;this.TDf=40;this.Bye=41;this.E_a=this.yBd=this.zBd=this.AFb=0;this.Luf=!0;this.fAd=!1;this.GSe=this.bMd=-1}function U(Ja,Lb,mc,xc,hd,Cd){var dc=ic.call(this,U.wJa(ab.a.I4()))||this;dc.$=Ja;dc.yj=Lb;dc.functionInfoManager=mc;dc.formulaAssistanceUIControl=xc;dc.formulaAssistanceTelemetryManager=hd;dc.pluginScheduler=
Cd;dc.r1a=null;dc.y2=0;dc.dr=null;dc.eWc=!1;dc.Gq=null;dc.Nka=null;dc.CRa=!0;dc.LQ=!1;dc.rba=ha.EwaSettings.isChangeGateEnabled("OfficeVSO:6409372_isGroupwisePluginOperationsUsed");dc.Ddf=ha.EwaSettings.isChangeGateEnabled("OfficeVSO:6592409_startArgumentAssistanceTimerBeforeAutocompleteCalculation");dc.onCardModeChange=function(Ec){dc.TNb(Ec);1===Ec?dc.formulaAssistanceTelemetryManager.U9.argumentAssistanceCollapseCounter++:dc.formulaAssistanceTelemetryManager.U9.argumentAssistanceExpandCounter++};
dc.SQa=function(Ec){var gb={};gb[qb.a.NU]="ArgumentAssistanceCard";var Bb={};Bb.FunctionName=Ec.functionName;gb[qb.a.T9c]=Bb;dc.$.Fd(802602464,0,8,gb)};dc.onDismissClick=function(){dc.formulaAssistanceTelemetryManager.U9.argumentAssistanceDismissCounter++;dc.CRa=!1;dc.csb();dc.LQ&&dc.OG.clear();0===dc.y2&&dc.TNb(1)};dc.Af=function(){dc.CRa=!0;dc.LQ&&dc.OG.clear()};dc.bKi=function(Ec){Ec.button===Sys.UI.MouseButton.leftButton&&Ec.target&&(Aa.g(Ec),dc.r1a&&dc.r1a.eSa(Ec))};dc.Xs=function(){void 0!==
dc.Gq&&null!==dc.Gq&&dc.Gq()};dc.Ck=ab.a.I4();dc.H4=dc.Ck&&ha.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ArgumentAssistanceDismiss",!1);dc.Ck?(dc.PNd(),dc.dr=new ka(dc.$,dc.formulaAssistanceUIControl,0,Bc.a.Jad),dc.H4&&Ob.g(dc.$).$b.tm(dc.Af),dc.LQ=ha.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceDismiss",!1)&&ha.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceDrag",!1)&&!!dc.formulaAssistanceUIControl,dc.LQ&&(dc.OG=new J(dc.formulaAssistanceUIControl,
dc.formulaAssistanceTelemetryManager)),ha.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceNoLayer",!1)&&dc.$.domElement.appendChild(dc.domElement)):(dc.r1a=new C(dc.domElement,dc.$.hE,void 0,ab.a.RM(dc.$)),dc.Ac.ka("mousedown",dc.bKi),Ja=$get(sa.gbd,dc.yj),dc.yj.insertBefore(dc.domElement,Ja));Ob.g(dc.$).view.Es(dc.Xs);return dc}function J(Ja,Lb){this.lJa=Ja;this.formulaAssistanceTelemetryManager=Lb;this.Ym=!1;Ja={};this.usageCount=(Ja[Hd.Drag]=0,Ja[Hd.Move]=0,Ja);this.DCc=
this.lJa.getWindowEdgeBuffer()+1;this.zpf=new K(this);this.sIe=new H(this)}function H(Ja){this.OG=Ja;this.Ym=!1}function K(Ja){var Lb=this;this.OG=Ja;this.EZ=this.XPd=this.Ym=!1;this.onKeyDown=function(mc){return!Lb.EZ&&mc.keyCode===cc.a.Doa&&mc.altKey&&mc.ctrlKey?(Lb.O7b(),mc.stopPropagation(),mc.preventDefault(),!0):!1};this.GMa=function(mc){if(!Lb.EZ)return!1;if(mc.eventName===Be.a.Lb){var xc=mc.Ca.ctrlKey?1:mc.Ca.shiftKey?50:10;switch(mc.Ca.keyCode){case cc.a.CTa:Lb.O5(0,-xc);break;case cc.a.Boa:Lb.O5(0,
xc);break;case cc.a.Coa:Lb.O5(-xc,0);break;case cc.a.ffb:Lb.O5(xc,0);break;case cc.a.jL:case cc.a.Oh:Lb.XPd=!0;break;default:return!1}}mc.eventName===Be.a.Gd&&Lb.XPd&&Lb.O3(!0);mc.Ca.preventDefault();return!0};this.YFb=function(mc){if(!Lb.EZ)return!1;mc.Ca.preventDefault();Lb.O3();return!0};this.onBlur=function(){if(!Lb.EZ)return!1;Lb.O3();return!0};this.ir=bc.KeyInputManager.instance;this.pointerInputManager=Tc.a.instance}function N(){this.callbacks=this.functionRenderingInfo=null;this.cardMode=
0}function M(){this.onDismissClick=this.onFeedback=this.onHelpLink=this.onCardModeChange=null}function C(Ja,Lb,mc,xc){xc=void 0===xc?!1:xc;Lb=Q.call(this,Ja,Lb,!1,void 0===mc?null:mc)||this;Lb.oRa(xc);Lb.Vi=wb.a.equals("rtl",Ja.dir,!0);return Lb}function Q(Ja,Lb,mc,xc){var hd=Qb.call(this,Ja,void 0===xc?null:xc)||this;hd.y3=null;hd.rTd=!1;hd.uMb=!1;hd.p1a=null;hd.z7=null;hd.offsetParent=null;hd.WEi=null;hd.MIc=!1;hd.prg=null;hd.$yd=function(Cd){return hd.d6(Cd)};hd.Zyd=function(Cd){return hd.lN(Cd)};
hd.lvf=function(Cd){var dc=ec.HelperMethods.En(Cd);dc.button===Sys.UI.MouseButton.leftButton&&2===Cd.lb&&(hd.Xmd(dc.target)||hd.eSa(dc));return!1};hd.p4d=Lb;mc&&(hd.rTd=!0,Tc.a.instance.ra(Be.a.pointerDown,hd.wIe,hd.lvf));hd.$ea=!1;return hd}function P(Ja,Lb){var mc=fd.call(this)||this;mc.pog=[];mc.kbd={};mc.lbd={};mc.QS=null;mc.I8=[];mc.tJa={};mc.Fwf=function(xc,hd){La.ULS.sendTraceTag(537161987,0,50,"FunctionInfoManager.OnGetFunctionListPartialSucceeded");mc.rwf(xc,!!hd&&1!==hd.FilterType,!0)};
mc.Ewf=function(){La.ULS.sendTraceTag(537161986,0,50,"FunctionInfoManager.OnGetFunctionListPartialFailed -  reset varaible to ensure we will re-issue the webservice call");mc.QS=null};mc.owf=function(xc){La.ULS.sendTraceTag(537161985,0,50,"FunctionInfoManager.OnFullFunctionListLoaded - full list was loaded");mc.BGd(xc.Yia,!0,!1)};mc.Dwf=function(xc){La.ULS.sendTraceTag(537161984,0,50,"FunctionInfoManager.OnGetFunctionListFullSucceeded");mc.rwf(xc,!0,!1)};mc.nKc=!1;mc.lKc=!1;mc.jb=Ja;mc.pluginScheduler=
Lb;mc.$.da.Ga(19,mc);return mc}function ka(Ja,Lb,mc,xc,hd){this.eka=this.WYc=!1;this.$=Ja;this.formulaAssistanceUIControl=Lb;this.STe=mc;this.Tkj=xc;this.n4e=void 0===hd?null:hd;this.eka=ha.EwaSettings.isChangeGateEnabled("OfficeVSO:6592066_FixAutoCompleteCardFocusBug")}function R(Ja,Lb,mc){var xc=cf.call(this)||this;xc.hbd=Ja;xc.pMd=Lb;xc.LVi=mc;return xc}function fa(Ja){var Lb=ke.call(this)||this;Lb.pMd=Ja;return Lb}function ca(Ja,Lb){var mc=bf.call(this)||this;mc.functionName=Ja;mc.hbd=Lb;return mc}
function ea(Ja){this.SFe={};this.$=Ja}function wa(){this.sheetName=this.namedRange=this.tooltip=this.name=null;this.type=0}function X(Ja){this.WS=0;this.P7d=!1;this.yVa=this.m9d=null;this.Uqg=void 0===Ja?!1:Ja;this.textEdit=null}function ja(Ja){var Lb=this;this.qrb=this.nha=this.calcManager=this.Ya=null;this.i9a=function(){Lb.O4a(!1,!1)};this.$=Ja;this.$tb=new ua(Ja);this.f$b=new aa(Ja);this.g$b=new va(this);Ob.g(Ja).Wb.tm(this.i9a);this.$.da.Ga(317,this)}function va(Ja){this.I7=0;this.Kad=Ja}function ua(Ja){this.lqa=
this.rSa=this.Q1a=this.KP=this.E$=this.Ya=null;this.Rhd=!1;this.Dc=Ja}function Xa(){}function aa(Ja){var Lb=this;this.Gyi=30;this.calcManager=null;this.Bd=!1;this.DOa=this.OFb=this.p$a=null;this.$x=function(){Lb.pha.JZ()};this.$=Ja;this.pha=new oa;this.JRf=-1;this.$.ea.RD(this.$x)}function ba(Ja,Lb,mc,xc,hd,Cd,dc){dc=Ja.Na(1,void 0===dc?null:dc);dc.getPartialCalcResultsParameters=Lb;return Gc.g(Ja,"GetPartialCalcResults",dc,mc,xc,hd,Cd,4)}function oa(){this.kQa={}}function ra(Ja){var Lb=uc.call(this)||
this;Lb.$=Ja;Lb.Eb();return Lb}function db(Ja,Lb){var mc=this;this.sJa=this.xua=this.Ria=null;this.aAf=function(xc,hd){mc.Y4i(hd.functionName,hd.hbd)};this.cAf=function(xc,hd){mc.X4i(hd.hbd,hd.pMd,hd.LVi)};this.bAf=function(xc,hd){xc=[];hd=bk(hd.pMd);for(var Cd=hd.next();!Cd.done;Cd=hd.next())Cd=Cd.value,(!mc.fwa||void 0!==Cd&&null!==Cd)&&(Cd=Cd.trim())&&xc.push(Cd);if(!mc.fwa||xc.length){hd="";for(Cd=0;Cd<xc.length;Cd++){var dc=mc.eYc(xc[Cd]),Ec=db.$Cd(Cd,xc.length);hd+=dc+Ec;Ec&&(hd+=mc.ariaLiveNotifier.uxa)}mc.ariaLiveNotifier.readText(hd)}};
this.dAf=function(xc,hd){mc.ariaLiveNotifier.$4i(hd.JF,hd.description,hd.selectedIndex.toString(),hd.length.toString())};this.Xzf=function(xc,hd){mc.ariaLiveNotifier.eLf(hd.description,hd.length)};this.jwf=function(){mc.ariaLiveNotifier.mab(kb.a.instance.ga(881),qb.a.aZa)};this.cwf=function(){mc.ariaLiveNotifier.readText(kb.a.instance.ga(882))};this.fwf=function(){mc.ariaLiveNotifier.readText(kb.a.instance.ga(883))};this.$=Lb;this.ariaLiveNotifier=Ja;this.$.da.Ga(219,this);this.fwa=ab.a.I4()}function Ka(Ja){return Rc.call(this,
Ja)||this}function Ga(Ja,Lb,mc){var xc=this;this.$=Ja;this.Va=Lb;this.functionInfoManager=mc;this.PDh="FinancialFns LogicalFns TextFns DateTimeFns LookupReferenceFns MathTrigFns StatisticalFns EngineeringFns CubeFns InformationFns".split(" ");this.menuId=null;this.onFunctionInfoLoaded=function(){xc.menuId&&Array.contains(xc.PDh,xc.menuId)&&xc.frame.Lw(xc.menuId)};this.SZ=ab.a.SZ(this.$);this.vwa=ab.a.vwa(this.$);this.Hki=ab.a.kod();this.SZ&&(this.formulaAssistanceManager=this.$.da.za(464));this.sY=
{};this.frame=this.$.frame;this.functionInfoManager.mYa(this.onFunctionInfoLoaded);this.formulaAssistanceTelemetryManager=Ja.da.za(491)}function xa(Ja){return Ja.Params.split("!")[0].split(",").map(function(Lb){return{name:Lb,description:"Mock description for param "+Lb+". How Mmuch wood would a wood chuck chuck if a wood chuck would chuck wood",type:"text"}})}function da(Ja,Lb){var mc=Ac.call(this,Ja)||this;mc.p$b=Lb;mc.JDh=function(xc,hd){var Cd;1===xc&&(mc.hide(),xc={},hd=(xc[Yb.a.Nc]=mc.p$b.NameUI,
xc.functionArgs=null!==(Cd=hd.functionArgs)&&void 0!==Cd?Cd:[],xc.ibdk=!0,xc),Cd=new yb.a(-433697611,0,mc.$.Jc,8,null),mc.$.Ka.Kb(Cd,hd))};mc.KHh=function(xc){return{name:"argument_"+xc,description:"mock argument description. she sells sea shells at the sea shore shop",type:"number"}};mc.zl=kb.a.instance.ga(1027);mc.rg();return mc}function qa(Ja,Lb){var mc=fb.call(this,Ja,kb.a.instance.ga(1026),void 0,void 0,void 0,ha.EwaSettings.ma(397))||this;mc.rJa=null;mc.Xia=null;mc.qJa=null;mc.kub=null;mc.oUe=
null;mc.Wia=null;mc.pUe=null;mc.sUe=null;mc.kkf=null;mc.jub=null;mc.hid=!1;mc.B1b=null;mc.Q5=null;mc.Ywb=null;mc.onFunctionInfoLoaded=function(){if(!mc.qJa.count){for(var xc=mc.functionInfoManager.bbd,hd=0,Cd=xc.length;hd<Cd;++hd)mc.qJa.ML(xc[hd],xc[hd],!1).className=Qa.a.znh;mc.qJa.selectedIndex=0;cb.a.oc([mc.B1b,mc.Q5,mc.Ywb]);mc.B1b=mc.je.Sd(mc.rJa);mc.Q5=mc.je.Sd(mc.Xia);mc.Ywb=mc.je.Sd(mc.jub);mc.B1b.ka("change",mc.pwf);mc.Q5.ka("change",mc.cKi);mc.Q5.ka("dblclick",mc.dKi);mc.Ywb.ka("click",
mc.qca);mc.Ywb.ka("keyup",mc.iMi);Mb.DOMElementExtensions.setVisible(mc.Xia,!0);Mb.DOMElementExtensions.setVisible(mc.oUe,!1);mc.$.q4c&&Mb.DOMElementExtensions.setVisible(mc.kkf,!0)}mc.pwf(null);mc.getButton(0).get_element().disabled=!1;mc.rJa.disabled=!1;mc.gRa();mc.hid=!0};mc.qca=function(){mc.N$&&za(mc.$,mc.N$.HelpId,mc.N$.IsDynamicUdf)};mc.iMi=function(xc){13!==xc.keyCode&&32!==xc.keyCode||mc.qca(xc)};mc.pwf=function(){var xc=mc.functionInfoManager.Pac(mc.qJa.fe.value);mc.Bua(xc);mc.Xia.scrollTop=
0;mc.TXf()};mc.cKi=function(){mc.TXf()};mc.dKi=function(xc){mc.N$&&(Aa.g(xc),mc.close(0))};mc.Uc=function(xc,hd){Kb.b(hd)&&mc.It()};mc.functionInfoManager=Ja.da.za(19);mc.formulaAssistanceControl=Ja.da.za(221);mc.Lad=ab.a.SZ(mc.$);mc.Lad&&(mc.formulaAssistanceManager=Ja.da.za(464));mc.RA=Lb;mc.BZc=Lb.textBox.caretPosition;return mc}function na(Ja){var Lb=ma.call(this,Ja)||this;Lb.lUe=function(mc,xc){1===mc&&(Lb.hide(),mc={},xc=(mc[Yb.a.Nc]=xc.functionName,mc.ibdk=!0,mc),mc=ab.a.vwa(Lb.$)?1117706454:
-433697611,mc=new yb.a(mc,0,Lb.$.Jc,8,null),Lb.$.Ka.Kb(mc,xc))};Lb.onFunctionInfoLoaded=function(){Lb.functionInfoManager.Rab(Lb.onFunctionInfoLoaded);Lb.g9e()};Lb.l5h=function(mc){ta(Lb.$,mc,!1)};Lb.bef=function(mc){return!Lb.functionInfoManager.fgc(mc)};Lb.zl=kb.a.instance.ga(1026);Lb.functionInfoManager=Ja.da.za(19);Lb.rg();return Lb}function ia(Ja){var Lb=Wa.a.x_,mc=Ja.da.za(368);mc&&!Ob.g(Ja).pj&&(Lb=mc.zoom);return Lb}function ta(Ja,Lb,mc){if(mc){if(Lb&&(!Lb||Lb.startsWith("http://")||Lb.startsWith("https://"))){if(Ja.ma(157)&&
(Ja=Ja.da.za(269))&&Ja.pBa(Lb))return;ec.HelperMethods.Ze(Lb,"_blank",Cb.a)}}else ec.HelperMethods.RV(Ja.aG,"XLWAEndUser_"+Lb,Ja.nS)}function za(Ja,Lb,mc){if(Ja){var xc=Ja.da.za(491);xc?xc.U9.argumentAssistanceLearnMoreCounter++:La.ULS.sendTraceTag(523551513,0,50,"FormulaAssistanceExtensions: logHelpLinkClick getService returned a null formulaAssistanceManager");mc?ta(Ja,Lb,mc):(mc=new yb.a(-859308420,Yb.a.Cb,Ja.Jc,0,null),xc={},Lb=(xc[Yb.a.Nc]=qb.a.CQ,xc[Yb.a.Uf]="HelpID="+Lb,xc),Ja.Ka.Kb(mc,Lb))}}
function sa(){}var V=b(10),Ia=b(0),Ha=b(905),ob=b(51),ib=b(37),La=b(14),zb=b(19),Fb=b(407),Yb=b(76);sa.m9c="!";sa.cEf="[";sa.bEf="]";sa.openParen="(";sa.closeParen=")";sa.Rfg=" /.(*\\".split("");sa.r7b="...";sa.zFb="param_help_link";sa.UBd="param_help_udf";sa.gbd="function_list_box";sa.UDh="function_param_box";sa.ibd="function_reader_description";sa.cbd="function_description_box";sa.qUe="function_param_table";sa.KVi="param_row_";sa.VBd="param_set";sa.KEf="param_row_0";sa.LEf="param_row_1";sa.VDh=
"<div id='{0}' class='{1}'></div>";sa.TDh="<div id='{0}' class='{1} {2} {3}'>\r\n\t<table id='{4}'>\r\n\t\t{5}\r\n\t\t{6}\r\n\t</table>\r\n</div> ";sa.MEf="<tr>\r\n\t<td id='{0}'>\r\n\t\t<span id='{0}_{1}' class='{2}'></span>\r\n\t\t<a href = '#' id='{0}_{3}' class='{4}'></a>\r\n\t\t<span id ='{0}_{5}'></span>\r\n\t</td>\r\n</tr>";sa.QDh="<div id='{0}' class='{1} {2} {3}'></div>";sa.NDh="<div id='{0}' class='{1} {2} {3} {4}'></div>";sa.fjf="[@";sa.q3g=1;sa.p3g=3;sa.vch=500;sa.zof=50;Object(Ia.a)(sa,
"FormulaAssistanceConstants",null,[]);var kb=b(15),vb=b(389),Wa=b(8),qb=b(5),yb=b(91),ec=b(11),Ob=b(21),Cb=b(370),ab=b(36),ya;(function(Ja){Ja.CategoryList="categoryList";Ja.FunctionsMap="functionsMap";Ja.FunctionIdsToDisplay="functionIdsToDisplay";Ja.RefreshListCallback="refreshListCallback";Ja.HelpCallback="helpCallback";Ja.InitialCategory="initialCategory";Ja.AllCategoryName="allFunctionsCategoryName"})(ya||(ya={}));Object(Ia.b)("PropsKeys",ya);var ma=vb.a;Rk(na,ma);na.prototype.rg=function(){this.functionInfoManager.H1a({Filter:null,
FilterType:2,IncludeOneOfEachGroupUI:!0},!0);this.Rb=1;this.functionInfoManager.TZ?this.g9e():this.functionInfoManager.mYa(this.onFunctionInfoLoaded)};na.prototype.g9e=function(){var Ja;this.a_b=this.functionInfoManager.q$b.filter(this.bef);var Lb=null!==(Ja=na.$hf)&&void 0!==Ja?Ja:na.F_g;Ja=this.functionInfoManager.bbd;var mc=this.functionInfoManager.Pac(Lb).map(function(hd){return hd.FunctionIndex}),xc={};this.xx=(xc[na.Vv]=this.nc,xc[ya.CategoryList]=Ja,xc[ya.FunctionsMap]=this.g6g(),xc[ya.FunctionIdsToDisplay]=
mc,xc[ya.RefreshListCallback]=this.DMi.bind(this),xc[ya.HelpCallback]=this.l5h,xc[ya.InitialCategory]=Lb,xc[ya.AllCategoryName]=na.AllCategoryName,xc);this.initializeAndShow(this.zl,this.lUe,this.xx)};na.prototype.g6g=function(){var Ja={};this.a_b.forEach(function(Lb){Ja[Lb.FunctionIndex]=Lb});return Ja};na.prototype.wQj=function(Ja){Ja=Ja.map(function(Lb){return Lb.FunctionIndex});this.xx[ya.FunctionIdsToDisplay]=Ja;this.kTa(this.zl,this.Y3a(this.lUe),this.xx)};na.prototype.DMi=function(Ja,Lb){Lb?
Lb=this.pzh(Lb):(Lb=this.functionInfoManager.Pac(Ja).filter(this.bef),na.$hf=Ja);this.wQj(Lb)};na.prototype.pzh=function(Ja){Ja=void 0===Ja?"":Ja;Ja=Ja.toLocaleLowerCase();var Lb=this.a_b.filter(function(mc){return mc.NameUI.toLocaleLowerCase().startsWith(Ja)});3<=Ja.length&&(Lb.push.apply(Lb,ck(this.a_b.filter(function(mc){return mc.NameUI.toLocaleLowerCase().includes(Ja)&&!Lb.includes(mc)}))),Lb.push.apply(Lb,ck(this.a_b.filter(function(mc){return mc.Help.toLocaleLowerCase().includes(Ja)&&!Lb.includes(mc)}))));
return Lb};Mf.Object.defineProperties(na.prototype,{nc:{configurable:!0,enumerable:!0,get:function(){return"FunctionDialog"}}});na.AllCategoryName=kb.a.instance.ga(1025);na.F_g=kb.a.instance.ga(1024);na.$hf=void 0;Object(Ia.a)(na,"FunctionDialog",vb.a,[]);var ha=b(1),Z=b(95),Na=b(58),eb=b(63),cb=b(89),Ua=b(27),pa=b(218),Qa=b(71),Db=b(118),Kb=b(235),Ab=b(53),ub=b(938),Mb=b(12),Aa=b(69),Za=Qa.a.ynh,Zb=Qa.a.cMe,jb=Qa.a.dMe,Vb=Qa.a.j8c,Ic=Qa.a.Anh,Rb=Qa.a.Enh,kc=Qa.a.ZLe,xb=Qa.a.gMe,Va=Qa.a.Cnh,tb=Qa.a.$Le,
fb=pa.a;Rk(qa,fb);qa.prototype.initialize=function(){this.Gb.classList.add(Qa.a.wnh);this.Gb.innerHTML=qa.IG();this.Ae||(this.Dl(),this.n2());fb.prototype.initialize.call(this);var Ja=Mb.DOMElementExtensions.zj(this.Gb,tb);this.rtl&&(Ja.align="right",this.jub.style.marginLeft="5px");this.Ae&&(Ja.style.padding="1px");this.functionInfoManager.H1a({Filter:null,FilterType:2,IncludeOneOfEachGroupUI:!0},!0)};qa.prototype.dispose=function(){this.functionInfoManager&&(this.functionInfoManager.Rab(this.onFunctionInfoLoaded),
this.functionInfoManager.$.ea.wk(this.Uc));cb.a.oc([this.B1b,this.Q5,this.Ywb,this.qJa,this.kub]);fb.prototype.dispose.call(this)};qa.prototype.Dl=function(){this.rJa=Mb.DOMElementExtensions.zj(this.Gb,Za);this.Xia=Mb.DOMElementExtensions.zj(this.Gb,Zb);this.rJa.setAttribute(qb.a.Hd,qb.a.E_b);this.qJa=new ub.a(this.rJa,!0);this.kub=new ub.a(this.Xia,!0);this.oUe=Mb.DOMElementExtensions.zj(this.Gb,Rb);this.jub=Mb.DOMElementExtensions.zj(this.Gb,Ic);this.sUe=Mb.DOMElementExtensions.zj(this.Gb,xb);this.kkf=
Mb.DOMElementExtensions.zj(this.Gb,Va);this.pUe=$get(qa.dbd,this.Gb);this.Wia=Mb.DOMElementExtensions.zj(this.Gb,kc);this.Ae&&(this.Wia.style.paddingLeft="1px");this.functionInfoManager.mYa(this.onFunctionInfoLoaded);this.functionInfoManager.$.ea.Vj(this.Uc)};qa.prototype.DQ=function(Ja){var Lb=this;this.$.da.Za(40,function(){Lb.qJa.DQ(Ja)})};qa.prototype.pn=function(){this.Lad?this.formulaAssistanceManager.t6b():this.formulaAssistanceControl.set_visible(!1);fb.prototype.pn.call(this);this.hid||(this.getButton(0).get_element().disabled=
!0)};qa.prototype.setFocus=function(){!this.rJa.disabled&&this.hid&&Mb.DOMElementExtensions.setFocus(this.rJa)};qa.prototype.commit=function(){return!0};qa.prototype.lqb=function(){var Ja=this,Lb=this.N$.NameDataStrings;if(ha.EwaSettings.isChangeGateEnabled("OfficeVSO:5658291_FormulasTabImprovements")){var mc=new yb.a(-433697611,0,this.$.Jc,8,null),xc={};xc=(xc[Yb.a.Nc]=Lb,xc);this.$.Ka.Kb(mc,xc)}else{Lb+=sa.openParen;mc=Ob.g(this.$);mc.view.visibleArea.contains(mc.fg(null))||mc.fr(mc.ha.sa.activeCell,
3,Z.a.ODh);var hd=this.RA.textBox;if(this.RA.isEditing&&this.RA.text){xc=this.RA.text;var Cd=this.BZc?xc.substring(0,this.BZc):"=";this.RA.text=Cd+Lb+xc.substring(this.BZc+(hd.gv?hd.gv.length:0),xc.length);hd.caretPosition=Cd.length+Lb.length}else ib.TaskExtensions.Aa(mc.startEdit(!0,1),function(){Ja.RA.text="="+Lb;var dc=Lb.length+1;hd.$Qa(dc);hd.caretPosition=dc},this.la,11,eb.a.current);mc.pj&&(mc=mc.Wb,mc.text=hd.text,mc.setCaretPosition(hd.caretPosition));(mc=this.RA.lY.get(Fb.a.P2a))&&mc.$T(!1)}};
qa.prototype.nsa=function(){this.Lad?this.formulaAssistanceManager.lda():this.formulaAssistanceControl.$nb()};qa.prototype.Bua=function(Ja){this.kub.clear();for(var Lb=qa.dbd+" "+qa.jUe,mc=0,xc=Ja.length;mc<xc;++mc){var hd=this.kub.ML(Ja[mc].NameUI,Ja[mc].FunctionIndex.toString(),!1);Ua.a.Uu&&hd.classList.add(Vb);hd.setAttribute(qb.a.XD,qa.kUe);hd.setAttribute(qb.a.xG,Lb)}this.kub.selectedIndex=0};qa.prototype.TXf=function(){if(this.N$){this.jub.parentNode.className=Qa.a.$Le+(this.functionInfoManager.fgc(this.N$)?
"-udf":"");var Ja=this.N$.NameDataStrings;this.sUe.innerText=Ja;this.jub.innerText=Ja;this.Wia.innerText=this.N$.Help;Ja=this.N$.Params.split(sa.m9c);this.pUe.innerText=sa.openParen+(1<Ja.length?sa.r7b:Ja[0])+sa.closeParen}};qa.IG=function(){return String.format("<div class='"+Qa.a.xnh+"'>\r\n\t<label for='{6}'>{0}</label>\r\n\t<select id='{6}' class='{9}' disabled='true'></select>\r\n</div>\r\n<div class='"+Db.a.Cn+"'>{1}</div>\r\n<div class='"+Qa.a.YLe+"'>\r\n\t<select id='{16}' class='{17} "+zb.a.Gp+
" "+zb.a.Lo+"' size='{8}'></select>\r\n\t<div class='{11}' >{2}</div>\r\n</div>\r\n<div class='"+Qa.a.Bnh+"'>\r\n\t<div style='direction:ltr' class='{15}'>\r\n\t\t<span class='{14} "+zb.a.Gp+"'>\r\n\t\t\t<span class='"+zb.a.IA+" "+Qa.a.Dnh+"'>\r\n\t\t\t\t<img title='{3}' class='"+zb.a.ath+"' src='{4}'/>\r\n\t\t\t</span>\r\n\t\t</span>\r\n\t\t<span id='{19}' class='{13}'></span>\r\n\t\t<a tabindex='0' title='{5}' class='{10}'></a>\r\n\t\t<span id='{7}'></span>\r\n\t</div>\r\n\t<div id='{18}' class='{12}'></div>\r\n</div>",
kb.a.instance.ga(1029),kb.a.instance.ga(1030),kb.a.instance.ga(739),kb.a.instance.mb(3),Ab.a.Se(13),kb.a.instance.ga(1031),qa.MDh,qa.dbd,7,Za,Ic,Rb,kc,xb,Va,tb,qa.RDh,Zb+(Ua.a.Uu?" "+jb:""),qa.jUe,qa.kUe)};Mf.Object.defineProperties(qa.prototype,{nc:{configurable:!0,enumerable:!0,get:function(){return"FunctionDeprecatedDialog"}},N$:{configurable:!0,enumerable:!0,get:function(){if(!this.Xia||!this.Xia.firstChild)return null;var Ja=Number.parseInvariant(this.Xia.children[this.Xia.selectedIndex].value);
return this.functionInfoManager.HOh(Ja)}}});qa.dbd="function_dialog_param_string";qa.jUe="function_dialog_function_description";qa.kUe="function_dialog_function_name";qa.RDh="function_list";qa.MDh="function_category";Object(Ia.a)(qa,"FunctionDeprecatedDialog",pa.a,[]);var ac=b(324),Ac=vb.a;Rk(da,Ac);da.prototype.rg=function(){this.Rb=1;var Ja={};this.xx=(Ja[ac.a.Vv]=this.nc,Ja.functionInfo=this.p$b,Ja.initialArgs=this.LHh(this.p$b),Ja.evaluateCallback=this.NSg,Ja.generateArgByIndex=this.KHh,Ja.helpCallback=
this.RV,Ja.isModal=!1,Ja);this.initializeAndShow(this.zl,this.JDh,this.xx)};da.prototype.RV=function(){ta(this.$,this.p$b.HelpId,!1)};da.prototype.NSg=function(){return"42"};da.prototype.LHh=function(Ja){return xa(Ja)};Mf.Object.defineProperties(da.prototype,{nc:{configurable:!0,enumerable:!0,get:function(){return"FunctionArgumentsDialog"}}});Object(Ia.a)(da,"FunctionArgumentsDialog",vb.a,[]);Ga.prototype.Lc=function(Ja,Lb){if(!ha.EwaSettings.isChangeGateEnabled("OfficeVSO:5658291_FormulasTabImprovements"))return!1;
switch(Lb){case 753860909:case -2060563418:case 1117706454:case 917756490:case -1756230110:case -1702465186:case -977299160:case 2135922458:case -1960662393:case -1999560076:case 493672674:case -1031255406:case 548833656:case 641360851:case -433697611:return Ja=Ob.g(this.$).Gi,Ja.f5a||!Ja.isEditing||0>=Ja.text.length?!1:!0;default:return!1}};Ga.prototype.executeCommand=function(Ja,Lb,mc){var xc=this,hd,Cd;Ja=Lb.command;var dc=Ob.g(this.$),Ec=dc.Gi;switch(Ja){case 753860909:case -2060563418:null===
(hd=this.formulaAssistanceManager)||void 0===hd?void 0:hd.t6b();dc.inRangePicker&&Ec.bE(!1);this.Hki?new na(this.$):(new qa(this.$,Ec)).gf();this.formulaAssistanceTelemetryManager.O2a.dialogShownCounter++;break;case 1117706454:null===(Cd=this.formulaAssistanceManager)||void 0===Cd?void 0:Cd.t6b();dc.inRangePicker&&Ec.bE(!1);hd=this.functionInfoManager.IOh(mc[Yb.a.Nc]);new da(this.$,hd);mc.ibdk?this.formulaAssistanceTelemetryManager.O2a.argsDialogOpenedByDialogCounter++:this.formulaAssistanceTelemetryManager.O2a.argsDialogOpenedByRibbonCounter++;
break;case -433697611:mc.ibdk&&(this.vwa?this.formulaAssistanceTelemetryManager.O2a.argsDialogCommitedCounter++:this.formulaAssistanceTelemetryManager.O2a.dialogCommitedCounter++);var gb=mc[Yb.a.Nc]+sa.openParen;this.vwa&&(gb+=mc.functionArgs.join(this.$.listSeparator)+sa.closeParen);mc.UILocation&&this.$.Fd(-1075437823,-1,0,null);dc.view.visibleArea.contains(dc.fg(null))||dc.fr(dc.ha.sa.activeCell,3,Z.a.NCh);var Bb=Ec.textBox;mc=Ec.textBox.caretPosition;Ec.isEditing&&Ec.text?(hd=Ec.text,Cd=mc?hd.substring(0,
mc):"=",Ec.text=Cd+gb+hd.substring(mc+(Bb.gv?Bb.gv.length:0),hd.length),Bb.caretPosition=Cd.length+gb.length):ib.TaskExtensions.Aa(dc.startEdit(!0,1),function(){Ec.text="="+gb;if(xc.vwa)dc.endEdit(!0,"FormulaAssistanceCommandHandler.ExecuteCommand");else{var qc=gb.length+1;Bb.$Qa(qc);Bb.caretPosition=qc}},this.$.la,11,eb.a.current);dc.pj&&(mc=dc.Wb,mc.text=Bb.text,mc.setCaretPosition(Bb.caretPosition));this.SZ?this.formulaAssistanceManager.lda():(mc=Ec.lY.get(Fb.a.P2a),null===mc||void 0===mc?void 0:
mc.$T(!1))}return Na.Task.Ua(!0)};Ga.prototype.zc=function(Ja,Lb){switch(Lb.command){case 753860909:case -2060563418:case -433697611:return!0;case 1117706454:return this.vwa;default:return!1}};Ga.prototype.MEh=function(Ja,Lb){Lb=this.Va.jq(Lb);var mc=this.Va.Bc(),xc=this.functionInfoManager.Pac(Ja);if(!xc)return La.ULS.sendTraceTag(537162067,0,15,"FormulaAssistanceCommandHandler.GenerateFunctionMenu: functionList is null"),Lb.$D();for(var hd=this.vwa?1117706454:-433697611,Cd=0;Cd<xc.length;++Cd){var dc=
xc[Cd].NameUI,Ec=this.Va.LP(280,"Formulas."+Ja+"MenuItem_"+xc[Cd].FunctionIndex.toString(),hd,null,1,"None",0,0,dc,!1,0);Ec.label=dc;var gb=xc[Cd].Params.split(sa.m9c);Ec.VR(dc+" "+(sa.openParen+(1<gb.length?sa.r7b:gb[0])+sa.closeParen)+"\n"+xc[Cd].Help);mc.buttons.push(Ec)}Ja=this.Va.Bc();xc=this.Va.LP(280,"Formulas.MoreFunctionsMenuItem",-2060563418,zb.a.mPe,3,"Image16by16",1028,0,"Formulas.MoreFunctionsMenuItem",!1,0);Ja.buttons.push(xc);Lb.pc.push(mc);Lb.pc.push(Ja);return Lb.$D()};Ga.prototype.Qc=
function(Ja,Lb,mc){Ja=this.GOh(Lb);if(-1===Ja)return!1;this.menuId=mc.MenuId;if(!this.functionInfoManager.TZ)return this.functionInfoManager.H1a({Filter:null,FilterType:2,IncludeOneOfEachGroupUI:!0},!0),!1;Ja=this.functionInfoManager.bbd[Ja];this.sY[Ja]=this.sY[Ja]||this.MEh(Ja,mc.MenuId);mc.MenuItems=this.sY[Ja];return!0};Ga.prototype.GOh=function(Ja){switch(Ja){case "PopulateFinancialFnsMenu":return 2;case "PopulateLogicalFnsMenu":return 9;case "PopulateTextFnsMenu":return 8;case "PopulateDateTimeFnsMenu":return 3;
case "PopulateLookupReferenceFnsMenu":return 6;case "PopulateMathTrigFnsMenu":return 4;case "PopulateStatisticalFnsMenu":return 5;case "PopulateEngineeringFnsMenu":return 11;case "PopulateCubeFnsMenu":return 12;case "PopulateInformationFnsMenu":return 10;default:return-1}};Object(Ia.a)(Ga,"FormulaAssistanceCommandHandler",null,[429]);var Rc=Ha.a;Rk(Ka,Rc);Ka.prototype.Ad=function(){var Ja=this,Lb=ob.GetServiceTaskFactory.create(this.$.da,102,this.la,this.hb),mc=ob.GetServiceTaskFactory.create(this.$.da,
153,this.la,this.hb);ib.TaskExtensions.Aa(ib.TaskExtensions.Vd([Lb,mc],this.la),function(){Ja.jd([new Ga(Ja.$,Lb.result,mc.result)])},this.la,3)};Ka.ka=function(Ja){Ha.a.Qd(92,new Ka(Ja))};Object(Ia.a)(Ka,"FormulaAssistanceCommandHandlerFactory",Ha.a,[]);var Fc=b(232),wb=b(22);db.prototype.dispose=function(){this.SWd();this.sJa=this.xua=this.Ria=null};db.prototype.DWc=function(Ja){Ja&&(this.Ria=Ja,this.Ria.sme(this.aAf),this.Ria.ine(this.cAf),this.fwa&&this.Ria.hne(this.bAf))};db.prototype.EWc=function(Ja){Ja&&
(this.xua=Ja,this.fwa&&(this.xua.qme(this.jwf),this.xua.ome(this.cwf)),this.xua.pme(this.fwf))};db.prototype.FWc=function(Ja){Ja&&(this.sJa=Ja,this.sJa.IUc(this.dAf),this.sJa.mZb(this.Xzf))};db.prototype.SWd=function(){var Ja,Lb,mc;this.Ria&&(this.Ria.oPf(this.aAf),this.Ria.LPf(this.cAf),this.fwa&&this.Ria.KPf(this.bAf));this.sJa&&(this.sJa.EId(this.dAf),this.sJa.ksc(this.Xzf));this.fwa&&(null===(Ja=this.xua)||void 0===Ja?void 0:Ja.nPf(this.jwf),null===(Lb=this.xua)||void 0===Lb?void 0:Lb.lPf(this.cwf));
null===(mc=this.xua)||void 0===mc?void 0:mc.mPf(this.fwf)};db.prototype.Y4i=function(Ja,Lb){if(Lb){var mc="";this.fwa||(mc+=kb.a.instance.mb(57)+this.ariaLiveNotifier.uxa);for(var xc=0;xc<Lb.length;xc++)mc+=Ja+this.ariaLiveNotifier.uxa+this.eYc(Lb[xc])+db.$Cd(xc,Lb.length);this.fwa&&(mc+=kb.a.instance.ga(880)+this.ariaLiveNotifier.uxa);this.ariaLiveNotifier.readText(mc)}};db.prototype.X4i=function(Ja,Lb,mc){if(Ja){var xc="",hd=0;if(Lb){for(var Cd=0;Cd<Lb.length;Cd++)if(mc>=Ja[Cd].split(this.$.listSeparator).length)hd++;
else{var dc=Lb[Cd].trim();if(!dc)return;dc=this.eYc(dc);var Ec=db.$Cd(Cd-hd,Lb.length-hd);xc+=dc+Ec;Ec&&(xc+=this.ariaLiveNotifier.uxa)}this.ariaLiveNotifier.readText(xc)}}};db.prototype.eYc=function(Ja){if(!Ja)return"";var Lb=Ja.split(this.$.listSeparator);Ja="";Lb=bk(Lb);for(var mc=Lb.next();!mc.done;mc=Lb.next()){var xc=mc.value;db.Omd(xc)?Ja+=xc:(xc=(mc=db.Hji(xc))?xc.replace("[","").replace("]",""):xc,Ja+=String.format(mc?kb.a.instance.mb(59):kb.a.instance.mb(58),xc));Ja+=this.ariaLiveNotifier.uxa}return Ja};
db.$Cd=function(Ja,Lb){return Ja>=Lb||1===Lb?(La.ULS.shipAssertTag(537161997,0,Ja<Lb,"FormulaAssistanceControl.PositionInList: requested item index >= list length."),""):String.format(kb.a.instance.mb(55),Ja+1,Lb)+"\r\n"};db.Omd=function(Ja){return wb.a.contains(Ja,sa.r7b,!0)};db.Hji=function(Ja){return Ja.trimStart().startsWith(sa.cEf)||Ja.trimEnd().endsWith(sa.bEf)};Object(Ia.a)(db,"FormulaAssistanceReadoutHandler",null,[520,3]);var uc=Fc.a;Rk(ra,uc);ra.prototype.create=function(){var Ja=this,Lb=
this.$.da;ib.TaskExtensions.Aa(ob.GetServiceTaskFactory.Ra(Lb,211,212,this.hb),function(mc){mc=Lb.za(219)||new db(mc.result,Ja.$);Ja.pb(mc)},this.la,3)};ra.ka=function(Ja){Ja.da.Ga(220,new ra(Ja))};Object(Ia.a)(ra,"FormulaAssistanceReadoutHandlerFactory",Fc.a,[]);var Pb=b(738),sc=b(113),nb=b(1183),pc=b(54),Dc=b(45),oc=b(121);oa.prototype.Mfd=function(Ja){return this.kQa&&Ja in this.kQa?this.kQa[Ja]:null};oa.prototype.Q5f=function(Ja,Lb){this.kQa||(this.kQa={});this.kQa[Ja]=Lb};oa.prototype.JZ=function(){this.kQa=
null};Object(Ia.a)(oa,"FormulaAssistanceContextualPreviewCache",null,[]);var Gc=b(62);aa.prototype.dispose=function(){this.Bd||(this.$&&(this.$.ea.hD(this.$x),this.$=null),this.pha=this.OFb=null,this.Bd=!0)};aa.prototype.ycd=function(Ja,Lb,mc,xc){var hd=this;if(Lb&&0>=Lb.length)throw Error.argumentNull("GetContextualFormulaPreviewResults - currentFormula is null or empty");if(!Ja)throw Error.argumentNull("GetContextualFormulaPreviewResults - formulaSubExpressionObject is null");this.calcManager=this.$.da.za(266);
if(!this.calcManager)throw Error.invalidOperation("GetContextualFormulaPreviewResults failed - No CalcManager");var Cd="="+Lb.substring(mc.start,mc.end);ha.EwaSettings.ma(594)&&(Cd=this.calcManager.IXh(Ob.g(this.$).ha.sa.activeCell,Ja,mc));var dc=this.OKh(Cd,mc);if(ha.EwaSettings.ma(594)){if(dc&&!this.calcManager.isFormulaSubExpressionVolatile(Ja))return Promise.resolve(dc)}else if(dc)return Promise.resolve(dc);return this.QKh(Cd,mc).then(function(Ec){if(hd.l_c(xc))throw Error.create("OperationCanceledException");
if(!Ec||Ec.Kgj||Ec.Rma.startsWith("##UNSUPPORTED:"))return hd.TWe(Lb,Cd,mc,xc);hd.pha.Q5f(Cd,Ec.Rma);return Promise.resolve(Ec)})};aa.prototype.OKh=function(Ja,Lb){return(Ja=this.pha.Mfd(Ja))?new nb.a(Ja,Lb.start,Lb.end,0):null};aa.prototype.QKh=function(Ja,Lb){if(!Ja||0>=Ja.length||!Lb)throw Error.argument("GetContextualFormulaPreviewResultsFromFormulaInspector failed - Invalid currentFormula or formulaSpan");return this.calcManager.LSg(Ob.g(this.$).ha.sa.activeCell,Ja,this.Gyi,Lb)};aa.prototype.TWe=
function(Ja,Lb,mc,xc){var hd=this;if(!Ja||0>=Ja.length||!Lb||0>=Lb.length||!mc)throw Error.argument("GetContextualFormulaPreviewResultsFromFormulaInspector failed - Invalid currentFormula or formulaSpan");if(this.DOa)return this.PKh(Ja,Lb,mc,xc);var Cd={};Cd.PartialFormula=Lb;Cd.Formula=Ja;Cd.SourceRange=Dc.v(Ob.g(this.$).ha.sa.activeCell,this.$);return this.DOa=new Promise(function(dc,Ec){hd.OFb=new Pb.a;hd.JRf=hd.$.ea.Ue;hd.p$a=ba(hd.$.oa.xa,Cd,function(gb){hd.DTi(Lb,mc,xc,gb,dc,Ec)},function(gb){hd.DOa=
null;hd.p$a=null;Ec(gb)},null,null,null);hd.OFb.token.register(function(){hd.qUg(Ec)})})};aa.prototype.DTi=function(Ja,Lb,mc,xc,hd,Cd){this.p$a=this.DOa=null;if(this.JRf!==this.$.ea.Ue)Cd(Error.create("OperationCanceledException"));else if(xc.Result)if(xc=pc.a.Th(xc.Result),!xc||sc.a.isEmpty(xc))hd(null);else{for(var dc in xc)this.pha.Q5f(dc,xc[dc]);this.l_c(mc)?Cd(Error.create("OperationCanceledException")):(Ja=this.pha.Mfd(Ja))?(""===Ja&&(Ja=" "),hd(new nb.a(Ja,Lb.start,Lb.end,0))):Cd(Error.create("SubexpressionNotFoundException"))}else hd(null)};
aa.prototype.PKh=function(Ja,Lb,mc,xc){var hd=this;return new Promise(function(Cd,dc){hd.DOa.then(function(){hd.uSf(Ja,Lb,mc,xc,Cd,dc)}).catch(function(){hd.uSf(Ja,Lb,mc,xc,Cd,dc)})})};aa.prototype.uSf=function(Ja,Lb,mc,xc,hd,Cd){if(this.l_c(xc))Cd(Error.create("OperationCanceledException"));else{var dc=this.pha.Mfd(Lb);dc?hd(new nb.a(dc,mc.start,mc.end,0)):this.TWe(Ja,Lb,mc,xc).then(function(Ec){hd(Ec)}).catch(function(Ec){Cd(Ec)})}};aa.prototype.qUg=function(Ja){this.p$a&&(oc.a.ku(this.p$a.Dt)?
(this.DOa=this.p$a=null,Ja(Error.create("PendingWebReqeuestCancelled"))):La.ULS.sendTraceTag(537162063,0,10,"Failed to cancel the pending web request!"))};aa.prototype.JZ=function(){this.rUg();this.pha&&this.pha.JZ()};aa.prototype.rUg=function(){this.OFb&&this.OFb.cancel()};aa.prototype.l_c=function(Ja){return this.Bd||Ja.YJ};Object(Ia.a)(aa,"FormulaAssistanceContextualPreviewCalculator",null,[3]);var ld=b(162),gd=b(224);Xa.loh="ewa-facp-text-box";Object(Ia.a)(Xa,"CssClassNames",null,[]);ua.prototype.dispose=
function(){(this.E$||this.KP)&&this.L6e();this.Ya=this.lqa=null};ua.prototype.iQj=function(Ja,Lb,mc,xc){Ja&&Lb&&xc&&Lb.Rma&&!(1>Lb.Rma.length)&&(this.Ya=Ja,this.oOf(),this.Q1a=Lb,this.rSa=xc,this.Eyj(Lb,mc,xc))};ua.prototype.L6e=function(){this.z5h();this.oOf();this.rSa=this.Q1a=null};ua.prototype.Eyj=function(Ja,Lb,mc){var xc=this;if(Ja.Rma&&!(1>Ja.Rma.length)){var hd=this.Dc.da.za(266);if(hd){var Cd=hd.NQh();Cd&&ib.TaskExtensions.Aa(this.GBb,function(){if(Lb)if(ha.EwaSettings.ma(594)&&xc.Ya.isEditing&&
0<mc.length){xc.jxb(Ja.oJa,mc[0].start,null);var dc=xc.L1e(mc[0],Cd),Ec=xc.Ya.text.substring(mc[0].start,mc[0].end).trim();Ec=xc.Ya.text.indexOf(Ec);Ec=xc.Ya.text.substring(0,Ec).lastIndexOf("\n");xc.jxb(0>Ec||1>=mc.length?mc[0].start:Ec+1,mc[0].end,dc?String.format(dc,.3):null);for(var gb=1;gb<mc.length;gb++)dc=xc.L1e(mc[gb],Cd),Ec=xc.Ya.text.substring(mc[gb].start,mc[gb].end).trim(),Ec=xc.Ya.text.indexOf(Ec),Ec=xc.Ya.text.substring(mc[gb-1].end,Ec).lastIndexOf("\n"),xc.jxb(0>Ec?mc[gb-1].end:Ec+
1+mc[gb-1].end,mc[gb].end,dc?String.format(dc,.3):null);Ec=xc.Ya.text.substring(mc[mc.length-1].end,Ja.zua).indexOf("\n");xc.jxb(0>Ec?mc[mc.length-1].end:Ec+1+mc[mc.length-1].end,Ja.zua,null);La.ULS.sendTraceTag(537162061,0,50,"FormulaAssistanceContextualPreviewControl.ShowContextualFormulaPreviewContainer: Colored highlighting and partial evaluation completed")}else xc.jxb(Ja.oJa,Ja.zua,null),La.ULS.sendTraceTag(537162060,0,50,"FormulaAssistanceContextualPreviewControl.ShowContextualFormulaPreviewContainer: Default highlighting and partial evaluation completed");
xc.E$||(xc.E$=document.createElement(gd.a.div),xc.Ya.textBox.domElement.appendChild(xc.E$));xc.KP||(xc.KP=document.createElement(gd.a.div),xc.KP.className=Xa.loh,xc.Dc.domElement.appendChild(xc.KP));dc=Ja.zua;ha.EwaSettings.ma(594)&&xc.Ya.isEditing&&mc&&0<mc.length&&mc[0].start<dc&&mc[0].start!==Ja.oJa&&!xc.Ya.textBox.gv.length&&(dc=mc[0].start);gb=wb.a.contains(xc.Ya.textBox.Me.id,"FormulaBar",!0)&&wb.a.contains(xc.Ya.text.substring(Ja.oJa,Ja.zua),"\n",!0);Ec=xc.Ya.isEditing?xc.Ya.textBox.caretPosition:
0;dc=excelOnline.utils.getBoundingRectForText(xc.Ya.textBox.Me,gb?Ec:Ja.oJa,gb?Ec:dc,ha.EwaSettings.ma(594));xc.KP.style.left=ec.HelperMethods.jc(dc.left);xc.KP.style.top=ec.HelperMethods.jc(dc.top);xc.KP.style.width=ec.HelperMethods.jc(dc.width);xc.KP.style.height=ec.HelperMethods.jc(dc.height);dc=String.format("FormulaAssistancePreviewToolTip_{0}_{1}",Ja.zua,Ja.zua);dialogControls.renderToolTip(xc.E$,dc,Ja.Rma,xc.KP,0,!1,!1,1)},this.Dc.la,3)}}};ua.prototype.L1e=function(Ja,Lb){var mc=this.Ya.text,
xc=mc.substring(Ja.start,Ja.end);xc=xc.trim();Ja=mc.indexOf(xc,Ja.start);Lb=mc.indexOf(Lb,Ja);xc=mc.substring(Ja,Lb);xc=xc.trim();return this.Ya.colors.getItem(Ja+"-"+(Ja+xc.length))};ua.prototype.z5h=function(){var Ja=this;this.Ya&&this.E$&&this.KP&&ib.TaskExtensions.Aa(this.GBb,function(){Ja.Ya.textBox.domElement.contains(Ja.E$)&&(dialogControls.clearToolTip(Ja.E$),Ja.Ya.textBox.domElement.removeChild(Ja.E$),Ja.E$=null);Ja.Dc.domElement.contains(Ja.KP)&&(Ja.Dc.domElement.removeChild(Ja.KP),Ja.KP=
null)},this.Dc.la,3)};ua.prototype.jxb=function(Ja,Lb,mc){if(this.Ya&&!(Ja>=Lb)){var xc={};this.Ya.textBox.formatText(Ja,Lb-Ja,(xc.background=mc||"#E3DDCC",xc));this.Rhd=!0}};ua.prototype.oOf=function(){if(this.Ya&&this.Q1a&&this.Rhd){var Ja=this.Q1a.zua;ha.EwaSettings.ma(594)&&0<this.rSa.length&&this.rSa[this.rSa.length-1].end>Ja&&(Ja=this.rSa[this.rSa.length-1].end);var Lb={};this.Ya.textBox.formatText(this.Q1a.oJa,Ja-this.Q1a.oJa,(Lb.background=!1,Lb));this.Rhd=!1}};Mf.Object.defineProperties(ua.prototype,
{GBb:{configurable:!0,enumerable:!0,get:function(){var Ja=this;if(this.lqa)return this.lqa;var Lb=new ld.a;this.Dc.bB(function(mc){ib.TaskExtensions.Aa(mc.Csd(),function(){Lb.setResult(!0)},Ja.Dc.la,3)});return this.lqa=Lb.task}}});Object(Ia.a)(ua,"FormulaAssistanceContextualPreviewControl",null,[3]);var Cc=b(85),kd=b(47),Fd=b(44);va.prototype.f2f=function(Ja,Lb,mc){mc?this.n5g(Ja,Lb,mc):this.X3e(Ja,Lb,mc,!0)};va.prototype.nfj=function(){this.I7=0};va.prototype.n5g=function(Ja,Lb,mc){var xc=this;
this.I7++;var hd=this.I7;kd.a.instance.create(function(){xc.X3e(Ja,Lb,mc,hd===xc.I7)},500,Fd.a.OCh,!0,!0)};va.prototype.X3e=function(Ja,Lb,mc,xc){var hd=this,Cd=this.Kad.ycd(Ja,Lb);Cd&&Cd.then(function(dc){xc&&hd.Kad.Gnd(Lb)&&hd.Kad.hQj(Ja,dc,mc)}).catch(function(dc){dc=Object(Cc.a)(Error,dc);"OperationCanceledException"===dc.message?La.ULS.sendTraceTag(537162059,0,50,"GetContextualFormulaPreviewResults - caught exception: {0}",dc):La.ULS.sendTraceTag(537162058,0,10,"GetContextualFormulaPreviewResults - caught exception: {0}",
dc)})};Object(Ia.a)(va,"FormulaAssistanceContextualPreviewHoverManager",null,[]);var rb=b(206);ja.prototype.dispose=function(){this.iZc();cb.a.oc([this.$tb,this.f$b]);this.g$b=this.f$b=this.$tb=null;this.$&&Ob.g(this.$).Wb.Nl(this.i9a);this.nha=this.Ya=this.$=null};ja.prototype.Fyj=function(Ja,Lb){Lb&&rb.f(Lb.text)&&!(Lb.pwa||Lb.textBox.gv||this.Ya&&this.Ya.textBox.gv)&&(this.Ya=Lb,this.calcManager=this.$.da.za(266))&&(La.ULS.sendTraceTag(537162056,0,50,"FormulaAssistanceContextualPreviewManager.GetContextualPreviewResultsOnHover: Highlighting and partial evaluation initiated"),
Ja=ec.HelperMethods.Jub(Ja),Ja=this.calcManager.FXh(Ob.g(this.$).ha.sa.activeCell,this.Ya.text,Ja.x,Ja.y),Lb=this.calcManager.getSubExpressionSpan(Ja),!Lb||Lb.end<=Lb.start||this.Gnd(Lb)||(this.nha=Lb,this.g$b.f2f(Ja,Lb,!0)))};ja.prototype.UQd=function(Ja){if(Ja&&rb.f(Ja.text))if(Ja.textBox.gv&&Ja.textBox.gv.trim()){if(this.Ya=Ja,this.calcManager=this.$.da.za(266)){La.ULS.sendTraceTag(537162054,0,50,"FormulaAssistanceContextualPreviewManager.GetContextualPreviewResultsOnSelection: Highlighting and partial evaluation initiated");
Ja={};var Lb=this.Ya.textBox.gv.trim();Ja.start=this.Ya.text.indexOf(Lb,this.Ya.textBox.caretPosition);Ja.end=Ja.start+Lb.length;(Lb=this.calcManager.getFormulaSubExpressionObject(Ob.g(this.$).ha.sa.activeCell,this.Ya.text,this.Ya.textBox.gv))&&!this.Gnd(Ja)&&(this.nha=Ja,this.g$b.f2f(Lb,Ja,!1))}}else this.O4a(!1,!0)};ja.prototype.O4a=function(Ja,Lb){!this.Ya||Lb&&this.Ya.textBox.gv||(this.nha=null,Ja&&(this.iZc(),this.f$b.JZ(),this.g$b.nfj()),this.$tb&&this.$tb.L6e(),this.Ya.pwa||(this.Ya.pwa=!1,
this.Ya=null))};ja.prototype.ycd=function(Ja,Lb){if(!this.Ya||this.Ya.pwa)return null;this.iZc();this.qrb=new Pb.a;return this.f$b.ycd(Ja,this.Ya.text,Lb,this.qrb.token)};ja.prototype.hQj=function(Ja,Lb,mc){this.qrb=null;!Ja||!Lb||!Lb.Rma||0>=Lb.Rma.length?this.O4a(!1,!1):(Ja=this.calcManager.GXh(Ob.g(this.$).ha.sa.activeCell,Ja,this.Ya.text),this.$tb.iQj(this.Ya,Lb,mc,Ja))};ja.prototype.Gnd=function(Ja){return this.nha?Ja.start===this.nha.start&&Ja.end===this.nha.end&&Ja.pre===this.nha.pre&&Ja.post===
this.nha.post:!1};ja.prototype.iZc=function(){this.qrb&&this.qrb.cancel()};Object(Ia.a)(ja,"FormulaAssistanceContextualPreviewManager",null,[578,3,579]);var Kd=b(7),Qd=b(4),ve=b(233),Be=b(13),Ie=b(202),se=b(1292),Se=b(66),Le=b(986),rf=b(30),af=b(24),xe=b(64),Td=b(255),Bc=b(253),qd=b(169);X.prototype.EYf=function(Ja){this.WS=0;this.P7d=Ja.IsCompatibility;this.set_name(Ja.NameDataStrings);this.yVa=Ja.Help};X.prototype.opj=function(Ja){this.WS=1;this.set_name(Ja.Name)};X.prototype.Poj=function(Ja){this.WS=
2;this.set_name(Ja.name);this.yVa=Ja.tooltip};X.prototype.qqj=function(Ja){this.WS=3;this.set_name(Ja.name);this.yVa=Ja.toolTip};X.prototype.b_f=function(Ja){this.WS=4;this.set_name(Ja.name)};X.prototype.Isj=function(Ja){this.WS=5;this.set_name(Ja.name);this.yVa=Ja.toolTip};X.prototype.Hsj=function(Ja){this.WS=7;this.set_name(Ja.name)};X.prototype.frj=function(){this.WS=6;this.set_name(kb.a.instance.mb(187));this.yVa=kb.a.instance.mb(188)};X.prototype.set_name=function(Ja){return this.m9d=Ja};X.H9g=
function(){return Object(Kd.a)(new X(!0),{})};Mf.Object.defineProperties(X.prototype,{itemType:{configurable:!0,enumerable:!0,get:function(){return this.WS}},tfi:{configurable:!0,enumerable:!0,get:function(){return this.P7d}},name:{configurable:!0,enumerable:!0,get:function(){return this.label}},label:{configurable:!0,enumerable:!0,get:function(){return this.m9d}},Wia:{configurable:!0,enumerable:!0,get:function(){return this.yVa}},aAb:{configurable:!0,enumerable:!0,get:function(){return this.Uqg}}});
Object(Ia.a)(X,"AutoCompleteItem",null,[597]);Object(Ia.a)(wa,"DefinedNameInfo",null,[]);var Jd=b(189);ea.prototype.EMj=function(Ja){var Lb=this.SFe[Ja.toUpperCase()];if(!Lb)return{returnValue:!1,sheetName:"",range:null};Ja=Lb.sheetName;Lb=this.k2g(Lb.namedRange);return{returnValue:!0,sheetName:Ja,range:Lb}};ea.prototype.z2g=function(Ja){if(null!=Ja&&void 0!=Ja)return{top:Ja.top,left:Ja.left,bottom:Ja.bottom,right:Ja.right,maxRows:Ja.maxRows,maxColumns:Ja.maxColumns,sheetName:void 0}};ea.prototype.k2g=
function(Ja){if(null!=Ja&&void 0!=Ja)return new Jd.a(Ja.top,Ja.left,Ja.bottom,Ja.right,Ja.maxRows,Ja.maxColumns)};ea.prototype.s2g=function(Ja){switch(Ja){case 2:return 0;case 3:return 1;default:return-1}};Mf.Object.defineProperties(ea.prototype,{RFe:{configurable:!0,enumerable:!0,get:function(){var Ja=[];if(!this.$.vb||!this.$.vb.items)return Ja;for(var Lb=0,mc=ha.EwaSettings.isChangeGateEnabled("OfficeVSO:5951570_sendingNamedObjectsAutocompleteRequest")&&ab.a.SZ(this.$),xc=bk(this.$.vb.items),hd=
xc.next();!hd.done;hd=xc.next())if((hd=hd.value)&&(3===hd.type&&hd.usedRange||mc&&2===hd.type)){var Cd=new wa;Cd.tooltip=hd.sheetName+Se.a.exclamation+hd.usedRange.toString();Cd.name=hd.name;Cd.namedRange=this.z2g(hd.usedRange);Cd.sheetName=hd.sheetName;Cd.type=this.s2g(hd.type);Ja.push(Cd);this.SFe[hd.name.toUpperCase()]=Cd;++Lb;if(Lb===sa.zof){La.ULS.sendTraceTag(537162076,0,15,"Maximum number of defined names reached for formula assistance: {0}",sa.zof);break}}return Ja}}});Object(Ia.a)(ea,"DefinedNameInfoManager",
null,[]);var ad=b(130),Yd=b(276),pe=b(273),Wd=b(244),bf=Sys.EventArgs;Rk(ca,bf);Object(Ia.a)(ca,"FormulaAssistanceFunctionChangedEventArgs",Sys.EventArgs,[]);var ke=Sys.EventArgs;Rk(fa,ke);Object(Ia.a)(fa,"FormulaAssistanceSelectedParameterChangedEventArgs",Sys.EventArgs,[]);var cf=Sys.EventArgs;Rk(R,cf);Object(Ia.a)(R,"FormulaAssitanceSelectedParameterChangedEventArgs",Sys.EventArgs,[]);var Pe=b(272);ka.prototype.Sf=function(Ja,Lb){Ja=!1;Lb||(Ob.g(this.$).Gi.textBox.UJ=!0,Ja=this.formulaAssistanceUIControl.focus(this.STe));
return Ja};ka.prototype.$g=function(Ja){var Lb=this.ic;return!(void 0===Lb||null===Lb)&&Mb.DOMElementExtensions.nf(Lb,Ja)};ka.prototype.ej=function(){this.n4e&&this.n4e();if(this.eka){var Ja=Ob.g(this.$).Gi.textBox;this.selection=Ja.selection;Ja.removeSelection()}};ka.prototype.Aj=function(){this.eka&&(Ob.g(this.$).Gi.textBox.selection=this.selection)};ka.prototype.dispose=function(){Pe.a(this.$).Az(this)};Mf.Object.defineProperties(ka.prototype,{canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return this.WYc},
set:function(Ja){this.WYc!==Ja&&(Ja?Pe.a(this.$).Lh(this):Pe.a(this.$).Az(this),this.WYc=Ja)}},Yd:{configurable:!0,enumerable:!0,get:function(){return this.Tkj}},ic:{configurable:!0,enumerable:!0,get:function(){return this.formulaAssistanceUIControl.getRootElement(this.STe)}}});Object(Ia.a)(ka,"FormulaAssistanceFocusManager",null,[448,3]);var nc=b(38),Da=b(388),Sb=b(177),hb=b(34),Xb=b(295),jc=b(294),Wc=b(1120),fd=nc.a;Rk(P,fd);P.prototype.mYa=function(Ja){this.addHandler("FunctionInfoLoaded",Ja)};
P.prototype.Rab=function(Ja){this.removeHandler("FunctionInfoLoaded",Ja)};P.prototype.vEg=function(Ja){this.addHandler("FunctionInfoReset",Ja)};P.prototype.zaj=function(Ja){this.removeHandler("FunctionInfoReset",Ja)};P.prototype.dispose=function(){var Ja=this.$.da.za(268);Ja&&Ja.kId(this.owf);this.jb=null;fd.prototype.dispose.call(this)};P.prototype.aSf=function(){this.raiseEvent("FunctionInfoReset")};P.prototype.VJd=function(){this.aSf();this.nKc=!1;this.QS=null;this.lKc=!0};P.prototype.H1a=function(Ja,
Lb){var mc=this;Lb=void 0===Lb?!1:Lb;if(this.TZ)this.MJf();else{La.ULS.sendTraceTag(537161991,0,50,"Retrieving the list of function names for culture '{0}' from the server.",this.$.ya.UICultureTag);var xc=null;(xc=this.$.da.za(268))||La.ULS.sendTraceTag(537161990,0,50,"instantaneousSupportInformationManager == null");if((null===xc||void 0===xc?0:xc.Yia)&&0<xc.Yia.length)ha.EwaSettings.ma(122)?xc.pCh(this.Dwf):this.BGd(xc.Yia,!0,!1);else{var hd=this.$.oa.xa.Pb();Ja&&(this.$.ea.dc||Lb)&&!this.ohi&&
(Lb?Da.a(this.$.userOperationManager,function(Cd,dc,Ec){return Gc.p(mc.$.oa.xa,Ja,jc.b(Cd,mc.Fwf),jc.a(dc,mc.Ewf),Ec,Ja,hd)},function(Cd){return new Sb.a(130,0,Cd,16)},null):Gc.p(this.$.oa.xa,Ja,this.Fwf,this.Ewf,null,Ja,hd));!this.TZ&&this.$.ea.dc&&(xc?(La.ULS.sendTraceTag(537161989,0,50,"FunctionInfoManager.EnsureFunctionInfoAsync - Functions not loaded yet, wait for them. IsFullyLoaded={0}, IsSessionActive={1}",this.TZ,this.$.ea.dc),xc.rme(this.owf)):(La.ULS.sendTraceTag(537161988,0,50,"FunctionInfoManager.EnsureFunctionInfoAsync - instantaneousSupportInformationManager is null"),
Gc.p(this.$.oa.xa,{FilterType:0},this.Dwf,null,null,null,hd),this.lKc=!1))}}};P.prototype.HOh=function(Ja){return 0>Ja||Ja>=this.QS.length?null:this.QS[Ja]};P.prototype.zdd=function(Ja){return hb.a.yc(this.kbd,Ja.toUpperCase())};P.prototype.IOh=function(Ja){return hb.a.yc(this.lbd,Ja.toUpperCase())};P.prototype.Pac=function(Ja){return hb.a.yc(this.tJa,Ja)};P.prototype.fgc=function(Ja){return!Ja.GroupUI};P.prototype.rwf=function(Ja,Lb,mc){var xc=Xb.a(Ja);La.ULS.sendTraceTag(537161955,0,50,"FunctionInfoManager.OnFunctionListSuceeded: areNonStatusMessagesPresentInResult={0}",
xc);xc?(Ob.g(this.$).endEdit(!1,"FunctionInfoManager.OnFunctionListSuceeded"),this.$.ea.fp(Ja.Errors)):(this.BGd(Ja.Result,Lb,mc),ab.a.mV()&&!ab.a.SZ(this.$)&&this.xSj())};P.prototype.BGd=function(Ja,Lb,mc){La.ULS.sendTraceTag(537161954,0,50,"FunctionInfoManager.RefreshFunctionList: functionsInfo count = {0}, isCategorized = {1}, partialResult = {2} IsFullyLoaded = {3}",Ja.length,Lb,mc,this.TZ);this.TZ||(this.QS=Ja,this.yPg(Lb),this.nKc=!mc,this.MJf())};P.prototype.MJf=function(){this.raiseEvent("FunctionInfoLoaded")};
P.prototype.xSj=function(){this.pluginScheduler.notifier().setFunctionsInfo(this.q$b)};P.prototype.yPg=function(Ja){function Lb(Nc,nd){return Nc.NameUI.localeCompare(nd.NameUI)}var mc=kb.a.instance.ga(1024),xc=[];this.tJa={};this.I8=[];this.tJa[mc]=xc;var hd=kb.a.instance.ga(1025),Cd=[];this.I8.push(mc);this.I8.push(hd);mc=0;for(var dc=this.QS.length;mc<dc;mc++){var Ec=this.QS[mc];Ec.IsCompatibility||Cd.push(Ec);var gb=Ec.NameUI,Bb=Ec.NameDataStrings;this.kbd[Bb.toUpperCase()]||(this.kbd[Bb.toUpperCase()]=
Ec);this.lbd[gb.toUpperCase()]||(this.lbd[gb.toUpperCase()]=Ec);if(!this.fgc(Ec)){if(Ja){gb=Ec.GroupUI;var qc=hb.a.yc(this.tJa,gb);qc||(qc=[],this.tJa[gb]=qc,this.I8.push(gb));qc.push(Ec)}Ec.IsCommonlyUsed&&xc.push(Ec);Ec.IsCompatibility||this.pog.push(Bb)}}this.tJa[hd]=Cd;Ja&&(P.DNf(xc,[2,3,0,5,4,9,1,7,8,6]),xc=Array(14),xc[0]=0,xc[1]=1,xc[2]=7,xc[3]=11,xc[4]=5,xc[5]=2,xc[6]=6,xc[7]=10,xc[8]=9,xc[9]=3,xc[10]=4,xc[11]=13,xc[12]=12,xc[13]=8,P.DNf(this.I8,xc),xc=[],Array.addRange(xc,this.I8),Array.removeAt(xc,
13),this.I8=xc);this.QS=Array.clone(this.QS);this.QS.sort(function(Nc,nd){return Nc.NameDataStrings.localeCompare(nd.NameDataStrings)});xc=1;for(hd=this.I8.length;xc<hd&&Ja;xc++)this.tJa[this.I8[xc]].sort(Lb);Ja=0;for(xc=this.QS.length;Ja<xc;Ja++)this.QS[Ja].FunctionIndex=Ja};P.DNf=function(Ja,Lb){for(var mc=Array.clone(Ja),xc=0;xc<mc.length&&xc<Lb.length;xc++)Ja[xc]=mc[Lb[xc]]};Mf.Object.defineProperties(P.prototype,{TZ:{configurable:!0,enumerable:!0,get:function(){return this.nKc}},ohi:{configurable:!0,
enumerable:!0,get:function(){return this.lKc}},q$b:{configurable:!0,enumerable:!0,get:function(){var Ja=this.QS,Lb=Wc.a(this.$);if(!Lb)return Ja;Lb=Lb.WNh();var mc=Lb.length;if(0>=mc)return Ja;var xc=[];Array.addRange(xc,Ja);for(Ja=0;Ja<mc;Ja++){var hd=Lb[Ja],Cd={};Cd.FunctionIndex=xc.length;Cd.HelpId=Cd.GroupUI=null;Cd.Help=hd.description;Cd.IsCommonlyUsed=Cd.IsCompatibility=!1;Cd.NameDataStrings=hd.name;Cd.NameUI=hd.name;Cd.Params=null;Cd.ParamsHelp=null;xc.push(Cd)}return xc}},bbd:{configurable:!0,
enumerable:!0,get:function(){return this.I8}},$:{configurable:!0,enumerable:!0,get:function(){return this.jb}}});Object(Ia.a)(P,"FunctionInfoManager",nc.a,[518,519,3]);var Tc=b(245),td=b(94),Tb=b(48),Fa=b(918),Qb=td.a;Rk(Q,Qb);Q.prototype.dispose=function(){this.rTd&&(Tc.a.instance.Ba(Be.a.Rj,this.wIe,this.lvf),this.rTd=!1);this.uMb&&(this.uMb=!1,Tc.a.instance.Ba(Be.a.Df,this.domElement.ownerDocument.body,this.$yd),Tc.a.instance.Ba(Be.a.Rj,this.domElement.ownerDocument.body,this.Zyd));this.y3=this.p4d=
null;Qb.prototype.dispose.call(this)};Q.prototype.pke=function(Ja){this.y3?this.y3.push(Ja):this.y3=[Ja]};Q.prototype.Xmd=function(Ja){if(this.y3)for(var Lb=0,mc=this.y3.length;Lb<mc;++Lb)if(Mb.DOMElementExtensions.nf(this.y3[Lb],Ja))return!0;return!1};Q.prototype.eSa=function(Ja){this.d7b||(this.$ea=!0,wb.a.equals(this.domElement.currentStyle.position,"absolute",!0)||(this.domElement.style.position="absolute"),this.Tkh(),Tc.a.instance.ra(Be.a.Df,this.domElement.ownerDocument.body,this.$yd),Tc.a.instance.ra(Be.a.Rj,
this.domElement.ownerDocument.body,this.Zyd),this.uMb=!0,this.drag(!0,Ja))};Q.prototype.drag=function(Ja,Lb){Aa.g(Lb);var mc=new Tb.a(0,0);Lb=new Sys.UI.Point(Lb.clientX,Lb.clientY);var xc=this.domElement.parentNode,hd=Fa.a.hs(mc,xc,Lb,this.isRtl());Ja?(mc=Fa.a.JE(mc,xc,this.domElement,this.isRtl()),this.p1a=Fa.a.oD(hd,mc),this.z7=hd,this.MIc=!1):!this.u4h&&this.r4h(hd,this.z7)&&(this.MIc=!0);mc=Fa.a.oD(hd,this.p1a);Fa.a.lcb(xc,this.domElement,mc,this.isRtl(),Ja);this.prg=Lb};Q.prototype.Xy=function(Ja){this.uMb&&
(this.uMb=!1,Tc.a.instance.Ba(Be.a.Df,this.domElement.ownerDocument.body,this.$yd),Tc.a.instance.Ba(Be.a.Rj,this.domElement.ownerDocument.body,this.Zyd));Aa.g(Ja);this.$ea=!1;this.z7=this.p1a=null};Q.prototype.d6=function(Ja){var Lb=ec.HelperMethods.En(Ja);Lb.button===Sys.UI.MouseButton.leftButton&&2===Ja.lb&&this.Xy(Lb);return!1};Q.prototype.lN=function(Ja){2===Ja.lb&&this.drag(!1,ec.HelperMethods.En(Ja));return!1};Q.prototype.r4h=function(Ja,Lb){return Lb.x<Ja.x-2||Lb.x>Ja.x+2||Lb.y<Ja.y-2||Lb.y>
Ja.y+2};Q.prototype.Tkh=function(){this.offsetParent=this.domElement.offsetParent||this.domElement.ownerDocument.body;this.WEi=Mb.DOMElementExtensions.getLocation(this.offsetParent)};Mf.Object.defineProperties(Q.prototype,{d7b:{configurable:!0,enumerable:!0,get:function(){return this.$ea}},wIe:{configurable:!0,enumerable:!0,get:function(){return this.p4d}},u4h:{configurable:!0,enumerable:!0,get:function(){return this.MIc}}});Object(Ia.a)(Q,"BaseDraggableBehavior",td.a,[]);Rk(C,Q);C.prototype.setVisible=
function(Ja){Mb.DOMElementExtensions.setVisible(this.domElement,Ja);Ja||(this.domElement.style.top="auto",this.domElement.style.left="auto")};C.prototype.isRtl=function(){return this.Vi};C.prototype.oRa=function(Ja){var Lb=this.domElement.style;Lb.cursor="move";Lb.position=Ja?"relative":"absolute"};Object(Ia.a)(C,"FunctionParamBoxDraggableItem",Q,[]);Object(Ia.a)(M,"FormulaArgumentAssistanceCallbacks",null,[]);Object(Ia.a)(N,"FormulaArgumentAssistanceRenderingInfo",null,[]);var cc=b(86),bc=b(109),
Mc=b(158);K.prototype.ka=function(Ja){(this.root=Ja)&&!this.Ym&&(this.root.addEventListener("keydown",this.onKeyDown,!0),this.Ym=!0)};K.prototype.detach=function(){this.root&&this.Ym&&(this.root.addEventListener("keydown",this.onKeyDown,!0),this.Ym=!1)};K.prototype.O7b=function(){this.root&&(this.target=this.OG.lCf("move",!0),this.TSd=this.target.getBoundingClientRect(),this.EZ=!0,this.XPd=!1,this.av(),this.alc||this.d3c(),this.target.appendChild(this.alc))};K.prototype.O3=function(Ja){this.OG.Dvf(void 0===
Ja?!1:Ja);this.EZ=!1;this.LHd();this.nHd();this.TSd=this.target=void 0};K.prototype.av=function(){this.ir.capture(this.GMa,null);this.pointerInputManager.ft(Be.a.pointerDown,this.target,this.YFb,!0);this.target.addEventListener("blur",this.onBlur)};K.prototype.nHd=function(){this.ir.releaseCapture();this.pointerInputManager.pt(Be.a.pointerDown,this.target,this.YFb,!0);this.target.removeEventListener("blur",this.onBlur)};K.prototype.LHd=function(){var Ja;this.target&&(null===(Ja=this.alc)||void 0===
Ja?void 0:Ja.parentNode)===this.target&&this.target.removeChild(this.alc)};K.prototype.O5=function(Ja,Lb){var mc=this.target.getBoundingClientRect();Ja+=mc.left-this.TSd.left;Lb+=mc.top-this.TSd.top;this.OG.onMove(Ja,Lb)};K.prototype.d3c=function(){this.alc=Mc.createClusteredImage(24,24,"ShapeQuadArrow_24x24x32","WACMoveArrowIcon",!0,"")};Object(Ia.a)(K,"FormulaAssistanceMoveAdapter",null,[]);var rd=b(291);H.prototype.oba=function(){return this.Ym&&!!this.Eja};H.prototype.gOa=function(Ja){this.Eja.style.cursor=
"grabbing";this.nEj=Ja.clientPoint.x;this.oEj=Ja.clientPoint.y;this.OG.lCf("drag");return!0};H.prototype.Ila=function(Ja){this.OG.onMove(Ja.clientPoint.x-this.nEj,Ja.clientPoint.y-this.oEj);return!0};H.prototype.Hla=function(){this.Xy()};H.prototype.Gla=function(){this.Xy()};H.prototype.ka=function(Ja){if(this.Eja=Ja)this.Eja.style.cursor="grab",rd.a.instance.$_(this.Eja,this),this.Ym=!0};H.prototype.detach=function(){this.Ym&&this.Eja&&(this.Eja.style.cursor="",rd.a.instance.Q7(this.Eja,this),this.Ym=
!1)};H.prototype.Xy=function(){this.Eja.style.cursor="grab";this.OG.Dvf()};Object(Ia.a)(H,"FormulaAssistanceDragAdapter",null,[608]);J.prototype.ka=function(Ja,Lb,mc,xc){this.root=Ja;this.render=mc;this.dismiss=xc;this.detach();Lb&&(this.sIe.ka(Lb),this.zpf.ka(Ja.firstChild),this.Ym=!0)};J.prototype.detach=function(){this.Ym&&(this.sIe.detach(),this.zpf.detach(),this.Ym=!1);Mb.DOMElementExtensions.ff(this.placeholder)};J.prototype.clear=function(){this.lJa.setOverrideTarget(void 0);this.detach();
this.FJd()};J.prototype.lCf=function(Ja,Lb){Lb=void 0===Lb?!1:Lb;this.usageCount[Ja]+=1;this.ayc=this.root.firstChild.getBoundingClientRect();this.placeholder=this.root.cloneNode(!0);Ja=this.placeholder.firstChild;Ja.style.animationDuration="0ms";this.root.parentElement.appendChild(this.placeholder);Lb&&(this.VDd=document.activeElement,Ja.tabIndex=0,Ja.focus());this.dismiss();return Ja};J.prototype.onMove=function(Ja,Lb){Ja=Math.min(Math.max(Ja,this.DCc-this.ayc.left),window.innerWidth-this.ayc.right-
this.DCc);Lb=Math.min(Math.max(Lb,this.DCc-this.ayc.top),window.innerHeight-this.ayc.bottom-this.DCc);this.placeholder.firstChild.style.transform="translate("+Ja+"px, "+Lb+"px)"};J.prototype.Dvf=function(Ja){var Lb=this;Ja=void 0===Ja?!0:Ja;var mc=this.placeholder.firstChild.getBoundingClientRect(),xc=this.lJa.getDirectionalHint({top:mc.top,left:mc.left});this.lJa.setOverrideTarget({top:1===xc?mc.bottom:mc.top,left:mc.left});this.render();window.requestAnimationFrame(function(){Mb.DOMElementExtensions.ff(Lb.placeholder);
Lb.VDd&&(Ja&&Lb.VDd.focus(),Lb.VDd=void 0)})};J.prototype.FJd=function(){var Ja=this.formulaAssistanceTelemetryManager.U9,Lb=this.usageCount[Hd.Drag],mc=this.usageCount[Hd.Move];0<Lb&&(Ja.argumentAssistanceDragCounter+=1,Ja.argumentAssistanceDragTotalCounter+=Lb,this.usageCount[Hd.Drag]=0);0<mc&&(Ja.argumentAssistanceMoveCounter+=1,Ja.argumentAssistanceMoveTotalCounter+=mc,this.usageCount[Hd.Move]=0)};Object(Ia.a)(J,"FormulaAssistanceDragControl",null,[]);var Hd;(function(Ja){Ja.Drag="drag";Ja.Move=
"move"})(Hd||(Hd={}));Object(Ia.b)("FormulaAssistanceDragMode",Hd);var ic=Wd.a;Rk(U,ic);U.prototype.sme=function(Ja){this.addHandler("FAFunctionNameUpdated",Ja)};U.prototype.oPf=function(Ja){this.removeHandler("FAFunctionNameUpdated",Ja)};U.prototype.ine=function(Ja){this.addHandler("FAParameterSelectionChangedOld",Ja)};U.prototype.LPf=function(Ja){this.removeHandler("FAParameterSelectionChangedOld",Ja)};U.prototype.hne=function(Ja){this.addHandler("FAParameterSelectionChanged",Ja)};U.prototype.KPf=
function(Ja){this.removeHandler("FAParameterSelectionChanged",Ja)};U.prototype.set_visible=function(Ja){this.Ck?Ja||this.csb():Sys.UI.Control.prototype.set_visible.call(this,Ja);return Ja};U.prototype.csb=function(){this.formulaAssistanceUIControl&&(this.Gq=null,this.LQ&&this.OG.detach(),this.formulaAssistanceUIControl.dismiss(this.domElement),this.Nka=null,this.dr.canReceiveFocus=!1)};U.prototype.show=function(Ja){this.Ck||(this.formulaAssistanceTelemetryManager.iO(["argumentAssistanceRender"]),
this.r1a.setVisible(!!Ja),this.formulaAssistanceTelemetryManager.dQ(["argumentAssistanceRender"]),this.eWc&&(this.eWc=!1,this.formulaAssistanceTelemetryManager.B7b("argumentAssistanceOverall")))};U.prototype.JJd=function(){var Ja=this;if(!this.H4||this.CRa){this.H4||this.formulaAssistanceTelemetryManager.iO(["argumentAssistanceOverall"]);this.formulaAssistanceTelemetryManager.iO(["argumentAssistanceComputation"]);var Lb=Ob.g(this.$).Gi,mc={content:Lb.text,caretPosition:Lb.textBox.caretPosition};(this.rba?
this.pluginScheduler.getRequester().argumentAssistance(mc,0):this.pluginScheduler.requester().argumentAssistance(mc)).then(function(xc){0===xc.kind?xc.payload?(Ja.formulaAssistanceTelemetryManager.dQ(["argumentAssistanceComputation"]),Ja.jyj(Ja.rDd(xc.payload),Lb.textBox.domElement)):Ja.csb():Ja.formulaAssistanceTelemetryManager.dQ(["argumentAssistanceComputation"],!1);return null})}};U.prototype.update=function(Ja,Lb,mc,xc){if(!this.Ck&&Ja){this.formulaAssistanceTelemetryManager.iO(["argumentAssistanceComputation",
"argumentAssistanceOverall"]);this.eWc=!0;var hd=this.$.listSeparator;try{var Cd=$get(sa.ibd,this.yj),dc=$get(sa.cbd,this.yj);Cd.innerText="";dc.innerText="";var Ec=$get(sa.qUe,this.yj),gb=Ja.Params.split(sa.m9c);Cd=[];dc=0;for(var Bb=Ec.rows.length;dc<Bb;dc++){var qc=Ec.rows[dc];Mb.DOMElementExtensions.setVisible(qc,dc<gb.length);var Nc=gb[dc],nd=sa.KVi+dc+"_",Vd=Ja.NameDataStrings;$get(nd+sa.zFb,qc).innerText=Vd;$get(nd+sa.UBd,qc).innerText=Vd;if(Nc){var oe=gb[dc].split(hd),qe=U.Omd(oe[oe.length-
1]),ee=U.Mji(Ja);qe&&(ee&&(2<oe.length?(oe[oe.length-2]+="1",oe[oe.length-3]+="1"):La.ULS.sendTraceTag(537162073,0,50,"pair params formula should have at least 2 params. at UpdateParameterAssistance. formula '{0}', {1} params, currentParameterIndex = {3}.",Vd,oe.length.toString(),Lb)),U.EJg(oe,ee,Lb,Ja));Nc=oe.join(hd.toString()+" ");gb[dc]=Nc;mc<oe.length?(Cd[dc]=oe[mc],La.ULS.shipAssertTag(537162072,0,!!oe[mc]&&1<=oe[mc].length,"Emphasized parameter is too short or empty selectedParameterIndex = {0}, currRowParamsArray.Length = {1}, formula name = {3}, current row = {4}",
mc,oe.length,Vd,dc),oe[mc]=String.format("{0}{1}{2}","<b>",oe[mc],"</b>"),Nc=oe.join(hd.toString()+" ")):La.ULS.shipAssertTag(537162071,0,!1,"the current param index is larger than the param list count. selectedParameterIndex = "+mc+"currRowParamsArray.Length = "+oe.length+", current row = "+dc);xc&&La.ULS.sendTraceTag(558474578,0,50,"formula '{0}', {1} params, isElipsis = {2}, isPairsParamsFormula = {3}, currentParameterIndex = {4}",Vd,oe.length,qe,ee,Lb)}$get(nd+sa.VBd,qc).innerHTML="("+(Nc||"")+
")"}xc?this.raiseEvent("FAFunctionNameUpdated",new ca(Ja.NameDataStrings,gb)):this.raiseEvent("FAParameterSelectionChangedOld",new R(gb,Cd,mc));Ec.className=Le.a.Uoh+(this.functionInfoManager.fgc(Ja)?"-udf":"")}catch(re){throw La.ULS.shipAssertTag(558474577,0,!1,"UpdateParameterAssistance Exception. formula '{0}', {1} params. \nException: {4}",Ja.NameDataStrings,Lb,re),re;}this.formulaAssistanceTelemetryManager.dQ(["argumentAssistanceComputation"])}};U.prototype.dispose=function(){this.Ck||(this.Ac.oC(),
cb.a.Ia(this.Ac),Ob.g(this.$).view.Fq(this.Xs),cb.a.Ia(this.r1a),this.r1a=null);this.Ck&&cb.a.Ia(this.dr);this.H4&&Ob.g(this.$).$b.Nl(this.Af);this.functionInfoManager=this.$=null;ic.prototype.dispose.call(this)};U.prototype.rDd=function(Ja){var Lb=new N;Lb.functionRenderingInfo=Ja;Lb.cardMode=this.y2;this.cHd(Lb);return Lb};U.prototype.cHd=function(Ja){Ja.callbacks=new M;Ja.callbacks.onHelpLink=this.Jdd(Ja.functionRenderingInfo);Ja.callbacks.onCardModeChange=this.onCardModeChange;Ja.callbacks.onFeedback=
this.SQa;this.H4&&(Ja.callbacks.onDismissClick=this.onDismissClick)};U.prototype.jyj=function(Ja,Lb){var mc=this;if(this.formulaAssistanceUIControl){this.formulaAssistanceTelemetryManager.iO(["argumentAssistanceRender"]);var xc={};xc.zoomLevel=ia(this.$);this.formulaAssistanceUIControl.updateContext(xc);this.Gq=function(){mc.formulaAssistanceUIControl.renderArgumentAssistanceCard(mc.domElement,Lb,Ja)};this.Gq();this.vCd(Ja);this.LQ&&this.OG.ka(this.formulaAssistanceUIControl.getCalloutElement(0),
this.formulaAssistanceUIControl.getDraggableElement(0),this.Gq,function(){return mc.formulaAssistanceUIControl.dismiss(mc.domElement)});this.dr.canReceiveFocus=!0;this.formulaAssistanceTelemetryManager.dQ(["argumentAssistanceRender"]);this.formulaAssistanceTelemetryManager.B7b("argumentAssistanceOverall")}};U.prototype.Jdd=function(Ja){var Lb=this;return function(){za(Lb.$,Ja.helpID,Ja.isUDF)}};U.prototype.PNd=function(){var Ja=ad.a.get(qb.a.C_b);this.y2=Ja?parseInt(Ja,10):U.S4c;this.formulaAssistanceTelemetryManager.kXf(this.y2)};
U.prototype.vCd=function(Ja){var Lb=Ja.functionRenderingInfo.functionName;this.Nka&&wb.a.equals(this.Nka,Lb,!0)?(Lb=Yd.a.map(Ja.functionRenderingInfo.signatures,function(mc){var xc="";0<=mc.signatureParams.activeParam&&mc.signatureParams.activeParam<mc.signatureParams.params.length&&(xc=mc.signatureParams.params[mc.signatureParams.activeParam]);return xc}),this.raiseEvent("FAParameterSelectionChanged",new fa(Lb))):(this.Nka=Lb,Ja=Yd.a.map(Ja.functionRenderingInfo.signatures,function(mc){return mc.signatureParams.params.join(", ")}),
this.raiseEvent("FAFunctionNameUpdated",new ca(Lb,Ja)))};U.prototype.TNb=function(Ja){this.y2=Ja;try{ad.a.Gw(qb.a.C_b,Ja.toString(),pe.AFrame.fea)}catch(Lb){La.ULS.sendTraceTag(537162070,0,15,"Failed setting ArgumentAssistanceCardCollapseState cookie with error message: {0}",Lb.message)}};U.Omd=function(Ja){return wb.a.contains(Ja,sa.r7b,!0)};U.Mji=function(Ja){return!!Ja&&wb.a.D1a(Ja.NameDataStrings,"IFS")};U.EJg=function(Ja,Lb,mc,xc){try{if(!Ja||2>Ja.length)La.ULS.shipAssertTag(537162069,0,!1,"Requested not on elipsis function, formula '{0}', {1} params, isPairsParamsFormula = {2}, currentParameterIndex = {3}.",
xc.NameDataStrings,Ja?Ja.length.toString():"currRowParamsArray == null",Lb,mc);else{for(var hd=Ja.pop().toString(),Cd=Ja.length-1;Cd<mc;Cd++){var dc=Ja[Cd].trim();if(Lb){var Ec=Ja[Cd-1].trim();Ja.push(U.DFh(Ec,dc))}else{var gb=U.J8e(dc);Ja.push(U.RUe(gb))}}Ja.push(hd)}}catch(Bb){throw La.ULS.shipAssertTag(537162068,0,!1,"AppendNewOptionalParameters Exception. formula '{0}', {1} params, isPairsParamsFormula = {2}, currentParameterIndex = {3}. \nException: {4}",xc.NameDataStrings,Ja?Ja.length.toString():
"currRowParamsArray == null",Lb,mc,Bb),Bb;}};U.DFh=function(Ja,Lb){Ja=U.J8e(Ja);var mc=U.J_e(Ja);Lb=U.J_e(Lb);return U.RUe(Ja,!0,!!mc&&!!Lb&&mc!==Lb)};U.J8e=function(Ja){var Lb=Ja.match(U.Nxd);Ja=wb.a.trimEnd(wb.a.trimStart(Ja,sa.cEf),sa.bEf);if(Lb&&Lb.length){Lb=Lb[Lb.length-1];var mc=Number.parseLocale(Lb)+1;Ja=Ja.replace(Lb,mc.toString())}else Ja=String.format("{0}{1}",Ja,1);return Ja};U.RUe=function(Ja,Lb,mc){var xc="[{0}]";(void 0===Lb?0:Lb)&&(xc=(void 0===mc?0:mc)?"[{0}":"{0}]");return String.format(xc,
Ja)};U.J_e=function(Ja){return(Ja=Ja.match(U.Nxd))&&Ja.length?Ja[0]:null};U.wJa=function(Ja){if(Ja)return document.createElement("div");Ja=String.format(sa.MEf,sa.KEf,sa.UBd,Le.a.wMe,sa.zFb,Le.a.vMe,sa.VBd);var Lb=String.format(sa.MEf,sa.LEf,sa.UBd,Le.a.wMe,sa.zFb,Le.a.vMe,sa.VBd);Ja=String.format(sa.TDh,sa.UDh,Le.a.rNe,Le.a.Rlh,zb.a.Gp,sa.qUe,Ja,Lb);Lb=document.createElement("div");Lb.innerHTML=Ja;return Lb.firstChild};U.Nxd=RegExp("\\d+");U.S4c=0;Object(Ia.a)(U,"FormulaArgumentAssistanceControlDeprecated",
Wd.a,[596]);Object(Ia.a)(O,"ParseContext",null,[]);var Jc=b(440),zd=b(1119),sd=b(335),Pd=zd.a;Rk(T,Pd);T.prototype.Hh=function(Ja,Lb){this.formulaAssistanceControl.Ya=this.Ya;-1470715894!==Lb&&-1231471547!==Lb||!this.MGe()||(this.pV=!1);return Pd.prototype.Hh.call(this,Ja,Lb)};T.prototype.nyd=function(){var Ja=this.f5a;if(Ja||this.tQd)if(this.formulaAssistanceControl.Ya=this.Ya,this.formulaAssistanceTelemetryManager.rob.formulaAssistanceRequestAttemptedCounter++,this.MGe())if(!Ja&&this.tQd)this.formulaAssistanceControl.kre();
else if(ha.EwaSettings.isChangeGateEnabled("OfficeVSO:6518663_FlightRemovalAutocompleteTableColumnHeaders")&&this.P7h){if(Ja=this.$.Fb.sc("LoadingUIShown","FormulaAutoCompleteListAutoCompleteBehavior"),this.formulaAssistanceControl.mre(),Ja.stop(),this.lob.text.endsWith("[")&&"["!==this.lob.text.charAt(this.lob.text.length-2)){var Lb=""===this.OHa?this.formulaAssistanceControl.tableManager.pg:Object(Cc.a)(sd.a,this.$.vb.getItemByName(this.OHa));La.ULS.sendTraceTag(575776010,0,50,"FormulaAutoCompleteListAutoCompleteBehavior.OnAutoCompleteTimerTick: AutoComplete List Box for Table Column Headers is shown after user types =[ inside a table with id {0} in {1} ms with cell edit regression time of {2} ms and popup visibility - {3}",
Lb.Ai,Ja.qc,this.Zjd,this.pV)}}else this.formulaAssistanceControl.$nb(),this.FDf&&(this.FDf=this.pV=!1);else this.formulaAssistanceTelemetryManager.rob.formulaAssistanceRequestOptimizedCounter++;else this.pV=!1};T.prototype.Dh=function(){this.M9i||(this.GRa=null,this.tQd&&this.formulaAssistanceControl.lZ())};T.prototype.Af=function(){this.pV=!1;this.formulaAssistanceControl.set_visible(!1);this.formulaAssistanceControl.dtc();this.Ck&&this.kui()};T.prototype.NEd=function(Ja,Lb){return this.formulaAssistanceControl.Hh(Ja,
Lb)};T.prototype.kui=function(){this.formulaAssistanceControl.GAa&&(this.formulaAssistanceTelemetryManager.uM.smartSuggestionShownCounter++,this.formulaAssistanceControl.GAa=!1);this.formulaAssistanceControl.ZRa&&(this.formulaAssistanceTelemetryManager.uM.smartSuggestionSelectedCounter++,this.formulaAssistanceControl.ZRa=!1);this.formulaAssistanceControl.YRa&&(this.formulaAssistanceTelemetryManager.uM.smartSuggestionCommittedCounter++,this.formulaAssistanceControl.YRa=!1);this.k2&&(this.formulaAssistanceControl.isCellContentOnlyEqualDuringEdit&&
(this.formulaAssistanceTelemetryManager.uM.isCellContentOnlyEqualDuringEditCounter++,this.formulaAssistanceControl.isCellContentOnlyEqualDuringEdit=!1),this.formulaAssistanceControl.CLa&&(this.formulaAssistanceTelemetryManager.uM.isCellContentFormulaCounter++,this.formulaAssistanceControl.CLa=!1))};T.prototype.KUg=function(Ja,Lb){for(var mc=0,xc;-1!==mc;)if(mc=Ja.indexOf("[",mc+1),-1!==mc&&mc<Lb&&(xc=Ja.indexOf("]",mc+1),-1===xc||xc>=Lb))return mc;return-1};T.prototype.MGe=function(){var Ja=this.Ya.text,
Lb=this.Ya.textBox.caretPosition,mc=this.formulaAssistanceControl.Oka,xc=this.formulaAssistanceControl.SMa;if(this.pV&&wb.a.equals(Ja,mc,!0)&&Lb===xc)return!1;this.formulaAssistanceControl.Oka=Ja;this.formulaAssistanceControl.SMa=Lb;return!0};Mf.Object.defineProperties(T.prototype,{Dyb:{configurable:!0,enumerable:!0,get:function(){return Object(Jc.a)(qa,this.$.ob.Xg)}},pV:{configurable:!0,enumerable:!0,get:function(){return this.formulaAssistanceControl.isListVisible},set:function(Ja){this.formulaAssistanceControl.isListVisible=
Ja}},f5a:{configurable:!0,enumerable:!0,get:function(){return this.Ya.f5a}},P7h:{configurable:!0,enumerable:!0,get:function(){var Ja=this.lob.text,Lb=!1;if(0>=Ja.length)return Lb;var mc=this.$.Fb.sc("LoadingUIShown","FormulaAutoCompleteListAutoCompleteBehavior"),xc=Ob.g(this.$).ha.sa.activeCell.clone(),hd=Ja.charCodeAt(0);this.OHa="";this.SP=this.KUg(Ja,this.lob.caretPosition);hd=61===hd&&-1!==this.SP;if(!ha.EwaSettings.isChangeGateEnabled("OfficeVSO:5402572_CrossSheetTableReferencing"))hd&&(Lb=!0);
else if(hd){if(ha.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")){hd=0;for(var Cd=this.SP-1;1<=Cd&&!(this.SP-Cd>T.vof);Cd--)if(Array.contains(T.hte,Ja.charAt(Cd))){hd=Cd;break}hd=Ja.substring(hd+1,this.SP);Ja=""!==hd?this.$.vb.getItemByName(hd):null;Cd=this.SP;for(var dc=this.SP+1;dc<=this.Ya.textBox.caretPosition;dc++)if("["===this.Ya.text.charAt(dc))Cd=dc;else break;this.SP=Cd}else{hd=Ja.lastIndexOf("[");Cd=0;for(dc=hd-1;1<=dc&&!(hd-dc>T.vof);dc--)if(Array.contains(T.hte,
Ja.charAt(dc))){Cd=dc;break}hd=Ja.substring(Cd+1,hd);Ja=""!==hd?this.$.vb.getItemByName(hd):null}Ja&&2===Ja.type?(Lb=!0,this.OHa=hd):Ob.g(this.$).Ab.dk(xc)&&(Lb=!0,this.OHa="")}mc.stop();this.Zjd=mc.qc;La.ULS.sendTraceTag(575776011,0,50,"FormulaAutoCompleteListAutoCompleteBehavior.InTableHeaderMode: Regression time in cell edit due to column header mode parsing is {0} milliseconds",this.Zjd);return Lb}},key:{configurable:!0,enumerable:!0,get:function(){return Fb.a.P2a}},calcManager:{configurable:!0,
enumerable:!0,get:function(){this.kFc||(this.kFc=this.$.da.za(266,!1));return this.kFc}},tQd:{configurable:!0,enumerable:!0,get:function(){if(null!=this.GRa)return this.GRa;if(!ha.EwaSettings.ma(136))return this.GRa=!1;var Ja=Ob.g(this.$).ha.sa.activeCell.clone();if(1!==Ja.cof||!Ja.left||Ob.g(this.$).ha.sa.Dgc())return!1;var Lb=this.formulaAssistanceControl.tableManager.Vm(Ja);if(Lb)return this.GRa=!1;--Ja.left;--Ja.right;if(!Ja.isValidRange)return!1;Lb=this.formulaAssistanceControl.tableManager.Vm(Ja);
return this.GRa=!!Lb&&Ja.top===Lb.top&&this.formulaAssistanceControl.tableManager.n3g(Lb,Ob.g(this.$))}}});T.hte=" !%&'()*+,-/:;<=>@[]^{|}~".split("");T.vof=255;Object(Ia.a)(T,"FormulaAutoCompleteListAutoCompleteBehavior",zd.a,[]);var De=b(29),lc;(function(Ja){Ja[Ja.function=0]="function";Ja[Ja.field=1]="field";Ja[Ja.definedName=2]="definedName";Ja[Ja.letVariable=3]="letVariable";Ja[Ja.tableColHeaderName=4]="tableColHeaderName";Ja[Ja.tableSpecialStructRef=5]="tableSpecialStructRef";Ja[Ja.pendingData=
6]="pendingData";Ja[Ja.tableNamedObject=7]="tableNamedObject"})(lc||(lc={}));Object(Ia.b)("ItemType",lc);var Pc=b(1294),md=b(1293);G.prototype.execute=function(Ja){Ja.push(this.index)};Object(Ia.a)(G,"AppendIndexOperation",null,[607]);F.prototype.execute=function(){};Object(Ia.a)(F,"NopIndexOperation",null,[607]);I.prototype.execute=function(Ja){for(var Lb=0;Lb<Ja.length;Lb++)Ja[Lb]===this.F_i&&(Ja[Lb]=this.Cqf)};Object(Ia.a)(I,"ReplaceIndexOperation",null,[607]);var bd=b(77);D.prototype.jDe=function(Ja,
Lb){var mc=new G(Lb);if(!this.T4)return mc;Ja=this.Aoi(Ja,Lb);return null!=Ja?this.items[Ja].aAb?new I(Ja,Lb):new F:mc};D.prototype.Aoi=function(Ja,Lb){var mc=this,xc=this.items[Lb];La.ULS.shipAssertTag(537162075,0,!!xc,"Internal error: invalid item index");Ja=bd.where(bd.asEnumerable(Ja),function(hd){return mc.items[hd].name===xc.name});return bd.Ct(Ja)?bd.first(Ja):null};Object(Ia.a)(D,"FilterItemOperationFactory",null,[]);var Od=b(117),le=b(1050);Object(Ia.a)(x,"CompletionItem",null,[]);var dd=
b(70),Zd="<tr>\r\n\t{0}\r\n\t<td id='name_cell{4}' class='{1}'>{2}</td>\r\n\t<td id='description_cell{4}' class='"+zb.a.Gp+"'>{3}</td>\r\n\t<td id='item_type_cell' class='"+zb.a.Gp+"'>{5}</td>\r\n</tr>",je="<tr>\r\n\t{0}\r\n\t<td id='name_cell{1}' class='{3}'>{4}</td>\r\n\t<td id='description_cell{1}' class='"+zb.a.Gp+"'></td>\r\n\t<td id='item_type_cell' class='"+zb.a.Gp+"'>{2}</td>\r\n</tr>",Ke="<td>\r\n\t<div class='"+zb.a.IA+"'>\r\n\t\t<img class='{0}' src='{1}' alt='{2}'/>\r\n\t</div>\r\n</td>",
lf="<tr>\r\n\t<td><b>{0}</b></td>\r\n\t<td id='name_cell{1}' class='{3}'>{4}</td>\r\n\t<td id='description_cell{1}' class='"+zb.a.Gp+"'>{5}</td>\r\n\t<td id='item_type_cell' class='"+zb.a.Gp+"'>{2}</td>\r\n</tr>",nf=Pc.a;Rk(z,nf);z.prototype.IUc=function(Ja){this.addHandler("FLBSelectedRowChanged",Ja)};z.prototype.EId=function(Ja){this.removeHandler("FLBSelectedRowChanged",Ja)};z.prototype.mZb=function(Ja){this.addHandler("ACLBUpdated",Ja)};z.prototype.ksc=function(Ja){this.removeHandler("ACLBUpdated",
Ja)};z.prototype.dispose=function(){nf.prototype.dispose.call(this);this.$qa=this.rUe=this.iub=null};z.prototype.Kyc=function(Ja,Lb,mc,xc){xc=void 0===xc?0:xc;this.Ydf||this.D7(!1);var hd="";mc&&(hd+=String.format("<table aria-live='off' id='{0}'><tr><td class='{1}'>{2}</td></tr></table>","list_column_header",Le.a.AZg,mc));hd+=String.format("<table class='{0}' aria-live='off'><tbody>",this.Uba);for(var Cd=new Ie.a,dc=0,Ec=this.dW.length;dc<Ec;dc++)hd+=this.T1e(Ja[this.dW[dc]],dc+1,Lb,xc),this.Ck&&
Cd.add(this.NWe(Ja[this.dW[dc]]));dc=this.dW.length;Ec=0;for(var gb=this.mq.length;Ec<gb;Ec++)Array.contains(this.dW,this.mq[Ec])||(dc++,hd+=this.T1e(Ja[this.mq[Ec]],dc,Lb,xc),this.Ck&&Cd.add(this.NWe(Ja[this.mq[Ec]])));this.Pf.innerHTML=hd+"</tbody></table>";this.Gn=Mb.DOMElementExtensions.zj(this.domElement,this.Uba);this.Ck&&(this.c3b=Cd.toArray());this.Ydf?(this.isListVisible=!0,this.hGa.set_visible(!0)):(this.D7(!0),this.BHg(!!mc))};z.prototype.$Ia=function(Ja,Lb,mc,xc,hd,Cd){xc=void 0===xc?
"":xc;hd=void 0===hd?0:hd;Cd=void 0===Cd?!1:Cd;if(Ja){var dc=[],Ec=[];this.ZLb=0;var gb=new D(this.$,Ja);if(Lb){var Bb=!!Lb&&0<hd,qc=Bb&&91===Lb.charCodeAt(hd+1)?hd+2:hd+1;Cd=Bb?Lb.length===qc:!1;Bb&&Lb.length===hd&&ha.EwaSettings.ma(136)&&(Cd=!0);var Nc=null;!Cd&&Bb&&Lb.length>hd+1&&(Nc=Lb.substring(qc,Lb.length));if(Lb)for(Bb=0,qc=Ja.length;Bb<qc;Bb++){var nd=Ja[Bb].name;if(!Ja[Bb].tfi){var Vd=gb.jDe(dc,Bb);Ja[Bb].aAb&&this.ZLb++;if(!Nc&&!Cd||0===Ja[Bb].itemType)Ec=this.LRe(Lb,nd,mc,Vd,dc,Ec),dc=
Ec.P8e,Ec=Ec.TGf;Nc&&1===Ja[Bb].itemType&&(Ec=this.LRe(Nc,nd,!0,Vd,dc,Ec),dc=Ec.P8e,Ec=Ec.TGf);Cd&&1===Ja[Bb].itemType&&Vd.execute(dc)}}}else for(mc=0;mc<Ja.length;++mc)if(Ja[mc].aAb||Cd)Nc=gb.jDe(dc,mc),Nc.execute(dc),Nc.execute(Ec),Ja[mc].aAb&&this.ZLb++;this.dW=Ec;this.mq=dc;this.Kyc(Ja,Lb,xc,hd)}};z.prototype.xRj=function(Ja){if(Ja&&!(1<Ja.length)){var Lb=[],mc=[];Lb.push(0);mc.push(0);this.dW=Lb;this.mq=mc;this.Kyc(Ja,"","",0)}};z.prototype.Oxa=function(){this.Ok&&nf.prototype.Oxa.call(this)};
z.prototype.c3i=function(Ja,Lb){this.raiseEvent("ACLBUpdated",new md.a(Ja,void 0,void 0,Lb))};z.prototype.Qcg=function(Ja){var Lb=this.Gn.rows[Ja];return(!this.Ok||this.Ok!==Lb)&&Ja<this.Gn.rows.length?(this.Ok=Lb,!0):!1};z.OWe=function(Ja){switch(Ja){case 0:return 3;case 2:return 100;case 1:case 6:return 103;case 3:return 102;case 4:return 101;case 5:return 107;case 7:return 106;default:return 3}};z.prototype.onItemClick=function(Ja){Aa.g(Ja.Ca);0===this.n0||2===this.n0||3===this.n0||4===this.n0||
5===this.n0||7===this.n0?(this.raiseEvent(le.a.i4a),this.Oxa()):1===this.n0?this.hGa.Hy(!1):(this.hGa.Hy(!1),Ja=Ob.g(this.$),Ja.wo(!1),Ja.focus());return!0};z.prototype.BHg=function(Ja){this.Gra();if(Ja){var Lb=this.Gn.offsetWidth+(this.mq.length>this.JH?Od.a.ev:0);Ja=$get("list_column_header");Ja.offsetWidth>Lb&&Mb.DOMElementExtensions.rv(this.Pf,Ja.offsetWidth);Lb=this.Pf.getElementsByClassName(this.i_);for(var mc=0;mc<Lb.length;mc++)Lb[mc].style.width=ec.HelperMethods.jc(Ja.offsetWidth)}};z.prototype.T1e=
function(Ja,Lb,mc,xc){if(1===Ja.itemType){var hd=De.a.zg(Ja.name),Cd=De.a.zg(xc?mc.substring(xc+1,mc.length):mc),dc=0;hd.substring(0,Cd.length).toLowerCase()!==Cd.toLowerCase()&&(dc=z.WDj(hd,sa.Rfg,Cd));mc="";mc=0<=dc?mc+(hd.substring(0,dc)+"<b>"+hd.substring(dc,dc+Cd.length)+"</b>"+hd.substring(dc+Cd.length,hd.length)):mc+hd;xc=xc?String.format(Ke,zb.a.SNe,De.a.yZ(Ab.a.Se(0)),kb.a.instance.ga(715)):"";return String.format(je,xc,Lb,lc[Ja.itemType],this.i_,mc)}if(5===Ja.itemType)return String.format(lf,
"",Lb,lc[Ja.itemType],this.i_,De.a.zg(Ja.name),De.a.zg(Ja.Wia));if(4===Ja.itemType)return String.format(lf,"(...)",Lb,lc[Ja.itemType],this.i_,De.a.zg(Ja.name));if(6===Ja.itemType)return xc=xc?String.format(Ke,zb.a.SNe,De.a.yZ(Ab.a.Se(0)),kb.a.instance.ga(715)):"",String.format(Zd,xc,this.i_,De.a.zg(Ja.name),De.a.zg(Ja.Wia),Lb,lc[Ja.itemType]);xc=String.format(Ke,2===Ja.itemType||3===Ja.itemType?zb.a.jsh:zb.a.hsh,De.a.yZ(Ab.a.Se(0)),kb.a.instance.ga(712));return String.format(Zd,xc,this.i_,De.a.zg(Ja.name),
De.a.zg(Ja.Wia),Lb,lc[Ja.itemType])};z.prototype.NWe=function(Ja){var Lb=new x;Lb.label=Ja.label;Lb.textEdit=Ja.textEdit;Lb.kind=z.OWe(Ja.itemType);Lb.type=Ja.aAb?1:0;if(ha.EwaSettings.isChangeGateEnabled("OfficeVSO:5607789_FunctionShortDescriptions")&&3===Lb.kind){var mc=this.formulaAssistanceControl.JOh(Ja.label);Lb.detail=mc?mc:Ja.Wia}else Lb.detail=Ja.Wia;return Lb};z.prototype.LRe=function(Ja,Lb,mc,xc,hd,Cd){wb.a.equals(Lb,"Pretend this is the line.",!1)&&0<hd.length||wb.a.aL(Lb,Ja)?(xc.execute(hd),
xc.execute(Cd)):mc&&Ja.length>=sa.q3g&&z.Zch(Lb,sa.Rfg,Ja)?xc.execute(hd):!mc&&Ja.length>=sa.p3g&&wb.a.contains(Lb,Ja,!0)&&xc.execute(hd);return{P8e:hd,TGf:Cd}};z.Zch=function(Ja,Lb,mc){Lb=bk(Lb);for(var xc=Lb.next();!xc.done;xc=Lb.next())if(xc=Ja.split(xc.value),!(2>xc.length)){xc=bk(xc);for(var hd=xc.next();!hd.done;hd=xc.next())if(wb.a.aL(hd.value,mc))return!0}return!1};z.WDj=function(Ja,Lb,mc){Lb=bk(Lb);for(var xc=Lb.next();!xc.done;xc=Lb.next())if(xc=Ja.toLowerCase().indexOf((xc.value+mc).toLowerCase()),
0<xc)return xc+1;return-1};Mf.Object.defineProperties(z.prototype,{Lhc:{configurable:!0,enumerable:!0,get:function(){return 0<this.ZLb&&this.ZLb===this.mq.length}},isListVisible:{configurable:!0,enumerable:!0,get:function(){return Object(dd.a)(z.prototype,this,"isListVisible")},set:function(Ja){Object(dd.b)(z.prototype,this,"isListVisible",Ja);Ja||(this.Buc=0,this.fe=null);0===this.Buc?Mb.DOMElementExtensions.setVisible(this.iub,Ja&&!this.Ck):Mb.DOMElementExtensions.setVisible(this.iub,!1)}},Ok:{configurable:!0,
enumerable:!0,get:function(){return this.$qa},set:function(Ja){this.gBa(this.Ok);if(Ja){this.rUe.innerText="";this.$qa=Ja;var Lb=this.gBa(this.Ok),mc=Ja.rowIndex+1,xc=$get("description_cell"+mc,Ja);this.iub.innerText=xc.innerText;var hd=$get("item_type_cell",Ja);this.fe=Lb=Lb.innerText;this.Buc="field"===hd.innerText?1:"definedName"===hd.innerText?2:"letVariable"===hd.innerText?3:"tableColHeaderName"===hd.innerText?4:"tableSpecialStructRef"===hd.innerText?5:"pendingData"===hd.innerText?6:"tableNamedObject"===
hd.innerText?7:0;this.raiseEvent("FLBSelectedRowChanged",new md.a(this.mq.length,mc,Lb,xc.innerText));this.nuc(Ja)}}},NSa:{configurable:!0,enumerable:!0,get:function(){return this.iub}},hGa:{configurable:!0,enumerable:!0,get:function(){return this.formulaAssistanceControl}},n0:{configurable:!0,enumerable:!0,get:function(){return this.Buc}}});Object(Ia.a)(z,"FormulaAutoCompleteListBox",Pc.a,[595]);Mf.Object.defineProperties(A.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return this._name}},
toolTip:{configurable:!0,enumerable:!0,get:function(){return this.r9}}});Object(Ia.a)(A,"LETVariableInfo",null,[]);Mf.Object.defineProperties(B.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return this._name}}});Object(Ia.a)(B,"TableColHeaderNameInfo",null,[]);Mf.Object.defineProperties(w.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return this._name}}});Object(Ia.a)(w,"TableNamedObjectInfo",null,[]);Mf.Object.defineProperties(m.prototype,{name:{configurable:!0,enumerable:!0,
get:function(){return this._name}},toolTip:{configurable:!0,enumerable:!0,get:function(){return this.r9}}});Object(Ia.a)(m,"TableSpecialStructRefInfo",null,[]);var me=b(114),$e=b(179),we=b(31),Ya=b(101),h=b(1116),lb=b(259),Ub=b(50),zc=b(187);Object(Ia.a)(y,"FormulaAutoCompleteCallbacks",null,[]);Object(Ia.a)(r,"FormulaAutoCompleteRenderingInfo",null,[]);Object(Ia.a)(v,"RunExperimentRequest",null,[]);var vc=se.a;Rk(f,vc);f.prototype.qme=function(Ja){this.addHandler(f.Sad,Ja)};f.prototype.nPf=function(Ja){this.removeHandler(f.Sad,
Ja)};f.prototype.ome=function(Ja){this.addHandler(f.oad,Ja)};f.prototype.lPf=function(Ja){this.removeHandler(f.oad,Ja)};f.prototype.pme=function(Ja){this.addHandler("FormulaAutoCompleteShown",Ja)};f.prototype.mPf=function(Ja){this.removeHandler("FormulaAutoCompleteShown",Ja)};f.prototype.get_visible=function(){return this.lcf?void 0!==this.pfb?this.pfb:this.pfb=vc.prototype.get_visible.call(this):vc.prototype.get_visible.call(this)};f.prototype.set_visible=function(Ja){if(this.lcf&&this.pfb===Ja)return this.Ck&&
!Ja&&this.e1a(),Ja;this.Qia.set_visible(Ja);this.Ck&&!Ja&&this.e1a();Sys.UI.Control.prototype.set_visible.call(this,Ja);return this.pfb=Ja};f.prototype.STg=function(Ja,Lb){this.isListVisible&&(Ja+=sa.openParen,Lb++,this.ZBd(Ja,Lb));var mc=0<Lb&&Ja.charAt(Lb-1)===sa.openParen,xc=Lb===Ja.length||Ja.charAt(Lb)===sa.closeParen;if(!mc||!xc)return La.ULS.sendTraceTag(537162053,0,50,"FormulaAssistanceControl.CanInsertFormulaArguments Caret position: {0} is invalid. Is cell empty: {1}. Function exists in cell: {2}",
Lb,!Ja.length,!!this.RP),!1;mc=Ja.substring(0,Lb).lastIndexOf(this.$.listSeparator);xc=Ja.substring(0,Lb-1).lastIndexOf(sa.openParen);Ja=Ja.substring(-1===mc&&-1===xc?1:Math.max(mc,xc)+1,Lb-1).trim();return this.functionInfoManager.zdd(Ja)?!0:(La.ULS.sendTraceTag(537162052,0,50,"FormulaAssistanceControl.CanInsertFormulaArguments No valid function name before caret. Function exists in cell: {0}",!!this.RP),!1)};f.prototype.lbi=function(Ja,Lb){var mc=this.STg(Ja,Lb);if(!mc||!this.RP)return La.ULS.shipAssertTag(537162051,
0,!mc||mc&&!!this.RP,"FormulaAssistanceControl.InsertFormulaArgumentsFromCaretPosition currentFunctionInfo is null"),{returnValue:null,yqf:0,HSe:0};mc=this.RP.Params;mc=mc.replace(RegExp("[\\[\\]]","g"),"");var xc=Ja.charAt(Lb-1)===sa.openParen,hd=xc?"":"(",Cd=Lb===Ja.length?")":"";var dc=this.$.listSeparator;dc=mc.includes(dc)?mc.indexOf(dc):mc.length;return{returnValue:Ja.substring(0,Lb)+hd+mc+Cd+Ja.substring(Lb,Ja.length),yqf:xc?Lb:Lb+1,HSe:dc}};f.prototype.Xs=function(Ja,Lb){this.Ck&&void 0!==
this.Gq&&null!==this.Gq&&this.Gq();this.Ck||vc.prototype.Xs.call(this,Ja,Lb)};f.prototype.dispose=function(){if(this.$){this.pSa(!1);var Ja=this.gridView;this.y9&&(this.$.userOperationManager.so(this.tca),this.$.userOperationManager.so(this.pOa));Ja&&(Ja.ha&&(this.Ck?Ja.ha.zF(this.Rc):Ja.ha.sW(this.Rc),ab.a.mV()&&4!==this.FCb&&(this.uzb?Ja.$b.vk(this.Dh):Ja.ha.Fma(this.wsf))),Ja.view.Fq(this.Pmc));this.Ck&&this.$.va&&this.$.va.vg(this.uh)}this.functionInfoManager&&(this.functionInfoManager.Rab(this.onFunctionInfoLoaded),
this.functionInfoManager.zaj(this.qwf));this.Ig&&this.Ig.bsc(this.iya);this.Ck&&this.dh&&this.dh.EId(this.oBf);ab.a.gfc&&this.Ya&&this.Ya.THb(this.a6);this.t6f(!1);cb.a.Ia(this.dh);cb.a.Ia(this.O_b);cb.a.Ia(this.Qia);cb.a.Ia(this.dr);this.Ya=this.functionInfoManager=this.Ig=null;cb.a.oc(this.mJa);this.pg=this.k8=this.Qia=this.mJa=null;vc.prototype.dispose.call(this)};f.prototype.zwa=function(){return!this.Et};f.prototype.uii=function(){return!this.iGa};f.prototype.Hh=function(Ja,Lb){if(!this.zwa()){if(this.Ck&&
this.wH){if(125627505===Lb||267796030===Lb)return this.Ck&&this.LAc(Lb),this.Fze(),this.y9&&this.yUf(),!1;if(1872288872===Lb)return this.Ema(),this.isListVisible=!1,!0;if(this.dh.Lhc&&(-798660877===Lb||137938150===Lb))return!1}if(1!==this.dh.n0||125627505!==Lb&&267796030!==Lb)if(6===this.dh.n0){var mc=Ja.keyCode;13!==mc&&9!==mc||this.Hy(!1)}else{if(4===this.dh.n0||5===this.dh.n0)return vc.prototype.Hh.call(this,Ja,Lb,!0);1===this.dh.dW.length&&(mc=Ja.keyCode,this.Cve=8===mc||127===mc||46===mc?!0:
!1)}else{if(this.Hy(!1)&&!this.Rja)return this.gridView.ha.Hh(Ja,Lb);if(125627505===Lb&&this.Rja)return!0}}return vc.prototype.Hh.call(this,Ja,Lb)};f.prototype.dtc=function(){this.Ig.qbb();this.k8=null;null==this.Cia||this.Cia||this.Djc("NoFieldChosen",1,2,1);this.Cia=null;this.t3=0;this.p5=this.Pqd=this.Xoc=null};f.prototype.$nb=function(){var Ja=this;this.Ddf&&this.formulaAssistanceTelemetryManager.iO(["argumentAssistanceOverall"]);var Lb=!!this.Ya&&!xe.f(this.$.pa),mc=null;this.k2&&Lb&&(mc=this.Ya.text,
mc.startsWith("=")&&(this.CLa=!0,1===mc.length&&(this.isCellContentOnlyEqualDuringEdit=!0)));if((this.FAa||this.Ixc)&&Lb){this.k2||(mc=this.Ya.text);var xc={content:mc,caretPosition:null};(this.rba?this.pluginScheduler.getRequester().functionSuggestion(xc,0):this.pluginScheduler.requester().functionSuggestion(xc)).then(function(hd){0===hd.kind&&(La.ULS.shipAssertTag(537162050,0,!!hd&&!!hd.payload.items,"FormulaAssistanceControl.AssistFormula - x10Scheduler returned `null` suggestion"),hd=bd.toArray(bd.select(bd.asEnumerable(hd.payload.items),
function(Cd){return f.h2g(Cd)})),Ja.Ixc&&"="===mc&&0<hd.length&&Ja.Mq.Ota.VNd("="+hd[0].textEdit.newText),Ja.FAa&&(Ja.XRa=hd,Qd.AFrameworkApplication.Ag||(Ja.wXc&&Ja.Ab.d5(Ja.gridView.ha.sa.activeCell)?Ja.formulaAssistanceTelemetryManager.uM.smartSuggestionWouldSuggestInsidePivotCounter++:Ja.lre(Lb,!0))));return null})}this.FAa&&Lb||this.lre(Lb,!1)};f.prototype.S1e=function(){if(ha.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")){var Ja=this.gridView.pj?
this.aub.SP:this.ypb.SP;"@"===this.Ya.text.charAt(Ja+1)&&this.Ya.textBox.caretPosition>Ja+1?this.Mdb=Ja+2:this.Mdb=Ja+1}else{Ja=this.Ya.text.lastIndexOf(sa.fjf);var Lb=this.Ya.text.lastIndexOf("[");this.Mdb=Ja+1>=Lb?Ja+2:Lb+1}return this.Ya.text.substring(this.Mdb,this.Ya.textBox.caretPosition)};f.prototype.mre=function(){this.m3f()&&(this.Y9g(),this.Et&&(this.Cia=!1,this.wV=this.S1e(),this.dh.$Ia(this.Et,this.wV,!0,void 0,void 0,!0),this.show(),ha.EwaSettings.isChangeGateEnabled("OfficeVSO:5516893_fixInTableHeaderModeAccordingToCaretPoisiton")&&
this.Qia.csb()))};f.prototype.kre=function(){this.m3f()&&(this.O_b&&this.O_b.cancel(),this.Ig.Q5a?(this.zwa()&&this.XBe(!0),this.get_visible()?this.HRe():this.U0d=$e.AsyncMethodContext.Ms(this.HRe,sa.vch,Fd.a.PCh,this.O_b)):this.lZ())};f.prototype.m3f=function(){return this.Ya?0<this.$.ob.nR||!this.Ya.text||!this.Ya.isEditing?(this.set_visible(!1),!1):xe.f(this.$.pa)?!1:!0:!1};f.prototype.mqb=function(Ja){this.Ya&&this.isListVisible&&(this.Zkd(this.Ya.text,Ja),this.Ya.textBox.caretPosition=Ja.range.start.character+
Ja.newText.length,this.set_visible(!1))};f.prototype.Hy=function(){var Ja;if(!this.Ya||!this.isListVisible)return!1;var Lb=this.dh.n0;this.Ubf&&this.formulaAssistanceTelemetryManager.G8e(z.OWe(Lb));var mc="",xc=0,hd=this.gridView,Cd=this.Ya.text,dc=0,Ec=this.dh.fe,gb=!1;if(0===Lb||2===Lb||3===Lb||7===Lb)mc+=Cd.substr(0,this.Q2a)+this.dh.fe,0!==Lb||this.dh.fe.endsWith(")")||(mc+="("),xc=mc.toString().length,mc+=Cd.substr(this.r$b),2===Lb&&(dc=4,Ec="DefinedName",gb=!0,this.set_visible(!1));else if(1===
Lb)if(this.Cia=!0,this.Rja){mc+=Cd.substr(0,this.t3+2);!mc.toString().endsWith(Se.a.xU)&&ha.EwaSettings.ma(136)&&(mc+=Se.a.xU);dc=this.dh.fe;dc=dc.replace("'","''");dc=dc.replace("[","'[");dc=dc.replace("]","']");if(this.c5c||this.syh(dc))dc=Se.a.gri+dc+Se.a.Fhj,gb=!0;mc+=dc;xc=mc.length;dc=3;zc.a("PulloutFieldAccepted")}else return this.Ya.text=this.dh.fe,this.set_visible(!1),hd.wo(!1),hd.focus(),this.Djc("FieldName",1,1,1),zc.a("TableHeaderAutoCompleteSuggestionAccepted"),!0;else if(5===Lb)La.ULS.sendTraceTag(537162048,
0,50,"FormulaAssistanceControl.Autocomplete: User selected TableSpecialStructRef listbox item"),mc+=Cd.substr(0,this.Mdb),wb.a.equals(this.dh.fe,"@ - "+this.instantaneousSupportInformationManager.we.ThisRowStructRefString,!1)?mc+="@":(mc+=this.dh.fe,gb=!0,this.set_visible(!1)),xc=mc.length;else if(4===Lb){La.ULS.sendTraceTag(575776009,0,50,"FormulaAssistanceControl.Autocomplete: User selected TableColHeaderName listbox item}");mc+=Cd.substr(0,this.Mdb);gb="";xc=!1;for(var Bb=[39,91,93,64,35],qc=0;qc<
this.dh.fe.length;qc++){var Nc=this.dh.fe.charCodeAt(qc);Array.contains(Bb,Nc)&&(gb+="'");gb+=this.dh.fe.charAt(qc).toString();xc||wb.a.isNumeral(Nc)||wb.a.qdf(Nc)||(xc=!0)}Bb=this.gridView.pj?this.aub.SP:this.ypb.SP;Cd=ha.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")?"@"===Cd.charAt(Bb+1)&&xc:Cd.lastIndexOf(sa.fjf)+1>=Cd.lastIndexOf("[")&&xc;mc+=Cd?"["+gb+"]":gb;gb=!0;this.set_visible(!1);xc=mc.toString().length}else if(6===Lb)mc+=Cd.substr(0,this.osb);
else return La.ULS.sendTraceTag(537162019,0,10,"Autocomplete item type was not set on AutoComplete ListBox"),!1;this.Ya.text=mc;this.Ya.textBox.caretPosition=xc;this.Ya.Vwa()&&(null===(Ja=hd.Dr)||void 0===Ja?0:Ja.yua)&&hd.Dr.TJb(this.Ya.text,this.Ya.textBox.caretPosition,this.Ya.textBox.caretPosition,this.Ya.textBox.gv.length);hd.pj&&(Ja=hd.Wb,Ja.text=this.Ya.text,Ja.setCaretPosition(this.Ya.textBox.caretPosition));Ec=(null==this.Cia?0:this.Cia)?"FieldName":Ec;this.dh.Ok.sectionRowIndex>=this.dh.dW.length?
this.Djc(Ec,4,dc,0):this.Djc(Ec,1,dc,0);gb||(5===Lb||4===Lb?this.mre():this.$nb());return!0};f.prototype.lZ=function(Ja,Lb){Ja=void 0===Ja?null:Ja;Lb=void 0===Lb?null:Lb;Ja?(this.Ig.qbb(),this.Ig.lZ(Ja,!1,!1,Lb)):(Ja=this.gridView,Ja.ha.sa.sg&&(Ja=Dc.v(Ja.ha.sa.Vc,this.$),this.Ig.lZ(Ja,!0,!0,Lb)))};f.prototype.Ema=function(){this.rfa=!1;this.Ya.nHe()};f.prototype.JOh=function(Ja){Ja=this.calcManager.getWorksheetFuncId(Ja);return this.uUe?this.uUe.descriptionsMap.get(Ja):null};f.prototype.XBe=function(Ja){if(this.uii()){if(this.Ig.Q5a&&
this.Ig.Gk&&(!this.Ig.Gk.length||!this.Ig.Gk[0].FieldInfoDataList))return;this.yPj(Ja)}Ja=bd.asEnumerable(this.iGa);Ja=bd.concat(Ja,this.FQh(this.Ya.text));ha.EwaSettings.isChangeGateEnabled("OfficeVSO:5501880_NamedObjectAutoCompleteDropdown")&&this.Ck&&(Ja=bd.concat(Ja,this.MRh()));bd.OBc(Ja,function(Lb){return Lb.name},new h.a);this.FAa&&(Ja=bd.concat(bd.asEnumerable(this.XRa),Ja),ha.EwaSettings.isChangeGateEnabled("OfficeVSO:5592322_fixSmartAutoCompleteItemsBugs")&&(0<this.XRa.length&&(this.GAa=
!0),this.XRa=[]));this.k8=bd.toArray(Ja)};f.prototype.Y9g=function(){var Ja=this.Ya.text;if(ha.EwaSettings.isChangeGateEnabled("OfficeVSO:5402572_CrossSheetTableReferencing")){var Lb=this.gridView.pj?this.aub.OHa:this.ypb.OHa,mc=!0;if(ha.EwaSettings.isChangeGateEnabled("OfficeVSO:5962126_tableColHeadersListJSCrashFix")){if(""!==Lb&&(this.pg=Object(Cc.a)(sd.a,this.$.vb.getItemByName(Lb))),this.pg||(this.pg=this.tableManager.pg,mc=!1),!this.pg){La.ULS.sendTraceTag(527234895,0,50,"FormulaAssistanceControl.createTableColHeaderAutoCompleteList - current table object is null. Total number of named objects in workbook: %d. Is target table name empty? %d",
this.$.vb.count,""===Lb);return}}else this.pg=Object(Cc.a)(sd.a,this.$.vb.getItemByName(Lb)),this.pg||(this.pg=this.tableManager.pg,mc=!1);this.pg.mO&&this.pg.mO.IsFullTableHeaders?this.qGf(mc):qd.d(this.pg)?(La.ULS.sendTraceTag(537162017,0,50,"FormulaAssistanceControl.CreateTableColHeaderAutoCompleteList - Getting column headers for table with xluid - %s",this.pg.Ai),Td.p(this.$.oa.xa,this.pg.Ai,this.NLi,this.MLi,null,null)):La.ULS.sendTraceTag(537162018,0,15,"FormulaAssistanceControl.CreateTableColHeaderAutoCompleteList - Table with xluid %s has header rows turned off.",
this.pg.Ai)}else if(this.calcManager&&this.tableManager.pg)if(Lb=this.calcManager.c4a(this.tableManager.pg))if(this.calcManager.qIg(this.tableManager.pg,Lb)){Ja=bd.empty();if(91===this.Ya.text.charCodeAt(this.Ya.text.length-1)){var xc=this.s0a("@ - "+this.instantaneousSupportInformationManager.we.ThisRowStructRefString);Ja=bd.concat(Ja,(mc=new Ie.a,mc.add(xc),mc))}Ja=bd.concat(Ja,bd.select(bd.asEnumerable(Lb.toArray()),function(hd){var Cd=new X,dc=new B;dc._name=hd.toString();Cd.b_f(dc);return Cd}));
this.k8=bd.toArray(Ja)}else Ja.endsWith("[")&&"["!==Ja.charAt(Ja.length-2)&&La.ULS.sendTraceTag(572381130,0,50,"FormulaAssistanceControl.CreateTableColHeaderAutoCompleteList: calcManager.GetTableHeaders returns partial table header data with {0} columns for a table with id {1} of size {2}",Lb.count,this.tableManager.pg.Ai,this.tableManager.pg.usedRange.right-this.tableManager.pg.usedRange.left+1);else Ja.endsWith("[")&&"["!==Ja.charAt(Ja.length-2)&&La.ULS.sendTraceTag(573149408,0,50,"FormulaAssistanceControl.CreateTableColHeaderAutoCompleteList: calcManager.GetTableHeaders returns null inside a table during table column header autocomplete list creation")};
f.prototype.syh=function(Ja){if(!Ja)return!1;var Lb=Ja.charCodeAt(0);if(46===Lb||48<=Lb&&57>=Lb||63===Lb)return!0;for(var mc=0;mc<Ja.length;mc++,Lb=Ja.charCodeAt(mc))if(!((ha.EwaSettings.isChangeGateEnabled("OfficeVSO:4831363_UseUpdatedisLetterCharacterCodeRangesInStringExtensions")?wb.a.isLetter(Lb):wb.a.Und(Lb))||92===Lb||95===Lb||63===Lb||48<=Lb&&57>=Lb))return!0;return!1};f.prototype.ZBd=function(Ja,Lb){var mc=!1,xc=!1,hd=!1,Cd=0,dc=0;this.Q2a=0;this.r$b=Lb;this.b5b=1;for(var Ec=Lb-1;0<=Ec;--Ec)switch(Ja.charCodeAt(Ec)){case 39:xc=
!xc;break;case 34:mc=!mc;break;case 91:++Cd;hd=Cd>dc;break;case 93:++dc}hd=Object(Kd.a)(new O,{Csa:!mc,Dsa:!xc,Dha:!hd,AFb:1});Cd=this.fWi(Ja,Lb,hd);Lb=this.gWi(Ja,Lb,hd.Csa,hd.Dsa,hd.Dha);this.b5b=Cd+Lb;if(this.NPc=Cd-1)this.Gwc=!1;this.hzh(Ja,mc,xc,hd.yBd,hd.zBd)};f.prototype.Mkd=function(){4!==this.FCb&&(this.uzb?this.gridView.$b.Ak(this.Dh):this.gridView.ha.Bga(this.wsf));var Ja=ab.a.iyb()?this.Mq.Ub(null):void 0;this.TNa(Ja);ab.a.gfc&&this.gridView.Gi.jYa(this.a6);f.pLd(this.pluginScheduler);
this.FAa&&this.oWg()};f.prototype.Exh=function(){return this.FAa||this.ZQe};f.prototype.hWi=function(){var Ja=this.p5;if(!this.xwj||!Ja)return this.t3=0,this.iGa=this.k8=null,!1;Ja=Ja.endsWith(Se.a.xU);var Lb;if(Lb=ha.EwaSettings.ma(136)){Lb=this.VMj(this.p5.substring(0,this.u3));var mc=Lb.sheetRange;Lb=Lb.returnValue}return Lb&&(Lb=this.p5.substring(0,this.t3),Ja&&Lb!==this.Pqd)?(this.Pqd=Lb,this.t3=this.p5.length-(Ja?1:0),this.lZ(mc,this.p5),this.Cia=!1,La.ULS.sendTraceTag(537162015,0,50,"Begin dot notation autocomplete"),
!0):!1};f.prototype.FQh=function(Ja){var Lb=new Ie.a;this.calcManager&&ha.EwaSettings.isChangeGateEnabled("OfficeVSO:4986015_LetAutocompleteTelemetry")&&La.ULS.shipAssertTag(537162014,0,!!this.calcManager.Rsa(af.Range.Tc(1,1)),"FormulaAssistanceControl.GetLetVariables() - ConvertToSheetGridCell() is null");if(this.calcManager&&this.ZQe&&(Ja=this.calcManager.extractLetVariables(Ja,this.Ya.textBox.caretPosition))){Ja=bk(Ja);for(var mc=Ja.next();!mc.done;mc=Ja.next()){var xc=mc.value;mc=new A;mc._name=
xc;mc.r9=kb.a.instance.ga(2187);xc=new X;xc.qqj(mc);Lb.add(xc)}}return Lb};f.prototype.MRh=function(){for(var Ja=new Ie.a,Lb=this.$.vb.items,mc=0,xc=Lb.length;mc<xc;mc++){var hd=Lb[mc];if(xe.n(hd)){var Cd=new w;Cd._name=hd.name;hd=new X;hd.Hsj(Cd);Ja.add(hd)}}return Ja};f.prototype.s0a=function(Ja){var Lb=new X,mc=new m;mc._name=Ja;Lb.Isj(mc);return Lb};f.prototype.qGf=function(Ja){var Lb=new Ie.a,mc=this.Ya.text.charCodeAt(this.Ya.text.length-1),xc=this.Ya.textBox.caretPosition-1;if(ha.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")?
91===this.Ya.text.charCodeAt(xc):91===mc){var hd=this.s0a("@ - "+this.instantaneousSupportInformationManager.we.ThisRowStructRefString);Lb.add(hd)}hd=bk(this.pg.mO.HeadersList);for(var Cd=hd.next();!Cd.done;Cd=hd.next()){Cd=Cd.value;var dc=new X,Ec=new B;Ec._name=Cd.Name;dc.b_f(Ec);Lb.add(dc)}hd=this.gridView.pj?this.aub.SP:this.ypb.SP;Cd=this.Ya.text.charCodeAt(hd+1);(ha.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")?!Ja||xc!==hd&&35!==Cd:!Ja||91!==
mc&&35!==mc)||(Ja=this.s0a("#"+this.instantaneousSupportInformationManager.we.AllStructRefString),Lb.add(Ja),Ja=this.s0a("#"+this.instantaneousSupportInformationManager.we.DataStructRefString),Lb.add(Ja),Ja=this.s0a("#"+this.instantaneousSupportInformationManager.we.HeadersStructRefString),Lb.add(Ja),Ja=this.s0a("#"+this.instantaneousSupportInformationManager.we.TotalsStructRefString),Lb.add(Ja));Lb&&(this.k8=Lb.toArray())};f.prototype.yPj=function(Ja){var Lb=bd.empty();!Ja&&this.functionInfoManager.TZ&&
(Lb=bd.concat(Lb,bd.select(bd.asEnumerable(this.functionInfoManager.q$b),function(mc){var xc=new X;xc.EYf(mc);return xc})),Ja=this.Q5b.RFe,0<Ja.length&&(Lb=bd.OBc(bd.concat(Lb,bd.select(bd.asEnumerable(Ja),function(mc){var xc=new X;xc.Poj(mc);return xc})),function(mc){return mc.name},new h.a)));if(this.Ig.Q5a&&this.Ig.Gk){if(!this.Ig.Gk.length||!this.Ig.Gk[0].FieldInfoDataList)return;Lb=bd.OBc(bd.concat(Lb,bd.select(bd.asEnumerable(this.Ig.Gk[0].FieldInfoDataList),function(mc){var xc=new X;xc.opj(mc);
return xc})),function(mc){return mc.name},new h.a);this.columnName=this.Ig.Gk[0].ColumnName}this.iGa=bd.toArray(Lb)};f.prototype.TNa=function(Ja){var Lb;if(1!==this.FCb){var mc=this.gridView.ha.sa.activeCell;if(mc){var xc=this.calcManager.Rsa(mc,!this.mmd);if(xc){var hd=this.$.va,Cd=xc.sheet.index;0>=hd.count||0>Cd||Cd>=hd.count||(Cd=hd=null,this.oxd&&void 0!==this.calcManager&&null!==this.calcManager&&(Ja=null!==(Lb=null===Ja||void 0===Ja?void 0:Ja.cell)&&void 0!==Lb?Lb:this.gridView.Ea.Jr(mc))&&
(Lb=this.calcManager.tbc(Ja.Yk),void 0!==Lb&&null!==Lb&&(hd=Lb.FormatString,Cd=Lb.Builtin)),2!==this.FCb&&this.pluginScheduler.notifier().setActiveCell({colIndex:xc.range.col,rowIndex:xc.range.row,sheetIndex:this.$.va.getItem(xc.sheet.index).sheetId,docName:xc.sheet.document.name,docPath:xc.sheet.document.path,formatString:hd,builtIn:Cd}))}}}};f.prototype.yUf=function(){this.formulaAssistanceTelemetryManager.g_={rk:this.gridView.ha.sa.activeCell,zpb:this.gridView.Wb.text,oqb:!0};this.formulaAssistanceTelemetryManager.lBb=
this.$.ea.Ue;this.formulaAssistanceTelemetryManager.ajc=this.$.va.pa.sheetId;this.$.userOperationManager.zr(this.pOa)};f.prototype.oWg=function(){this.gridView.pj?this.aub.$T(!1):this.ypb.$T(!1)};f.prototype.Xgf=function(Ja){var Lb=ha.EwaSettings.isChangeGateEnabled("OfficeVSO:4831363_UseUpdatedisLetterCharacterCodeRangesInStringExtensions")?wb.a.isLetter(Ja):wb.a.Und(Ja);return 48<=Ja&&57>=Ja||46===Ja||95===Ja||Lb};f.prototype.show=function(){if(this.Et){var Ja=this.dh.Qcg(0);this.Ck?0<this.dh.mq.length?
Ja||this.b3f():this.e1a():((Ja=0<this.dh.mq.length)&&this.formulaAssistanceTelemetryManager.iO(["autoCompleteRender"]),!this.isListVisible&&this.columnName&&Ja&&this.dh.c3i(this.dh.mq.length,this.columnName),this.isListVisible=Ja,this.Qia.show(this.RP),this.vBa(!0),this.dh.Oxa(),Ja&&this.formulaAssistanceTelemetryManager.dQ(["autoCompleteRender"]))}};f.prototype.gWi=function(Ja,Lb,mc,xc,hd){for(mc=Object(Kd.a)(new O,{TDf:41,Bye:40,Csa:mc,Dsa:xc,Dha:hd});Lb<Ja.length&&!this.QEf(Ja,Lb,mc);++Lb);return mc.AFb};
f.prototype.fWi=function(Ja,Lb,mc){for(--Lb;0<=Lb&&!this.QEf(Ja,Lb,mc);--Lb);return mc.AFb};f.prototype.QEf=function(Ja,Lb,mc){var xc=Ja.charCodeAt(Lb);0>=this.u3&&(this.u3=Ja.substring(0,Lb).lastIndexOf(Se.a.xU));46===xc&&(Lb<this.u3?this.u3=Lb:Lb>this.osb&&(this.t3=this.osb=Lb));if(!this.Xgf(xc)&&!f.Vni(xc)&&(!this.Rja||Lb<=this.u3||!f.o7h(xc,mc))){mc.Luf&&(mc.Luf=!1,this.Q2a=Lb+1);if(mc.fAd){mc.zBd=Lb+1;if(this.functionInfoManager.zdd(Ja.substring(mc.zBd,mc.yBd)))return!0;mc.fAd=!1}switch(xc){case 39:mc.Dsa=
!mc.Dsa;break;case 34:mc.Csa=!mc.Csa;break;case 91:mc.Dha=!1;break;case 93:mc.Dha=!0}xc===this.$.listSeparator.toString().charCodeAt(0)&&mc.Dsa&&mc.Csa&&!mc.E_a&&(!this.Rja||mc.Dha)&&(Lb<mc.bMd||-1===mc.bMd)&&(mc.AFb+=1,this.b5b++);xc===mc.Bye&&mc.Csa&&mc.Dsa&&(!this.Rja||mc.Dha)?mc.E_a+=1:xc===mc.TDf&&mc.Csa&&mc.Dsa&&(!this.Rja||mc.Dha)?0<mc.E_a?--mc.E_a:(mc.bMd=mc.GSe,mc.GSe=Lb,0<Lb&&this.Xgf(Ja.charCodeAt(Lb-1))&&(mc.fAd=!0,mc.yBd=Lb)):this.Rja&&46===xc&&Lb>this.u3&&(Lb<this.u3?this.u3=Lb:Lb>this.osb&&
(this.t3=this.osb=Lb))}return!1};f.prototype.hzh=function(Ja,Lb,mc,xc,hd){this.r$b>this.Q2a&&0<=this.Q2a?Lb||mc||(this.wV=Ja.substring(this.Q2a,this.r$b)):this.wV=null;xc!==hd?(Ja=Ja.substring(hd,xc),this.RP&&wb.a.equals(this.RP.NameDataStrings,Ja,!0)||(this.Gwc=!0),this.RP=this.functionInfoManager.zdd(Ja)):(this.Gwc=!1,this.RP=null)};f.prototype.t6f=function(Ja){var Lb=$get(sa.KEf+"_"+sa.zFb,this.domElement),mc=$get(sa.LEf+"_"+sa.zFb,this.domElement);Ja&&!this.rdc?(Lb&&ve.a.instance.ra(Be.a.click,
Lb,this.qca),mc&&ve.a.instance.ra(Be.a.click,mc,this.qca),this.rdc=!0):this.rdc&&(Lb&&ve.a.instance.Ba(Be.a.click,Lb,this.qca),mc&&ve.a.instance.Ba(Be.a.click,mc,this.qca),this.rdc=!1)};f.prototype.VMj=function(Ja){var Lb=this;var mc=null;var xc;if(function(){var Ec=Dc.Z(Ja,Lb.$.ea.va);Cd=Ec.sheetName;xc=Ec.range;return Ec}().returnValue&&xc){if(!Cd){var hd=Object(Cc.a)(Ya.a,this.$.pa);if(!hd)return{returnValue:!1,sheetRange:mc};var Cd=hd.name}mc=Dc.v(xc,this.$);mc.SheetName=Cd;this.c5c=!1;return{returnValue:!0,
sheetRange:mc}}var dc=null;return function(){var Ec=Lb.Q5b.EMj(Ja);Cd=Ec.sheetName;dc=Ec.range;return Ec}().returnValue?(mc=Dc.v(dc,this.$),mc.SheetName=Cd,this.c5c=!0,{returnValue:!0,sheetRange:mc}):{returnValue:!1,sheetRange:mc}};f.prototype.nLd=function(Ja){Ja={content:Ja,isCellContentOnlyEqualDuringEdit:this.isCellContentOnlyEqualDuringEdit};this.rba?this.pluginScheduler.getRequester().runAuthoringExperiment(Ja,0):this.pluginScheduler.requester().runAuthoringExperiment(Ja)};f.prototype.Tjd=function(){if(1===
this.dh.dW.length&&this.Et.length){var Ja=this.Et[this.dh.dW[0]];if(1===Ja.itemType){var Lb=Ja.name;Ja=this.Ya.text;Lb=Lb.substring(Ja.length,Lb.length);Lb.length&&(this.Ya.text=Ja+Lb,this.Ya.textBox.selectRange(Ja.length,this.Ya.text.length))}}else La.ULS.shipAssertTag(537162007,0,!1,"InCellAutoComplete should only be called when there is 1 item (number of items: {0})",this.dh.dW.length)};f.prototype.Djc=function(Ja,Lb,mc,xc){var hd={};hd.a=Ja;hd.b=Lb;hd.c=mc;hd.d=xc;Ub.b().Ce(38,hd,!0)};f.prototype.lre=
function(Ja,Lb){if(!this.functionInfoManager.TZ){if(Ja)if(this.ZBd(this.Ya.text,this.Ya.textBox.caretPosition),this.FAa||this.wV){var mc={};mc.Filter=this.wV?this.wV.charAt(0).toString():"";mc.FilterType=1;mc.IncludeOneOfEachGroupUI=!1;this.functionInfoManager.H1a(mc)}else ha.EwaSettings.isChangeGateEnabled("OfficeVSO:6518663_FlightRemovalAutocompleteTableColumnHeaders")&&this.get_visible()&&this.set_visible(!1);if(!Lb)return}0<this.$.ob.nR||this.Ya&&!this.Ya.isEditing?this.set_visible(!1):Ja&&(this.ZBd(this.Ya.text,
this.Ya.textBox.caretPosition),this.Qia.update(this.RP,this.b5b,this.NPc,this.Gwc),this.p5=this.Ya.text.substring(1,this.Ya.textBox.caretPosition),this.u3=this.p5.indexOf(Se.a.xU),this.t3=this.p5.lastIndexOf(Se.a.xU),this.hWi()?(Ja=new X,Ja.frj(),this.iGa=this.k8=Ja=[Ja],this.dh.xRj(Ja),this.show()):((this.Exh()||this.zwa())&&this.XBe(!1),0<this.t3?this.dh.$Ia(this.Et,this.p5,!1,void 0,this.p5.lastIndexOf(Se.a.xU),!1):this.dh.$Ia(this.Et,this.wV,!1,void 0,this.t3,!1),this.show(),this.Ck&&(this.dh.mq.length||
this.gridView.Gi.AK?this.Qia.csb():(this.Qia.JJd(),this.Ck&&this.e1a()))))};f.prototype.b3f=function(){var Ja=this;if(0<this.dh.mq.length){this.formulaAssistanceTelemetryManager.iO(["autoCompleteRender"]);if(this.formulaAssistanceUIControl){var Lb={};Lb.zoomLevel=ia(this.$);this.formulaAssistanceUIControl.updateContext(Lb);this.Gq=function(){Ja.formulaAssistanceUIControl.renderAutoCompleteMenu(Ja.c0b,Ja.gridView.Gi.textBox.domElement,Ja.vdd())};this.Gq();this.Ck&&this.dh.Lhc&&this.raiseEvent(f.Sad,
null);this.Hld||this.dh.Lhc||this.raiseEvent("FormulaAutoCompleteShown");this.Hld=this.dr.canReceiveFocus=!0;this.Ubf&&this.formulaAssistanceTelemetryManager.H8e(this.dh.c3b)}this.formulaAssistanceTelemetryManager.dQ(["autoCompleteRender"]);!ha.EwaSettings.isChangeGateEnabled("OfficeVSO:5592322_fixSmartAutoCompleteItemsBugs")&&void 0!==this.XRa&&null!==this.XRa&&0<this.XRa.length&&(this.GAa=!0)}};f.prototype.Usd=function(){this.gIa&&(this.formulaAssistanceTelemetryManager.nY.selectByArrowKeyCounter++,
this.gIa=!1);this.hIa&&(this.formulaAssistanceTelemetryManager.nY.selectByMouseHoverCounter++,this.hIa=!1);this.fIa&&(this.formulaAssistanceTelemetryManager.nY.commitByTabKeyCounter++,this.fIa=!1);this.dIa&&(this.formulaAssistanceTelemetryManager.nY.commitByEnterKeyCounter++,this.dIa=!1);this.eIa&&(this.formulaAssistanceTelemetryManager.nY.commitByMouseClickCounter++,this.eIa=!1)};f.prototype.vdd=function(){var Ja=new r;Ja.completionItems=this.dh.c3b;Ja.activeItemIndex=this.dh.Ok?this.dh.Ok.rowIndex:
-1;this.$Gd(Ja);return Ja};f.prototype.$Gd=function(Ja){Ja.callbacks=new y;Ja.callbacks.onCompletionItemSelected=this.Oyd;Ja.callbacks.onCompletionItemCommitted=this.Nyd;Ja.callbacks.onFeedback=this.SQa;Ja.callbacks.onDismiss=this.onDismiss;Ja.callbacks.onRestoreFocus=ha.EwaSettings.isChangeGateEnabled("OfficeVSO:6178649_FixFormulaBarFocusBug")?this.onRestoreFocus:void 0};f.prototype.IDd=function(Ja){this.rfa=!0;var Lb=Ja.textEdit.newText;this.Ya.fdb(Lb.substring(this.Ya.text.length-Ja.textEdit.range.start.character,
Lb.length))};f.prototype.Fze=function(){this.Hy(!0);this.rfa=this.isListVisible=!1;this.YRa=this.ZRa=!0};f.prototype.Zkd=function(Ja,Lb){this.Ya.text=Ja.substring(0,Lb.range.start.character)+Lb.newText+Ja.substring(Lb.range.end.character,Ja.length);this.gridView.pj&&(this.gridView.Wb.text=this.Ya.text)};f.pLd=function(Ja){ha.EwaSettings.isChangeGateEnabled("OfficeVSO:6409372_isGroupwisePluginOperationsUse")?Ja.getRequester().runExperiment(new v,0):Ja.requester().runExperiment(new v)};f.h2g=function(Ja){var Lb=
X.H9g(),mc={IsCompatibility:!1};mc.NameDataStrings=Ja.label;mc.Help=Ja.detail;Lb.EYf(mc);Lb.textEdit=Ja.textEdit;return Lb};f.wJa=function(){var Ja=String.format(sa.VDh,sa.ibd,rf.a.zMe),Lb=String.format(sa.QDh,sa.gbd,Le.a.q8c,zb.a.Lo,zb.a.Gp),mc=String.format(sa.NDh,sa.cbd,Le.a.q8c,zb.a.Lo,Le.a.rNe,zb.a.Gp);return String.format("{0}\r\n{1}\r\n{2}",Ja,Lb,mc)};f.Vni=function(Ja){return 36===Ja||58===Ja||33===Ja||39===Ja||32===Ja};f.o7h=function(Ja,Lb){return 32===Ja||91===Ja||!Lb.Dha};Mf.Object.defineProperties(f.prototype,
{Ft:{configurable:!0,enumerable:!0,get:function(){return this.dh}},Et:{configurable:!0,enumerable:!0,get:function(){return this.k8}},LJb:{configurable:!0,enumerable:!0,get:function(){return this.dh.fe}},nUe:{configurable:!0,enumerable:!0,get:function(){return this.dh}},RTe:{configurable:!0,enumerable:!0,get:function(){return this.Qia}},dh:{configurable:!0,enumerable:!0,get:function(){return this.jog}},w0a:{configurable:!0,enumerable:!0,get:function(){return this.FAa?this.Ya?this.Ya.text:null:this.wV}},
isListVisible:{configurable:!0,enumerable:!0,get:function(){return this.Ft.isListVisible},set:function(Ja){this.Ck&&!Ja&&this.e1a();this.Ft.isListVisible=Ja}},tableManager:{configurable:!0,enumerable:!0,get:function(){return this.Kwg}},Rja:{configurable:!0,enumerable:!0,get:function(){return 0<this.t3}},wH:{configurable:!0,enumerable:!0,get:function(){return this.rfa}},gridView:{configurable:!0,enumerable:!0,get:function(){return this.Jhi?this.Mq:Ob.g(this.$)}},Ab:{configurable:!0,enumerable:!0,get:function(){return this.gridView.Ab}},
O_b:{configurable:!0,enumerable:!0,get:function(){return this.U0d}},t3:{configurable:!0,enumerable:!0,get:function(){return this.eIe},set:function(Ja){this.eIe=Ja;Ja||(this.u3=0)}},xwj:{configurable:!0,enumerable:!0,get:function(){if(null==this.Xoc){var Ja=this.$.hc;this.Xoc=!!Ja&&!Ja.inEmbedView}return this.Xoc}},$Vf:{configurable:!0,enumerable:!0,get:function(){return this.dh.c3b[this.dh.Ok.rowIndex]}},uUe:{configurable:!0,enumerable:!0,get:function(){!this.jbd&&this.pluginScheduler&&(this.jbd=
this.pluginScheduler.getFunctionsShortDescriptions());return this.jbd}}});f.Sad="FACardOpened";f.oad="FAFocusOnSmartSuggestionsCard";f.ojd=null;Object(Ia.a)(f,"FormulaAssistanceControl",se.a,[580,522,3,581,582]);var ud=Wd.a;Rk(n,ud);n.prototype.sme=function(Ja){this.addHandler("FAFunctionNameUpdated",Ja)};n.prototype.oPf=function(Ja){this.removeHandler("FAFunctionNameUpdated",Ja)};n.prototype.ine=function(Ja){this.addHandler("FAParameterSelectionChangedOld",Ja)};n.prototype.LPf=function(Ja){this.removeHandler("FAParameterSelectionChangedOld",
Ja)};n.prototype.hne=function(Ja){this.addHandler("FAParameterSelectionChanged",Ja)};n.prototype.KPf=function(Ja){this.removeHandler("FAParameterSelectionChanged",Ja)};n.prototype.$Dg=function(Ja){this.addHandler("DC",Ja)};n.prototype.iaj=function(Ja){this.removeHandler("DC",Ja)};n.prototype.dismiss=function(){this.Fv=!1;this.formulaAssistanceUIControl&&(this.Gq=null,this.LQ&&this.OG.detach(),this.formulaAssistanceUIControl.dismiss(this.domElement),this.Nka=null,this.dr.canReceiveFocus=!1)};n.prototype.show=
function(Ja,Lb){var mc=this;this.Fv=!0;var xc=this.rDd(Ja);this.formulaAssistanceUIControl&&(this.formulaAssistanceTelemetryManager.iO(["argumentAssistanceRender"]),Ja={},Ja.zoomLevel=ia(this.$),this.formulaAssistanceUIControl.updateContext(Ja),ha.EwaSettings.isChangeGateEnabled("OfficeVSO:5470368_FormulaAssistanceScroll")?(this.Gq=function(){mc.formulaAssistanceUIControl.renderArgumentAssistanceCard(mc.domElement,Lb,xc)},this.Gq()):this.formulaAssistanceUIControl.renderArgumentAssistanceCard(this.domElement,
Lb,xc),this.vCd(xc),this.LQ&&this.OG.ka(this.formulaAssistanceUIControl.getCalloutElement(0),this.formulaAssistanceUIControl.getDraggableElement(0),this.Gq,function(){return mc.formulaAssistanceUIControl.dismiss(mc.domElement)}),this.dr.canReceiveFocus=!0,this.formulaAssistanceTelemetryManager.dQ(["argumentAssistanceRender"]),this.formulaAssistanceTelemetryManager.B7b("argumentAssistanceOverall"))};n.prototype.dispose=function(){if(this.$){var Ja=Ob.g(this.$);Ja&&(Ja.ha&&Ja.ha.zF(this.Rc),Ja.view.Fq(this.Xs),
this.LQ&&Ja.$b.Nl(this.Af))}cb.a.Ia(this.dr);this.$=null};n.prototype.rDd=function(Ja){var Lb=new N;Lb.functionRenderingInfo=Ja;Lb.cardMode=this.y2;this.cHd(Lb);return Lb};n.prototype.cHd=function(Ja){Ja.callbacks=new M;Ja.callbacks.onHelpLink=this.Jdd(Ja.functionRenderingInfo);Ja.callbacks.onCardModeChange=this.onCardModeChange;Ja.callbacks.onFeedback=this.SQa;this.H4&&(Ja.callbacks.onDismissClick=this.onDismissClick)};n.prototype.Jdd=function(Ja){var Lb=this;return function(){za(Lb.$,Ja.helpID,
Ja.isUDF)}};n.prototype.PNd=function(){var Ja=ad.a.get(qb.a.C_b);this.y2=Ja?parseInt(Ja,10):n.S4c;this.formulaAssistanceTelemetryManager.kXf(this.y2)};n.prototype.vCd=function(Ja){var Lb=Ja.functionRenderingInfo.functionName;this.Nka&&wb.a.equals(this.Nka,Lb,!0)?(Lb=Yd.a.map(Ja.functionRenderingInfo.signatures,function(mc){var xc="";0<=mc.signatureParams.activeParam&&mc.signatureParams.activeParam<mc.signatureParams.params.length&&(xc=mc.signatureParams.params[mc.signatureParams.activeParam]);return xc}),
this.raiseEvent("FAParameterSelectionChanged",new fa(Lb))):(this.Nka=Lb,Ja=Yd.a.map(Ja.functionRenderingInfo.signatures,function(mc){return mc.signatureParams.params.join(", ")}),this.raiseEvent("FAFunctionNameUpdated",new ca(Lb,Ja)))};n.prototype.TNb=function(Ja){this.y2=Ja;try{ad.a.Gw(qb.a.C_b,Ja.toString(),pe.AFrame.fea)}catch(Lb){La.ULS.sendTraceTag(537162074,0,15,"Failed setting ArgumentAssistanceCardCollapseState cookie with error message: {0}",Lb.message)}};n.wJa=function(){return document.createElement("div")};
Mf.Object.defineProperties(n.prototype,{visible:{configurable:!0,enumerable:!0,get:function(){return this.Fv},set:function(Ja){Ja||this.dismiss();this.Fv=Ja}}});n.S4c=0;Object(Ia.a)(n,"FormulaArgumentAssistanceControl",Wd.a,[604]);var Gd;(function(Ja){Ja[Ja.Dismissed=0]="Dismissed";Ja[Ja.Smart=1]="Smart";Ja[Ja.Simple=2]="Simple";Ja[Ja.Mixed=3]="Mixed"})(Gd||(Gd={}));Object(Ia.b)("UIState",Gd);var od=Wd.a;Rk(l,od);l.prototype.qme=function(Ja){this.addHandler("FACardOpened",Ja)};l.prototype.nPf=function(Ja){this.removeHandler("FACardOpened",
Ja)};l.prototype.ome=function(Ja){this.addHandler("FAFocusOnSmartSuggestionsCard",Ja)};l.prototype.lPf=function(Ja){this.removeHandler("FAFocusOnSmartSuggestionsCard",Ja)};l.prototype.pme=function(Ja){this.addHandler("FormulaAutoCompleteShown",Ja)};l.prototype.mPf=function(Ja){this.removeHandler("FormulaAutoCompleteShown",Ja)};l.prototype.IUc=function(Ja){this.addHandler("SelectedRowChanged",Ja)};l.prototype.EId=function(Ja){this.removeHandler("SelectedRowChanged",Ja)};l.prototype.mZb=function(Ja){this.addHandler("ListBoxUpdated",
Ja)};l.prototype.ksc=function(Ja){this.removeHandler("ListBoxUpdated",Ja)};l.prototype.dispose=function(){if(this.$){var Ja=Ob.g(this.$);this.y9&&(this.$.userOperationManager.so(this.tca),this.$.userOperationManager.so(this.pOa));Ja&&(Ja.ha&&Ja.ha.zF(this.Rc),Ja.$b&&this.Zyb&&Ja.$b.Nl(this.Af),Ja.view.Fq(this.Xs));this.$.va&&this.$.va.vg(this.uh)}cb.a.Ia(this.dr);this.$=null};l.prototype.NDg=function(Ja){this.addHandler("CVIC",Ja)};l.prototype.V$i=function(Ja){this.removeHandler("CVIC",Ja)};l.prototype.Hh=
function(Ja,Lb){if(!this.visible)return!1;this.LAc(Lb);var mc;return(mc=this.M2h(Lb)).Ycc?mc.result:this.cwj(Lb)};l.prototype.owb=function(Ja){if(!this.visible)return!1;var Lb=!1;switch(Ja){case 1872288872:this.wH&&this.Ema();this.visible=!1;Lb=!0;break;case -798660877:this.Web(this.Uvb(this.LW+1));Lb=!0;break;case 137938150:this.Web(this.Uvb(this.LW-1));Lb=!0;break;case 2091832999:this.Web(this.Uvb(this.LW+8));Lb=!0;break;case 742457698:this.Web(this.Uvb(this.LW-8));Lb=!0;break;case 125627505:case 267796030:this.mqb(this.Et.items[this.LW]),
Lb=!0}return Lb};l.prototype.show=function(Ja){this.Ya=Ob.g(this.$).Gi;this.Fv=!0;this.LW=0;this.Et=Ja;0<this.Et.items.length&&(this.render(),this.Web(this.Uvb(this.LW)),1===this.Et.items[0].type&&this.Zyb&&(this.GAa=!0));this.formulaAssistanceTelemetryManager.H8e(Ja.items)};l.prototype.Ema=function(){this.rfa=!1;this.Ya.nHe()};l.prototype.cwj=function(Ja){return[1872288872,-798660877,137938150,2091832999,742457698,125627505,267796030].includes(Ja)};l.prototype.M2h=function(Ja){return this.wH?125627505===
Ja||267796030===Ja?(this.mqb(this.Et.items[this.LW]),{Ycc:!0,result:!1}):!this.GDf||-798660877!==Ja&&137938150!==Ja?{Ycc:!1}:{Ycc:!0,result:!1}:{Ycc:!1}};l.prototype.render=function(){var Ja=this;this.formulaAssistanceTelemetryManager.iO(["autoCompleteRender"]);if(this.formulaAssistanceUIControl){var Lb={};Lb.zoomLevel=ia(this.$);this.formulaAssistanceUIControl.updateContext(Lb);this.Gq=function(){Ja.formulaAssistanceUIControl.renderAutoCompleteMenu(Ja.domElement,Ja.Ya.textBox.domElement,Ja.vdd())};
this.Gq();this.S2i();this.dr.canReceiveFocus=!0;this.formulaAssistanceTelemetryManager.dQ(["autoCompleteRender"]);this.formulaAssistanceTelemetryManager.B7b("autoCompleteOverall")}};l.prototype.S2i=function(){var Ja=this.HNb;this.HNb=this.jZh(this.Et.items);Ja!==Gd.Dismissed&&Ja!==Gd.Smart||this.HNb!==Gd.Simple&&this.HNb!==Gd.Mixed||this.raiseEvent("FormulaAutoCompleteShown")};l.prototype.u3i=function(){var Ja;if(this.Lii&&0!==this.Et.items.length){var Lb=0<=this.LW?this.LW:0,mc=this.Et.items[Lb];
mc={JF:mc.label,description:null!==(Ja=mc.detail)&&void 0!==Ja?Ja:"",selectedIndex:Lb+1,length:this.Et.items.length};this.raiseEvent("SelectedRowChanged",mc)}};l.prototype.mqb=function(Ja){if(this.Ya&&this.visible){var Lb=Ja.textEdit;this.Zkd(this.Ya.text,Lb);this.Ya.textBox.caretPosition=Lb.range.start.character+Lb.newText.length;this.wH&&(this.rfa=!1,this.Zyb&&(this.YRa=this.ZRa=!0),this.y9&&this.vqj(),this.Ya.endEdit(!0,"FormulaAutoCompleteControl.CommitAutoCompletion",0));this.visible=!1;this.raiseEvent("CVIC",
{shouldRequestAutocompleteOnCommit:Ja.shouldRequestAutocompleteOnCommit});this.formulaAssistanceTelemetryManager.G8e(Ja.kind)}};l.prototype.vqj=function(){var Ja=Ob.g(this.$);this.formulaAssistanceTelemetryManager.g_={rk:Ja.ha.sa.activeCell,zpb:Ja.Wb.text,oqb:!0};this.formulaAssistanceTelemetryManager.ajc=this.$.va.pa.sheetId;this.formulaAssistanceTelemetryManager.lBb=this.$.ea.Ue;this.$.userOperationManager.zr(this.pOa)};l.prototype.cIg=function(){this.GAa&&(this.formulaAssistanceTelemetryManager.uM.smartSuggestionShownCounter++,
this.GAa=!1);this.ZRa&&(this.formulaAssistanceTelemetryManager.uM.smartSuggestionSelectedCounter++,this.ZRa=!1);this.YRa&&(this.formulaAssistanceTelemetryManager.uM.smartSuggestionCommittedCounter++,this.YRa=!1)};l.prototype.vdd=function(){var Ja=new r;Ja.completionItems=this.Et.items;Ja.activeItemIndex=this.LW;this.$Gd(Ja);return Ja};l.prototype.$Gd=function(Ja){Ja.callbacks=new y;Ja.callbacks.onCompletionItemSelected=this.Oyd;Ja.callbacks.onCompletionItemCommitted=this.Nyd;Ja.callbacks.onFeedback=
this.SQa;Ja.callbacks.onDismiss=this.EIi;Ja.callbacks.onRestoreFocus=ha.EwaSettings.isChangeGateEnabled("OfficeVSO:6178649_FixFormulaBarFocusBug")?this.onRestoreFocus:void 0};l.prototype.IDd=function(Ja){this.rfa=!0;var Lb=Ja.textEdit.newText;this.Ya.fdb(Lb.substring(this.Ya.text.length-Ja.textEdit.range.start.character,Lb.length))};l.prototype.Web=function(Ja){var Lb=this.LW;this.LW=Ja;var mc=this.Et.items[Ja];this.wH&&this.Ema();Lb!==Ja&&this.render();1===mc.type&&ha.EwaSettings.tb()&&!Ob.g(this.$).Gi.text.includes("\n")&&
this.IDd(mc);this.u3i()};l.prototype.Uvb=function(Ja){return 0>Ja?0:Math.min(Ja,this.Et.items.length-1)};l.prototype.Zkd=function(Ja,Lb){this.Ya.text=Ja.substring(0,Lb.range.start.character)+Lb.newText+Ja.substring(Lb.range.end.character,Ja.length);Ob.g(this.$).pj&&(Ob.g(this.$).Wb.text=this.Ya.text)};l.prototype.Usd=function(){this.gIa&&(this.formulaAssistanceTelemetryManager.nY.selectByArrowKeyCounter++,this.gIa=!1);this.hIa&&(this.formulaAssistanceTelemetryManager.nY.selectByMouseHoverCounter++,
this.hIa=!1);this.fIa&&(this.formulaAssistanceTelemetryManager.nY.commitByTabKeyCounter++,this.fIa=!1);this.dIa&&(this.formulaAssistanceTelemetryManager.nY.commitByEnterKeyCounter++,this.dIa=!1);this.eIa&&(this.formulaAssistanceTelemetryManager.nY.commitByMouseClickCounter++,this.eIa=!1)};l.prototype.LAc=function(Ja){switch(Ja){case -798660877:case 137938150:case 2091832999:case 742457698:this.gIa=!0;break;case 125627505:this.fIa=!0;break;case 267796030:this.dIa=!0}};l.wJa=function(){return document.createElement("div")};
l.prototype.jZh=function(Ja){return Ja.reduce(function(Lb,mc){return Lb|=0===mc.type?Gd.Simple:Gd.Smart},Gd.Dismissed)};Mf.Object.defineProperties(l.prototype,{visible:{configurable:!0,enumerable:!0,get:function(){return this.Fv},set:function(Ja){Ja||this.dismiss();this.Fv=Ja}},wH:{configurable:!0,enumerable:!0,get:function(){return this.rfa}},GDf:{configurable:!0,enumerable:!0,get:function(){return 1===this.Et.items.length&&1===this.Et.items[0].type}}});Object(Ia.a)(l,"FormulaAutoCompleteControl",
Wd.a,[603,3,581]);var Ae=b(978);k.prototype.getRichValueFieldListContext=function(Ja,Lb,mc,xc){var hd={k$:Ja,fIe:Lb},Cd;if(Cd=Object(Ae.b)(this.wrd))Cd=this.wrd,Cd=!(hd.k$.FirstRow===Cd.k$.FirstRow&&hd.k$.FirstColumn===Cd.k$.FirstColumn&&hd.k$.LastRow===Cd.k$.LastRow&&hd.k$.LastColumn===Cd.k$.LastColumn&&hd.k$.SheetName===Cd.k$.SheetName&&hd.fIe===Cd.fIe);Cd&&this.Ig.qbb();this.wrd=hd;this.vBj&&this.Ig.Q5a||this.Ig.lZ(Ja,mc,xc,Lb);this.e9b=new Ae.a;this.Ig.Q5a?this.e9b.resolve(this.Ig.Gk):this.r7i();
return this.e9b.promise};k.prototype.dispose=function(){var Ja,Lb;null===(Lb=null===(Ja=Ob.g(this.$))||void 0===Ja?void 0:Ja.$b)||void 0===Lb?void 0:Lb.Nl(this.Af)};k.prototype.r7i=function(){this.Ig.eZb(this.iya);this.Ig.xEg(this.ywf)};k.prototype.fag=function(){this.Ig.bsc(this.iya);this.Ig.Baj(this.ywf)};Object(Ia.a)(k,"ServerDataProvider",null,[602]);e.prototype.S1h=function(Ja,Lb,mc){return isNullOrUndefined(this.coloredReferencesManager)?!1:this.coloredReferencesManager.kAc(Ja,Lb,mc)};Mf.Object.defineProperties(e.prototype,
{coloredReferencesManager:{configurable:!0,enumerable:!0,get:function(){this.HUa||(this.HUa=this.$.da.za(281));return this.HUa}}});Object(Ia.a)(e,"FormulaHighlightsControl",null,[]);var Ne=b(1186);d.prototype.dispose=function(){if(this.$){var Ja=this.gridView;Ja&&(Ja.ha&&ab.a.mV()&&(this.uzb?Ja.$b.vk(this.Dh):Ja.ha.Fma(this.Ch)),this.Wdf&&Ja.Ea&&Ja.Ea.dv(this.xi))}this.k2&&this.gridView.$b.Nl(this.Af);this.H4&&(this.k2||this.gridView.$b.Nl(this.Af),this.Rpa.iaj(this.Usf));this.H8.V$i(this.btf);this.functionInfoManager&&
this.functionInfoManager.Rab(this.onFunctionInfoLoaded);ab.a.gfc&&this.Ya&&this.Ya.THb(this.a6);cb.a.Ia(this.Rpa);cb.a.Ia(this.H8);this.H8=this.Rpa=this.functionInfoManager=this.$=null};d.prototype.Yej=function(){this.SMa=-1;this.Oka=null};d.prototype.t6b=function(){this.H8.visible=!1;this.Rpa.visible=!1};d.prototype.Hh=function(){this.lda();return!1};d.prototype.lda=function(){if(!this.Ya.AK)if(this.formulaAssistanceTelemetryManager.rob.formulaAssistanceRequestAttemptedCounter++,this.Nwj()){this.functionInfoManager.TZ||
(this.functionInfoManager.mYa(this.onFunctionInfoLoaded),this.functionInfoManager.H1a({}));var Ja=this.Ya,Lb=Ja.text;Ja=Ja.textBox.caretPosition;this.k2&&Lb.startsWith("=")&&(this.CLa=!0,1===Lb.length&&(this.isCellContentOnlyEqualDuringEdit=!0));!this.H4||this.CRa?(this.formulaAssistanceTelemetryManager.iO(["argumentAssistanceComputation","autoCompleteComputation","argumentAssistanceOverall","autoCompleteOverall"]),this.pWf(Lb,Ja)):(this.formulaAssistanceTelemetryManager.iO(["autoCompleteComputation",
"autoCompleteOverall"]),this.Hej(Lb,Ja));ha.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AutoCompleteWrapperPluginRequest",!1)&&this.Gej(Lb,Ja)}else this.formulaAssistanceTelemetryManager.rob.formulaAssistanceRequestOptimizedCounter++};d.prototype.pWf=function(Ja,Lb){var mc=this;Ja=this.pluginScheduler.batchRequester().functionSuggestionAndArgumentAssistance({functionSuggestion:{content:Ja,caretPosition:Lb},argumentAssistance:{content:Ja,caretPosition:Lb}});this.ZV+=1;Ja.then(function(xc){--mc.ZV;
0===xc.kind&&(mc.O3e(xc.payload.argumentAssistance),mc.s4e(xc.payload.functionSuggestion));return null})};d.prototype.Hej=function(Ja,Lb){var mc=this;Ja={content:Ja,caretPosition:Lb};Ja=this.rba?this.pluginScheduler.getRequester().functionSuggestion(Ja,0):this.pluginScheduler.requester().functionSuggestion(Ja);this.ZV+=1;Ja.then(function(xc){--mc.ZV;0===xc.kind&&mc.s4e(xc.payload);return null})};d.prototype.Gej=function(Ja,Lb){var mc=this;Ja={content:Ja,caretPosition:Lb,enableAutocompleteWrapperPlugin:this.Uwa&&
!this.T4&&"="===Ja};this.rba&&(Ja=this.pluginScheduler.getRequester().runPerCharacterExperiment(Ja,0),this.ZV+=1,Ja.then(function(xc){--mc.ZV;if(0===xc.kind){xc=bk(xc.payload.results);for(var hd=xc.next();!hd.done;hd=xc.next())hd=hd.value,0===hd.kind&&(hd=hd.value.items,0<hd.length&&mc.gridView.Ota.VNd("="+hd[0].textEdit.newText))}return null}))};d.prototype.JJd=function(Ja,Lb){var mc=this;Ja={content:Ja,caretPosition:Lb};Ja=this.rba?this.pluginScheduler.getRequester().argumentAssistance(Ja,0):this.pluginScheduler.requester().argumentAssistance(Ja);
this.ZV+=1;Ja.then(function(xc){--mc.ZV;0===xc.kind&&mc.O3e(xc.payload)})};d.prototype.Nwj=function(){var Ja=this.Ya,Lb=Ja.text;Ja=Ja.textBox.caretPosition;if(this.H8.visible&&wb.a.equals(Lb,this.Oka,!0)&&(!this.$gi||!rb.e(Lb))&&Ja===this.SMa)return!1;this.Oka=Lb;this.SMa=Ja;return!0};d.prototype.pLd=function(){this.rba?this.pluginScheduler.getRequester().runExperiment(new v,0):this.pluginScheduler.requester().runExperiment(new v)};d.prototype.O3e=function(Ja){Ja&&this.Ya.isEditing?(this.formulaAssistanceTelemetryManager.dQ(["argumentAssistanceComputation"]),
this.Rpa.show(Ja,this.Ya.textBox.domElement)):this.Rpa.dismiss()};d.prototype.s4e=function(Ja){var Lb;Ja&&0<Ja.items.length&&this.Ya.isEditing&&(!ha.EwaSettings.isChangeGateEnabled("OfficeVSO:6487912_SmartSuggestionFix")||this.Ya.text===this.Oka)?this.wXc&&this.Ab.d5(this.gridView.ha.sa.activeCell)?(this.formulaAssistanceTelemetryManager.uM.smartSuggestionWouldSuggestInsidePivotCounter++,this.H8.dismiss()):(this.formulaAssistanceTelemetryManager.dQ(["autoCompleteComputation"]),this.H8.show(Ja)):this.H8.dismiss();
this.Uwa&&"="===this.Oka&&0<(null===(Lb=null===Ja||void 0===Ja?void 0:Ja.items)||void 0===Lb?void 0:Lb.length)&&1===Ja.items[0].type&&this.gridView.Ota.VNd("="+Ja.items[0].textEdit.newText)};d.prototype.nLd=function(Ja){Ja={content:Ja,isCellContentOnlyEqualDuringEdit:this.isCellContentOnlyEqualDuringEdit};this.rba?this.pluginScheduler.getRequester().runAuthoringExperiment(Ja,0):this.pluginScheduler.requester().runAuthoringExperiment(Ja)};d.prototype.TNa=function(Ja){var Lb,mc=this.gridView.ha.sa.activeCell;
if(mc){var xc=this.calcManager.Rsa(mc,!this.mmd);if(xc){var hd=this.$.va,Cd=xc.sheet.index;0>=hd.count||0>Cd||Cd>=hd.count||(Cd=hd=null,this.oxd&&void 0!==this.calcManager&&null!==this.calcManager&&(Ja=null!==(Lb=null===Ja||void 0===Ja?void 0:Ja.cell)&&void 0!==Lb?Lb:this.gridView.Ea.Jr(mc))&&(Lb=this.calcManager.tbc(Ja.Yk),void 0!==Lb&&null!==Lb&&(hd=Lb.FormatString,Cd=Lb.Builtin)),this.pluginScheduler.notifier().setActiveCell({colIndex:xc.range.col,rowIndex:xc.range.row,sheetIndex:this.$.va.getItem(xc.sheet.index).sheetId,
docName:xc.sheet.document.name,docPath:xc.sheet.document.path,formatString:hd,builtIn:Cd}))}else La.ULS.sendTraceTag(537162002,0,50,"FormulaAssistanceManager.NotifyActiveCellChanged ISheetGridCell location is null")}};d.prototype.ySj=function(){this.pluginScheduler.notifier().setFunctionsInfo(this.functionInfoManager.q$b)};d.prototype.Mkd=function(){this.uzb?this.gridView.$b.Ak(this.Dh):this.gridView.ha.Bga(this.Ch);var Ja=ab.a.iyb()?this.gridView.Ub(null):void 0;this.TNa(Ja);ab.a.gfc&&this.Ya.jYa(this.a6);
this.pLd();this.H8.NDg(this.btf);this.pluginScheduler.setServerDataProvider(new k(this.Ig,this.$));this.lda()};d.prototype.kAc=function(Ja,Lb,mc){mc=Object(Ae.b)(Lb)?this.wdd(Lb,Object(Ae.b)(mc)?mc:Ne.a):this.wdd(Ja.text,Ja.textBox.selection);return this.ZCh.S1h(Ja,Lb,mc)};Mf.Object.defineProperties(d.prototype,{Sia:{configurable:!0,enumerable:!0,get:function(){return this.H8}},QTe:{configurable:!0,enumerable:!0,get:function(){return this.Rpa}},Ya:{configurable:!0,enumerable:!0,get:function(){return this.gridView.Gi}},
Ab:{configurable:!0,enumerable:!0,get:function(){return this.gridView.Ab}}});Object(Ia.a)(d,"FormulaAssistanceManager",null,[577,3]);b(256);var gf=Fc.a;Rk(c,gf);c.prototype.create=function(){var Ja=this,Lb=ab.a.mV(),mc=ha.EwaSettings.ma(374),xc=ha.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.LETAutocomplete",!1),hd=ab.a.SZ(this.$),Cd=this.$.da,dc=ob.GetServiceTaskFactory.create(Cd,134,this.la,this.hb),Ec=ob.GetServiceTaskFactory.Ra(this.$.da,12,477,this.hb);var gb=ab.a.I4()?ob.GetServiceTaskFactory.create(this.$.da,
449,this.$.la,1):Na.Task.Ua(null);var Bb=ab.a.mV()?ob.GetServiceTaskFactory.create(this.$.da,414,this.$.la,1):Na.Task.Ua(null);if(xc||Lb){var qc=ob.GetServiceTaskFactory.Ra(Cd,266,265,this.hb),Nc=ob.GetServiceTaskFactory.Ra(Cd,219,220,this.hb),nd=ob.GetServiceTaskFactory.Ra(Cd,491,492,this.hb);ib.TaskExtensions.Aa(ib.TaskExtensions.Vd([qc,Bb,gb,Nc,nd],this.la),function(){var qe=Cd.za(19)||new P(Ja.$,Bb.result),ee=Nc.result;if(hd){var re=Cd.za(464);re||(re=new d(Ja.$,qe,qc.result,Bb.result,gb.result,
nd.result,Ec.result.E2c(Ja.$,dc.result)),ee.DWc(re.QTe),ee.EWc(re.Sia),ha.EwaSettings.isChangeGateEnabled("OfficeVSO:6312266_RedesignListBoxEvents")&&ee.FWc(re.Sia))}else re=Cd.za(221),re||(re=new f(Ja.$,qe,dc.result,qc.result,null,Ec.result,gb.result,nd.result,Bb.result),ee.DWc(re.RTe),ee.FWc(re.nUe),ee.EWc(re)),mc&&(Cd.za(317)||new ja(Ja.$));Ja.pb(qe)},this.la,3)}else{var Vd=ob.GetServiceTaskFactory.Ra(Cd,219,220,this.hb),oe=ob.GetServiceTaskFactory.Ra(Cd,491,492,this.hb);ib.TaskExtensions.Aa(ib.TaskExtensions.Vd([Vd,
gb,Bb],this.la),function(){var qe=Cd.za(19)||new P(Ja.$,Bb.result),ee=Vd.result,re=Cd.za(221);re||(re=new f(Ja.$,qe,dc.result,null,null,Ec.result,gb.result,oe.result,Bb.result),ee.DWc(re.RTe),ee.FWc(re.nUe),ee.EWc(re));mc&&(Cd.za(317)||new ja(Ja.$));Ja.pb(qe)},this.la,3)}};c.ka=function(Ja){Ja.da.Ga(153,new c(Ja))};Object(Ia.a)(c,"FunctionInfoManagerFactory",Fc.a,[]);b.d(E,"a",function(){return a})},1349:function(u,E,b){function a(){x.a.Fa(c.ka)}function c(V){return sa.call(this,V)||this}function d(){}
function e(V,Ia,Ha,ob){var ib=ta.call(this,V)||this;ib.UCb=null;ib.Mkc=null;ib.Gec=null;ib.a3=null;ib.gka=!1;ib.disposed=!1;ib.EMa=!1;ib.Mh=null;ib.Syd=function(La){I.ULS.sendTraceTag(537163269,0,50,"DataValidationEditDialogDeprecated.OnDataValidationEditSuccessCallback");if(ib.disposed)I.ULS.sendTraceTag(537163268,0,50,"DataValidationEditDialogDeprecated.OnDataValidationEditSuccessCallback: Callback not handled since dialog was already disposed");else{if(J.a(La)){I.ULS.sendTraceTag(537163267,0,15,
"DataValidationEditDialogDeprecated.OnDataValidationEditSuccessCallback - request has expected errors: {0}.",La?ra.a.Ec(La.Errors):null);if(La.Errors&&1===La.Errors.length){var zb=La.Errors[0].MessageId,Fb=ib.Hcd(zb);if(Fb){ib.Jxj(zb)?ib.$sj(Fb):ib.nr(Fb);ib.Uka("OkInvalidByServer",La.Errors[0].MessageIdName);return}}I.ULS.sendTraceTag(537163266,0,15,"DataValidationEditDialogDeprecated.OnDataValidationEditSuccessCallback - Unexpected error, cannot parse: {0}",ra.a.Ec(La.Errors))}ib.Uka("OkValid",
"None");ib.hide()}};ib.r4c=function(La){ib.uW(La);2!==La&&(ib.Mh=ib.$.Fb.sc("UserAction","DataValidationEditTimeToDialogTryClose"));1===La?ib.C9a():2===La?ib.gya():ib.Ela()};ib.rca=function(){ib.XPj();ib.EMa?ib.Vxe():ib.z_c();return ib.gka=!1};ib.selectedRanges=Ia;ib.PRb=Ha;ib.command=ob;3===ob&&(ib.gka=!0);ib.Rb=2;ib.yv=!1;ib.Vf=m.Vf;return ib}function k(V,Ia){this.options=this.cellRange=null;this.cellRange=V;this.options=Ia}function l(V,Ia){var Ha=qa.call(this,V)||this;Ha.I9=null;Ha.bha=null;Ha.MTa=
null;Ha.K9=null;Ha.J9=null;Ha.Vmc=function(){Ha.I9.checked?(Ha.bha.disabled=!1,Ha.MTa.disabled=!1,Ha.K9.disabled=!1,Ha.J9.disabled=!1):(Ha.bha.disabled=!0,Ha.MTa.disabled=!0,Ha.K9.disabled=!0,Ha.J9.disabled=!0);return!1};Ha.get_visible=Ha.Aja;Ha.set_visible=Ha.sna;Ha.uk=Ia;Ha.Uja();return Ha}function n(V,Ia){var Ha=da.call(this,V)||this;Ha.fba=null;Ha.R9e=null;Ha.hba=null;Ha.gba=null;Ha.Wmc=function(){Ha.fba.checked?(Ha.hba.disabled=!1,Ha.gba.disabled=!1):(Ha.hba.disabled=!0,Ha.gba.disabled=!0);return!1};
Ha.get_visible=Ha.Aja;Ha.set_visible=Ha.sna;Ha.uk=Ia;Ha.Uja();return Ha}function f(){}function v(V,Ia,Ha,ob){var ib=Ga.call(this,V)||this;ib.Gtb=null;ib.dMd=null;ib.gka=!1;ib.disposed=!1;ib.EMa=!1;ib.Mh=null;ib.LUj=function(La,zb){ib.xac(La);var Fb=ib.LYd();La=Fb.errorString;var Yb=Fb.lq;if(Fb.returnValue)return ib.oLa(121,ib.ILh(ib.$,zb),0,ib.Z4,!1),"";ib.Uka("OkInvalidByClient",Yb);return La};ib.r4c=function(La){ib.uW(La);ib.Mh=ib.$.Fb.sc("UserAction","DataValidationEditTimeToDialogTryClose");0===
La&&ib.Ela()};ib.selectedRanges=Ia;ib.PRb=Ha;ib.command=ob;3===ob&&(ib.gka=!0);ib.Rb=2;ib.yv=!1;return ib}function r(V,Ia,Ha,ob,ib,La,zb,Fb){Fb=V.Na(9,void 0===Fb?null:Fb);Fb.selectedRanges=Ia;Fb.ruleOptions=Ha;return oa.g(V,"CreateOrEditDataValidation",Fb,ob,ib,La,zb,0)}function y(V,Ia,Ha){var ob=ba.call(this,Ia)||this;ob.Rva=null;ob.gec=null;ob.yT=null;ob.sK=null;ob.Cya=null;ob.Dya=null;ob.e5a=null;ob.gNa=null;ob.V9a=null;ob.JOa=null;ob.uoc=null;ob.tBd=null;ob.RAh=[[12,12,12,12,12,12,12,12],[0,
0,2,2,0,1,0,1],[0,0,2,2,0,1,0,1],[3,3,3,3,3,3,3,3],[5,5,7,7,5,6,5,6],[8,8,10,10,8,9,8,9],[0,0,11,11,0,1,0,1],[4,4,4,4,4,4,4,4]];ob.Jkj=[[12,12],[1,1],[1,1],[12,12],[6,6],[9,9],[1,1],[12,12]];ob.Umc=function(ib){var La=!1;(null===ib||void 0===ib?0:ib.Ca)&&(ib.Ca.keyCode===wa.a.Doa||ib.Ca.keyCode===wa.a.Oh)&&(La=ob.rca(ib),ob.yT.blur(),ob.sK.blur());return La};ob.rca=function(){var ib=ob.yT.selectedIndex,La=ob.sK.selectedIndex;ob.uoc.innerText=ob.$ub(ib,La);ob.tBd.innerText=ob.sfd(ib,La);switch(ib){case 0:return ob.sK.disabled=
!0,Xa.DOMElementExtensions.setVisible(ob.V9a,!1),Xa.DOMElementExtensions.setVisible(ob.JOa,!1),Xa.DOMElementExtensions.setVisible(ob.e5a,!1),Xa.DOMElementExtensions.setVisible(ob.gNa,!1),ob.Rva.disabled=!0,!1;case 3:return ob.sK.disabled=!0,Xa.DOMElementExtensions.setVisible(ob.V9a,!0),Xa.DOMElementExtensions.setVisible(ob.JOa,!1),Xa.DOMElementExtensions.setVisible(ob.e5a,!0),Xa.DOMElementExtensions.setVisible(ob.gNa,!0),ob.Rva.disabled=!1;case 7:return ob.sK.disabled=!0,Xa.DOMElementExtensions.setVisible(ob.V9a,
!0),Xa.DOMElementExtensions.setVisible(ob.JOa,!1),Xa.DOMElementExtensions.setVisible(ob.e5a,!1),Xa.DOMElementExtensions.setVisible(ob.gNa,!1),ob.Rva.disabled=!1;default:ob.Rva.disabled=!1,Xa.DOMElementExtensions.setVisible(ob.V9a,!0),Xa.DOMElementExtensions.setVisible(ob.gNa,!1)}switch(La){case 0:case 1:Xa.DOMElementExtensions.setVisible(ob.JOa,!0);break;default:Xa.DOMElementExtensions.setVisible(ob.JOa,!1)}ob.sK.disabled=!1;ob.uoc.disabled=!1;Xa.DOMElementExtensions.setVisible(ob.e5a,!1);Xa.DOMElementExtensions.setVisible(ob.gNa,
!1);return!1};ob.get_visible=ob.Aja;ob.set_visible=ob.sna;ob.VQ=new va.a;ob.VQ.add(aa.a.instance.ga(1652));ob.VQ.add(aa.a.instance.ga(1653));ob.VQ.add(aa.a.instance.ga(1656));ob.VQ.add(aa.a.instance.ga(1654));ob.VQ.add(aa.a.instance.ga(1655));ob.VQ.add(aa.a.instance.ga(1657));ob.VQ.add(aa.a.instance.ga(1658));ob.VQ.add(aa.a.instance.ga(1659));ob.VQ.add(aa.a.instance.ga(1660));ob.VQ.add(aa.a.instance.ga(1661));ob.VQ.add(aa.a.instance.ga(1662));ob.VQ.add(aa.a.instance.ga(1663));ob.VQ.add("");ob.$=V;
ob.uk=Ha;ob.Uja();return ob}function m(){}function w(V,Ia){var Ha=this;this.EB=this.L0a=this.selectedRanges=null;this.KIe=!1;this.Mh=null;this.tKi=function(ob){I.ULS.sendTraceTag(537163284,0,50,"DataValidationEditCommandHandler.OnGetDataValidationInitialStateSuccessCallback");!ob||J.a(ob)?I.ULS.sendTraceTag(537163283,0,10,"DataValidationEditCommandHandler.OnGetDataValidationInitialStateSuccessCallback, failed to get expected results."):(Ha.L0a=ob.Result,Ha.r_i())};this.Uwh=function(ob){Ha.uW("DataValidationEdit.ExpandExisitngDialog",
ob);Ha.EB.c=w.$ha(ob);1===ob?Ha.rHa(new B(Ha.L0a)):2===ob?Ha.rHa(new B):Ha.Klf()};this.rVi=function(ob){Ha.uW("DataValidationEdit.OverrideExisitngDialog",ob);Ha.EB.c=w.$ha(ob);1===ob?Ha.rHa(new B):Ha.Klf()};this.$=V;this.s4c=Ia}function B(V){this.U4=(V=void 0===V?null:V)?V.IsIgnoreBlank:!0;this.V4=V?V.IsInCellDropDown:!0;this.yN=V?V.LowerBoundary:"";this.zN=V?V.UpperBoundary:"";this.tB=V?V.ConditionType:0;this.ruleType=V?V.RuleType:0;this.NZ=V?V.IsAlertBlocking:!0;this.xT=V?V.AlertTitle:"";this.wT=
V?V.AlertMessage:"";this.iV=V?V.InputMessage:"";this.UE=V?V.InputTitle:"";this.j5=V?V.IsShowErrorAlert:!0;this.k5=V?V.IsShowInputMessage:!0}function A(V){switch(V){case 0:V="AnyValue";break;case 1:V="WholeNumber";break;case 2:V="Decimal";break;case 3:V="List";break;case 4:V="Date";break;case 5:V="Time";break;case 6:V="TextLength";break;case 7:V="Custom";break;default:V="Unknown"}return V}function z(V){switch(V){case 0:V="Between";break;case 1:V="NotBetween";break;case 2:V="Equal";break;case 3:V="NotEqual";
break;case 4:V="GreaterThan";break;case 5:V="LessThan";break;case 6:V="GreaterThanOrEqual";break;case 7:V="LessThanOrEqual";break;default:V="Unknown"}return V}var x=b(10);u=b(0);var D=b(905),I=b(14),F=b(133),G=b(45),T=b(388),O=b(177),U=b(255);B.prototype.isEqual=function(V){return V?this.U4===V.U4&&this.V4===V.V4&&this.yN===V.yN&&this.zN===V.zN&&this.tB===V.tB&&this.ruleType===V.ruleType&&this.NZ===V.NZ&&this.xT===V.xT&&this.wT===V.wT&&this.iV===V.iV&&this.UE===V.UE&&this.j5===V.j5&&this.k5===V.k5:
(I.ULS.shipAssertTag(537163233,0,!1,"DataValidationEditDialogState.IsEqual: State should not be Null"),!1)};Object(u.a)(B,"DataValidationEditDialogState",null,[]);var J=b(295),H=b(186),K=b(294),N=b(21),M=b(134),C=b(50),Q=b(58);w.prototype.Lc=function(){return!1};w.prototype.executeCommand=function(V,Ia){-1728432249!==Ia.command&&H.a(Ia.command);this.selectedRanges=G.r(N.g(this.$).ha.sa.selectedRanges,this.$);N.g(this.$).NRa(!0);this.getDataValidationInitialState();this.Mh=this.$.Fb.sc("UserAction",
"DataValidationEditTimeToDialogOpen");this.KIe?I.ULS.sendTraceTag(537163285,0,50,"Open data validation edit dialog - NOT first time in session"):(I.ULS.sendTraceTag(23667778,0,50,"Open data validation edit dialog - FIRST time in session"),this.KIe=!0);return Q.Task.Ua(!0)};w.prototype.zc=function(V,Ia){return-1728432249===Ia.command};w.prototype.Qc=function(){return!1};w.prototype.getDataValidationInitialState=function(){var V=this,Ia=this.$.oa.xa.Pb();T.a(this.$.userOperationManager,function(Ha,
ob,ib){return U.f(V.$.oa.xa,V.selectedRanges,K.b(Ha,V.tKi),K.a(ob),ib,Ia)},function(Ha){return new O.a(120,0,Ha,16)},null)};w.prototype.r_i=function(){var V=this.EB={};switch(this.L0a.Command){case 0:var Ia="CreateNew";break;case 1:Ia="CreateNewFromRule";break;case 2:Ia="ExpandExisitng";break;case 3:Ia="OverrideExisitng";break;default:Ia="Unknown"}V.a=Ia;this.Mh&&(this.Mh.stop(),this.EB.r=this.Mh.id);switch(this.L0a.Command){case 0:this.EB.b=!1;this.EB.c="None";this.rHa(new B);break;case 1:this.EB.b=
!1;this.EB.c="None";this.rHa(new B(this.L0a));break;case 2:this.EB.b=!0;this.s4c.X3g(this.$,this.Uwh);break;case 3:this.EB.b=!0;this.s4c.Z3g(this.$,this.rVi);break;default:I.ULS.sendTraceTag(537163282,0,10,"DataValidationEditCommandHandler.PrepareUserDialog, unexpected command type.")}};w.prototype.rHa=function(V){this.s4c.rHa(this.$,this.selectedRanges,V,this.L0a.Command);this.dwi(V)};w.prototype.dwi=function(V){w.$rb(V,this.EB);this.EB.d=!0;C.b().Ce(48,this.EB,!0)};w.prototype.Klf=function(){this.EB.d=
!1;C.b().Ce(48,this.EB,!0)};w.prototype.uW=function(V,Ia){var Ha={};V=(Ha.ButtonType=w.$ha(Ia),Ha.DialogName=V,Ha.Location="dialog",Ha.NumberOfSelectedRanges=N.g(this.$).ha.sa.qK,Ha);M.b(this.$).yd(F.a.e6b,V)};w.$rb=function(V,Ia){Ia.e=A(V.ruleType);Ia.f=z(V.tB);Ia.g=!!V.yN;Ia.h=!!V.zN;Ia.i=V.U4;Ia.j=V.V4;Ia.k=V.k5;Ia.l=!!V.UE;Ia.m=!!V.iV;Ia.n=V.j5;Ia.o=V.NZ;Ia.p=!!V.xT;Ia.q=!!V.wT};w.$ha=function(V){switch(V){case 1:return"Yes";case 2:return"No";case 0:return"Cancel";default:return I.ULS.shipAssertTag(537163281,
0,!1,"DataValidationEditCommandHandler.DialogButtonToString: Unknown DialogButton"),"Unknown"}};Object(u.a)(w,"DataValidationEditCommandHandler",null,[429]);var P=b(135),ka=b(1011),R;(function(V){V[V.between=0]="between";V[V.notBetween=1]="notBetween";V[V.equal=2]="equal";V[V.notEqual=3]="notEqual";V[V.greaterThan=4]="greaterThan";V[V.lessThan=5]="lessThan";V[V.greaterThanOrEqual=6]="greaterThanOrEqual";V[V.lessThanOrEqual=7]="lessThanOrEqual"})(R||(R={}));Object(u.b)("DataValidationRuleConditionType",
R);var fa;(function(V){V[V.anyValue=0]="anyValue";V[V.wholeNumber=1]="wholeNumber";V[V.decimal=2]="decimal";V[V.list=3]="list";V[V.date=4]="date";V[V.time=5]="time";V[V.textLength=6]="textLength";V[V.custom=7]="custom"})(fa||(fa={}));Object(u.b)("DataValidationRuleType",fa);var ca=b(150),ea=b(180);Mf.Object.defineProperties(m,{Vf:{configurable:!0,enumerable:!0,get:function(){return ca.a.No(m.qk,"")}},jeh:{configurable:!0,enumerable:!0,get:function(){return ca.a.No(m.neh,ea.a.ga(1650),ea.a.ga(1665),
ea.a.ga(1666),ea.a.ga(1667),ea.a.ga(1668),ea.a.ga(1669),ea.a.ga(1670),ea.a.ga(1671),ea.a.ga(1672),ea.a.ga(1651),ea.a.ga(1675),ea.a.ga(1676),ea.a.ga(1677),ea.a.ga(1678),ea.a.ga(1679),ea.a.ga(1680),ea.a.ga(1681),ea.a.ga(1682),ea.a.ga(1652),ea.a.ga(1653),ea.a.ga(1673),ea.a.ga(1674),ea.a.ga(1664),"255")}},qeh:{configurable:!0,enumerable:!0,get:function(){return ca.a.No(m.oeh,ea.a.ga(1687),ea.a.ga(1691),ea.a.ga(1692),"255","32")}},ueh:{configurable:!0,enumerable:!0,get:function(){return ca.a.No(m.peh,
ea.a.ga(1686),ea.a.ga(1689),ea.a.ga(1688),ea.a.ga(1690),ea.a.ga(1691),ea.a.ga(1692),"255","32")}}});m.Z7f=255;m.qk="<div class='WACDialogRow' id='dataValidationTabsId'> </div> <div class='DataValidationEditErrorMessage WACDialogRowNoBreak' id='ErrorContainer'> <label id='validationErrorMessageId' class='WACDialogLabel' role='alert' >{0}</label> </div>";m.neh="<div class='DataValidationEditTabContent' id='ConditionDivID'> <div class='DataValidationRow' id='allowConditionRow'> <label id='allowConditionSelectionLabelId' class='DataValidationEditElementLabel' for='allowConditionSelectionId'>{0}</label> <select class='WACDialogList DataValidationEditElement DataValidationEditSelect' id='allowConditionSelectionId'> <option value='0'>{1}</option> <option value='1'>{2}</option> <option value='2'>{3}</option> <option value='3'>{4}</option> <option value='4'>{5}</option> <option value='5'>{6}</option> <option value='6'>{7}</option> <option value='7'>{8}</option> </select> </div> <div class='DataValidationRow' id='operatorSelectionDivId'> <label id='operatorSelectionLabelId' class='DataValidationEditElementLabel' for='operatorSelectionId'>{9}</label> <select class='WACDialogList DataValidationEditElement DataValidationEditSelect' id='operatorSelectionId'> <option value='0'>{10}</option> <option value='1'>{11}</option> <option value='2'>{12}</option> <option value='3'>{13}</option> <option value='4'>{14}</option> <option value='5'>{15}</option> <option value='6'>{16}</option> <option value='7'>{17}</option> </select> </div> <div class='DataValidationRow' id='operatorInputDivId1'> <label id='operatorInputLableId1' class='DataValidationEditElementLabel' for='operatorInputId1'>{18}</label> <input type='text' id='operatorInputId1' class='DataValidationEditElement DataValidationEditInput' spellcheck=\"false\" maxlength={23} autocomplete=\"off\"/> </div> <div class='DataValidationRow' id='operatorInputDivId2'> <label id='operatorInputLableId2' class='DataValidationEditElementLabel' for='operatorInputId2'>{19}</label> <input type='text' id='operatorInputId2' class='DataValidationEditElement DataValidationEditInput' spellcheck=\"false\" maxlength={23} autocomplete=\"off\"/> </div> <div class='DataValidationNonBorderRow' id='listDescriptionDivId'> <div id='listDescriptionDummyLabelId' class='DataValidationEditElementLabel'></div> <div class='DataValidationEditNoBorderElement' id='listDescriptionSubDivID'> <label id='listDescriptionLabelId' class='DataValidationEditLabel' for='listDescriptionSubDivID'>{20}</label> </div> </div> <div class='DataValidationNonBorderRow' id='ignoreBlankCheckboxDivID'> <div id='ignoreBlankCheckboxDummyLabelId' class='DataValidationEditElementLabel'></div> <div class='DataValidationEditNoBorderElement' id='ignoreBlankCheckboxSubDivID'> <input type='checkbox' id='ignoreBlankCheckBoxId' class='WACDialogCheckBox DataValidationEditCheckBoxWithText' title='{21}'></input> <label id='\"\"' class='WACDialogLabel' for='ignoreBlankCheckBoxId' >{21}</label> </div> </div> <div class='DataValidationNonBorderRow' id='inCellDropdownDivId'> <div id='inCellDropdownDummyLabelId' class='DataValidationEditElementLabel'></div> <div class='DataValidationEditNoBorderElement' id='inCellDropdownSubDivId'> <input type='checkbox' id='inCellDropdownCheckboxId' class='WACDialogCheckBox DataValidationEditCheckBoxWithText' title='{22}'></input> <label id='\"\"' class='WACDialogLabel' for='inCellDropdownCheckboxId' >{22}</label> </div> </div> </div>";
m.oeh="<div class='DataValidationEditTabContent' id='inputDivID'> <div class='DataValidationNonBorderRow' id='inputMessageCheckBoxDivID'> <label id='showInputCheckBoxLabelId' class='DataValidationEditElementLabel' for='showInputCheckBoxId'>{0}</label> <div class='DataValidationEditNoBorderElement' id='inputMessageCheckBoxSubDivID'> <input type='checkbox' id='showInputCheckBoxId' class='WACDialogCheckBox DataValidationEditCheckBoxNoText'></input> </div> </div> <div class='DataValidationRow' id='inputTitleDivID'> <label id='inputTitleLabelId' class='DataValidationEditElementLabel' for='textForInputTitleId'>{1}</label> <input type='text' id='textForInputTitleId' class='DataValidationEditElement DataValidationEditInput' maxlength={4} autocomplete=\"off\"/> </div> <div class='DataValidationRow' id='inputMessageDivID'> <label id='inputMessageLabelId' class='DataValidationEditElementLabel' for='textForInputMessageId'>{2}</label> <textarea id='textForInputMessageId' class='DataValidationEditElement DataValidationEditTextArea' maxlength={3} autocomplete=\"off\"></textarea> </div> </div>";
m.peh="<div class='DataValidationEditTabContent' id='alertDivID'> <div class='DataValidationNonBorderRow' id='showAlertCheckBoxDivID'> <label id='showAlertCheckBoxLabelId' class='DataValidationEditElementLabel' for='showAlertCheckBoxId'>{0}</label> <div class='DataValidationEditNoBorderElement' id='showAlertCheckBoxSubDivID'> <input type='checkbox' id='showAlertCheckBoxId' class='WACDialogCheckBox DataValidationEditCheckBoxNoText'></input> </div> </div> <div class='DataValidationRow' id='blockWarnRadioDivID'> <label id='blockWarnRadioLabelId' class='DataValidationEditElementLabel' for='blockWarnRadioSubDivID'>{1}</label> <div class='DataValidationEditRadio DataValidationEditNoBorderElement' id='blockWarnRadioSubDivID'> <input type='radio' id='blockingId' name='alertType' class='WACDialogRadio DataValidationEditRadio' alt='{2}' title='{2}'></input> <label id='blockingId' class='WACDialogLabel' for='blockingId' >{2}</label> <input type='radio' id='warningId' name='alertType' class='WACDialogRadio DataValidationEditRadio' alt='{3}' title='{3}'></input> <label id='blockingId' class='WACDialogLabel' for='warningId' >{3}</label> </div> </div> <div class='DataValidationRow' id='alertTitleDivID'> <label id='alertTitleLabelId' class='DataValidationEditElementLabel' for='textForAlertTitleId'>{4}</label> <input type='text' id='textForAlertTitleId' class='DataValidationEditElement DataValidationEditInput' maxlength={7} autocomplete=\"off\"/> </div> <div class='DataValidationRow' id='alertMessageDivID'> <label id='alertMessageLabelId' class='DataValidationEditElementLabel' for='textForAlertMessageId'>{5}</label> <textarea id='textForAlertMessageId' class='DataValidationEditElement DataValidationEditTextArea' maxlength={6} autocomplete=\"off\"></textarea> </div> </div>";
Object(u.a)(m,"DataValidationEditDialogHtml",null,[]);var wa=b(86),X=b(617),ja=b(13),va=b(202),ua=b(244),Xa=b(12),aa=b(15),ba=ua.a;Rk(y,ba);y.prototype.iAa=function(V){this.yT.selectedIndex=V.ruleType;this.sK.selectedIndex=V.tB;this.gec.checked=V.V4;this.Rva.checked=V.U4;this.Cya.value=V.yN;this.Dya.value=V.zN;this.rca(null)};y.prototype.dpb=function(V){V.U4=this.Rva.checked;V.V4=this.gec.checked;V.tB=this.sK.selectedIndex;V.ruleType=this.yT.selectedIndex;V.yN=this.Cya.value;V.zN=this.Dya.value};
y.prototype.dispose=function(){this.Tj();this.uk=this.tBd=this.uoc=this.JOa=this.V9a=this.gNa=this.e5a=this.gec=this.Dya=this.Cya=this.sK=this.yT=this.Rva=null;ba.prototype.dispose.call(this)};y.prototype.render=function(V){V.appendChild(this.domElement)};y.prototype.Aja=function(){return this.isVisible};y.prototype.sna=function(V){return this.isVisible=V};y.prototype.setFocus=function(){};y.prototype.$ub=function(V,Ia){return this.v_e(V,Ia,this.RAh)};y.prototype.sfd=function(V,Ia){return 0!==Ia&&
1!==Ia?"":this.v_e(V,Ia,this.Jkj)};y.prototype.Uja=function(){this.domElement.innerHTML=m.jeh;this.Rva=Xa.DOMElementExtensions.getElementById(this.domElement,"ignoreBlankCheckBoxId");this.yT=Xa.DOMElementExtensions.getElementById(this.domElement,"allowConditionSelectionId");this.sK=Xa.DOMElementExtensions.getElementById(this.domElement,"operatorSelectionId");this.Cya=Xa.DOMElementExtensions.getElementById(this.domElement,"operatorInputId1");this.Dya=Xa.DOMElementExtensions.getElementById(this.domElement,
"operatorInputId2");this.uoc=Xa.DOMElementExtensions.getElementById(this.domElement,"operatorInputLableId1");this.tBd=Xa.DOMElementExtensions.getElementById(this.domElement,"operatorInputLableId2");this.e5a=Xa.DOMElementExtensions.getElementById(this.domElement,"inCellDropdownDivId");this.gNa=Xa.DOMElementExtensions.getElementById(this.domElement,"listDescriptionDivId");this.V9a=Xa.DOMElementExtensions.getElementById(this.domElement,"operatorInputDivId1");this.JOa=Xa.DOMElementExtensions.getElementById(this.domElement,
"operatorInputDivId2");this.gec=Xa.DOMElementExtensions.getElementById(this.domElement,"inCellDropdownCheckboxId");this.Pi()};y.prototype.v_e=function(V,Ia,Ha){return Ha.length<V||Ha[V].length<Ia?(I.ULS.sendTraceTag(537163280,0,10,"DataValidationEditDialog.GetOperatorLabel: wrong parameters conditionOption={0} operatorOption={1}, cannot get label.",V,Ia),""):this.VQ.na(Ha[V][Ia])};y.prototype.Pi=function(){X.a.instance.ra(ja.a.Lb,this.yT,this.Umc);X.a.instance.ra(ja.a.Lb,this.sK,this.Umc);X.a.instance.ra(ja.a.change,
this.yT,this.rca);X.a.instance.ra(ja.a.change,this.sK,this.rca);X.a.instance.ra(ja.a.change,this.sK,this.uk);X.a.instance.ra(ja.a.change,this.yT,this.uk);X.a.instance.ra(ja.a.change,this.Cya,this.uk);X.a.instance.ra(ja.a.Lb,this.Cya,this.uk);X.a.instance.ra(ja.a.change,this.Dya,this.uk);X.a.instance.ra(ja.a.Lb,this.Dya,this.uk)};y.prototype.Tj=function(){X.a.instance.Ba(ja.a.Lb,this.yT,this.Umc);X.a.instance.Ba(ja.a.Lb,this.sK,this.Umc);X.a.instance.Ba(ja.a.change,this.yT,this.rca);X.a.instance.Ba(ja.a.change,
this.sK,this.rca);X.a.instance.Ba(ja.a.change,this.sK,this.uk);X.a.instance.Ba(ja.a.change,this.yT,this.uk);X.a.instance.Ba(ja.a.change,this.Cya,this.uk);X.a.instance.Ba(ja.a.Lb,this.Cya,this.uk);X.a.instance.Ba(ja.a.change,this.Dya,this.uk);X.a.instance.Ba(ja.a.Lb,this.Dya,this.uk)};y.bja=function(){var V;return V=new va.a,V.add("operatorInputId1"),V.add("operatorInputId2"),V};Mf.Object.defineProperties(y.prototype,{title:{configurable:!0,enumerable:!0,get:function(){return aa.a.instance.ga(1683)}},
n0g:{configurable:!0,enumerable:!0,get:function(){return this.yT.selectedIndex}}});Object(u.a)(y,"DataValidationEditConditionsControl",ua.a,[550,3,553]);var oa=b(62),ra=b(31),db=b(22),Ka=b(206),Ga=ka.a;Rk(v,Ga);v.prototype.DRd=function(){var V={};V=(V.RuleType=this.od.ruleType,V.RuleOperatorType=this.od.tB,V.OperatorInput1=this.od.yN,V.OperatorInput2=this.od.zN,V.IsIgnoreBlank=this.od.U4,V.IsInCellDropDown=this.od.V4,V.IsAlertBlocking=this.od.NZ,V.AlertTitle=this.od.xT,V.AlertMessage=this.od.wT,V.InputTitle=
this.od.UE,V.InputMessage=this.od.iV,V.IsShowErrorAlert=this.od.j5,V.IsShowInputMessage=this.od.k5,V);this.mc(2,aa.a.instance.ga(1649));var Ia={};V=(Ia[v.Vv]=this.nc,Ia.validateDialogValues=this.LUj,Ia.RangePickerController=N.g(this.$).hg.Gbc(),Ia.isModal=!1,Ia.bodyProps=V,Ia);this.initializeAndShow(aa.a.instance.ga(1648),this.r4c,V);I.ULS.sendTraceTag(537163278,0,50,"DataValidationEditDialog dialog opened.")};v.prototype.dispose=function(){this.disposed||(Ga.prototype.dispose.call(this),this.disposed=
!0)};v.prototype.bja=function(){return y.bja()};v.prototype.ILh=function(V,Ia){var Ha=this;return function(ob,ib,La){var zb=V.oa.xa.Pb();return r(Ha.$.oa.xa,Ha.selectedRanges,Ha.CQg(),Ha.n_a(ob,Ha.Syd(Ia)),K.a(ib),La,zb)}};v.prototype.Syd=function(V){var Ia=this;return function(Ha){I.ULS.sendTraceTag(537163277,0,50,"DataValidationEditDialog.OnDataValidationEditSuccessCallback");var ob;J.a(Ha)?(I.ULS.sendTraceTag(537163276,0,15,"DataValidationEditDialog.OnDataValidationEditSuccessCallback - request has expected errors: {0}.",
Ha?ra.a.Ec(Ha.Errors):null),Ha.Errors&&1===Ha.Errors.length&&((ob=Ia.Hcd(Ha.Errors[0].MessageId))?Ia.Uka("OkInvalidByServer",Ha.Errors[0].MessageIdName):(Ia.Uka("OkValid","None"),Ia.hide()),V(ob)),I.ULS.sendTraceTag(537163275,0,15,"DataValidationEditDialog.OnDataValidationEditSuccessCallback - Unexpected error, cannot parse: {0}",ra.a.Ec(Ha.Errors))):Ia.hide()}};v.prototype.CQg=function(){var V={};V.Command=this.command;V.RuleType=this.od.ruleType;V.ConditionType=this.od.tB;V.IsIgnoreBlank=this.od.U4;
V.IsInCellDropDown=this.od.V4;V.LowerBoundary=this.od.yN;V.UpperBoundary=this.od.zN;V.IsAlertBlocking=this.od.NZ;V.IsShowErrorAlert=this.od.j5;V.IsShowInputMessage=this.od.k5;V.AlertTitle=this.od.xT;V.AlertMessage=this.od.wT;V.InputTitle=this.od.UE;V.InputMessage=this.od.iV;V.ShouldIgnoreFormulaError=this.EMa;return V};v.prototype.Hcd=function(V){switch(V){case 1173235830:return aa.a.instance.ga(1698);case 43935303:return aa.a.instance.ga(1699);case -1323438439:return aa.a.instance.ga(1701);case 2112020473:return aa.a.instance.ga(1695);
case -219503282:return aa.a.instance.ga(1696);case 1689335445:return aa.a.instance.ga(1697);case 2146493810:return aa.a.instance.ga(1700);case -2104909922:return String.format(aa.a.instance.mb(105),this.Gtb,this.dMd);case -869372599:return String.format(aa.a.instance.mb(104),this.Gtb);case -1181828368:return aa.a.instance.ga(1703);case -758480861:return aa.a.instance.ga(1704);case -13729088:return aa.a.instance.ga(1705);case -846654055:return aa.a.instance.ga(1706);case 751854001:return aa.a.instance.ga(1707);
case -453846397:return aa.a.instance.ga(1708);case 1102013489:return aa.a.instance.ga(1709);case 835813260:return aa.a.instance.ga(1710);case 1577787509:return aa.a.instance.ga(1711);case 2083564019:return aa.a.instance.ga(1702);default:I.ULS.sendTraceTag(537163274,0,15,"DataValidationEditDialog.GetDataValidationServerErrorString - unexpected error: {0}.",V.toString())}return null};v.prototype.Ela=function(){this.Uka("Cancel","None")};v.prototype.uW=function(V){I.ULS.sendTraceTag(537163273,0,50,"DataValidationEditDialog {0} was clicked.",
1===V?"Ok":"Cancel");var Ia={};V=(Ia.ButtonType=v.$ha(V),Ia.DialogName=this.nc,Ia.Location="dialog",Ia.NumberOfSelectedRanges=N.g(this.$).ha.sa.qK,Ia);M.b(this.$).yd(F.a.e6b,V)};v.prototype.Uka=function(V,Ia){var Ha={};v.$rb(this.od,Ha);Ha.o=V;Ha.p=Ia;Ha.n=this.gka;this.Mh&&(this.Mh.stop(),Ha.q=this.Mh.id);C.b().Ce(49,Ha,!0)};v.prototype.xac=function(V){this.od.ruleType=V.RuleType;this.od.tB=V.RuleOperatorType;this.od.yN=V.OperatorInput1;this.od.zN=V.OperatorInput2;this.od.NZ=V.IsAlertBlocking;this.od.j5=
V.IsShowErrorAlert;this.od.xT=V.AlertTitle;this.od.wT=V.AlertMessage;this.od.k5=V.IsShowInputMessage;this.od.UE=V.InputTitle;this.od.iV=V.InputMessage;this.od.U4=V.IsIgnoreBlank;this.od.V4=V.IsInCellDropDown;this.Gtb=V.firstOperatorLabel;this.dMd=V.secondOperatorLabel};v.prototype.FOb=function(V,Ia,Ha){var ob;var ib=ob=null;if(!V)return Ha?(ob=String.format(aa.a.instance.mb(105),this.Gtb,this.dMd),ib="DataValidationEditNoMinMaxError"):(ob=String.format(aa.a.instance.mb(104),this.Gtb),ib="DataValidationEditNoValueError"),
{returnValue:!1,errorString:ob,lq:ib};if(V.length>m.Z7f)return ob=aa.a.instance.ga(1702),{returnValue:!1,errorString:ob,lq:ib};if(Ka.d(V))return{returnValue:!0,errorString:ob,lq:ib};if(1===Ia||2===Ia||6===Ia){if(!db.a.b5(V))return ob=aa.a.instance.ga(1695),{returnValue:!1,errorString:ob,lq:ib};if(1===Ia&&!db.a.isInteger(V))return ob=aa.a.instance.ga(1696),{returnValue:!1,errorString:ob,lq:ib};if(6===Ia){if(!db.a.isInteger(V))return ob=aa.a.instance.ga(1696),{returnValue:!1,errorString:ob,lq:ib};if(0>
parseInt(V,10))return ob=aa.a.instance.ga(1697),{returnValue:!1,errorString:ob,lq:ib}}}return{returnValue:!0,errorString:ob,lq:ib}};v.prototype.LYd=function(){var V=this,Ia;var Ha=Ia=null;var ob=this.od.yN,ib=this.od.zN,La=fa[this.od.ruleType],zb=R[this.od.tB];if(0===La)return{returnValue:!0,errorString:Ia,lq:Ha};var Fb=(0===zb||1===zb)&&3!==La&&7!==La;return!function(){var Yb=V.FOb(ob,La,Fb);Ia=Yb.errorString;Ha=Yb.lq;return Yb}().returnValue||Fb&&!function(){var Yb=V.FOb(ib,La,Fb);Ia=Yb.errorString;
Ha=Yb.lq;return Yb}().returnValue?{returnValue:!1,errorString:Ia,lq:Ha}:Fb&&(1===La||2===La||6===La)&&!Ka.d(ob)&&!Ka.d(ib)&&parseFloat(ob)>parseFloat(ib)?(Ia=aa.a.instance.ga(1700),Ha="DataValidationEditMaximumLessMinimumError",{returnValue:!1,errorString:Ia,lq:Ha}):{returnValue:!0,errorString:Ia,lq:Ha}};v.$ha=function(V){switch(V){case 0:return"Cancel";case 1:return"Ok";case 2:return"ClearAll";default:return I.ULS.shipAssertTag(537163272,0,!1,"DataValidationEditDialog.DialogButtonToString: Unknown DialogButton"),
"Unknown"}};v.$rb=function(V,Ia){Ia.a=A(V.ruleType);Ia.b=z(V.tB);Ia.c=!!V.yN;Ia.d=!!V.zN;Ia.e=V.U4;Ia.f=V.V4;Ia.g=V.k5;Ia.h=!!V.UE;Ia.i=!!V.iV;Ia.j=V.j5;Ia.k=V.NZ;Ia.l=!!V.xT;Ia.m=!!V.wT};Mf.Object.defineProperties(v.prototype,{od:{configurable:!0,enumerable:!0,get:function(){return this.PRb}},nc:{configurable:!0,enumerable:!0,get:function(){return"DataValidationEditDialog"}},G1b:{configurable:!0,enumerable:!0,get:function(){return 3===this.od.ruleType}}});Object(u.a)(v,"DataValidationEditDialog",
ka.a,[]);var xa=b(89);ka=b(324);f.Yah="DataValidationDialogPanel";f.Xah="DataValidationButtonPanel";f.Wah="DataValidationButtonClearAll";Object(u.a)(f,"CssClassNames",null,[]);var da=ua.a;Rk(n,da);n.prototype.render=function(V){V.appendChild(this.domElement)};n.prototype.Aja=function(){return this.isVisible};n.prototype.sna=function(V){return this.isVisible=V};n.prototype.setFocus=function(){};n.prototype.dispose=function(){this.Tj();this.uk=this.hba=this.gba=this.R9e=this.fba=null;da.prototype.dispose.call(this)};
n.prototype.Uja=function(){this.domElement.innerHTML=m.qeh;this.fba=Xa.DOMElementExtensions.getElementById(this.domElement,"showInputCheckBoxId");this.R9e=Xa.DOMElementExtensions.getElementById(this.domElement,"inputMessageDivID");this.hba=Xa.DOMElementExtensions.getElementById(this.domElement,"textForInputTitleId");this.gba=Xa.DOMElementExtensions.getElementById(this.domElement,"textForInputMessageId");this.fba.checked=!0;this.Pi();this.Wmc(null)};n.prototype.iAa=function(V){this.hba.value=void 0===
V.UE||null===V.UE?"":V.UE;this.gba.value=void 0===V.iV||null===V.iV?"":V.iV;this.fba.checked=V.k5;this.Wmc(null)};n.prototype.dpb=function(V){V.UE=this.hba.value;V.iV=this.gba.value;V.k5=this.fba.checked};n.prototype.Pi=function(){X.a.instance.ra(ja.a.change,this.fba,this.Wmc);X.a.instance.ra(ja.a.change,this.fba,this.uk);X.a.instance.ra(ja.a.change,this.hba,this.uk);X.a.instance.ra(ja.a.Lb,this.hba,this.uk);X.a.instance.ra(ja.a.change,this.gba,this.uk);X.a.instance.ra(ja.a.Lb,this.gba,this.uk)};
n.prototype.Tj=function(){X.a.instance.Ba(ja.a.change,this.fba,this.Wmc);X.a.instance.Ba(ja.a.change,this.fba,this.uk);X.a.instance.Ba(ja.a.change,this.hba,this.uk);X.a.instance.Ba(ja.a.Lb,this.hba,this.uk);X.a.instance.Ba(ja.a.change,this.gba,this.uk);X.a.instance.Ba(ja.a.Lb,this.gba,this.uk)};Mf.Object.defineProperties(n.prototype,{title:{configurable:!0,enumerable:!0,get:function(){return aa.a.instance.ga(1685)}}});Object(u.a)(n,"DataValidationEditInputControl",ua.a,[550,3,552]);var qa=ua.a;Rk(l,
qa);l.prototype.render=function(V){V.appendChild(this.domElement)};l.prototype.Aja=function(){return this.isVisible};l.prototype.sna=function(V){return this.isVisible=V};l.prototype.setFocus=function(){};l.prototype.dispose=function(){this.Tj();this.uk=this.K9=this.J9=this.MTa=this.bha=this.I9=null;qa.prototype.dispose.call(this)};l.prototype.Uja=function(){this.domElement.innerHTML=m.ueh;this.I9=Xa.DOMElementExtensions.getElementById(this.domElement,"showAlertCheckBoxId");this.bha=Xa.DOMElementExtensions.getElementById(this.domElement,
"blockingId");this.MTa=Xa.DOMElementExtensions.getElementById(this.domElement,"warningId");this.K9=Xa.DOMElementExtensions.getElementById(this.domElement,"textForAlertTitleId");this.J9=Xa.DOMElementExtensions.getElementById(this.domElement,"textForAlertMessageId");this.I9.checked=!0;this.bha.checked=!0;this.Pi();this.Vmc(null)};l.prototype.iAa=function(V){this.bha.checked=V.NZ;this.MTa.checked=!V.NZ;this.K9.value=void 0===V.xT||null===V.xT?"":V.xT;this.J9.value=void 0===V.wT||null===V.wT?"":V.wT;
this.I9.checked=V.j5;this.Vmc(null)};l.prototype.dpb=function(V){V.xT=this.K9.value;V.wT=this.J9.value;V.NZ=this.bha.checked;V.j5=this.I9.checked};l.prototype.Pi=function(){X.a.instance.ra(ja.a.change,this.I9,this.Vmc);X.a.instance.ra(ja.a.change,this.I9,this.uk);X.a.instance.ra(ja.a.change,this.bha,this.uk);X.a.instance.ra(ja.a.change,this.MTa,this.uk);X.a.instance.ra(ja.a.change,this.K9,this.uk);X.a.instance.ra(ja.a.Lb,this.K9,this.uk);X.a.instance.ra(ja.a.change,this.J9,this.uk);X.a.instance.ra(ja.a.Lb,
this.J9,this.uk)};l.prototype.Tj=function(){X.a.instance.Ba(ja.a.change,this.I9,this.Vmc);X.a.instance.Ba(ja.a.change,this.I9,this.uk);X.a.instance.ra(ja.a.change,this.bha,this.uk);X.a.instance.ra(ja.a.change,this.MTa,this.uk);X.a.instance.Ba(ja.a.change,this.K9,this.uk);X.a.instance.Ba(ja.a.Lb,this.K9,this.uk);X.a.instance.Ba(ja.a.change,this.J9,this.uk);X.a.instance.Ba(ja.a.Lb,this.J9,this.uk)};Mf.Object.defineProperties(l.prototype,{title:{configurable:!0,enumerable:!0,get:function(){return aa.a.instance.ga(1684)}}});
Object(u.a)(l,"DataValidationEditMessagesControl",ua.a,[550,3,551]);Object(u.a)(k,"MacroRecorderRangeDataValidationChangedPayload",null,[438]);var na=b(1440),ia=b(70),ta=ka.a;Rk(e,ta);e.prototype.DRd=function(){var V={};V=(V.key=this.od,V);this.initializeAndShow(aa.a.instance.ga(1648),this.r4c,V);I.ULS.sendTraceTag(537163271,0,50,"DataValidationEditDialogDeprecated dialog opened.")};e.prototype.dispose=function(){this.disposed||(this.Gec=this.Mkc=this.a3=null,xa.a.Ia(this.UCb),this.UCb=null,M.b(this.$)&&
M.b(this.$).$Sd("DataValidationDialogCorellation"),ta.prototype.dispose.call(this),this.disposed=!0)};e.prototype.hv=function(V){ta.prototype.hv.call(this,V);this.mc(2,aa.a.instance.ga(1649));V=this.UU(2);var Ia=this.UU(1),Ha=this.UU(0),ob=Ia.parentNode;ob.appendChild(V);ob.appendChild(Ia);ob.appendChild(Ha);V.parentNode.classList.add(f.Xah);V.classList.add(f.Wah);V=document.getElementById("dataValidationTabsId");Ia=new y(this.$,document.createElement("div"),this.rca);Ha=new n(document.createElement("div"),
this.rca);ob=new l(document.createElement("div"),this.rca);this.Bai(Ia,Ha,ob);var ib;this.UCb=new na.a(V,(ib=new va.a,ib.add(Ia),ib.add(Ha),ib.add(ob),ib));this.UCb.bQf();this.JU=document.getElementById("validationErrorMessageId");this.iAa();M.b(this.$)&&M.b(this.$).KSd("DataValidationDialogCorellation")};e.prototype.fO=function(){ta.prototype.fO.call(this);document.getElementById(this.$h("WACDialogPanel")).classList.add(f.Yah)};e.prototype.bja=function(){return y.bja()};e.prototype.Ucd=function(){return"validationErrorMessageId"};
e.prototype.Bai=function(V,Ia,Ha){this.a3=V;this.Gec=Ia;this.Mkc=Ha};e.prototype.Olj=function(){function V(){return new k(Ia.selectedRanges,Ha)}var Ia=this,Ha={};Ha.IsClearAll=this.gka;Ha.Command=this.command;Ha.RuleType=this.od.ruleType;Ha.ConditionType=this.od.tB;Ha.IsIgnoreBlank=this.od.U4;Ha.IsInCellDropDown=this.od.V4;Ha.LowerBoundary=this.od.yN;Ha.UpperBoundary=this.od.zN;Ha.IsAlertBlocking=this.od.NZ;Ha.IsShowErrorAlert=this.od.j5;Ha.IsShowInputMessage=this.od.k5;Ha.AlertTitle=this.od.xT;Ha.AlertMessage=
this.od.wT;Ha.InputTitle=this.od.UE;Ha.InputMessage=this.od.iV;Ha.ShouldIgnoreFormulaError=this.EMa;var ob=this.$.oa.xa.Pb();T.a(this.$.userOperationManager,function(ib,La,zb){return r(Ia.$.oa.xa,Ia.selectedRanges,Ha,K.b(ib,Ia.Syd),K.a(La),zb,ob)},function(ib){return new O.a(121,0,ib,void 0,V)},null)};e.prototype.Jxj=function(V){return 1577787509===V};e.prototype.$sj=function(V){this.JU.innerText=V;this.kI(this.UU(0));this.EMa=!0};e.prototype.Vxe=function(){this.EMa=!1;this.JU.innerText=""};e.prototype.Hcd=
function(V){switch(V){case 1173235830:return aa.a.instance.ga(1698);case 43935303:return aa.a.instance.ga(1699);case -1323438439:return aa.a.instance.ga(1701);case 2112020473:return aa.a.instance.ga(1695);case -219503282:return aa.a.instance.ga(1696);case 1689335445:return aa.a.instance.ga(1697);case 2146493810:return aa.a.instance.ga(1700);case -2104909922:return String.format(aa.a.instance.mb(105),this.a3.$ub(this.od.ruleType,this.od.tB),this.a3.sfd(this.od.ruleType,this.od.tB));case -869372599:return String.format(aa.a.instance.mb(104),
this.a3.$ub(this.od.ruleType,this.od.tB));case -1181828368:return aa.a.instance.ga(1703);case -758480861:return aa.a.instance.ga(1704);case -13729088:return aa.a.instance.ga(1705);case -846654055:return aa.a.instance.ga(1706);case 751854001:return aa.a.instance.ga(1707);case -453846397:return aa.a.instance.ga(1708);case 1102013489:return aa.a.instance.ga(1709);case 835813260:return aa.a.instance.ga(1710);case 1577787509:return aa.a.instance.ga(1711);case 2083564019:return aa.a.instance.ga(1702);default:I.ULS.sendTraceTag(537163265,
0,15,"DataValidationEditDialogDeprecated.GetDataValidationServerErrorString - unexpected error: {0}.",V.toString())}return null};e.prototype.C9a=function(){I.ULS.sendTraceTag(537163264,0,50,"DataValidationEditDialogDeprecated 'Ok' was clicked.");this.xac();var V=this.LYd();var Ia=V.errorString;var Ha=V.lq;if(!V.returnValue)return this.nr(Ia),this.Uka("OkInvalidByClient",Ha),!1;this.Olj();return!0};e.prototype.Ela=function(){this.xac();this.Uka("Cancel","None");this.hide()};e.prototype.gya=function(){I.ULS.sendTraceTag(537163235,
0,50,"DataValidationEditDialogDeprecated 'ClearAll' was clicked.");this.EMa?this.Vxe():this.z_c();this.ffj();this.gka=!0};e.prototype.uW=function(V){var Ia={};V=(Ia.ButtonType=e.$ha(V),Ia.DialogName=this.nc,Ia.Location="dialog",Ia.NumberOfSelectedRanges=N.g(this.$).ha.sa.qK,Ia);M.b(this.$).yd(F.a.e6b,V)};e.prototype.ffj=function(){this.PRb=new B;this.iAa()};e.prototype.iAa=function(){this.Mkc.iAa(this.od);this.Gec.iAa(this.od);this.a3.iAa(this.od)};e.prototype.xac=function(){this.a3.dpb(this.od);
this.Mkc.dpb(this.od);this.Gec.dpb(this.od)};e.prototype.Uka=function(V,Ia){var Ha={};e.$rb(this.od,Ha);Ha.o=V;Ha.p=Ia;Ha.n=this.gka;this.Mh&&(this.Mh.stop(),Ha.q=this.Mh.id);C.b().Ce(49,Ha,!0)};e.prototype.FOb=function(V,Ia){var Ha;var ob=Ha=null;if(!V)return Ia?(Ha=String.format(aa.a.instance.mb(105),this.a3.$ub(this.od.ruleType,this.od.tB),this.a3.sfd(this.od.ruleType,this.od.tB)),ob="DataValidationEditNoMinMaxError"):(Ha=String.format(aa.a.instance.mb(104),this.a3.$ub(this.od.ruleType,this.od.tB)),
ob="DataValidationEditNoValueError"),{returnValue:!1,errorString:Ha,lq:ob};if(V.length>m.Z7f)return Ha=aa.a.instance.ga(1702),{returnValue:!1,errorString:Ha,lq:ob};if(Ka.d(V))return{returnValue:!0,errorString:Ha,lq:ob};if(1===this.od.ruleType||2===this.od.ruleType||6===this.od.ruleType){if(!db.a.b5(V))return Ha=aa.a.instance.ga(1695),{returnValue:!1,errorString:Ha,lq:ob};if(1===this.od.ruleType&&!db.a.isInteger(V))return Ha=aa.a.instance.ga(1696),{returnValue:!1,errorString:Ha,lq:ob};if(6===this.od.ruleType){if(!db.a.isInteger(V))return Ha=
aa.a.instance.ga(1696),{returnValue:!1,errorString:Ha,lq:ob};if(0>parseInt(V,10))return Ha=aa.a.instance.ga(1697),{returnValue:!1,errorString:Ha,lq:ob}}}return{returnValue:!0,errorString:Ha,lq:ob}};e.prototype.LYd=function(){var V=this,Ia;var Ha=Ia=null;if(this.gka||0===this.od.ruleType)return{returnValue:!0,errorString:Ia,lq:Ha};var ob=(0===this.od.tB||1===this.od.tB)&&3!==this.od.ruleType&&7!==this.od.ruleType;return!function(){var ib=V.FOb(V.od.yN,ob);Ia=ib.errorString;Ha=ib.lq;return ib}().returnValue||
ob&&!function(){var ib=V.FOb(V.od.zN,ob);Ia=ib.errorString;Ha=ib.lq;return ib}().returnValue?{returnValue:!1,errorString:Ia,lq:Ha}:ob&&(1===this.od.ruleType||2===this.od.ruleType||6===this.od.ruleType)&&!Ka.d(this.od.yN)&&!Ka.d(this.od.zN)&&parseFloat(this.od.yN)>parseFloat(this.od.zN)?(Ia=aa.a.instance.ga(1700),Ha="DataValidationEditMaximumLessMinimumError",{returnValue:!1,errorString:Ia,lq:Ha}):{returnValue:!0,errorString:Ia,lq:Ha}};e.$ha=function(V){switch(V){case 0:return"Cancel";case 1:return"Ok";
case 2:return"ClearAll";default:return I.ULS.shipAssertTag(537163234,0,!1,"DataValidationEditDialogDeprecated.DialogButtonToString: Unknown DialogButton"),"Unknown"}};e.$rb=function(V,Ia){Ia.a=A(V.ruleType);Ia.b=z(V.tB);Ia.c=!!V.yN;Ia.d=!!V.zN;Ia.e=V.U4;Ia.f=V.V4;Ia.g=V.k5;Ia.h=!!V.UE;Ia.i=!!V.iV;Ia.j=V.j5;Ia.k=V.NZ;Ia.l=!!V.xT;Ia.m=!!V.wT};Mf.Object.defineProperties(e.prototype,{od:{configurable:!0,enumerable:!0,get:function(){return this.PRb}},nc:{configurable:!0,enumerable:!0,get:function(){return"DataValidationEditDialog"}},
onCommitDialogHandler:{configurable:!0,enumerable:!0,get:function(){var V=this;return function(){V.uW(1);V.C9a()}},set:function(V){Object(ia.b)(e.prototype,this,"onCommitDialogHandler",V)}},canBePreempted:{configurable:!0,enumerable:!0,get:function(){return!1}},G1b:{configurable:!0,enumerable:!0,get:function(){return 3===this.a3.n0g}}});Object(u.a)(e,"DataValidationEditDialogDeprecated",ka.a,[]);var za=b(1);d.prototype.rHa=function(V,Ia,Ha,ob){za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataValidationReactDialog",
!1)?(new v(V,Ia,Ha,ob)).DRd():(new e(V,Ia,Ha,ob)).DRd()};d.prototype.X3g=function(V,Ia){var Ha=new P.StandardDialog;Ha.Rb=3;Ha.zAa(V.ob.$ia,aa.a.instance.ga(1693),Ia)};d.prototype.Z3g=function(V,Ia){var Ha=new P.StandardDialog;Ha.Rb=1;Ha.XW(V.ob.$ia,aa.a.instance.ga(1694),Ia)};Object(u.a)(d,"DataValidationEditDialogFactory",null,[504]);var sa=D.a;Rk(c,sa);c.prototype.Ad=function(){this.jd([new w(this.$,new d)])};c.ka=function(V){D.a.Qd(245,new c(V))};Object(u.a)(c,"DataValidationEditCommandHandlerFactory",
D.a,[]);b.d(E,"a",function(){return a})},1356:function(u,E,b){function a(){J.a.Fa(c.ka)}function c(ha){var Z=ma.call(this)||this;Z.$=ha;Z.Eb();return Z}function d(ha){var Z=this;this.kx=this.calcManager=this.fz=this.URa=null;this.WJi=function(Na,eb){if(Na&&!ob.a(Na)&&eb){var cb=!!Na&&!!Na.RequestTelemetryData;Fb.g(Z.$).si.dla(eb.toString(),Na.StateId,cb?Na.RequestTelemetryData.EcsOperationDuration:0,cb?Na.RequestTelemetryData.EcsRequestDuration:0,cb?Na.RequestTelemetryData.WfeRequestDuration:0)}};
this.$=ha;this.$.da.Za(268,function(Na){Z.fz=Na});this.xCh=new l(Fb.g(this.$).Ea,this.$);this.qha=new f(this.$,Fb.g(this.$),this);this.$.da.Za(266,function(Na){Z.calcManager=Na});this.tb=ba.EwaSettings.tb();this.Am=ba.EwaSettings.Am();this.kAb=ba.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseNumberFormatterInWebWorker",!1);this.Lqd=ba.EwaSettings.isChangeGateEnabled("OfficeVSO:6169583_checkTextAlignmentColorAndApplyNumberFormat2");this.wMa=ba.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextOrientationSlice3",
!1);this.voi=ba.EwaSettings.isChangeGateEnabled("OfficeVSO:6280164_fixRTEregressionInMovingNFToWebWorker")}function e(ha,Z){this.success=ha;this.$y=Z}function k(){this.yeg=this.mWj=!1;this.source=0;this.Zva=this.jhc=!1}function l(ha,Z){this.kx=null;this.Ea=ha;this.j2a=Z}function n(ha,Z,Na){this.success=ha;this.Klc=void 0===Z?null:Z;this.reason=void 0===Na?"":Na}function f(ha,Z,Na){var eb=this;this.Rca=[];this.calcManager=this.Cyc=this.lastSetCellInstantaneousOperation=null;this.AIf=function(cb){var Ua;
if(cb&&cb.rangeDeltas){for(var pa=eb.Rca.length,Qa=0;Qa<cb.rangeDeltas.length;Qa++)(null===(Ua=cb.rangeDeltas[Qa])||void 0===Ua?0:Ua.data)&&void 0!==cb.rangeDeltas[Qa].data.value&&null!==cb.rangeDeltas[Qa].data.value&&void 0!==cb.rangeDeltas[Qa].range&&null!==cb.rangeDeltas[Qa].range&&eb.Rca.push(new v(cb.rangeDeltas[Qa],cb.stateId,cb.isFinished,cb.priorityGroup));N.ULS.sendTraceTag(574993422,0,50,"CalcResultProcessor.ProcessResults stateId={0}, priorityGroup={1}, recalcFinished={2}, cellsFromCalc={3}, initialCellsToRender={4}, recalcedCells={5}, lastSetCellInstantaneousOperation={6}",
cb.stateId,cb.priorityGroup,cb.isFinished,cb.rangeDeltas.length,pa,eb.Rca.length,eb.lastSetCellInstantaneousOperation);!pa&&eb.Rca.length&&eb.gAf(!1,0)}};this.$=ha;this.grid=Z;this.Fg=Na;this.Nca=f.GFe;this.$.da.Za(268,function(cb){eb.Cyc=cb});this.$.da.Za(266,function(cb){eb.calcManager=cb});this.kAb=ba.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseNumberFormatterInWebWorker",!1);this.Lqd=ba.EwaSettings.isChangeGateEnabled("OfficeVSO:6169583_checkTextAlignmentColorAndApplyNumberFormat2");
this.uoi=ba.EwaSettings.isChangeGateEnabled("OfficeVSO:6280164_fixRTEregressionInMovingNFToWebWorker")}function v(ha,Z,Na,eb){this.rangeDelta=ha;this.stateId=Z;this.isFinished=Na;this.priorityGroup=eb}function r(ha,Z,Na,eb,cb,Ua,pa,Qa,Db,Kb,Ab,ub,Mb,Aa,Za,Zb,jb,Vb,Ic,Rb,kc,xb,Va,tb,fb){this.numberOfDependentRecalcedCellsInBatch=this.numberOfEditedRecalcedCellsInBatch=this.newProcessingTimeLimit=this.originalProcessingTimeLimit=this.totalExecutionTime=this.numberOfSkippedCellsDueToMissingLocaleInfo=
this.numberOfUnsupportedRichCellTypes=this.numberOfUnsupportedBlankCellTypes=this.numberOfUnsupportedErrorCellTypes=this.numberOfCellsWithNoFormattedCell=this.numberOfCellsSkippedDueToTimeout=this.numberOfCellsUpdatedAlreadyByServer=this.numberOfUpdatedCells=this.numberOfNonUpdatedCells=this.totalNumberOfCellsInBatch=0;this.isNewTask=!1;this.lastSetCellInstantaneousOperation=null;this.taskId=0;this.numberOfHashFormattedValues=this.numberOfMeasureTextWidthCalls=this.newNumberFormatterFinalizeFailures=
this.totalNumberFormatterTime=this.numberOfRecalcedCellsWithoutFormattedValue=this.numberOfRecalcedCellsWithFormattedValue=this.isNewNumberFormatter=null;this.totalNumberOfCellsInBatch=void 0===ha?0:ha;this.numberOfNonUpdatedCells=void 0===Z?0:Z;this.numberOfUpdatedCells=void 0===Na?0:Na;this.numberOfCellsUpdatedAlreadyByServer=void 0===eb?0:eb;this.numberOfCellsSkippedDueToTimeout=void 0===cb?0:cb;this.numberOfCellsWithNoFormattedCell=void 0===Ua?0:Ua;this.numberOfUnsupportedErrorCellTypes=void 0===
pa?0:pa;this.numberOfUnsupportedBlankCellTypes=void 0===Qa?0:Qa;this.numberOfUnsupportedRichCellTypes=void 0===Db?0:Db;this.numberOfSkippedCellsDueToMissingLocaleInfo=void 0===Kb?0:Kb;this.totalExecutionTime=void 0===Ab?0:Ab;this.originalProcessingTimeLimit=void 0===ub?0:ub;this.newProcessingTimeLimit=void 0===Mb?0:Mb;this.numberOfEditedRecalcedCellsInBatch=void 0===Aa?0:Aa;this.numberOfDependentRecalcedCellsInBatch=void 0===Za?0:Za;this.isNewTask=void 0===Zb?!1:Zb;this.lastSetCellInstantaneousOperation=
void 0===jb?"":jb;this.taskId=void 0===Vb?0:Vb;this.isNewNumberFormatter=void 0===Ic?null:Ic;this.numberOfRecalcedCellsWithFormattedValue=void 0===Rb?null:Rb;this.numberOfRecalcedCellsWithoutFormattedValue=void 0===kc?null:kc;this.totalNumberFormatterTime=void 0===xb?null:xb;this.newNumberFormatterFinalizeFailures=void 0===Va?null:Va;this.numberOfMeasureTextWidthCalls=void 0===tb?null:tb;this.numberOfHashFormattedValues=void 0===fb?null:fb}function y(){}function m(ha,Z,Na,eb,cb){this.aM=void 0===
ha?0:ha;this.cellValue=void 0===Z?"":Z;this.ifmt=void 0===Na?0:Na;this.priorityGroup=void 0===eb?"":eb;this.$y=void 0===cb?"":cb}function w(ha){ha=B(ha);if(0===ha)return 1;if(1===ha)return 2;N.ULS.sendTraceTag(537162182,0,10,"CalcInterfaceAdapter.GetInstantaneousUpdatedCellType: unknown updated cell type!");return 0}function B(ha){if(ha.priorityGroup===G.editCell)return 0;if(ha.priorityGroup===G.dependentCell)return 1;N.ULS.sendTraceTag(537162183,0,10,"CalcInterfaceAdapter.GetRecalcPriorityGroup: unknown priority group!");
return 2}function A(ha,Z){var Na=B(Z),eb=!(void 0===Z.rangeDelta.data.format||null===Z.rangeDelta.data.format);N.ULS.shipAssertTag(537162187,0,0===Na||!eb,"CalcInterfaceAdapter.GetRecalcInferredFormat: Format inference expected for Edited cell only {0}",Z.priorityGroup);ha=Math.max(ha.cell.Yk,0);eb&&(eb=excelOnlineCalc.calc.getCellFormatKind(Z.rangeDelta.data.format.format),"number"===eb?ha=Z.rangeDelta.data.format.format:"string"===eb?N.ULS.sendTraceTag(537162186,0,50,"CalcInterfaceAdapter.GetRecalcInferredFormat: format kind string"):
"Unavailable"===eb?N.ULS.sendTraceTag(537162185,0,50,"CalcInterfaceAdapter.GetRecalcInferredFormat: format kind unavailable"):N.ULS.shipAssertTag(537162184,0,!1,"CalcInterfaceAdapter.GetRecalcInferredFormat: unknown format kind!"));return ha}function z(ha){var Z=ha.value;switch(ha.type){case 2:return void 0===Z||null===Z?"":Z;case 1:return ha=parseFloat(Z),isNaN(ha)?null:ha;case 3:return ha=parseFloat(Z),isNaN(ha)?null:1===ha;case 4:return ha=parseFloat(Z),isNaN(ha)?null:excelOnlineCalc.calc.errorValue(ha);
default:return excelOnlineCalc.calc.blankValue}}function x(ha){ha=excelOnlineCalc.calc.getCellValueKind(ha.rangeDelta.data.value);var Z=0;switch(ha){case "number":Z=1;break;case "string":Z=2;break;case "boolean":Z=3;break;case "Error":Z=4;break;case "Blank":Z=0;break;default:N.ULS.shipAssertTag(537162191,0,!1,"CalcInterfaceAdapter.GetCellValueType: Unexpected unsupported type {0}",ha)}return Z}function D(ha,Z){ha=excelOnlineCalc.calc.getCellValueKind(ha.rangeDelta.data.value);switch(ha){case "number":case "string":case "boolean":return!0;
case "Blank":if(ba.EwaSettings.isChangeGateEnabled("OfficeVSO:5477761_Calc_BlankCellValueTypeSupported"))return!0;Z.numberOfUnsupportedBlankCellTypes++;return!1;case "Error":if(ba.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CalcErrorValueTypeSupported",!1))return!0;Z.numberOfUnsupportedErrorCellTypes++;return!1;case "Rich":return Z.numberOfUnsupportedRichCellTypes++,!1;default:return N.ULS.shipAssertTag(537162192,0,!1,"CalcInterfaceAdapter.IsCellValueTypeSupported: Unexpected unsupported type {0}",
ha),!1}}function I(ha){if(ha=ha.color){if("String"===Object.getType(ha).getName())return Ga.a.Oo(ha);if("Number"===Object.getType(ha).getName())return null}else return null;N.ULS.sendTraceTag(537162193,0,10,"CalcInterfaceAdapter.GetFontColorFromFormattedValue: unknown color type!");return null}function F(ha){switch(ha.alignment){case "Center":return 2;case "Left":return 1;case "Right":return 3;default:return N.ULS.sendTraceTag(537162194,0,10,"CalcInterfaceAdapter.GetHorizontalAlignmentFromFormattedValue: unknown horizontal alignment!"),
0}}function G(){}function T(ha,Z,Na,eb,cb,Ua,pa,Qa,Db,Kb,Ab,ub,Mb){ub=void 0===ub?null:ub;Mb=void 0===Mb?null:Mb;Qa=ra.call(this,11,0,Qa,Ab)||this;Qa.wCh=ha;Qa.Had=Z;Qa.format=eb;Qa.activeCell=Na;Qa.sqe=cb;Qa.QFf=Ua;Qa.LFf=pa;Qa.YEa=Db;Qa.clientCorrelationId=Kb;Qa.Clb=ub;Qa.Whb=Mb;return Qa}function O(){}function U(ha,Z,Na,eb,cb,Ua){if(0===eb)return Object(za.a)(ab.UnsupportedZeroResize);if(0>eb||0===Na.length)return Object(za.a)(ab.InvalidInput);if(ha.H4h())return Object(za.a)(ab.UnsupportedSkeletonInView);
var pa=ha.Oe;if(!pa)return Object(za.a)(ab.NullSPD);var Qa=pa.KYe(Na);if(Qa&&0<Qa.length)return Object(za.a)(Qa.length.toString()+" "+ab.UnsupportedHiddenInRange);a:{Qa=bk(Na);for(var Db=Qa.next();!Db.done;Db=Qa.next())Db=Db.value,cb?Db.right=xa.a.Bh:Db.bottom=xa.a.sh;Qa=ha.K$("EditGridAction.IsMergeCellAcrossBlocksExistInRanges",Na);try{for(Qa.$$rst();Qa.$$mn();)if(Qa.yn.OCj){var Kb=!0;break a}}finally{Qa&&Qa.dispose()}Kb=!1}if(Kb)return Object(za.a)(ab.UnsupportedMergeCell);if(ba.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextWidthClientPhase2",
!1)&&!cb&&"undefined"!==typeof gridRenderer)for(Kb=bk(Na),Qa=Kb.next();!Qa.done;Qa=Kb.next())gridRenderer.CanvasRendererGlobals.resetColWidthCacheByCol(Qa.value.left);ha=ha.Ea;Kb=Cb.a.create().toString();pa.Ncg(Na,eb,cb);Ua=ha.GPj(cb,Ua);Z.o6i(Na,cb);ha.y2i(Ua,Kb,cb?"row":"column");return Object(za.d)(eb)}var J=b(10);u=b(0);var H=b(232),K=b(7),N=b(14),M=b(89),C=b(276),Q=b(202),P=b(440),ka=b(85),R=b(985),fa=b(189),ca=b(281),ea=b(24),wa=b(1083),X=b(45);O.cEh="GalleryGeneral";O.eEh="GalleryNumber";O.aEh=
"GalleryCurrency";O.ZDh="GalleryAccounting";O.hEh="GalleryShortDate";O.dEh="GalleryLongDate";O.jEh="GalleryTime";O.fEh="GalleryPercentage";O.bEh="GalleryFraction";O.gEh="GalleryScientific";O.iEh="GalleryText";O.PRg="ButtonComma";O.buttonPercentage="ButtonPercentage";O.keyboardNumber="KeyboardNumber";O.keyboardCurrency="KeyboardCurrency";O.keyboardDate="KeyboardDate";O.keyboardTime="KeyboardTime";O.keyboardPercentage="KeyboardPercentage";Object(u.a)(O,"RibbonFormatKind",null,[]);var ja=b(62),va=b(308),
ua=b(716),Xa=b(715),aa=b(714),ba=b(1),oa=b(70),ra=va.a;Rk(T,ra);T.prototype.C2=function(ha){return ra.prototype.C2.call(this,ha)||this.wCh.C2(this.Had,this.activeCell,this.format,this.sqe,this.QFf,this.LFf,this.YZb,this.YEa,this.clientCorrelationId,this.Clb,this.Whb)};T.prototype.Zi=function(){var ha=[];if(this.Dcc)for(var Z=bk(this.Dcc),Na=Z.next();!Na.done;Na=Z.next())ha.push(aa.a(Na.value));else ha.push(new Xa.a(this.format,this.Had,this.activeCell));return function(){return new ua.a(ha)}};T.prototype.ceb=
function(){var ha={OperationType:0};ha.FormatCellsMultiRange=this.Had;ha.ActiveCell=this.activeCell;ha.Format=this.format;ha.ApplyFormatOnPivotTableValueField=this.sqe;ha.PivotTableXluid=this.QFf;ha.PivotTableFieldCaption=this.LFf;return ha};Mf.Object.defineProperties(T.prototype,{operationWorkingState:{configurable:!0,enumerable:!0,get:function(){return ba.EwaSettings.Zb()?Object(oa.a)(T.prototype,this,"operationWorkingState"):0}},kt:{configurable:!0,enumerable:!0,get:function(){return this.Clb}},
naa:{configurable:!0,enumerable:!0,get:function(){return this.Whb}},NBc:{configurable:!0,enumerable:!0,get:function(){return this.YEa}}});Object(u.a)(T,"FormatCellsBatchOperation",va.a,[]);var db=b(36),Ka=b(216);G.editCell="Edited";G.dependentCell="Dependents";Object(u.a)(G,"RecalcPriorityGroupType",null,[]);var Ga=b(203),xa=b(8);Object(u.a)(m,"RecalcAccuracyObject",null,[]);y.string="String";y.blank="Blank";y.general="General";y.fBh="Flexible";Object(u.a)(y,"FormattedUnitKind",null,[]);Object(u.a)(r,
"RecalcResultProcessingStatistics",null,[]);Object(u.a)(v,"RecalcedCellInfo",null,[]);var da=b(110),qa=b(11),na=b(22),ia=b(58),ta=b(63),za=b(445);f.prototype.dispose=function(){this.calcManager=this.Cyc=this.Fg=this.grid=this.$=null};f.prototype.q$c=function(ha,Z,Na,eb,cb,Ua,pa){if(!Z)return Object(za.a)("Null");var Qa=excelOnlineCalc.numfmt.renderCallback(eb,function(Kb){return gridRenderer.CanvasRendererGlobals.measureTextWidth(Kb,cb,!0,ba.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextWidthClientPhase1",
!1))},pa),Db=ha.renderValue(Z,Qa);if(!excelOnlineCalc.util.isSuccess(Db))return Object(za.a)("Finalize");eb=null;if(pa=excelOnlineCalc.numfmt.isHashesValue(Db.value)){if(Db=ha.renderHashesValue(Db.value,Qa),!excelOnlineCalc.util.isSuccess(Db))return Object(za.a)("Hashes")}else eb=f.ICh(Z,Db.value);Qa=Db.value;ha=excelOnlineCalc.numfmt.renderedValueToString(Qa);Z=F(Qa);Qa=I(Qa);return Object(za.d)({text:ha,valueType:Na,fontColor:Qa,Yk:Ua,O8a:eb,horizontalAlignment:Z,isHashesValue:pa})};f.prototype.gAf=
function(ha,Z){var Na=this;this.$&&this.grid&&this.calcManager&&this.Cyc&&this.calcManager.lF?(ha&&(this.Nca=this.Cyc.j$e),this.S0i(this.grid,this.calcManager.lF,ha,Z),!this.Nca&&this.Rca.length?ia.Task.delay(0).Io(function(eb){Na.gAf(!0,eb.id);return!0},0,null,ta.a.current):ia.Task.Ua(!0)):(N.ULS.sendTraceTag(537162181,0,50,"CalcResultProcessor.OnRecalcResultsTask: one of the objects required for processing is null. Aborting..."),ia.Task.Ua(!1))};f.prototype.S0i=function(ha,Z,Na,eb){var cb=qa.HelperMethods.Qb();
for(Na=new r(this.Rca.length,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,this.Nca,void 0,void 0,void 0,Na,void 0,eb,!0,0,0,0,0,0,0);0<this.Rca.length;){eb=qa.HelperMethods.Qb()-cb;if(!this.Nca||eb>this.Nca){Na.numberOfCellsSkippedDueToTimeout=this.Rca.length;break}eb=Array.dequeue(this.Rca);if(D(eb,Na)){var Ua=ea.Range.Tc(eb.rangeDelta.range.row+1,eb.rangeDelta.range.column+1);(Ua=ha.Ub(Ua))?f.JTg(eb.stateId,Ua.cell)?(f.Flc(ha,Ua,eb,Na),this.gKg(Z,Ua,eb,Na)):Na.numberOfCellsUpdatedAlreadyByServer++:
Na.numberOfCellsWithNoFormattedCell++}}eb=Math.round(qa.HelperMethods.Qb()-cb);this.fTj(eb);this.NFj(Na,eb);this.mej(Na)};f.prototype.gKg=function(ha,Z,Na,eb){var cb,Ua,pa,Qa,Db=A(Z,Na),Kb=Na.rangeDelta.data.formatted,Ab=x(Na),ub=B(Na);ha=this.q$c(ha,Kb,Ab,Z.cell.WAa,Z.cell.L$,Db,!1);Db=Z.cell.F_d;if(Object(za.c)(ha))if(this.kAb&&this.Lqd){if(0===ub||Z.text!==ha.value.text)this.uoi&&0===ub&&this.gQd(Db,ha.value)&&(Z.cell.formattedText=Db),this.Fg.UYa(Z,ha.value),Na=w(Na),this.Fg.e7c(Z,this.lastSetCellInstantaneousOperation,
2,Na,!0,!0),0===ub&&ba.EwaSettings.isChangeGateEnabled("OfficeVSO:6487996_CalcNotifiesRecalcComplete")&&(this.calcManager?this.calcManager.hrf(Z.range):N.ULS.sendTraceTag(521171802,0,15,"CalcResultsProcessor.applyRecalcResultOnCell: Unable to call notifyEditedCellRecalcComplete as calcManager member is null.")),eb.numberOfUpdatedCells++}else Z.text!==ha.value.text&&(this.Fg.UYa(Z,ha.value),Na=w(Na),this.Fg.e7c(Z,this.lastSetCellInstantaneousOperation,2,Na,!0,!0),eb.numberOfUpdatedCells++);else switch(ha.reason){case "Null":eb.numberOfRecalcedCellsWithoutFormattedValue=
(null!==(cb=eb.numberOfRecalcedCellsWithoutFormattedValue)&&void 0!==cb?cb:0)+1;break;case "Hashes":eb.numberOfHashFormattedValues=(null!==(Ua=eb.numberOfHashFormattedValues)&&void 0!==Ua?Ua:0)+1;break;case "Finalize":eb.newNumberFormatterFinalizeFailures=(null!==(pa=eb.newNumberFormatterFinalizeFailures)&&void 0!==pa?pa:0)+1}Object(za.b)(ha)&&"Null"!==ha.reason&&(eb.numberOfRecalcedCellsWithFormattedValue=(null!==(Qa=eb.numberOfRecalcedCellsWithFormattedValue)&&void 0!==Qa?Qa:0)+1);eb=0===ub?Z.cell.userInput:
Z.formulaBarText;Qa=Object(za.c)(ha)?ha.value.text:"";Na=Object(za.b)(ha)?ha.reason:"";N.ULS.sendTraceTag(537162180,0,50,"CalcResultProcessor.ApplyRecalcResultOnCell: ({0}, {1}) 2nd pass formatting, success: {2}, reason: {3}, priority: {4}, ifmt: {5}, input: '{6}', prediction: '{7}',",Z.range.top,Z.range.left,ha.success,Na,ub,Z.cell.Yk,eb?na.a.VL(eb):"null",Qa?na.a.VL(Qa):"null")};f.prototype.fTj=function(ha){this.Nca=Math.max(this.Nca-Math.max(ha,1),0)};f.prototype.NFj=function(ha,Z){ha.numberOfNonUpdatedCells=
this.Rca.length;ha.totalExecutionTime=Z;ha.newProcessingTimeLimit=this.Nca;ha.lastSetCellInstantaneousOperation=this.lastSetCellInstantaneousOperation};f.prototype.mej=function(ha){ha=Sys.Serialization.JavaScriptSerializer.serialize(ha);N.ULS.sendTraceTag(574993417,0,50,"CalcResultProcessor.ReportRecalcProcessingStatistics:{0}",ha)};f.ICh=function(ha,Z){ha=ha.units;var Na=Z.units;if(ha.length!==Na.length)return N.ULS.sendTraceTag(537162179,0,15,"CalcResultProcessor.FormattedValueToNumberFormatInformation: can't convert to NumberFormatInformation: units and finalized units don't have the same length!"),
null;Z=[];for(var eb=-1,cb=0;cb<ha.length;cb++)switch(ha[cb].kind){case y.blank:Z.push.apply(Z,ck(da.h(" ",Na[cb].str.length)));break;case y.string:Z.push(ha[cb].str);break;case y.fBh:Z.push("");eb=cb;break;case y.general:Z.push(Na[cb].str);break;default:N.ULS.sendTraceTag(537162178,0,15,"CalcResultProcessor.ProcessFormattedValue: unknown FormattedUnitKind!")}if(0>=eb||""===Na[eb].str)return null;Na={};Na.Start=Z.slice(0,eb).join("");Na.Separator=ha[eb].str;Na.End=Z.slice(eb+1,Z.length).join("");
return Na};f.wJh=function(ha){return ha&&ha&&ha.Rt?ha.Rt.lJ:xa.a.Ee};f.JTg=function(ha,Z){if(!Z)return!1;Z=f.wJh(Z);return Z===xa.a.Ee||Z===ha};f.Flc=function(ha,Z,Na,eb){var cb=Na.rangeDelta.data.value.toString(),Ua=x(Na),pa=A(Z,Na);cb=new m(Ua,cb,pa,Na.priorityGroup);Z.cell.Flc(cb,ha.Ea.x5);1===B(Na)?eb.numberOfDependentRecalcedCellsInBatch++:eb.numberOfEditedRecalcedCellsInBatch++};f.prototype.gQd=function(ha,Z){return null==ha?!1:!!ha.TextRuns&&!!ha.Fonts&&ha.Text===Z.text&&2===Z.valueType};f.GFe=
20;Object(u.a)(f,"CalcResultProcessor",null,[722,3]);Object(u.a)(n,"GetRibbonNumberFormatResult",null,[]);var sa=b(1117);l.prototype.jcb=function(ha,Z,Na,eb,cb,Ua){ha&&(ha.t0(Z,Na,void 0===cb?!1:cb,void 0===Ua?!1:Ua),ha.verticalAlignment=eb)};l.prototype.jKb=function(ha,Z,Na){this.kx||(this.kx=new sa.a(this.Ea,this.j2a));this.kx.jKb(ha,Z,Na)};Object(u.a)(l,"FormatCellsActionModelAccessor",null,[721]);var V=b(217),Ia=b(28),Ha=b(31),ob=b(295),ib=b(259),La=b(294),zb=b(74);Object(u.a)(k,"FormatCellInstantaneousResult",
null,[]);Object(u.a)(e,"FormatStringResult",null,[]);var Fb=b(21),Yb=b(206),kb=b(1287),vb=b(42),Wa=b(568),qb=b(50),yb=b(205),ec=b(274),Ob=b(77),Cb=b(178),ab;(function(ha){ha.InvalidInput="invalid input";ha.UnsupportedZeroResize="resizing to 0 - ignore";ha.UnsupportedSkeletonInView="skeleton in view - ignore";ha.NullSPD="ActiveSheetProcessedData is null";ha.UnsupportedHiddenInRange="hiddens in resizeRanges";ha.UnsupportedMergeCell="There's a merge cell across blocks in resizeRanges"})(ab||(ab={}));
Object(u.b)("InstantaneousRowColumnResizeFailureReason",ab);var ya=b(327);d.prototype.dispose=function(){M.a.oc([this.URa,this.qha]);this.$=this.qha=this.URa=null};d.prototype.AAa=function(ha,Z,Na,eb,cb,Ua,pa,Qa,Db){return this.zzj(ha,Z,Na,void 0===cb?!1:cb,void 0===Qa?0:Qa,void 0===Ua?"":Ua,void 0===Db?null:Db)};d.prototype.e7c=function(ha,Z,Na,eb,cb,Ua){ha.cell.Rt.jM|=eb;d.$_g(Fb.g(this.$),ha,Na,cb);this.qha.lastSetCellInstantaneousOperation=Z;Ua&&Fb.g(this.$).si.A0(Z,zb.BasicTelemetryCalculator.HQ)};
d.prototype.Kda=function(ha,Z,Na,eb,cb,Ua){eb=void 0===eb?!1:eb;cb=void 0===cb?null:cb;var pa=void 0===pa?null:pa;Ua=(void 0===Ua?null:Ua)||ha.ha.sa.selectedRanges;if(!(-1690267012===Z&&1<Ua.length)){-1690267012===Z&&N.ULS.shipAssertTag(537162176,0,1===Ua.length,"FormatCellsAction.ShowInstantaneousFormatting: targetRanges.Length = {0}",Ua.length);var Qa=ha.K$("FormatCellsAction.ShowInstantaneousFormatting",Ua);try{Qa.$$rst();for(var Db=!1;Qa.$$mn();){var Kb=void 0,Ab=Qa.$$cu().ZE?ha.HJb(Qa.$$cu().range):
(Kb=new Q.a,Kb.add(Qa.$$cu()),Kb);Kb={};for(var ub=bk(Ab),Mb=ub.next();!Mb.done;Kb={Afb:Kb.Afb},Mb=ub.next()){var Aa=Mb.value;if(Fb.g(this.$).gz&&Aa&&pa&&-1690267012===Z&&(Kb.Afb=Aa.range,Kb.Afb&&pa.contains(Kb.Afb)&&C.a.all(Ua,function(Za){return function(Zb){return!X.c(Zb,Za.Afb)}}(Kb))))continue;if(!Aa||Qa.gb.contains(Aa.range))if(this.D2f(Z,Aa,Na,eb,cb,Qa.$$cu().ZE),Db||(ha.Ea.lV(),Db=!0),cb)break}}}finally{Qa&&Qa.dispose()}}};d.prototype.UYa=function(ha,Z,Na){if(Na=void 0===Na?null:Na)Na.Zva=
!0;Na=!Z.text;var eb=na.a.hef(Z.text),cb,Ua=ha.ZE?Fb.g(this.$).HJb(ha.range):(cb=new Q.a,cb.add(ha),cb);cb=bk(Ua);for(Ua=cb.next();!Ua.done;Ua=cb.next())this.eKg(this.$,Ua.value,Z.text,Z.horizontalAlignment,Z.fontColor,Z.Yk,ha.cell.Yk,Na,eb,Z.valueType,Z.O8a);ha.cell.BBc()};d.prototype.OWi=function(ha,Z,Na,eb,cb){cb=void 0===cb?null:cb;try{var Ua=X.D(Z),pa=X.D(Na);if(ha.Ab.f6a(Ua)||ha.Ab.f6a(pa))return 8;if(-185374993!==eb&&this.pmi(ha,Ua,pa))return 9;if(-185374993!==eb&&(ha.Ab.f5(pa)||ha.Ab.Gzb(Ua)))return 10;
if(1804571062!==eb&&ha.Ab.d5(pa))return 11;if(this.Ygh(pa))return 12;if(this.hni(Ua,pa))return 13;var Qa=this.$.Fb.sc("UserAction","PasteInstantaneous");Qa.start();Wa.a(Qa);cb&&qb.b().rA(Qa.id,cb.id,"actions","actions");!Ua.isSingle&&pa.isSingle&&(pa=d.expandRange(Ua,pa),ha.ha.updateSelection(pa,pa,0));switch(eb){case 237279923:case 808159687:if(!this.eXi(Ua,pa))return 14;this.Y1c(ha,Ua,pa,!0,!1);break;case 1804571062:this.Y1c(ha,Ua,pa,!0,!1);break;case -185374993:this.Y1c(ha,Ua,pa,!1,!0);break;default:return 2}N.ULS.sendTraceTag(537162146,
0,50,"FormatCellsAction.PasteInstantaneous: Complete processing.");return 1}catch(Db){return N.ULS.sendTraceTag(537162145,0,10,"FormatCellsAction.PasteInstantaneous: failed with the following error: {0}",JSON.stringify(Db)),15}};d.prototype.TXg=function(ha,Z){ha=bk(ha);for(var Na=ha.next();!Na.done;Na=ha.next())this.J_c(Na.value,!0,Z)};d.prototype.J_c=function(ha,Z,Na){Na=void 0===Na?"":Na;if(ha){var eb=Fb.g(this.$);if(Z){if(Z=eb.Xj("FormatCellsAction.ClearRangeInstantaneous",ha),ha=ha.isSingle?null:
ha,Z.$$mn()&&void 0!==Z.$$cu()&&null!==Z.$$cu())for(eb=Object(K.a)(new ec.a,{Text:""}),this.AAa(Z.$$cu(),eb,!1,void 0,db.a.qgc(this.$),Na,void 0,void 0,ha);Z.$$mn();)void 0!==Z.$$cu()&&null!==Z.$$cu()&&this.AAa(Z.$$cu(),eb,!1,void 0,!1,Na)}else this.Kda(eb,-1228228458,{},void 0,void 0,[ha])}else N.ULS.shipAssertTag(537162144,0,!1,"FormatCellsAction.ClearRangeInstantaneous: targetRange shouldn't be null")};d.prototype.o6i=function(ha,Z){if(!Z){Z=qa.HelperMethods.Qb();var Na=Fb.g(this.$),eb=Na.K$("FormatCellsAction.ReformatCells",
ha);try{eb.$$rst();for(var cb=!1;eb.$$mn();){var Ua=eb.$$cu().cell;if(0===Ua.aM||2===Ua.aM)this.updateSpillInformation(Ua,ha),cb||(Na.Ea.lV(),cb=!0)}}finally{eb&&eb.dispose()}N.ULS.sendTraceTag(537162143,0,50,"FormatCellsAction.ReformatCellsAfterGeometryChange: reformatting cells total time: {0}.",qa.HelperMethods.Qb()-Z)}};d.prototype.bdc=function(ha,Z){if(this.tb){if(ha.formulaBarText)return!na.a.equals(Z.Text,ha.formulaBarText,!1);var Na=ha.cell.formattedText;Na=ib.a(Na,ha.cell.getCellFont());
return!gridRenderer.CanvasRendererGlobals.compareFormattedTexts(Na,Z).isEqual}return!na.a.equals(Z.Text,ha.text,!1)};d.prototype.DCh=function(ha){if(void 0===ha||null===ha)return new e(!1,"1234.56");ha=this.D2a({value:"1234.56",type:1},ha,244,"12px sans-serif");return Object(za.b)(ha)?new e(!1,"1234.56"):new e(!0,ha.value.text)};d.prototype.Azj=function(ha,Z,Na,eb){return U(ha,this,Z,Na,eb,!0)};d.prototype.C2f=function(ha,Z,Na){if(!this.bdc(Z,Na))return Object(za.d)("Skip unchanged cell content");
Z=Z.cell;Na=this.OTe(Na.Text,Z.Yk,Z.WAa,Z.L$,!0);if(Object(za.b)(Na))ha=Na;else{Na=Na.value;var eb=Na.text;var cb=Na.valueType;eb=Z.hasRichValueIcon?"Unsupported rich value icon":Z.vea?ba.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EstimateWrapTextEditResize",!1)&&2==cb&&'normal 11pt "calibri"'===Z.L$&&Z.BAe(eb)>=Z.offsetWidth*Math.floor(Z.offsetHeight/xa.a.Rrb)?"Unsupported wrapped text with long input":"Unsupported wrapped text":Z.ahf||null!=Z.gS&&0!==Z.gS?"Unsupported rotated text":
!0;!0!==eb?ha=Object(za.a)(eb):(Z.isCellWidthFixed?eb="Skip fixed width cell":(eb=Na.valueType,eb=0===eb?"Skip empty cell value":2===eb?"Skip string cell value":Z.QM&&!Z.jmi?"Skip merged cell":Z.txc?"Skip shrunk to fit":Na.isHashesValue?"Skip hashes cell value":!0),!0!==eb?ha=Object(za.d)(eb):(Na=Z.BAe(Na.text),Na>Z.offsetWidth?(Z=[Z.getRange().clone()],ha=U(ha,this,Z,Na,!1,!1),ha=Object(za.b)(ha)?ha:Object(za.d)(Na)):ha=Object(za.d)("Column is wide enough")))}return ha};d.prototype.MTe=function(ha,
Z,Na,eb,cb){var Ua={};Ua.value=ha;Ua.type=Na;Z=this.D2a(Ua,Z,eb,cb);return Object(za.b)(Z)?new e(!1,ha):new e(!0,Z.value.text)};d.prototype.updateSpillInformation=function(ha,Z){var Na=ha.getRange(),eb=!1;Z=bk(Z);for(var cb=Z.next();!cb.done;cb=Z.next())if(Na.left===cb.value.left){eb=!0;break}ha.WPj(eb)};d.prototype.zzj=function(ha,Z,Na,eb,cb,Ua,pa){var Qa=void 0;Ua=void 0===Ua?"":Ua;Qa=void 0===Qa?1:Qa;pa=void 0===pa?null:pa;this.kAb&&this.voi&&(ha.cell.F_d=Z);var Db=new k;Db.source=0;Db.Zva=!1;
ha.cell.zoc=ha.cell.Yk;var Kb=Z.Text,Ab=!Kb,ub=na.a.hef(Kb);na.a.tq(Kb)&&(N.ULS.shipAssertTag(537162142,0,!((void 0===Kb||null===Kb)&&void 0!==Z.TextRuns&&null!==Z.TextRuns),"FormatCellsAction.ShowInstantaneousDataEntryOnCellInternal: Text is null but TextRuns isn't"),Z=Object(K.a)(new ec.a,{Text:""}),Kb="");ha.cell.userInput=Kb;if(!this.bdc(ha,Z))return this.pVg(ha,cb,Ab,ub,Db);Na?this.iVg(ha,Kb,this.$.workbookContext.DefaultHyperlinkStyle,Db):this.cVg(ha,Z,Kb,Ab,ub,eb,Db,pa);this.e7c(ha,Ua,cb,Qa,
Db.jhc,Db.Zva);return Db};d.prototype.pVg=function(ha,Z,Na,eb,cb){cb.yeg=!0;cb.jhc=!0;cb.Zva=!1;0===Z&&Fb.g(this.$).Ea.lV();0===ha.cell.Fya&&(Na?ha.cell.t0(0,!1):eb&&ha.cell.t0(1,!1));this.xWd(ha.range,"FormatCellsAction.cellUnchangedDataEntryCSE");return cb};d.prototype.iVg=function(ha,Z,Na,eb){eb.Zva=!0;ha.insertHyperlink(Z,Ka.a.X$c(Z),Na);this.xWd(ha.range,"FormatCellsAction.cellDataEntryCSE")};d.prototype.cVg=function(ha,Z,Na,eb,cb,Ua,pa,Qa){Qa=void 0===Qa?null:Qa;pa.Zva=!1;var Db=ha.cell;this.fz||
(this.fz=this.$.da.za(268));this.KLj(this.fz,Db.Yk);eb||cb?this.eVg(ha,eb,cb,pa):(eb=this.OTe(Na,Db.Yk,Db.WAa,Db.L$,!1),Object(za.c)(eb)?(this.gQd(Z.TextRuns,Z.Fonts)&&this.gVg(ha,Z,eb.value),this.UYa(ha,eb.value,pa),this.xWd(ha.range,"FormatCellsAction.cellDataEntryCSE")):this.kAb&&this.Lqd?this.mVg(ha,Z.Text,pa):this.nVg(ha,Z.Text),Z=Object(za.c)(eb)?eb.value.text:"",cb=Object(za.b)(eb)?eb.reason:"",N.ULS.sendTraceTag(559724065,0,50,"FormatCellsAction.CellDataEntryCSE: ({0}, {1}) 1st pass formatting, success: {2}, reason: {3}, ifmt: {4}, input: '{5}', prediction: '{6}',",
ha.range.top,ha.range.left,eb.success,cb,Db.Yk,na.a.OYa(Db.userInput),na.a.OYa(Z)));Db.formulaBarText=Na;Ua&&this.kLj(this.fz,ha,Na,Qa);pa.jhc=!0};d.prototype.eVg=function(ha,Z,Na,eb){eb.Zva=!0;ha.text="";ha.formulaBarText="";ha.cell.userInput="";this.C1b(ha,null,null,Z,Na)};d.prototype.gVg=function(ha,Z,Na){Z.Text===Na.text&&2===Na.valueType&&(ha.cell.formattedText=Z)};d.prototype.mVg=function(ha,Z,Na){Na&&(Na.Zva=!0);ha.text=Z;ha.formulaBarText=Z;this.C1b(ha,1)};d.prototype.nVg=function(ha,Z){ha.text=
Z;ha.formulaBarText=Z;this.C1b(ha,1)};d.prototype.C1b=function(ha,Z,Na,eb,cb,Ua){Na=void 0===Na?null:Na;eb=void 0===eb?!1:eb;cb=void 0===cb?!1:cb;Ua=void 0===Ua?!1:Ua;var pa=ha.horizontalAlignment;Na=null!=Na?Na:ha.verticalAlignment;0===ha.cell.Fya&&(null!=Z||eb||cb||Ua)&&(eb?pa=0:cb||Ua?pa=1:null!=Z&&(pa=Z),this.wua.jcb(ha,pa,!1,Na,!0))};d.prototype.xWd=function(ha,Z){var Na=this;if(ba.EwaSettings.isChangeGateEnabled("OfficeVSO:6487996_CalcNotifiesRecalcComplete")){var eb=Fb.g(this.$),cb=function(){Na.calcManager?
Na.calcManager.hrf(ha):N.ULS.sendTraceTag(521172961,0,50,"FormatCellsAction.cellUnchangedDataEntryCSE: Unable to call notifyEditedCellRecalcComplete as calcManager member is null. caller: "+Z+", cell "+ha);eb.Wb.Nl(cb)};eb.Wb.tm(cb)}};d.prototype.KLj=function(ha,Z){(null===ha||void 0===ha?0:ha.Yxa)&&Z>=d.OAh&&Z>ha.Yxa.length-1&&(N.ULS.sendTraceTag(537162141,0,50,"FormatCellsAction.TriggerSupportInformationRefresh: The cell has a missing format, ifmt:{0}. Triggering refresh...",Z),ha.ETe())};d.prototype.kLj=
function(ha,Z,Na,eb){eb=void 0===eb?null:eb;if(void 0!==ha&&null!==ha)if(this.fz.cld)N.ULS.sendTraceTag(537162140,0,50,"FormatCellsAction.TriggerCalc: in manual mode - not recalcing");else{var cb=this.$.da.za(266);cb&&(this.qha.Nca=f.GFe,ha&&(this.qha.Nca=ha.j$e),cb.YSg(Z,Na,this.qha.AIf,eb))}};d.prototype.D2a=function(ha,Z,Na,eb){var cb=this.$.da.za(266);if(!cb)return Object(za.a)("calcManager is null");if(!cb.lF)return Object(za.a)("calcManager.NumberFormatter is null");if(!this.fz)return Object(za.a)("instantaneousManager is null");
if("number"===typeof Z||"string"===typeof Z){var Ua=cb.rbc(Z);if(!Object(za.c)(Ua))return Ua;var pa=Ua.value}else pa=Z;Ua=cb.lF;var Qa=z(ha);if(void 0===Qa||null===Qa)return Object(za.a)("cellValue is null");cb=excelOnlineCalc.calc.cellValueToReadOper(cb.config.mathpack,Qa);if(void 0===cb||null===cb)return Object(za.a)("readOper is null");cb=Ua.applyFormat(pa,cb,ba.EwaSettings.isChangeGateEnabled("OfficeVSO:6328006_applyFormatDisplaysZeroes"));return excelOnlineCalc.util.isSuccess(cb)?this.qha.q$c(Ua,
cb.value,ha.type,Na,eb,"number"===typeof Z?Z:-1,!1):Object(za.a)("NumberFormatter.ApplyFormat: "+JSON.stringify(cb.reason.kind))};d.prototype.OTe=function(ha,Z,Na,eb,cb){var Ua=this.$.da.za(266);if(void 0===Ua||null===Ua)return Object(za.a)("calcManager is null");if(void 0===Ua.lF||null===Ua.lF)return Object(za.a)("calcManager.NumberFormatter is null");if(void 0===this.fz||null===this.fz)return Object(za.a)("instantaneousManager is null");if(this.kAb&&!cb)return Object(za.a)("No main thread number formatter");
var pa=Ua.rbc(Z);if(!Object(za.c)(pa))return pa;var Qa=pa.value;pa=Ua.lF;ha=pa.parseEdit(ha,Qa);if(!excelOnlineCalc.util.isSuccess(ha))return Object(za.a)("ParseEdit failure: reason="+ha.reason.kind+", features="+ha.reason.features);if(ha.value.kind===wa.a.formula)return Object(za.a)("Main thread - skipping formula edit");Ua=excelOnlineCalc.numfmt.applyValueEdit(pa,Ua.localeInfo,Qa,ha.value);if(!excelOnlineCalc.util.isSuccess(Ua))return Object(za.a)("NumberFormatter.FormatValueEdit: "+JSON.stringify(Ua.reason.kind));
ha=ha.value;N.ULS.shipAssertTag(537162190,0,ha.kind!==wa.a.formula,"CalcInterfaceAdapter.GetCellValueTypeFromParsedEdit: given parsed edit must be a value edit!");ha=excelOnlineCalc.numfmt.getValueEditOperKind(ha);Qa=0;switch(ha){case 0:case 128:Qa=0;break;case 1:Qa=1;break;case 2:Qa=2;break;case 4:Qa=3;break;case 8:Qa=4;break;case 16:case 32:case 64:case 256:N.ULS.sendTraceTag(537162189,0,15,"CalcInterfaceAdapter.OperKindToCellValueType: can't convert given OperKind {0} to a CellValueType",ha);break;
default:N.ULS.shipAssertTag(537162188,0,!1,"CalcInterfaceAdapter.OperKindToCellValueType: Unexpected oper kind {0}",ha)}return this.qha.q$c(pa,Ua.value,Qa,Na,eb,"number"===typeof Z?Z:-1,cb)};d.prototype.pmi=function(ha,Z,Na){if(Z.width<Na.width)for(var eb=ha.Xj("FormatCellsAction.IsSourceRangeLargerAndWithBorders",new ea.Range(Z.top,Z.left,Z.bottom,Z.left,!0,!0));eb.$$mn();){var cb=eb.$$cu();if(cb&&cb.CKa())return N.ULS.sendTraceTag(537162139,0,50,"FormatCellsAction.ShowInstantaneousFormattingFromRange: no instantenous."),
!0}if(Z.height<Na.height)for(ha=ha.Xj("FormatCellsAction.IsSourceRangeLargerAndWithBorders2",new ea.Range(Z.top,Z.left,Z.top,Z.right,!0,!0));ha.$$mn();)if((Z=ha.$$cu())&&Z.FKa())return N.ULS.sendTraceTag(537162138,0,50,"FormatCellsAction.ShowInstantaneousFormattingFromRange: no instantenous."),!0;return!1};d.prototype.Y1c=function(ha,Z,Na,eb,cb){for(var Ua=Z.jS().FirstRow,pa=Z.jS().LastRow,Qa=Na.jS().LastRow,Db=Ua,Kb=Na.jS().FirstRow;Kb<=Qa;Kb++,Db++){Db>pa&&(Db=Ua);var Ab=Z.jS();Ab.FirstRow=Ab.LastRow=
Db;var ub=Na.jS();ub.FirstRow=ub.LastRow=Kb;this.Z2g(ha,fa.a.pQ(Ab),fa.a.pQ(ub),eb,cb)}};d.prototype.eXi=function(ha,Z){var Na=this.$.da.za(266);return void 0!==Na&&null!==Na?(Na.SSg(ha,Z.topLeft,this.qha.AIf),!0):!1};d.prototype.hni=function(ha,Z){var Na=ha.right-ha.left+1;ha=ha.bottom-ha.top+1;var eb=Z.right-Z.left+1;Z=Z.bottom-Z.top+1;if(eb>Na&&Z>ha){if(!(eb%Na&&Z%ha))return!0}else if(eb===Na&&Z>ha){if(!(Z%ha))return!0}else if(eb>Na&&Z===ha&&!(eb%Na))return!0;return!1};d.prototype.Ygh=function(ha){if(ba.EwaSettings.ma(103)){ha=
Fb.g(this.$).Y0(ha).gridView.getRangeInformation(ha);ha=bk(ha);for(var Z=ha.next();!Z.done;Z=ha.next())if(Z=Z.value,Object(P.a)(ca.DynamicArrayRange,Z)&&!Object(ka.a)(ca.DynamicArrayRange,Z).xlc)return!0}return!1};d.prototype.sBe=function(ha,Z,Na,eb,cb,Ua){Z=bk(Z);for(var pa=Z.next();!pa.done;pa=Z.next())pa=pa.value,Na&&(this.c3g(pa,cb),pa.setCell(!0)),eb&&(Ua=this.G2h(cb,pa)),Ua||(ha.Ea.lV(),Ua=!0);return Ua};d.prototype.vOh=function(ha,Z,Na){Z=new ea.Range(Z,Na,Z,Na,!0,!0);return ha.Ub(Z)};d.prototype.Z2g=
function(ha,Z,Na,eb,cb){if(Na){this.URa&&Na.equals(this.URa.range)||(M.a.Ia(this.URa),this.URa=ha.Xj("FormatCellsAction.CopyBetweenRows",Na));Na=this.URa;Na.$$rst();var Ua=!1;if(ba.EwaSettings.getBooleanFeatureGate(ya.a.oEe,!1)){var pa=Z.jS().FirstColumn+1,Qa=Z.jS().LastColumn+1;Z=Z.jS().FirstRow+1;for(var Db=pa;Na.$$mn();){Db>Qa&&(Db=pa);var Kb=this.vOh(ha,Z,Db);Db+=1;var Ab=void 0,ub=Na.$$cu().ZE?ha.HJb(Na.$$cu().range):(Ab=new Q.a,Ab.add(Na.$$cu()),Ab);Kb&&(Ua=this.sBe(ha,ub,eb,cb,Kb,Ua));Ob.lastOrDefault(ub)}}else for(pa=
ha.Xj("FormatCellsAction.CopyBetweenRows2",Z);Na.$$mn();)pa.$$mn()||(pa.$$rst(),pa.$$mn()),Qa=pa.$$cu(),Z=void 0,Db=Na.$$cu().ZE?ha.HJb(Na.$$cu().range):(Z=new Q.a,Z.add(Na.$$cu()),Z),Qa&&(Ua=this.sBe(ha,Db,eb,cb,Qa,Ua)),Ob.lastOrDefault(Db)}else N.ULS.sendTraceTag(537162137,0,50,"FormatCellsAction.CopyBetweenRows: targetRange is null")};d.prototype.W2f=function(){var ha=Ha.a.Xc(1,0,0,651,0,104573951,"PivotTableContextMenuOperationFailure");vb.a(this.$).hj(ha)};d.prototype.Vxi=function(ha,Z){var Na=
{ValidMembers:32},eb=Z.NumberFormat;switch(ha){case 1890566896:if(1001===eb||1002===eb||1003===eb){Na.NumberFormat=14;Na.NumberFormatOptions={};switch(eb){case 1001:Na.NumberFormatOptions.TimeType=2;break;case 1002:Na.NumberFormatOptions.DateType=7;break;case 1003:Na.NumberFormatOptions.DecimalPlaces=0}Na.NumberFormatOptions.NumberFormatCategory=this.TJg(eb)}else Na.NumberFormat=eb;break;case 1886928607:Na.NumberFormat=13;break;case -992833457:Na.NumberFormat=11;break;case 218524921:Na.NumberFormat=
12;break;case 996232352:Na.NumberFormat=14;Na.NumberFormatOptions=Object(K.a)(new R.a,{DecimalPlaces:0});Na.NumberFormatOptions.NumberFormatCategory=6;break;default:return Z}return Na};d.prototype.formatCells=function(ha,Z,Na,eb,cb,Ua,pa){eb=void 0===eb?null:eb;cb=void 0===cb?null:cb;Ua=void 0===Ua?null:Ua;pa=void 0===pa?null:pa;var Qa=this.$.Fb.sc("UserAction","FormatCellsInstantaneous, command = "+qb.b().ei(ha)),Db=this.$.Fb.Kg("UserAction","FormatCellsInstantaneousFrame");Db.start();Wa.a(Db);var Kb=
qb.b().ei(ha),Ab=this.$,ub=Fb.g(Ab),Mb=ub.ha.sa,Aa=cb||Mb.selectedRanges,Za=da.g(Aa,function(Rb){return Rb.EG});Kb=String.format("{0}, cellCount={1}",Kb,Za);Fb.g(this.$).si.y7(1,Qa.id,Kb);Aa=X.r(Aa,this.$);Mb=Mb.activeCell;Kb=-168056295===Na.command;var Zb=Za=null;if(Kb){Zb=ub.Ab.Qo(Mb);if(!Zb){this.W2f();return}Za=Zb.Eca.substring(1,Zb.Eca.length-1);Zb=Zb.sac();if(!Zb){this.W2f();return}Zb=Zb.Caption}ub.hg.GG(!1,!0);var jb=X.o(Mb,Ab),Vb=Ab.oa.xa.Pb({n_:!0,GZ:1}),Ic=this.Vxi(Na.command,Z);Kb||this.Kda(ub,
ha,Z,!1,eb,cb);Qa.stop();Fb.g(this.$).si.A0(Qa.id,zb.BasicTelemetryCalculator.HQ);Na.Fbi=Ia.a.Ta.Jb;eb=this.$.Fb.sc("UserAction","FormatCellsUserAction");this.jui(ha,Na.taskId,Z,Aa,Mb,eb.id);qb.b().rA(Qa.id,eb.id,"actions","actions");qb.b().rA(Db.id,eb.id,"actions","actions");ba.EwaSettings.Zb()?Ab.userOperationManager.Sb(new T(this,Aa,jb,Ic,Kb,Za,Zb,Vb,eb,Qa.id,64,Ua,pa),Na):Ab.userOperationManager.Sb(new T(this,Aa,jb,Ic,Kb,Za,Zb,Vb,eb,Qa.id,0,Ua,pa),Na)};d.prototype.C2=function(ha,Z,Na,eb,cb,Ua,
pa,Qa,Db,Kb,Ab){var ub=this,Mb=this.$;return function(Aa,Za,Zb){Mb.ly();Aa=[Aa,ub.WJi];Za=[Za];Kb&&Aa.push(Kb);Ab&&Za.push(Ab);return ja.l(Mb.oa.xa,ha,Z,Na,eb,cb,Ua,!1,La.b.apply(La,ck(Aa)),La.a.apply(La,ck(Za)),Zb,Db,pa,Qa)}};d.prototype.D2f=function(ha,Z,Na,eb,cb,Ua,pa){pa=void 0===pa?null:pa;if(Z&&Na){var Qa=Na.Font,Db=Na.HorizontalAlignment,Kb=Na.VerticalAlignment;Na.ValidMembers&2||(Db=Z.horizontalAlignment);Na.ValidMembers&1||(Kb=Z.verticalAlignment);var Ab=0!==Db;d.Qdi(ha)&&0===Db&&(Db=this.NYe(Z));
var ub=!1;switch(ha){case -394785302:this.wua.jcb(Z,Db,Ab,0);break;case 1041132226:this.wua.jcb(Z,Db,Ab,1);break;case -571165336:this.wua.jcb(Z,Db,Ab,2);break;case -1150205178:case -1142465846:case -286432209:this.wua.jcb(Z,Db,Ab,Kb,!1,!1);break;case -1220714308:case -1649235364:case 524773427:case 1886217042:case 928057943:case -1526602249:this.wMa&&this.ioj(Z,Na,Ab);break;case 1650812936:this.setFillColor(Z,Na,Ua);break;case -287251124:Z.bold=Qa.Bold;break;case -1690267012:Fb.g(this.$).ha.sa.sg&&
(Qa=ba.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellUnmergeWithBorderScenariosCse",!1)?pa?pa:Fb.g(this.$).ha.sa.Vc:Fb.g(this.$).ha.sa.Vc,this.wua.jKb(Z,Na,Qa));break;case 1970784898:Na=Ga.a.Oo(Z.color,Z.backgroundColor);if(V.a.compare(Na,V.a.red)&&(na.a.b5(Z.text)||na.a.B5e(Z.text)))break;Qa=V.a.WG(Qa.FontColor);Z.color=yb.e(Ga.a.VF(Qa));break;case -1925065947:Z.italic=Qa.Italic;break;case -1293291468:Na=ba.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation");
this.Am?(Z.CKb(Qa.FontName,Na,"ShowInstantaneousFormattingOnCell"),Z.CYf(Qa.FontScheme)):Z.CKb(Qa.FontName,Na,"ShowInstantaneousFormattingOnCell");break;case 862890474:case 963349338:Z.fontSize=Qa.FontSize;this.$.hf();break;case -1077965542:Z.fontSize=Qa.FontSize;break;case 1764140053:Z.underline=Qa.Underline;break;case -1685033574:Z.doubleUnderline=Qa.DoubleUnderline;break;case -1590502662:Z.fontStrikethrough=Qa.Strikethrough;break;case -848953656:case 2045211913:ub=Z.Opb();break;case 2105621672:Qa=
Object(ka.a)(kb.a,cb);if(!Qa)break;Na=V.a.DDh(Qa.color);Z.color=yb.e(Ga.a.VF(Na));this.yqe(Z,Qa.Olc);break;case -1409276245:this.yqe(Z,Na.NumberFormatOptions.CustomFormatString);break;case 1890566896:this.dKg(Z,Na);break;case -1228228458:Z.Opb();Z.clearFormat();this.TVc(Z,0);ub=!0;break;case -730106152:Z.clearFormat();this.TVc(Z,0);break;case 932244020:this.hoj(Z,Na,Ua);break;case -1942512156:case -1920201820:this.fqj(Z,Na)}eb||(ub?Z.CHb(!0):Z.setCell(!0))}else N.ULS.shipAssertTag(537162135,0,!Z,
"FormatCellsAction.ShowInstantaneousFormattingOnCell empty cellToFormat"),N.ULS.shipAssertTag(537162134,0,!Na,"FormatCellsAction.ShowInstantaneousFormattingOnCell empty cellFormat")};d.prototype.c3g=function(ha,Z){ha&&Z?(ha.Xpb(Z),ha.$_c(Z),this.TVc(ha,Z.cell.Yk)):N.ULS.sendTraceTag(537162133,0,10,"FormatCellsAction.CopyFormattingBetweenCells:cellToFormat & sourceCell should not be null")};d.prototype.TVc=function(ha,Z){if(0>Z)this.Wba({caller:"ApplyNumberFormatIndexOnCell",cell:ha,kind:"failure",
reason:"ApplyNumberFormatIndexOnCell: negative format index was supplied"});else{var Na=this.D2a(ha.Nw,Z,ha.cell.WAa,ha.cell.L$);Object(za.b)(Na)?this.Wba({caller:"ApplyNumberFormatIndexOnCell",cell:ha,kind:"failure",reason:Na.reason}):(this.UYa(ha,Na.value),this.Wba({caller:"ApplyNumberFormatIndexOnCell",cell:ha,kind:"success",$y:Na.value,format:Z}))}};d.prototype.yqe=function(ha,Z){if(void 0===Z||null===Z)this.Wba({caller:"ApplyNumberFormatStringOnCell",cell:ha,kind:"failure",reason:"ApplyNumberFormatStringOnCell: no format string was supplied"});
else{var Na=this.D2a(ha.Nw,Z,ha.cell.WAa,ha.cell.L$);Object(za.b)(Na)?this.Wba({caller:"ApplyNumberFormatStringOnCell",cell:ha,kind:"failure",reason:Na.reason}):(this.UYa(ha,Na.value),this.Wba({caller:"ApplyNumberFormatStringOnCell",cell:ha,kind:"success",$y:Na.value,format:Z}))}};d.prototype.dKg=function(ha,Z){if(Z=void 0===Z?null:Z)if(Z=this.BVh(ha,Z),Z.success){var Na=this.D2a(ha.Nw,Z.Klc,ha.cell.WAa,ha.cell.L$);Object(za.b)(Na)?this.Wba({caller:"ApplyNumberFormatCategoryOnCell",cell:ha,kind:"failure",
reason:Na.reason,format:Z.Klc}):(this.UYa(ha,Na.value),this.Wba({caller:"ApplyNumberFormatCategoryOnCell",cell:ha,kind:"success",$y:Na.value,format:Z.Klc}))}else this.Wba({caller:"ApplyNumberFormatCategoryOnCell",cell:ha,kind:"failure",reason:Z.reason,format:Z.Klc});else this.Wba({caller:"ApplyNumberFormatCategoryOnCell",cell:ha,kind:"failure",reason:"ApplyNumberFormatCategoryOnCell: no format was supplied"})};d.prototype.TJg=function(ha){switch(ha){case 1004:return 1;case 5:return-1;case 1002:return 4;
case 6:case 1001:return 5;case 7:case 1003:return 6;case 8:return 7;case 9:return 8;case 10:return 9}return 10<ha?-1:ha};d.prototype.BVh=function(ha,Z){if(!this.fz||!this.localeInfo||!Z)return ha=this.fz?this.localeInfo?"cellFormat is null":"localeInfo is null":"instantaneousManager is null",new n(!1,void 0,"GetRibbonNumberFormat: "+ha);Z=Z.NumberFormat;switch(Z){case 0:ha=O.cEh;break;case 1:ha=O.eEh;break;case 2:ha=O.aEh;break;case 3:ha=O.ZDh;break;case 4:ha=O.hEh;break;case 5:ha=O.dEh;break;case 6:ha=
O.jEh;break;case 7:ha=O.fEh;break;case 8:ha=O.bEh;break;case 9:ha=O.gEh;break;case 10:ha=O.iEh;break;case 11:case 12:return this.fz.ETe(),this.OLh(ha,Z);case 13:ha=O.PRg;break;case 1006:ha=O.buttonPercentage;break;case 1004:ha=O.keyboardNumber;break;case 1005:ha=O.keyboardCurrency;break;case 1002:ha=O.keyboardDate;break;case 1001:ha=O.keyboardTime;break;case 1003:ha=O.keyboardPercentage;break;case 14:return ha="GetRibbonNumberFormat: should not be called with NumberFormatDialog!",N.ULS.shipAssertTag(537162132,
0,!1,ha),new n(!1,void 0,ha);default:return ha="GetRibbonNumberFormat: unknown NumberFormatType!",N.ULS.shipAssertTag(537162131,0,!1,ha),new n(!1,void 0,ha)}return ha?(ha=excelOnlineCalc.numfmt.getRibbonFormat(this.localeInfo,ha))?new n(!0,ha):new n(!1,void 0,"GetRibbonNumberFormat: ExcelOnlineCalcService.NumberFormatter.GetRibbonNumberFormat unable to get ribbon format..."):new n(!1,void 0,"GetRibbonNumberFormat: unsupported ribbonFormatKind...")};d.prototype.OLh=function(ha,Z){if(!this.calcManager||
!this.lF)return Z=this.calcManager?"numberFormatter is null":"calcManager is null",new n(!1,void 0,"GetDecimalChangeNumberFormat: "+Z);ha=this.calcManager.rbc(ha.cell.Yk);if(!Object(za.c)(ha))return new n(!1,void 0,"getDecimalChangeNumberFormat: "+ha.reason);Z=this.lF.changeFormatDecimals(ha.value,11===Z?1:-1);return excelOnlineCalc.util.isSuccess(Z)?void 0===Z.value||null===Z.value?new n(!1,void 0,"GetDecimalChangeNumberFormat: successUndefined result"):new n(!0,Z.value):new n(!1,void 0,"GetDecimalChangeNumberFormat: NumberFormatter.ChangeFormatDecimals failure")};
d.prototype.Wba=function(ha){var Z=ha.caller,Na=ha.cell,eb=ha.format;eb=null==eb?"null":"number"===typeof eb?eb:"string"===typeof eb?na.a.OYa(eb):na.a.OYa(eb.formatString);var cb=na.a.OYa(Na.Nw.value)||"null",Ua="success"===ha.kind?na.a.OYa(ha.$y.text):"null";N.ULS.sendTraceTag(537162130,0,50,"FormatCellsAction.LogNumberFormatEdit: {0}",{caller:Z,"range.top":Na.range.top,"range.left":Na.range.left,result:ha.kind,reason:"success"===ha.kind?"":ha.reason,value:cb,valueType:Na.Nw.type,ifmt:eb,prediction:Ua})};
d.prototype.eKg=function(ha,Z,Na,eb,cb,Ua,pa,Qa,Db,Kb,Ab){Qa=void 0===Qa?!1:Qa;Db=void 0===Db?!1:Db;var ub=Z.cell;ub.aM=void 0===Kb?0:Kb;Kb=Z.text;Kb!==Na&&(ub.text=Na);ub.O8a=void 0===Ab?null:Ab;Yb.f(Kb)?Z.formulaBarText=Kb:Z.formulaBarText="";ha=Fb.g(ha).Ab.Ref(Z.range);this.C1b(Z,eb,null,Qa,Db,ha);cb&&(Z.color=yb.e(Ga.a.VF(cb)));Z.cell.Yk=Ua;Z.cell.zoc=pa;Z.cell.zSd=Ua};d.prototype.jui=function(ha,Z,Na,eb,cb,Ua){var pa={};pa.a=this.$.ya.UserSessionId;pa.b=Z;pa.c=eb.Ranges.length;pa.d=this.$6g(eb.Ranges);
pa.e=cb.toString();pa.f=ha;pa.h=Ua;1890566896===ha?pa.g=Na.NumberFormat.toString():2105621672===ha&&(pa.g=Na.NumberFormatOptions.NumberFormatCategory.toString());qb.b().Ce(3,pa,!0)};d.prototype.$6g=function(ha){for(var Z=0,Na=0,eb=0,cb=0;cb<ha.length;cb++){var Ua=X.B(ha[cb]).EG;Z+=Ua;Ua>eb&&(eb=Ua,Na=cb)}ha=X.B(ha[Na]).toString();return"TotalCellCount:"+Z+"; Max range:"+ha+"; MaxRangeSize:"+eb+";"};d.prototype.hoj=function(ha,Z,Na){64===(Z.ValidMembers&64)&&this.setFillColor(ha,Z,Na);16===(Z.ValidMembers&
16)&&d.Kpj(ha,Z);128===(Z.ValidMembers&128)&&this.wua.jKb(ha,Z,ha.range);if(2===(Z.ValidMembers&2)||1===(Z.ValidMembers&1)){Na=Z.VerticalAlignment;Z=Z.HorizontalAlignment;var eb=0!==Z;ba.EwaSettings.isChangeGateEnabled("OfficeVSO:3603507_calculateHorizontalAlignmentOnToggle")&&!eb&&this.NYe(ha);this.wua.jcb(ha,Z,eb,Na)}};d.prototype.setFillColor=function(ha,Z,Na){(ba.EwaSettings.isChangeGateEnabled("OfficeVSO:3634588_NoFillColorOnConditionalFormattingCell")?ha.Xaa:ha.Xaa&&ha.ywb&&!ha.Bwb&&!ha.Gwb)||
(Z=-1===Z.FillColor?Na?Ga.a.VF(V.a.white):null:Ga.a.VF(V.a.WG(Z.FillColor)),ha.backgroundColor=Z?yb.e(Z):null)};d.prototype.fqj=function(ha,Z){0!==ha.horizontalAlignment&&2!==ha.horizontalAlignment||ha.t0(1,!1);0<=ha.indentation+Z.IndentationIncrease&&(ha.indentation+=Z.IndentationIncrease)};d.prototype.ioj=function(ha,Z,Na){var eb=ha.gS,cb=Z.TextOrientation;cb!==xa.a.verticalText&&(0>cb||180<cb)&&N.ULS.shipAssertTag(523090050,0,!1,"FormatCellsAction.setCellTextOrientation: invalid value for text orientation in server {0}",
cb);eb===cb||eb===xa.a.Htc&&cb===xa.a.Itc||eb===xa.a.Jtc&&cb===xa.a.Ktc?Z.TextOrientation=0:(ha.gS=Z.TextOrientation,Na||ha.t0(0<=ha.gS?1:3,!1))};d.prototype.NYe=function(ha){ha=this.D2a(ha.Nw,ha.cell.Yk,ha.cell.WAa,ha.cell.L$);return Object(za.b)(ha)?0:null!=ha.value.horizontalAlignment?ha.value.horizontalAlignment:0};d.prototype.qrj=function(ha,Z,Na){this.kx||(this.kx=new sa.a(Fb.g(this.$).Ea,this.$));this.kx.jKb(ha,Z,Na)};d.prototype.G2h=function(ha,Z){var Na=new ec.a;if(ha.cell.formulaBarText&&
ha.cell.formulaBarText.startsWith("'"))Na.Text=ha.cell.formulaBarText;else{var eb=ha.cellValue;eb&&4!==ha.cell.aM||(eb=ha.text);Na.Text=eb}this.AAa(Z,Na,!1,void 0,db.a.qgc(this.$));return!0};d.prototype.gQd=function(ha,Z){return this.tb&&!!ha&&!!Z};d.$_g=function(ha,Z,Na,eb){eb&&Z.setCell(!0);0===Na&&ha.Ea.lV()};d.expandRange=function(ha,Z){Z=Z.clone();Z.height<ha.height&&(Z.bottom=Z.top+ha.height-1);Z.width<ha.width&&(Z.right=Z.left+ha.width-1);return Z};d.Qdi=function(ha){switch(ha){case -1142465846:case -1150205178:case -286432209:case -571165336:case 1041132226:case -394785302:return!0;
default:return!1}};d.Kpj=function(ha,Z){Z=Z.Font;var Na=0!==(Z.ValidMembers&16),eb=0!==(Z.ValidMembers&16),cb=0!==(Z.ValidMembers&16);ha.bold=0!==(Z.ValidMembers&4);ha.italic=0!==(Z.ValidMembers&8);Na&&(ha.underline=Na);eb&&(ha.doubleUnderline=eb);cb&&(ha.fontStrikethrough=cb);Na=ba.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation");ha.CKb(Z.FontName,Na,"SetFont");ha.fontSize=Z.FontSize;Na=Ga.a.Oo(ha.color,ha.backgroundColor);V.a.compare(Na,V.a.red)&&(na.a.b5(ha.text)||
na.a.B5e(ha.text))||(Z=V.a.WG(Z.FontColor),ha.color=yb.e(Ga.a.VF(Z)))};Mf.Object.defineProperties(d.prototype,{wua:{configurable:!0,enumerable:!0,get:function(){return this.xCh}},lF:{configurable:!0,enumerable:!0,get:function(){return void 0===this.calcManager||null===this.calcManager?null:this.calcManager.lF}},localeInfo:{configurable:!0,enumerable:!0,get:function(){return void 0===this.calcManager||null===this.calcManager?null:this.calcManager.localeInfo}}});d.OAh=36;Object(u.a)(d,"FormatCellsAction",
null,[647,3]);var ma=H.a;Rk(c,ma);c.prototype.create=function(){this.pb(new d(this.$))};c.ka=function(ha){ha.da.Ga(18,new c(ha))};Object(u.a)(c,"FormatCellsActionFactory",H.a,[]);b.d(E,"a",function(){return a})},1363:function(u,E,b){function a(){A.a.Fa(c.ka)}function c(ha){var Z=ma.call(this)||this;Z.$=ha;x.EwaSettings.isChangeGateEnabled("OfficeVSO:6198510_AddServiceCreatedEvent")&&Z.Eb();return Z}function d(){}function e(ha,Z,Na,eb,cb){Na=void 0===Na?null:Na;eb=void 0===eb?null:eb;cb=void 0===cb?
0:cb;ha=l.call(this,ha,Z)||this;ha.lNa=null;ha.fec=Na||ab.a.current.Ro(103);ha.ikf=cb;ha.$3c=eb;ha.bBg();return ha}function k(ha,Z,Na,eb){ha=l.call(this,ha,Z)||this;ha.HBb=null;ha.Wmg=Na;ha.t5h=eb;ha.cBg();return ha}function l(ha,Z){var Na=Ob.call(this,ha)||this;Na.IBb=null;Na.Cfh=function(){Na.display()};Na.l8h=Math.max(1,Z);return Na}function n(ha,Z,Na,eb,cb,Ua,pa,Qa){Qa=void 0===Qa?"":Qa;var Db=ec.call(this)||this;Db.Vva=null;Db.I7e=!1;Db.Ykc=null;Db.Xkc=null;Db.buttons={};Db.rLe={};Db.$=ha;Db.svgIconProvider=
Z;Db.eHi=Na;Db.Ojd=eb;Db.Njd=cb;Db.altText=Ua;Db.ZFb=pa;Db.buttonText=Qa;return Db}function f(ha,Z,Na,eb,cb,Ua,pa,Qa){function Db(Ab){Fb.g(Ab)}var Kb=Wa.call(this,document.createElement("div"))||this;Kb.vif=null;Kb.HRd=!1;Kb.RRa=null;Kb.QMb=null;Kb.rN=function(){Kb.raiseEvent("OnObjectButtonMouseOver")};Kb.qN=function(){Kb.raiseEvent("OnObjectButtonMouseOut")};Kb.eBj=function(){Kb.cje()};Kb.$c=function(Ab){Kb.raiseEvent(Kb.ZFb,Ab);Kb.XFb();return!0};Kb.LIi=function(Ab){100<H.a(J.a.Ta,Kb.vif)&&Kb.khd(new Sys.UI.Point(Math.round(Ab.clientX),
Math.round(Ab.clientY)))};Kb.mN=function(Ab){Fb.g(Ab.Ca,!1);return!1};Kb.TY=Kb.je.tHa();Kb.set_visible(!1);Kb.Mhc=cb;Kb.ZFb=Ua;Kb.zlc=ha;Kb.q2b=Z;Kb.Mhc&&(Kb.RRa=T.a.instance.create(Kb.eBj,3E4,"OnObjectButton.ShyTimerFired",!1,!1));ha&&Kb.domElement.classList.add(ha);Kb.PZa=document.createElement("div");Kb.domElement.appendChild(Kb.PZa);Na&&Kb.PZa.classList.add(Na);eb&&(Kb.PZa.innerHTML=eb);pa&&(Kb.QMb=document.createElement("div"),Kb.domElement.appendChild(Kb.QMb),Kb.QMb.classList.add(Qa),Kb.QMb.innerText=
pa,Kb.domElement.style.padding="3px",ib.a.instance.ra(Q.a.pointerDown,Kb.domElement,Kb.mN));Kb.GZa=new zb.a(Kb.domElement,7);La.a.instance.ra(Q.a.click,Kb.domElement,Kb.$c);x.EwaSettings.isChangeGateEnabled("OfficeVSO:4996434_AvoidSelectionFromClickInOOUIPadding")&&ib.a.instance.ra(Q.a.pointerDown,Kb.domElement,Kb.mN);Kb.Ac.ka("mouseup",Db);Kb.Ac.ka("click",Db);Kb.Ac.ka("dblclick",Db);return Kb}function v(){}function r(ha,Z,Na,eb){var cb=y.call(this,ha,Z)||this;cb.w1a=null;cb.Pvf=function(){cb.bsc(cb.Pvf);
if(cb.Gk&&cb.Gk.length&&cb.contextMenuManager){var Ua=cb.contextMenuManager.wcd("autoFilterRichFieldList"),pa=window.document.getElementById(cb.w1a);Ua.x0(null,pa,cb,null,!0)}};cb.zkg=Na;cb.contextMenuManager=eb;return cb}function y(ha,Z){var Na=ta.call(this)||this;Na.XO=null;Na.Zub=null;Na.bdd=null;Na.OIb=null;Na.RTb=!1;Na.m3d=null;Na.gFd=!1;Na.BKi=function(eb,cb,Ua){D.ULS.sendTraceTag(25264350,0,10,"Call to GetRichValueFieldListContextList failed in: "+Ua);Na.OIb&&Na.OIb.stop();Na.XO=null;Na.raiseEvent(ua.k)};
Na.CKi=function(eb){da.a(eb)||(Na.OIb&&Na.OIb.stop(),Na.RTb=!1,Na.XO=eb.Result,Na.XO&&0<Na.XO.length&&D.ULS.sendTraceTag(25264351,0,50,"Retrieved {0} rich value field list context for autocomplete",Na.XO.length),Na.PVa=!0,Na.vqc())};Na.PVa=!1;Na.jb=ha;Na.DSb=-1;Na.tableManager=Z;Na.gFd=x.EwaSettings.isChangeGateEnabled("OfficeVSO:6395797_raiseFieldInfoLoadedEventOnEmptyResults")&&ia.a.SZ(ha);return Na}function m(ha){var Z=ja.call(this)||this;Z.firstElement=null;Z.jw=null;Z.RLa=!1;Z.ms=null;Z.fvj=
N.a.Nf;Z.Sxf=function(Na){var eb=Na.Ca.keyCode;return eb===M.a.Oh?Z.eJi():eb===M.a.Pz&&Na.Ca.shiftKey?Z.Qwh(Z.firstElement):!1};Z.uDf=function(Na){if(!Z.RLa||Na.Ca.keyCode!==M.a.jL)return!1;m.b7e();X.Task.delay(1).Io(function(){Z.jw.focus();return!0},0,Z.la);return!0};Z.KTi=function(){document.activeElement&&document.activeElement.id===Z.jw.id||(m.b7e(),X.Task.delay(1).Io(function(){Z.jw.focus();return!0},0,Z.la))};Z.Vvf=function(){Z.C9f(Z.jw)};Z.Rxf=function(Na){Na.stopPropagation();Na.preventDefault();
Z.RLa&&(Z.RLa=!1)};Z.$=ha;(ha=Z.$.ea.hc)&&D.ULS.sendTraceTag(39350791,0,50,"EmbedViewFocusControl: PermissionSet = {0}; InWebPart = '{1}', InEmbedView = '{2}'",ha.Jsa,ha.inWebPart?"Classic":"Non Classic",ha.inEmbedView?"True (+Modern)":"False (not Modern)");ha&&(ha.inWebPart||ha.inEmbedView)?D.ULS.sendTraceTag(537153856,0,15,"EwaControl.EmbedViewFocusControl: disable focus grabbing by embedded workbooks and disable some related keyboard navigation. InWebPart = '{0}', InEmbedView = '{1}'",ha.inWebPart?
"Classic":"Non Classic",ha.inEmbedView?"True (+Modern)":"False (not Modern)"):(Z.T5g(),Z.R6g(),C.KeyInputManager.instance.ra(Q.a.Lb,Z.$.domElement,Z.uDf));Z.$.da.Ga(238,Z);return Z}function w(ha,Z,Na,eb,cb){cb=void 0===cb?null:cb;var Ua=K.call(this)||this;Ua.tnb=null;Ua.COa=null;Ua.oYc=0;Ua.roc=null;Ua.pQi=function(){var pa=Ua.COa.HXe();D.ULS.sendTraceTag(537153861,0,50,"ActionAggregator<{0}>.OnRunningLong: Operation running for more than {1}ms",Ua.Zka,pa);Ua.roc=T.a.instance.create(Ua.q6,Math.max(Ua.jue-
pa,0),O.a.Rie)};Ua.q6=function(){D.ULS.sendTraceTag(537153860,0,50,"ActionAggregator<{0}>.OnTimeout: Operation running for more than {1}ms, timing out. Has pending actions: {2}",Ua.Zka,Ua.COa.HXe(),Ua.t5a);Ua.oYc++;Ua.oYc>Ua.iue&&D.ULS.sendTraceTag(537153859,0,50,"ActionAggregator<{0}>.OnTimeout: passed the allowed bypassed count",Ua.Zka);Ua.COa.mx.cancel();Ua.wSe()};Ua.f9a=function(){Ua.t5a&&D.ULS.sendTraceTag(537153858,0,50,"ActionAggregator<{0}>.OnDocumentUnhidden: Start. IsActionOngoing: {1}, AggregatedActionParams not null: {2}",
Ua.Zka,Ua.rLa,Ua.t5a);Ua.ild()};Ua.Syg=ha;Ua.Tyg=Z;Ua.documentVisibilityObserver=Na;Ua.Zka=eb;Ua.pO=cb;Na&&Ua.documentVisibilityObserver.cZb(Ua.f9a);Ua.nYc=!!Na&&x.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperation",!1);Ua.iue=x.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperationLimit",3);Z=x.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperationThresholdInMs",5E3);Ua.jue=ha.Gbd(Z);ha=
x.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperationLogThresholdInMs",1E3);Ua.aSg=Math.max(Ua.jue-Z,0)+ha;return Ua}function B(){this.startTime=J.a.Ta.Jb;this.mx=new U.a}var A=b(10);u=b(0);var z=b(232),x=b(1),D=b(14),I=b(214),F=b(79),G=b(37),T=b(47),O=b(44),U=b(738),J=b(28),H=b(119);B.prototype.HXe=function(){return H.a(J.a.Ta,this.startTime)};Object(u.a)(B,"OngoingAction",null,[]);var K=F.a;Rk(w,K);w.prototype.vFf=function(ha){D.ULS.sendTraceTag(537153864,0,
50,"ActionAggregator<{0}>.PerformThrottledAction: Start. IsActionOngoing: {1}, AggregatedActionParams not null: {2}",this.Zka,this.rLa,this.t5a);this.tnb=this.Tyg.nVc(ha,this.tnb);this.ild()};w.prototype.dispose=function(){this.documentVisibilityObserver&&this.documentVisibilityObserver.WHb(this.f9a);this.Ove();K.prototype.dispose.call(this)};w.prototype.pZf=function(ha){this.nYc?(this.COa=ha?new B:null,ha?this.startTimer():this.Ove()):this.COa=ha?{}:null};w.prototype.wSe=function(ha){ha=void 0===
ha?null:ha;this.nYc&&ha&&ha.YJ?D.ULS.sendTraceTag(537153863,0,50,"ActionAggregator<{0}>.FinishedCallback: timedout, skipping",this.Zka):(D.ULS.sendTraceTag(537153862,0,50,"ActionAggregator<{0}>.FinishedCallback: Start. IsActionOngoing: {1}, AggregatedActionParams not null: {2}",this.Zka,this.rLa,this.t5a),this.pZf(!1),this.ild())};w.prototype.ild=function(){var ha=this;if(!this.uLb()){var Z=this.tnb;this.tnb=null;this.pZf(!0);D.ULS.sendTraceTag(537153857,0,50,"ActionAggregator<{0}>.InternalPerformAction: Calling PerformAction.",
this.Zka);var Na=this.nYc?this.COa.mx.token:I.a.none;G.TaskExtensions.Aa(this.Syg.tCd(Z),function(){ha.wSe(Na)},Na,0,this.pO)}};w.prototype.uLb=function(){return!this.t5a||this.rLa?!0:this.documentVisibilityObserver&&this.documentVisibilityObserver.Ni?(D.ULS.sendTraceTag(593376846,0,50,"ActionAggregator<{0}>.ShouldThrottle: Not Calling PerformAction as document is hidden.",this.Zka),!0):!1};w.prototype.Ove=function(){this.roc&&this.roc.cancel()};w.prototype.startTimer=function(){this.oYc<=this.iue&&
(this.roc=T.a.instance.create(this.pQi,this.aSg,O.a.Rie))};Mf.Object.defineProperties(w.prototype,{rLa:{configurable:!0,enumerable:!0,get:function(){return!!this.COa}},t5a:{configurable:!0,enumerable:!0,get:function(){return!!this.tnb}}});Object(u.a)(w,"ActionAggregator",F.a,[996,3]);var N=b(27),M=b(86),C=b(109),Q=b(13),P=b(43),ka=b(38),R=b(19),fa=b(5),ca=b(129),ea=b(15),wa=b(21),X=b(58),ja=ka.a;Rk(m,ja);m.prototype.XEg=function(ha){this.addHandler("KBIS",ha)};m.prototype.Taj=function(ha){this.removeHandler("KBIS",
ha)};m.prototype.dispose=function(){this.firstElement&&P.a.removeHandler(this.firstElement,Q.a.focus,this.Vvf);this.ms&&this.ms.detach("focus");this.jw&&(P.a.removeHandler(this.jw,Q.a.focus,this.Rxf),P.a.removeHandler(this.jw,Q.a.blur,m.onBlur),C.KeyInputManager.instance.Ba(Q.a.Lb,this.jw,this.Sxf));C.KeyInputManager.instance.Ba(Q.a.Lb,this.$.domElement,this.uDf);this.ms=this.jw=this.firstElement=this.$=null;ja.prototype.dispose.call(this)};m.prototype.T5g=function(){this.fvj?(this.firstElement=document.documentElement,
this.ms=ca.a.instance.JG(document.parentWindow),this.ms.ka("focus",this.KTi)):(this.firstElement=m.BCe(),document.body.insertBefore(this.firstElement,document.body.childNodes[0]),P.a.addHandler(this.firstElement,Q.a.focus,this.Vvf))};m.prototype.R6g=function(){this.jw=m.BCe();this.jw.id=fa.a.GJe;this.jw.setAttribute(fa.a.Bt,ea.a.instance.ga(861));document.body.appendChild(this.jw);P.a.addHandler(this.jw,Q.a.focus,this.Rxf);P.a.addHandler(this.jw,Q.a.blur,m.onBlur);C.KeyInputManager.instance.ra(Q.a.Lb,
this.jw,this.Sxf)};m.prototype.Qwh=function(ha){this.C9f(ha);return!1};m.prototype.eJi=function(){this.RLa=!0;wa.g(this.$).focus();wa.g(this.$).ha.m4e();this.raiseEvent("KBIS");return!0};m.prototype.C9f=function(ha){this.RLa?this.RLa=!1:(this.RLa=!0,ha&&ha.focus())};m.BCe=function(){var ha=document.createElement("div");ha.tabIndex=0;return ha};m.b7e=function(){document.body.classList.add(R.a.iMe)};m.onBlur=function(){document.body.classList.remove(R.a.iMe)};Object(u.a)(m,"EmbedViewFocusControl",ka.a,
[995,3]);var va=b(4),ua=b(1284),Xa=b(60),aa=b(570),ba=b(24),oa=b(45),ra=b(388),db=b(177),Ka=b(255),Ga=b(121),xa=b(31),da=b(295),qa=b(294),na=b(62),ia=b(36),ta=ka.a;Rk(y,ta);y.prototype.eZb=function(ha){this.addHandler(ua.a,ha)};y.prototype.bsc=function(ha){this.removeHandler(ua.a,ha)};y.prototype.xEg=function(ha){this.addHandler(ua.k,ha)};y.prototype.Baj=function(ha){this.removeHandler(ua.k,ha)};y.prototype.dispose=function(){this.jb=null;this.qbb();ta.prototype.dispose.call(this)};y.prototype.uYi=
function(){var ha=Array(9);var Z={};Z.Name=ua.e;ha[0]=Z;Z={};Z.Name=ua.h;ha[1]=Z;Z={};Z.Name=ua.f;ha[2]=Z;Z={};Z.Name=ua.i;ha[3]=Z;Z={};Z.Name=ua.j;ha[4]=Z;Z={};Z.Name=ua.g;ha[5]=Z;Z={};Z.Name=ua.c;ha[6]=Z;Z={};Z.Name=ua.d;ha[7]=Z;Z={};Z.Name=ua.b;ha[8]=Z;Z={ColumnName:"",ColumnIndex:-1};Z.FieldInfoDataList=ha;ha=[];ha[0]=Z;this.ANd(ha)};y.prototype.lZ=function(ha,Z,Na,eb){eb=void 0===eb?null:eb;if(ha){this.fZc();this.r1b();var cb=null,Ua=!1,pa;if(pa=!eb)pa=this.wMj(ha,Z,Na),Ua=pa.i$a,cb=pa.Gk,pa=
pa.returnValue;if(pa)if(this.gFd||this.ANd(cb),this.RTb=!0,this.XO=cb,this.gFd){if(!Ua){this.PVa=!0;this.vqc();return}}else if(this.XO&&0<this.XO.length&&(this.PVa=!0,this.vqc()),!Ua)return;this.kcg(ha,eb,Z,Na,!1)}};y.prototype.kcg=function(ha,Z,Na,eb,cb){if(this.$.ea.dc){this.$.Fb&&(this.OIb=this.$.Fb.sc("WebServiceCall","GetRichValueFieldInfoListContext"));this.Zub=null;var Ua=this.$.oa.xa.Pb(),pa=this.$.oa.xa,Qa=this.CKi,Db=this.BKi,Kb=pa.Na(1,null);Kb.selectedRange=ha;Kb.richValueKeyPath=Z;Kb.singleColumn=
Na;Kb.searchForRange=eb;Kb.calculateMajorityDataType=cb;this.Zub=na.g(pa,"GetRichValueFieldListContextList",Kb,Qa,Db,null,Ua,4)}else this.XO=null};y.prototype.qbb=function(){this.XO=null;this.PVa=!1;this.fZc();this.r1b();this.Zub=null;this.DSb=-1};y.prototype.fZc=function(){y.vpb(this.Zub)};y.prototype.r1b=function(){y.vpb(this.bdd)};y.prototype.vqc=function(){this.raiseEvent(ua.a)};y.prototype.Vm=function(ha){ha=oa.D(ha);--ha.left;--ha.right;return this.tableManager.Vm(ha)};y.prototype.KJa=function(ha){var Z=
this;ha.FirstColumn=ha.FirstColumn;ha.LastColumn=ha.LastColumn;ha.FirstRow=ha.FirstRow;ha.LastRow=ha.LastRow;this.r1b();this.bdd=null;return ra.a(this.$.userOperationManager,function(Na,eb,cb){return Ka.h(Z.$.oa.xa,ha,qa.b(Na,function(Ua){Z.MKi(Ua)}),qa.a(eb,eb,function(Ua){Z.LKi(Ua)}),cb,null)},function(Na){return new db.a(264,0,Na,80)},null)};y.prototype.LKi=function(ha){ha=Ga.a.Mf(ha.data);D.ULS.sendTraceTag(525336847,0,10,"FieldInfoManager.OnGetFullTableRangeFailure - Webservice call failed with Errors: {0}",
xa.a.Ec(ha))};y.prototype.MKi=function(ha){if(da.a(ha))-315732528!==ha.Errors[0].MessageId&&D.ULS.sendTraceTag(525336846,0,10,"FieldInfoManager.OnGetFullTableRangeSuccess - Webservice call failed with Unexpected error : {0}",xa.a.Ec(ha.Errors));else if(ha&&ha.Result){ha=ha.Result;var Z=ha.HasHeaderRow;Z=new aa.AutofilterRange(ha.TableRange.FirstRow+(Z?1:0)+1,ha.TableRange.FirstColumn+1,ha.TableRange.LastRow+1,ha.TableRange.LastColumn+1,null,null,null,0,Z);this.DSb=ha.TableRange.FirstColumn;(ha=this.CIf(!1,
!0,Z))||D.ULS.sendTraceTag(525336844,0,50,"FieldInfoManager.OnGetFullTableRangeSuccess - fieldInfoListContextList is null");this.ANd(ha)}else D.ULS.sendTraceTag(525336845,0,10,"FieldInfoManager.OnGetFullTableRangeSuccess - Webservice call returned no result")};y.prototype.wMj=function(ha,Z,Na){var eb=null;var cb=!1;if(ha.SheetName!==this.$.ea.pa.sheetName)return{returnValue:!1,i$a:cb,KJa:!1,Gk:eb};this.DSb=-1;if(Na){var Ua=this.Vm(ha);if(!Ua||!Ua.Zaa)return{returnValue:!1,i$a:cb,KJa:!1,Gk:eb};var pa=
wa.g(this.$).Ab.G0e(Ua);this.m3d=Ua;if(x.EwaSettings.isChangeGateEnabled("OfficeVSO:5167298_ObtainFullRangeOfTableForPopulatingInsertDataDropdownCorrectly")&&pa&&0<pa.count)return--ha.FirstColumn,--ha.LastColumn,this.bdd=this.KJa(ha),{returnValue:!0,i$a:cb,KJa:!0,Gk:eb};Ua.top+=1;Ua.right=oa.D(ha).right-1}else Ua=new aa.AutofilterRange(ha.FirstRow+1,ha.FirstColumn+1,ha.LastRow+1,ha.LastColumn+1,null,null,null,0,!1);if(Ua.top>Ua.bottom||Ua.left>Ua.right)return{returnValue:!0,i$a:cb,KJa:!1,Gk:eb};ha=
wa.g(this.$);var Qa=ha.eb.width,Db=ha.eb.height;pa=ha.view.visibleArea;Qa=new Xa.a(pa.x-Qa,pa.y-Db,pa.width+Qa,pa.height+Db);Db=ha.fg(Ua);if(!pa||!Db||!ha.nhc(Ua))return{returnValue:!1,i$a:cb,KJa:!1,Gk:eb};Qa.contains(Db)||(cb=!0);eb=this.CIf(Z,Na,Ua);return{returnValue:!0,i$a:cb,KJa:!1,Gk:eb}};y.prototype.ANd=function(ha){ha&&D.ULS.sendTraceTag(25264348,0,50,"Retrieved {0} rich value field contexts from block cache",ha.length);this.RTb=!0;(this.XO=ha)&&0<this.XO.length&&(this.PVa=!0,this.vqc())};
y.prototype.CIf=function(ha,Z,Na){var eb=null;var cb=Na.clone();if(Z){Z=Na.right;for(var Ua=0;Z>=Na.left;--Z){cb.left=Z;cb.right=Z;var pa=this.VXe(cb,!0,Na.left);if(pa){eb||(eb=[]);eb[Ua]=pa;if(ha)break;++Ua}}}else if(ha=this.VXe(cb,!1))eb=[],eb[0]=ha;return eb};y.prototype.VXe=function(ha,Z,Na){Na=void 0===Na?0:Na;var eb=null;if(x.EwaSettings.isChangeGateEnabled("OfficeVSO:5723259_StoreRichValueFieldsInDictionary")){var cb=wa.g(this.$).Ab.EVh(ha);if(cb&&0<cb.count){var Ua=Array(cb.count),pa=0;cb=
bk(cb.values);for(eb=cb.next();!eb.done;eb=cb.next()){var Qa={};Qa.Name=eb.value;Ua[pa]=Qa;++pa}pa="";cb=-1;0<ha.top&&Z&&(ha=new ba.Range(ha.top-1,ha.left,ha.top-1,ha.left,!1,!1),null!=wa.g(this.$).Ub(ha)&&null!=wa.g(this.$).Ub(ha).originalText&&(pa=wa.g(this.$).Ub(ha).originalText),cb=ha.left-Na);eb={};eb.ColumnName=pa;eb.ColumnIndex=cb;eb.FieldInfoDataList=Ua}}else if((cb=wa.g(this.$).Ab.G0e(ha))&&0<cb.count){Ua=Array(cb.count);pa=0;cb=bk(cb);for(eb=cb.next();!eb.done;eb=cb.next())Qa={},Qa.Name=
eb.value,Ua[pa]=Qa,++pa;pa="";cb=-1;0<ha.top&&Z&&(ha=new ba.Range(ha.top-1,ha.left,ha.top-1,ha.left,!1,!1),pa=wa.g(this.$).Ub(ha).originalText,cb=ha.left-Na);eb={};eb.ColumnName=pa;eb.ColumnIndex=cb;eb.FieldInfoDataList=Ua}return eb};y.vpb=function(ha){ha&&va.AFrameworkApplication.qd.ku(ha.Dt)};Mf.Object.defineProperties(y.prototype,{Q5a:{configurable:!0,enumerable:!0,get:function(){return this.PVa}},Ksi:{configurable:!0,enumerable:!0,get:function(){return this.RTb}},iUe:{configurable:!0,enumerable:!0,
get:function(){return this.DSb}},X3c:{configurable:!0,enumerable:!0,get:function(){return this.m3d}},$:{configurable:!0,enumerable:!0,get:function(){return this.jb}},Gk:{configurable:!0,enumerable:!0,get:function(){return this.XO}},xNh:{configurable:!0,enumerable:!0,get:function(){return!!this.Zub}}});Object(u.a)(y,"FieldInfoManager",ka.a,[589,3]);Rk(r,y);r.prototype.HNh=function(ha,Z){this.w1a=Z;D.ULS.sendTraceTag(537153825,0,100,"FilterInfoManager.GetFilterFieldInfoListContextAsync - Retrieving the list of field list context for row, col, row, col ({0}, {1}, {2}, {3})",
ha.FirstRow,ha.FirstColumn,ha.LastRow,ha.LastColumn);this.kcg(ha,null,!0,!1,!0)};Mf.Object.defineProperties(r.prototype,{zG:{configurable:!0,enumerable:!0,get:function(){return this.zkg}}});Object(u.a)(r,"FilterInfoManager",y,[590,589,3]);var za=b(1050),sa=b(1295),V=b(29),Ia=b(89),Ha=b(8);v.Nqh="ewa-sharedUi-launchButton";v.Qqh="ewa-sharedUi-launchButtonWithText";v.Oqh="ewa-sharedUi-launchButtonClick";v.Rqh="ewa-sharedUi-launchButtonWithTextClick";v.Pqh="ewa-sharedUi-launchButtonText";Object(u.a)(v,
"CssClassNames",null,[]);var ob=b(64);b(565);var ib=b(245),La=b(233);ka=b(244);var zb=b(297),Fb=b(69),Yb=b(11),kb=b(259),vb=b(33),Wa=ka.a;Rk(f,Wa);f.prototype.p2=function(ha){this.addHandler(this.ZFb,ha)};f.prototype.dda=function(ha){this.get_events().removeHandler(this.ZFb,ha)};f.prototype.nFg=function(ha){this.addHandler("OnObjectButtonMouseOver",ha)};f.prototype.jbj=function(ha){this.get_events().removeHandler("OnObjectButtonMouseOver",ha)};f.prototype.mFg=function(ha){this.addHandler("OnObjectButtonMouseOut",
ha)};f.prototype.ibj=function(ha){this.get_events().removeHandler("OnObjectButtonMouseOut",ha)};f.prototype.sbg=function(ha){ha&&(this.PZa.innerHTML=ha)};f.prototype.LPj=function(ha,Z,Na){this.PZa.innerHTML="";ha?ha.iba(Z,16,16,this.PZa,16,16,void 0,Na):D.ULS.sendTraceTag(537153824,0,10,"OnObjectButton.UpdateButtonSvgImage: Called without svgIconProvider")};f.prototype.MPj=function(ha,Z){ha&&(this.QMb.innerText=ha);this.domElement.title=Z};f.prototype.dispose=function(){this.get_isInitialized()&&
(this.hide(),this.Ac.oC(),Ia.a.oc([this.TY,this.GZa]),La.a.instance.Ba(Q.a.click,this.domElement,this.$c),ib.a.instance.Ba(Q.a.pointerDown,this.domElement,this.mN),this.RRa&&this.RRa.dispose(),Wa.prototype.dispose.call(this))};f.prototype.obb=function(){this.q2b&&this.domElement.classList.remove(this.q2b);this.zlc&&this.domElement.classList.add(this.zlc)};f.prototype.XFb=function(){this.zlc&&this.domElement.classList.remove(this.zlc);this.q2b&&this.domElement.classList.add(this.q2b);this.K1a()};f.prototype.K1a=
function(){this.Mhc&&(this.RRa.cancel(),this.D5f(),this.setOpacity(1));this.set_visible(!0)};f.prototype.hp=function(ha,Z,Na,eb,cb){cb=void 0===cb?!1:cb;ha=vb.a(eb).hi(ha);Z=vb.a(eb).hi(Z);vb.a(eb).Hvc(this.domElement);this.domElement.style.top=Yb.HelperMethods.jc(Z);this.domElement.style.left=this.domElement.style.right="";Z=ha;cb&&(Z=ha-this.domElement.offsetWidth);kb.c(this.domElement.style,Na,Yb.HelperMethods.jc(Z));this.set_visible(!0);this.setOpacity(1);this.Mhc&&(this.HRd=!1,this.UDj(),this.RRa.Hq())};
f.prototype.hide=function(){this.obb();this.set_visible(!1);this.Mhc&&(this.D5f(),this.RRa.cancel())};f.prototype.w7b=function(){this.Ac.ka("mouseover",this.rN,!0);this.Ac.ka("mouseout",this.qN,!0)};f.prototype.UDj=function(){this.TY.Ym("mousemove")||this.TY.ka("mousemove",this.LIi)};f.prototype.D5f=function(){this.TY.Ym("mousemove")&&this.TY.detach("mousemove")};f.prototype.khd=function(ha){if(this.domElement.parentNode){var Z=Sys.UI.DomElement.getBounds(this.domElement),Na=new Sys.UI.Point(Math.round(Z.x+
Z.width),Math.round(Z.y+Z.height));Z=Math.abs(Na.x-ha.x);ha=Math.abs(Na.y-ha.y);ha=Z>ha?Z:ha;this.HRd?this.setOpacity(f.eTg(ha)):100>=ha&&this.cje()}};f.prototype.cje=function(){this.HRd=!0;this.RRa.cancel()};f.prototype.setOpacity=function(ha){N.a.setOpacity(this.domElement,ha);this.vif=J.a.Ta.Jb};f.eTg=function(ha){return 100>=ha?1:250<=ha?0:.01*(100-(ha-100)/150*100)};Object(u.a)(f,"OnObjectButton",ka.a,[982,72,3]);var qb=b(1003),yb=v.Pqh,ec=F.a;Rk(n,ec);n.prototype.dispose=function(){this.Sfh();
this.$=null;ec.prototype.dispose.call(this)};n.prototype.getButton=function(ha,Z){return this.Jua(ha,void 0===Z?!0:Z)};n.prototype.Jua=function(ha,Z){var Na=ha.toString();Na in this.buttons||this.T6g(ha,void 0===Z?!0:Z);return this.buttons[Na]};n.prototype.hp=function(ha,Z,Na,eb,cb,Ua){cb=void 0===cb?!0:cb;Ua=void 0===Ua?!1:Ua;this.hide();if(this.$.ea.isNamedObjectViewMode&&ob.i(this.$.pa)){var pa=wa.g(this.$).LR.domElement,Qa=ha+this.buttonWidth-pa.scrollWidth;pa=Z+this.buttonWidth-pa.scrollHeight;
ha=0<Qa?ha-Qa:ha;Z=0<pa?Z-pa:Z}this.Jua(eb,cb).hp(ha,Z,Na,this.$,Ua)};n.prototype.hide=function(){var ha=this.buttons,Z;for(Z in ha)ha[Z].hide()};n.prototype.w7b=function(ha,Z){!this.I7e&&(Z=this.buttons[Z.toString()])&&(this.Ykc=function(Na,eb){ha(eb,!0)},Z.nFg(this.Ykc),this.Xkc=function(Na,eb){ha(eb,!1)},Z.mFg(this.Xkc),this.I7e=!0,Z.w7b())};n.prototype.T6g=function(ha,Z){function Na(Ua,pa){eb.eHi(pa,ha)}var eb=this;this.Vva=String.format(this.Ojd===R.a.k8b?'<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>':
'<img class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1"/>',V.a.zg(this.Ojd),V.a.zg(this.Njd),"{0}");var cb=String.format(this.Vva,V.a.zg(this.altText));Z=new f(""===this.buttonText?v.Nqh:v.Qqh,""===this.buttonText?v.Oqh:v.Rqh,R.a.IA,cb,Z,this.ZFb,this.buttonText,yb);Z.p2(Na);this.buttons[ha.toString()]=Z;this.rLe[ha.toString()]=Na;cb=wa.g(this.$).Cf(ha);cb.domElement.insertBefore(Z.domElement,cb.domElement.firstChild)};n.prototype.Sfh=function(){for(var ha=bk(qb.a(this.buttons)),Z=ha.next();!Z.done;Z=
ha.next()){Z=Z.value;var Na=this.buttons[Z];Na.dda(this.rLe[Z]);Ia.a.Ia(Na);delete this.buttons[Z];this.Ykc&&Na.jbj(this.Ykc);this.Xkc&&Na.ibj(this.Xkc)}};n.prototype.domElement=function(ha){return this.Jua(ha).domElement};n.prototype.K1a=function(ha){this.Jua(ha).K1a()};n.prototype.oOb=function(ha,Z,Na){Na=void 0===Na?!0:Na;this.Vva=String.format('<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>',V.a.zg(this.Ojd),V.a.zg(this.Njd),"{0}");ha=String.format(this.Vva,
V.a.zg(ha));this.Jua(Z,Na).sbg(ha)};n.prototype.qTa=function(ha,Z,Na){this.Jua(Na,!1).MPj(ha,Z)};n.prototype.hcg=function(){var ha=void 0===ha?!1:ha;this.Vva=String.format('<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>',"{0}",V.a.zg(this.Njd),"{1}");var Z=String.format(this.Vva,void 0,V.a.zg(void 0));this.Jua(void 0,ha).sbg(Z)};n.prototype.icg=function(ha,Z,Na){this.Jua(Na,!1).LPj(this.svgIconProvider,ha,Z)};Mf.Object.defineProperties(n.prototype,{dz:{configurable:!0,
enumerable:!0,get:function(){return vb.a(this.$).PFa(Ha.a.FOi)}},R1b:{configurable:!0,enumerable:!0,get:function(){return Ha.a.EOi}},buttonWidth:{configurable:!0,enumerable:!0,get:function(){return vb.a(this.$).PFa(Ha.a.GOi)}}});Object(u.a)(n,"OnObjectLaunchButton",F.a,[957,3]);F=b(94);var Ob=F.a;Rk(l,Ob);l.prototype.dispose=function(){Ia.a.Ia(this.IBb);this.IBb=null;Ob.prototype.dispose.call(this)};l.prototype.fSa=function(){Ia.a.Ia(this.IBb);this.IBb=T.a.instance.create(this.Cfh,this.l8h,O.a.Osi)};
l.prototype.zdb=function(){Ia.a.Ia(this.IBb);this.hide()};Object(u.a)(l,"LoadingIndicatorBehavior",F.a,[981,3]);Rk(k,l);k.prototype.dispose=function(){this.HBb=null;l.prototype.dispose.call(this)};k.prototype.display=function(){this.Wmg(this.HBb)};k.prototype.hide=function(){this.t5h(this.HBb)};k.prototype.cBg=function(){this.HBb=document.createElement("div");this.domElement.appendChild(this.HBb)};Object(u.a)(k,"ShimmerLoadingIndicatorBehavior",l,[]);var Cb=b(71),ab=b(53),ya=b(12);Rk(e,l);e.prototype.dispose=
function(){this.lNa=null;l.prototype.dispose.call(this)};e.prototype.display=function(){ya.DOMElementExtensions.setVisible(this.lNa,!0)};e.prototype.hide=function(){ya.DOMElementExtensions.setVisible(this.lNa,!1)};e.prototype.bBg=function(){this.lNa=document.createElement("div");this.lNa.classList.add(Cb.a.nph);var ha=document.createElement("div");ha.classList.add(Cb.a.oph);this.$3c&&""!=this.$3c&&ha.classList.add(this.$3c);var Z=0===this.ikf?"":ea.a.instance.ga(this.ikf),Na=String.format('<div class="'+
Cb.a.pph+'">{0}</div>',Z);this.fec?(Z=String.format('<img src="{0}" alt="{1}" title="{1}"/>',this.fec,Z),ha.innerHTML=Z+Na):ha.innerHTML=Na;this.lNa.appendChild(ha);this.domElement.appendChild(this.lNa)};Object(u.a)(e,"SpinnerLoadingIndicatorBehavior",l,[]);d.prototype.b3c=function(ha,Z,Na){return new za.a(ha,Z,Na)};d.prototype.t4b=function(ha,Z,Na,eb,cb,Ua,pa,Qa,Db,Kb){return new sa.a(ha,Z,Na,eb,cb,Ua,pa,Qa,Db,Kb)};d.prototype.orb=function(ha,Z,Na,eb,cb){return new e(ha,Z,Na,eb,void 0===cb?0:cb)};
d.prototype.Ged=function(ha){return ha.da.za(238)||new m(ha)};d.prototype.x4b=function(ha,Z,Na,eb,cb,Ua,pa,Qa){return new n(ha,Z,Na,eb,cb,Ua,pa,void 0===Qa?"":Qa)};d.prototype.E2c=function(ha,Z){return new y(ha,Z)};d.prototype.O5g=function(ha,Z,Na,eb){return new r(ha,Z,Na,eb)};d.prototype.k2c=function(ha,Z,Na,eb){return new w(ha,Z,Na,eb)};Object(u.a)(d,"SharedUIControlsFactory",null,[924]);var ma=z.a;Rk(c,ma);c.prototype.create=function(){x.EwaSettings.xl()?this.pb(this.$.da.za(12)||new d):this.pb(new d)};
c.ka=function(ha){ha.da.Ga(477,new c(ha))};Object(u.a)(c,"SharedUIControlsFactoryServiceFactory",z.a,[]);b.d(E,"a",function(){return a})},1366:function(u,E,b){function a(){m.a.Fa(c.ka);m.a.Fa(y.ka)}function c(pa){return Ua.call(this,pa)||this}function d(pa,Qa,Db,Kb,Ab,ub,Mb){var Aa=this;this.$=pa;this.gridView=Qa;this.Fg=Db;this.rB=Kb;this.borderFormatManager=Ab;this.moreColorsHelper=ub;this.fontDropdownHelper=Mb;this.xA=null;this.WZa=1461300262;this.Zw=this.TZa=this.q8a=this.e$b=null;this.JMi=function(Za,
Zb){if(!na.a(Za)&&Zb){var jb=!!Za&&!!Za.RequestTelemetryData;Yb.g(Aa.$).si.dla(Zb,Za.StateId,jb?Za.RequestTelemetryData.EcsOperationDuration:0,jb?Za.RequestTelemetryData.EcsRequestDuration:0,jb?Za.RequestTelemetryData.WfeRequestDuration:0)}};this.Spb=function(){if(Aa.gridView.U5a){var Za=Aa.$.da.za(254,!0);Za&&Za.xbj(Aa.Spb);Aa.gridView.U5a=!1;Aa.gridView.hg.vo(fa.a.m4);Aa.gridView.ha.rW(Aa.Iad);Yb.g(Aa.$).$.hf()}};this.Iad=function(){var Za=Aa.e$b;Aa.e$b=ea.d(Aa.$.va.pa);if(Za===Aa.e$b)if(Aa.gridView.ha.rW(Aa.Iad),
(Za=Aa.$.da.za(254,!0))&&Za.VYc(36,Yb.g(Aa.$).ha.sa.selectedRanges)){Za=new xa.a(1804571062,2,2,0,null);var Zb={};Aa.$.Ka.Kb(Za,(Zb[fa.a.skipClipboardAccess]=!0,Zb[fa.a.y_c]=!0,Zb[fa.a.isFormatPainter]=!0,Zb)).continueWith(function(){Aa.Spb()})}else Aa.gridView.hg.GG(!1)};this.tb=z.EwaSettings.tb();this.Jkc=new e(this.$,Db);this.JC=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1);this.Am=z.EwaSettings.Am();this.$m=eb.a.$m()}function e(pa,Qa){this.$=pa;this.Fg=Qa;this.kx=
new Fb.a(Yb.g(this.$).Ea,this.$);this.Nef=z.EwaSettings.isChangeGateEnabled("OfficeVSO:5412627_MergeCellRangeBorderScenariosTelemetry");this.xyb=z.EwaSettings.isChangeGateEnabled("OfficeVSO:5607672_MergeCellCseForOutOfViewPortCells");this.aod=z.EwaSettings.isChangeGateEnabled("OfficeVSO:5658006_MergeCellCSEBugFixesforCellStylesAndRTL");this.Bgc=z.EwaSettings.isChangeGateEnabled("OfficeVSO:5954689_MergeCellCSEUnmergewithMergeCommand");this.Kcf=z.EwaSettings.isChangeGateEnabled("OfficeVSO:6013788_MergeCellHighGetRangeNumbersTelemetry");
this.Jfi=z.EwaSettings.isChangeGateEnabled("OfficeVSO:6100978_MergeCellCSEIsCsePossibleForWrapTextWrongValueForUnmergeCommandFix");this.Ogf=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellUnmergeWithBorderScenariosCse",!1);this.mhc=z.EwaSettings.isChangeGateEnabled("OfficeVSO:6147046_MergeCellCSERangeBorderScenarioFix");this.nzb=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellMultipleBlocksScenarioCse",!1);this.Cgc=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellBorderScenarioCse",
!1);this.Xii=z.EwaSettings.isChangeGateEnabled("OfficeVSO:6327711_MergeCellMultiBlockUnmergeBitFix");this.Qfi=z.EwaSettings.isChangeGateEnabled("OfficeVSO:6350260_MergeCellCSEDataLossScenarioUnmergeConditionFix");this.Haf=z.EwaSettings.isChangeGateEnabled("OfficeVSO:6209366_MergeCellCSECellFormatAssertFix");this.Hcf=z.EwaSettings.isChangeGateEnabled("OfficeVSO:6402649_HiddenCellsAvoidCseFixEnabled");this.mji=z.EwaSettings.isChangeGateEnabled("OfficeVSO:6476102_MergeCellCSEMultiBlockMergeFlagsFix")}
function k(){this.scenario=0;this.nQ=null}function l(){this.qQa=this.nGa=this.$Ma=this.PSa=0}function n(pa,Qa,Db,Kb){this.targetSheetRange=this.sourceSheetRange=null;this.fillRangeDirection=this.fillRangeType=0;this.sourceSheetRange=pa;this.targetSheetRange=Qa;this.fillRangeType=Db;this.fillRangeDirection=Kb}function f(pa,Qa,Db){var Kb=ib.call(this,pa)||this;Kb.zl=null;Kb.x5c=0;Kb.jbi=function(Ab,ub){if(0===Ab)F.ULS.sendTraceTag(574993491,0,50,"InsertDeleteCellsDialog.InsertDeleteCellsDialogHandler: User pressed Cancel");
else{Ab={};var Mb="",Aa=1035996630;switch(ub.selectedKey){case 0:Mb=1896159024===Kb.mr?"InsertCellsShiftRight":"DeleteCellsShiftLeft";break;case 1:Mb=1896159024===Kb.mr?"InsertCellsShiftDown":"DeleteCellsShiftUp";break;case 2:1896159024===Kb.mr?(Mb="InsertRows",Aa=-1113896058):(Mb="DeleteRows",Aa=1554436520);break;case 3:1896159024===Kb.mr?(Mb="InsertColumns",Aa=1415868706):(Mb="DeleteColumns",Aa=674605324)}F.ULS.sendTraceTag(574993490,0,50,"InsertDeleteCellsDialog.InsertDeleteCellsDialogHandler: Handle RibbonCommand.InsertOrDeleteCells, MenuItemId:{0}",
Mb);ub=new xa.a(Aa,1,2,8,null);Ab[wa.a.Nc]=Mb;Kb.$.Ka.Kb(ub,Ab)}};Kb.mr=Qa;Kb.selectedRanges=Db;pa=Object(Ia.a)(Ha.a,Kb.$.va.pa);Kb.isRtl=pa.displayRtl;return Kb}function v(pa,Qa,Db,Kb,Ab){this.zTe=0;this.hog=pa;this.iog=Qa;this.vwg=Db;this.GWb=Kb;this.zTe=void 0===Ab?0:Ab}function r(pa){this.insertDeleteMultiRangeParameters=null;this.insertDeleteMultiRangeParameters=pa}function y(pa){var Qa=D.call(this)||this;Qa.$=pa;Qa.Eb();return Qa}var m=b(10);u=b(0);var w=b(232),B=b(51),A=b(37),z=b(1),x=b(1018),
D=w.a;Rk(y,D);y.prototype.create=function(){var pa=this,Qa=B.GetServiceTaskFactory.create(this.$.da,18,this.la,this.hb),Db=B.GetServiceTaskFactory.create(this.$.da,102,this.la,this.hb);A.TaskExtensions.Aa(A.TaskExtensions.Vd([Qa,Db],this.la),function(){pa.pb(pa.$.da.za(296)||pa.$.da.Ga(296,new x.BorderFormatManager(pa.$,Qa.result,Db.result)))},this.la,3)};y.ka=function(pa){z.EwaSettings.isChangeGateEnabled("OfficeVSO:5680290_AddBorderFormatManagerFactory")&&pa.da.Ga(468,new y(pa))};Object(u.a)(y,
"BorderFormatManagerFactory",w.a,[]);var I=b(905),F=b(14),G=b(276),T=b(178),O=b(1033),U=b(27),J=b(39),H=b(29),K=b(96),N=b(273),M=b(369),C=b(366),Q=b(99),P=b(202),ka=b(8),R;(function(pa){pa[pa.insert=1]="insert";pa[pa.delete=2]="delete";pa[pa.rows=4]="rows";pa[pa.columns=8]="columns";pa[pa.cellsShiftHorizontal=16]="cellsShiftHorizontal";pa[pa.cellsShiftVertical=32]="cellsShiftVertical";pa[pa.insertRows=5]="insertRows";pa[pa.insertColumns=9]="insertColumns";pa[pa.insertCellsShiftRight=17]="insertCellsShiftRight";
pa[pa.insertCellsShiftDown=33]="insertCellsShiftDown";pa[pa.deleteRows=6]="deleteRows";pa[pa.deleteColumns=10]="deleteColumns";pa[pa.deleteCellsShiftLeft=18]="deleteCellsShiftLeft";pa[pa.deleteCellsShiftUp=34]="deleteCellsShiftUp"})(R||(R={}));Object(u.b)("InsertDeleteCellFlags",R);var fa=b(5),ca=b(447),ea=b(64),wa=b(76);Object(u.a)(r,"MacroRecorderRangeInsertedOrDeletedPayload",null,[438]);var X=b(1282),ja=b(45),va=b(564),ua=b(388),Xa=b(177),aa=b(62),ba=b(255),oa=b(151),ra=b(492),db=b(114),Ka=b(53),
Ga=b(203),xa=b(91),da=b(34),qa=b(31),na=b(295),ia=b(268),ta=b(11),za=b(186),sa=b(22),V=b(294);v.IQg=function(pa,Qa){return new v(pa,Qa,null,null,null)};v.fYc=function(pa,Qa){return new v(pa,null,Qa,null,null)};v.JQg=function(pa,Qa){return new v(pa,null,null,Qa,null)};v.HQg=function(pa,Qa,Db){return new v(pa,null,Qa,null,Db)};Mf.Object.defineProperties(v.prototype,{Pia:{configurable:!0,enumerable:!0,get:function(){return this.hog}},formattedText:{configurable:!0,enumerable:!0,get:function(){return this.iog}},
style:{configurable:!0,enumerable:!0,get:function(){return this.vwg}},size:{configurable:!0,enumerable:!0,get:function(){return this.GWb}},zaa:{configurable:!0,enumerable:!0,get:function(){return this.zTe}}});Object(u.a)(v,"CachedPreviewCellGroup",null,[]);var Ia=b(85);w=b(389);var Ha=b(101),ob=b(15),ib=w.a;Rk(f,ib);f.prototype.rg=function(){1896159024===this.mr?(this.zl=ob.a.instance.ga(23),this.x5c=0):(this.zl=ob.a.instance.ga(22),this.x5c=1);var pa=this.selectedRanges[0].YZ&&!this.selectedRanges[0].m5?
0:1;this.Rb=1;var Qa={};pa=(Qa[f.Vv]=this.nc,Qa.dialogToDisplay=this.x5c,Qa.defaultSelectedKey=pa,Qa.isRtl=this.isRtl,Qa);this.initializeAndShow(this.zl,this.jbi,pa)};Mf.Object.defineProperties(f.prototype,{nc:{configurable:!0,enumerable:!0,get:function(){return"InsertDeleteCellsDialog"}}});Object(u.a)(f,"InsertDeleteCellsDialog",w.a,[]);Object(u.a)(n,"MacroRecorderRangeFilledPayload",null,[438]);var La=b(7),zb=b(24);Object(u.a)(l,"RangeBorders",null,[]);Object(u.a)(k,"ScenarioInfo",null,[]);var Fb=
b(1117),Yb=b(21),kb=b(274),vb=b(217),Wa=b(77);e.prototype.dispose=function(){this.$=null};e.prototype.Pfi=function(pa,Qa){return!(void 0===Qa||null===Qa)&&!!(Qa.scenario&16384)&&!this.Rfi(pa,Qa)&&this.Aaf(Qa,pa)};e.prototype.GZe=function(){var pa=J.a.me(),Qa=Yb.g(this.$),Db=Qa.ha.sa.selectedRanges,Kb=0,Ab=0,ub=Db.length,Mb=new k;if(1<ub)return Mb.scenario=4,Mb;if(this.Hcf&&Qa.Oe.tef(Db[0]))return Mb.scenario=262144,Mb;this.aod&&Yb.g(this.$).rtl&&(Kb|=65536);if(!Qa.QQ(Db[0]))if(this.xyb)Kb|=32;else return Mb.scenario=
32,Mb;if(Qa=Qa.Ea.RJa(Db[0],this.$.activeItemName))for(Mb.AXc=Qa,Qa=bk(Qa),ub=Qa.next();!ub.done;ub=Qa.next())if(Ab+=1,1<Ab){this.xyb?(Kb|=256,Mb.scenario=Kb):Mb.scenario=256;if(!this.nzb)return Mb;break}Ab=Yb.g(this.$).Ea.Eua(Db[0]);if(!Ab)return Mb.scenario=32768,Mb;Qa=Ab.length;Db=Db[0];ub=Db.bottom-Db.top+1;for(var Aa=Db.right-Db.left+1,Za=new l,Zb=0;Zb<Qa;Zb++)if(this.Nef&&this.sUh(Ab[Zb],Db,Za),Kb=Kb|(void 0!==Ab[Zb].text&&null!==Ab[Zb].text&&""!==Ab[Zb].text?1:0)|(Ab[Zb].QM?2:0)|(Ab[Zb].Ava?
8:0)|(Ab[Zb].zwb?16:0)|(Ab[Zb].ME?64:0)|(Ab[Zb].Xaa?128:0),void 0!==Ab[Zb].text&&null!==Ab[Zb].text&&""!==Ab[Zb].text||Ab[Zb].Ava)if(void 0===Mb.nQ||null===Mb.nQ)Mb.nQ=Yb.g(this.$).Ub(Ab[Zb].getRange());else{if(Ab[Zb].getRange().top<Mb.nQ.range.top||Ab[Zb].getRange().top==Mb.nQ.range.top&&Ab[Zb].getRange().left<Mb.nQ.range.left)Mb.nQ=Yb.g(this.$).Ub(Ab[Zb].getRange());Kb|=16384}this.Nef&&(Za.PSa===Aa&&(Kb|=512),Za.nGa===Aa&&(Kb|=2048),Za.$Ma===ub&&(Kb|=4096),Za.qQa===ub&&(Kb|=1024),0<Za.PSa&&Za.PSa<
Aa||0<Za.nGa&&Za.nGa<Aa||0<Za.$Ma&&Za.$Ma<ub||0<Za.qQa&&Za.qQa<ub)&&(Kb|=8192);!z.EwaSettings.isChangeGateEnabled("OfficeVSO:6217608_Add_Entire_Row_Column_Selection_flag")||Db.right!==Db.maxColumns&&Db.bottom!==Db.maxRows||(Kb|=131072);pa=J.a.me()-pa;F.ULS.sendTraceTag(537159424,0,50,"Execution time of GetMergeCellScenario is : {0}",pa);Mb.scenario=Kb;return Mb};e.prototype.Qof=function(pa,Qa){var Db=pa.command;if(void 0===Qa||null===Qa)Qa=this.GZe();if(!this.Aaf(Qa,Db))return!1;pa=Yb.g(this.$).ha.sa.selectedRanges;
var Kb=Yb.g(this.$).Ea.Eua(pa[0]);if(!Kb)return!1;if(z.EwaSettings.isChangeGateEnabled("OfficeVSO:5993850_HandleSingleCellMergeScenario")&&1===Kb.length&&!Kb[0].QM)return-167499203===Db?(Kb[0].t0(2,!0),!0):!1;Kb=Yb.g(this.$).ha.sa.Vs;var Ab=this.$.pa.sheetName,ub=!0;switch(Db){case -167499203:2===(Qa.scenario&2)&&this.Bgc?this.vag(Qa.scenario,pa,Db):ub=this.yzi(Qa,pa);break;case 1097660126:(Qa=this.Rof(Qa,pa))&&0!=Qa.length||(ub=!1);break;case 155820588:this.vag(Qa.scenario,pa,Db);break;default:return!1}Yb.g(this.$).aV(pa,
Kb,Ab,null,pa[0],null,null,0,"MergeCellCommandAction");return this.nzb?ub:!0};e.prototype.Aaf=function(pa,Qa){var Db=this.Bei(pa,Qa);if(!this.Kcf)return Db;var Kb=Yb.g(this.$).ha.sa.selectedRanges[0].aB(!1);F.ULS.sendTraceTag(526149324,0,50,"Merge Cell Command: {0}; Scenario Number: {1}; IsCSEPossible result: {2}; Range: {3}",Qa.toString(),pa.scenario,Db,Kb);return Db};e.prototype.Bei=function(pa,Qa){if(-255094134===Qa)return!1;var Db=pa.scenario;if(this.Hcf&&262144===Db||this.aod&&65536===(Db&65536))return!1;
if(this.Ngf(Qa,pa))return this.vni(Qa,pa);this.xyb&&32===(Db&32)&&(Db&=-33);if(256==(Db&256))if(this.lji(pa))Db&=-257;else return!1;return 32768===Db||4===Db||128===(Db&128)||!this.xyb&&32===Db?!1:-167499203!=Qa&&1097660126!==Qa||!this.Old(pa)?void 0!==pa.nQ&&null!==pa.nQ&&pa.nQ.vea?!1:0===Db?!0:16384===(Db&16384)?z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellDataLossScenarioCse",!1):1!==(Db&1)&&8!==(Db&8)||!z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellContentScenarioCse",
!1)?!1:!0:this.Cgc};e.prototype.Dgi=function(pa){return 131072===(pa.scenario&131072)?!0:!1};e.prototype.lji=function(pa){if(!this.nzb)return!1;var Qa="Multi block",Db=!0;this.Old(pa)&&(Qa+=" with border",Db=!1);this.Dgi(pa)&&(Db=!1,Qa+=" with entire row or column selected",16384===(pa.scenario&16384)&&(Qa+=" and a data loss scenario"));Db||F.ULS.sendTraceTag(523511383,0,50,"CSE for {0}, is not enabled",Qa);return Db};e.prototype.Old=function(pa){return 16===(pa.scenario&16)||this.Jhd(pa.scenario)||
this.bid(pa.scenario)||this.Thd(pa.scenario)||this.fid(pa.scenario)||8192===(pa.scenario&8192)?!0:!1};e.prototype.Rfi=function(pa,Qa){return this.Qfi?this.Ngf(pa,Qa):155820588===pa};e.prototype.Ngf=function(pa,Qa){return 155820588===pa||(-167499203===pa||1097660126===pa)&&2===(Qa.scenario&2)&&this.Bgc?!0:!1};e.prototype.uni=function(pa){return this.fid(pa.scenario)||this.Thd(pa.scenario)||this.Jhd(pa.scenario)||this.bid(pa.scenario)?!0:!1};e.prototype.vni=function(pa,Qa){if(1097660126===pa&&2===(Qa.scenario&
2)||this.Jfi&&void 0!==Qa.nQ&&null!==Qa.nQ&&Qa.nQ.vea)return!1;this.xyb&&32===(Qa.scenario&32)&&(Qa.scenario&=-33);return 32768===Qa.scenario||4===Qa.scenario||256===(Qa.scenario&256)&&this.Xii||128===(Qa.scenario&128)?!1:2===(Qa.scenario&2)?this.uni(Qa)?z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellUnmergeWithBorderScenariosCse",!1):z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellUnmergeWithoutBorderScenariosCse",!1):!1};e.prototype.sUh=function(pa,Qa,
Db){var Kb=pa.getRange();if(Kb.top===Qa.top)if(pa.FKa)Db.PSa+=Kb.right-Kb.left+1;else{var Ab=this.kx.rQ(Kb,0);if(Ab){var ub=bk(Ab);for(Ab=ub.next();!Ab.done;Ab=ub.next())Ab=Ab.value,Ab.AKa&&(Db.PSa+=Ab.getRange().right-Ab.getRange().left+1)}}if(Kb.left===Qa.left)if(pa.CKa)Db.$Ma+=Kb.bottom-Kb.top+1;else if(Ab=this.kx.rQ(Kb,2))for(ub=bk(Ab),Ab=ub.next();!Ab.done;Ab=ub.next())Ab=Ab.value,Ab.DKa&&(Db.$Ma+=Ab.getRange().bottom-Ab.getRange().top+1);if(Kb.bottom===Qa.bottom)if(pa.AKa)Db.nGa+=Kb.right-Kb.left+
1;else if(Ab=this.kx.rQ(Kb,1))for(ub=bk(Ab),Ab=ub.next();!Ab.done;Ab=ub.next())Ab=Ab.value,Ab.FKa&&(Db.nGa+=Ab.getRange().right-Ab.getRange().left+1);if(Kb.right===Qa.right)if(pa.DKa)Db.qQa+=Kb.bottom-Kb.top+1;else if(pa=this.kx.rQ(Kb,3))for(pa=bk(pa),Ab=pa.next();!Ab.done;Ab=pa.next())Qa=Ab.value,Qa.CKa&&(Db.qQa+=Qa.getRange().bottom-Qa.getRange().top+1)};e.prototype.p9i=function(pa,Qa){Qa=bk(Qa.AXc);for(var Db=Qa.next();!Db.done;Db=Qa.next()){Db=pa.ze(Db.value.jf);Db=Yb.g(this.$).Ea.Eua(Db);for(var Kb=
Db.length,Ab=1;Ab<Kb;Ab++){var ub=Yb.g(this.$).Ub(Db[Ab].getRange());this.Cgc?ub.cell.deleteCellFromModel():(ub.Opb(),ub.clearFormat(),ub.cell.q9i());ub.CHb(!0)}}};e.prototype.dTj=function(pa,Qa){pa.backgroundColor=Qa.backgroundColor;pa.color=Qa.color};e.prototype.shg=function(pa,Qa){return{SpansBlocks:!0,OriginRow:pa,OriginColumn:Qa,IsOrigin:!1,Columns:0,Rows:0,Width:0,Height:0,OriginDeltaX:0,OriginDeltaY:0}};e.prototype.Qzg=function(pa,Qa,Db,Kb,Ab){Db=pa.ze(Db.jf);if(!Db)return F.ULS.sendTraceTag(523547158,
0,15,"blockRange(intersection of block's range and the selected range) can't be null as the blocks we are checking are returned as the intersecting blocks"),null;var ub=new zb.Range(pa.top,pa.left,Db.top,Db.left,!1,!1);if(Db.top==pa.top)var Mb=0;else ub.bottom=Db.top-1,Mb=Qa.afd(ub);Db.left==pa.left?ub=0:(ub.right=Db.left-1,ub=Qa.bfd(ub));Qa=this.shg(pa.top-1,pa.left-1);Qa.OriginDeltaY=Mb;Qa.OriginDeltaX=ub;Qa.Rows=Db.bottom-Db.top;Qa.Columns=Db.right-Db.left;Qa.Height=Ab;Qa.Width=Kb;Db.top==pa.top&&
Db.left==pa.left&&(Qa.IsOrigin=!0);pa=Yb.g(this.$).Ub(Db.topLeft);pa.cell.dZf(Qa);return pa};e.prototype.bOd=function(pa,Qa){var Db=[],Kb=Yb.g(this.$).Oe;if(!Kb)return Db;var Ab=Kb.afd(pa),ub=Kb.bfd(pa);if(Qa.AXc){Qa=bk(Qa.AXc);for(var Mb=Qa.next();!Mb.done;Mb=Qa.next())if(Mb=this.Qzg(pa,Kb,Mb.value,ub,Ab))Db.push(Mb);else{Db=[];break}}return Db};e.prototype.uVh=function(pa,Qa,Db,Kb){var Ab=Db.bottom-Db.top,ub=Db.right-Db.left,Mb=[],Aa=Kb.scenario;if(256===(Aa&256)){if(Mb=this.bOd(Db,Kb),!Mb||0==
Mb.length)return Mb}else Qa.cell.bOd(Ab,ub),Mb.push(Qa);Ab=this.N2(this.K4(Qa),!0,0,Aa,"merge");if(void 0!==pa&&null!==pa){ub=bk(Mb);for(var Za=ub.next();!Za.done;Za=ub.next()){Za=Za.value;var Zb=pa.cell.formattedText,jb=Object(La.a)(new kb.a,{TextRuns:Zb.TextRuns,Fonts:Zb.Fonts});jb.Text=void 0!==pa.cell.originalText&&null!==pa.cell.originalText?pa.cell.originalText:void 0!==pa.cell.userInput&&null!==pa.cell.userInput?pa.cell.userInput:Zb.Text;Ab=this.N2(this.K4(Za),Ab,1,Aa,"merge");this.Fg.AAa(Za,
jb,!1,null,!0,"MergeCells",void 0,2);Ab=this.N2(this.K4(Za),Ab,2,Aa,"merge");this.aod?Za.Xpb(pa):this.dTj(Za,pa);Ab=this.N2(this.K4(Za),Ab,3,Aa,"merge");Za.cell.a3g(pa.cell);Ab=this.N2(this.K4(Za),Ab,4,Aa,"merge");Za.cell.BBc(!1);Ab=this.N2(this.K4(Za),Ab,6,Aa,"merge")}}this.p9i(Db,Kb);this.N2(this.K4(Qa),Ab,5,Aa,"merge");return Mb};e.prototype.Thd=function(pa){return 4096===(pa&4096)};e.prototype.fid=function(pa){return 512===(pa&512)};e.prototype.Jhd=function(pa){return 2048===(pa&2048)};e.prototype.bid=
function(pa){return 1024===(pa&1024)};e.prototype.V$b=function(pa,Qa){for(var Db=null,Kb=0;Kb<pa.length;Kb++)if(pa[Kb].BorderPosition===Qa){Db=pa[Kb];break}return Db};e.prototype.AQh=function(pa,Qa){this.mhc?(Qa=this.V$b(Qa.cell.wM().Borders,2))&&pa.push(Qa):(Qa=Qa.cell.wM().Borders,1<Qa.length&&(Qa=[Qa[1]]),pa=[].concat(ck(Qa),ck(pa)));return pa};e.prototype.NYh=function(pa,Qa){this.mhc?(Qa=this.V$b(Qa.cell.wM().Borders,0))&&pa.push(Qa):(Qa=Qa.cell.wM().Borders,1<Qa.length&&(Qa=[Qa[0]]),pa=[].concat(ck(Qa),
ck(pa)));return pa};e.prototype.EIh=function(pa,Qa){Qa=this.kx.rQ(Qa.cell.getRange(),1);if(!Qa||0===Qa.length)return pa;if(this.mhc){if(Qa=Qa[0].wM().Borders,Qa=this.V$b(Qa,0))Qa.BorderPosition=1,pa.push(Qa)}else{var Db=[];0<Qa.length&&(Db=Qa[0].wM().Borders);Db[0].BorderPosition=1;pa=[].concat(ck(Db),ck(pa))}return pa};e.prototype.FVh=function(pa,Qa){Qa=this.kx.rQ(Qa.cell.getRange(),3);if(!Qa||0===Qa.length)return pa;if(this.mhc){if(Qa=Qa[0].wM().Borders,Qa=this.V$b(Qa,2))Qa.BorderPosition=3,pa.push(Qa)}else{var Db=
[];0<Qa.length&&(Db=Qa[0].wM().Borders);Db[0].BorderPosition=3;pa=[].concat(ck(Db),ck(pa))}return pa};e.prototype.tUh=function(pa,Qa,Db){this.Thd(pa.scenario)&&(Qa=this.AQh(Qa,Db));this.fid(pa.scenario)&&(Qa=this.NYh(Qa,Db));this.Jhd(pa.scenario)&&(Qa=this.EIh(Qa,Db));this.bid(pa.scenario)&&(Qa=this.FVh(Qa,Db));return Qa};e.prototype.kZ=function(pa){if(0===pa.length)return null;var Qa=[0,0,0,0],Db=[1,1,1,1],Kb=0;pa.forEach(function(ub){var Mb=ub.BorderPosition;Db[Mb]=ub.BorderLineStyle;var Aa=new vb.a(ub.Color.Red,
ub.Color.Green,ub.Color.Blue);Qa[Mb]=Aa.iS();Kb|=ta.HelperMethods.g3a(ub.BorderPosition)});pa={};pa.LineStyle=Db;pa.Color=Qa;var Ab={};Ab.BorderFormat=pa;Ab.Border=Kb;return Ab};e.prototype.T_d=function(pa,Qa,Db){Db=void 0===Db?null:Db;var Kb=[];Kb=null!==Db?[].concat(ck(Db)):this.tUh(Qa,Kb,pa);if(Qa=this.kZ(Kb))pa.cell.Iab(pa.cell.getRange()),this.kx.BHb(pa.cell.getRange()),this.Fg.Kda(Yb.g(this.$),-1690267012,Qa,!1,null,[pa.cell.getRange()])};e.prototype.ski=function(pa){return 512===(pa.scenario&
512)||4096===(pa.scenario&4096)||1024===(pa.scenario&1024)||2048===(pa.scenario&2048)?!0:!1};e.prototype.OYh=function(pa){pa=this.kx.rQ(pa.cell.getRange(),1);return pa&&0!==pa.length?pa[0].FKa?(pa=pa[0].wM().Borders[0],pa.BorderPosition=1,pa):null:null};e.prototype.PYh=function(pa){pa=this.kx.rQ(pa.cell.getRange(),3);return pa&&0!==pa.length?pa[0].CKa?(pa=pa[0].wM().Borders[0],pa.BorderPosition=3,pa):null:null};e.prototype.q2h=function(pa,Qa,Db,Kb,Ab){Qa.cell.scg();if(this.ski(pa))this.T_d(Qa,pa);
else{var ub=8192===(pa.scenario&8192),Mb=Qa.cell.getRange();ub&&this.Haf?(Qa.cell.Iab(),this.kx.BHb(Mb)):Ab?(Ab=[],null!==Db&&Ab.push(Db),null!==Kb&&Ab.push(Kb),0<Ab.length?this.T_d(Qa,pa,Ab):(Qa.cell.Iab(),this.kx.BHb(Mb))):ub&&!this.Haf&&(Qa.cell.Iab(),this.kx.BHb(Mb))}};e.prototype.YPh=function(pa,Qa){return null===pa||void 0===pa?!0:pa.cell.getRange().top===Qa.topLeft.top&&pa.cell.getRange().left===Qa.topLeft.left&&pa.cell.getRange().bottom===Qa.topLeft.bottom&&pa.cell.getRange().right===Qa.topLeft.right?
!0:!1};e.prototype.yzi=function(pa,Qa){Qa=this.Rof(pa,Qa);if(this.nzb&&(!Qa||0==Qa.length))return!1;for(var Db=0;Db<Qa.length;Db++)Qa[Db].t0(2,!0),this.N2(this.K4(Qa[Db]),!0,8,pa.scenario,"merge");return!0};e.prototype.BRj=function(pa){var Qa=Yb.g(this.$).Ea.RJa(pa,this.$.activeItemName);if(Qa&&Wa.Ct(Qa)){Qa=bk(Qa);for(var Db=Qa.next();!Db.done;Db=Qa.next())Db.value.HXd(pa,!0)}};e.prototype.Rof=function(pa,Qa){var Db=pa.nQ,Kb=Yb.g(this.$).Ub(Qa[0]),Ab=null,ub=null;this.Cgc&&(Ab=this.OYh(Kb),ub=this.PYh(Kb));
var Mb=this.uVh(Db,Kb,Qa[0],pa);if(this.nzb&&(!Mb||0==Mb.length))return Mb;this.mji?this.BRj(Qa[0]):Yb.g(this.$).Ea.b$(Qa[0],this.$.activeItemName).HXd(Qa[0],!0);this.N2(this.K4(Kb),!0,9,pa.scenario,"merge");if(this.Cgc&&this.Old(pa))for(Qa=this.YPh(Db,Qa[0]),Db=bk(Mb),Kb=Db.next();!Kb.done;Kb=Db.next())this.q2h(pa,Kb.value,Ab,ub,Qa);return Mb};e.prototype.RJg=function(pa,Qa,Db){var Kb=this;if(!(1>pa.Borders.length)){var Ab=this.kZ(pa.Borders);Db.forEach(function(ub){ub=Yb.g(Kb.$).Ub(ub.getRange());
Kb.Fg.D2f(-1690267012,ub,Ab,!1,null,!1,Qa)})}};e.prototype.jOj=function(pa,Qa,Db){for(var Kb=pa.length,Ab=0;Ab<Kb;Ab++){pa[Ab].cell.BBc();var ub=pa[Ab].cell.getRange(),Mb=Yb.g(this.$).Ea.Eua(ub),Aa=Mb.length;if(-167499203===Qa&&this.Bgc){var Za=0;2===pa[Ab].cell.XFd||1===pa[Ab].cell.aM?Za=3:2===pa[Ab].cell.aM&&(Za=1);pa[Ab].t0(Za,!1)}for(Za=1;Za<Aa;Za++)Mb[Za].attachCellToModel(),Mb[Za].Xpb(pa[Ab]),-167499203===Qa&&this.Bgc&&Mb[Za].t0(null,!1);this.Ogf&&Db&&this.RJg(Db[Ab],ub,Mb)}};e.prototype.qVe=
function(pa,Qa){for(var Db=null,Kb=0;Kb<pa.length;Kb++)if(pa[Kb].BorderPosition===Qa){Db=pa[Kb];break}return Db};e.prototype.DIh=function(pa,Qa){var Db=pa.cell.wM();pa.AKa()&&pa.cell.NPa(1);pa.DKa()&&pa.cell.NPa(3);if((pa=this.kx.rQ(Qa,0))&&pa[0].AKa){var Kb=pa[0].wM().Borders;Kb=this.qVe(Kb,1);Kb.BorderPosition=0;Db.Borders.push(Kb);pa.forEach(function(Ab){Ab.NPa(1)})}(Qa=this.kx.rQ(Qa,2))&&Qa[0].DKa&&(pa=Qa[0].wM().Borders,pa=this.qVe(pa,3),pa.BorderPosition=2,Db.Borders.push(pa),Qa.forEach(function(Ab){Ab.NPa(3)}));
return Db};e.prototype.vag=function(pa,Qa,Db){var Kb=Yb.g(this.$).Ea.Zua(Qa[0],this.$.activeItemName),Ab=Yb.g(this.$).Ea.b$(Qa[0],this.$.activeItemName),ub=[];if(void 0!==Kb&&null!==Kb&&(Qa=Yb.g(this.$).Yua(Qa[0],Kb),void 0!==Qa&&null!==Qa)){Qa=Qa.$$ge();for(Kb=[];Qa.$$mn();){var Mb=Qa.$$cu();if(Mb.ZE){ub.push(Mb);this.N2(this.K4(Mb),!0,10,pa,"unmerge");Mb.cell.IXg();var Aa=Mb.cell.getRange();this.N2(this.K4(Mb),!1,11,pa,"unmerge");Ab.HXd(Aa,!1);this.Ogf&&(Mb=this.DIh(Mb,Aa),Kb.push(Mb))}}0<ub.length&&
(Ab.lf.resetCellLookup(),this.jOj(ub,Db,Kb))}};e.prototype.N2=function(pa,Qa,Db,Kb,Ab){if(!this.Kcf)return!1;pa!==Qa&&F.ULS.sendTraceTag(526149323,0,50,"Merge Information for resultant cell is unexpectedly changed at step: {0}; Scenario: {1}; Command: {2}; Expected: {3}; Actual: {4}",Db,Kb,Ab,Qa?"populated":"empty",pa?"populated":"empty");return pa};e.prototype.K4=function(pa){return!!pa.cell.cell.Merge};Object(u.a)(e,"MergeCellCommandAction",null,[]);var qb=b(74),yb=b(95),ec=b(206),Ob=b(42),Cb=b(494),
ab=b(396),ya=b(50),ma=b(67),ha=b(906),Z=b(58),Na=b(1289),eb=b(36),cb=b(354);d.prototype.kii=function(pa){return 1896159024===pa||-1554384558===pa||-1113896058===pa||1554436520===pa||1415868706===pa||674605324===pa||1035996630===pa};d.prototype.Lc=function(pa,Qa){return 2054778433===Qa&&pa&1?!ra.a(this.$).phc:600686207===Qa?!1:this.kii(Qa)&&G.a.any(this.gridView.ha.sa.selectedRanges,function(Db){return Db.Te||Db.isRow})&&!this.Fff&&!this.Aff?!0:this.Khc(pa,Qa)};d.prototype.executeCommand=function(pa,
Qa,Db){return this.Kb(Qa,Db)};d.prototype.zc=function(pa,Qa,Db){if(pa=1===pa)switch(Qa.command){case 1457172838:case 2036397036:case -287251124:case -1925065947:case 1764140053:case -1685033574:case -1590502662:case -571165336:case -1142465846:case -1150205178:case 1041132226:case -286432209:case -394785302:case -1116189897:case 1886928607:case -992833457:case 218524921:case 996232352:case -167499203:case -255094134:case -693675336:case 322710748:case 1097660126:case 155820588:case 1896159024:case -1554384558:case 504848446:case 1504715724:case 1872288872:case 41465729:case -1451655532:case 1972143101:case -475861485:case -978843926:case 2098035706:case -2142700828:case 1405660955:case 1983983164:case 478842689:case -798660877:case -653661711:case 862890474:case 963349338:case 1012765228:case 1597684571:case -1832800737:case -1920201820:case -1942512156:case -600086683:case -208772570:case -987339782:case 748067091:case -381232414:case 1696566924:case 894341014:case 165770524:case 277878202:case -844983198:case -2090948892:case 1690991812:case -1770246794:break;
case -1220714308:case -1649235364:case 524773427:case 1886217042:case 928057943:case -1526602249:pa=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextOrientationSlice3",!1);break;case -1077965542:case 909774670:case -1904244080:case -1293291468:case 324978188:case -1428968098:case 1970784898:case -803000997:case -128950598:case 1688184685:case 87208751:case -446735083:case 1650812936:case 673562736:case -1690267012:case -236759591:case -1803452024:case -2118943501:case 1890566896:case -1113896058:case 1415868706:case 1554436520:case 674605324:case 1035996630:case 886009118:case 165054436:case 1981714220:case -556441918:case 942362098:case 622604322:case 1405456548:case 284490184:case 1256700402:case -1756763834:case -1418159950:pa=
!!Db;break;case 862825906:case 1532790410:case 46555851:case -1522760979:pa=!0;break;default:pa=!1}return pa};d.prototype.Qc=function(pa,Qa,Db){switch(Qa){case "PopulateFontColor":Db.MenuItems=this.rB.gac(1970784898,-803000997,null,null,-128950598,2036397036,1688184685,862825906,Db.MenuId);break;case "PopulateFillColor":Db.MenuItems=this.rB.gac(1650812936,null,87208751,2063445891,673562736,1457172838,-446735083,1532790410,Db.MenuId);break;case "PopulateBorderColor":Db.MenuItems=this.rB.gac(-236759591,
-1803452024,void 0,void 0,void 0,void 0,void 0,46555851,Db.MenuId);break;case "PopulateBorderStyle":this.borderFormatManager.K2h(Db);break;case "PopulateFontDropdown":case "PopulateFontRTFDropdown":if(this.$m&&(this.fontDropdownHelper.Fqj(Db.MenuId),!this.fontDropdownHelper.ihi()))return!1;Db.MenuItems=this.fontDropdownHelper.LUe(-1293291468,324978188,-1428968098,Db.MenuId);break;default:return!1}return!0};d.prototype.Khc=function(pa,Qa){var Db=Yb.g(this.$).ha.sa.selectedRanges;return!(new oa.a(this.$.va)).zm(pa,
Qa,Db,this.gridView)};d.prototype.Kb=function(pa,Qa){var Db=this,Kb=this.gridView,Ab=pa.command,ub=A.TaskExtensions.jk(),Mb=!0;switch(Ab){case -1077965542:Mb=this.q4e(Qa,pa,!1);break;case 909774670:this.epb(Ab);Mb=this.q4e(Qa,pa,!0);break;case -1293291468:Mb=this.o4e(Qa,pa,!1);break;case 324978188:z.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&F.ULS.sendTraceTag(574650248,0,50,"GridCommandHandler.HandleRibbonCommand: Handle font name preview");this.epb(Ab);Mb=
this.o4e(Qa,pa,!0);break;case 862890474:case 963349338:Mb=this.e2h(pa);break;case -1832800737:Mb=this.Mcc(Ab,Qa,!1,pa);break;case 1970784898:Mb=this.Mcc(Ab,Qa,!1,pa);break;case -803000997:Mb=this.Mcc(Ab,Qa,!1,pa);break;case -128950598:case 1688184685:this.epb(Ab);Mb=this.Mcc(Ab,Qa,!0,pa);break;case 1597684571:Mb=this.nwb(Ab,Qa,!1,pa);break;case 87208751:Qa.Color="-1";Qa.IntColor=!0;Mb=this.nwb(Ab,Qa,!1,pa);break;case -446735083:this.epb(Ab);Qa.Color="-1";Qa.IntColor=!0;Mb=this.nwb(Ab,Qa,!0,pa);break;
case 1650812936:Mb=this.nwb(Ab,Qa,!1,pa);break;case 673562736:this.epb(Ab);Mb=this.nwb(Ab,Qa,!0,pa);break;case -1904244080:case -1428968098:case 1457172838:case 2036397036:z.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&(pa=ya.b().ei(Ab),F.ULS.sendTraceTag(537159510,0,50,"GridCommandHandler.HandleRibbonCommand: Handle {0}",pa));this.HSf(Ab);break;case -287251124:case -1925065947:case 1764140053:case -1685033574:case -1590502662:Mb=this.P1h(Ab,pa);break;case -571165336:case -1142465846:case -1150205178:case 1041132226:case -286432209:case -394785302:case -1116189897:Mb=
this.X0h(Ab,pa);break;case -1220714308:case -1649235364:case 524773427:case 1886217042:case 928057943:case -1526602249:Mb=this.F2h(Ab,pa);break;case -1803452024:case -236759591:Mb=this.Vgd(Ab,Qa,pa);break;case -2118943501:Mb=this.borderFormatManager.h1h(Qa,pa);break;case 1012765228:Mb=this.borderFormatManager.Z2h(Qa,pa);break;case 1256700402:Mb=this.borderFormatManager.Zgd(pa);break;case -1756763834:Mb=this.borderFormatManager.$gd(pa);break;case -1418159950:Mb=this.borderFormatManager.c4e(pa);break;
case -1920201820:case -1942512156:Mb=this.f2h(Ab,pa);break;case -1690267012:case -600086683:case 165054436:case 1981714220:case -556441918:Mb=this.borderFormatManager.P3e(Qa,pa);this.izh(Qa);break;case 1890566896:case 1886928607:case -992833457:case 218524921:case 996232352:Mb=this.B2h(Ab,Qa,pa);break;case -693675336:case 322710748:break;case 1696566924:Mb=this.Q1h(pa);break;case -167499203:case -255094134:case 1097660126:case 155820588:ub=this.handleMergeCellsCommand(this.gridView,pa);break;case 1896159024:case -1554384558:Qa=
this.gridView.ha.sa.selectedRanges;if(this.hxj(pa,Qa))F.ULS.sendTraceTag(574993492,0,50,"GridCommandHandler.HandleRibbonCommand: showing InsertDeleteCellsDialog"),(new f(this.$,Ab,Qa)).rg(),Mb=!0;else if(G.a.any(Qa,function(Za){return Db.gridView.Ab.gMa(Za)})){Kb="";ub=1461300262;var Aa=-1554384558===Ab&&this.gridView.Ab.tki(Qa[0]);Qa=Qa[0].height>Qa[0].width&&!Aa;switch(Ab){case 1896159024:Kb=Qa?"InsertColumnsTable":"InsertRowsTable";ub=Qa?622604322:942362098;break;case -1554384558:Kb=Qa?"DeleteColumnsTable":
"DeleteRowsTable",ub=Qa?284490184:1405456548}Qa=da.a.Tp(d.Wkd,Kb,1);new xa.a(ub,1,2,6,null);ub=this.insertOrDeleteCells(Qa,pa,!0)}else ub=this.insertOrDeleteCells(1896159024===Ab?1:2,pa,!1);break;case 942362098:case 622604322:case 1405456548:case 284490184:ub=this.insertOrDeleteCells(da.a.Tp(d.Wkd,Qa[wa.a.Nc],1),pa,!0);break;case -1113896058:case 1415868706:case 1554436520:case 674605324:case 1035996630:ub=this.insertOrDeleteCells(da.a.Tp(d.Wkd,Qa[wa.a.Nc],1),pa,!1);break;case 504848446:ub=Kb.startEdit(!1,
1,Qa[fa.a.event],void 0,void 0,!0);break;case 1504715724:if(Yb.g(this.$).gz&&this.borderFormatManager.yU.fB)break;ub=Kb.startEdit(!0,0,Qa[fa.a.event],void 0,void 0,!0);break;case 1872288872:this.Spb();break;case 41465729:ub=this.fill(Kb.ha.sa.Vc,null,0,1,pa);break;case -1451655532:case 1972143101:ub=this.fillDownAbsoluteValueAndStartEdit(Kb,Qa[fa.a.event],-1451655532===Ab);break;case -475861485:ub=this.fill(Kb.ha.sa.Vc,null,Kb.rtl?1:2,1,pa);break;case -978843926:ub=this.fill(Kb.ha.sa.Vc,null,3,1,
pa);break;case 2098035706:ub=this.fill(Kb.ha.sa.Vc,null,Kb.rtl?2:1,1,pa);break;case -2142700828:ub=this.fill(Kb.ha.sourceRange,Kb.ha.sa.Vc,d.YXe(Kb.ha.sa.Vc,Kb.ha.sourceRange),2,pa);break;case 1405660955:ub=this.fill(Kb.ha.sourceRange,Kb.ha.sa.Vc,d.YXe(Kb.ha.sa.Vc,Kb.ha.sourceRange),4,pa);break;case 1983983164:ub=this.fill(Kb.ha.sa.Vc,null,0,0,pa);break;case 478842689:(pa=this.$.da.za(376))?(pa.O2i(),Mb=!0):F.ULS.sendTraceTag(537159509,0,15,"gridHighlightBehaviorEventManager is null for TouchAutoFill");
break;case -798660877:case -653661711:case 165770524:case 277878202:case -844983198:case -2090948892:case 1690991812:Mb=Kb.ha.Kb(null,Ab);break;case -208772570:this.w2h();Mb=!0;break;case -987339782:this.p1h();Mb=!0;break;case -1770246794:Kb.ha.q1h();Mb=!0;break;case 748067091:case -381232414:this.t1h(Ab);Mb=!0;break;case -1522760979:this.gridView.toggleFormulaView();Mb=!0;break;case 886009118:ub=this.c2h();break;case 894341014:this.h2h();Mb=!0;break;case 862825906:ub=this.G4e(1970784898,pa);break;
case 1532790410:ub=this.G4e(1650812936,pa);break;case 46555851:ub=this.s2h(pa);break;default:Mb=!1}Mb||(ub=za.a(Ab));return ub};d.prototype.izh=function(pa){pa&&pa.MenuItemId&&["OutsideBorders","AllBorders","ThickOutsideBorders"].includes(pa.MenuItemId)&&z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.IntelligentMetadataTableProactiveSuggestions",!1)&&this.pOg(new cb.a(this.gridView.ha.sa.activeRange,ea.d(this.$.va.pa)))};d.prototype.pOg=function(pa){A.TaskExtensions.Aa(B.GetServiceTaskFactory.Ra(this.$.da,
426,427,1),function(Qa){Qa.result.WVd(pa,"BorderActions")},this.$.la,3)};d.prototype.hxj=function(pa,Qa){var Db=this,Kb=G.a.all(Qa,function(Mb){return!Db.gridView.Ab.gMa(Mb)}),Ab=1<Qa.length&&!!this.gridView.Ab.Rfd(Qa),ub=G.a.all(Qa,function(Mb){return!Db.gridView.Ab.d5(Mb)});Qa=!G.a.any(Qa,function(Mb){return Mb.isRow||Mb.Te});return 1===pa.method&&6===pa.Le&&(Kb||Ab)&&ub&&Qa};d.prototype.fillDownAbsoluteValueAndStartEdit=function(pa,Qa,Db){var Kb=this,Ab=pa.ha.sa.activeCell,ub=ja.E(Ab,this.gridView.ys);
return pa.startEdit(!0,0,Qa).Io(function(){var Mb=pa.Ub(ub),Aa=pa.Ub(Ab);if(!Mb||!Aa)return F.ULS.shipAssertTag(537159507,0,!1,"GridCommandHandler.FillDownAbsoluteValueAndStartEdit Cannot get cells for active cell: {0} and above cell: {1}",Ab.toString(),ub.toString()),Z.Task.Ua(!1);Kb.gridView.Wb.text=Db?Mb.Q0:Mb.text;Kb.gridView.Wb.textBox.setCaretPositionToEnd();return Z.Task.Ua(!0)})};d.prototype.insertOrDeleteCells=function(pa,Qa,Db){function Kb(){return new r(Zb)}var Ab=this,ub=T.a.create().toString(),
Mb=Enum.toString(R,pa);this.gridView.si.y7(17,ub,Mb);Mb=this.gridView.ha.sa.selectedRanges;var Aa=this.Fff,Za=this.Aff;if(!this.$.hq(null,!1,void 0,Qa.Le)&&!Za&&!Aa&&5!==pa&&9!==pa)return Z.Task.Ua(!0);2===pa?pa=Za?10:Aa?6:Mb[0].height>Mb[0].width?18:34:1===pa?pa=Za?9:Aa?5:Mb[0].height>Mb[0].width?17:33:18===pa&&Aa?pa=34:34===pa&&Za&&(pa=18);Mb=this.KHg(Mb,pa);if((10===pa||6===pa)&&!this.$.hq(Mb,!0,1,Qa.Le))return Z.Task.Ua(!0);var Zb={};Zb.InsertDeleteRangeItems=Array(Mb.length);Zb.SheetName=this.$.pa.sheetName;
Zb.IsTableCommand=Db;for(Db=0;Db<Mb.length;Db++){Aa=Mb[Db];var jb={},Vb=Za=void 0;pa&4?(jb.FirstRow=Aa.top-1,jb.LastRow=ka.a.Tx,jb.FirstColumn=0,jb.LastColumn=ka.a.Wu,Za=Aa.bottom-Aa.top+1,Vb=0,6===pa&&(Aa.Te||(jb.FirstRow=Aa.bottom),Za=-Za)):pa&8?(jb.FirstRow=0,jb.LastRow=ka.a.Tx,jb.FirstColumn=Aa.left-1,jb.LastColumn=ka.a.Wu,Za=0,Vb=Aa.right-Aa.left+1,10===pa&&(Aa.isRow||(jb.FirstColumn=Aa.right),Vb=-Vb)):pa&16?(jb.FirstRow=Aa.top-1,jb.LastRow=Aa.bottom-1,jb.FirstColumn=Aa.left-1,jb.LastColumn=
ka.a.Wu,Za=0,Vb=Aa.right-Aa.left+1,18===pa&&(jb.FirstColumn=Aa.right,Vb=-Vb)):(jb.FirstRow=Aa.top-1,jb.LastRow=ka.a.Tx,jb.FirstColumn=Aa.left-1,jb.LastColumn=Aa.right-1,Za=Aa.bottom-Aa.top+1,Vb=0,34===pa&&(jb.FirstRow=Aa.bottom,Za=-Za));jb={InsertDeleteRange:jb};jb.DeltaRow=Za;jb.DeltaColumn=Vb;jb.AdjustedSelectedRange=ja.j(Aa);Zb.InsertDeleteRangeItems[Db]=jb}this.gridView.hg.GG(!1);var Ic=z.EwaSettings.isChangeGateEnabled("OfficeVSO:4932761_InsertDeleteCellsDecoupled");Zb.IsDecoupleRecalc=Ic;var Rb=
this.$.oa.xa.Pb();return ua.a(this.$.userOperationManager,function(kc,xb,Va){Ic&&!z.EwaSettings.isChangeGateEnabled("OfficeVSO:5316173_RecoverableFromOOM")||Ab.$.ly();var tb=Ab.$.oa.xa;kc=V.b(kc,Ab.JMi);var fb=tb.Na(41,void 0===Rb?null:Rb);fb.insertDeleteMultiRangeParameters=Zb;return aa.g(tb,"InsertDeleteCells",fb,kc,xb,Va,ub,0)},function(kc){return new Xa.a(237,0,kc,void 0,Kb)},Qa)};d.prototype.KHg=function(pa,Qa){return Qa&32?this.EYa(pa,function(Db){return Db.bottom},function(Db){return Db.top},
function(Db,Kb){Db.bottom=Kb},!1,!0):Qa&16?this.gridView.rtl?this.EYa(pa,function(Db){return Db.left},function(Db){return Db.right},function(Db,Kb){Db.left=Kb},!1,!1):this.EYa(pa,function(Db){return Db.right},function(Db){return Db.left},function(Db,Kb){Db.right=Kb},!1,!1):Qa&4?this.EYa(pa,function(Db){return Db.bottom},function(Db){return Db.top},function(Db,Kb){Db.bottom=Kb},!0,!0):Qa&8?this.gridView.rtl?this.EYa(pa,function(Db){return Db.left},function(Db){return Db.right},function(Db,Kb){Db.left=
Kb},!0,!1):this.EYa(pa,function(Db){return Db.right},function(Db){return Db.left},function(Db,Kb){Db.right=Kb},!0,!1):pa};d.prototype.EYa=function(pa,Qa,Db,Kb,Ab,ub){pa=ja.d(pa);pa.sort(function(Za,Zb){return Qa(Zb)-Qa(Za)});if(Ab){Ab=[];ub=z.EwaSettings.isChangeGateEnabled("OfficeVSO:5181014_DeletingLastTwoRowsColsFix")?ub?ka.a.sh+1:ka.a.Bh+1:ub?ka.a.Tx:ka.a.Wu;for(var Mb=0;Mb<pa.length;Mb++){var Aa=pa[Mb];Db(Aa)<ub&&(Kb(Aa,Math.min(Qa(Aa),ub-1)),Ab.push(Aa),ub=Db(Aa))}pa=Ab}return pa};d.prototype.fill=
function(pa,Qa,Db,Kb,Ab){function ub(){return new n(Za,Zb,Kb,Db)}var Mb=this,Aa=this.$;if(!Aa.hq([Qa],!0))return Z.Task.Ua(!0);var Za=ja.v(pa,Aa),Zb=Qa?ja.v(Qa,Aa):Za,jb=this.$.oa.xa.Pb();return ua.a(this.$.userOperationManager,function(Vb,Ic,Rb){Mb.$.ly();var kc=Mb.$.oa.xa,xb=kc.Na(9,jb);xb.sourceRange=Za;xb.targetRange=Zb;xb.fillDirection=Db;xb.fillType=Kb;return aa.g(kc,"FillRange",xb,Vb,Ic,Rb,null,0)},function(Vb){return new Xa.a(155,0,Vb,void 0,ub)},Ab)};d.prototype.B2h=function(pa,Qa,Db){var Kb=
{ValidMembers:32};switch(pa){case 1890566896:pa=parseInt(Qa[wa.a.Nc].toString(),10);if(14===pa)return Db=new xa.a(2105621672,Db.method,Db.mode,Db.Le,Db.tabName),Qa[wa.a.Nc]=null,this.$.Ka.Kb(Db,Qa),F.ULS.sendTraceTag(537159506,0,50,"GridCommandHandler.HandleNumberFormatCommand: triggered NumberFormatDialog command, with menu item 14."),!0;Kb.NumberFormat=pa;break;case 1886928607:Kb.NumberFormat=13;break;case -992833457:Kb.NumberFormat=11;break;case 218524921:Kb.NumberFormat=12;break;case 996232352:Kb.NumberFormat=
1006;break;default:return F.ULS.shipAssertTag(537159505,0,!1,"Unexpected number formatting command "+ya.b().ei(Db.command)),!1}F.ULS.sendTraceTag(537159504,0,50,"GridCommandHandler.HandleNumberFormatCommand: triggered {0} command, with menu item {1}.",ya.b().ei(Db.command),Qa[wa.a.Nc]);this.Fg.formatCells(1890566896,Kb,Db);this.$.hf();return!0};d.prototype.e2h=function(pa){var Qa=this.gridView.Ub(this.gridView.ha.sa.activeCell);if(this.tb&&this.gridView.isEditing){Qa=this.gridView.Gi.B3a(Qa?ec.a(Qa).Font:
null);if(!Qa)return F.ULS.shipAssertTag(537159503,0,!1,"GridCommandHandler.HandleIncreaseOrDecreaseFontSizeCommand: fontType for range {0} is null while editing",this.gridView.ha.sa.activeCell.toString()),!1;var Db=Qa.FontSize}else if(Qa)Db=Qa.fontSize;else return!1;Qa=pa.command;var Kb=0;if(862890474===Qa)for(;Kb<d.jJa.length-1&&d.jJa[Kb]<=Db;)Kb++;else if(963349338===Qa)for(Kb=d.jJa.length-1;0<Kb&&d.jJa[Kb]>=Db;)Kb--;F.ULS.sendTraceTag(537159501,0,50,"GridCommandHandler.HandleIncreaseOrDecreaseFontSizeCommand: change font from size {0} to size {1}",
Db,d.jJa[Kb]);if(Db===d.jJa[Kb])return!0;Db=d.ivc(2);Db.Font.FontSize=d.jJa[Kb];this.tb&&this.gridView.isEditing?(this.Inb(pa,!1,Db),this.$.hf()):this.Fg.formatCells(Qa,Db,pa);return!0};d.prototype.q4e=function(pa,Qa,Db){pa=pa[pa[O.a.IsFreeForm]?O.a.Value:wa.a.Uf].toString();if(!d.jZi.test(pa))return F.ULS.sendTraceTag(537159499,0,50,"GridCommandHandler.HandleFontSizeCommand: Font size in command is not a number."),z.EwaSettings.isChangeGateEnabled("OfficeVSO:5115068_FontSizeCommandHandledForInvalidParameter")?
!0:!1;pa=parseFloat(pa);if(8>pa||72<pa)return F.ULS.sendTraceTag(537159497,0,50,"GridCommandHandler.HandleFontSizeCommand: Font size in command is not within expected limits ({0} - {1}).",8,72),z.EwaSettings.isChangeGateEnabled("OfficeVSO:5115068_FontSizeCommandHandledForInvalidParameter")?!0:!1;var Kb=Math.round(2*pa)/2,Ab=d.ivc(2);Ab.Font.FontSize=Kb;this.tb&&this.gridView.isEditing?(this.Inb(Qa,Db,Ab,!0),Kb===pa||Db||this.$.hf()):Db?this.Fg.Kda(this.gridView,-1077965542,Ab,Db):(this.Fg.formatCells(-1077965542,
Ab,Qa),this.x_a());return!0};d.prototype.o4e=function(pa,Qa,Db){var Kb=pa[wa.a.Uf];if(this.$m){var Ab=this.fontDropdownHelper.Dyc?this.fontDropdownHelper.Dyc[Kb]:null;Ab||(F.ULS.sendTraceTag(523903201,1,15,"GridCommandHandler.HandleFontFamilyCommand: font in supportedFontFamiliesNew is not found for {0}",Kb),Ab=ta.HelperMethods.dS[Kb])}else Ab=ta.HelperMethods.dS[Kb];var ub=0;this.Am&&(pa=pa.MenuItemId,pa===Na.b?(Kb==this.themesManager.fL.lpf&&(Ab=Kb),ub=2):pa===Na.a&&(Kb==this.themesManager.fL.Gnf&&
(Ab=Kb),ub=1));if(!Ab)return!0;Kb=d.ivc(1);Kb.Font.FontName=Ab;this.Am&&(Kb.Font.FontScheme=ub);this.tb&&this.gridView.isEditing?(this.Inb(Qa,Db,Kb),this.$.hf()):Db?this.Fg.Kda(this.gridView,-1293291468,Kb,Db):(this.Fg.formatCells(-1293291468,Kb,Qa),this.x_a());return!0};d.prototype.Mcc=function(pa,Qa,Db,Kb){var Ab=-803000997===pa||1688184685===pa?"black":Qa.Color;this.moreColorsHelper&&(-1832800737===pa?Ab=sa.a.compare(Ab,"WindowText",!0)?this.moreColorsHelper.cHb:"black":Db||(this.moreColorsHelper.cHb=
Ab,this.moreColorsHelper.Sca(Qa,Ab,Kb)));pa=d.ivc(32);pa.Font.FontColor=Ga.a.XG(Ab,da.a.wg(Qa,"IntColor"));this.tb&&this.gridView.isEditing?this.Inb(Kb,Db,pa,17===Kb.Le):Db?this.Fg.Kda(this.gridView,1970784898,pa,Db):(this.JC&&(Db=this.getThemeColor(Qa),Qa=Db.themeColor,Db.returnValue&&(pa.Font.ThemeFontColor=Qa,pa.Font.ColorTypeOption=1)),this.Fg.formatCells(1970784898,pa,Kb),this.x_a());return!0};d.prototype.t1h=function(pa){var Qa=(new Date).format(748067091===pa?this.$.ya.ShortDateFormat:this.$.ya.ShortTimeFormat),
Db=this.gridView.pj?db.a(this.gridView.$):this.gridView.Wb;pa=Db.textBox;if(this.gridView.isEditing)Db.insertText(Qa);else{var Kb=z.EwaSettings.isChangeGateEnabled("OfficeVSO:6336696_ChangeEditingModeAfterInsertDateOrTime")?0:1;this.gridView.startEdit(!0,Kb);Db.text=Qa;Qa=Qa.length;pa.$Qa(Qa);pa.caretPosition=Qa}};d.prototype.w2h=function(){this.gridView.QQ(this.gridView.ha.sa.activeCell)||this.gridView.Fuc||this.gridView.cMa()||this.gridView.fr(this.gridView.ha.sa.activeCell,3,yb.a.z3e)};d.prototype.p1h=
function(){if(!(this.gridView.Fuc||this.gridView.cMa()||this.gridView.isEditing&&U.a.isMac)){var pa=this.gridView.ha.sa.W3;this.gridView.gg(ja.v(pa,this.$),pa,null,null,60,yb.a.z3e)}};d.prototype.Q1h=function(pa){var Qa=this;this.e$b=ea.d(this.$.va.pa);var Db=this.$.da.za(254,!0);if(this.gridView.U5a)return this.gridView.hg.GG(!1),!!Db;if(!Db)return F.ULS.sendTraceTag(537159494,0,50,"GridCommandHandler.HandleFormatPainter : copyPasteInfrastructure is null"),!1;this.gridView.ha.gY(this.Iad);var Kb=
String.format(fa.a.jta,Ka.a.current.Ro(105));this.gridView.hg.vo(Kb);pa=new xa.a(-911352779,pa.method,pa.mode,pa.Le,pa.tabName);Kb={};this.$.Ka.Kb(pa,(Kb[fa.a.silentClipboardAccessFailures]=!0,Kb[fa.a.isFormatPainter]=!0,Kb)).continueWith(function(Ab){(6>Ab.status||6===Ab.status&&!Ab.result)&&Qa.Spb()});this.gridView.U5a=!0;Db.JFg(this.Spb);return!0};d.prototype.nwb=function(pa,Qa,Db,Kb){var Ab=87208751===pa?"-1":Qa.Color;this.moreColorsHelper&&(1597684571===pa?Ab=this.moreColorsHelper.rab:Db||(this.moreColorsHelper.rab=
Ab===d.notSet?d.QVd:Ab,this.moreColorsHelper.Sca(Qa,Ab,Kb)));pa={ValidMembers:64};pa.FillColor=Ga.a.XG(Ab,da.a.wg(Qa,"IntColor"));Db?this.Fg.Kda(this.gridView,1650812936,pa,!0):(this.JC&&(Db=this.getThemeColor(Qa),Qa=Db.themeColor,Db.returnValue&&(pa.ThemeFillColor=Qa,pa.ColorTypeOption=1)),this.Fg.formatCells(1650812936,pa,Kb),this.x_a());return!0};d.prototype.h2h=function(){F.ULS.sendTraceTag(537159493,0,50,"GridCommandHandler.HandleInsertFormulaArgumentsInCell Started handling the command");var pa=
this.$.da.za(221);if(pa){var Qa=this.gridView.Gi;if(Qa){var Db=pa.lbi(Qa.text,Qa.textBox.caretPosition);var Kb=Db.yqf;var Ab=Db.HSe;(Db=Db.returnValue)?(pa.isListVisible=!1,Qa.text=Db,Qa.textBox.selectRange(Kb,Kb+Ab),F.ULS.sendTraceTag(587534607,0,50,"GridCommandHandler.HandleInsertFormulaArgumentsInCell InsertFormulaArguments executed successfully")):F.ULS.sendTraceTag(537159490,0,50,"GridCommandHandler.HandleInsertFormulaArgumentsInCell Can't insert formula arguments with current text and caret position.")}else F.ULS.shipAssertTag(537159491,
0,!1,"GridCommandHandler.HandleInsertFormulaArgumentsInCell No editor object")}else F.ULS.sendTraceTag(537159492,0,50,"GridCommandHandler.HandleInsertFormulaArgumentsInCell No formulaAssistanceControl object")};d.prototype.P1h=function(pa,Qa){var Db=0,Kb=this.gridView,Ab=ec.a(Kb.Ub(null));this.tb&&Kb.isEditing&&(Ab.Font=Kb.Gi.B3a(Ab.Font));var ub=Ab.Font;ub||(ub={ValidMembers:0});switch(pa){case -287251124:Db|=4;ia.e(ub,4)?ub.Bold=!ub.Bold:ub.Bold=!0;break;case -1925065947:Db|=8;ia.e(ub,8)?ub.Italic=
!ub.Italic:ub.Italic=!0;break;case 1764140053:Db|=16;ia.e(ub,16)?ub.Underline=!ub.Underline:ub.Underline=!0;break;case -1685033574:Db|=64;ia.e(ub,64)?ub.DoubleUnderline=!ub.DoubleUnderline:ub.DoubleUnderline=!0;break;case -1590502662:Db|=128,ia.e(ub,128)?ub.Strikethrough=!ub.Strikethrough:ub.Strikethrough=!0}if(!Db)return!1;ub.ValidMembers=Db;Ab.Font=ub;Ab.ValidMembers=16;this.tb&&this.gridView.isEditing?this.Inb(Qa,!1,Ab):(z.EwaSettings.ma(658)||Kb.hg.GG(!1),this.Fg.formatCells(pa,Ab,Qa));this.$.hf();
return!0};d.prototype.X0h=function(pa,Qa){var Db=0,Kb=this.gridView,Ab=ec.a(Kb.Ub(null));-571165336===pa||1041132226===pa||-394785302===pa?(Db|=1,Ab.VerticalAlignment=da.a.Tp(d.KYa,pa.toString(),2)):d.Vhi(pa)?(Db|=2,this.$1h(Ab,pa)):-1116189897===pa&&(Db|=8,Ab.Wrap=Ab.ValidMembers&8?!Ab.Wrap:!0);if(!Db)return!1;Ab.ValidMembers=Db;z.EwaSettings.ma(658)||Kb.hg.GG(!1);this.Fg.formatCells(pa,Ab,Qa);this.$.hf();return!0};d.prototype.$1h=function(pa,Qa){!z.EwaSettings.isChangeGateEnabled("OfficeVSO:5049785_DisableTextAlignmentCommandFlipInRTL")&&
this.$.isChromeRtl&&-1142465846!==Qa&&(Qa=-1150205178===Qa?-286432209:-1150205178);Qa=da.a.Tp(d.KYa,Qa.toString(),0);pa.HorizontalAlignment=Qa===pa.HorizontalAlignment?0:Qa};d.prototype.wIf=function(pa,Qa,Db,Kb){var Ab=this,ub=!1;z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellPerfImprovement",!1)&&(ub=this.Jkc.Qof(Qa,Db))&&Yb.g(this.$).si.A0(this.q8a,qb.BasicTelemetryCalculator.HQ);return this.Nsb(pa,Qa,!1,ub,function(Mb){Ab.SNi(Mb,Db,Qa,ub,Kb)})};d.prototype.handleMergeCellsCommand=
function(pa,Qa){var Db=this;this.q8a=T.a.create().toString();var Kb=null;Kb=this.Jkc.GZe();var Ab=ca.a(Qa.command),ub=this.Jkc.Pfi(Qa.command,Kb),Mb=z.EwaSettings.isChangeGateEnabled("OfficeVSO:5855030_MergeCellLogTelemetryForDataLossScenario"),Aa=0;Mb&&ub?Aa=J.a.me():Yb.g(this.$).si.y7(4,this.q8a,Ab+", Scenario = "+Kb.scenario.toString());Ab=pa.ha.sa.selectedRanges;F.ULS.sendTraceTag(537159459,0,50,"GridCommandHandler.HandleMergeCellsCommand: Merge Command: {0}, Number of ranges: {1}, Ranges: {2}",
ya.b().ei(Qa.command),Ab.length,ja.i(Ab,",",this.$,!1));Ab=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellPerfImprovement",!1);pa.hg.GG(!1,Ab);if(10===da.a.Tp(d.Sof,Qa.command.toString(),10))return Z.Task.Ua(!1);var Za=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellDataLossScenarioCse",!1);if(Ab&&Za)return ub?(Mb?this.WQd(Kb,Qa,!0,!0,Aa):this.WQd(Kb,Qa,!0),Z.Task.Ua(!0)):this.wIf(pa,Qa,Kb,!1);var Zb=!1;Ab&&(Zb=this.Jkc.Qof(Qa,Kb))&&Yb.g(this.$).si.A0(this.q8a,
qb.BasicTelemetryCalculator.HQ);return this.Nsb(pa,Qa,!1,Zb,function(jb){Db.TNi(jb,Qa,Zb)})};d.prototype.Nsb=function(pa,Qa,Db,Kb,Ab){function ub(Ic,Rb,kc){Za.$.ly();Ic=Ab?V.b(Ic,Ab):Ic;Ic=V.b(Ic,Mb);return aa.d(Za.$.oa.xa,jb,Vb,Db,Ic,Rb,kc,null,Zb)}function Mb(Ic){var Rb=!!Ic&&!!Ic.RequestTelemetryData;Yb.g(Za.$).si.dla(Za.q8a,Ic.StateId,Rb?Ic.RequestTelemetryData.EcsOperationDuration:0,Rb?Ic.RequestTelemetryData.EcsRequestDuration:0,Rb?Ic.RequestTelemetryData.WfeRequestDuration:0)}function Aa(){return new X.a(jb,
Vb)}var Za=this;Ab=void 0===Ab?null:Ab;var Zb=this.$.oa.xa.Pb(),jb=da.a.Tp(d.Sof,Qa.command.toString(),10),Vb=ja.r(pa.ha.sa.selectedRanges,pa.$);return Kb?z.EwaSettings.Zb()?ua.a(this.$.userOperationManager,ub,function(Ic){return new Xa.a(156,0,Ic,64,Aa)},Qa):ua.a(this.$.userOperationManager,ub,function(Ic){return new va.a(156,0,Ic,void 0,Aa)},Qa):ua.a(this.$.userOperationManager,ub,function(Ic){return new Xa.a(156,0,Ic,void 0,Aa)},Qa)};d.prototype.WQd=function(pa,Qa,Db,Kb,Ab){var ub=this;Kb=void 0===
Kb?!1:Kb;Ab=void 0===Ab?0:Ab;F.ULS.sendTraceTag(537159457,0,50,"Merge cells with multiple values. isCalledBeforeCSE :- {0}",Db);var Mb=Yb.g(this.$).rtl,Aa=z.EwaSettings.isChangeGateEnabled("OfficeVSO:5855030_MergeCellLogTelemetryForDataLossScenario");Mb=qa.a.Xc(3,2,0,Mb?638:637,0,514846606,"MergeCellsLoseData");A.TaskExtensions.Aa(Ob.a(this.$).hj(Mb),function(Za){Za=Za.result;if(Kb){var Zb=J.a.me()-Ab;F.ULS.sendTraceTag(528779355,0,50,"Time taken to show Dialog in Data Loss Scenario is : {0}, and the user action is : {1}",
Zb,Za)}0===Za?(F.ULS.sendTraceTag(537159456,0,50,"MergeCellsLoseData Dialog: Ok pressed"),Db?(Kb&&Aa&&(Za=ca.a(Qa.command),Yb.g(ub.$).si.y7(4,ub.q8a,Za+", Scenario = "+pa.scenario.toString())),ub.wIf(Yb.g(ub.$),Qa,pa,!0)):ub.Nsb(ub.gridView,Qa,!0,!1)):1===Za&&F.ULS.sendTraceTag(537159455,0,50,"MergeCellsLoseData Dialog: Cancel pressed")},this.$.la,11)};d.prototype.Lti=function(pa,Qa,Db,Kb){Qa!==pa&&F.ULS.sendTraceTag(537159454,0,15,"MergeCellsLoseData flag as per client and server does not match. MergeCellsLoseData flag as per client is :- {0} and as per server is {1}. The scenario is:- {2}, The CSE is done:- {3}",
Qa,pa,Db,Kb)};d.prototype.TNi=function(pa,Qa,Db){var Kb=this;na.b(pa,514846606)&&(F.ULS.sendTraceTag(537159453,0,50,"Merge cells with multiple values"),ma.a(this.$).fd.eJ(514846606),pa=Yb.g(this.$).rtl,pa=qa.a.Xc(3,2,0,pa?638:637,0,514846606,"MergeCellsLoseData"),A.TaskExtensions.Aa(Ob.a(this.$).hj(pa),function(Ab){Ab=Ab.result;0===Ab?(F.ULS.sendTraceTag(537159452,0,50,"MergeCellsLoseData Dialog: Ok pressed"),Kb.Nsb(Kb.gridView,Qa,!0,Db)):1===Ab&&F.ULS.sendTraceTag(537159451,0,50,"MergeCellsLoseData Dialog: Cancel pressed")},
this.$.la,11))};d.prototype.SNi=function(pa,Qa,Db,Kb,Ab){var ub=this,Mb=!1;na.b(pa,514846606)&&(Mb=!0,ma.a(this.$).fd.eJ(514846606),Kb&&Ab?window.setTimeout(function(){ub.Nsb(ub.gridView,Db,!0,!0)},0):this.WQd(Qa,Db,!1));this.Lti(Mb,Ab,Qa.scenario,Kb)};d.prototype.epb=function(pa){var Qa=z.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation");if(Qa&&this.WZa!==pa&&1461300262!==this.WZa){this.HSf(this.WZa);var Db=ya.b().ei(pa),Kb=ya.b().ei(this.WZa);F.ULS.sendTraceTag(537159450,
0,50,"GridCommandHandler.CacheFontStyles: Style cached during {0} was restored before caching the style for {1} command.",Kb,Db)}Qa&&(this.WZa=pa);if(this.tb&&this.gridView.isEditing)this.TZa||(this.TZa=this.gridView.Gi.formattedText);else if(!this.xA){this.xA=[];Qa=this.gridView.K$("GridCommandHandler.CacheFontStyles",this.gridView.ha.sa.selectedRanges);try{for(Qa.$$rst();Qa.$$mn();){var Ab=Qa.$$cu(),ub=Ab.cell.hasRichText;if(z.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")){var Mb=
ya.b().ei(pa);F.ULS.sendTraceTag(537159449,0,100,"GridCommandHandler.CacheFontStyles: Add CachedPreviewCellGroup following {0} command. isRichText({1}). Cache size is {2}",Mb,ub,this.xA.length)}if(ub)this.xA.push(v.IQg(Ab,Ab.cell.formattedText));else switch(pa){case 673562736:case -446735083:this.xA.push(v.fYc(Ab,Ab.backgroundColor));z.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&!Ab.backgroundColor&&F.ULS.sendTraceTag(537159448,0,100,"GridCommandHandler.CacheFontStyles: cached empty or null BackgroundColor. isNull({0})",
!Ab.backgroundColor);break;case -128950598:case 1688184685:this.xA.push(v.fYc(Ab,Ab.color));z.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&!Ab.color&&F.ULS.sendTraceTag(537159447,0,100,"GridCommandHandler.CacheFontStyles: cached empty or null Color. isNull({0})",!Ab.color);break;case 909774670:this.xA.push(v.JQg(Ab,Ab.fontSize));if(z.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")){var Aa=ha.c(Ab.fontSize)?"null or undefined":
Ab.fontSize.toString();F.ULS.sendTraceTag(537159446,0,100,"GridCommandHandler.CacheFontStyles: cached font size is {0}",Aa)}break;case 324978188:this.Am?this.xA.push(v.HQg(Ab,Ab.fontName,Ab.zaa)):this.xA.push(v.fYc(Ab,Ab.fontName)),z.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&(Ab.fontName?F.ULS.sendTraceTag(537159444,0,50,"GridCommandHandler.CacheFontStyles: cached FontName is ({0}) of length({1}).",gridRenderer.CanvasRendererGlobals.getFontNameForLogging(Ab.fontName),
Ab.fontName.length):F.ULS.sendTraceTag(537159445,0,100,"GridCommandHandler.CacheFontStyles: cached empty or null FontName. isNull({0})",!Ab.fontName))}}}finally{Qa&&Qa.dispose()}}};d.prototype.yBj=function(){return this.tb&&this.gridView.isEditing?!this.TZa:!this.xA};d.prototype.Gei=function(pa){return!!this.xA&&this.xA.length>pa&&!!this.xA[pa].formattedText};d.prototype.S$b=function(pa){return this.xA[pa].style};d.prototype.iJh=function(pa){return this.xA[pa].size};d.prototype.hJh=function(pa){return this.xA[pa].zaa};
d.prototype.HSf=function(pa){if(this.yBj())z.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&F.ULS.sendTraceTag(537159443,0,100,"GridCommandHandler.RestoreCachedStyles: Nothing to restore following {0} command.",pa);else{if(this.tb&&this.gridView.isEditing)z.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&(pa=ya.b().ei(pa),F.ULS.sendTraceTag(537159442,0,50,"GridCommandHandler.RestoreCachedStyles: Restore style following {0} command. Formatted text is enabledand IsEditing is true.",
pa)),this.TZa&&(this.gridView.Wb.formattedText=this.TZa);else for(var Qa=this.xA.length,Db=0;Db<Qa;Db++){var Kb,Ab=this.xA[Db].Pia.cell.getRange();if(Kb=this.gridView.Ub(Ab)){Ab=void 0;var ub=Kb.ZE?this.gridView.HJb(Kb.range):(Ab=new P.a,Ab.add(Kb),Ab);Ab=bk(ub);for(ub=Ab.next();!ub.done;ub=Ab.next()){ub=ub.value;if(z.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")){var Mb=ya.b().ei(pa);F.ULS.sendTraceTag(537159440,0,100,"GridCommandHandler.RestoreCachedStyles: Restore style following {0} command. formattedCell.Cell.HasRichText({1}). Cached item {2}. isMerge({3}). Cache size is {4}",
Mb,ub.cell.hasRichText,Db,Kb.ZE,Qa)}if(ub.cell.hasRichText&&1457172838!==pa)this.Gei(Db)&&(ub.cell.formattedText=this.xA[Db].formattedText,z.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&!ub.cell.formattedText&&F.ULS.sendTraceTag(537159439,0,100,"GridCommandHandler.RestoreCachedStyles: Setting FormattedText to null."));else switch(pa){case 1457172838:ub.backgroundColor=this.S$b(Db);z.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&
!ub.backgroundColor&&F.ULS.sendTraceTag(537159438,0,100,"GridCommandHandler.RestoreCachedStyles: Setting BackgroundColor to be empty or null. isNull({0}).",!ub.backgroundColor);break;case 2036397036:ub.color=this.S$b(Db);z.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&!ub.color&&F.ULS.sendTraceTag(537159437,0,100,"GridCommandHandler.RestoreCachedStyles: Setting Color to be empty or null. isNull({0}).",!ub.color);break;case -1904244080:ub.fontSize=this.iJh(Db);
z.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&(ub=ha.c(ub.fontSize)?"null or undefined":ub.fontSize.toString(),F.ULS.sendTraceTag(537159436,0,100,"GridCommandHandler.RestoreCachedStyles: Setting font size to {0}",ub));break;case -1428968098:Mb=z.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation"),this.Am?(ub.CKb(this.S$b(Db),Mb,"RestoreCachedStyles"),ub.CYf(this.hJh(Db))):ub.CKb(this.S$b(Db),Mb,"RestoreCachedStyles")}}}else F.ULS.sendTraceTag(537159441,
0,50,"GridCommandHandler.RestoreCachedStyles: Cell is not supposed to be null. Cell range: {0}",Ab.aB(!1))}z.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&(this.WZa=1461300262);this.x_a()}};d.prototype.x_a=function(){this.tb&&this.gridView.isEditing?this.TZa=null:this.xA=null;z.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&F.ULS.sendTraceTag(537159435,0,50,"GridCommandHandler.ClearCachedStyles: Cache cleared.")};d.prototype.f2h=
function(pa,Qa){var Db={IndentationIncrease:0};if(-1942512156===pa)Db.IndentationIncrease=1;else if(-1920201820===pa)Db.IndentationIncrease=-1;else return!0;Db.ValidMembers=256;this.Fg.formatCells(pa,Db,Qa);return!0};d.prototype.F2h=function(pa,Qa){var Db=pa;!Yb.g(this.$).rtl||-1649235364!==pa&&524773427!==pa||(Db=-1649235364===pa?524773427:-1649235364);switch(Db){case -1649235364:Db=ka.a.rotateTextUp45;break;case 524773427:Db=ka.a.Itc;break;case 1886217042:Db=ka.a.rotateTextUp90;break;case 928057943:Db=
ka.a.Ktc;break;case -1526602249:Db=ka.a.verticalText;break;default:return!1}var Kb={ValidMembers:512};Kb.TextOrientation=Db;this.Fg.formatCells(pa,Kb,Qa);return!0};d.prototype.c2h=function(){var pa=this,Qa=Yb.g(this.$),Db=ja.r(Qa.ha.sa.selectedRanges,this.$),Kb=ja.o(Qa.ha.sa.activeCell,this.$);F.ULS.sendTraceTag(42566215,0,50,"GridCommandHandler: HandleIgnoreErrorCommand Invoked.");return ua.a(this.$.userOperationManager,function(Ab,ub,Mb){return ba.q(pa.$.oa.xa,Kb,Db,Ab,ub,Mb,null)},function(Ab){return new Xa.a(201,
0,Ab)},null)};d.prototype.G4e=function(pa,Qa){var Db=null,Kb=Yb.g(this.$).ha.sa.selectedRanges;Kb=this.gridView.K$("MoreColors",Kb,1,!0);try{for(Kb.$$rst();Kb.$$mn();){var Ab=Kb.$$cu().cell;if(Ab){var ub=d.black;if(1970784898===pa)ub=Ab.color;else if(1650812936===pa){var Mb=Ab.backgroundColor;ub=sa.a.compare(Mb,d.QVd,!0)&&sa.a.compare(Mb,d.empty,!0)?Ab.backgroundColor:d.white}if(!Db)Db=ub;else if(Db!==ub){Db=d.black;break}}}}finally{Kb&&Kb.dispose()}this.tb&&this.gridView.isEditing&&1970784898===
pa&&this.gridView.Gi.textBox.Tse();return this.moreColorsHelper.mxa(pa,Qa,Db)};d.prototype.s2h=function(pa){var Qa=H.a.T3a(this.borderFormatManager.g3);return this.moreColorsHelper.mxa(-236759591,pa,Qa)};d.prototype.Inb=function(pa,Qa,Db,Kb){var Ab=this;Kb=void 0===Kb?!1:Kb;Qa?this.gridView.Gi.xHf(Db.Font):(this.Tvi(pa),Kb?window.requestAnimationFrame(function(){K.FocusManager.instance().Gj(N.AFrame.V$);Ab.gridView.Gi.NTe(Db.Font)}):(K.FocusManager.instance().Gj(N.AFrame.V$),this.gridView.Gi.NTe(Db.Font)),
this.x_a())};d.prototype.Tvi=function(pa){var Qa=ca.a(pa.command);pa=M.a[pa.Le]+"_"+C.a[pa.method];var Db=this.gridView.$b.owe.toString(),Kb=new Map;Kb.set("Command",Qa);Kb.set("Source",pa);Kb.set("Ribbon","React");Kb.set("CellTextRuns",Db);Q.Health.instance.recordKpiUsage(ab.a.zCh,0,Cb.a.iTf,Kb)};d.prototype.Vgd=function(pa,Qa,Db){pa=this.borderFormatManager.Vgd(pa,Qa,Db);this.moreColorsHelper&&this.moreColorsHelper.Sca(Qa,this.borderFormatManager.g3,Db);return pa};d.prototype.getThemeColor=function(pa){var Qa=
{};var Db=!1;if((pa.SqmControlId||"").includes("ThemeColorPicker")){if(!this.themesManager)return F.ULS.sendTraceTag(537159433,0,10,"GridCommandHandler.GetThemeColor: Themes Manager is null"),{returnValue:!1,themeColor:Qa};Db=this.themesManager.getThemeColor(pa.Color);pa=Db.themeIndex;var Kb=Db.aBa;if(Db=Db.returnValue)Qa.ThemeColorIndex=pa,Qa.ThemeColorRow=Kb}return{returnValue:Db,themeColor:Qa}};d.Vhi=function(pa){return-1150205178===pa||-1142465846===pa||-286432209===pa};d.ivc=function(pa){var Qa=
{},Db={};Qa.ValidMembers=16;Qa.Font=Db;Db.ValidMembers=pa;return Qa};d.YXe=function(pa,Qa){var Db=pa.top<Qa.top?3:pa.bottom>Qa.bottom?0:-1;return Db=pa.left<Qa.left?1:pa.right>Qa.right?2:Db};Mf.Object.defineProperties(d.prototype,{Fff:{configurable:!0,enumerable:!0,get:function(){return G.a.all(this.gridView.ha.sa.selectedRanges,function(pa){return pa.isRow})}},Aff:{configurable:!0,enumerable:!0,get:function(){return G.a.all(this.gridView.ha.sa.selectedRanges,function(pa){return pa.Te})}},themesManager:{configurable:!0,
enumerable:!0,get:function(){this.Zw||(this.Zw=this.$.da.za(422));return this.Zw}}});Mf.Object.defineProperties(d,{jZi:{configurable:!0,enumerable:!0,get:function(){return d.Ice||(d.Ice=RegExp("^[0-9]+[.]?[0-9]*$"))}},Wkd:{configurable:!0,enumerable:!0,get:function(){var pa={};return d.o7d||(d.o7d=(pa.InsertRows=5,pa.InsertColumns=9,pa.InsertCellsShiftRight=17,pa.InsertCellsShiftDown=33,pa.DeleteRows=6,pa.DeleteColumns=10,pa.DeleteCellsShiftLeft=18,pa.DeleteCellsShiftUp=34,pa.DeleteRowsTable=6,pa.DeleteColumnsTable=
10,pa.InsertRowsTable=5,pa.InsertColumnsTable=9,pa))}},KYa:{configurable:!0,enumerable:!0,get:function(){var pa={};return d.igb||(d.igb=(pa["-394785302"]=0,pa["-571165336"]=2,pa["1041132226"]=1,pa["-1150205178"]=1,pa["-1142465846"]=2,pa["-286432209"]=3,pa))}},Sof:{configurable:!0,enumerable:!0,get:function(){var pa={};return d.bae||(d.bae=(pa["-167499203"]=2,pa["-255094134"]=5,pa["1097660126"]=6,pa["155820588"]=7,pa))}}});d.QVd="transparent";d.notSet="-1";d.black="#000000";d.empty="";d.white="#FFFFFF";
d.o7d=null;d.igb=null;d.bae=null;d.Ice=null;d.jJa=[8,9,10,11,12,14,16,18,20,24,26,28,36,48,72];Object(u.a)(d,"GridCommandHandler",null,[429]);var Ua=I.a;Rk(c,Ua);c.prototype.Ad=function(){var pa=this,Qa=B.GetServiceTaskFactory.create(this.$.da,111,this.la,this.hb),Db=B.GetServiceTaskFactory.create(this.$.da,18,this.la,this.hb),Kb=B.GetServiceTaskFactory.create(this.$.da,397,this.la,this.hb),Ab=B.GetServiceTaskFactory.Ra(this.$.da,502,503,this.hb);if(z.EwaSettings.isChangeGateEnabled("OfficeVSO:5680290_AddBorderFormatManagerFactory")){var ub=
B.GetServiceTaskFactory.Ra(this.$.da,296,468,this.hb);A.TaskExtensions.Aa(A.TaskExtensions.Vd([Qa,Db,Kb,ub,Ab],this.la),function(){pa.jd([new d(pa.$,Yb.g(pa.$),Db.result,Qa.result,ub.result,Kb.result,Ab.result)])},this.la,3)}else{var Mb=B.GetServiceTaskFactory.create(this.$.da,102,this.la,this.hb);A.TaskExtensions.Aa(A.TaskExtensions.Vd([Qa,Db,Mb,Kb,Ab],this.la),function(){pa.jd([new d(pa.$,Yb.g(pa.$),Db.result,Qa.result,new x.BorderFormatManager(pa.$,Db.result,Mb.result),Kb.result,Ab.result)])},
this.la,3)}};c.ka=function(pa){I.a.Qd(80,new c(pa))};Object(u.a)(c,"GridCommandHandlerFactory",I.a,[]);b.d(E,"a",function(){return a})},1376:function(u,E,b){function a(){Type.registerNamespace("Common.App.GestureManager");c.main()}function c(){this.fb=null;this.Sw=!1}function d(C,Q){var P=K.call(this)||this;P.Xpa=w.a.sGh;P.fOc=!!window.PointerEvent;P.nhe=window.hasOwnProperty("ontouchstart");P.akb=null;P.zVa=null;P.J8=!1;P.YS=new B.a;P.ukb=new B.a;P.vog=new r.a;P.spa=null;P.Ulb=!1;P.k2d=!1;P.Ode=
!1;P.aMc=!1;P.vFc=!1;P.e2d=!1;P.zIc=!1;P.CUa=!1;P.Djb=-1;P.PQc=null;P.session=null;P.handlers=null;P.element=null;P.curRecognizer=null;P.Ld=O.EventHandlerManager.instance;P.fOc?(v.ULS.sendTraceTag(593893141,310,50,"Using pointer events"),P.akb=Object(y.a)(P,P.Dnc,"onPointerEvent"),P.zVa=I.a.uGh):P.nhe?(v.ULS.sendTraceTag(593893140,310,50,"Using touch events"),P.akb=Object(y.a)(P,P.yya,"onTouchEvent"),P.zVa=I.a.touchEvents):(v.ULS.sendTraceTag(593893139,310,50,"Using mouse events"),P.akb=Object(y.a)(P,
P.nnc,"onMouseEvent"),P.zVa=I.a.tGh);P.ph=Q;P.Zea=C;z.AFrameworkApplication.fa&&(P.Ulb=z.AFrameworkApplication.fa.qa("UsePointerCaptureIsEnabled"),P.k2d=z.AFrameworkApplication.fa.qa("ClearCacheOnPrimaryPointerIsEnabled"),P.Ode=z.AFrameworkApplication.fa.qa("ResetHandledBeforeInputHandlerIsEnabled"),P.aMc=z.AFrameworkApplication.fa.qa("LogCoalescedEventsIsEnabled"),P.vFc=z.AFrameworkApplication.fa.qa("CheckExistenceOfGetCoalescedEventsIsEnabled"),P.e2d=z.AFrameworkApplication.fa.qa("CheckIfHammerExistsAfterDownloadIsEnabled"),
P.zIc=z.AFrameworkApplication.fa.qa("HammerJsPerformanceTimersIsEnabled"),P.CUa=P.Ulb&&z.AFrameworkApplication.fa.qa("CancelDragFromGestureInputManagerIsEnabled")&&z.AFrameworkApplication.fa.qa("UseGestureInputManagerPointerCacheIsEnabled"));return P}function e(){}function k(){this.srcEvent=this.pointerType=this.changedPointers=this.pointers=null;this.maxPointers=this.rotation=this.scale=this.angle=this.distance=this.overallVelocity=this.overallVelocityY=this.overallVelocityX=0;this.additionalEvent=
this.center=this.target=null;this.isFinal=this.isFirst=!1;this.deltaTime=this.timeStamp=this.deltaY=this.deltaX=this.eventType=0;this.offsetDirection=null}function l(C,Q,P,ka,R,fa,ca,ea,wa){C=T.call(this,C,P,ka,fa)||this;C.Ogb=Q;C.Yfa=ca;C.wX=ea;C.XYj=wa;C.uog=R;return C}function n(){this.MGc=null}function f(){this.Uca=this.eVe=null}u=b(0);var v=b(14),r=b(202),y=b(84),m=b(85),w=b(409),B=b(100),A=b(43);Object(u.a)(f,"GestureAdapterInfo",null,[]);var z=b(4),x=b(392),D=b(236);n.prototype.fsi=function(){if(!this.MGc){var C=
"hammer.min.js";z.AFrameworkApplication.fa.Zn("IsServerFlavorDebug")&&(C=z.AFrameworkApplication.fa.qa("IsServerFlavorDebug")?"hammer.js":"hammer.min.js");C=z.AFrameworkApplication.NK(String.format("{0}",C),5);C=D.a.create(C,null,null);x.a.lia(C);this.MGc=C.K7a}return this.MGc};Mf.Object.defineProperties(n,{instance:{configurable:!0,enumerable:!0,get:function(){n.Ma||(n.Ma=new n);return n.Ma}}});n.Ma=null;Object(u.a)(n,"HammerJsDependencyLoader",null,[717]);var I=b(13),F;(function(C){C[C.none=-1]=
"none";C[C.pinch=0]="pinch";C[C.pan=1]="pan";C[C.swipe=2]="swipe"})(F||(F={}));Object(u.b)("GestureEvent",F);var G=b(75),T=G.a;Rk(l,T);l.create=function(C,Q,P,ka,R,fa){if(P.rawEvent)if(fa){var ca=P.rawEvent;ca=new Sys.UI.Point(ca.clientX,ca.clientY)}else ca=G.a.Kub(P);else ca=new Sys.UI.Point(P.clientX,P.clientY);return new l(C,ca,Q,P,ka,R,P.shiftKey,P.ctrlKey,fa)};Mf.Object.defineProperties(l.prototype,{shiftKey:{configurable:!0,enumerable:!0,get:function(){return this.Yfa}},ctrlKey:{configurable:!0,
enumerable:!0,get:function(){return this.wX}},clientPoint:{configurable:!0,enumerable:!0,get:function(){return this.Ogb}},Dua:{configurable:!0,enumerable:!0,get:function(){return this.uog}}});Object(u.a)(l,"GestureEventArgs",G.a,[]);Object(u.a)(k,"GestureManagerData",null,[]);e.Hig=2;e.Iig=4;e.Jig=8;e.Kig=8;Object(u.a)(e,"HammerConstants",null,[]);var O=b(92),U=b(212),J=b(29),H=b(77),K=A.a;Rk(d,K);d.prototype.POh=function(){return this.fOc?0:this.nhe?1:2};d.prototype.Wm=function(C){K.prototype.Wm.call(this,
C);this.Ld.Vja(this.zVa,C,0,this.akb)};d.prototype.$l=function(C){K.prototype.$l.call(this,C);this.Ld.YHa(C,this.zVa)};d.prototype.y7i=function(C,Q,P){var ka=this;P=void 0===P?null:P;var R=void 0===R?null:R;z.AFrameworkApplication.Hgc()?n.instance.fsi().continueWith(function(fa){ka.dEj();if(fa.Xf||fa.zh)v.ULS.sendTraceTag(591192778,310,10,"Hammer did not download correctly: {0}",fa.status);else{v.ULS.sendTraceTag(591192779,310,50,"Hammer download status: {0}",fa.status);if(ka.e2d){fa=window.Hammer;
if("undefined"===typeof fa){v.ULS.sendTraceTag(590901389,310,10,"Hammer does not exist");ka.lyc();return}if("undefined"===typeof fa.inputHandler){v.ULS.sendTraceTag(590901390,310,10,"Hammer.inputHandler does not exist");ka.lyc();return}}if(!C)throw ka.lyc(),Error.argumentNull("source element can not be null");fa=U.a.cva(C,ka.Xpa);if(void 0===fa||null===fa)fa=new B.a,U.a.scb(C,ka.Xpa,fa),ka.z7i(C);var ca=null;if(!fa.kb(F[0])){ca=Object;var ea=ca.assign,wa=new f,X=F[0],ja=R;ja=void 0===ja?null:ja;if(void 0===
ka||null===ka)throw v.ULS.sendTraceTag(42256258,310,10,"manager cannot be null"),Error.argumentNull("manager can not be null");var va=null;switch(X){case I.a.pinch:va=new Hammer.Pinch(ja);break;case I.a.pan:va=new Hammer.Pan(ja)}va&&(va.manager=ka);ca=ea.call(ca,wa,{Uca:va,eVe:Q});fa.add(F[0],ca)}if(void 0!==P&&null!==P)for(ea=0;ea<P.length;ea++)fa.kb(F[P[ea]])&&(wa=fa.na(F[P[ea]]),ca.Uca.recognizeWith(wa.Uca))}ka.lyc()}):v.ULS.sendTraceTag(42256219,310,10,"Multi Touch is not enabled either from common BRS or from your app BRS")};
d.prototype.dEj=function(){this.zIc&&(this.ph?this.PQc=this.ph.sc("Task","RegisterGestureAdapterAfterLoad"):v.ULS.sendTraceTag(590387074,310,10,"_stopwatchBuilder is null"))};d.prototype.lyc=function(){this.zIc&&(this.PQc?this.PQc.stop():v.ULS.sendTraceTag(590387075,310,10,"_stopwatchForRegisterGestureAdapterAfterLoad is null"))};d.prototype.z7i=function(C){this.vog.add(C);this.Ld.Vja(this.zVa,C,0,this.akb)};d.prototype.recognize=function(C){for(var Q=Array(C.pointers.length),P=0;P<C.pointers.length;P++)Q[P]=
C.pointers[P].target;P=null;for(this.spa=this.aRh(Q);void 0!==this.spa&&null!==this.spa&&(P=U.a.cva(this.spa,this.Xpa),void 0===P||null===P);this.spa=this.spa.parentNode);if(void 0!==P&&null!==P){this.curRecognizer&&this.curRecognizer.state===e.Kig&&(this.curRecognizer=null);Q=bk(P.keys);for(var ka=Q.next();!ka.done;ka=Q.next()){ka=P.na(ka.value);void 0!==ka&&null!==ka&&void 0!==ka.Uca&&null!==ka.Uca&&(void 0===this.curRecognizer||null===this.curRecognizer||ka.Uca===this.curRecognizer||ka.Uca.canRecognizeWith(this.curRecognizer))&&
ka.Uca.recognize(C);var R=ka.Uca.state;this.curRecognizer||e.Hig!==R&&e.Iig!==R&&e.Jig!==R||(this.curRecognizer=ka.Uca)}}};d.prototype.emit=function(C,Q){if("hammer.input"!==C){this.J8=!1;Q=l.create(C,this.spa,Q.srcEvent,Q,3,this.fOc);var P=U.a.cva(this.spa,this.Xpa);if(this.Xji(C))var ka=0;else if(this.Oji(C))ka=1;else if(this.Lmi(C))ka=2;else{v.ULS.sendTraceTag(42256256,310,15,"Event can not be recognized by current manager");return}P=P.yc(F[ka]).value;void 0!==P&&null!==P&&((P=P.eVe,P.Ehi())?C.endsWith("start")?
this.J8=P.iKi(Q):C.endsWith("end")?(P.gKi(Q),this.J8=!0):C.endsWith("cancel")?(P.fKi(Q),this.J8=!0):C.endsWith("move")&&(this.J8=P.hKi(Q)):v.ULS.sendTraceTag(42256257,310,50,"App rejected to perform gesture now : {0}",C))}};d.prototype.get=function(C){return Object(m.a)(Hammer.Recognizer,C)};d.prototype.aRh=function(C){if(1>C.length)return null;if(1===C.length)return C[0];for(var Q=C[0],P=!0,ka=1;ka<C.length;ka++){if(!C[ka])return null;if(Q!==C[ka]){P=!1;break}}if(P)return Q;Q=this.xVe(C[0]);P=0;
C=bk(C);for(ka=C.next();!ka.done;ka=C.next()){ka=this.xVe(ka.value);if(Q.na(Q.count-1)!==ka.na(ka.count-1))return null;for(var R=Q.count-2,fa=ka.count-2;R>=P&&0<=fa;R--,fa--)if(Q.na(R)!==ka.na(fa)){P=R+1;break}}return Q.na(P)};d.prototype.xVe=function(C){for(var Q=new r.a;void 0!==C&&null!==C;C=C.parentNode)Q.add(C);return Q};d.prototype.$Ye=function(C){switch(C){case I.a.rf:case I.a.fha:return 1;case I.a.lg:case I.a.gha:return 2;case I.a.pe:case I.a.qGa:return 4;case I.a.Rzc:case I.a.PXc:return 8}return 0};
d.prototype.yya=function(C,Q,P){C=this.$Ye(C);Q=this.NPh(P);Hammer.inputHandler(this,C,Q);this.J8&&P.preventDefault();return this.J8};d.prototype.n5e=function(){return 1<this.YS.count};d.prototype.t1b=function(){v.ULS.sendTraceTag(594055960,310,50,"CancelPendingPointerEvents");if(this.Ulb)for(var C=bk(this.YS),Q=C.next();!Q.done;Q=C.next())this.rOf(Q.value.key);else this.YS=new B.a;this.session=null};d.prototype.tBg=function(C,Q,P){v.ULS.sendTraceTag(594055959,310,50,"AddOrReplacePointerInCaches: pointerId: {0}",
C);if(!this.ukb.kb(C)){try{Q.setPointerCapture(C)}catch(ka){v.ULS.sendTraceTag(594055958,310,10,"Exception: {0}",ka)}this.ukb.add(C,Q)}this.YS.ia(C,P);this.CUa&&1<this.YS.count&&this.Zea&&!this.Zea.spb&&(this.Zea.spb=!0)};d.prototype.rOf=function(C){v.ULS.sendTraceTag(594055957,310,50,"RemovePointerFromCaches: pointerId: {0}",C);if(this.ukb.kb(C)){try{this.ukb.na(C).releasePointerCapture(C)}catch(Q){v.ULS.sendTraceTag(594055956,310,10,"Exception: {0}",Q)}this.ukb.remove(C)}else v.ULS.sendTraceTag(594055955,
310,10,"RemovePointerFromCaches: pointerId should be in cache: {0}",C);this.YS.remove(C);this.CUa&&1>=this.YS.count&&this.Zea&&this.Zea.spb&&(this.Zea.spb=!1)};d.prototype.Dnc=function(C,Q,P){var ka=P.rawEvent.pointerType.toString(),R=P.rawEvent.pointerId.toString();if("touch"!==ka)return!1;C=this.$Ye(C);if(1!==C&&!this.YS.kb(R))return!1;this.k2d&&1===C&&P.rawEvent.isPrimary&&this.YS.count&&(v.ULS.sendTraceTag(593839564,310,10,"Pointer cache should be empty"),this.t1b());this.Ulb?this.tBg(R,Q,P):
this.YS.ia(R,P);this.aMc&&2===C&&(!this.vFc||this.vFc&&"function"===typeof P.rawEvent.getCoalescedEvents)&&(Q=P.rawEvent.getCoalescedEvents())&&this.n5e()&&(this.Djb=Math.max(this.Djb,Q.length));this.Ode&&(this.J8=!1);ka=this.MPh(this.YS,P,ka);Hammer.inputHandler(this,C,ka);if(4===C||8===C)this.Ulb?this.rOf(R):this.YS.remove(R),this.YS.count||(this.session=null,this.aMc&&-1!==this.Djb&&(v.ULS.sendTraceTag(593597138,310,50,"Max number of coalesced events: {0}",this.Djb),this.Djb=-1));this.J8&&P.preventDefault();
return this.J8};d.prototype.nnc=function(){return!1};d.prototype.NPh=function(C){var Q=new k,P=C.rawEvent,ka=P.touches;P=P.changedTouches;Q.pointers=Array.clone(ka);Q.pointers=Array.clone(0<ka.length?ka:P);Q.changedPointers=Array.clone(P);Q.srcEvent=C;Q.pointerType="touch";return Q};d.prototype.MPh=function(C,Q,P){var ka=new k;ka.pointers=H.toArray(C.values);ka.changedPointers=[Q];ka.pointerType=P;ka.srcEvent=Q;return ka};d.prototype.Xji=function(C){return J.a.startsWith(C,I.a.pinch)};d.prototype.Oji=
function(C){return J.a.startsWith(C,I.a.pan)};d.prototype.Lmi=function(C){return J.a.startsWith(C,I.a.swipe)};Object(u.a)(d,"GestureInputManager",A.a,[687,688]);var N=b(291),M=b(254);c.prototype.Ph=function(C){C.register(d,"Common.App.GestureManager.GestureInputManager").as("Common.IGestureInputManager").tc().Cc(function(){return new d(N.a.instance,z.AFrameworkApplication.ta.pD)});this.fb=C};c.prototype.init=function(){this.Sw||(this.fb.resolve("Common.App.GestureManager.GestureInputManager"),this.Sw=
!0)};c.prototype.dispose=function(){};c.main=function(){M.a.instance.Qi(new c)};Mf.Object.defineProperties(c.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.GestureInputManager"}}});Object(u.a)(c,"GestureInputManagerPackage",null,[10,11]);b.d(E,"a",function(){return a})},1389:function(u,E,b){function a(){v.a.Fa(function(ib){ib.da.Ga(150,new c(ib))})}function c(ib){var La=ob.call(this)||this;La.$=ib;La.Eb();return La}function d(ib){var La=Ha.call(this,document.createElement("div"))||
this;La.XQ=!1;La.zQ=!1;La.S0b=!1;La.Ah=null;La.Kh=null;La.Ufi=Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:6172290_DataValidationConditionalHideAll");La.Vfi=Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:6172279_DataValidationConstButtonWidth");La.Wnd=!1;La.Pod=!1;La.Rld=!1;La.A5b=[];La.Ch=function(){La.i2f(!1)};La.oOa=function(Fb,Yb){La.show(La.PQ,!La.isListVisible,!0,y.a.Wo||3===Yb.lb||3===G.a.Cb);La.Tyd(null,null)};La.Tyd=function(){La.gridView.setFocus()};La.cLa=function(){La.Ya.textBox.UJ=!0};
La.Xs=function(){La.xcg()};La.onContentReady=function(){La.i2f(La.isListVisible)};La.Fc=function(){La.Jx()};La.uya=function(){La.aRa()};La.tvf=function(){La.xcg()};La.$=ib;La.gridView=N.g(La.$);La.DI=La.gridView.Wb;var zb="<div id='dv_reader_description' class='"+z.a.zMe+"' role='alert' aria-live='polite'></div>\r\n<div id='dv_list_button' class='"+f.Nnh+" "+D.a.Gp+"'></div>\r\n<div id='dv_list_box' class='"+f.Umh+" "+D.a.Lo+" "+D.a.Gp+"'></div>\r\n<div id='dv_prompt_box' class='"+f.Lnh+" "+D.a.Gp+
"'></div>";La.domElement.className=f.Mnh;La.domElement.innerHTML=zb;qa.d(La.style,La.isGridRtl);La.Pf=$get("dv_list_box",La.domElement);La.P_=$get("dv_prompt_box",La.domElement);La.hsa=$get("dv_list_button",La.domElement);La.ABb=$get("dv_reader_description",La.domElement);(zb=da.a(ib))&&La.A5b.push(new k(ib,zb,La));La.A5b.push(new k(ib,La.gridView.Wb,La));La.gridView.ha.hJ(La.Ch);La.gridView.yu(La.onContentReady);La.gridView.$b.dEg(La.tvf);La.$.Bk(La.Fc);zb=La.gridView.yj;zb.insertBefore(La.domElement,
zb.firstChild);La.onContentReady(null,null);ib.da.Ga(14,La);return La}function e(ib,La,zb){ib=xa.call(this,ib,La,new Ka.a(f.listItem,f.yBb,f.BBb,f.CBb))||this;ib.hlb=null;ib.fe=null;ib.vda=null;ib.AV=null;ib.SHa=null;ib.hNa=0;ib.pFb=[];ib.AQj=Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:6172276_UpdateDvListHeightUsingItemHeight");ib.ABb=zb;return ib}function k(ib,La,zb){ib=aa.call(this,ib,La)||this;ib.dataValidationControl=zb;return ib}function l(ib,La,zb){var Fb=ua.call(this,ib)||this;Fb.xx=null;
Fb.IU=null;Fb.hff=!1;Fb.errorMessage=null;Fb.A6e=null;Fb.um=null;Fb.Qda=null;Fb.aFe=function(Yb){var kb=Fb.$,vb=Fb.hff;Fb.hide();var Wa=N.g(kb);Wa.isEditing&&Wa.Wb.endEdit(!1,"DataValidationErrorDialog.DataValidationErrorDialogHandler",0);1===Yb&&vb&&H.TaskExtensions.Aa(Wa.startEdit(!1,1),function(){var yb=Wa.Wb.textBox;yb.text&&yb.selectRange(0,yb.text.length)},Fb.la,11,C.a.current);if(1===Yb&&!vb){if(vb=Wa.Ub(null)){Wa.Ea.lV();var qb=Object(T.a)(new M.a,{Text:vb.cell.userInput});Wa.setCell(qb,vb.range,
0,63,null)}kb.Fd(-798660877,G.a.Cb,8,null)}2===Yb&&H.TaskExtensions.Aa(Wa.startEdit(!1,0),function(){var yb=Wa.Wb.textBox;yb.text&&yb.selectRange(0,yb.text.length)},Fb.la,11,C.a.current)};Fb.l9a=function(){X.HelperMethods.RV(Fb.$.aG,Fb.error.HelpTopicId,Fb.$.nS)};Fb.ZLi=function(){Fb.hxb();Fb.$.Fd(802602464,2,8,Fb.IU)};Fb.uKi=function(){O.ULS.sendTraceTag(537163288,0,10,"DataValidationErrorDialog.OnGetDataValidationRuleInformationFailureCallback, failed to get expected results.")};Fb.vKi=function(Yb){!Yb||
wa.a(Yb)?O.ULS.sendTraceTag(537163287,0,10,"DataValidationErrorDialog.OnGetDataValidationRuleInformationSuccessCallback, failed to get expected results."):(Yb=Fb.NVh(Yb.Result),Fb.xx.errorInformation=Yb,Fb.kTa(Fb.DIa,Fb.Y3a(Fb.aFe),Fb.xx))};Fb.izd=function(){Fb.show(Fb.QRb)};Fb.gLe=zb;Fb.sqmManager=va.a(Fb.$);Fb.error=l.tQ(La,ib,zb);Fb.ob.Cp=Fb;ib=ib.da.za(14);Fb.Eu=ib.o3a(Fb.gLe);Fb.DIa=Fb.Eu&&Fb.Eu.DIa?Fb.Eu.DIa:K.a.instance.ga(1712);Fb.Soj();Fb.initializeAndShow(Fb.DIa,Fb.aFe,Fb.xx);return Fb}
function n(ib,La,zb){var Fb=Q.call(this,ib,n.tQ(La,ib,zb))||this;Fb.Rc=function(){Fb.setFocus()};N.g(Fb.$).ha.vG(Fb.Rc);(ib=ib.da.za(14).o3a(zb))&&ib.options&1&&O.ULS.sendTraceTag(537163291,0,50,"DataValidationErrorDeprecatedDialog.DataValidationErrorDeprecatedDialogs, Data validation Error opened on a list rule.");return Fb}function f(){}var v=b(10);u=b(0);var r=b(232),y=b(27),m=b(89),w=b(29),B=b(440),A=b(244);f.Mnh="ewa-dv";f.Nnh="ewa-dv-buttonarea";f.Umh="ewa-dlb";f.BBb="list-table";f.listItem=
"list-item";f.yBb="list-item-selected";f.CBb="list-table-touch";f.Lnh="ewa-dpb";f.Whh="dv-prompt-title";f.Vhh="dv-prompt-message";Object(u.a)(f,"CssClassNames",null,[]);var z=b(30),x=b(618),D=b(19),I=b(48),F=b(461),G=b(76),T=b(7),O=b(14),U=b(160),J=b(1029),H=b(37),K=b(15),N=b(21),M=b(274),C=b(63),Q=U.ErrorDialog;Rk(n,Q);n.prototype.dispose=function(){N.g(this.$).ha.zF(this.Rc);Q.prototype.dispose.call(this)};n.prototype.setFocus=function(){switch(this.error.Severity){case 0:var ib=4;break;case 1:ib=
3;break;case 2:ib=0;break;default:ib=this.closeAction}(ib=this.getButton(ib))?ib.get_element().focus():Q.prototype.setFocus.call(this)};n.prototype.lqb=function(){var ib=N.g(this.$);ib.isEditing&&ib.Wb.endEdit(!1,"DataValidationErrorDeprecatedDialog.CommitAfterClosing",0);4===this.returnValue&&this.GSd(1);if(2===this.returnValue||0===this.returnValue){var La=ib.Ub(null);if(La){ib.Ea.lV();var zb=Object(T.a)(new M.a,{Text:La.originalText});ib.setCell(zb,La.range,0,63,null)}this.$.Fd(-798660877,G.a.Cb,
8,null)}Q.prototype.lqb.call(this)};n.prototype.nsa=function(){var ib=N.g(this.$);ib.isEditing&&ib.Wb.endEdit(!1,"DataValidationErrorDeprecatedDialog.CancelAfterClosing",0);3===this.returnValue&&this.GSd(0);Q.prototype.nsa.call(this)};n.prototype.GSd=function(ib){var La=N.g(this.$);H.TaskExtensions.Aa(La.startEdit(!1,ib),function(){var zb=La.Wb.textBox;zb.text&&zb.selectRange(0,zb.text.length)},this.la,11,C.a.current)};n.tQ=function(ib,La,zb){zb=La.da.za(14).o3a(zb);ib.MessageId=-1083021405;ib.MessageIdName=
"DataValidationError";ib.MessageIdHash=w.a.Kv(ib.MessageIdName);ib.Severity=zb?zb.R7c:1;La=(null===zb||void 0===zb?0:zb.DIa)?w.a.zg(zb.DIa):null;zb=(null===zb||void 0===zb?0:zb.error)?w.a.zg(zb.error):String.format("<p>{0}</p><p>{1}</p>",K.a.instance.ga(893),K.a.instance.ga(894));switch(ib.Severity){case 0:ib.Appearance=18;break;case 1:ib.Appearance=12;zb+=String.format("<p>{0}</p>",K.a.instance.ga(895));break;default:ib.Appearance=3}ib.Caption=La;ib.Description=zb;ib.HelpDescription=K.a.instance.ga(1300);
ib.HelpTopicId=J.a.$Ee;return ib};Object(u.a)(n,"DataValidationErrorDeprecatedDialog",U.ErrorDialog,[]);U=b(389);var P=b(5),ka=b(45),R=b(255),fa=b(197),ca=b(53),ea=b(31),wa=b(295),X=b(11),ja=b(294),va=b(165),ua=U.a;Rk(l,ua);l.prototype.dispose=function(){this===this.ob.Cp&&(this.ob.Cp=null);m.a.Ia(this.um);this.um=null;ua.prototype.dispose.call(this)};l.prototype.Soj=function(){this.Eu&&this.Eu.error?this.errorMessage=this.Eu.error:this.Eu&&this.Eu.options&1?(O.ULS.sendTraceTag(537163289,0,50,"DataValidationErrorDialog.SetDialogProps, Data validation Error opened on a list rule."),
this.errorMessage=K.a.instance.ga(1714),this.A6e=ca.a.current.Ro(117)):(this.errorMessage=K.a.instance.ga(1713),this.JLh(this.gLe));var ib=this.Eu?this.Eu.R7c:1,La={};this.xx=(La[l.Vv]=this.nc,La.errorDescription=this.errorMessage,La.helpImageUri=this.A6e,La);switch(ib){case 0:this.Rb=1;this.mc(1,"Retry");this.xx.dialogIcon=2;this.hff=!0;break;case 1:this.Rb=4;this.xx.dialogIcon=1;this.xx.additionalInformation=K.a.instance.ga(895);break;default:this.Rb=1,this.xx.dialogIcon=3}ib={};this.xx.helpLink=
(ib.type="AppLinkProps",ib[l.Vv]=this.error.HelpTopicId,ib.text=K.a.instance.ga(1300),ib.handler=this.l9a,ib);ib=ea.a.ZVc([this.error]);La={};this.IU=(La[P.a.c9b]=!0,La[P.a.X9c]=ib,La[P.a.Y9c]=va.a(this.$).Usb(this.error.MessageIdHash),La[P.a.NU]=this.nc,La.DismissHandler=this.izd,La);ib={};this.xx.giveFeedbackLink=(ib.type="AppLinkProps",ib[l.Vv]=P.a.Dgd,ib.text=K.a.instance.ga(1750),ib.handler=this.ZLi,ib)};l.prototype.JLh=function(ib){var La=this.$.oa.xa.Pb();R.f(this.$.oa.xa,ka.q(ib,this.$),ja.b(this.vKi),
ja.a(this.uKi),null,La)};l.prototype.NVh=function(ib){switch(ib.RuleType){case 1:switch(ib.ConditionType){case 0:var La=K.a.instance.mb(108);return String.format(La,ib.LowerBoundary,ib.UpperBoundary);case 1:return La=K.a.instance.mb(109),String.format(La,ib.LowerBoundary,ib.UpperBoundary);case 2:return La=K.a.instance.mb(110),String.format(La,ib.LowerBoundary);case 3:return La=K.a.instance.mb(111),String.format(La,ib.LowerBoundary);case 4:return La=K.a.instance.mb(112),String.format(La,ib.LowerBoundary);
case 5:return La=K.a.instance.mb(113),String.format(La,ib.UpperBoundary);case 6:return La=K.a.instance.mb(114),String.format(La,ib.LowerBoundary);case 7:return La=K.a.instance.mb(115),String.format(La,ib.UpperBoundary);default:return"we couldn't get the details"}case 2:switch(ib.ConditionType){case 0:return La=K.a.instance.mb(116),String.format(La,ib.LowerBoundary,ib.UpperBoundary);case 1:return La=K.a.instance.mb(117),String.format(La,ib.LowerBoundary,ib.UpperBoundary);case 2:return La=K.a.instance.mb(118),
String.format(La,ib.LowerBoundary);case 3:return La=K.a.instance.mb(119),String.format(La,ib.LowerBoundary);case 4:return La=K.a.instance.mb(120),String.format(La,ib.LowerBoundary);case 5:return La=K.a.instance.mb(121),String.format(La,ib.UpperBoundary);case 6:return La=K.a.instance.mb(122),String.format(La,ib.LowerBoundary);case 7:return La=K.a.instance.mb(123),String.format(La,ib.UpperBoundary);default:return"we couldn't get the details"}case 4:switch(ib.ConditionType){case 0:return La=K.a.instance.mb(124),
String.format(La,ib.LowerBoundary,ib.UpperBoundary);case 1:return La=K.a.instance.mb(125),String.format(La,ib.LowerBoundary,ib.UpperBoundary);case 2:return La=K.a.instance.mb(126),String.format(La,ib.LowerBoundary);case 3:return La=K.a.instance.mb(127),String.format(La,ib.LowerBoundary);case 4:return La=K.a.instance.mb(128),String.format(La,ib.LowerBoundary);case 5:return La=K.a.instance.mb(129),String.format(La,ib.UpperBoundary);case 6:return La=K.a.instance.mb(130),String.format(La,ib.LowerBoundary);
case 7:return La=K.a.instance.mb(131),String.format(La,ib.UpperBoundary);default:return"we couldn't get the details"}case 5:switch(ib.ConditionType){case 0:return La=K.a.instance.mb(132),String.format(La,ib.LowerBoundary,ib.UpperBoundary);case 1:return La=K.a.instance.mb(133),String.format(La,ib.LowerBoundary,ib.UpperBoundary);case 2:return La=K.a.instance.mb(134),String.format(La,ib.LowerBoundary);case 3:return La=K.a.instance.mb(135),String.format(La,ib.LowerBoundary);case 4:return La=K.a.instance.mb(136),
String.format(La,ib.LowerBoundary);case 5:return La=K.a.instance.mb(137),String.format(La,ib.UpperBoundary);case 6:return La=K.a.instance.mb(138),String.format(La,ib.LowerBoundary);case 7:return La=K.a.instance.mb(139),String.format(La,ib.UpperBoundary);default:return"we couldn't get the details"}case 6:switch(ib.ConditionType){case 0:return La=K.a.instance.mb(140),String.format(La,ib.LowerBoundary,ib.UpperBoundary);case 1:return La=K.a.instance.mb(141),String.format(La,ib.LowerBoundary,ib.UpperBoundary);
case 2:return La=K.a.instance.mb(142),String.format(La,ib.LowerBoundary);case 3:return La=K.a.instance.mb(143),String.format(La,ib.LowerBoundary);case 4:return La=K.a.instance.mb(144),String.format(La,ib.LowerBoundary);case 5:return La=K.a.instance.mb(145),String.format(La,ib.UpperBoundary);case 6:return La=K.a.instance.mb(146),String.format(La,ib.LowerBoundary);case 7:return La=K.a.instance.mb(147),String.format(La,ib.UpperBoundary);default:return"we couldn't get the details"}case 3:return La=K.a.instance.mb(106),
String.format(La,ib.LowerBoundary);case 7:return La=K.a.instance.mb(107),String.format(La,ib.LowerBoundary);default:return"we couldn't get the details"}};l.prototype.GSd=function(ib){var La=N.g(this.$);H.TaskExtensions.Aa(La.startEdit(!1,ib),function(){var zb=La.Wb.textBox;zb.text&&zb.selectRange(0,zb.text.length)},this.la,11,C.a.current)};l.tQ=function(ib,La,zb){La=La.da.za(14).o3a(zb);ib.MessageId=-1083021405;ib.MessageIdName="DataValidationError";ib.MessageIdHash=w.a.Kv(ib.MessageIdName);ib.Severity=
La?La.R7c:1;ib.HelpDescription=K.a.instance.ga(1300);ib.HelpTopicId=J.a.$Ee;return ib};Mf.Object.defineProperties(l.prototype,{nc:{configurable:!0,enumerable:!0,get:function(){return"DataValidationErrorDialog"}},la:{configurable:!0,enumerable:!0,get:function(){this.um=this.um||new fa.a;return this.um.token}}});Object(u.a)(l,"DataValidationErrorDialog",U.a,[465,466,3,424]);U=b(1119);var Xa=b(407),aa=U.a;Rk(k,aa);k.prototype.dispose=function(){this.dataValidationControl=null;aa.prototype.dispose.call(this)};
k.prototype.Hh=function(ib,La){this.dataValidationControl.Ya=this.Ya;var zb=ib.keyCode;return 1461300262!==La||16!==zb&&17!==zb&&18!==zb?aa.prototype.Hh.call(this,ib,La):!1};k.prototype.nyd=function(){this.pV&&(this.dataValidationControl.Ya=this.Ya,this.dataValidationControl.show(this.dataValidationControl.PQ,!0,!0,y.a.Wo||3===G.a.Cb))};k.prototype.Af=function(){};k.prototype.Dh=function(){this.dataValidationControl.show(this.dataValidationControl.PQ,!0,!0,y.a.Wo||3===G.a.Cb)};k.prototype.NEd=function(ib,
La){return this.dataValidationControl.Hh(La)};Mf.Object.defineProperties(k.prototype,{Dyb:{configurable:!0,enumerable:!0,get:function(){return Object(B.a)(l,this.$.ob.Xg)}},pV:{configurable:!0,enumerable:!0,get:function(){return this.dataValidationControl.isListVisible},set:function(ib){this.dataValidationControl.isListVisible=ib}},f5a:{configurable:!0,enumerable:!0,get:function(){return!1}},key:{configurable:!0,enumerable:!0,get:function(){return Xa.a.t4c}}});Object(u.a)(k,"DataValidationListAutoCompleteBehavior",
U.a,[]);var ba=b(276);U=b(1050);var oa=b(12),ra=b(117),db=b(22),Ka=b(1118),Ga=b(1),xa=U.a;Rk(e,xa);e.prototype.dispose=function(){xa.prototype.dispose.call(this);this.ABb=this.hlb=null};e.prototype.hea=function(ib,La,zb,Fb){if(ib&&(!ib||ib.length)){this.D7(!1);this.SHa=ib;this.AV=[];for(var Yb=0;Yb<ib.length;Yb++)this.AV[Yb]=ib[Yb]?ib[Yb].Name:null;Yb=String.format("<table class='{0}' aria-live='polite'><tbody>",this.Uba);var kb="",vb="";ib=0;var Wa=N.g(this.$).Ub(null);Fb=this.isEditing?Fb?Fb.text:
this.editText:Wa?Wa.originalText:null;Wa=!Fb;var qb=0;Array.clear(this.pFb);var yb=[],ec=[],Ob=[],Cb=Fb?Fb.split(" "):[""];Fb=Fb.trim();for(var ab={},ya=0;ya<this.AV.length;ab={dDc:ab.dDc},ya++){var ma=this.AV[ya],ha=void 0;ab.dDc=ma.split(" ");ha=ba.a.all(Cb,function(eb){return function(cb){return ba.a.any(eb.dDc,function(Ua){return db.a.aL(Ua,cb)})}}(ab));var Z=!ma,Na=Array.contains(Ob,ma);Z||Na||this.isEditing&&!ha||(ha=ma?w.a.zg(w.a.a7c(ma)):"",ha=String.format("<tr>\r\n\t<td class='{0}'>{1}</td>\r\n</tr>",
this.i_,ha),Ob.push(ma),this.isEditing&&db.a.aL(ma,Fb)?(kb+=ha,yb.push(ya)):(vb+=ha,ec.push(ya)),!Wa&&db.a.equals(Fb,ma,!0)&&(ib=this.isEditing?yb.length-1:qb,Wa=!0),qb++)}this.hNa=qb;Array.addRange(this.pFb,yb);Array.addRange(this.pFb,ec);this.Pf.innerHTML=Yb+(kb+vb+"</tbody></table>");Yb=this.Gn=oa.DOMElementExtensions.zj(this.domElement,this.Uba);this.Mmb(Yb,La);this.D7(!0);this.Gra(La,zb);this.Ok=0<this.hNa?Yb.rows[ib]:null}};e.prototype.aRa=function(ib){var La=!1;this.isEditing&&ib&&(La=!this.hNa,
ib.endEdit(La,"DataValidationListBox.SetCellContent",0));if(!La&&(ib=N.g(this.$),La=ib.Ub(null))){var zb=null;this.vda&&-1!==this.vda.SheetId&&-1!==this.vda.Row&&-1!==this.vda.Column&&(zb={},zb.SheetName=this.vda.SheetId.toString(),zb.FirstRow=this.vda.Row,zb.FirstColumn=this.vda.Column,zb={ParameterType:6,SourceRange:zb});var Fb=Object(T.a)(new M.a,{Text:this.fe});ib.setCell(Fb,La.range,0,63,zb)}return!0};e.prototype.Gra=function(ib,La){var zb=ib?this.qCb:this.JH;ib=ib?this.rjc:this.sjc;0>=this.hNa?
this.Pf.style.height=X.HelperMethods.jc(ib):(this.Pf.style.height="auto",this.hNa>zb?(oa.DOMElementExtensions.vI(this.Pf,this.AQj?Math.floor(ib*zb):Math.floor(this.Pf.offsetHeight*zb/this.hNa)),this.Pf.style.overflowY="auto"):(this.Pf.style.height="auto",this.Pf.style.overflowY="hidden"));oa.DOMElementExtensions.rv(this.Pf,La);oa.DOMElementExtensions.rv(this.Gn,La-(this.hNa>zb?ra.a.ev:0))};Mf.Object.defineProperties(e.prototype,{Ok:{configurable:!0,enumerable:!0,get:function(){return this.hlb},set:function(ib){this.gBa(this.hlb);
if(ib){this.hlb=ib;this.ABb.innerText="";this.gBa(this.hlb);var La=this.pFb[ib.rowIndex];this.fe=this.AV[La];this.SHa&&(this.vda=this.SHa[La],O.ULS.shipAssertTag(537163286,0,!this.pFb.length||!!this.vda,"DataValidationListBox.SelectedRow: Did not find corresponding DataValidationListItem"));this.ABb.innerText=this.fe;this.nuc(ib)}else this.vda=this.fe=null}},isEditing:{configurable:!0,enumerable:!0,get:function(){return N.g(this.$).isEditing}},editText:{configurable:!0,enumerable:!0,get:function(){return N.g(this.$).Wb.text}}});
Object(u.a)(e,"DataValidationListBox",U.a,[]);var da=b(114),qa=b(259),na=b(265),ia=b(1295),ta="<p class='"+f.Whh+"'>\r\n\t<span class='dv-prompt-titletext'>{0}</span>\r\n</p>",za="<p class='"+f.Vhh+"'>\r\n\t<span class='dv-prompt-messagetext'>{0}</span>\r\n</p>",sa=D.a.hMe,V=D.a.hMe,Ia=D.a.tYg,Ha=A.a;Rk(d,Ha);d.prototype.dispose=function(){this.$&&(this.rMb(!1),this.gridView.ha.PN(this.Ch),this.gridView.jy(this.onContentReady),this.gridView.$b.laj(this.tvf),this.$.Ol(this.Fc));this.lDe(!1);this.mDe(!1);
m.a.oc(this.A5b);this.A5b=this.hsa=this.Pf=this.P_=this.DI=this.gridView=this.$=null;Ha.prototype.dispose.call(this)};d.prototype.b6c=function(ib){return!!this.o3a(ib)};d.prototype.Wqb=function(ib,La){return Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:5879568_ReactDataValidationErrorDialog")?new l(this.$,ib,La):new n(this.$,ib,La)};d.prototype.o3a=function(ib){ib=this.gridView.getRangeInformation(ib);for(var La=0;La<ib.length;La++){var zb=ib[La];if(Object(B.a)(F.DataValidationRange,zb))return zb}return null};
d.prototype.MHh=function(){if(!this.z4a)return"";var ib=this.V5e?String.format("{0} {1}",this.Eu.NIf,this.Eu.prompt):"",La=this.Hwb?K.a.instance.ga(841):"";return String.format(K.a.instance.mb(17),ib,La)};d.prototype.Hh=function(ib){var La=!1;if(this.isListVisible||(-569786022===ib||541421805===ib)&&this.Hwb||1872288872===ib&&this.PQ)switch(ib){case -569786022:case 541421805:this.show(this.PQ,!this.isListVisible,!0,y.a.Wo||3===G.a.Cb);La=!0;break;case 1872288872:this.isListVisible?(this.show(this.PQ,
!1,!0,!1),La=!0):this.PQ?(this.show(!1,!1,!0,!1),La=!0):this.Ya&&(this.Ya.endEdit(!1,"DataValidationControl.HandleKeyDown",0),La=!0);break;case -798660877:this.Kh.lB(1);La=!0;break;case 137938150:this.Kh.lB(-1);La=!0;break;case 2091832999:this.Kh.lB(this.Kh.JH-1);La=!0;break;case 742457698:this.Kh.lB(-(this.Kh.JH-1));La=!0;break;case 125627505:case 267796030:La=this.aRa()}return La};d.prototype.show=function(ib,La,zb,Fb){this.Jx();if(this.iAb&&this.z4a){var Yb=this.YNa;if(Yb){if(ib||La||zb)this.isVisible=
!0;qa.d(this.style,this.isGridRtl);zb&&this.Hwb&&(this.mDe(!0),this.ocg(Yb,!1));La&&this.Hwb&&this.LRa(Fb,Yb);ib&&this.V5e&&this.qAj(Yb);this.rni||(this.isVisible=!1)}}};d.prototype.dva=function(ib,La){if(!La||!La.cell.sk)return null;var zb=this.gridView.$b.textBox.domElement;var Fb=0<oa.DOMElementExtensions.getHeight(zb)&&0<oa.DOMElementExtensions.getWidth(zb)&&0<=zb.offsetTop&&0<=zb.offsetLeft;if(Fb)zb=oa.DOMElementExtensions.dva(zb,ib.yj);else{zb=ib.getCellBounds(La.cell);var Yb=oa.DOMElementExtensions.getBoundingClientRect(ib.yj);
zb=new Sys.UI.Bounds(zb.x-Yb.x,zb.y-Yb.y,zb.width,zb.height)}if(zb)if(Fb)2<zb.height&&2<zb.height&&(zb.x+=1,zb.y+=1,zb.height-=2,zb.width-=2);else if(Fb=N.g(this.$).LJ(La.cell))Fb=Fb.width+1,Yb=db.a.equals(na.a.Qub(La.cell,ib.rtl),"right",!0),ib.rtl&&Yb&&(zb.x=zb.x+zb.width-Fb),La.Cka&&ib.rtl===Yb&&(zb.width=Fb);else return null;return zb};d.prototype.i2f=function(ib){var La=this.z4a;this.rMb(La);La?this.show(!0,ib,!0,!1):this.Jx()};d.prototype.aRa=function(){var ib=!1;this.isListVisible&&(ib=this.Kh.aRa(this.Ya),
this.show(this.PQ,!1,!0,!1));return ib};d.prototype.Jx=function(){this.Ufi?(this.isListVisible&&(this.isListVisible=!1),this.BLa&&(this.BLa=!1),this.PQ&&(this.PQ=!1),this.isVisible&&(this.isVisible=!1)):this.isListVisible=this.BLa=this.PQ=this.isVisible=!1;this.Wnd=this.Rld=this.Pod=!1};d.prototype.LRa=function(ib,La){this.Hwb&&!this.Eu.SHa?this.BLa&&this.Ah.disable():(this.lDe(!0),this.Kh.hea(this.Eu.SHa,ib,this.MQh(La),this.Ya),this.vBa(La,!1))};d.prototype.qAj=function(ib){this.Eu.prompt&&(this.PQ=
!0,this.oSj(this.Eu.NIf,this.Eu.prompt),this.Hcg(ib,!1))};d.prototype.ocg=function(ib,La){var zb=ib.y;this.hsa.style.top=X.HelperMethods.jc(zb);ib=this.isGridRtl?ib.x-this.hsa.offsetWidth+1:ib.x+ib.width+1;this.hsa.style.left=X.HelperMethods.jc(ib);La?this.BLa=this.gridView.hic(new I.a(ib,zb))&&this.Rld:this.Rld=!0};d.prototype.vBa=function(ib,La){var zb=ib.y+ib.height;ib=this.isGridRtl?ib.x+ib.width-this.Pf.offsetWidth:ib.x;this.Pf.style.top=X.HelperMethods.jc(zb);this.Pf.style.left=X.HelperMethods.jc(ib);
La?this.isListVisible=this.gridView.hic(new I.a(ib,zb))&&this.Wnd:this.Wnd=!0};d.prototype.Hcg=function(ib,La){var zb=ib.y+ib.height+5,Fb=this.activeCell;Fb=Fb?Fb.width/2:32;ib=this.isGridRtl?ib.x-this.P_.offsetWidth+Fb:ib.x+ib.width-Fb;this.P_.style.top=X.HelperMethods.jc(zb);this.P_.style.left=X.HelperMethods.jc(ib);La?this.PQ=this.gridView.hic(new I.a(ib,zb))&&this.Pod:this.Pod=!0};d.prototype.oSj=function(ib,La){if(La){var zb="";ib&&(zb+=String.format(ta,w.a.zg(ib)));zb+=String.format(za,w.a.zg(La));
this.P_.innerHTML=zb;ib=oa.DOMElementExtensions.zj(this.P_,"dv-prompt-titletext");if(La=oa.DOMElementExtensions.zj(this.P_,"dv-prompt-messagetext"))for(ib=ib?parseInt(String(Math.max(ib.offsetWidth,La.offsetWidth)),10):La.offsetWidth,ib+=6,oa.DOMElementExtensions.rv(this.P_,ib),La=0,zb=this.P_.children.length;La<zb;La++)oa.DOMElementExtensions.rv(this.P_.children[La],ib)}};d.prototype.MQh=function(ib){return this.Vfi?ib.width+17-2+1:ib.width+this.hsa.clientWidth-2+1};d.prototype.mDe=function(ib){this.$&&
!this.iAb||!ib?(this.s6f(!1),m.a.Ia(this.Ah),this.Ah=null):(this.Ah||(this.Ah=new ia.a(this.hsa,sa,x.a.Uha,1,V,K.a.instance.ga(892),Ia,K.a.instance.ga(891),"",-1),this.s6f(!0)),this.BLa=!0,this.Eu.SHa?this.Ah.isEnabled||this.Ah.enable():this.Ah.disable())};d.prototype.lDe=function(ib){this.$&&!this.iAb||!ib?(this.pSa(!1),m.a.Ia(this.Kh),this.Kh=null):(this.Kh||(this.Kh=new e(this.$,this.Pf,this.ABb),this.pSa(!0)),this.isListVisible=!0)};d.prototype.pSa=function(ib){this.Kh&&(ib&&!this.XQ?(this.Kh.D9(this.Tyd),
this.Kh.iZb(this.cLa),this.Kh.gnb(this.uya),this.XQ=!0):!ib&&this.XQ&&(this.Kh.eda(this.Tyd),this.Kh.hsc(this.cLa),this.Kh.iIb(this.uya),this.XQ=!1))};d.prototype.rMb=function(ib){ib&&!this.zQ?(this.gridView.view.Es(this.Xs),this.zQ=!0):!ib&&this.zQ&&(this.gridView.view.Fq(this.Xs),this.zQ=!1)};d.prototype.s6f=function(ib){this.Ah&&(ib&&!this.S0b?(this.Ah.jUc(this.oOa),this.Ah.vUc(this.oOa),this.Ah.Smb(this.cLa),this.S0b=!0):!ib&&this.S0b&&(this.Ah.cId(this.oOa),this.Ah.qId(this.oOa),this.Ah.SHb(this.cLa),
this.S0b=!1))};d.prototype.xcg=function(){if(this.z4a){var ib=this.YNa;ib&&(this.ocg(ib,!0),this.vBa(ib,!0),this.Hcg(ib,!0))}};Mf.Object.defineProperties(d.prototype,{iAb:{configurable:!0,enumerable:!0,get:function(){return!!(this.$.Cd&16)}},rni:{configurable:!0,enumerable:!0,get:function(){return this.isListVisible||this.PQ||this.BLa}},isListVisible:{configurable:!0,enumerable:!0,get:function(){return oa.DOMElementExtensions.isVisible(this.Pf)},set:function(ib){oa.DOMElementExtensions.setVisible(this.Pf,
ib)}},PQ:{configurable:!0,enumerable:!0,get:function(){return oa.DOMElementExtensions.isVisible(this.P_)},set:function(ib){oa.DOMElementExtensions.setVisible(this.P_,ib)}},BLa:{configurable:!0,enumerable:!0,get:function(){return oa.DOMElementExtensions.isVisible(this.hsa)&&!!this.Ah&&oa.DOMElementExtensions.isVisible(this.Ah.domElement)},set:function(ib){oa.DOMElementExtensions.setVisible(this.hsa,ib);this.Ah&&oa.DOMElementExtensions.setVisible(this.Ah.domElement,ib)}},Ya:{configurable:!0,enumerable:!0,
get:function(){return this.DI},set:function(ib){this.DI=ib}},z4a:{configurable:!0,enumerable:!0,get:function(){return!!this.activeCell&&this.b6c(this.activeCell.range)}},activeCell:{configurable:!0,enumerable:!0,get:function(){return this.gridView.Ub(null)}},V5e:{configurable:!0,enumerable:!0,get:function(){return this.z4a&&!!this.Eu&&!!(this.Eu.options&2)&&!!this.Eu.prompt}},Hwb:{configurable:!0,enumerable:!0,get:function(){return this.z4a&&!!this.Eu&&!!(this.Eu.options&1)}},isGridRtl:{configurable:!0,
enumerable:!0,get:function(){return this.gridView.rtl}},Eu:{configurable:!0,enumerable:!0,get:function(){return this.o3a(this.activeCell.range)}},YNa:{configurable:!0,enumerable:!0,get:function(){var ib=this.activeCell;return ib?this.dva(this.gridView,ib):null}}});Object(u.a)(d,"DataValidationControl",A.a,[498,3]);var ob=r.a;Rk(c,ob);c.prototype.create=function(){this.pb(this.$.da.za(14)||new d(this.$))};Object(u.a)(c,"DataValidationControlFactory",r.a,[]);b.d(E,"a",function(){return a})},1390:function(u,
E,b){function a(){m.a.Fa(function(N){c.ka(N)})}function c(N){var M=K.call(this)||this;M.$=N;M.Eb();return M}function d(N,M,C){var Q=this;this.$=N;this.FAd=function(P,ka){return Object(B.a)(Q,void 0,void 0,function fa(){var ca,ea=this;return Km(fa,function(wa){ca={text:P.text,start:ka.index,length:ka.length};void ea.zIf(ca,ea.requester.request.bind(ea.requester),P,0===ca.length);wa.We=0})})};this.cOa=function(){Q.hide()};this.reset=function(){Q.handler.clearCache();Q.requester.clearCache();Q.hide()};
this.$x=function(){Q.handler.clearCache();Q.requester.clearCache()};this.gridView=Object(z.g)(this.$);this.control=new f(this.$,C);this.requester=new k(this.$,M);this.handler=new l(this.$,{FAd:this.FAd,cOa:this.cOa});this.Pi()}function e(N){this.VUd=N;this.map=new Map}function k(N,M){this.$=N;this.pluginScheduler=M;this.jbb=new e(y);this.TWf=new e(y);this.ZQi=function(C,Q){return function(P){if(Object(A.c)(P.Result))Q("No result");else if(P=JSON.parse(P.Result),Object(A.c)(P))Q("Failed to deserialize");
else if(1!==Object.keys(P).length)Q("Invalid response");else{var ka;for(ka in P)var R=P[ka];C(R)}}};this.YQi=function(C){return function(){C("Request failed")}};this.gridView=Object(z.g)(this.$)}function l(N,M){this.cache=void 0;var C=this;C.$=N;C.callbacks=M;C.Emc=function(Q,P){var ka=C.gridView.Gi;if(!(0<(ka.isEditing?ka.textBox.selection:{index:0,length:0}).length))switch(P.state){case 0:C.Dzd(Q,P.event);break;case 1:C.oMi(Q);break;default:return x.ULS.shipAssertTag(521446489,0,!1,"FormulaAssistanceValuePreviewHandler.onHoverChange unxpected HoverState"),
P}};C.Dmc=function(Q,P){var ka;C.clearCache();P=null!==(ka=P.selection)&&void 0!==ka?ka:Q.textBox.selection;if(0<P.length)C.onSelectionChange(Q,P);else C.pBf(Q)};C.gridView=Object(z.g)(C.$);C.editBox=C.gridView.$b;C.formulaBar=Object(T.a)(C.$);C.Pi();return C}function n(N){this.cache=N}function f(N,M){this.$=N;this.lJa=M;this.s9h();this.editBox=Object(z.g)(this.$).Wb}function v(N,M,C){if(N===M)return C;if(M.textContent!==M.parentElement.textContent)for(;null!==M.previousSibling;)M=M.previousSibling,
C+=M.textContent.length,"div"===M.nodeName.toLowerCase()&&(C+=1);return v(N,M.parentElement,C)}function r(N,M,C){if(N.has(M))return N.get(M);C=C();N.set(M,C);return C}function y(N){return JSON.stringify({text:N.text,start:N.start,length:N.length})}var m=b(10);u=b(0);var w=b(232),B=b(275),A=b(978),z=b(21),x=b(14),D=b(11),I=b(22),F=b(228),G=b(33);f.prototype.dispose=function(){this.hide()};f.prototype.show=function(N,M,C){N=Object.assign(Object.assign({},M),{RA:N,IZd:C});this.Scb(N)&&(this.Bna(N)&&
this.hide(),this.LY=N,this.ry(),C&&this.k6h())};f.prototype.hide=function(){if(this.LY){var N=this.LY.IZd;this.qfh();N&&this.O9i();this.LY=void 0}};f.prototype.Scb=function(N){var M;(M=!this.LY)||(M=this.LY,M=!(M.RA===N.RA&&M.kind===N.kind&&M.text===N.text&&M.start===N.start&&M.length===N.length&&M.IZd===N.IZd));return M};f.prototype.Bna=function(N){var M;if(M=this.LY)M=this.LY,M=!(M.RA===N.RA&&M.start===N.start&&M.length===N.length);return M};f.prototype.k6h=function(){var N=this.LY;N.RA.textBox.formatText(N.start,
N.length,{background:"rgba(202,234,216,0.6)"})};f.prototype.O9i=function(){var N=this.LY,M=N.RA,C=N.start;N=N.length;var Q=M.text;Q.length<C+N?x.ULS.shipAssertTag(521019917,0,!1,"FormulaAssistanceValuePreviewControl.removeHighlight - unexpected editor state, "+Q.length+":"+C+":"+N):M.textBox.formatText(C,N,{background:!1})};f.prototype.ry=function(){var N=this.LY,M=N.text;switch(N.kind){case 1:case 2:N={isLoaded:!0,value:M};break;case 3:N={isLoaded:!1,value:null};break;default:return}this.jTj();this.lJa.renderValuePreview(this.gs,
this.pNb,N)};f.prototype.qfh=function(){this.lJa.dismiss(this.gs)};f.prototype.s9h=function(){this.gs=document.createElement("div");this.pNb=document.createElement("div");this.pNb.style.position="absolute";this.pNb.style.visibility="hidden";this.$.domElement.appendChild(this.pNb)};f.prototype.jTj=function(){var N=this.LY,M=N.RA,C=N.start;N=N.length;var Q=I.a.contains(M.text.substring(C,C+N),"\n",!0);M=excelOnline.utils.getBoundingRectForText(M.textBox.Me,C,Q?C:C+N,!1);C=new F.a(this.pNb.style);C.AB.left=
this.yxc(M.left);C.AB.top=this.yxc(M.top);C.AB.width=this.yxc(M.width);C.AB.height=this.yxc(M.height);C.w2()};f.prototype.yxc=function(N){var M=this.LY.RA;M=Object(A.b)(this.zoomManager)&&M===this.editBox;return D.HelperMethods.jc(M?this.zoomManager.hi(N):N)};Mf.Object.defineProperties(f.prototype,{zoomManager:{configurable:!0,enumerable:!0,get:function(){this.Cie||(this.Cie=Object(G.a)(this.$));return this.Cie}}});Object(u.a)(f,"FormulaAssistanceValuePreviewControl",null,[3]);var T=b(114);n.prototype.clearCache=
function(){this.cache=void 0};Object(u.a)(n,"Cacheable",null,[]);Rk(l,n);l.prototype.dispose=function(){this.Tj()};l.prototype.Pi=function(){this.editBox.qUc(this.Emc);this.formulaBar.qUc(this.Emc);this.editBox.bme(this.Dmc);this.formulaBar.bme(this.Dmc)};l.prototype.Tj=function(){this.editBox.mId(this.Emc);this.formulaBar.mId(this.Emc);this.editBox.cPf(this.Dmc);this.formulaBar.cPf(this.Dmc)};l.prototype.Dzd=function(N,M){var C=new Sys.UI.Point(M.clientX,M.clientY);M=N.textBox.Me;var Q=void 0,P=
C.x,ka=C.y;Q=void 0===Q?document:Q;C=-1;var R=null;void 0!==Q.caretPositionFromPoint?(Q=Q.caretPositionFromPoint(P,ka),null!==Q&&(C=Q.offset,R=Q.offsetNode)):void 0!==Q.caretRangeFromPoint&&(Q=Q.caretRangeFromPoint(P,ka),null!==Q&&(C=Q.startOffset,R=Q.startContainer));null===R||-1===C?(x.ULS.sendTraceTag(521446491,0,15,"getEditorCaretPositionFromPoint - failed to get relevant range"),M=-1):M.contains(R)?M=v(M,R,C):(x.ULS.sendTraceTag(521446490,0,15,"getEditorCaretPositionFromPoint - relavant node not inside root"),
M=-1);if(-1!==M)this.onSelectionChange(N,{index:M,length:0})};l.prototype.oMi=function(N){this.pBf(N)};l.prototype.onSelectionChange=function(N,M){this.ewj(M)&&(this.cache=M,this.callbacks.FAd(N,M))};l.prototype.pBf=function(N){this.clearCache();this.callbacks.cOa(N)};l.prototype.ewj=function(N){var M;(M=!this.cache)||(M=this.cache,M=!(M.index===N.index&&M.length===N.length));return M};Object(u.a)(l,"FormulaAssistanceValuePreviewHandler",n,[3]);var O=b(45),U=b(62);k.prototype.clearCache=function(){this.jbb.clear();
this.TWf.clear()};k.prototype.request=function(N){return Object(B.a)(this,void 0,void 0,function C(){var Q=this,P;return Km(C,function(ka){P=Q;return ka.return(r(Q.jbb,N,function(){return Object(B.a)(P,void 0,void 0,function fa(){var ca=this,ea,wa,X,ja,va;return Km(fa,function(ua){switch(ua.We){case 1:return ea=ca,ua.Jm(ca.pluginScheduler.getRequester().valuePreview(N,0),2);case 2:wa=ua.vy;X=wa.kind;ja=wa.payload;if(0!==X)return ua.return(null);if(Object(A.c)(ja))return ua.return({kind:0});switch(ja.kind){case 0:return ua.return({kind:0});
case 1:case 2:return ua.return(Object.assign({},ja));case 3:ua.We=3;return}ua.We=0;break;case 3:va={text:N.text,start:ja.start,length:ja.length};if(!ca.jbb.has(va)){ua.We=5;break}return ua.Jm(ca.jbb.get(va),6);case 6:return ua.return(ua.vy);case 5:return ua.return(Object.assign(Object.assign({},ja),{kind:3,next:function(){return ea.Fej(va,N,ja.text)}}))}})})}))})})};k.prototype.Fej=function(N,M,C){return Object(B.a)(this,void 0,void 0,function P(){var ka=this,R;return Km(P,function(fa){R=ka;return fa.return(r(ka.TWf,
N,function(){var ca=new Promise(function(ea){return Object(B.a)(R,void 0,void 0,function X(){var ja=this,va,ua;return Km(X,function(Xa){if(1==Xa.We)return Xa.K2=2,Xa.Jm(ja.bTh(C),4);2!=Xa.We?(va=Xa.vy,ea({kind:1,text:va,start:N.start,length:N.length}),Xa.We=0,Xa.K2=0):(ua=Cm(Xa),x.ULS.sendTraceTag(520495426,1,50,"FormulaAssistanceValuePreviewRequester.requestFromServer: getPartialCalcResults failed, "+ua),ea({kind:0}),Xa.We=0)})})});ca.then(function(){R.jbb.set(N,ca);R.jbb.set(M,ca)}).catch(function(ea){x.ULS.sendTraceTag(520495425,
1,15,"FormulaAssistanceValuePreviewRequester.requestFromServer: serverPromise failed, "+ea)});return ca}))})})};k.prototype.bTh=function(N){return Object(B.a)(this,void 0,void 0,function C(){var Q=this,P;return Km(C,function(ka){P=Q;return ka.return(new Promise(function(R,fa){var ca={Formula:N,PartialFormula:N,SourceRange:Object(O.v)(P.gridView.ha.sa.activeCell,P.$)},ea=P.$.oa.xa;R=P.ZQi(R,fa);fa=P.YQi(fa);var wa=ea.Na(1,null);wa.getPartialCalcResultsParameters=ca;Object(U.g)(ea,"GetPartialCalcResults",
wa,R,fa,null,null,4)}))})})};Object(u.a)(k,"FormulaAssistanceValuePreviewRequester",null,[]);e.prototype.has=function(N){N=this.VUd(N);return this.map.has(N)};e.prototype.get=function(N){N=this.VUd(N);return this.map.get(N)};e.prototype.set=function(N,M){N=this.VUd(N);this.map.set(N,M);return this};e.prototype.clear=function(){this.map.clear()};Object(u.a)(e,"RequestMap",null,[]);d.prototype.dispose=function(){this.Tj();this.handler.dispose();this.control.dispose()};d.prototype.Pi=function(){this.gridView.Wb.tm(this.reset);
this.gridView.ha.Bga(this.reset);this.$.ea.RD(this.$x)};d.prototype.Tj=function(){this.gridView.Wb.Nl(this.reset);this.gridView.ha.Fma(this.reset);this.$.ea.hD(this.$x)};d.prototype.zIf=function(N,M,C,Q){return Object(B.a)(this,void 0,void 0,function ka(){var R,fa=this,ca;return Km(ka,function(ea){if(1==ea.We)return R=Object.assign(Object.assign({},N),{RA:C,bQd:Q}),fa.wrb=R,ea.Jm(M(N),2);ca=ea.vy;if(Object(A.c)(ca)||!fa.Zki(R))return ea.return();void fa.j3h(ca);ea.We=0})})};d.prototype.j3h=function(N){return Object(B.a)(this,
void 0,void 0,function C(){var Q=this,P,ka,R,fa,ca,ea;return Km(C,function(wa){P=Q.wrb;ka=P.text;R=P.RA;fa=P.bQd;switch(N.kind){case 0:Q.hide();break;case 1:case 2:Q.show(R,N,fa);break;case 3:if(!Q.sni(N))break;Q.show(R,N,fa);ca={text:ka,start:N.start,length:N.length};void Q.zIf(ca,N.next,R,fa);break;default:return ea=N,wa.return(ea)}wa.We=0})})};d.prototype.show=function(N,M,C){this.control.show(N,M,C);this.wrb=void 0;this.xrb=M};d.prototype.hide=function(){this.control.hide();this.xrb=this.wrb=
void 0};d.prototype.Zki=function(N){var M;if(M=this.wrb)M=this.wrb,M=M.text===N.text&&M.start===N.start&&M.length===N.length&&M.RA===N.RA&&M.bQd===N.bQd;return M};d.prototype.sni=function(N){return!this.xrb||this.xrb.start!==N.start||this.xrb.length!==N.length||3===this.xrb.kind};Object(u.a)(d,"FormulaAssistanceValuePreview",null,[515,3]);var J=b(51),H=b(37),K=w.a;Rk(c,K);c.ka=function(N){N.da.Ga(497,new c(N))};c.prototype.create=function(){var N=this,M=this.$.da.za(496);M&&this.pb(M);var C=J.GetServiceTaskFactory.Ra(this.$.da,
413,414,this.hb),Q=J.GetServiceTaskFactory.Ra(this.$.da,448,449,this.hb),P=J.GetServiceTaskFactory.Ra(this.$.da,19,153,this.hb);H.TaskExtensions.Aa(H.TaskExtensions.Vd([C,Q,P],this.la),function(){M=N.$.da.za(496);M||(M=new d(N.$,C.result,Q.result),N.$.da.Ga(496,M));N.pb(M)},this.la,3)};Object(u.a)(c,"FormulaAssistanceValuePreviewFactory",w.a,[]);b.d(E,"a",function(){return a})},1400:function(u,E,b){function a(){k.a.Fa(function(M){c.ka(M)})}function c(M){var C=N.call(this)||this;C.$=M;C.Eb();return C}
function d(M){var C=this;this.$=M;this.g_=null;this.lBb=-1;this.ajc=null;this.cjc=0;this.U9=Object.assign({},y);this.uM=Object.assign({},m);this.nY=Object.assign({},v);this.rob=Object.assign({},r);this.Cda=Object.assign({},A);this.sob={};this.O2a=Object.assign(Object.assign({},w),{isReactDialog:J.a.kod()});this.Af=function(Q,P){null!=C.g_&&(1==Math.abs(C.lBb-C.$.ea.Ue)&&(Q=C.$.va.pa.sheetId,P.oqb&&P.rk.equals(C.g_.rk)&&C.ajc===Q&&C.g_.zpb!==P.zpb&&C.cjc++),1<=Math.abs(C.lBb-C.$.ea.Ue)&&(C.g_=null,
C.lBb=-1,C.ajc=null))};this.Fc=function(){C.lsj();C.y9&&C.vsj();C.$.sendBeaconTraceTag(88392384,50,!1,"{0}",C.getJsonForLogging())};this.y9=I.EwaSettings.isChangeGateEnabled("OfficeVSO:6378161_addKeptSmartSuggestionsMetric");this.q$a=new O.a;M.Bk(this.Fc);this.y9&&T.g(this.$).Gi.tm(this.Af)}function e(M){var C=this;this.dpf=M;this.J_=Object.assign({},B);this.h7b=[];this.Bkc=-1;(this.cpf=I.EwaSettings.isChangeGateEnabled("OfficeVSO:5999949_formulaTelemetryMetriThresholds"))&&M&&(this.J_.countAboveThresholds=
{},M.forEach(function(Q){return C.J_.countAboveThresholds[Q]=0}))}var k=b(10);u=b(0);var l=b(232),n=b(202),f={average:0,max:0,median:0,P75:0,P95:0},v={selectByArrowKeyCounter:0,selectByMouseHoverCounter:0,commitByTabKeyCounter:0,commitByEnterKeyCounter:0,commitByMouseClickCounter:0,commitWhileRequestPending:0},r={formulaAssistanceRequestAttemptedCounter:0,formulaAssistanceRequestOptimizedCounter:0},y={argumentAssistanceCardInitialMode:void 0,argumentAssistanceCollapseCounter:0,argumentAssistanceExpandCounter:0,
argumentAssistanceLearnMoreCounter:0,argumentAssistanceDismissCounter:0,argumentAssistanceDragCounter:0,argumentAssistanceDragTotalCounter:0,argumentAssistanceMoveCounter:0,argumentAssistanceMoveTotalCounter:0},m={smartSuggestionShownCounter:0,smartSuggestionSelectedCounter:0,smartSuggestionCommittedCounter:0,smartSuggestionKeptCounter:0,isCellContentOnlyEqualDuringEditCounter:0,isCellContentFormulaCounter:0,smartSuggestionWouldSuggestInsidePivotCounter:0},w={dialogCommitedCounter:0,dialogShownCounter:0,
argsDialogOpenedByRibbonCounter:0,argsDialogOpenedByDialogCounter:0,argsDialogCommitedCounter:0},B={count:0,countAboveThresholds:void 0,failedCount:0,firstAction:0,includingFirstAction:Object.assign({},f),excludingFirstAction:Object.assign({},f)},A={argumentAssistanceFlight:void 0,autoCompleteUIFlight:void 0,smartFormulaBarAutoCompleteFlight:void 0,smartFormulaBarAutoCompletePluginFlight:void 0,anyPluginInitialized:void 0,formulaAssistanceRedesignFlight:void 0,NewInsertFunctionDialogFlight:void 0},
z=b(54),x=b(110),D=b(28),I=b(1);e.prototype.gSa=function(){this.Bkc=D.a.Ta.Wd.m};e.prototype.kia=function(M){-1!==this.Bkc&&(M?(this.Kmb(D.a.Ta.Wd.m-this.Bkc),this.Bkc=-1):this.J_.failedCount++)};e.prototype.xzh=function(){this.J_.excludingFirstAction=e.SRe(this.h7b);this.h7b.push(this.J_.firstAction);this.J_.includingFirstAction=e.SRe(this.h7b)};e.prototype.Kmb=function(M){var C=this;this.J_.count?1E3>this.J_.count&&this.h7b.push(M):this.J_.firstAction=M;this.cpf&&this.dpf&&this.dpf.forEach(function(Q){M>
Q&&C.J_.countAboveThresholds[Q]++});this.J_.count++};e.SRe=function(M){var C=Object.assign({},f);0<M.length&&(x.i(M),C.median=M[Math.floor(.5*M.length)],C.P75=M[Math.floor(.75*M.length)],C.P95=M[Math.floor(.95*M.length)],C.max=M[M.length-1],C.average=x.g(M,function(Q){return Q})/M.length);return C};Object(u.a)(e,"PerformanceMeasurement",null,[]);var F=b(22),G=b(41),T=b(21),O=b(100),U;(function(M){M[M.function=3]="function";M[M.namedRange=100]="namedRange";M[M.tableHeader=101]="tableHeader";M[M.letVariable=
102]="letVariable";M[M.richEntity=103]="richEntity";M[M.lambda=104]="lambda";M[M.customFunction=105]="customFunction";M[M.table=106]="table";M[M.tableSpecialStructRef=107]="tableSpecialStructRef";M[M.richEntityEmptyCellRef=108]="richEntityEmptyCellRef"})(U||(U={}));Object(u.b)("CompletionItemKind",U);var J=b(36),H={},K=(H.argumentAssistanceOverall=[50,80,100,130,150,170,200],H.autoCompleteOverall=[50,80,100,130,150,170,200],H);d.prototype.dispose=function(){this.$&&this.y9&&T.g(this.$).Gi.Nl(this.Af)};
d.prototype.iO=function(M){var C=this;M.forEach(function(Q){C.q$a.kb(Q)||C.q$a.ia(Q,new e(K[Q]));C.q$a.na(Q).gSa()})};d.prototype.dQ=function(M,C){var Q=this;C=void 0===C?!0:C;M.forEach(function(P){Q.q$a.kb(P)&&Q.q$a.na(P).kia(C)})};d.prototype.kXf=function(M){var C="Undefined";switch(M){case 1:C="Collapsed";break;case 0:C="Expanded";break;case 2:C="Hidden"}this.U9.argumentAssistanceCardInitialMode=C};d.prototype.B7b=function(M){var C=this;window.requestAnimationFrame(function(){C.dQ([M])})};d.prototype.H8e=
function(M){var C=this;M.forEach(function(Q){Q=U[Q.kind];C.Deg(Q);C.sob[Q].shownCounter++})};d.prototype.G8e=function(M){M=U[M];this.Deg(M);this.sob[M].committedCounter++};d.prototype.getJsonForLogging=function(){return"{"+this.cU("SessionDetails",this.Cda)+","+this.cU("ArgumentAssistanceUsage",this.U9)+","+this.cU("FormulaSuggestionsUsage",this.uM)+","+this.cU("FunctionDialogUsage",this.O2a)+","+this.cU("AutocompleteCardInteraction",this.nY)+","+this.cU("AutocompleteRenderOptimization",this.rob)+
","+this.cU("AutocompleteUsageByKind",this.sob)+","+this.rWh()+"}"};d.prototype.vsj=function(){this.uM.smartSuggestionKeptCounter=this.uM.smartSuggestionCommittedCounter-this.cjc};d.prototype.lsj=function(){this.Cda.argumentAssistanceFlight=this.y3a("Microsoft.Office.ExcelOnline.","ArgumentAssistancePlugin");this.Cda.autoCompleteUIFlight=this.y3a("Microsoft.Office.Excel.","AutoCompleteNewUI");this.Cda.smartFormulaBarAutoCompleteFlight=this.y3a("Microsoft.Office.Excel.","SmartFormulaBarAutocompleteFeatureIsEnabled");
this.Cda.smartFormulaBarAutoCompletePluginFlight=this.y3a("Microsoft.Office.Excel.","SmartFormulaBarAutocompleteIsEnabled");this.Cda.formulaAssistanceRedesignFlight=this.y3a("Microsoft.Office.Excel.","FormulaAssistanceRedesign");this.Cda.NewInsertFunctionDialogFlight=this.y3a("Microsoft.Office.Excel.","NewInsertFunctionDialog")};d.prototype.rWh=function(){for(var M=new n.a,C=bk(this.q$a),Q=C.next();!Q.done;Q=C.next())Q=Q.value,Q.value.xzh(),M.add(String.format('"{0}":{1}',Q.key,z.a.xc(Q.value.J_)));
return String.format('"PerfMeasurements": {{{0}}}',M.toArray().join(","))};d.prototype.y3a=function(M,C){return F.a.contains(this.$.ya.FlightHolder.FlightId,C,!0)?I.EwaSettings.getBooleanFeatureGate(M+C,!1)?"T":"C":"None"};d.prototype.cU=function(M,C){return String.format('"{0}":{1}',M.toString(),G.c(C))};d.prototype.Deg=function(M){this.sob[M]||(this.sob[M]={shownCounter:0,committedCounter:0})};Object(u.a)(d,"FormulaAssistanceTelemetryManager",null,[516]);var N=l.a;Rk(c,N);c.ka=function(M){M.da.Ga(492,
new c(M))};c.prototype.create=function(){var M;this.pb(null!==(M=this.$.da.za(491))&&void 0!==M?M:this.$.da.Ga(491,new d(this.$)))};Object(u.a)(c,"FormulaAssistanceTelemetryManagerFactory",l.a,[]);b.d(E,"a",function(){return a})},1414:function(u,E,b){function a(){Type.registerNamespace("CAUI");c.main()}function c(){}function d(F,G,T,O){var U=this;this.A1d=this.f1=this.Di=this.zD=this.n8=null;this.EWb=F;this.Gvg=O;this.EWb.zLa&&(this.Di=new w.a(3,2,5E3,Object(v.a)(this,this.mMg,"authenticationCheckTask"),
2),r.AFrameworkApplication.yi.Dg(this.Di),this.Bg(G,T));this.EWb.Rmb(function(){U.$sf()});this.EWb.hYa(function(){U.atf()})}function e(){}u=b(0);var k=b(631),l=b(625),n=b(622),f=b(1206);e.prototype.x8g=function(F,G){if(F&&!(1>F.length)&&G){var T=Object.assign(new n.a,{ExternalId:"msPresenceOuter",ControlList:[]});this.X5g(F,T.ControlList);G.push(T)}};e.prototype.X5g=function(F,G){var T=Object.assign(new k.a,{ExternalId:"ContextCoauthors",LabelText:CommonUIStrings.l_PresenceMenuSectionTitle,Menu:Object.assign(new l.a,
{ExternalId:"msPresenceInner",UpdateDynamically:!0,ShouldAutoOpen:!1,MenuSectionList:[]})});Array.add(G,T);G=Object.assign(new n.a,{Title:"",ControlList:[]});Array.add(T.Menu.MenuSectionList,G);this.d8g(F,G.ControlList)};e.prototype.d8g=function(F,G){for(var T=0;T<F.length;T++){var O=Object.assign(new f.a,{ExternalId:String.format("CoauthorPersona_{0}",T),Command:"336231556",DisplayName:F[T].userName,LabelText:F[T].userName,ImageBackColor:F[T].color,PersonaId:F[T].email,IsAnonymous:F[T].isAnonymous});
Array.add(G,O)}};Object(u.a)(e,"PresenceContextMenuSectionBuilder",null,[237]);var v=b(84),r=b(4),y=b(181),m=b(623),w=b(108),B=b(135),A=b(89),z=b(83),x=b(107),D=b(25);d.prototype.Bg=function(F,G){var T=r.AFrameworkApplication.ub;T.He(D.a.authenticationLost,x.a.frame,F,96);T.He(D.a.Rre,x.a.frame,G,96);T.Mb(D.a.Mve,x.a.frame,y.ActionManager.W5c);T.Mb(D.a.Nve,x.a.frame,y.ActionManager.W5c);T.Mb(D.a.$rd,x.a.frame,y.ActionManager.W5c)};d.prototype.$sf=function(){this.showDialog(CommonUIStrings.l_AuthenticationLostMessage);
r.AFrameworkApplication.ub.processAction(D.a.authenticationLost,2)};d.prototype.atf=function(){this.pHj();r.AFrameworkApplication.ub.processAction(D.a.Rre,2)};d.prototype.mMg=function(){this.EWb.authenticationCheck()};d.prototype.pHj=function(){this.zD&&(this.zD.hide(),this.zD.dispose(),this.zD=null);this.n8&&this.businessBar&&(r.AFrameworkApplication.Ag||this.businessBar.removeEntry(this.n8),this.n8.dispose(),this.n8=null)};d.prototype.showDialog=function(F){A.a.Ia(this.zD);this.zD=new B.StandardDialog;
this.Gvg||(this.zD.Pu=!1,this.zD.Rb=0);this.zD.mc(1,CommonUIStrings.l_SignIn);this.zD.XW(CommonUIStrings.l_DefaultDialogTitle,F,Object(v.a)(this,this.Uv,"dialogHandler"))};d.prototype.Uv=function(F){1===F?(m.a.y6(),this.showDialog(CommonUIStrings.l_AuthenticationLostSigninInProgressMessage),r.AFrameworkApplication.ub.processAction(D.a.$rd,2)):(this.JQd(),r.AFrameworkApplication.ub.processAction(D.a.Nve,2))};d.prototype.JQd=function(){this.businessBar&&this.Wte&&(this.n8=this.Wte.create(CommonUIStrings.l_AuthenticationLostTitle,
CommonUIStrings.l_AuthenticationLostMessage,null),this.n8.closeable=!0,this.n8.addButton(CommonUIStrings.l_SignIn,d.IRg,""),this.n8.u$=Object(v.a)(this,this.LRg,"businessBarEntryCloseHandler"),this.businessBar.OD(this.n8,!1))};d.prototype.LRg=function(){this.bfh();r.AFrameworkApplication.ub.processAction(D.a.Mve,2)};d.prototype.bfh=function(){this.Di&&(r.AFrameworkApplication.yi.Dp(this.Di),this.Di=null)};d.prototype.dispose=function(){this.Di=this.zD=this.n8=null};d.IRg=function(){m.a.y6();r.AFrameworkApplication.ub.processAction(D.a.$rd,
2)};Mf.Object.defineProperties(d.prototype,{businessBar:{configurable:!0,enumerable:!0,get:function(){return this.f1||(this.f1=z.a.instance.mh("CommonUI.IBusinessBar"))}},Wte:{configurable:!0,enumerable:!0,get:function(){return this.A1d||(this.A1d=z.a.instance.mh("CommonUI.IBusinessBarEntryFactory"))}}});Object(u.a)(d,"SignOutResponseUI",null,[3]);var I=b(254);c.prototype.Ph=function(F){F.register(e,"Common.App.UI.PresenceContextMenuSectionBuilder").as("Common.App.UI.IPresenceContextMenuSectionBuilder").tc()};
c.prototype.init=function(){};c.prototype.dispose=function(){A.a.Ia(c.P1);c.P1=null};c.main=function(){I.a.instance.Qi(new c)};Mf.Object.defineProperties(c.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.UI"}}});c.P1=null;Object(u.a)(c,"CommonAppUIPackage",null,[10,11]);b.d(E,"a",function(){return a})},1418:function(u,E,b){function a(kb,vb,Wa,qb){var yb=Yb.call(this,kb,"PopulateGridContextMenu",1247109494,-2064931494,a.A0h,!0,!1,a.YIb,vb,Wa,!0,qb)||this;yb.yAa=!1;yb.Iva=
!1;yb.$Y=!1;yb.refresh=!1;yb.expandCollapse=!1;yb.Xhc=!1;yb.$Ce=!0;yb.grid=ja.g(kb);yb.Dkc=!0;yb.Afc=wa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.GridContextMenuFilterByValue",!1);if(yb.Afc){var ec=Xa.GetServiceTaskFactory.Ra(yb.$.da,309,310,3),Ob=Xa.GetServiceTaskFactory.create(yb.$.da,18,yb.la,3);fa.TaskExtensions.Aa(fa.TaskExtensions.Vd([ec,Ob],yb.la),function(){yb.$.da.Za(268,function(Cb){yb.l4a=new c(kb,ec.result,Ob.result,Cb)})},yb.la,3)}return yb}function c(kb,vb,Wa,qb){this.RVc=
this.deb=this.feb=0;this.$=kb;this.gridView=ja.g(this.$);this.namedSheetViewPublic=vb;this.Fg=Wa;this.instantaneousSupportInformationManager=qb;this.fMa=Ha.a.Ild()}function d(kb){this.ranges=null;this.ranges=kb}function e(kb,vb,Wa,qb,yb,ec,Ob,Cb){this.$=vb;this.Va=Wa;this.sl=qb;this.selectedRanges=yb;this.grid=ec;this.py=Cb;this.jba=Ob;this.Kra=v.a.all(yb,function(ab){return ab.isRow});this.Lga=v.a.all(yb,function(ab){return ab.Te});this.lDb=v.a.all(yb,function(ab){return!ab.isRow&&!ab.Te});vb=ec.Ab.Rfd(yb);
this.u4b=!!vb;this.FQf=!!vb&&vb.hasActiveFilter;this.menuSection=Wa.Bc();kb.pc.push(this.menuSection);this.Zja=this.Kra||this.Lga?this.menuSection:Wa.Bc();this.tta=this.Kra||this.Lga?this.menuSection:Wa.Bc()}b.r(E);u=b(0);var k=b(14),l=b(291),n=b(92),f=b(39),v=b(276),r=b(611),y=b(4),m=b(85),w=b(440),B=b(928),A=b(8),z=b(30),x=b(19),D=b(60),I=b(5),F=b(1E3),G=b(1250),T=b(1049),O=b(15),U=b(36);e.prototype.obd=function(){this.ZEh();this.CEh();var kb=this.py.E6a(this.selectedRanges,this.grid);this.menuSection.buttons.push(this.Va.nb(kb?
149:148))};e.prototype.dFh=function(){var kb=0;this.u4b?this.jba.zm(942362098)?kb=this.py.zm(this.sl,942362098,this.selectedRanges,this.grid)?161:169:this.FQf&&(kb=this.py.zm(this.sl,-1113896058,this.selectedRanges,this.grid)?177:181):this.jba.zm(-1113896058)&&(kb=this.Kra?this.py.zm(this.sl,-1113896058,this.selectedRanges,this.grid)?49:116:this.py.zm(this.sl,-1113896058,this.selectedRanges,this.grid)?177:181);0!==kb&&this.Zja.buttons.push(this.Va.nb(kb))};e.prototype.$Eh=function(){var kb=0;this.u4b?
this.jba.zm(622604322)&&(kb=this.grid.rtl?this.py.zm(this.sl,622604322,this.selectedRanges,this.grid)?191:192:this.py.zm(this.sl,622604322,this.selectedRanges,this.grid)?162:170):this.jba.zm(1415868706)&&(kb=U.a.rzb()&&this.grid.rtl?this.Lga?this.py.zm(this.sl,1415868706,this.selectedRanges,this.grid)?288:289:this.py.zm(this.sl,1415868706,this.selectedRanges,this.grid)?290:291:this.Lga?this.py.zm(this.sl,1415868706,this.selectedRanges,this.grid)?50:117:this.py.zm(this.sl,1415868706,this.selectedRanges,
this.grid)?178:182);0!==kb&&this.Zja.buttons.push(this.Va.nb(kb))};e.prototype.YEh=function(){this.jba.zm(1035996630)&&(this.py.zm(this.sl,1035996630,this.selectedRanges,this.grid)?(this.Zja.buttons.push(this.Va.nb(this.grid.rtl?187:165)),this.Zja.buttons.push(this.Va.nb(166))):(this.Zja.buttons.push(this.Va.nb(this.grid.rtl?188:173)),this.Zja.buttons.push(this.Va.nb(174))))};e.prototype.ZEh=function(){var kb=b(1418).GridContextMenu,vb=null;this.lDb&&(vb=this.Va.Qv("ContextMenu.InsertCells",null,
O.a.instance.ga(350),1896159024),vb.menu.pc.push(this.Zja));kb.aFh(this.Zja,this.Va,this.$);this.dFh();this.$Eh();this.YEh();vb&&0<this.Zja.buttons.length&&this.menuSection.buttons.push(vb)};e.prototype.EEh=function(){var kb=0;this.u4b?this.jba.zm(1405456548)?kb=this.py.zm(this.sl,1405456548,this.selectedRanges,this.grid)?163:171:this.FQf&&(kb=this.py.zm(this.sl,1554436520,this.selectedRanges,this.grid)?179:183):this.jba.zm(1554436520)&&(kb=this.Kra?this.py.zm(this.sl,1554436520,this.selectedRanges,
this.grid)?51:118:this.py.zm(this.sl,1554436520,this.selectedRanges,this.grid)?179:183);0!==kb&&this.tta.buttons.push(this.Va.nb(kb))};e.prototype.DEh=function(){var kb=0;this.u4b?this.jba.zm(284490184)&&(kb=this.py.zm(this.sl,284490184,this.selectedRanges,this.grid)?164:172):this.jba.zm(674605324)&&(kb=this.Lga?this.py.zm(this.sl,674605324,this.selectedRanges,this.grid)?52:119:this.py.zm(this.sl,674605324,this.selectedRanges,this.grid)?180:184);0!==kb&&this.tta.buttons.push(this.Va.nb(kb))};e.prototype.BEh=
function(){this.jba.zm(1035996630)&&(this.py.zm(this.sl,1035996630,this.selectedRanges,this.grid)?(this.tta.buttons.push(this.Va.nb(this.grid.rtl?189:167)),this.tta.buttons.push(this.Va.nb(168))):(this.tta.buttons.push(this.Va.nb(this.grid.rtl?190:175)),this.tta.buttons.push(this.Va.nb(176))))};e.prototype.CEh=function(){var kb=null;this.lDb&&(kb=this.Va.Qv("ContextMenu.DeleteCells",null,O.a.instance.ga(413),-1554384558),kb.menu.pc.push(this.tta));this.EEh();this.DEh();this.BEh();kb&&0<this.tta.buttons.length&&
this.menuSection.buttons.push(kb)};Object(u.a)(e,"CellsContextMenuGenerator",null,[]);Object(u.a)(d,"MacroRecorderRangeHyperlinkRemovedPayload",null,[438]);var J=b(589),H=b(24),K=b(103),N=b(76),M=b(78),C=b(45),Q=b(177),P=b(62),ka=b(701),R=b(151),fa=b(37),ca=b(492),ea=b(620),wa=b(1),X=b(186),ja=b(21),va=b(390),ua=b(33),Xa=b(51),aa=b(248),ba=b(22),oa=b(29),ra=b(1274),db=b(1115),Ka=b(133),Ga=b(564),xa=b(388),da=b(255),qa=b(169),na=b(160),ia=b(356),ta=b(91),za=b(31),sa=b(295),V=b(294),Ia=b(134),Ha=b(983),
ob=b(984),ib=b(112),La=b(41),zb=b(58),Fb;(function(kb){kb[kb.none=0]="none";kb[kb.once=1]="once";kb[kb.twice=2]="twice"})(Fb||(Fb={}));Object(u.b)("ToggleState",Fb);c.prototype.qgh=function(){var kb=this.TU(),vb={};kb=(vb.CommandValueId=La.c(kb),vb);vb=new ta.a(-2058042992,2,this.$.Jc,19,null);k.ULS.sendTraceTag(527500302,0,50,"GridContextMenuFilter::DoClearFilter GridContextMenu ClearFilter command executed");return this.$.Ka.Kb(vb,kb)};c.prototype.Ggh=function(){var kb=new ta.a(644342024,2,this.$.Jc,
19,null);k.ULS.sendTraceTag(527500301,0,50,"GridContextMenuFilter::DoReapplyFilter GridContextMenu ReapplyFilter command executed");return this.$.Ka.Kb(kb)};c.prototype.vgh=function(){var kb=this.gridView.ha.sa.activeCell,vb=this.$.da.za(66).pg,Wa=this.$.da.za(66).yub(kb);return vb||Wa?this.xgh(vb,Wa,kb):this.wgh(kb)};c.prototype.xgh=function(kb,vb,Wa){if(this.$Vg(kb,vb,Wa))return k.ULS.sendTraceTag(527500300,0,50,"GridContextMenuFilter::DoFilterByValue Header/Total error dialog raised for FilterByValue in Table"),
zb.Task.Ua(!1);if(null!=kb&&kb.hasAutoFilter||null!=vb&&vb.RZa.every(function(qb){return 0!=qb.length}))return this.feb=Fb.none,this.PVc();this.feb=Fb.once;return this.Q6b(Fb.once)};c.prototype.wgh=function(kb){var vb=C.v(this.gridView.ha.sa.Vc,this.$);vb=this.gridView.$.va.getItemByName(vb.SheetName);var Wa=C.D(vb.w0);if(this.ZVg(Wa,kb))return k.ULS.sendTraceTag(527500299,0,50,"GridContextMenuFilter::DoFilterByValue Header/EmptyRange error dialog raised for FilterByValue in Sheet"),zb.Task.Ua(!1);
if(vb.hasAutoFilter){if(Wa&&Wa.contains(this.gridView.ha.sa.activeCell))return this.feb=Fb.none,this.PVc();this.feb=Fb.twice;return this.Q6b(Fb.twice)}this.feb=Fb.once;return this.Q6b(Fb.once)};c.prototype.Q6b=function(kb){function vb(Cb){sa.a(Cb)?k.ULS.sendTraceTag(527500297,0,50,"GridContextMenuFilter::ToggleFilter service call failed with errors : {}",za.a.Ec(Cb.Errors)):(k.ULS.sendTraceTag(527500298,0,50,"GridContextMenuFilter::ToggleFilter service call succeeded"),kb===Fb.twice?qb.Q6b(Fb.once):
qb.PVc())}function Wa(){return new ra.a(yb)}var qb=this,yb=C.v(this.gridView.ha.sa.Vc,this.$);if(!yb)return zb.Task.Ua(!1);this.deb||(this.deb=Date.now());var ec=new ta.a(368460465,2,this.$.Jc,19,null),Ob=this.$.oa.xa.Pb();return wa.EwaSettings.Zb()?xa.a(this.$.userOperationManager,function(Cb,ab,ya){return da.A(qb.$.oa.xa,yb,V.b(Cb,vb),ab,ya,null,Ob)},function(Cb){return new Q.a(516,0,Cb,64,Wa)},ec):xa.a(this.$.userOperationManager,function(Cb,ab,ya){return da.A(qb.$.oa.xa,yb,V.b(Cb,vb),ab,ya,null,
Ob)},function(Cb){return new Ga.a(516,0,Cb,void 0,Wa)},ec)};c.prototype.$Vg=function(kb,vb,Wa){return null!=kb&&qa.d(kb)&&Wa.top===kb.usedRange.top||null!=vb&&vb.Zaa&&Wa.top===vb.top?(this.wqc(this.$,225),!0):null!=kb&&qa.g(kb)&&Wa.top===kb.usedRange.bottom?(this.wqc(this.$,226),!0):!1};c.prototype.ZVg=function(kb,vb){if(kb&&kb.contains(vb)&&vb.top===kb.top||!kb&&this.$Ug(vb.top,vb.left))return this.wqc(this.$,227),!0;kb=new H.Range(vb.top,vb.left,vb.top+1,vb.left+1,!1,!1);return this.gridView.Ab.Lwa(kb)?
(this.wqc(this.$,228),!0):!1};c.prototype.wqc=function(kb,vb){vb=za.a.Xc(1,1,754,vb,0,147079615,"ContextMenuFilterByCellValueError");wa.EwaSettings.kz()?new ia.a(kb,vb):(kb=new na.ErrorDialog(kb,vb),kb.initialize(),kb.gf())};c.prototype.PVc=function(){function kb(Cb){var ab={};ab=(ab.ToggleFilterOperationCount=vb.feb,ab.ApplyFilterTime=vb.RVc?Date.now()-vb.RVc:-1,ab.ToggleAndApplyFilterTime=vb.deb?Date.now()-vb.deb:-1,ab.FilterByValueType=qb.AutoFilterType,ab);k.ULS.sendTraceTag(527500295,0,50,"GridContextMenuFilter::ApplyFilterByValue Perf Telemetry : {0}",
JSON.stringify(ab));vb.deb&&(vb.deb=0);Ha.a.Iwc(Cb)&&(ab=Ha.a.O$b(Cb),vb.fMa?Ha.a.ZPa(ob.a.filterByCellValue,ab.MessageIdName,ib.a.Yra,!0,Ha.a.isSessionEndingError(ab.MessageId)):k.ULS.sendTraceTag(527500294,0,10,"GridContextMenuFilter::ApplyFilterByValue failed with FilterException -{0}",ab.MessageIdName));sa.a(Cb)?k.ULS.sendTraceTag(527500292,0,50,"GridContextMenuFilter::ApplyFilterByValue service call failed with errors : {}",za.a.Ec(Cb.Errors)):(k.ULS.sendTraceTag(527500293,0,50,"GridContextMenuFilter::ApplyFilterByValue service call succeeded"),
Ia.b(vb.$).yd(Ka.a.twf,vb.dm(),void 0,!0),Cb={},Cb.FirstRow=vb.INh(),Cb.FirstColumn=qb.Column,-1!==Cb.FirstRow&&(Cb=C.C(Cb),vb.hL(Cb)))}var vb=this;this.RVc=Date.now();var Wa=this.SZh();if(!Wa)return k.ULS.sendTraceTag(527500296,0,50,"GridContextMenuFilter::ApplyFilterByValue . CellValue returned is null"),zb.Task.Ua(!1);var qb=this.TU(),yb={FirstRow:0};yb.FirstColumn=qb.Column;yb.SheetName=qb.SheetName;Ia.b(this.$).yd(Ka.a.Ssf,this.dm(),void 0,!0);var ec=this.r2c(qb,yb),Ob=new Q.a(208,0,function(Cb,
ab,ya){return P.a(vb.$.oa.xa,ec,Wa,V.b(Cb,kb),ab,ya,null,null)},6,function(){return new db.a(Wa,ec)});this.namedSheetViewPublic?this.namedSheetViewPublic.BAa().continueWith(function(Cb){Cb.result&&vb.$.userOperationManager.Sb(Ob,null)}):this.$.userOperationManager.Sb(Ob,null);return zb.Task.Ua(!0)};c.prototype.hL=function(kb){U.a.Bba(this.$)&&fa.TaskExtensions.Aa(Xa.GetServiceTaskFactory.Ra(this.$.da,430,431,1),function(vb){vb.result.eea(kb);k.ULS.sendTraceTag(527500291,306,50,"GridContextMenuFilter:TriggerPivotTableHandRaise Trigger hand raise from context menu filterByValue.")},
this.$.la,3)};c.prototype.dm=function(){var kb={};return kb.Location="contextMenu",kb};c.prototype.TU=function(){var kb=0,vb=this.gridView.ha.sa.activeCell;var Wa=this.$.da.za(66).pg;var qb=this.$.da.za(66).yub(vb);if(Wa){var yb="Table";kb=Wa.objectId}else qb?(yb="Table",kb=qb.id):yb="Sheet";Wa=vb.left;vb={};vb.AutoFilterType=yb;vb.Column=Wa;vb.Id=kb;yb={};this.$.Lj(yb);yb.FirstRow=0;yb.FirstColumn=vb.Column;kb=this.$.ea.isNamedObjectViewMode;vb.NamedObjectView=kb;vb.SheetName=kb?yb.NamedObjectName:
yb.SheetName;vb.ItemListOptions=null;return vb};c.prototype.$Ug=function(kb,vb){kb=H.Range.Tc(kb,vb);return this.gridView.Ea.b$(kb,this.$.pa.name)&&(kb=this.gridView.Ea.YJa(kb))&&kb.autoFilterMenu?!0:!1};c.prototype.SZh=function(){var kb=null,vb=this.gridView.Ub(this.gridView.ha.sa.activeCell);if(!vb)return null;var Wa=vb.cell.zSd;var qb=this.instantaneousSupportInformationManager.cTa(Wa,!1).category;if(1===vb.Nw.type)if(3===qb){if(!vb.cell.O8a)return k.ULS.sendTraceTag(527500290,0,15,"GridContextMenuFilter::GetValueForFilter() for category : {0}. NumFmt is null. ",
qb),null;kb=(vb.cell.O8a.Start+vb.cell.O8a.End).trim()}else if(!qb&&(ba.a.b0a(vb.Nw.value,"E")||ba.a.b0a(vb.originalText,"E"))){kb=this.Fg.MTe(vb.Nw.value,Wa,1,Number.POSITIVE_INFINITY,vb.cell.L$);if(!kb.success)return k.ULS.sendTraceTag(527500289,0,50,"GridContextMenuFilter::GetValueForFilter() for category : {0}. Failed to acquire formatted value",qb),null;kb=kb.$y}kb||(kb=vb.originalText);return oa.a.p_c(kb)?["[Blanks]"]:["i"+kb.trim()]};c.prototype.INh=function(){var kb=this.gridView.ha.sa.activeCell,
vb=this.$.da.za(66).pg,Wa=this.$.da.za(66).yub(kb);if(vb)return vb.usedRange.top;if(null!=Wa)return Wa.top;vb=this.$.va.getItemByName(this.$.pa.sheetName);return(vb=C.D(vb.w0))&&vb.contains(kb)?vb.top:-1};c.prototype.r2c=function(kb,vb){var Wa={};Wa.Location=vb;Wa.FieldId=kb.Id.toString();Wa.DataSourceIndex=-1;Wa.FilterType=kb.AutoFilterType;Wa.AnchorType=0;Wa.ChartId=null;Wa.AnchorValue1=-1;Wa.AnchorValue2=-1;Wa.Property=kb.RichProperty;return Wa};Object(u.a)(c,"GridContextMenuFilter",null,[]);b.d(E,
"GridContextMenu",function(){return a});var Yb=B.a;Rk(a,Yb);a.prototype.dispose=function(){Yb.prototype.dispose.call(this);this.grid=null};a.prototype.Lc=function(kb,vb){kb=!this.kpd(kb,vb);if(!kb)switch(vb){case -1977666927:kb=null==this.l4a||this.Fvj();break;case 1549396389:kb=null==this.l4a||!this.Lei();break;case 2045563128:case 1803952894:kb=null==this.l4a||!this.$.isEditMode&&!this.Mei()}return kb};a.prototype.kpd=function(kb,vb){var Wa=this.grid.ha.sa.selectedRanges;return(new R.a(this.$.va)).zm(kb,
vb,Wa,this.grid)};a.prototype.executeCommand=function(kb,vb,Wa){var qb=vb.command;kb=null;switch(qb){case -1396319072:if(vb=this.grid.Ub(null))l.a.instance.dZc(!0),n.EventHandlerManager.instance.Cad(),a.eUi(vb);break;case -1253126584:this.removeHyperlinksFromRange(this.grid.ha.sa.selectedRanges,vb);break;case 324156914:kb=this.grid.startEdit(!1,1);break;case 1441131127:this.showGridContextMenu(Wa);break;case -1977666927:kb=this.l4a.qgh();break;case 1549396389:kb=this.l4a.Ggh();break;case 1803952894:kb=
this.l4a.vgh();break;default:kb=X.a(qb)}return kb||fa.TaskExtensions.Saa()};a.prototype.zc=function(kb,vb,Wa){kb=!1;switch(vb.command){case -1396319072:case -1253126584:case 324156914:case -1977666927:case 1549396389:case 1803952894:kb=!0;break;case 1441131127:kb=!!Wa}return kb};a.prototype.IY=function(kb){kb=void 0===kb?!1:kb;var vb=!1,Wa=!1,qb=0;wa.EwaSettings.isChangeGateEnabled("OfficeVSO:5244620_ContextualUIDetailedTelemetryIsEnabled")&&(qb=f.a.me());var yb=this.Va.jq(this.menuId),ec=this.grid.ha.sa,
Ob=ec.sg,Cb=Ob&&ec.Vc.Te,ab=Ob&&ec.Vc.isRow;ec=ec.selectedRanges;var ya=v.a.all(ec,function(Na){return Na.Te}),ma=v.a.all(ec,function(Na){return Na.isRow}),ha=C.O(ec),Z=C.P(ec);this.zef(Cb,ab)?(vb=!0,this.HFh(yb)):this.$.isEditMode?va.a(this.$)?this.IFh(yb,Cb,ab):(this.FEh(yb,!(ab||Cb||!this.Xhc)),this.bFh(yb,ec,kb),this.REh(yb,ya,ma,ha,Z),this.YUe(yb,Ob,Cb,ab),this.$Fh(yb),this.DUe(yb,Cb,ab),this.xFh(yb,Ob,Cb,ab,ec),this.IEh(yb),this.GEh(yb,ec),this.iFh(yb),this.VFh(yb,Ob),wa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ImmersiveReader",
!1)&&this.WEh(yb)):(Wa=!0,va.a(this.$)?this.TUe(yb):this.pGh(yb,Ob,Cb,ab,ec));wa.EwaSettings.isChangeGateEnabled("OfficeVSO:5244620_ContextualUIDetailedTelemetryIsEnabled")&&(kb=f.a.me()-qb,k.ULS.sendTraceTag(537167046,0,50,"GridContextMenu::CreateMenuModel, ExecutionTimeTotal: {0}, isPivotMenu: {1}, isViewMenu: {2}, firstTimeEntry: {3}",kb,vb,Wa,this.$Ce));this.$Ce=!1;return yb};a.prototype.NJa=function(kb){var vb=[];if(va.a(this.$))return vb;if(3===kb){kb=this.grid.ha.sa;var Wa=kb.sg,qb=Wa&&kb.Vc.Te,
yb=Wa&&kb.Vc.isRow,ec=!1,Ob=!1,Cb=!1;this.$.isMobileMode&&(Ob=kb.selectedRanges,ec=C.O(Ob),Ob=C.P(Ob));if(Wa){var ab=ja.e(this.grid);ab&&ab.range.contains(kb.Vc)&&this.nV(ab)&&(Cb=!0)}this.$.isEditMode?this.zef(qb,yb)?Array.addRange(vb,[T.a.KFf,T.a.MFf]):qb||yb?(vb.push(T.a.clipboard),yb?vb.push(T.a.Thj):qb&&vb.push(T.a.BZg)):(Array.addRange(vb,[T.a.edit,T.a.clipboard]),Cb?vb.push(T.a.hyperlink):vb.push(T.a.color),Wa&&vb.push(T.a.uMg)):(vb.push(T.a.copy),Cb&&vb.push(T.a.openHyperlink),!yb||this.$.isMobileMode&&
Ob?!qb||this.$.isMobileMode&&ec||vb.push(T.a.CVj):vb.push(T.a.DVj));vb.push(T.a.r0h)}else 2===kb&&vb.push(T.a.jwe);return vb};a.prototype.zef=function(kb,vb){return(this.yAa||this.Iva||this.$Y||this.refresh||this.expandCollapse)&&!(kb||vb)};a.prototype.showGridContextMenu=function(kb){this.expandCollapse=this.refresh=this.$Y=this.Iva=this.yAa=!1;var vb=this.$,Wa=ca.a(vb).aKa(),qb=this.grid.ha.sa,yb=qb.sg,ec=yb&&qb.Vc.Te;qb=yb&&qb.Vc.isRow;if(Wa&&!ec&&!qb){ec=ea.a(vb);if(null===ec||void 0===ec?0:ec.TPd)this.yAa=
ec=K.f(vb.mg),this.Iva=!ec;ec=vb.hc;this.$Y=Wa.supportsBIExplore&&!!F.a(vb)&&ec.x2(32768);ec.allowInteractivity&&(vb=this.grid.Ub(null),(null===vb||void 0===vb?0:vb.cell)&&(vb.cell.TYc||vb.cell.x1f)&&(this.expandCollapse=!0),ec.allowManualDataRefresh&&(this.refresh=!0))}vb=null;Wa=1;ec=Object(m.a)(r.a,kb.eventArgs);kb=Object(m.a)(G.a,kb.creationParams);qb=this.MKh();kb?(vb=kb.clientPoint,Wa=kb.inputMethod):ec&&1!==ec.lb?(vb=new Sys.UI.Point(ec.clientPoint.x,ec.clientPoint.y),Wa=ec.lb):qb&&(vb=new Sys.UI.Point(qb.x+
(this.$.isChromeRtl?0:qb.width),qb.y+qb.height));N.a.Cb=Wa;this.Xhc=3===Wa;kb=z.a.ktb;this.hp(vb,!ec||ec.Ca.target.className!==kb,Wa)};a.prototype.removeHyperlinksFromRange=function(kb,vb){var Wa=this;if(!wa.EwaSettings.isChangeGateEnabled("OfficeVSO:5639309_CheckedProtectedRangeUnlockStateWhenInsertHyperlink")||this.$.hq(kb,!0)){var qb=C.r(kb,this.$),yb=this.$.oa.xa.Pb();this.$.userOperationManager.Sb(new Q.a(125,0,function(ec,Ob,Cb){Wa.$.ly();return P.b(Wa.$.oa.xa,qb,"","",!0,!1,127,ec,Ob,Cb,null,
yb)},void 0,function(){return new d(qb)}),vb);this.grid.hg.GG(!1)}};a.prototype.MKh=function(){var kb=this.grid.Ub(null);if((null===kb||void 0===kb?0:kb.cell.sk)&&this.Fdf(kb))return this.grid.getCellBounds(kb.cell);kb=this.grid.ha.sa.activeCell;return(kb=this.y9b(new H.Range(kb.top,kb.left,A.a.sh,kb.left,!1,!1),2,!0)||this.y9b(new H.Range(1,kb.left,kb.top,kb.left,!1,!1),2,!1)||this.y9b(new H.Range(kb.top,kb.right,kb.top,A.a.Bh,!1,!1),1,!0)||this.y9b(new H.Range(kb.top,1,kb.top,kb.right,!1,!1),1,
!1)||null)&&kb.sk?this.grid.getCellBounds(kb):Sys.UI.DomElement.getBounds(this.grid.K4a.ic)};a.prototype.Fdf=function(kb){var vb=this.grid.rtl,Wa=this.$.isChromeRtl;kb=kb.cell;var qb=ja.g(this.$).LJ(kb);return qb?(qb=qb.topLeft,vb=qb.x+=vb===Wa?kb.offsetWidth:0,Wa=qb.y+=kb.offsetHeight,this.grid.view.visibleArea.contains(new D.a(vb,Wa,0,0))):!1};a.prototype.y9b=function(kb,vb,Wa){kb=this.grid.Xj("GridContextMenu.FindFirstCellInViewportArea",kb,vb,Wa);try{for(kb.$$rst();kb.$$mn();){var qb=kb.$$cu();
if(qb&&this.Fdf(qb))return qb.cell}}finally{kb&&kb.dispose()}return null};a.prototype.HFh=function(kb){var vb=this.Va,Wa=vb.Bc();this.refresh&&Wa.buttons.push(vb.nb(100));this.$Y&&Wa.buttons.push(vb.nb(99));this.yAa?Wa.buttons.push(vb.nb(59)):this.Iva&&Wa.buttons.push(vb.nb(58));if(this.expandCollapse){var qb=vb.Qv("ContextMenu.PivotExpandCollapse",null,O.a.instance.ga(1144),589118293);var yb=vb.Bc();yb.buttons.push(vb.nb(243));yb.buttons.push(vb.nb(244));yb.buttons.push(vb.nb(245));yb.buttons.push(vb.nb(246));
qb.menu.pc.push(yb);qb&&0<yb.buttons.length&&Wa.buttons.push(qb)}kb.pc.push(Wa)};a.prototype.YUe=function(kb,vb,Wa,qb){if(vb&&!Wa&&!qb){vb=this.Va.Bc();this.Afc&&!this.$.TM&&this.tbd(vb);this.Abd(vb);this.dGh(vb);if(wa.EwaSettings.ma(481)&&ja.g(this.$).ha.sa.XJ()&&ja.g(this.$).ha.sa.l5)switch(wa.EwaSettings.getIntFeatureGate("Microsoft.Office.ExcelOnline.Insights.GridContextMenuQnABrandingCandidatesIndex",0)){case 1:vb.buttons.push(this.Va.nb(237));break;case 2:vb.buttons.push(this.Va.nb(238));break;
default:vb.buttons.push(this.Va.nb(236))}kb.pc.push(vb)}};a.prototype.Abd=function(kb){if(!wa.EwaSettings.isChangeGateEnabled("OfficeVSO:6172529_FixAllowSort")||this.$.hc.allowSorting)if(!wa.EwaSettings.isChangeGateEnabled("OfficeVSO:5230917_HideSortForProtectedSheetInMobiles")||!this.$.isMobileMode||(new R.a(this.$.va)).Ud(2048)){var vb=this.Va.Bc();vb.buttons.push(this.Va.nb(223));vb.buttons.push(this.Va.nb(224));wa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PutSelectedItemOnTop",
!1)&&(vb.buttons.push(this.Va.nb(292)),vb.buttons.push(this.Va.nb(293)),vb.buttons.push(this.Va.nb(294)));this.$.isMobileMode||vb.buttons.push(this.Va.nb(225));var Wa=this.Va.Qv("ContextMenu.sort",null,O.a.instance.ga(229),-864298118);Wa.menu.pc.push(vb);kb.buttons.push(Wa)}};a.prototype.tbd=function(kb){var vb=this.Va.Qv("ContextMenu.filter",null,O.a.instance.ga(1940),2045563128),Wa=this.Va.Bc(),qb=this.jPh(),yb=this.Va.nb(234);yb.label=qb;Wa.buttons.push(yb);Wa.buttons.push(this.Va.nb(235));qb=
this.Va.Bc();qb.buttons.push(this.Va.nb(233));vb.menu.pc.push(Wa);vb.menu.pc.push(qb);kb.buttons.push(vb)};a.prototype.dGh=function(kb){if(ja.g(this.$).ha.sa.XJ()){var vb=this.Va.Bc();vb.buttons.push(this.Va.nb(232));wa.EwaSettings.isChangeGateEnabled("OfficeVSO:6680193_FlighRemovalTableAltText")&&(vb.buttons.push(this.Va.nb(285)),vb.buttons.push(this.Va.nb(286)));var Wa=this.Va.Qv("ContextMenu.table",null,O.a.instance.ga(1939),-697806646);Wa.menu.pc.push(vb);kb.buttons.push(Wa)}};a.prototype.OUe=
function(kb,vb,Wa,qb,yb){if(vb){var ec=C.K(yb),Ob=ja.e(this.grid);if(Ob&&!Wa&&!qb){Wa=new R.a(this.$.va);if(Ob.range.contains(ec)&&this.nV(Ob)){(vb=!Ob.WLa&&!Wa.fj)&&this.$.isEditMode&&kb.buttons.push(this.Va.nb(45));Ob.Yaa&&kb.buttons.push(this.Va.nb(53));vb&&this.$.isEditMode&&kb.buttons.push(this.Va.nb(47));return}!Ob.WLa&&this.$.isEditMode&&(Ob=Wa.Ud(128),kb.buttons.push(this.Va.nb(Ob?46:121)))}}this.V3i(yb)&&kb.buttons.push(this.Va.nb(48));(Ob=this.$.va.pa)&&Ob.Md&&(Ob=Ob.Md.Qx||Ob.Md.bK,!vb||
this.$.TM||!wa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)||this.$.ea.isNamedObjectViewMode||this.$.isMobileMode||Ob||(vb=C.K(yb),this.U3i(vb)?kb.buttons.push(this.Va.nb(276)):vb.Te||vb.isRow||kb.buttons.push(this.Va.nb(275))))};a.prototype.V3i=function(kb){kb=bk(kb);for(var vb=kb.next();!vb.done;vb=kb.next()){vb=this.grid.getRangeInformation(vb.value);for(var Wa=0;Wa<vb.length;Wa++)if(Object(w.a)(J.HyperlinkRange,vb[Wa])){var qb=this.grid.Ub(vb[Wa]);if(qb&&this.nV(qb)&&
!qb.WLa)return!0}}return!1};a.prototype.U3i=function(kb){if(ja.g(this.$).ha.sa.XJ()){var vb=ja.g(this.$).Ab.dk(kb);if(vb&&vb.usedRange.equals(kb))return!0}return!1};a.prototype.DUe=function(kb,vb,Wa){var qb,yb;if(1===ja.g(this.$).ha.Pe&&!vb&&!Wa){vb=va.a(this.$);Wa=this.Va;var ec=Wa.Bc(),Ob=this.$.da.za(65);(null===(qb=null===Ob||void 0===Ob?void 0:Ob.Cm)||void 0===qb?0:qb.OE)&&!vb&&ec.buttons.push(Wa.nb(227));Ob&&Ob.isCommentOperationEnabled(3)&&ec.buttons.push(Wa.nb(221));(null===(yb=null===Ob||
void 0===Ob?void 0:Ob.Cm)||void 0===yb?0:yb.Xhd)&&!vb&&ec.buttons.push(Wa.nb(228));(null===Ob||void 0===Ob?0:Ob.hasCommentAtActiveCell)?Ob.eC.isResolved||ec.buttons.push(Wa.nb(159)):Ob&&Ob.hasCommentAtActiveCell||(Ob&&Ob.Cm&&Ob.Cm.OE?vb||(ec.buttons.push(Wa.nb(229)),ec.buttons.push(Wa.nb(230))):(ec.buttons.push(Wa.nb(160)),vb||ec.buttons.push(Wa.nb(226))));kb.pc.push(ec)}};a.prototype.$Fh=function(kb){if(wa.EwaSettings.ma(135)){var vb=this.Va,Wa=vb.Bc();Wa.buttons.push(vb.nb(250));kb.pc.push(Wa)}};
a.prototype.bFh=function(kb,vb,Wa){if(!Wa){Wa=this.$.Ka.bH();var qb=new R.a(this.$.va),yb=new ka.a(Wa,vb,this.grid);(new e(kb,this.$,this.Va,Wa,vb,this.grid,yb,qb)).obd()}};a.prototype.REh=function(kb,vb,Wa,qb,yb){var ec=(new R.a(this.$.va)).Ud(8),Ob=this.Va,Cb=Ob.Bc();vb&&Cb.buttons.push(Ob.nb(ec?152:153));Wa&&Cb.buttons.push(Ob.nb(ec?150:151));vb&&(qb||Cb.buttons.push(Ob.nb(ec?109:155)),Cb.buttons.push(Ob.nb(ec?111:157)));Wa&&(yb||Cb.buttons.push(Ob.nb(ec?108:154)),Cb.buttons.push(Ob.nb(ec?110:
156)));kb.pc.push(Cb)};a.prototype.FEh=function(kb,vb){var Wa=this.Va,qb=Wa.Bc();kb.pc.push(qb);vb&&qb.buttons.push(Wa.nb(102));qb.buttons.push(Wa.nb(42));qb.buttons.push(Wa.nb(43));vb=this.EFh(Wa);kb.pc.push(vb)};a.prototype.EFh=function(kb){var vb=kb.Bc();vb.title=O.a.instance.ga(1124);vb.s3f=!1;vb.r3f=!1;vb.K8f=!1;var Wa=5,qb=U.a.Gqd(this.$);qb&&(Wa=6);kb=kb.lC("PasteOptionsGallery",Wa,"Size24by24",vb.title);vb.buttons.push(kb);kb.zt("ContextMenu.Paste",237279923,"QueryAdvancedPasteContextMenuGalleryIcon",
1125,void 0,"Paste_24",1,x.a.ksh);kb.zt("ContextMenu.PasteValues",-185374993,"QueryAdvancedPasteContextMenuGalleryIcon",1126,void 0,"PasteValues_24",1,x.a.psh);kb.zt("ContextMenu.PasteFormulas",1766348718,"QueryAdvancedPasteContextMenuGalleryIcon",1127,void 0,"PasteFormulas_24",1,x.a.msh);kb.zt("ContextMenu.PasteTranspose",-958589048,"QueryAdvancedPasteContextMenuGalleryIcon",1128,void 0,"PasteTranspose_24",1,x.a.osh);kb.zt("ContextMenu.PasteFormatting",1804571062,"QueryAdvancedPasteContextMenuGalleryIcon",
1129,void 0,"PasteFormatting_24",1,x.a.lsh);qb&&kb.zt("ContextMenu.PasteLink",42074747,"QueryAdvancedPasteContextMenuGalleryIcon",1130,void 0,"PasteLink_24",1,x.a.nsh);return vb};a.prototype.pGh=function(kb,vb,Wa,qb,yb){var ec,Ob=this.Va,Cb=Ob.Bc();Cb.buttons.push(Ob.nb(43));kb.pc.push(Cb);this.Afc&&!this.$.TM&&(Cb=this.Va.Bc(),this.tbd(Cb),kb.pc.push(Cb));wa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MiniWACInReadOnlyEditMode",!1)&&this.$.ea.hc.isMobileMode&&this.$.ea.hc.isReadOnlyEditMode&&
!this.$.ya.IsMeetingLiveSession||(Cb=this.Va.Bc(),this.Abd(Cb),kb.pc.push(Cb),k.ULS.sendTraceTag(537167045,0,50,"GridContextMenu::GenerateViewMenuSection, Remove the sort options from right contextual menu in mobile, readonlyeditmode and non-meeting scenario"));Cb=this.$.da.za(65);if(null===(ec=null===Cb||void 0===Cb?void 0:Cb.Cm)||void 0===ec?0:ec.OE)ec=this.Va.Bc(),ec.buttons.push(Ob.nb(229)),kb.pc.push(ec);ec=this.Va.Bc();this.OUe(ec,vb,Wa,qb,yb);kb.pc.push(ec);y.AFrameworkApplication.isMobileMode&&
!M.a(this.$.ya,30)&&(vb=Ob.Bc(),vb.buttons.push(Ob.nb(272)),kb.pc.push(vb))};a.prototype.xFh=function(kb,vb,Wa,qb,yb){var ec=this.Va.Bc();this.yFh(ec);this.OUe(ec,vb,Wa,qb,yb);0<ec.buttons.length&&kb.pc.push(ec)};a.prototype.yFh=function(kb){kb.buttons.push(this.Va.nb(135))};a.prototype.WEh=function(kb){var vb=this.Va.Bc();vb.buttons.push(this.Va.nb(185));kb.pc.push(vb)};a.prototype.VFh=function(kb,vb){wa.EwaSettings.ma(482)&&vb&&(vb=this.Va.Bc(),vb.buttons.push(this.Va.nb(262)),kb.pc.push(vb))};
a.prototype.iFh=function(kb){var vb=this.grid.ha.sa.selectedRanges;if(vb&&vb.length){for(var Wa=!1,qb=0;qb<vb.length;qb++)if(this.grid.Ab.Swa(vb[qb])){Wa=!0;break}if(Wa){Wa=!1;if(wa.EwaSettings.isChangeGateEnabled("OfficeVSO:6411410_RemoveConvertToTextForRichValueRange"))for(qb=0;qb<vb.length;qb++){var yb=this.grid.Ab.oTh(vb[qb]);if(null!=yb&&null!=yb[0]){for(var ec=0;ec<yb.length;ec++)if(this.grid.Ab.Swa(yb[ec])){Wa=!0;break}if(Wa)break}}ec=this.Va;qb=ec.Bc();yb=ec.Bc();for(var Ob=1===vb.length&&
(vb[0].isSingle||this.grid.Ab.M6a(vb[0])),Cb=!1,ab=!1,ya=!1,ma=!1,ha=0;ha<vb.length&&!(Cb&&ya&&ab&&ma);ha++)!Cb&&this.grid.Ab.wji(vb[ha])&&(Cb=!0),!ya&&this.grid.Ab.wdf(vb[ha],!1)&&(ya=!0),!ab&&this.grid.Ab.Zod(vb[ha])&&(ab=!0),!ma&&this.grid.Ab.Oei(vb[ha])&&(ma=!0);wa.EwaSettings.ma(105)&&Ob&&!this.grid.Ab.bfc(vb[0])&&(ma?qb.buttons.push(ec.nb(217)):qb.buttons.push(ec.nb(216)));ma=Cb;ma=!(new R.a(this.$.va)).fj&&ma;ya&&!Wa&&(wa.EwaSettings.ma(131)&&K.l(this.$.mg)&&(wa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LinkedEntityRefreshMenu",
!1)&&(wa.EwaSettings.isChangeGateEnabled("OfficeVSO:5695344_showRefreshSettingsOnProtectedSheet")?yb.buttons.push(ec.nb(220)):yb.buttons.push(ec.nb(ma?220:271))),ab&&yb.buttons.push(ec.nb(ma?218:269)),Ob&&(this.grid.Ab.Zod(vb[0])||this.grid.Ab.bfc(vb[0]))&&yb.buttons.push(ec.nb(ma?219:270))),yb.buttons.push(ec.nb(ma?215:268)));0<yb.buttons.length&&(vb=ec.Qv(Cb?"ContexMenu.LinkedEntitiesFlyOut_EnabledContents":"ContexMenu.LinkedEntitiesFlyOut_DisabledContents",null,O.a.instance.ga(1758),798637440),
vb.menu.pc.push(yb),qb.buttons.push(vb));0<qb.buttons.length&&kb.pc.push(qb)}}};a.prototype.GEh=function(kb,vb){this.grid.Ab.Kbf(vb)&&(vb=this.Va.Bc(),this.grid.ha.sa.Eba()?(vb.buttons.push(this.Va.nb(241)),vb.buttons.push(this.Va.nb(239))):vb.buttons.push(this.Va.nb(240)),kb.pc.push(vb))};a.prototype.nV=function(kb){return kb.cell.hasHyperlink};a.prototype.TUe=function(kb){this.JFh(kb);var vb=this.Va.Bc();this.Abd(vb);kb.pc.push(vb);this.Afc&&(vb=this.Va.Bc(),this.tbd(vb),kb.pc.push(vb))};a.prototype.IFh=
function(kb,vb,Wa){this.TUe(kb);this.DUe(kb,vb,Wa)};a.prototype.JFh=function(kb){if(this.grid.ha.sa.sg&&!this.grid.eb.Ji){var vb=this.Va,Wa=vb.Bc();ua.a(this.$).wQd()?Wa.buttons.push(vb.nb(265)):Wa.buttons.push(vb.nb(264));kb.pc.push(Wa)}};a.eUi=function(kb){var vb=kb.UJa(a.tjd);vb&&vb.gld&a.tjd&&kb.invoke(a.tjd,null)};a.aFh=function(kb,vb,Wa){if(wa.EwaSettings.isChangeGateEnabled("OfficeVSO:5552180_DontAssertIfCopyPasteInfraNotReadyOnContextMenuOpen")){if(Wa=Wa.da.za(254),!Wa){k.ULS.sendTraceTag(537167044,
0,50,"GridContextMenu::GenerateInsertCopiedCutCellsConextMenu, CopyPasteInfrastructure is not ready.");return}}else if(Wa=Wa.da.za(254,!0),!Wa)return;Wa.Nnd()&&Wa.wif()&&kb.buttons.push(vb.nb(212));Wa.Nnd()&&Wa.Pic()&&kb.buttons.push(vb.nb(213))};a.prototype.Fvj=function(){var kb=this.$.da.za(66).pg,vb=this.grid.ha.sa.activeCell;return null!=kb&&!kb.hasActiveFilter||aa.c(this.$,vb)||!this.Nei(vb)};a.prototype.Nei=function(kb){var vb=kb.left,Wa=this.Ybc();if(null!=Wa&&null!=Wa.o9b&&Array.contains(Wa.o9b,
vb-1))return!0;Wa=this.Pbc();return null!=Wa&&C.D(Wa).contains(kb)&&null!=Wa.FilteredColumns&&Array.contains(Wa.FilteredColumns,vb-1)?!0:!1};a.prototype.Lei=function(){var kb=this.$.da.za(66).pg,vb=this.Ybc();if(null!=kb)return kb.hasAutoFilter&&kb.hasActiveFilter;if(null!=vb)return null!=vb.o9b&&0<vb.o9b.length;kb=this.Pbc();return null!=kb&&null!=kb.FilteredColumns&&0<kb.FilteredColumns.length};a.prototype.Mei=function(){var kb=this.$.da.za(66).pg,vb=this.Ybc();if(null!=kb&&kb.hasAutoFilter||null!=
vb&&vb.RZa.every(function(Wa){return 0!=Wa.length}))return!0;kb=C.D(this.Pbc());return null!=kb&&kb.contains(this.grid.ha.sa.activeCell)?!0:!1};a.prototype.Ybc=function(){var kb=this.$.da.za(66);kb.Vm(this.grid.ha.sa.activeCell);return kb.yub(this.grid.ha.sa.activeCell)};a.prototype.Pbc=function(){return this.$.va.getItemByName(this.$.pa.sheetName).w0};a.prototype.jPh=function(){var kb=this.grid.ha.sa.activeCell,vb=0,Wa=!1,qb=this.$.da.za(66),yb=this.Ybc();qb=qb.pg;null!=qb?(vb=qb.usedRange.top,Wa=
!0):null!=yb?(vb=yb.top,Wa=!0):(yb=this.Pbc(),null!=yb&&C.D(yb).contains(kb)&&(vb=yb.FirstRow+1,Wa=!0));return Wa?(kb=kb.left,vb=H.Range.Tc(vb,kb),vb=this.grid.Ub(vb),Wa="",null!=vb&&(Wa=vb.text),this.EPg(Wa,kb)):O.a.instance.ga(222)};a.prototype.EPg=function(kb,vb){null==kb||ba.a.fh(kb.trim())?kb=String.format(O.a.instance.mb(157),H.Range.GP(vb)):kb.length>a.K_d?(kb=kb.substring(0,a.K_d),kb=String.format(O.a.instance.mb(155),kb)):kb=String.format(O.a.instance.mb(156),kb);return kb};Mf.Object.defineProperties(a.prototype,
{uw:{configurable:!0,enumerable:!0,get:function(){return"PopulateGridContextMenu"}},sB:{configurable:!0,enumerable:!0,get:function(){return I.a.OKf}}});a.YIb="GridContextMenuRootName";a.A0h=I.a.JAe;a.tjd=192;a.K_d=26;Object(u.a)(a,"GridContextMenu",B.a,[])},1419:function(u,E,b){function a(ea,wa){var X=ca.call(this,ea)||this;X.JCa=null;X.IZc=[];X.z3d=null;X.Mva=!1;X.Jdc=!1;X.Xp=null;X.j$d=null;X.CIe=function(){X.wY.$Ia(X.items,X.JCa);X.raiseEvent("ACLBUpdated",new m.a(X.items.length));X.show()};X.tableManager=
wa;X.domElement.className=r.a.CLe;X.domElement.innerHTML=fa;O.DOMElementExtensions.setVisible(X.domElement,!1);R.d(X.style,X.$.isChromeRtl);X.icf=D.EwaSettings.xl();X.ewe=$get(k.D6f,X.domElement);X.wY=new c(X.$,X.ewe,X);X.pSa(!0);X.$.domElement.appendChild(X.domElement);X.hob(ea,C.a(ea));X.hob(ea,F.g(ea).Wb);X.icf||X.$.da.Ga(1,X);X.Sei=D.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChangeHandleKeyDownConditionOrder",!1);return X}function c(ea,wa,X){ea=K.call(this,ea,wa)||this;ea.cellAutoCompleteControl=
null;ea.$qa=null;ea.oyb=D.EwaSettings.xl();ea.oyb&&(ea.cellAutoCompleteControl=X);ea.mq=[];return ea}function d(ea,wa,X){var ja=G.call(this,ea,wa)||this;ja.RQb=null;ja.Jic=0;ja.z7a=null;ja.I0=null;ja.a6=function(va,ua){if(va=ja.cellAutoCompleteControl.items)if(1===va.length&&ja.cellAutoCompleteControl.w0a.length<va[0].Xra.length&&ja.cellAutoCompleteControl.Mva&&I.a.aL(va[0].Xra,ja.cellAutoCompleteControl.w0a)&&(ua.newValue=va[0].Xra),ja.Ya&&D.EwaSettings.ma(136)){var Xa=-1;1<va.length?Xa=ja.cellAutoCompleteControl.Ubc(ja.Ya.text,
!0):1===va.length&&(ja.cellAutoCompleteControl.Mva||ja.cellAutoCompleteControl.Jdc)&&(Xa=0);if(0<=Xa&&va.length>Xa&&va[Xa].NWc){var aa=x.C(va[Xa].NWc);aa&&F.g(ja.$).Ab.Swa(aa)&&(ua.Gaf=!0,ua.fwe=va[Xa].NWc)}}};ja.YEb=function(){ja.cellAutoCompleteControl.Mva=!1};ja.Ya.jYa(ja.a6);ja.oyb=D.EwaSettings.xl();ja.oyb&&(ja.RQb=X);ja.I0=ja.je.Sd(ja.Ya.textBox.domElement);ja.I0.ka("mousedown",ja.YEb);return ja}function e(ea,wa){this.ykg=ea;this.xkg=wa}function k(){}b.r(E);u=b(0);var l=b(14),n=b(89),f=b(1292),
v=b(8),r=b(986);k.D6f="suggested_cells_list_box";Object(u.a)(k,"CssElementIds",null,[]);var y=b(5),m=b(1293);Mf.Object.defineProperties(e.prototype,{Xra:{configurable:!0,enumerable:!0,get:function(){return this.ykg}},NWc:{configurable:!0,enumerable:!0,get:function(){return this.xkg}}});Object(u.a)(e,"CellAutoCompleteItem",null,[567]);var w=b(4),B=b(85),A=b(1119),z=b(407),x=b(45),D=b(1),I=b(22),F=b(21),G=A.a;Rk(d,G);d.prototype.dispose=function(){this.Ya.THb(this.a6);G.prototype.dispose.call(this)};
d.prototype.$T=function(ea){ea&&!this.cellAutoCompleteControl.isListVisible||G.prototype.$T.call(this,ea)};d.prototype.Hh=function(ea,wa){this.cellAutoCompleteControl.Ya=this.Ya;this.Jic=ea.keyCode;if(this.Ya.isEditing){var X=this.Ya.text;I.a.equals(this.z7a,X,!1)||(this.z7a=X)}else this.z7a=null;if(237279923===wa)return this.cellAutoCompleteControl.isListVisible=!1;D.EwaSettings.ma(136)&&17===this.Jic&&this.cellAutoCompleteControl.Mva&&(this.cellAutoCompleteControl.Jdc=!0);return G.prototype.Hh.call(this,
ea,wa)};d.prototype.nyd=function(){var ea;if(!D.EwaSettings.isChangeGateEnabled("OfficeVSO:5172529_CheckForShuttingDownInAutocompletionTimedCallback")||!w.AFrameworkApplication.Ag)if(this.cellAutoCompleteControl.Ya=this.Ya,this.cellAutoCompleteControl.Mva=!1,this.Ya.isEditing){var wa=!I.a.equals(this.z7a,this.Ya.text,!0),X=this.Ya.Imd;X||!wa&&229!==this.Jic?X&&(this.cellAutoCompleteControl.isListVisible&&(this.cellAutoCompleteControl.isListVisible=!1),null===(ea=this.cellAutoCompleteControl.fNa)||
void 0===ea?void 0:ea.cancel()):this.cellAutoCompleteControl.iLg(this.Jic)}else this.z7a=null};d.prototype.Dh=function(){};d.prototype.Af=function(){this.pV=!1;this.cellAutoCompleteControl.set_visible(!1);this.z7a=null;this.cellAutoCompleteControl.Mva=!1;this.cellAutoCompleteControl.Jdc=!1;this.cellAutoCompleteControl.fNa&&this.cellAutoCompleteControl.fNa.cancel()};d.prototype.NEd=function(ea,wa){return this.cellAutoCompleteControl.Hh(ea,wa)};Mf.Object.defineProperties(d.prototype,{Dyb:{configurable:!0,
enumerable:!0,get:function(){return!1}},pV:{configurable:!0,enumerable:!0,get:function(){return this.cellAutoCompleteControl.isListVisible},set:function(ea){this.cellAutoCompleteControl.isListVisible=ea}},f5a:{configurable:!0,enumerable:!0,get:function(){return!1}},key:{configurable:!0,enumerable:!0,get:function(){return z.a.JZc}},cellAutoCompleteControl:{configurable:!0,enumerable:!0,get:function(){if(this.oyb)return this.RQb;var ea=b(1419).CellAutoCompleteControl;return this.RQb||(this.RQb=Object(B.a)(ea,
this.$.da.za(1)))}}});Object(u.a)(d,"CellAutoCompleteListAutoCompleteBehavior",A.a,[]);var T=b(29);A=b(1294);var O=b(12),U=b(11),J=b(117),H=b(70),K=A.a;Rk(c,K);c.prototype.dispose=function(){K.prototype.dispose.call(this);this.$qa=null};c.prototype.Kyc=function(ea){this.D7(!1);var wa=""+String.format("<table class='{0}' aria-live='polite'><tbody>",this.Uba);for(var X=0,ja=this.mq.length;X<ja;X++){var va=T.a.zg(ea[this.mq[X]].Xra);va=String.format("<tr><td class='{0}'><span class='{1}' {2}='{3}'>{4}</span></td></tr>",
this.i_,c.KZc,y.a.Doe,va,T.a.a7c(va));wa+=va}this.Pf.innerHTML=wa+"</tbody></table>";this.Gn=O.DOMElementExtensions.zj(this.domElement,this.Uba);this.D7(!0);this.Gra()};c.prototype.$Ia=function(ea,wa){if(ea&&ea.length){var X=[];if(wa)for(var ja=0,va=ea.length;ja<va;ja++)I.a.aL(ea[ja].Xra,wa)&&X.push(ja);this.mq=X;this.Kyc(ea)}else this.isListVisible=!1,this.$qa=null};c.prototype.Oxa=function(){};c.prototype.MSg=function(ea,wa,X){var ja=Math.min(ea,Math.max(200,X));wa&&ea<X&&(ja+=J.a.ev);O.DOMElementExtensions.rv(this.Pf,
ja);wa&&(ja-=J.a.ev);return ja};c.prototype.Gra=function(){K.prototype.Gra.call(this);var ea=O.DOMElementExtensions.zj(this.get_element(),this.Uba),wa=this.mq.length>this.JH,X=F.g(this.$);if(X=X.Ub(X.ha.sa.activeCell))for(ea=this.MSg(ea.offsetWidth,wa,X.width),wa=this.Pf.getElementsByClassName(c.KZc),X=0;X<wa.length;X++)wa[X].style.maxWidth=U.HelperMethods.jc(ea);else l.ULS.sendTraceTag(537167964,0,15,"CellAutoCompleteListBox.AdjustHeightAndWidth: Can't retrive FormattedCell of the Current Active Cell.")};
c.prototype.onItemClick=function(ea){if(ea=K.prototype.onItemClick.call(this,ea)){var wa=F.g(this.$);wa.wo(!1);wa.focus()}return ea};Mf.Object.defineProperties(c.prototype,{Ok:{configurable:!0,enumerable:!0,get:function(){return this.$qa},set:function(ea){this.gBa(this.Ok);this.$qa=ea;var wa=this.gBa(this.Ok);this.fe=ea?wa.innerText:null;this.nuc(ea)}},isListVisible:{configurable:!0,enumerable:!0,get:function(){return Object(H.a)(c.prototype,this,"isListVisible")},set:function(ea){Object(H.b)(c.prototype,
this,"isListVisible",ea);ea||(this.Ok=null)}},NSa:{configurable:!0,enumerable:!0,get:function(){return null}},hGa:{configurable:!0,enumerable:!0,get:function(){return this.oyb?this.cellAutoCompleteControl:this.cellAutoCompleteControl||(this.cellAutoCompleteControl=this.$.da.za(1))}}});c.KZc=r.a.Erh;Object(u.a)(c,"CellAutoCompleteListBox",A.a,[]);var N=b(24),M=b(64),C=b(114),Q=b(179),P=b(44),ka=b(34),R=b(259);A=b(19);b.d(E,"CellAutoCompleteControl",function(){return a});var fa="<div id='"+k.D6f+"' class='"+
r.a.q8c+" "+A.a.Lo+"' ></div>",ca=f.a;Rk(a,ca);a.prototype.mZb=function(ea){this.addHandler("ACLBUpdated",ea)};a.prototype.ksc=function(ea){this.removeHandler("ACLBUpdated",ea)};a.prototype.r2=function(ea){this.addHandler("ACLBSelectionChanged",ea)};a.prototype.gda=function(ea){this.removeHandler("ACLBSelectionChanged",ea)};a.prototype.SEg=function(ea){this.addHandler("ACLBMatchedItem",ea)};a.prototype.Oaj=function(ea){this.removeHandler("ACLBMatchedItem",ea)};a.prototype.S5f=function(ea){for(var wa=
0;wa<ea.length;wa++){var X=ea.charCodeAt(wa);if(D.EwaSettings.isChangeGateEnabled("OfficeVSO:4831363_UseUpdatedisLetterCharacterCodeRangesInStringExtensions")?I.a.isLetter(X):I.a.Und(X))return!0}return!1};a.prototype.zwa=function(){return!this.items};a.prototype.dispose=function(){if(this.$){this.pSa(!1);var ea=F.g(this.$);ea&&ea.view.Fq(this.Pmc)}n.a.oc([this.wY,this.fNa]);n.a.oc(this.IZc);this.IZc=this.ewe=this.wY=this.Ya=null;ca.prototype.dispose.call(this)};a.prototype.Hh=function(ea,wa){var X=
!1;if(this.bwj())switch(wa){case -798660877:if(1===this.items.length&&this.fe)break;this.Ft.lB(1);this.raiseEvent("ACLBSelectionChanged",new m.a(this.items.length,this.Ubc(this.fe),this.fe));X=this.Hy(!1);break;case 137938150:if(1===this.items.length&&this.fe)break;this.Ft.lB(-1);this.raiseEvent("ACLBSelectionChanged",new m.a(this.items.length,this.Ubc(this.fe),this.fe));X=this.Hy(!1);break;case 2091832999:this.Ft.lB(this.JH-1);X=this.Hy(!1);break;case 742457698:this.Ft.lB(-(this.JH-1));X=this.Hy(!1);
break;case 125627505:this.Ya.textBox.caretPosition=this.Ya.text.length;this.isListVisible=!1;X=!0;break;case 267796030:this.Hy(!0);break;default:X=ca.prototype.Hh.call(this,ea,wa)}return X};a.prototype.show=function(){this.items&&this.items.length&&(this.wY.Ok=this.fe?this.Ft.Gn.rows[this.Ubc(this.fe)]:null,this.isListVisible=0<this.wY.mq.length,this.vBa(!0),this.wY.Oxa())};a.prototype.iLg=function(ea){var wa=!!this.Ya&&!M.f(this.$.pa);this.Jdc=this.Mva=!1;this.Ya&&!this.Ya.isEditing?this.set_visible(!1):
wa&&!this.Zah(this.activeCell)&&this.Dzj(ea)};a.prototype.Zah=function(ea){return!!this.dataValidationControl&&this.dataValidationControl.b6c(ea)};a.prototype.Hy=function(ea){if(!this.Ya||!this.isListVisible)return!1;var wa=this.JCa;if(this.fe){var X=O.DOMElementExtensions.jZ(O.DOMElementExtensions.zj(this.wY.Ok,c.KZc),y.a.Doe,""),ja=X.substring(wa.length,X.length);ea?this.Ya.text=X:this.Ya.insertTextAt(ja,wa.length,this.Ya.text.length)}X=F.g(this.$);X.pj&&(X=X.Wb,X.text=this.Ya.text,X.setCaretPosition(this.Ya.textBox.caretPosition));
ea?this.isListVisible=!1:this.Ya.textBox.selectRange(wa.length,this.Ya.text.length);return!0};a.prototype.Ubc=function(ea,wa){wa=void 0===wa?!1:wa;if(!this.wY.Gn)return-1;for(var X=this.wY.Gn.children[0],ja=X.children.length,va,ua=0;ua<ja;++ua)if(va=X.children[ua],I.a.equals(va.innerText.trim(),ea,wa))return ua;return-1};a.prototype.bAg=function(ea,wa,X,ja,va,ua,Xa){var aa=X.originalText.replace(a.Uqf,String.fromCharCode(32)),ba=new N.Range(ea.top-1,ea.left,ea.bottom-1,ea.right,!1,!1),oa=Xa?Xa.Vm(X.range):
null;(!X.ZE||X.range.left===ea.left)&&1<aa.length&&!ja.kb(aa.toUpperCase())&&I.a.aL(aa,wa)&&!I.a.equals(aa,wa,!0)&&!a.FSe(wa)&&this.S5f(aa)&&(!va&&!oa||!va&&oa.equals(Xa.Vm(ba))||va&&X.range.xd(ua)&&X.range.top!==ua.top)&&(ea=X.formulaBarText,I.a.equals(ea,X.text,!1)||!ea)&&(ea={},ea.FirstRow=X.range.top-1,ea.FirstColumn=X.range.left-1,X=new e(aa,ea),ja.add(aa.toUpperCase(),X))};a.prototype.Dzj=function(ea){this.Xp=this.MXh();this.fNa&&this.fNa.cancel();0<this.Ya.text.length&&0!==ea?this.items&&((1<
this.items.length||this.isListVisible)&&this.Ghh(),8!==ea&&127!==ea&&46!==ea&&(1===this.items.length?this.Tjd(!1):this.wY.Ok&&this.Hy(!1))):this.isListVisible=!1};a.prototype.Ghh=function(){this.isListVisible?this.CIe():this.j$d=Q.AsyncMethodContext.Ms(this.CIe,500,P.a.YUg,this.fNa)};a.prototype.Tjd=function(ea){l.ULS.shipAssertTag(537167966,0,!this.zwa()&&1===this.items.length,"Invalid Items");var wa=this.items[0].Xra,X=this.Ya.text,ja=wa.substring(X.length,wa.length);if(ea&&!ja.length)this.Ya.text=
wa;else if(!ea&&0<ja.length)this.Ya.appendText(ja),this.Ya.textBox.selectRange(X.length,this.Ya.text.length);else return;this.raiseEvent("ACLBMatchedItem",new m.a(this.items.length,0,wa));this.Mva=!0};a.prototype.MXh=function(){this.Xp=null;var ea=new ka.a(!1),wa=this.activeCell;this.JCa=this.Ya.text.replace(a.Uqf,String.fromCharCode(32));var X=this.tableManager.Vm(wa),ja=wa.xd(X);if(a.FSe(this.JCa)||!this.S5f(this.JCa))return this.items;var va=new N.Range(1,wa.left,wa.top-1,wa.left,!1,!1),ua=new N.Range(wa.top+
1,wa.left,v.a.sh,wa.left,!1,!1),Xa=F.g(this.$);ua=Xa.Xj("CellAutoCompleteControl.GetSuggestedCells",ua);try{var aa=Xa.Xj("CellAutoCompleteControl.GetSuggestedCells2",va);try{for(var ba=bk([aa,ua]),oa=ba.next();!oa.done;oa=ba.next())for(var ra=oa.value;ra.$$mn();){var db=ra.$$cu();this.bAg(wa,this.JCa,db,ea,ja,X,this.tableManager)}}finally{aa&&aa.dispose()}}finally{ua&&ua.dispose()}this.Xp=Array(ea.values.length);for(wa=0;wa<this.items.length;wa++)this.items[wa]=ea.values[wa];this.items.sort(function(Ka,
Ga){return Ka.Xra.localeCompare(Ga.Xra)});return this.items};a.prototype.hob=function(ea,wa){ea&&wa&&this.IZc.push(new d(ea,wa,this.icf?this:void 0))};a.prototype.bwj=function(){return this.Sei?this.w0a&&!this.zwa()&&this.isListVisible?this.get_visible():!1:this.w0a&&!this.zwa()&&this.get_visible()&&this.isListVisible};a.FSe=function(ea){ea=0<ea.length?ea.charCodeAt(0):-1;return 35===ea||61===ea||43===ea||45===ea||64===ea};Mf.Object.defineProperties(a.prototype,{Ft:{configurable:!0,enumerable:!0,
get:function(){return this.wY}},w0a:{configurable:!0,enumerable:!0,get:function(){return this.JCa}},fe:{configurable:!0,enumerable:!0,get:function(){return this.wY.fe}},items:{configurable:!0,enumerable:!0,get:function(){return this.Xp}},fNa:{configurable:!0,enumerable:!0,get:function(){return this.j$d}},activeCell:{configurable:!0,enumerable:!0,get:function(){return F.g(this.$).ha.sa.activeCell}},dataValidationControl:{configurable:!0,enumerable:!0,get:function(){return this.z3d||(this.z3d=this.$.da.za(14))}}});
Mf.Object.defineProperties(a,{Uqf:{configurable:!0,enumerable:!0,get:function(){return a.Rae||(a.Rae=new RegExp(String.fromCharCode(160),"g"))}}});a.Rae=null;Object(u.a)(a,"CellAutoCompleteControl",f.a,[521,522,523,3])},1429:function(u,E,b){function a(){A.a.Fa(e.ka);A.a.Fa(c.ka)}function c(z){var x=B.call(this)||this;x.$=z;x.Eb();return x}function d(z,x){var D=this;this.oZa=null;this.Yzf=function(I,F){1<F.length&&(I=w.a.instance.ga(856),D.ariaLiveNotifier.eLf(I,F.length))};this.Zzf=function(I,F){m.ULS.shipAssertTag(537167961,
0,0<=F.selectedIndex&&0<=F.length&&F.selectedIndex<F.length,"Invalid ListEventArgs: SelectedIndex/Length");m.ULS.shipAssertTag(537167960,0,!!F.JF,"ListEventArgs: SelectedValue should not be null");D.ariaLiveNotifier.Z4i(F.JF,F.selectedIndex+1,F.length)};this.$zf=function(I,F){D.ariaLiveNotifier.vPa(F.JF)};this.ariaLiveNotifier=z;v.EwaSettings.xl()||x.Ga(213,this)}function e(z){var x=y.call(this)||this;x.$=z;x.Eb();return x}u=b(0);var k=b(232),l=b(1419),n=b(51),f=b(37),v=b(1),r=b(911),y=k.a;Rk(e,y);
e.prototype.create=function(){var z=this,x=this.$.da,D=n.GetServiceTaskFactory.create(x,134,this.la,this.hb),I=n.GetServiceTaskFactory.Ra(x,213,214,this.hb);f.TaskExtensions.Aa(f.TaskExtensions.Vd([D,I],this.la),function(){if(v.EwaSettings.xl())z.pb(Object(r.c)(z.$.da,1,function(){var G=new l.CellAutoCompleteControl(z.$,D.result);I.result.ka(G);return G}));else{var F=x.za(1);F||(F=new l.CellAutoCompleteControl(z.$,D.result),I.result.ka(F));z.pb(F)}},this.la,3)};e.ka=function(z){z.da.Ga(151,new e(z))};
Object(u.a)(e,"CellAutoCompleteControlFactory",k.a,[]);var m=b(14),w=b(15);d.prototype.dispose=function(){this.SWd();this.oZa=null};d.prototype.ka=function(z){z&&(this.oZa=z,z.mZb(this.Yzf),z.r2(this.Zzf),z.SEg(this.$zf))};d.prototype.SWd=function(){this.oZa&&(this.oZa.ksc(this.Yzf),this.oZa.gda(this.Zzf),this.oZa.Oaj(this.$zf))};Object(u.a)(d,"CellAutoCompleteReadoutHandler",null,[524,3]);var B=k.a;Rk(c,B);c.prototype.create=function(){var z=this,x=this.$.da;f.TaskExtensions.Aa(n.GetServiceTaskFactory.Ra(x,
211,212,this.hb),function(D){if(v.EwaSettings.xl())z.pb(Object(r.c)(x,213,function(){return new d(D.result,x)}));else{var I=x.za(213)||new d(D.result,x);z.pb(I)}},this.la,3)};c.ka=function(z){z.da.Ga(214,new c(z))};Object(u.a)(c,"CellAutoCompleteReadoutHandlerFactory",k.a,[]);var A=b(10);b.d(E,"a",function(){return a})},1430:function(u,E,b){function a(){k.a.Fa(function(ka){ka.ma(136)&&c.ka(ka)})}function c(ka){var R=P.call(this)||this;R.$=ka;R.Eb();return R}function d(ka,R,fa,ca,ea){var wa=Q.call(this)||
this;wa.zO=null;wa.g0=null;wa.lFa=null;wa.suc=null;wa.cNc=null;wa.eXa=null;wa.ede=0;wa.WDc=!1;wa.Hfc=!1;wa.SBb=!1;wa.ug=function(){wa.ewa&&(wa.gridView?1===wa.gridView.ha.Pe?(wa.gridView.ha.sa.activeCell.equals(wa.lFa)||wa.WM||wa.Jx(),wa.cob.Hq()):wa.Jx():y.ULS.shipAssertTag(537154141,0,!1,"GridView is null during selection"))};wa.Dh=function(){wa.Jx()};wa.Yc=function(){wa.VW()};wa.Fc=function(){wa.Jx()};wa.$c=function(){wa.showCallout()};wa.iya=function(){if(wa.Ig.Gk&&wa.Ig.Gk.length)if(wa.kYc)wa.Ig.Ksi||
(wa.WDc=wa.Ig.Gk[0].BlockingDataForExpand),wa.Ig.xNh&&y.ULS.sendTraceTag(537154140,0,50,"User clicked pullout launch button before fieldInfo web service returned"),wa.ede=wa.Ig.X3c&&wa.Ig.iUe<wa.Ig.X3c.left-1?wa.Ig.X3c.left-1-wa.Ig.iUe:-1,wa.showCallout();else if(wa.gridView.ha.sa.sg){var X=wa.gridView.ha.sa.activeCell;if(X&&wa.g0){var ja=wa.tableManager.Vm(X);wa.QKc=!!ja;var va=wa.gridView.ha.sa.Vc;ja=wa.WM&&wa.g0.xd(ja);var ua=wa.Ngd&&!wa.WM&&va.equals(wa.selectedRange);ja||ua?(y.ULS.sendTraceTag(39662912,
0,50,"Field TableWidget shown on grid"),wa.f9b=!0,r.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RichPivotAll",!1)&&!wa.WM&&wa.tableManager.hva(X)?y.ULS.shipAssertTag(537154139,0,!1,"PulloutManager:OnFieldInfoListContextLoaded fetch rich fields for a cell on PivotTable range"):(r.EwaSettings.isChangeGateEnabled("OfficeVSO:5459087_FixLinkedEntityConvertPulloutButtonVisibilityBounds")?wa.WM?wa.Jh.xAa(wa.g0,wa.WM):wa.Jh.xAa(va,wa.WM):wa.Jh.xAa(wa.g0,wa.WM),wa.dtc())):y.ULS.shipAssertTag(537154138,
0,!1,"PulloutManager:OnFieldInfoListContextLoaded FAILURE")}}};wa.Oi=function(){wa.j6a()&&wa.Jh.hide();1===wa.gridView.ha.Pe&&wa.VW()};wa.iR=function(){var X=wa.gridView.ha.Pe;wa.gridView.ha.sa.activeCell&&1===X&&wa.VW()};wa.Xs=function(){if(r.EwaSettings.isChangeGateEnabled("OfficeVSO:5459087_FixLinkedEntityConvertPulloutButtonVisibilityBounds"))if(wa.WM){if(wa.g0&&wa.lFa){var X=wa.tableManager.Vm(wa.lFa);X&&1<X.bottom-X.top&&(--X.bottom,wa.gridView.e5(X)&&wa.cob.Hq())}}else wa.gridView.ha.sa.sg&&
wa.gridView.e5(wa.gridView.ha.sa.Vc)&&wa.cob.Hq();else wa.g0&&wa.lFa&&wa.WM&&(X=wa.tableManager.Vm(wa.lFa))&&1<X.bottom-X.top&&(--X.bottom,wa.gridView.e5(X)&&wa.cob.Hq())};wa.VW=function(){if(wa.$&&wa.gridView){if(wa.f9b&&wa.WM){var X=wa.gridView.ha.sa.activeCell;wa.g0=wa.nSe();var ja=!!wa.suc&&wa.suc.contains(X);if(wa.g0&&(X.equals(wa.lFa)||ja)){wa.Jh.xAa(wa.g0,wa.WM);return}}wa.f9b=!1;wa.g0=wa.nSe();wa.g0&&wa.tla&&wa.gridView&&wa.gridView.Ea.Jr(wa.tla)?(wa.kYc=!1,wa.lZ()):(wa.Ig.fZc(),wa.Ig.r1b());
wa.f9b||wa.Jh.hide()}};wa.$=ka;wa.tableManager=fa;wa.contextMenuManager=ca;wa.Jh=new e(ka,wa.$c,R,ea);wa.Ig=R.E2c(ka,fa);wa.kYc=!1;wa.f9b=!1;wa.Ngd=r.EwaSettings.ma(136);wa.QKc=!0;wa.aKc=!1;wa.gridView=U.g(wa.$);wa.gridView.Wb.Ak(wa.Dh);wa.gridView.yu(wa.iR);wa.$.Tk(wa.Yc);wa.$.Bk(wa.Fc);wa.$.sA(wa.Oi);wa.gridView.view.Es(wa.Xs);wa.gridView.ha.lP(wa.ug);wa.cob=F.a.instance.create(wa.VW,250,G.a.v1i);y.ULS.sendTraceTag(537154143,0,50,"Feature TableWidget enabled");wa.Ig.eZb(wa.iya);M.a.Byb()&&(wa.Hfc=
!0);wa.VW();ka.da.Ga(261,wa);return wa}function e(ka,R,fa,ca){var ea=N.call(this)||this;ea.isMac=J.a.isMac;ea.$=ka;ea.ariaLiveNotifier=ca;ea.zp=fa.x4b(ka,null,R,H.a.wsh,K.a.Se(9),O.a.instance.ga(1716),"PulloutPointerDown");return ea}var k=b(10);u=b(0);var l=b(242),n=b(232),f=b(51),v=b(37),r=b(1),y=b(14),m=b(89),w=b(4),B=b(79),A=b(8),z=b(24),x=b(64),D=b(45),I=b(151),F=b(47),G=b(44),T=b(12),O=b(15),U=b(21),J=b(27),H=b(19),K=b(53),N=B.a;Rk(e,N);e.prototype.dispose=function(){this.zp.dispose();this.$=
null;N.prototype.dispose.call(this)};e.prototype.domElement=function(ka){return this.zp.domElement(ka)};e.prototype.getButton=function(ka){return this.zp.getButton(ka,!1)};e.prototype.oOb=function(ka,R){this.zp.oOb(ka,R,!1)};e.prototype.xAa=function(ka,R){var fa=U.g(this.$),ca=fa.eb.dj(ka);this.zp.oOb(R?O.a.instance.ga(1716):O.a.instance.ga(1717),ca);R=this.isMac?R?O.a.instance.ga(1720):O.a.instance.ga(1721):R?O.a.instance.ga(1718):O.a.instance.ga(1719);var ea=fa.fg(ka,ca);ka=fa.Cf(ca).fn;if(ea&&
0<=ea.x&&0<=ea.y){var wa=ea.bottomRight.x+this.dz;ea=ea.topLeft.y-this.dz-this.buttonWidth;if(ea<ka.topLeft.y+this.dz){if(fa.eb.RSa){this.hide();return}ea=ka.topLeft.y+this.dz}this.hp(wa,ea,fa.rtl,ca);this.ariaLiveNotifier.vPa(R)}else this.hide()};e.prototype.hp=function(ka,R,fa,ca){this.zp.hp(ka,R,fa,ca,!1)};e.prototype.hide=function(){this.zp.hide()};Mf.Object.defineProperties(e.prototype,{dz:{configurable:!0,enumerable:!0,get:function(){return this.zp.dz}},buttonWidth:{configurable:!0,enumerable:!0,
get:function(){return this.zp.buttonWidth}}});Object(u.a)(e,"PulloutLaunchButton",B.a,[]);var M=b(36),C=b(22),Q=B.a;Rk(d,Q);d.prototype.dispose=function(){this.gridView&&(this.gridView.ha.sW(this.ug),this.gridView.view.Fq(this.Xs),this.gridView.Wb&&this.gridView.Wb.vk(this.Dh));if(this.$){var ka=this.$;ka.rl(this.Yc);ka.Ol(this.Fc);ka.gD(this.Oi);U.g(ka).jy(this.iR)}this.Ig&&this.Ig.bsc(this.iya);m.a.Ia(this.Jh);this.Ig=this.$=this.gridView=this.cob=this.Jh=null;Q.prototype.dispose.call(this)};d.prototype.Jx=
function(){this.Jh.hide()};d.prototype.nda=function(){this.Jh?this.Jh.getButton(this.nea).obb():y.ULS.sendTraceTag(537154142,0,15,"PulloutManager.ResetButtonAppearance: launchButton is null.")};d.prototype.zfj=function(){this.g0=null};d.prototype.oIf=function(){this.Jh&&this.Jh.hide()};d.prototype.PZh=function(){if(!this.Ngd||1!==this.selectedRange.width)return null;for(var ka=this.selectedRange.clone();this.gridView.e5(ka);){ka.left+=1;ka.right+=1;if(!this.gridView.Cf(this.gridView.eb.dj(ka)).Ug.ze(ka))break;
if(this.gridView.Ea.Jr(ka)){var R=this.gridView.Xj("PulloutManager.GetValidatedRangeToFill",ka,2);try{if(d.BUj(R))return ka}finally{R&&R.dispose()}}}return null};d.prototype.dtc=function(){this.Ig.qbb()};d.prototype.showCallout=function(){var ka=this;this.ewa&&(this.Ig.Q5a?(this.Jh.getButton(this.nea).XFb(),r.EwaSettings.xl()?v.TaskExtensions.Aa(f.GetServiceTaskFactory.Ra(this.$.da,8,9,0),function(R){ka.W1f(R.result)},this.$.la,3):this.W1f(this.contextMenuManager)):(this.kYc=!0,this.lZ()))};d.prototype.W1f=
function(ka){ka.wcd("tableFieldList").x0(null,this.Jh.domElement(this.nea),this.Ig,null,!0);this.dtc()};d.prototype.nSe=function(){if(!this.ewa||!this.gridView||this.gridView.ha.Oa.Yb||!this.gridView.ha.sa.sg)return null;var ka=this.gridView.ha.sa.activeCell,R=U.g(this.$).eb.dj(ka);if(!ka)return null;this.lFa=ka.clone();var fa=this.tableManager.Vm(ka);this.QKc=!!fa;if(this.WM){this.Jh.oOb(O.a.instance.ga(1716),R);this.zO=d.reg(fa);if(!this.zO)return null;R=this.tableManager.zBe(fa,this.gridView);
ka=R.pY;R=R.returnValue||ka;this.WDc=ka;if(R)return this.suc=new z.Range(fa.top,fa.left,fa.bottom,fa.right,!1,!1),this.cNc=new z.Range(this.zO.top,this.zO.right+1,this.zO.top,this.zO.right+1,!1,!1),this.zO}else if(this.Ngd){this.Jh.oOb(O.a.instance.ga(1717),R);this.eXa=this.gridView.ha.sa.Vc.clone();fa=U.g(this.$).Ab.Swa(this.selectedRange);(R=this.selectedRange.isSingle&&U.g(this.$).Ab.mbf(this.selectedRange))&&!this.SBb&&r.EwaSettings.isChangeGateEnabled("OfficeVSO:6253558_DatePulloutExperimentTrigger")&&
C.a.equals(w.AFrameworkApplication.uiCulture,"en-us",!0)&&(w.AFrameworkApplication.l_("XLS-DateSuggestion-Treatment;XLS-DateSuggestion-Control"),this.SBb=!0);this.zO=d.reg(this.selectedRange);if(!(this.Hfc&&R||fa)||!this.zO||!this.selectedRange)return null;this.Hfc&&(this.aKc=R&&!fa);if(r.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RichPivotAll",!1)&&this.tableManager.hva(this.selectedRange))return null;this.cNc=this.PZh();if((r.EwaSettings.isChangeGateEnabled("OfficeVSO:5459087_FixLinkedEntityConvertPulloutButtonVisibilityBounds")?
this.gridView.e5(this.selectedRange):this.gridView.e5(this.zO))&&this.tla)return this.suc=this.zO,fa=String.format("PulloutManager:FindSelection, NextRange, {0}, RightColumnHeader, {1}, ActiveCell, {2}",this.tla?this.tla.toString():"null",this.zO?this.zO.toString():"null",ka?ka.toString():"null"),y.ULS.sendTraceTag(537154137,0,50,fa),this.zO}return null};d.prototype.lZ=function(){this.WM?this.Ig.lZ(D.v(this.tla,this.$),!1,!0):this.Hfc&&this.aKc?this.Ig.uYi():r.EwaSettings.ma(136)&&this.Ig.lZ(D.v(this.selectedRange,
this.$),!0,!1)};d.prototype.j6a=function(){return this.$.ea.isNamedObjectViewMode&&x.f(this.$.pa)};d.BUj=function(ka){for(;ka.$$mn();)if(ka.$$cu().text||ka.$$cu().ZE||ka.$$cu().Ni||ka.yn.O5e)return!1;return!0};d.reg=function(ka){return ka.right===A.a.Bh?null:new z.Range(ka.top,ka.right,ka.top,ka.right,!1,!1)};Mf.Object.defineProperties(d.prototype,{ic:{configurable:!0,enumerable:!0,get:function(){return this.Jh.domElement(1)}},tla:{configurable:!0,enumerable:!0,get:function(){return this.cNc}},selectedRange:{configurable:!0,
enumerable:!0,get:function(){return this.eXa}},WM:{configurable:!0,enumerable:!0,get:function(){return this.QKc}},smd:{configurable:!0,enumerable:!0,get:function(){return this.aKc}},UIf:{configurable:!0,enumerable:!0,get:function(){return this.ede}},oBb:{configurable:!0,enumerable:!0,get:function(){var ka=this.Jh.domElement(this.nea);return ka?T.DOMElementExtensions.isVisible(ka):!1}},ewa:{configurable:!0,enumerable:!0,get:function(){return this.$.isEditMode&&r.EwaSettings.ma(136)?!(new I.a(this.$.va)).fj:
!1}},uHg:{configurable:!0,enumerable:!0,get:function(){return this.WDc}},nea:{configurable:!0,enumerable:!0,get:function(){return this.tla?this.gridView.eb.dj(this.zO):1}}});Object(u.a)(d,"PulloutManager",B.a,[497,3]);var P=n.a;Rk(c,P);c.prototype.create=function(){var ka=this;k.a.Fa(function(R){var fa=f.GetServiceTaskFactory.Ra(R.da,12,477,ka.hb),ca=f.GetServiceTaskFactory.Ra(R.da,66,134,ka.hb),ea=f.GetServiceTaskFactory.Ra(R.da,211,212,ka.hb),wa=l.a.Ua(null),X=!r.EwaSettings.xl();X&&(wa=f.GetServiceTaskFactory.Ra(R.da,
8,9,ka.hb));v.TaskExtensions.Aa(v.TaskExtensions.Vd([fa,ca,wa,ea],R.la),function(){X?ka.pb(ka.$.da.za(261)||new d(ka.$,fa.result,ca.result,wa.result,ea.result)):ka.pb(ka.$.da.za(261)||new d(ka.$,fa.result,ca.result,null,ea.result))},R.la)})};c.ka=function(ka){ka.da.Ga(262,new c(ka))};Object(u.a)(c,"PulloutManagerFactory",n.a,[]);b.d(E,"a",function(){return a})},1440:function(u,E,b){function a(m,w,B){B=void 0===B?null:B;this.Flb=this.Nlb=null;this.b1=-1;this.Uj=m;this.dga=(void 0===w?null:w)||new k.a;
this.Iwg=B||new e;this.OEa=new k.a;m=0;w=bk(this.dga);for(B=w.next();!B.done;B=w.next()){B=B.value;this.yqd(this.b1)||(this.b1=m);var A=m++;this.OEa.add(new c(document.createElement("li"),B.title,this.J5g(A)))}}function c(m,w,B){this.Uj=m;this.vp=w;this.DFc=B;this.pfa=document.createElement("a");r.a.uvc(this.pfa,this.vp);Sys.UI.DomElement.addCssClass(this.pfa,d.KGj);Sys.UI.DomElement.addCssClass(this.Uj,d.JGj);this.Uj.appendChild(this.pfa);this.pfa.tabIndex=0;this.KAc();n.a.addHandler(this.Uj,"click",
this.DFc);n.a.addHandler(this.Uj,"keyup",Object(l.a)(this,this.J9a,"onTitleKeyUp"))}function d(){}function e(){}u=b(0);var k=b(202);e.prototype.oGj=function(m,w){m.set_visible(!1);w.set_visible(!0)};Object(u.a)(e,"DefaultTabSwitchBehaviour",null,[561]);d.bHj="TabsContainer";d.LGj="TabTitlesContainer";d.JGj="TabTitle";d.KGj="TabTitleText";d.YTd="TabTitleActive";Object(u.a)(d,"MultitabControlStyles",null,[]);var l=b(84),n=b(43),f=b(86),v=b(88),r=b(55);c.prototype.dispose=function(){n.a.removeHandler(this.Uj,
"keyup",Object(l.a)(this,this.J9a,"onTitleKeyUp"));n.a.removeHandler(this.Uj,"click",this.DFc);this.Uj=this.pfa=null};c.prototype.setActive=function(m){m?Sys.UI.DomElement.addCssClass(this.Uj,d.YTd):Sys.UI.DomElement.removeCssClass(this.Uj,d.YTd);this.pfa&&this.pfa.setAttribute(v.a.Sga,m)};c.prototype.J9a=function(m){m.keyCode!==f.a.Oh&&m.keyCode!==f.a.Doa||this.DFc(m)};c.prototype.KAc=function(){this.Uj.setAttribute(v.a.Hd,v.a.Gs);this.pfa.setAttribute(v.a.Bt,this.vp);this.pfa.setAttribute(v.a.Hd,
v.a.Vnb)};Mf.Object.defineProperties(c.prototype,{ic:{configurable:!0,enumerable:!0,get:function(){return this.Uj}},title:{configurable:!0,enumerable:!0,get:function(){return this.vp}},isActive:{configurable:!0,enumerable:!0,get:function(){return Sys.UI.DomElement.containsCssClass(this.Uj,d.YTd)},set:function(m){this.setActive(m)}}});Object(u.a)(c,"TabTitleControl",null,[3]);var y=b(39);b.d(E,"a",function(){return a});a.prototype.bQf=function(){this.Nlb=document.createElement("ul");this.Nlb.className=
d.LGj;this.Flb=document.createElement("div");this.Flb.className=d.bHj;for(var m=0;m<this.Myc;++m){var w=this.dga.na(m),B=this.OEa.na(m);w.set_visible(!1);B.isActive=!1;var A=document.createElement("div");w.render(A);this.Flb.appendChild(A);this.Nlb.appendChild(B.ic)}this.ic.appendChild(this.Nlb);this.ic.appendChild(this.Flb);this.yqd(this.b1)&&(this.OEa.na(this.b1).isActive=!0,this.dga.na(this.b1).set_visible(!0))};a.prototype.dispose=function(){for(var m=0;m<this.Myc;++m)this.dga.na(m).dispose(),
this.OEa.na(m).dispose();this.OEa=this.dga=this.Uj=this.Flb=this.Nlb=null};a.prototype.setFocus=function(){this.dga.na(this.b1).setFocus()};a.prototype.yqd=function(m){return 0<=m&&m<this.Myc};a.prototype.X6f=function(m){this.b1!==m&&this.yqd(m)&&(this.Iwg.oGj(this.dga.na(this.b1),this.dga.na(m)),this.OEa.na(this.b1).isActive=!1,this.OEa.na(m).isActive=!0,this.b1=m,this.setFocus())};a.prototype.J5g=function(m){var w=this;return function(){w.X6f(m)}};Mf.Object.defineProperties(a.prototype,{Myc:{configurable:!0,
enumerable:!0,get:function(){return this.dga.count}},activeTab:{configurable:!0,enumerable:!0,get:function(){return this.b1},set:function(m){this.X6f(m)}},ic:{configurable:!0,enumerable:!0,get:function(){return this.Uj}},visible:{configurable:!0,enumerable:!0,get:function(){return y.a.isVisible(this.Uj)},set:function(m){this.Uj.style.visibility=m?"visible":"hidden"}}});Object(u.a)(a,"MultitabControl",null,[554,3])},1449:function(u,E,b){function a(){e.a.Fa(function(y){c.ka(y)})}function c(y){var m=
r.call(this)||this;m.ckj="formulaAssistance";m.$=y;m.Eb();return m}function d(){this.isFeedbackAllowed=!1;this.zoomLevel=0}var e=b(10);u=b(0);var k=b(7),l=b(232),n=b(51),f=b(37);Object(u.a)(d,"FormulaAssistanceUIContext",null,[]);var v=b(256),r=l.a;Rk(c,r);c.prototype.create=function(){var y=this,m=this.$.da.za(448);if(m)this.pb(m);else{var w=n.GetServiceTaskFactory.Ra(this.$.da,283,284,this.hb);f.TaskExtensions.Aa(w,function(){f.TaskExtensions.Aa(v.c(w.result.tn.loadScript(y.ckj)),function(){m=y.$.da.za(448);
if(!m){var B=Object(k.a)(new d,{isFeedbackAllowed:y.$.isFeedbackEnabled});m=y.$.da.Ga(448,formulaAssistance.FormulaAssistanceUIFactoryGlobal.create(B));y.$.Vwe(function(){var A={};A.isFeedbackAllowed=y.$.isFeedbackEnabled;m.updateContext(A)})}y.pb(m)},y.$.la,3)},this.$.la,3)}};c.ka=function(y){y.da.Ga(449,new c(y))};Object(u.a)(c,"FormulaAssistanceUIControlFactory",l.a,[]);b.d(E,"a",function(){return a})},1450:function(u,E,b){function a(){e.a.Fa(c.ka)}function c(D){var I=x.call(this)||this;I.$=D;
I.Eb();return I}function d(D,I){var F=this;this.UMa=1;this.rga=[];this.active=!1;this.qw=function(){var G=F.gridView.egd();if(!(0>=G||G===F.UMa||F.gridView.gp)){for(var T=!1,O=[],U=[],J=F.rga.length-1;0<=J;J--){var H=F.rga[J];if(F.dgd(H)>G||H.bottom<G)O.push(H),Array.removeAt(F.rga,J),T=!0}for(J=F.tableManager.rangeList.length-1;0<=J;J--){H=F.tableManager.rangeList[J];var K=F.dgd(H);K<=G&&H.bottom>=G&&!(K<=F.UMa&&H.bottom>=F.UMa)&&H.Zaa&&(U.push(H),T=!0)}if(T)for(H=B.EwaSettings.isChangeGateEnabled("OfficeVSO:6336710_ApplyHeaderSnappingOnVerticalFreezePane")?
F.gridView.Noc:[F.gridView.U2],J=bk(H),H=J.next();!H.done;H=J.next())for(K=bk(H.value),H=K.next();!H.done;H=K.next()){var N=bk(H.value);for(H=N.next();!H.done;H=N.next()){for(var M=H.value,C=M.Fn,Q=A.a(M.r4),P=O.length-1;0<=P;P--)H=O[P],F.Dzc(H,!1,Q,C)&&Array.removeAt(O,P);for(P=U.length-1;0<=P;P--)H=U[P],F.Dzc(H,!0,Q,C)&&F.rga.push(H);T&&M.NNd(Q)}}else v.ULS.sendTraceTag(537157657,0,50,"HeaderSnappingFeature:OnVisibleAreaChanged: detected an opportunity for bailing out");F.UMa=G}};this.dxf=function(G,
T){T.isRow||T.TUc(F.GKa)};this.exf=function(G,T){T.isRow||(F.tableManager.rangeList.length||F.deactivate(),T.QId(F.GKa))};this.GKa=function(G,T){if(F.Ud())F.activate();else if(G=F.active,F.deactivate(),!G){v.ULS.sendTraceTag(537157652,0,50,"HeaderSnappingFeature:HeaderBlockOnUpdatedBlockHtml: detected an opportunity for bailing out");return}(T=T.St)&&F.l4f(T.Fn[0],T.Fn[T.Fn.length-1],T.r4,T.Fn)};this.Szf=function(G,T){!F.gridView.gp&&(F.Ud()?F.activate():(G=F.active,F.deactivate(),G||v.ULS.sendTraceTag(537157651,
0,50,"HeaderSnappingFeature:OnRangeListUpdated: detected an opportunity for bailing out")),T=T.St)&&(G=A.a(T.r4),F.l4f(T.Fn[0],T.Fn[T.Fn.length-1],G,T.Fn)&&T.NNd(G))};this.oe=function(){F.gridView.eb.p4?F.deactivate():F.activate()};this.tableManager=D;this.gridView=I;this.$=I.$;D.$me(this.Szf);I.BEg(this.dxf);I.CEg(this.exf);this.$.va.If(this.oe);this.$.vb.If(this.oe);this.xqe(function(G){G.TUc(F.GKa)});this.Ud()&&(this.activate(),this.qw(this,null));this.$.da.Ga(68,this)}var e=b(10);u=b(0);var k=
b(232),l=b(51),n=b(37),f=b(21),v=b(14),r=b(30),y=b(219),m=b(24),w=b(64),B=b(1),A=b(1290),z=b(11);d.prototype.dispose=function(){var D=this;this.deactivate();this.gridView&&(this.tableManager.HPf(this.Szf),this.gridView.Daj(this.dxf),this.gridView.Eaj(this.exf),this.$.va.vg(this.oe),this.$.vb.vg(this.oe),this.xqe(function(I){I.QId(D.GKa)}));this.gridView=this.tableManager=this.rga=null};d.prototype.Dzc=function(D,I,F,G){if(!w.b(this.$.pa)||this.$.ea.isNamedObjectViewMode||this.gridView.eb.RSa)return!0;
if(!F.length)return!1;var T=G.length;if(G[T-1]<D.left)return!1;var O=z.HelperMethods.jx(new y.a(G),0,T,D.left,z.HelperMethods.NC);if(0>O)return!1;var U=D.N8f,J=!!D.RZa&&0<D.RZa.length,H=!!D.menuModel&&0<D.menuModel.length,K=O,N=0;for(T=Math.min(U.length+O,T);K<T;K++,N++)if(O=F[K],!B.EwaSettings.isChangeGateEnabled("OfficeVSO:5317457_ToggleHeaderSnapping_JSCrash_Fix")||O){var M=null,C=O.getElementsByClassName(r.a.b9c);C&&(M=C[0]);if(M&&M.innerText){if(C=O.getElementsByClassName(r.a.eoe))for(var Q=
C.length-1;0<=Q;Q--)O.removeChild(C[Q]);C=G[K];I?(M.innerText=U[N],O.classList.add(r.a.tPe),J&&D.RZa[N]&&(M=document.createElement("div"),M.innerHTML=D.RZa[N],H&&D.menuModel[N]&&this.kBg(D,N,C),O.appendChild(M.firstChild))):(O.classList.remove(r.a.tPe),M.textContent=m.Range.GP(C),this.Hhh(C))}}D.Kna=I;return!0};d.prototype.kBg=function(D,I,F){this.$.da.Za(8,function(G){G.n9b.gMi(D,I,F)})};d.prototype.Hhh=function(D){this.$.da.Za(8,function(I){I.n9b.hMi(D)})};d.prototype.l4f=function(D,I,F,G){for(var T=
!1,O=this.pZh(D,I),U=this.rga.length-1;0<=U;U--){var J=this.rga[U];I>=J.left&&D<=J.right&&(this.Dzc(J,!1,F,G),Array.removeAt(this.rga,U),T=!0)}D=0;for(I=O.length;D<I;D++)this.Dzc(O[D],!0,F,G)&&(this.rga.push(O[D]),T=!0);return T};d.prototype.activate=function(){this.Ud()&&!this.active&&(this.gridView.view.Es(this.qw),this.active=!0)};d.prototype.deactivate=function(){this.active&&(this.gridView.view.Fq(this.qw),this.active=!1)};d.prototype.Ud=function(){return w.b(this.$.pa)&&!this.$.ea.isNamedObjectViewMode&&
0>=this.gridView.eb.lL&&0<this.tableManager.rangeList.length};d.prototype.xqe=function(D){var I=B.EwaSettings.isChangeGateEnabled("OfficeVSO:6336710_ApplyHeaderSnappingOnVerticalFreezePane")?this.gridView.Noc:[this.gridView.U2];I=bk(I);for(var F=I.next();!F.done;F=I.next()){F=bk(F.value);for(var G=F.next();!G.done;G=F.next()){G=bk(G.value);for(var T=G.next();!T.done;T=G.next())D(T.value)}}};d.prototype.pZh=function(D,I){var F=[];if(!this.active)return F;this.UMa=this.gridView.egd();for(var G=this.tableManager.rangeList.length-
1;0<=G;G--){var T=this.tableManager.rangeList[G];T.bottom>=this.UMa&&this.dgd(T)<=this.UMa&&T.left>=D&&T.right<=I&&T.Zaa&&F.push(T)}return F};d.prototype.dgd=function(D){var I=this.gridView.Ab.dk(D);return I&&this.tableManager.Dcf(D,I.usedRange.topLeft)?D.top+1:D.top};Object(u.a)(d,"HeaderSnappingFeature",null,[3]);var x=k.a;Rk(c,x);c.prototype.create=function(){var D=this,I=l.GetServiceTaskFactory.create(this.$.da,134,this.la,this.hb);n.TaskExtensions.Aa(n.TaskExtensions.Vd([I],this.la),function(){D.pb(D.$.da.za(68)||
new d(I.result,f.g(D.$)))},this.la,11)};c.ka=function(D){D.da.Ga(67,new c(D))};Object(u.a)(c,"HeaderSnappingFactory",k.a,[]);b.d(E,"a",function(){return a})},1479:function(u,E,b){function a(){l.a.Fa(function(I){c.ka(I)})}function c(I){var F=D.call(this)||this;F.z4b=null;F.$=I;F.Eb();return F}function d(I){this.a=I;this.preventDefault=d.fEf.preventDefault;this.stopPropagation=d.fEf.stopPropagation;var F=this.type=I.type.toLowerCase();this.rawEvent=I;this.altKey=I.altKey;"undefined"!==typeof I.button&&
(this.button="undefined"!==typeof I.which?I.button:4===I.button?Sys.UI.MouseButton.middleButton:2===I.button?Sys.UI.MouseButton.rightButton:Sys.UI.MouseButton.leftButton);"keypress"===F?this.charCode=I.charCode||I.keyCode:this.keyCode=I.keyCode&&46===I.keyCode?127:I.keyCode;this.clientX=I.clientX;this.clientY=I.clientY;this.ctrlKey=I.ctrlKey;this.target=I.target?I.target:I.srcElement;this.screenX=I.screenX;this.screenY=I.screenY;this.shiftKey=I.shiftKey}function e(){this._list={}}function k(){this._list=
{}}var l=b(10);u=b(0);var n=b(14),f=b(1084),v=b(27),r=b(214),y=b(232),m=b(223),w=b(1),B=b(50),A=b(58),z=b(256),x=b(36);k.prototype.addHandler=function(I,F){var G;this._list[I]=[].concat(ck(null!==(G=this._list[I])&&void 0!==G?G:[]),[F])};k.prototype.removeHandler=function(I,F){var G=this._list[I];void 0!==G&&(F=G.indexOf(F),0<=F&&(this._list[I]=[].concat(ck(G.slice(0,F)),ck(G.slice(F+1)))))};k.prototype.getHandler=function(I){var F=this._list[I];return F&&0!==F.length?function(G,T){for(var O=bk(F),
U=O.next();!U.done;U=O.next())U=U.value,U(G,T)}:null};k.tIb=function(){Sys.EventHandlerList.prototype.addHandler=k.prototype.addHandler;Sys.EventHandlerList.prototype.getHandler=k.prototype.getHandler;Sys.EventHandlerList.prototype.removeHandler=k.prototype.removeHandler};Object(u.a)(k,"EventHandlerListOptimized",null,[]);e.prototype.addHandler=function(I,F){this.invalidate(I);void 0===this._list[I]?this._list[I]=[F]:this._list[I].push(F)};e.prototype.invalidate=function(I){void 0!==this.$z&&this.$z.delete(I)};
e.prototype.removeHandler=function(I,F){var G=this._list[I];void 0!==G&&0!==G.length&&(F=G.indexOf(F),0<=F&&(this.invalidate(I),G.splice(F,1)))};e.prototype.getHandler=function(I){void 0===this.$z&&(this.$z=new Map);var F=this.$z.get(I);return void 0===F?(F=this.makeHandler(I),this.$z.set(I,F),F):F};e.prototype.makeHandler=function(I){I=this._list[I];if(!I||0===I.length)return null;var F=[].concat(ck(I));return function(G,T){for(var O=0;O<F.length;++O)F[O](G,T)}};e.tIb=function(){Sys.EventHandlerList.prototype.addHandler=
e.prototype.addHandler;Sys.EventHandlerList.prototype.getHandler=e.prototype.getHandler;Sys.EventHandlerList.prototype.removeHandler=e.prototype.removeHandler;Sys.EventHandlerList.prototype.makeHandler=e.prototype.makeHandler;Sys.EventHandlerList.prototype.invalidate=e.prototype.invalidate};Object(u.a)(e,"EventHandlerListMemoized",null,[]);d.tIb=function(){Sys.UI.DomEvent=d;d.registerClass("Sys.UI.DomEvent",void 0,void 0)};Mf.Object.defineProperties(d.prototype,{offsetX:{configurable:!0,enumerable:!0,
get:function(){if(!this.type.startsWith("key")){if(void 0!==this.rawEvent.offsetX)return this.rawEvent.offsetX;if(this.target&&3!==this.target.nodeType&&"number"===typeof this.clientX){var I=Sys.UI.DomElement.getLocation(this.target);return(Sys.UI.DomElement._getWindow(this.target).pageXOffset||0)+this.clientX-I.x}}}},offsetY:{configurable:!0,enumerable:!0,get:function(){if(!this.type.startsWith("key")){if(void 0!==this.rawEvent.offsetY)return this.rawEvent.offsetY;if(this.target&&3!==this.target.nodeType&&
"number"===typeof this.clientY){var I=Sys.UI.DomElement.getLocation(this.target);return(Sys.UI.DomElement._getWindow(this.target).pageYOffset||0)+this.clientY-I.y}}}}});d.addHandler=Sys.UI.DomEvent.addHandler;d.addHandlers=Sys.UI.DomEvent.addHandlers;d.removeHandler=Sys.UI.DomEvent.removeHandler;d.clearHandlers=Sys.UI.DomEvent.clearHandlers;d._removeHandler=Sys.UI.DomEvent._removeHandler;d._clearHandlers=Sys.UI.DomEvent._clearHandlers;d._disposeHandlers=Sys.UI.DomEvent._disposeHandlers;d.fEf=Sys.UI.DomEvent.prototype;
d.registerClass=function(I,F,G){this.prototype.constructor=this;this.__typeName=I;this.__class=!0;F&&(this.__baseType=F,this.__basePrototypePending=!0);Sys.__upperCaseTypes[I.toUpperCase()]=this;if(G){this.__interfaces=[];for(var T=2,O=arguments.length;T<O;T++)this.__interfaces.push(arguments[T])}return this};Object(u.a)(d,"DomEventLazy",null,[481]);var D=y.a;Rk(c,D);c.prototype.create=function(){var I=this;n.ULS.sendTraceTag(537154643,0,50,"PluginSchedulerFactory.Create: Loading scheduler slice");
f.a.then(this.l8g(),function(F){I.pb(F)})};c.prototype.l8g=function(){var I=this;if(this.z4b)return this.z4b;var F=m.a.AHa(B.b(),r.a.none,"LoadResource","x10Scheduler loading");if(w.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseNativeStartsWithEndsWith",!1)){var G=String.prototype;if(void 0===G.startsWithOriginal||void 0===G.endsWithOriginal)if(w.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RetrieveOriginalStringUsingIFrameHack",!1)){var T=document.createElement("frame");
document.body.appendChild(T);var O=T.contentWindow.String.prototype;document.body.removeChild(T);G.startsWithOriginal=O.startsWith;G.endsWithOriginal=O.endsWith}else G.startsWithOriginal=function(U,J){J=void 0===J?0:J;return this.lastIndexOf(U,J)===J},G.endsWithOriginal=function(U){return-1!==this.indexOf(U,this.length-U.length)};G.startsWith=G.startsWithOriginal;G.endsWith=G.endsWithOriginal}w.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseImmutableHandlers",!1)&&k.tIb();w.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseMemoizedHandlers",
!1)&&e.tIb();w.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseLazyDomEvent",!1)&&d.tIb();if(w.EwaSettings.isChangeGateEnabled("OfficeVSO:5789323_disableSchedulerForIE")&&v.a.Uu)return G=excelOnlineCalc.PluginSchedulerSingletonGlobal.instance(),this.$.da.Ga(413,G),F.setResult(G),this.z4b=F.task;this.$.da.Za(266,function(U){w.EwaSettings.isChangeGateEnabled("OfficeVSO:6600721_doGracefullyFallIfTryToLoadSchedulerWithoutCalc")&&!U.Wld?(n.ULS.sendTraceTag(520901762,0,15,"PluginSchedulerFactory.createPluginSchedulerAsync: Calc is not initialized, pluginScheduler creation canceled"),
F.jt()):I.$.da.Za(283,function(J){var H=excelOnlineCalc.PluginSchedulerSingletonGlobal.instance();J=z.b(A.Task.Ua(J.tn));(w.EwaSettings.isChangeGateEnabled("OfficeVSO:6409372_isGroupwisePluginOperationsUsed")?Promise.all([excelOnlineCalc.x10.ensureGroupAttached(J,0),x.a.SLg(I.$)?excelOnlineCalc.x10.ensureGroupAttached(J,2):Promise.resolve(0)]).then(function(K){return K.some(function(N){return 0<N})}):excelOnlineCalc.x10.ensureAllPluginsAttached(J)).then(function(K){I.$.da.Ga(413,H);F.setResult(H);
w.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.MockSetActiveCell",0)&&I.$.da.Za(491,function(N){N.Cda.anyPluginInitialized=K})})})});return this.z4b=F.task};c.ka=function(I){I.da.Ga(414,new c(I))};Object(u.a)(c,"PluginSchedulerFactory",y.a,[]);b.d(E,"a",function(){return a})},1644:function(u,E,b){function a(nb){return uc.call(this,nb)||this}function c(nb){this.$=nb}function d(nb){var pc=kc.call(this)||this;pc.$=nb;pc.Eb();return pc}function e(nb,pc){var Dc=this;this.$=nb;this.fontServiceManager=
pc;this.menuId=this.mYc=this.dS=this.vua=null;this.tad=0;this.fAi="+mn-lt";this.lxi="+mj-lt";this.VJi=function(){Dc.ZXf()};this.lPi=function(oc){Dc.Cef=!0;Dc.ISg=null;Dc.$.bB(function(Gc){Gc.dPa("FontName_New")});O.ULS.sendTraceTag(520710160,1,15,String.format("PreviewFont Status is {0}",oc))};this.xei=!!String.fromCodePoint&&!ub.a.Yt&&!!window.gridRenderer&&gridRenderer.CanvasRendererGlobals.isFontLoadApiSupported();this.Cef=!1;this.ISg=null;this.Am=ca.EwaSettings.Am();this.gridView=X.g(this.$);
(this.$m=Ic.a.$m())&&this.fontServiceManager&&(this.fontServiceManager.lnd?this.ZXf():this.fontServiceManager.Rme(this.VJi))}function k(nb){return Kb.call(this,nb)||this}function l(nb,pc){var Dc=this;this.l$b=this.JEd=null;this.lwf=function(){ca.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UnfreezeViewportAdjustLocation",!1)||Dc.ftc();if(Dc.l$b){var oc=Ua.a(cb.a.Ta.Wd,Dc.l$b);O.ULS.sendTraceTag(570949840,5,50,"FreezePanesCommandHandler.OnFreezePanesUpdateCompleted: duration of FreezePane from operation until allBlockUpdated: {0}",
oc);Dc.l$b=null}Dc.XDf()};this.$=nb;this.gridView=X.g(nb);this.gF=pc.orb(this.$.domElement,500,null,null);this.vKa=this.uKa=-1}function n(nb){this.freezeOptions=null;this.freezeOptions=nb}function f(){}function v(nb){var pc=ec.call(this)||this;pc.pSb=null;pc.$=nb;pc.Eb();return pc}function r(nb){var pc=yb.call(this)||this;pc.EHf=0;pc.QG=null;pc.I9i=function(Dc){pc.W$i(Dc)};pc.oZg=function(Dc,oc){if(1===Dc&&pc.QG.FileCollectionErrorStateId){Dc=pc.$.oa.xa;var Gc=pc.QG.MessageId,ld=pc.QG.OriginalEcsServerId,
gd=pc.QG.FileCollectionErrorStateId,Cc=Dc.Na(0);Cc.errorMessageId=Gc;Cc.ecsServerId=ld;Cc.fileCollectionErrorStateId=gd;Cc.userComment=oc;Dc.PYc("CollectFile",Cc,null,null,null,null,0)}pc.raiseEvent("fileCollectionComplete",null,pc)};pc.$=nb;return pc}function y(nb){var pc=qb.call(this,!1,!1,y.mu)||this;pc.pud=!1;pc.tnf=!0;pc.Dmf=0;pc.Rb=1;pc.mc(1,CommonUIStrings.l_Send);pc.mc(0,CommonUIStrings.l_NoThanks);pc.Vf=m.HTML;pc.wmf=nb;pc.ye=y.kSg;return pc}function m(){}function w(nb){return na.call(this,
nb)||this}function B(nb,pc,Dc){var oc=qa.call(this)||this;oc.ZGi=function(Gc,ld){if(!xa.a(Gc)&&ld){var gd=!!Gc&&!!Gc.RequestTelemetryData;X.g(oc.$).si.dla(ld.toString(),Gc.StateId,gd?Gc.RequestTelemetryData.EcsOperationDuration:0,gd?Gc.RequestTelemetryData.EcsRequestDuration:0,gd?Gc.RequestTelemetryData.WfeRequestDuration:0)}};oc.$=nb;oc.tableManager=pc;oc.Fg=Dc;return oc}function A(nb){return aa.call(this,nb)||this}function z(nb){var pc=Xa.call(this)||this;pc.dtf=function(Dc){var oc=X.g(pc.$);if(Dc=
Dc.Result){var Gc=K.D(Dc.NewSelection),ld=K.D(Dc.NewActiveCell);if(Gc&&ld)if(!Dc.Committed&&Dc.AutoSumFormula){var gd=oc.Ub(ld);gd&&(oc.ha.updateSelection(Gc,ld,60),Gc=ld=K.D(Dc.MarkedArea),oc.BJ=2,D(oc.$b,gd,Dc.AutoSumFormula,!!Gc,Dc.FormulaMarkStart,Dc.FormulaMarkEnd),Gc&&ld&&oc.ha.updateSelection(Gc,ld,0),oc.$b.Ood=!1,P.TaskExtensions.Aa(Q.GetServiceTaskFactory.create(pc.$.da,153,pc.la,0),function(Cc){Cc.result.H1a(null)},pc.la,3))}else oc.ha.updateSelection(Gc,ld,60)}};pc.$=nb;return pc}function x(nb,
pc){this.sharedSheetRange=null;this.type=0;this.sharedSheetRange=nb;this.type=pc}function D(nb,pc,Dc,oc,Gc,ld){if(pc){var gd=nb.textBox;nb.isEditing||nb.startEdit(pc,!0);nb.Ood=!0;nb.text=Dc;gd.caretPosition=Gc;Gc<ld&&(oc&&nb.IAa(),gd.selectRange(0,ld+1),gd.selectRange(Gc,ld))}}function I(nb,pc,Dc,oc,Gc,ld,gd,Cc,kd,Fd){Fd=nb.Na(9,Fd);Fd.selectedRange=pc;Fd.activeCell=Dc;Fd.autoSumType=oc;Fd.topLeftCell=Gc;return J.g(nb,"AutoSum",Fd,ld,gd,Cc,kd,0)}b.r(E);var F=b(1281),G=b(0),T=b(905),O=b(14),U=b(207),
J=b(62),H=b(76);x.prototype.Z3a=function(){return this.sharedSheetRange};Object(G.a)(x,"MacroRecorderAutoSumPayload",null,[438]);var K=b(45),N=b(564),M=b(388),C=b(177),Q=b(51),P=b(37),ka=b(160),R=b(356),fa=b(31),ca=b(1),ea=b(186),wa=b(294),X=b(21),ja=b(126),va=b(627),ua=b(58),Xa=U.a;Rk(z,Xa);z.prototype.Lc=function(){return!1};z.prototype.executeCommand=function(nb,pc,Dc){nb=pc.command;switch(nb){case 1220954656:pc=this.LHe(0,pc);break;case -1537138325:pc=this.LHe(parseInt(Dc[H.a.Nc].toString(),10),
pc);break;default:pc=ea.a(nb)}return pc};z.prototype.zc=function(nb,pc){if(nb=1===nb)switch(pc.command){case 1220954656:case -1537138325:break;default:nb=!1}return nb};z.prototype.Qc=function(){return!1};z.prototype.LHe=function(nb,pc){function Dc(){return new x(gd,nb)}var oc=this,Gc=X.g(this.$);Gc.hg.GG(!1);if(!X.g(this.$).ha.sa.sg)return O.ULS.sendTraceTag(537170308,0,50,"AutoSumCommandHandler.DoAutoSum: Unhandled AutoSum of type {0} due to discontinuous selection. Number of selected ranges is {1}",
nb,X.g(this.$).ha.sa.qK),this.Sya(),ua.Task.Ua(!1);var ld=Gc.iH();if(!ld)return null;var gd=K.v(Gc.ha.sa.Vc,this.$),Cc=K.o(Gc.ha.sa.activeCell,this.$),kd=K.o(ld,this.$),Fd=this.$.oa.xa.Pb();return this.$.hq(Gc.ha.sa.selectedRanges,!0)?ca.EwaSettings.Zb()?M.a(this.$.userOperationManager,function(rb,Kd,Qd){return I(oc.$.oa.xa,gd,Cc,nb,kd,wa.b(rb,oc.dtf),Kd,Qd,nb,Fd)},function(rb){return new C.a(502,0,rb,64,Dc)},pc):M.a(this.$.userOperationManager,function(rb,Kd,Qd){return I(oc.$.oa.xa,gd,Cc,nb,kd,wa.b(rb,
oc.dtf),Kd,Qd,nb,Fd)},function(rb){return new N.a(502,0,rb,void 0,Dc)},pc):ua.Task.Ua(!1)};z.prototype.Sya=function(){va.a(ja.a.discontinuousSelectionBlocking,["OtherICE"],!0,!0,!1,!1,null);var nb=fa.a.Xc(1,1,754,2162,0,371863010,"DiscontinuousSelectionBlocking");ca.EwaSettings.kz()?new R.a(this.$,nb):(nb=new ka.ErrorDialog(this.$,nb),nb.initialize(),nb.gf())};Object(G.a)(z,"AutoSumCommandHandler",U.a,[429]);var aa=T.a;Rk(A,aa);A.prototype.Ad=function(){this.jd([new z(this.$)])};A.ka=function(nb){T.a.Qd(96,
new A(nb))};Object(G.a)(A,"AutoSumCommandHandlerFactory",T.a,[]);var ba=b(10),oa=b(178),ra=b(276),db=b(38),Ka=b(337),Ga=b(1282),xa=b(295),da=b(74),qa=db.a;Rk(B,qa);B.prototype.DDg=function(nb){this.addHandler("ekcvc",nb)};B.prototype.N$i=function(nb){this.removeHandler("ekcvc",nb)};B.prototype.Lc=function(){return!1};B.prototype.executeCommand=function(nb,pc){nb=pc.command;switch(nb){case -730106152:pc=this.Wgd(pc,3);break;case -1228228458:pc=this.Wgd(pc,4);break;case -848953656:case 2045211913:if(this.hki()){pc=
ua.Task.Ua(!0);break}pc=this.Wgd(pc,1);break;default:pc=ea.a(nb)}return pc};B.prototype.zc=function(nb,pc){if(nb=1===nb)switch(pc.command){case -730106152:case -1228228458:case -848953656:case 2045211913:break;default:nb=!1}return nb};B.prototype.Qc=function(){return!1};B.prototype.Wgd=function(nb,pc){function Dc(){return new Ga.a(pc,Fd)}function oc(Kd,Qd,ve){Gc.$.ly();return J.d(Gc.$.oa.xa,pc,Fd,!1,wa.b(Kd,Gc.ZGi),Qd,ve,kd,rb)}var Gc=this,ld=X.g(this.$),gd=ld.ha.sa.selectedRanges,Cc=nb.command,kd=
oa.a.create().toString();if(!this.$.hq(gd,!0)&&-730106152!==Cc)return ua.Task.Ua(!0);var Fd=K.r(gd,this.$);this.yzj(Cc,ld,gd,kd);ca.EwaSettings.isChangeGateEnabled("OfficeVSO:3371143_RegisterFormulaBarToClearContentEvent")&&this.B2i();var rb=this.$.oa.xa.Pb({n_:!0,GZ:1});return ca.EwaSettings.Zb()?M.a(this.$.userOperationManager,oc,function(Kd){return new C.a(508,0,Kd,67,Dc)},nb):M.a(this.$.userOperationManager,oc,function(Kd){return new N.a(508,0,Kd,3,Dc)},nb)};B.prototype.yzj=function(nb,pc,Dc,
oc){var Gc=this;if(-848953656!==nb&&2045211913!==nb&&-730106152!==nb&&-1228228458!==nb)O.ULS.sendTraceTag(537167938,0,10,"ClearCommandHandler.ShowInstantaneousClear: Unexpected command {0}.",nb);else if(!ra.a.any(Dc,function(gd){return 0<pc.getRangeInformation(gd).length})){var ld=ra.a.any(Dc,function(gd){return Gc.tableManager.cqd(gd)});if(-730106152!==nb&&-1228228458!==nb||!ld)this.uDj(pc,nb,oc,Dc),-730106152!==nb&&-1228228458!==nb||this.Fg.Kda(pc,-730106152,{}),-1228228458!==nb&&2045211913!==nb&&
-848953656!==nb||this.Fg.TXg(Dc,oc),pc.si.A0(oc,da.BasicTelemetryCalculator.HQ)}};B.prototype.uDj=function(nb,pc,Dc,oc){var Gc="";switch(pc){case -1228228458:Gc="ClearAll";break;case 2045211913:case -848953656:Gc="ClearContent";break;case -730106152:Gc="ClearFormat";break;default:O.ULS.sendTraceTag(537167937,0,15,"ClearCommandHandler.StampTimeWithCompatibleDescription: Unexpected command {0}.",pc)}pc=oc.length;oc=K.b(oc);nb.si.y7(15,Dc,Gc+(", ranges to clear: "+pc+", cells to clear: "+oc))};B.prototype.B2i=
function(){this.raiseEvent("ekcvc",new Ka.a)};B.prototype.hki=function(){if(X.g(this.$).gz){var nb=this.$.da.za(296);return!!nb&&nb.yU.fB}return!1};Object(G.a)(B,"ClearCommandHandler",db.a,[429,925]);var na=T.a;Rk(w,na);w.prototype.Ad=function(){var nb=this,pc=Q.GetServiceTaskFactory.create(this.$.da,134,this.la,this.hb),Dc=Q.GetServiceTaskFactory.create(this.$.da,18,this.la,this.hb);P.TaskExtensions.Aa(P.TaskExtensions.Vd([pc,Dc],this.la),function(){var oc=new B(nb.$,pc.result,Dc.result);nb.jd([oc]);
nb.$.da.Ga(313,oc)},this.la,3)};w.ka=function(nb){T.a.Qd(101,new w(nb))};Object(G.a)(w,"ClearCommandHandlerFactory",T.a,[]);var ia=b(1414),ta=b(1283),za=b(1336),sa=b(1285),V=b(1286),Ia=b(1349),Ha=b(89),ob=b(232),ib=b(4),La=b(107),zb=b(43),Fb=b(11),Yb=b(84),kb=b(150);m.HTML='<div id="WACDialogRow" class="WACDialogRow">\r\n\t\t\t\t\t<div id="WACDialogIconPanel" class="WACDialogIconPanel"></div>\r\n\t\t\t\t\t<div id="WACDialogTextPanel" class="WACDialogTextPanel" style="padding-right: 30px;">\r\n\t\t\t\t\t\t<div id="WACDialogErrorMessage"></div>\r\n\t\t\t\t\t\t<br>\r\n\t\t\t\t\t\t<div id="WACDialogErrorReportMessage"> </div>\r\n\t\t\t\t\t\t<br>\r\n\t\t\t\t\t\t<div id="WACDialogErrorTextPrompt" ></div> \r\n\t\t\t\t\t\t<textarea id="WACDialogInput" class="WACDialogInput" rows="5" style="margin-bottom: 10px; margin-top: 9px; overflow: auto;" maxlength="256"></textarea>\r\n\t\t\t\t\t\t<div id = "WACDialogSendFileCheckboxContainer" class="WACDialogRow" >\r\n\t\t\t\t\t\t<input type="checkbox" id="WACDialogSendFileCheckbox">\r\n\t\t\t\t\t\t<span id="WACDialogSendFileCheckboxText">text</span>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<a id="WACDialogPrivacyText"> </a> \r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>';
Object(G.a)(m,"FileUploadDialogHTML",null,[]);var vb=b(158),Wa=b(25),qb=kb.a;Rk(y,qb);y.prototype.hj=function(nb,pc,Dc,oc,Gc){Gc=void 0===Gc?!0:Gc;this.pud=void 0===oc?!1:oc;this.Lyj(pc);this.Dmf=nb;Gc&&ib.AFrameworkApplication.DF(nb)};y.prototype.Lyj=function(nb){if(y.mu)this.sAj(nb);else{var pc={};pc[y.gSg]=nb;pc[y.mSg]=CommonUIStrings.l_SendFileErrorReportMessage;pc[y.nSg]=CommonUIStrings.l_SendFileErrorReportTextCaption;pc[y.xYc]="";pc[y.jSg]=CommonUIStrings.l_UserReportLinkText;pc[y.X0b]=!0;
this.initializeAndShow(CommonUIStrings.l_DefaultDialogTitle,Object(Yb.a)(this,this.kri,"legacyDialogHandler"),pc);this.PW(y.sSg)}};y.prototype.sAj=function(nb){var pc={},Dc={},oc={},Gc={},ld={};nb=(ld.id=this.ye,ld.bodyControls=(Gc.reportErrorCheckboxProps=this.pud?(pc.label=CommonUIStrings.l_UserReportLinkText,pc):null,Gc.textAreaProps=this.tnf?{}:null,Gc.privacyStatementLinkProps=(oc.text=CommonUIStrings.l_PrivacyStatement,oc.handler=(Dc.href=ib.AFrameworkApplication.rma,Dc.target="_blank",Dc),
oc),Gc),ld.errorMessage=nb,ld.errorReportMessage=CommonUIStrings.l_SendFileErrorReportMessage,ld.errorTextPrompt=CommonUIStrings.l_SendFileErrorReportTextCaption,ld);this.initializeAndShow(CommonUIStrings.l_DefaultDialogTitle,Object(Yb.a)(this,this.EFd,"reactDialogHandler"),nb)};y.prototype.n9a=function(){if(!y.mu){var nb=document.getElementById(y.pSg);nb&&(nb.className=y.oSg,nb.appendChild(vb.createClusteredImage(32,32,y.lSg,null,!0,CommonUIStrings.l_DialogError)));if(nb=document.getElementById(y.qSg))nb.innerText=
CommonUIStrings.l_PrivacyStatement,nb.href=ib.AFrameworkApplication.rma,zb.a.addHandler(nb,"click",Object(Yb.a)(this,this.oPi,"onPrivacyClickHandler"));this.tnf||(nb=document.getElementById(y.xYc))&&nb.parentNode&&nb.parentNode.removeChild(nb);this.pud||(nb=document.getElementById(y.iSg))&&nb.parentNode&&nb.parentNode.removeChild(nb)}};y.prototype.fO=function(){y.mu||(qb.prototype.fO.call(this),document.getElementById(this.$h("WACDialogPanel")).style.width=String.format("{0}px",400))};y.prototype.kri=
function(nb,pc){var Dc=pc[y.xYc]||"",oc=!0;void 0!==pc[y.X0b]&&null!==pc[y.X0b]&&(oc=pc[y.X0b]);this.Uv(nb,Dc,oc)};y.prototype.EFd=function(nb,pc){this.Uv(nb,pc.text||"",pc.reportErrorChecked)};y.prototype.Uv=function(nb,pc,Dc){this.wmf&&(Dc&&O.ULS.sendTraceTag(5768786,306,50,"Error Report sent for errorCode:{0}",this.Dmf),this.wmf(nb,pc,Dc))};y.prototype.oPi=function(nb){ib.AFrameworkApplication.ub.$d(Wa.a.bza,2,nb)};Mf.Object.defineProperties(y.prototype,{canBePreempted:{configurable:!0,enumerable:!0,
get:function(){return!1}}});Mf.Object.defineProperties(y,{mu:{configurable:!0,enumerable:!0,get:function(){return ib.AFrameworkApplication.ta.Qa.Vu&&ib.AFrameworkApplication.ta.Qa.Gki}}});y.gSg="WACDialogErrorMessage";y.mSg="WACDialogErrorReportMessage";y.nSg="WACDialogErrorTextPrompt";y.xYc="WACDialogInput";y.qSg="WACDialogPrivacyText";y.pSg="WACDialogIconPanel";y.lSg="CancelRequest_32x32x32";y.oSg="WACDialogIcon";y.sSg="WACDialogTextPanel";y.X0b="WACDialogSendFileCheckbox";y.iSg="WACDialogSendFileCheckboxContainer";
y.jSg="WACDialogSendFileCheckboxText";y.kSg="FileUploadErrorDialog";Object(G.a)(y,"FileUploadErrorDialog",kb.a,[]);var yb=db.a;Rk(r,yb);r.prototype.ODg=function(nb){this.addHandler("fileCollectionComplete",nb)};r.prototype.W$i=function(nb){this.removeHandler("fileCollectionComplete",nb)};r.prototype.nZg=function(nb,pc,Dc){this.EHf=pc;this.QG=nb;this.ODg(Dc);ib.AFrameworkApplication.rma=this.$.workbookContext.FullDocumentInfo.PrivacyUrl;nb=new y(this.oZg);ib.AFrameworkApplication.ub.Mb(Wa.a.bza,La.a.frame,
r.o0i);nb.hj(0,"",null,!1,!1)};r.o0i=function(nb,pc,Dc,oc,Gc){zb.a.Gt(Gc);ib.AFrameworkApplication.rma&&Fb.HelperMethods.Ze(ib.AFrameworkApplication.rma,void 0,void 0,"FileCollectionOperation.PrivacyUrl");return 32};Object(G.a)(r,"FileCollectionOperation",db.a,[927,3]);var ec=ob.a;Rk(v,ec);v.prototype.create=function(){var nb=this;P.TaskExtensions.Aa(Q.GetServiceTaskFactory.create(this.$.da,155,this.la,this.hb),function(){nb.pb(nb.vyh)},this.la,3)};v.prototype.dispose=function(){Ha.a.Ia(this.pSb);
this.pSb=null;ec.prototype.dispose.call(this)};v.ka=function(nb){nb.da.Ga(125,new v(nb))};Mf.Object.defineProperties(v.prototype,{vyh:{configurable:!0,enumerable:!0,get:function(){return this.pSb||(this.pSb=new r(this.$))}}});Object(G.a)(v,"FileCollectionCommandHandlerFactory",ob.a,[]);var Ob=b(1356),Cb=b(1288),ab=b(1449),ya=b(7),ma=b(741);Object(G.a)(f,"FreezePanesCommandParameters",null,[]);var ha=b(8),Z=b(185),Na=b(24),eb=b(412),cb=b(28),Ua=b(283),pa=b(285),Qa=b(117);n.prototype.getSheetName=function(){return this.freezeOptions.SheetName};
Object(G.a)(n,"MacroRecorderSheetPaneFrozenPayload",null,[438]);var Db=b(42);l.prototype.Lc=function(nb,pc){var Dc=!1;switch(pc){case 1844679312:Dc=1!==nb&&!this.gridView.eb.p4}return Dc};l.prototype.executeCommand=function(nb,pc){nb=this.gridView.eb;var Dc=this.gridView.ugd();ib.AFrameworkApplication.ta.Qa.lz&&this.$.Bka&&(1844679312===pc.command||340334732===pc.command||-806625837===pc.command)&&ma.ShyRibbon.xP(1,2);switch(pc.command){case 1844679312:return this.setFreezePanes(pc,Dc,nb.Ji);case 340334732:return nb.H9b?
ua.Task.Ua(!1):this.Ppj(pc,Dc);case -806625837:return nb.RSa?ua.Task.Ua(!1):this.Qpj(pc,Dc)}return ua.Task.Ua(!1)};l.prototype.zc=function(nb,pc){nb=!1;switch(pc.command){case 1844679312:case 340334732:case -806625837:case 1745254833:nb=!0}return nb};l.prototype.Qc=function(){return!1};l.prototype.setFreezePanes=function(nb,pc,Dc){if(Dc)return this.Luc(nb,!1,0,0,0,0,pc,null);var oc=this.gridView.ha.sa;Dc=oc.activeCell.clone();oc=oc.activeRange;oc.Te&&(O.ULS.sendTraceTag(537159585,0,50,"FreezePanesCommandHandler.SetFreezePanes: activeRange is a column. updating firstUnfreezeCell.Top ({0}) and firstUnfreezeCell.Bottom ({1}) to equal topLeftRange.Top ({2})",
Dc.top,Dc.bottom,pc.top),Dc.top=Dc.bottom=pc.top);oc.isRow&&(O.ULS.sendTraceTag(537159584,0,50,"FreezePanesCommandHandler.SetFreezePanes: activeRange is a row. updating firstUnfreezeCell.Left ({0}) and firstUnfreezeCell.Right ({1}) to equal topLeftRange.Left ({2})",Dc.left,Dc.right,pc.left),Dc.left=Dc.right=pc.left);Dc.top===pc.top&&Dc.left===pc.left&&(Dc=Na.Range.Tc(Dc.top+1,Dc.left));oc=Dc.top-1;var Gc=Dc.left-1,ld=oc-(pc.top-1),gd=Gc-(pc.left-1);return this.NUj(Dc,ld,gd)?this.Luc(nb,!0,oc,Gc,ld,
gd,pc,Dc):(this.$.hf(),this.XDf(),ua.Task.Ua(!0))};l.prototype.Ppj=function(nb,pc){return this.Luc(nb,!0,0,pc.left,0,1,pc,null)};l.prototype.Qpj=function(nb,pc){return this.Luc(nb,!0,pc.top,0,1,0,pc,null)};l.prototype.NUj=function(nb,pc,Dc){var oc=this.gridView.fg(nb),Gc=this.gridView.view.visibleArea;return!oc||Gc.topLeft.y>oc.bottomRight.y||Gc.topLeft.x>oc.bottomRight.x||Gc.bottomRight.y<oc.bottomRight.y||Gc.bottomRight.x<oc.bottomRight.x?(O.ULS.sendTraceTag(537159583,0,50,"FreezePanesCommandHandler.ValidateFreezePanesRange: User tried to create freeze pane when active cell not in view, range={0}, rangeViewportArea={1}, visibleArea={2}",
nb,oc?oc.toString():"null",Gc.toString()),nb=fa.a.Xc(1,0,26,1471,0,2105967339,"FreezePaneSelectionNotInViewErr"),ca.EwaSettings.kz()?new R.a(this.$,nb):(nb=new ka.ErrorDialog(this.$,nb),nb.initialize(),nb.gf()),!1):0>=pc&&0>=Dc?(O.ULS.sendTraceTag(537159582,0,50,"FreezePanesCommandHandler.ValidateFreezePanesRange: User tried to create empty freeze pane"),nb=X.g(this.$).rtl?1473:1472,pc=X.g(this.$).rtl?-2131054257:-1953454131,nb=fa.a.Xc(1,0,26,nb,0,pc,"FreezePaneA1SelectedErr"),ca.EwaSettings.kz()?
new R.a(this.$,nb):(nb=new ka.ErrorDialog(this.$,nb),nb.initialize(),nb.gf()),!1):!0};l.prototype.Luc=function(nb,pc,Dc,oc,Gc,ld,gd,Cc){function kd(){return new n(rb)}var Fd=this;this.JEd=Db.a(this.$).C9(5,"SendFreezePanesRequest","SendFreezePanesRequest");this.gridView.iP(this.lwf);this.gF.fSa();this.gridView.YDj(pc?"":"UnsetFreezePane");this.gsj(nb,pc,this.gridView.eb);var rb=Object(ya.a)(new f,{SheetName:this.$.pa.name,Freeze:pc,FrozenRows:Gc,FrozenColumns:ld,FirstRow:Dc,FirstColumn:oc});O.ULS.sendTraceTag(573101852,
0,50,"FreezePanesCommandHandler.SendFreezePanesRequest: Freeze={0}, FrozenRows={1}, FrozenColumns={2}, FirstRow={3}, FirstColumn={4} ",pc,Gc,ld,Dc,oc);this.l$b=cb.a.Ta.Wd;return M.a(this.$.userOperationManager,function(Kd,Qd,ve){if(ca.EwaSettings.ma(61)){var Be=window.performance;Be.clearMarks();Be.mark("FreezePanes request sent")}Be=Fd.gridView.ys;ca.EwaSettings.isChangeGateEnabled("OfficeVSO:6661123_RequestContentOnFreezePaneOperation")&&Be?(Be=Fd.ylh(rb,Be,gd,Cc),Fd.mLj(Be)):Fd.$.ly();Be=Fd.$.oa.xa;
var Ie=Be.Na(9,null);Ie.freezeSettings=rb;return J.g(Be,"FreezeOrUnfreezePanes",Ie,Kd,Qd,ve,pc,0)},function(Kd){return new C.a(151,0,Kd,void 0,kd)},nb)};l.prototype.ylh=function(nb,pc,Dc,oc){O.ULS.shipAssertTag(537159580,1,!!pc,"FreezePaneCommandHandler.EstimatePaneViewDataOnPaneRequest: called with null Sheet Processed Data");if(!nb.Freeze)return null;var Gc=pa.a();Gc.State=1;Gc.IsEstimated=!0;var ld=!1,gd=!1,Cc=pc.VU(Na.Range.Tc(Dc.top,Dc.left)),kd=nb.FrozenRows,Fd=nb.FrozenColumns;1!==nb.FrozenRows||
nb.FrozenColumns?nb.FrozenRows||1!==nb.FrozenColumns?(Fd=pc.VU(Na.Range.Tc(nb.FirstRow+1,nb.FirstColumn+1)),pc=pc.VU(Na.Range.Tc(Dc.top,Dc.left)),Gc.Width=Fd.nj-Cc.nj,Gc.Height=Fd.tj-Cc.tj,0<nb.FrozenRows&&(Gc.AbsoluteTop=Fd.tj,gd=!0),0<nb.FrozenColumns&&(Gc.AbsoluteLeft=Fd.nj,ld=!0),kd=Fd.LK-pc.LK,Fd=Fd.qJ-pc.qJ):(Gc.Width=pc.bfd(Z.a.Tc(Dc.top,Dc.left)),oc=Na.Range.Tc(Dc.top,Dc.left+1),Gc.AbsoluteLeft=Cc.nj+Gc.Width,ld=!0):(Gc.Height=pc.afd(Z.a.Tc(Dc.top,Dc.left)),oc=Na.Range.Tc(Dc.top+1,Dc.left),
Gc.AbsoluteTop=Cc.tj+Gc.Height,gd=!0);gd&&(Gc.FirstFrozenRow=Dc.top,Gc.FirstScrollableRow=oc.top);ld&&(Gc.FirstFrozenColumn=Dc.left,Gc.FirstScrollableColumn=oc.left);Gc.VisibleRows=kd;Gc.VisibleColumns=Fd;return Gc};l.prototype.mLj=function(nb){var pc=this;ua.Task.delay(this.$.ya.GetRangeContentPrefetchDelayInMs).continueWith(function(){pc.$.pa&&pc.$.ea&&(pc.$.ea.gX(ha.a.Ee,"FreezePaneCommandHandler.TriggerDelayActiveItemPaneChange"),eb.b(pc.$.pa,nb,-1,void 0,!0))})};l.prototype.gsj=function(nb,pc,
Dc){if(!ca.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UnfreezeViewportAdjustLocation",!1))switch(nb.command){case 1844679312:if(pc||-1===this.uKa&&-1===this.vKa)this.uKa=Dc.ex-Dc.width+this.gridView.scrollLeft,this.vKa=Dc.gx-Dc.height+this.gridView.scrollTop;break;case 340334732:if(pc||-1===this.uKa)this.uKa=Dc.ex-Dc.width+this.gridView.scrollLeft;break;case -806625837:if(pc||-1===this.vKa)this.vKa=Dc.gx-Dc.height+this.gridView.scrollTop}};l.prototype.ftc=function(){var nb=this.gridView.eb;
0<nb.width?this.gridView.scrollLeft=Qa.a.H0b(this.gridView.domElement,X.g(this.$).rtl,0):-1!==this.uKa&&(this.gridView.scrollLeft=this.uKa,this.uKa=-1);0<nb.height?this.gridView.scrollTop=0:-1!==this.vKa&&(this.gridView.scrollTop=this.vKa,this.vKa=-1)};l.prototype.XDf=function(){this.gF.zdb();Ha.a.Ia(this.JEd);this.JEd=null;this.gridView.EK(this.lwf)};Object(G.a)(l,"FreezePanesCommandHandler",null,[429]);var Kb=T.a;Rk(k,Kb);k.prototype.Ad=function(){var nb=this;P.TaskExtensions.Aa(Q.GetServiceTaskFactory.Ra(this.$.da,
12,477,this.hb),function(pc){nb.jd([new l(nb.$,pc.result)])},this.$.la)};k.ka=function(nb){nb.da.Ga(116,new k(nb))};Object(G.a)(k,"FreezePanesCommandHandlerFactory",T.a,[]);var Ab=b(1366),ub=b(27),Mb=b(625),Aa=b(622),Za=b(29),Zb=b(1200),jb=b(1289);b(322);var Vb=b(15),Ic=b(36);e.prototype.ZXf=function(){this.dS=this.fontServiceManager.Dyc;this.vua=this.fontServiceManager.lCh;this.tad=2};e.prototype.LUe=function(nb,pc,Dc,oc){oc=void 0===oc?null:oc;var Gc=Object.assign(new Mb.a,{Id:"FontDropdownMenu"});
Gc.MenuSectionList=[];if(this.Am&&this.themesManager){this.themesManager.f$c(oc);if(null==this.themesManager.fL||this.themesManager.hqd)return Gc;oc=Object.assign(new Aa.a,{ControlsId:"ThemeFontsMenuSectionControl",Title:Vb.a.instance.ga(1317),ControlList:this.uYh(nb,pc,Dc)});Gc.MenuSectionList.push(oc)}oc=Object.assign(new Aa.a,{ControlsId:"FontsMenuSectionControl"});if(this.Am||this.$m)oc.Title=Vb.a.instance.ga(1318);oc.ControlList=this.kOh(nb,pc,Dc);Gc.MenuSectionList.push(oc);return Gc};e.prototype.uYh=
function(nb,pc,Dc){var oc,Gc=[],ld=this.gridView.ha.Oa.Yb;ld=5===(null===(oc=null===ld||void 0===ld?void 0:ld.floatingObject)||void 0===oc?void 0:oc.type);if(this.themesManager.fL){var gd=this.themesManager.fL.lpf;var Cc=this.themesManager.fL.Gnf}else O.ULS.sendTraceTag(520710165,1,15,"ThemeFonts are Null");null!=Cc?(oc=this.$De(Cc,1,ld,nb,pc,Dc),Gc.push(oc)):O.ULS.sendTraceTag(520710164,1,15,"Major Theme Font is Null");null!=gd?(nb=this.$De(gd,2,ld,nb,pc,Dc),Gc.push(nb)):O.ULS.sendTraceTag(520710163,
1,15,"Minor Theme Font is Null");return Gc};e.prototype.$De=function(nb,pc,Dc,oc,Gc,ld){var gd=2===pc?this.fAi:this.lxi;Dc=Dc?gd:Za.a.af(nb);gd=Za.a.af(Fb.HelperMethods.acc(nb,pc));nb=Za.a.af(nb);return Object.assign(new Zb.a,{MenuItemId:2===pc?jb.b:jb.a,CommandValueId:Dc,LabelText:gd,LabelCss:String.format("font-size:12pt;font-family:{0};",nb),Styles:e.Cvb(nb),AriaLabel:gd,Alt:gd,Command:oc.toString(),CommandPreviewId:Gc.toString(),CommandRevertId:ld.toString()})};e.prototype.kOh=function(nb,pc,
Dc){if(this.mYc)return this.mYc.E4c;var oc=this.xei&&!this.Cef,Gc=!1;this.vua||(this.z9e(),Gc=!0);var ld=this.CCe(nb,pc,Dc,this.vua,oc,Gc);ld.ywc&&!Gc&&(O.ULS.sendTraceTag(520710162,1,15,"FontDropdownHelper.getFontButtonsForMenuSection: ddEntries is Null. Fallback to old Font Dictionary."),this.z9e(),ld=this.CCe(nb,pc,Dc,this.vua,oc,ld.ywc));this.$m&&!ld.ywc&&(this.mYc=ld);oc&&gridRenderer.CanvasRendererGlobals.loadPreviewFont(this.lPi);return ld.E4c};e.prototype.CCe=function(nb,pc,Dc,oc,Gc,ld){var gd=
[],Cc=this.$m&&!ld;var kd=Cc?"msofpNew":"msofp";for(var Fd in oc){var rb=Fd,Kd=oc[Fd],Qd=Za.a.af(rb),ve;if(Cc)if(ve=this.dS?this.dS[rb]:null)ve=Za.a.af(ve);else return O.ULS.sendTraceTag(520710161,1,15,"FontDropdownHelper.getFontButtonsForMenuSection: localizedFontName in supportedFontFamiliesNew is not found for {0}",rb),{ywc:!0,E4c:[]};else ve=Za.a.af(Fb.HelperMethods.dS[rb]);rb=Za.a.af(rb);Gc||(Kd=0);Qd=Object.assign(new Zb.a,{MenuItemId:Qd,CommandValueId:Qd,LabelText:Gc&&0<Kd?Za.a.af(String.fromCodePoint(Kd)):
ve,LabelCss:String.format("font-size:12pt;font-family:{0};",Gc&&0<Kd?kd:rb),Styles:e.Cvb(Gc&&0<Kd?kd:rb),AriaLabel:ve,Alt:ve,Command:nb.toString(),CommandPreviewId:pc.toString(),CommandRevertId:Dc.toString()});gd.push(Qd)}return{ywc:ld,E4c:gd}};e.prototype.Fqj=function(nb){this.menuId=nb};e.prototype.ihi=function(){return 2!==this.tad&&3!==this.tad?!1:!0};e.prototype.z9e=function(){var nb={};this.vua=(nb["Angsana New"]=983046,nb["Arial Black"]=983051,nb.Arial=983050,nb.Batang=983061,nb["Book Antiqua"]=
983077,nb["Browallia New"]=983082,nb.Calibri=983085,nb.Cambria=983089,nb.Candara=983091,nb.Century=983095,nb["Comic Sans MS"]=983100,nb.Consolas=983101,nb.Constantia=983102,nb.Corbel=983106,nb["Cordia New"]=983107,nb["Courier New"]=983109,nb.DilleniaUPC=983121,nb.Dotum=983123,nb.FangSong=983138,nb.Garamond=983154,nb.Georgia=983156,nb.Gulim=983182,nb.GungSuh=983186,nb.KaiTi=983222,nb.JasmineUPC=983218,nb["Malgun Gothic"]=983258,nb.Mangal=983262,nb.Meiryo=983264,nb["Microsoft JhengHei"]=983272,nb["Microsoft YaHei"]=
983284,nb.MingLiU=983292,nb.MingLiU_HKSCS=983296,nb["MS Gothic"]=983245,nb["MS Mincho"]=983247,nb["MS PGothic"]=983249,nb["MS PMincho"]=983251,nb.PMingliU=983322,nb["PMingLiU-ExtB"]=983324,nb.SimHei=983382,nb.SimSun=983384,nb["SimSun-ExtB"]=983386,nb["Source Sans Pro"]=983396,nb.Tahoma=983405,nb.THSarabunPSK=983404,nb["Times New Roman"]=983415,nb["Trebuchet MS"]=983419,nb.Verdana=983443,nb["Yu Gothic"]=983464,nb["Yu Mincho"]=983474,nb)};e.Cvb=function(nb){var pc={};pc["font-family"]=nb;pc["font-size"]=
"12pt";return{optionText:pc}};Mf.Object.defineProperties(e.prototype,{themesManager:{configurable:!0,enumerable:!0,get:function(){this.Zw||(this.Zw=this.$.da.za(422));return this.Zw}},Dyc:{configurable:!0,enumerable:!0,get:function(){return this.dS}}});Object(G.a)(e,"FontDropdownHelper",null,[926]);var Rb=b(911),kc=ob.a;Rk(d,kc);d.prototype.create=function(){var nb=this;ca.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FontServiceIntegration",!1)?this.$.da.Za(504,function(pc){nb.pb(Object(Rb.c)(nb.$.da,
502,function(){return new e(nb.$,pc)}))}):this.pb(Object(Rb.c)(this.$.da,502,function(){return new e(nb.$,null)}))};d.ka=function(nb){nb.da.Ga(503,new d(nb))};Object(G.a)(d,"FontDropdownHelperFactory",ob.a,[]);var xb=b(1450),Va=b(1291),tb=b(1429),fb=b(1389),ac=b(1337),Ac=b(1363),Rc=b(1479),Fc=b(1430),wb=b(1400);c.prototype.Lc=function(){return!1};c.prototype.executeCommand=function(nb,pc){nb=!1;pc=pc.command;switch(pc){case 1910465940:nb=!0}return nb?ua.Task.Ua(!0):ea.a(pc)};c.prototype.zc=function(nb,
pc){switch(pc.command){case 1910465940:return!0;default:return!1}};c.prototype.Qc=function(){return!1};Object(G.a)(c,"NameManagerCommandHandler",null,[429]);var uc=T.a;Rk(a,uc);a.prototype.Ad=function(){this.jd([new c(this.$)])};a.ka=function(nb){T.a.Qd(493,new a(nb))};Object(G.a)(a,"NameManagerCommandHandlerFactory",T.a,[]);var Pb=b(1390),sc=b(1376);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.AutoComplete");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.ContextMenu");
Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.DataValidation");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.DataValidationEdit");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.FormulaAssistance");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.SharedUIControlsFactory");Type.registerNamespace("_Ewa");Object(F.a)();ba.a.Fa(A.ka);ba.a.Fa(w.ka);Object(ia.a)();Object(ta.a)();Object(za.a)();Object(sa.a)();Object(V.a)();Object(Ia.a)();ba.a.Fa(v.ka);Object(Ob.a)();
Object(Cb.a)();Object(ab.a)();(function(){ba.a.Fa(function(nb){k.ka(nb)})})();Object(Ab.a)();Object(xb.a)();Object(Va.a)();Object(tb.a)();Object(fb.a)();Object(ac.a)();Object(Ac.a)();Object(Rc.a)();Object(Fc.a)();Object(sc.a)();Object(wb.a)();Object(Pb.a)();(function(){ba.a.Fa(function(nb){a.ka(nb)})})();(function(){ba.a.Fa(function(nb){d.ka(nb)})})()},928:function(u,E,b){function a(C,Q,P,ka,R,fa,ca,ea,wa,X,ja,va){var ua=M.call(this)||this;ua.Dkc=!1;ua.contextMenuController=null;ua.eIc=null;ua.qFc=
null;ua.ind=!1;ua.s_j=0;ua.r_j=0;ua.gsb=null;ua.Etc=null;ua.rC=function(){ua.contextMenuController?ua.contextMenuController.rC():d.ULS.sendTraceTag(537167068,0,10,"ContextMenuBase.DismissFloatie: the context menu controller is null when attempintg to dismiss floatie on KeyDown.");ua.Hag()};ua.jb=C;ua.Nof=R;ua.hPc=X;ua.CZj=P;ua.BZj=ka;ua.dZj=Q;ua.gGf=fa;ua.populateOnlyOnce=ca;ua.n4h=ja;ua.VMf(va);return ua}b.d(E,"a",function(){return a});u=b(0);var c=b(7),d=b(14),e=b(625),k=b(89),l=b(622),n=b(393),
f=b(652),v=b(631),r=b(113),y=b(276),m=b(83),w=b(440),B=b(1600);E=b(79);var A=b(19),z=b(5),x=b(1048),D=b(76),I=b(45),F=b(59),G=b(151),T=b(114),O=b(1),U=b(11),J=b(22),H=b(15),K=b(21),N=b(33),M=E.a;Rk(a,M);a.prototype.Lc=function(C,Q){C=!0;switch(Q){case 1651433993:case 1675506831:case 966232027:C=this.Ud(4096)||this.Ud(2048);break;case 2045563128:C=this.Ud(4096);break;case 912277356:case 2123758504:case -1793121409:case 1378457149:C=this.Ud(8192)}return!C};a.prototype.Qc=function(C,Q,P){P.IsShadowMenuOpen||
x.h(this.$,x.d);C=!1;Q===this.uw&&(P.IsShadowMenuOpen||x.h(this.$,x.a),Q=Object(c.a)(new e.a,{ExternalId:"ContextMenu",UpdateDynamically:!0,MenuSectionList:[]}),this.QCd(Q,P.IsShadowMenuOpen),P.MenuItems=Q,P.IsShadowMenuOpen||x.h(this.$,x.c),C=!0);C&&this.Dkc&&U.HelperMethods.I0b&&!P.IsShadowMenuOpen&&x.j(this.$);return C};a.prototype.QCd=function(C,Q){(Q=this.IY(Q))?(this.P7e(Q),Array.addRange(C.MenuSectionList,Q.$D().MenuSectionList),this.MBg(C)):d.ULS.sendTraceTag(537167105,0,10,"ContextMenuBase.PopulateContextMenuProps: CreateRibbonMenu() returned null instead of RibbonMenu instance")};
a.prototype.IY=function(){d.ULS.sendTraceTag(537167104,0,10,"ContextMenuBase.CreateRibbonMenu: This method should not be called if the menu is not ready for React!");return null};a.prototype.x0=function(C,Q,P,ka,R){C=Sys.UI.DomElement.getBounds(Q);Q=new Sys.UI.Point(C.x,C.y+C.height);this.$.isChromeRtl&&(Q.x+=C.width);this.hp(Q,R)};a.prototype.hp=function(C,Q,P){P=void 0===P?0:P;Q&&(C=N.a(this.$).rja(C));Q=!0;if(this.n4h){var ka;3===P?(ka=this.NJa(3))&&0<ka.length?(Q=!1,this.showFloatie(ka,new Sys.UI.Bounds(C.x,
C.y,0,0),P)):d.ULS.sendTraceTag(537167075,0,10,"ContextMenuBase.ShowAt: A context menu that implements floaties has returned null when generating the touch floatie groups. Context menu ID: {0}",this.menuId):2===P&&this.$.isEditMode&&((ka=this.NJa(2))&&0<ka.length?ka[0]!==a.XSe?(Q=!1,this.TQd(ka,new Sys.UI.Bounds(C.x,C.y,0,0),P)):d.ULS.sendTraceTag(537167074,0,50,"ContextMenuBase.ShowAt: The context menu does not support floatie. Context menu ID: {0}",this.menuId):d.ULS.sendTraceTag(537167073,0,10,
"ContextMenuBase.ShowAt: A context menu that implements floaties has returned null when generating the mouse floatie groups. Context menu ID: {0}",this.menuId))}Q&&this.showContextMenu(new Sys.UI.Bounds(C.x,C.y,0,0),P)};a.prototype.NJa=function(){return null};a.prototype.Xed=function(C,Q){var P="";3===C?P="touch":2===C&&(P="mouse");C={};return C.ContextMenuId=this.menuId,C.IsEditMode=this.$.isEditMode,C.IsSLR=!!F.a.qg&&F.a.qg.aK,C.IsReactMLR=!!F.a.qg&&F.a.qg.rV,C.IsNov=this.$.ea.isNamedObjectViewMode,
C.InputType=P,C.FloatieGroups=JSON.stringify(void 0===Q?null:Q),C};a.prototype.showContextMenu=function(C,Q){Q=void 0===Q?0:Q;var P=this.Xed(Q);d.ULS.sendTraceTag(595359709,0,50,"ContextMenuBase.ShowContextMenu: rendering a context menu with given arguments: {0}",JSON.stringify(P));this.contextMenuController?this.sB!==z.a.FFd&&this.sB!==z.a.GFd||0===Q?this.contextMenuController.SQd(this.sB,C,D.a.Cb):this.contextMenuController.SQd(this.sB,C,Q):d.ULS.sendTraceTag(537167072,0,10,"ContextMenuBase.ShowContextMenu: the context menu controller is null when attempintg to show context menu.")};
a.prototype.showFloatie=function(C,Q,P){var ka=this.Xed(P,C);d.ULS.sendTraceTag(595359710,0,50,"ContextMenuBase.ShowFloatie: rendering a floatie with given arguments: {0}",JSON.stringify(ka));this.contextMenuController?(O.EwaSettings.isChangeGateEnabled("OfficeVSO:5381730_FloatieDismissal_OnKeyDown_JsCrashFix")&&this.bNf(),this.contextMenuController.bxc(C,Q,P)):d.ULS.sendTraceTag(537167071,0,10,"ContextMenuBase.ShowFloatie: the context menu controller is null when attempting to show the floatie with floatieGroups {0}.",
JSON.stringify(C))};a.prototype.TQd=function(C,Q,P){var ka=this.Xed(P,C);d.ULS.sendTraceTag(537167070,0,50,"ContextMenuBase.ShowContextMenuWithFloatie: rendering a floatie with given arguments: {0}",JSON.stringify(ka));this.contextMenuController?(O.EwaSettings.isChangeGateEnabled("OfficeVSO:5381730_FloatieDismissal_OnKeyDown_JsCrashFix")&&this.bNf(),this.contextMenuController.RQd(C,Q,P,this.sB)):d.ULS.sendTraceTag(587335491,0,10,"ContextMenuBase.ShowContextMenuWithFloatie: the context menu controller is null when attempintg to show floatie with ContextMenu.")};
a.prototype.VMf=function(C){this.contextMenuController=C};a.prototype.dispose=function(){this.$&&this.$.Ka.Jab(this);this.jb=null;O.EwaSettings.isChangeGateEnabled("OfficeVSO:5381730_FloatieDismissal_OnKeyDown_JsCrashFix")&&this.Hag();this.Etc&&(k.a.Ia(this.Etc),this.Etc=null);M.prototype.dispose.call(this)};a.prototype.IEh=function(C){var Q=this.$.da.za(204);Q&&(Q=Q.oFh(this.Nof))&&C.pc.push(Q)};a.prototype.Ud=function(C){return(new G.a(this.$.va)).Ud(C)};a.prototype.P7e=function(C){C=bk(C.pc);for(var Q=
C.next();!Q.done;Q=C.next())if(Q=Q.value,Object(w.a)(573,Q)){Q.title&&(Q.title=a.qh(Q.title));Q=bk(Q.buttons);for(var P=Q.next();!P.done;P=Q.next())P=P.value,Object(w.a)(574,P)?(P.label=a.qh(P.label),P.VR(a.qh(P.alt))):Object(w.a)(575,P)&&this.P7e(P.menu)}};a.prototype.Kof=function(C,Q){Q=void 0===Q?!1:Q;var P=[];C=bk(C);for(var ka=C.next();!ka.done;ka=C.next())P.push(this.hU(ka.value,Q));return P};a.prototype.hU=function(C){for(var Q=[],P=bk(C.MenuItems),ka=P.next();!ka.done;ka=P.next())switch(ka=
ka.value,ka.Type){case 3:Q.push(this.y4g(ka));break;case 2:Q.push(this.h$g(ka));break;case 1:Q.push(this.Y5g(ka))}return Object(c.a)(new l.a,{ControlList:Q,Title:C.Title,DisplayMode:"Menu16",MenuSectionTitleFocusable:!0,ShowMenuSectionTitleBackground:!0,ShowMenuSectionTitleIcon:!0})};a.prototype.vbd=function(C,Q){Q=[this.gsb,C.RibbonCommand.toString(),Q?this.EYe(Q):this.EYe(C.Label),C.Disabled?C.Disabled.toString():"False"];var P=C.CommandData;P=J.a.hashCode(P).toString();Q.push(P,C.Identifier.toString());
Q=Q.join("_");C.IsChecked&&(Q+="_Checked");return Q};a.prototype.pFh=function(C){var Q=[this.gsb,J.a.hashCode(C.Title).toString()];C=bk(C.MenuItems);for(var P=C.next();!P.done;P=C.next())Q.push(P.value.RibbonCommand.toString());return Q.join("_")};a.prototype.KUe=function(C){var Q=C.Label;Q=J.a.hashCode(Q).toString();Q=[this.gsb,Q];O.EwaSettings.isChangeGateEnabled("OfficeVSO:5139850_FixPivotFilterMenuDuplicatingIdenticalFields")&&C.Id&&Q.push(J.a.hashCode(C.Id).toString());Q=Q.join("_");C.IsChecked&&
(Q+="_Checked");return Q};a.prototype.y4g=function(C){var Q=this.y$b(C,!1);var P=Q.label;var ka=Q.ZKa;Q=Q.mr;var R=this.vbd(C,P);return Object(c.a)(new n.a,{Command:C.Disabled?(-251203935).toString():Q.toString(),ExternalId:R,Id:R,Image16by16Class:ka,LabelText:P||C.Label,MenuItemId:C.CommandData,CommandValueId:C.CommandData})};a.prototype.h$g=function(C){var Q=this.y$b(C,C.IsChecked);var P=Q.label;var ka=Q.ZKa;Q=Q.mr;var R=this.vbd(C,P);return Object(c.a)(new f.a,{Command:C.Disabled?(-251203935).toString():
Q.toString(),ExternalId:R,Id:R,Image16by16Class:ka,LabelText:P||C.Label,MenuItemId:C.CommandData,CommandValueId:C.CommandData,IsChecked:C.IsChecked})};a.prototype.Y5g=function(C){var Q=this.UUe(C);var P=Q.label;Q=Q.ZKa;var ka=Object(c.a)(new e.a,{MenuSectionList:[],UpdateDynamically:!0});Array.addRange(ka.MenuSectionList,this.Kof(C.SubMenu.Sections,!0));var R=this.KUe(C);C=P||C.Label;return Object(c.a)(new v.a,{ExternalId:R,Id:R,LabelText:C,PopulateOnlyOnce:!1,Menu:ka,Image16by16Class:Q,ImageIsVisible:!!Q})};
a.prototype.UUe=function(C){C=this.y$b(C,!0);return{label:C.label,ZKa:C.ZKa,mr:C.mr}};a.prototype.y$b=function(C,Q){switch(C.Identifier){case 26:var P=912804500;Q=A.a.$Oe;C=H.a.instance.ga(1926);break;case 3:P=-1902148570;Q=Q?A.a.gaa:null;C=H.a.instance.ga(1886);break;case 4:P=-1902148570;Q=Q?A.a.gaa:null;C=H.a.instance.ga(1887);break;case 5:P=-1902148570;Q=Q?A.a.gaa:null;C=null;break;case 1:P=-1677817820;Q=A.a.q8b;C=H.a.instance.ga(235);break;case 2:P=-1649376918;Q=C.IsChecked?A.a.dua:null;C=H.a.instance.ga(2092);
break;case 23:P=1701016594;Q=C.IsChecked?A.a.dua:null;C=H.a.instance.ga(2092);break;case 6:P=-87741481;Q=null;C=H.a.instance.ga(2093);break;case 7:P=1948650742;Q=A.a.ONe;C=H.a.instance.ga(1924);break;case 8:P=1933713114;Q=A.a.NNe;C=H.a.instance.ga(1925);break;case 14:P=504133448;Q=A.a.GIa;C=H.a.instance.ga(145);break;case 30:P=504133448;Q=A.a.GIa;C=H.a.instance.ga(149);break;case 32:P=504133448;Q=A.a.GIa;C=H.a.instance.ga(151);break;case 34:P=504133448;Q=A.a.GIa;C=H.a.instance.ga(153);break;case 27:P=
1701016594;Q=Q?A.a.s8b:A.a.GIa;C=H.a.instance.ga(145);break;case 15:P=-798968736;Q=A.a.HIa;C=H.a.instance.ga(147);break;case 31:P=-798968736;Q=A.a.HIa;C=H.a.instance.ga(150);break;case 33:P=-798968736;Q=A.a.HIa;C=H.a.instance.ga(152);break;case 35:P=-798968736;Q=A.a.HIa;C=H.a.instance.ga(154);break;case 28:P=1701016594;Q=Q?A.a.t8b:A.a.HIa;C=H.a.instance.ga(147);break;case 21:P=-2058042992;Q=A.a.$1a;C=null;break;case 29:P=1701016594;Q=A.a.$1a;C=null;break;case 9:P=1701016594;C=Q=null;break;case 11:P=
-1494291901;C=Q=null;break;case 25:P=-1045020714;Q=C.IsChecked?A.a.dua:null;C=null;break;case 13:P=1701016594;Q=C.IsChecked?A.a.dua:null;C=H.a.instance.ga(156);break;case 16:P=1701016594;Q=A.a.i8b;C=H.a.instance.ga(1059);break;case 17:P=1701016594;Q=A.a.Z1a;C=null;break;case 18:P=1701016594;Q=A.a.Y1a;C=null;break;case 19:P=1701016594;Q=A.a.j8b;C=H.a.instance.ga(1064);break;case 20:P=1701016594;Q=A.a.x8c;C=H.a.instance.ga(1065);break;case 24:P=1675506831;C=Q=null;break;case 22:P=C.RibbonCommand;Q=
C.IsChecked?A.a.gaa:null;C=null;break;case 36:P=1461300262;Q=null;C=H.a.instance.ga(155);break;case 38:P=C.RibbonCommand;Q=A.a.u8b;C=H.a.instance.ga(1797);break;default:d.ULS.shipAssertTag(537167069,0,!1,"Unable to map menu item: {0}",JSON.stringify(C)),P=1461300262,C=Q=null}return{label:C,ZKa:Q,mr:P}};a.prototype.EYe=function(C){return O.EwaSettings.isChangeGateEnabled("OfficeVSO:6130289_FixLoggingColumnNameInButtonId")?J.a.hashCode(C+U.HelperMethods.znj).toString():C};a.prototype.MBg=function(C){if(!this.$.ea.amIAlone){var Q=
this.$.da.za(25);if((void 0!==Q&&null!==Q||!O.EwaSettings.isChangeGateEnabled("OfficeVSO:5280339_GuardPresenceView"))&&!r.a.isEmpty(Q.FBa)&&(Q=Q.d_h(),!y.a.fh(Q))){var P=[];m.a.instance.resolve("Common.App.UI.IPresenceContextMenuSectionBuilder").x8g(Q,P);Array.addRange(C.MenuSectionList,P)}}};a.prototype.bNf=function(){this.ind||(this.bub&&this.bub.kZb(this.rC),this.Apb&&this.Apb.kZb(this.rC),this.ind=!!this.bub||!!this.Apb)};a.prototype.Hag=function(){this.bub&&this.bub.jsc(this.rC);this.Apb&&this.Apb.jsc(this.rC);
this.ind=!1};a.kmd=function(C,Q){Q=I.C(Q);C=K.g(C).Ea.YJa(Q);return!(null===C||void 0===C||!C.sk)};a.xcd=function(C,Q,P){Q=I.C(Q);var ka=K.g(C).Ea.YJa(Q);Q=K.g(C).getCellBounds(ka);var R=ka.xMg;ka=ka.wMg;var fa=Q.x+R.x;Q=Q.y+R.y;P&&O.EwaSettings.isChangeGateEnabled("OfficeVSO:5554367_NewAutoFilterUXEnabled")&&(K.g(C).rtl||(fa+=ka),Q-=ka);return new Sys.UI.Point(fa,Q)};a.uwh=function(C){try{Object(B.a)(C.CommandValueId)}catch(Q){}};a.qh=function(C){var Q=a.l1a.parseFromString(C,"text/html");return Q?
Q.body.innerText:(d.ULS.sendTraceTag(537167066,0,15,"Not able to decode htmlFormattedText"),C)};Mf.Object.defineProperties(a.prototype,{contextMenuRoot:{configurable:!0,enumerable:!0,get:function(){return this.Etc}},$:{configurable:!0,enumerable:!0,get:function(){return this.jb}},Va:{configurable:!0,enumerable:!0,get:function(){return this.hPc}},menuId:{configurable:!0,enumerable:!0,get:function(){return this.$.yb+this.Nof}},bub:{configurable:!0,enumerable:!0,get:function(){this.eIc||(this.eIc=T.a(this.$));
return this.eIc}},Apb:{configurable:!0,enumerable:!0,get:function(){this.qFc||(this.qFc=K.g(this.$).Wb);return this.qFc}}});a.l1a=new DOMParser;a.XSe="Unsupported";Object(u.a)(a,"ContextMenuBase",E.a,[429,576,3])},986:function(u,E,b){function a(){}b.d(E,"a",function(){return a});u=b(0);a.CLe="ewa-ac";a.Rlh="ewa-ac-param";a.vMe="ewa-function-help-link";a.q8c="ewa-lb";a.pMe="ewa-fb-refactor";a.listItem="list-item";a.yBb="list-item-selected";a.CBb="list-table-touch";a.BBb="list-table";a.Erh="ewa-suggested-cell-name";
a.AZg="columnName-header";a.rNe="ewa-tt";a.Uoh="ewa-function-link-container";a.wMe="ewa-function-udf-name";a.rtl="rtl";Object(u.a)(a,"CssClassNames",null,[])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.kpae.js.map/4573c72b89f3c6e8b0a82d1761ba6dd3/EwaDS.kpae.js.map