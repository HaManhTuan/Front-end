(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[23],{1188:function(u,E,b){function a(k,l){k=e.call(this,k,l)||this;l!==d.a.P9&&k.rFa(l);k.wga(a.iterateNext);k.wga(a.axa);k.pTc(c.a.KTa);k.pTc(c.a.LTa);return k}b.d(E,"a",function(){return a});u=b(0);var c=b(170);E=b(1442);var d=b(973),e=E.a;Rk(a,e);a.iterateNext="IterateNext";a.axa="IteratePrevious";a.jNb="ToggleShowChanges";a.setCurrentChangeCount="SetCurrentChangeCount";a.setTotalChangesCount="SetTotalChangesCount";a.AOa=
"OnVHDiffReady";Object(u.a)(a,"VersionHistoryMessenger",E.a,[])},1460:function(u,E,b){function a(K,N,M,C){var Q=this;this.authorColor=this.Y1=this.oea=null;this.O6a=!1;this.q9f=0;this.E0a=-1;this.Y3c=0;this.ZHa=100;this.Hka=-1;this.WYd=null;this.wob=f.a.nVj;this.sFe=f.a.oVj;this.di=function(P){(P=A.a(P)?null:P.Result)?P.OperationWaitingForFileDownload?20>Q.Y3c?(Q.ZHa*=2,H.Task.delay(Q.ZHa).continueWith(function(){Q.mWd()})):(Q.fBc(),d.ULS.sendTraceTag(537150406,0,50,"VersionHistoryHighlightManager::OnWebMethodSuccess Next Operation enqueue failed")):
P.ActivityList?(Q.initialize(P.ActivityList,P.VersionAuthors),z.EwaSettings.isChangeGateEnabled("OfficeVSO:4844740_ExcelVersionHistoryHighlightChangesFix")?Q.AOa():Q.ixc(!0),Q.WYd.stop(),d.ULS.sendTraceTag(41743369,0,50,"VersionHistoryHighlightManager: Time taken For showing diffs in Ms:{0}",Q.WYd.qc.toString())):(Q.fBc(),d.ULS.sendTraceTag(537150407,0,50,"VersionHistoryHighlightManager::OnWebMethodSuccess no activity list found.")):(Q.ZHa*=2,H.Task.delay(Q.ZHa).continueWith(function(){Q.mWd()}),
d.ULS.sendTraceTag(537150408,0,10,"VersionHistoryHighlightManager::OnWebMethodSuccess call returned null result."))};this.Aya=function(){Q.fBc();d.ULS.sendTraceTag(537150405,0,10,"VersionHistoryHighlightManager::OnWebMethodFailure service call failed.")};this.Sqd=function(P){d.ULS.sendTraceTag(537150400,0,50,"VersionHistoryHighlightManager.IterateMessageHandler called with MessageID:{0}",P.MessageId);switch(P.MessageId){case O.a.iterateNext:Q.iterateNext();Q.Hka=(Q.Hka+1)%Q.bS.length;Q.SJb(O.a.setCurrentChangeCount,
Q.Hka+1);break;case O.a.axa:Q.axa();Q.Hka=0>Q.Hka?0:Q.Hka;Q.Hka=(Q.Hka+Q.bS.length-1)%Q.bS.length;Q.SJb(O.a.setCurrentChangeCount,Q.Hka+1);break;case O.a.jNb:Q.ixc(P.Values.ToggleValue)}};this.T_g=function(P,ka){return Q.X2b(P.rk,ka.rk)};this.S_g=function(P,ka){return Q.X2b(P.rk,ka)};this.Rc=function(){Q.Y5b()};this.ap=function(){Q.Y5b()};this.Dh=function(){Q.Y5b()};d.ULS.sendTraceTag(537150411,0,50,"VersionHistoryHighlightManager::Constructor.");this.$=K;this.ariaLiveNotifier=C;this.gridView=G.g(this.$);
this.gridView.ha.vG(this.Rc);this.gridView.QD(this.ap);this.gridView.Wb.Ak(this.Dh);this.hRj();N&&(this.WYd=K.Fb.sc("UserAction","VersionHistoryDiffManagerStopWatch"),this.mWd());if(this.Mr=M)K=e.a.Oaa(this.$.ya.VersionHistoryActionUrl)||J.a.P9,K!==J.a.P9&&this.Mr.rFa(K),this.Mr.Tn(O.a.iterateNext),this.Mr.Tn(O.a.axa),this.Mr.Tn(O.a.jNb),this.Mr.Ml(O.a.iterateNext,this.Sqd),this.Mr.Ml(O.a.axa,this.Sqd),this.Mr.Ml(O.a.jNb,this.Sqd)}function c(K,N,M){this.oFa=K;this.rk=N;this.PBc=M}u=b(0);var d=b(14),
e=b(81),k=b(1030),l=b(85),n=b(202),f=b(8),v=b(219),r=b(64),y=b(45),m=b(564),w=b(177),B=b(110),A=b(295),z=b(1),x=b(11),D=b(101),I=b(15),F=b(294);b(95);var G=b(21),T=b(354);Object(u.a)(c,"UserActivityLocation",null,[]);var O=b(1188),U=b(62),J=b(973),H=b(58);b.d(E,"a",function(){return a});a.prototype.dispose=function(){this.xza();this.oea=this.Y1=null;this.gridView&&(this.gridView.ha&&this.gridView.ha.zF(this.Rc),this.gridView.yF(this.ap),this.gridView.Wb&&this.gridView.Wb.vk(this.Dh),this.Mr&&(this.Mr.qoa(O.a.axa),
this.Mr.qoa(O.a.iterateNext),this.Mr.qoa(O.a.jNb)))};a.prototype.initialize=function(K,N){K?(this.xza(),this.E0a=-1,this.oea=[],this.O6a=!1,this.Y1={},this.authorColor={},this.Uxi(N),this.G3c(K)):d.ULS.shipAssertTag(537150410,0,!1,"VersionHistoryHighlightManager.Initialize - userActivityList was Null")};a.prototype.mWd=function(){function K(M,C,Q){var P=N.$.oa.xa;M=F.b(M,N.di);C=F.a(C,N.Aya);var ka=P.Na(1,null);return U.g(P,"GetVersionHistoryHighlightActivitiesData",ka,M,C,Q,null,4)}var N=this;d.ULS.sendTraceTag(537150409,
0,50,"VersionHistoryHighlightManager: TryFetchUserActivityandTriggerDiff triggered: {0} --{1}",this.Y3c.toString(),this.ZHa.toString());this.Y3c++;z.EwaSettings.Zb()?this.$.userOperationManager.Sb(new w.a(537,0,K,80),null):this.$.userOperationManager.Sb(new m.a(537,0,K,16),null)};a.prototype.ixc=function(K){var N=this.Y1,M;for(M in N){var C=M,Q=N[M];Q?Q.GLb(K):d.ULS.shipAssertTag(537150404,0,!1,"VersionHistoryHighlightManager.ShowOrHideAllHighlights -"+C+"view was Null")}};a.prototype.xza=function(){var K=
this.Y1,N;for(N in K){var M=N,C=K[N];C?C.AHd():d.ULS.shipAssertTag(537150403,0,!1,"VersionHistoryHighlightManager.RemoveAllHighlights -"+M+"view was Null")}this.oea=this.Y1=null};a.prototype.VVf=function(K){var N=this.fSh(K,this.E0a);var M=N.N8e;K=N.Odg;N.returnValue&&(d.ULS.shipAssertTag(537150402,0,!!K,"VersionHistoryHighlightManager.SelectNextOrPreviousChange - userActivityLocation is null"),this.Y5b(),K.oFa.toString()in this.Y1?(this.Y1[K.oFa.toString()].ilj(K.rk),N=y.D(K.rk),this.ariaLiveNotifier.setEnabled(!1),
this.ariaLiveNotifier.setEnabled(!0),this.ariaLiveNotifier.readText(String.format(I.a.instance.mb(158),M+1,this.bS.length,N.aB(!1),K.PBc.DisplayName)),this.E0a=M):d.ULS.shipAssertTag(537150401,0,!1,String.format("VersionHistoryHighlightManager.SelectNextOrPreviousChange - {0} view not present in views dictionary",K.oFa.toString())))};a.prototype.SJb=function(K,N){if(z.EwaSettings.ma(320))if(this.Mr){var M={};M.count=N;K=new k.a(K);K.Values=M;this.Mr.send(K)}else d.ULS.sendTraceTag(537150370,0,10,
"VersionHistoryHighlightManager.SendIteratorTextUpdateMessage hostPostmessenger is null");else d.ULS.sendTraceTag(537150371,0,50,"VersionHistoryHighlightManager.SendIteratorTextUpdateMessage VersionHistoryIterator BRS is turned off")};a.prototype.fSh=function(K,N){var M=!1;var C=null;for(var Q=0;!M&&Q<this.bS.length;){N=K?this.XRh(N):this.PTh(N);C=this.bS[N];var P=Object(l.a)(D.a,this.$.va.getItemByName(C.rk.SheetName));if(!P)return d.ULS.shipAssertTag(537150369,0,!1,String.format("VersionHistoryHighlightManager.GetNextorPreviousUserActivityLocationFromIndex - useractivitylocation contains sheetrange with null sheet")),
{returnValue:!1,N8e:N,Odg:C};P.visible&&(M=!0);Q++}return{returnValue:M,N8e:N,Odg:C}};a.prototype.XRh=function(K){return-1===K?this.ZZe():(K+1)%this.bS.length};a.prototype.PTh=function(K){-1===K&&(K=this.ZZe());return K=(K+this.bS.length-1)%this.bS.length};a.prototype.G3c=function(K){this.w$g(K);this.m3c()};a.prototype.xZh=function(K,N){var M=[];if(!K.RangeList)return d.ULS.shipAssertTag(537150368,0,!1,"VersionHistoryHighlightManager.GetUserActivityLocationFromRangeActivityLocation - ActivityLocationType.Range RangeList Null "),
M;K=bk(K.RangeList);for(var C=K.next();!C.done;C=K.next())(C=C.value)&&this.$.va.Jj(C.SheetName)?(C=new c(0,C,N),M.push(C)):d.ULS.shipAssertTag(537150367,0,!1," Inavlid sheet name"+C.SheetName);return M};a.prototype.w$g=function(K){K=bk(K);for(var N=K.next();!N.done;N=K.next())if(N=N.value,!N||B.e(N.LocationList))d.ULS.sendTraceTag(537150366,0,50,"Empty Location list");else for(var M=bk(N.LocationList),C=M.next();!C.done;C=M.next())if(C=C.value)switch(C.Type){case 0:this.oea.push.apply(this.oea,ck(this.xZh(C,
N.Person)));break;default:d.ULS.sendTraceTag(537150364,0,50,"VersionHistoryHighlightManager.CreateViews Failed. Invalid ActivityLocationType")}else d.ULS.shipAssertTag(537150365,0,!1,"VersionHistoryHighlightManager.CreateUserActivityLocationList - LocationList contains Null")};a.prototype.m3c=function(){for(var K={},N=new n.a,M=[],C=bk(this.oea),Q=C.next();!Q.done;Q=C.next())if(Q=Q.value,N.contains(Q.PBc)||N.add(Q.PBc),0===Q.oFa){var P=new T.a(y.D(Q.rk),r.d(this.$.va.getItemByName(Q.rk.SheetName))),
ka=a.gwc(P);ka in K||M.push(P);K[ka]=this.fKh(Q.PBc)}d.ULS.sendTraceTag(42541534,0,15,"VersionHistoryHighlightManager.CreateRangeHighlightView. Total activities : {0}, Highlightable activities: {1},Total userlist in activities : {0}, Total userlist from pane: {1} ",this.oea.length,M.length,N.count,this.q9f);this.fBc();0<M.length&&(K=new (b(1567).RangeVersionHistoryHighlightView)(this.$,M,K,this.wob),this.Y1["0"]=K)};a.prototype.fBc=function(){var K=this.oea?this.bS.length:0;this.SJb(O.a.setCurrentChangeCount,
0);this.SJb(O.a.setTotalChangesCount,K)};a.prototype.AOa=function(){this.SJb(O.a.AOa,0)};a.prototype.Uxi=function(K){if(K){this.q9f=K.length;for(var N=0;N<K.length;++N)if(z.EwaSettings.isChangeGateEnabled("OfficeVSO:5140301_HandleEmptyInitialsColor")&&!K[N].InitialsColor)d.ULS.sendTraceTag(537150362,0,15,"VersionHistoryHighlightManager.MapAuthorColorInfo: InitialsColor is null or empty for a version author");else{var M=K[N].EmailAddress;var C=K[N].UserName;var Q=null;if(K[N].LoginName){var P=K[N].LoginName.split("|");
3===P.length&&(Q=P[2])}Q?this.authorColor[Q]=K[N].InitialsColor:M?(d.ULS.sendTraceTag(537150361,0,15,String.format("VersionHistoryHighlightManager Map Author Color: LoginName is null")),this.authorColor[M]=K[N].InitialsColor):C?(d.ULS.sendTraceTag(537150360,0,15,String.format("VersionHistoryHighlightManager Map Author Color: Email Address is null")),this.authorColor[C]=K[N].InitialsColor):d.ULS.sendTraceTag(537150359,0,10,String.format("VersionHistoryHighlightManager Map Author Color: User name is null"))}}else d.ULS.sendTraceTag(537150363,
0,15,"VersionHistoryHighlightManager.MapAuthorColorInfo: versionAuthors is null")};a.prototype.hRj=function(){if(this.$.ya.VersionHistoryHighlightsSettings)for(var K=Array.isArray(Sys.Serialization.JavaScriptSerializer.deserialize(this.$.ya.VersionHistoryHighlightsSettings))?Sys.Serialization.JavaScriptSerializer.deserialize(this.$.ya.VersionHistoryHighlightsSettings):null,N=0;N<K.length;N++){var M=K[N],C=M.key?M.key:M.Key?M.Key:"";M=M.value?M.value:M.Value?M.Value:"";"DefaultColor"===C?this.sFe=
M:"InitialTint"===C?this.wob=M:d.ULS.sendTraceTag(537150357,0,15,String.format("VersionHistoryHighlightManager.UpdateHighlightSettings Highlight Settings are incorrect"))}else d.ULS.sendTraceTag(537150358,0,15,String.format("VersionHistoryHighlightManager.UpdateHighlightSettings Highlight Settings are null"))};a.prototype.fKh=function(K){if(K.Email in this.authorColor)return this.authorColor[K.Email];if(K.DisplayName in this.authorColor)return this.authorColor[K.DisplayName];d.ULS.sendTraceTag(537150356,
0,15,String.format("VersionHistoryHighlightManager GetColorFromPerson - unable to associate corresponding author in dictionary"));return this.sFe};a.prototype.X2b=function(K,N){var M=Object(l.a)(D.a,this.$.va.getItemByName(K.SheetName)),C=Object(l.a)(D.a,this.$.va.getItemByName(N.SheetName));return M&&C?(M=(M=x.HelperMethods.NC(M.index,C.index))||x.HelperMethods.NC(K.FirstRow,N.FirstRow))||x.HelperMethods.NC(K.FirstColumn,N.FirstColumn):(d.ULS.sendTraceTag(537150355,0,10,"VersionHistoryHighlightManager.CompareSharedSheetRange - null sheet"),
0)};a.prototype.ZZe=function(){var K=y.m(this.gridView.ha.sa.activeRange,this.$.va.pa);if(!K)return d.ULS.sendTraceTag(537150354,0,10,"VersionHistoryHighlightManager.GetNearestLocationIndexFromCurrentSelection - SelectedSharedSheetRange is null "),0;K=x.HelperMethods.jx(new v.a(this.bS),0,this.bS.length,K,this.S_g);0>K&&(K=~K);return K%this.bS.length};a.prototype.Y5b=function(){if(this.MJb){if(!(this.MJb.oFa.toString()in this.Y1)){d.ULS.shipAssertTag(537150353,0,!1,String.format("VersionHistoryHighlightManager.DeselectCurrentlySelectedView - {0} view not present in views dictionary",
this.MJb.oFa.toString()));return}this.Y1[this.MJb.oFa.toString()].jdh(this.MJb.rk)}this.E0a=-1};a.prototype.iterateNext=function(){this.VVf(!0)};a.prototype.axa=function(){this.VVf(!1)};a.gwc=function(K){return String.format("{0}{1}",K.range,K.sheetId)};Mf.Object.defineProperties(a.prototype,{ofb:{configurable:!0,enumerable:!0,get:function(){return this.Y1}},MJb:{configurable:!0,enumerable:!0,get:function(){return-1===this.E0a?null:this.bS[this.E0a]}},bS:{configurable:!0,enumerable:!0,get:function(){this.O6a||
(this.oea.sort(this.T_g),this.O6a=!0);return this.oea}}});Object(u.a)(a,"VersionHistoryHighlightManager",null,[799,3])},1567:function(u,E,b){function a(m,w,B,A){this.uib=null;this.$=m;this.rvg=w;this.zRa=B;this.ARa={};this.wob=A;this.sai()}function c(){}b.r(E);u=b(0);var d=b(14),e=b(8);c.Lrh="ewa-vhr-rectinnerborder";Object(u.a)(c,"CssClassNames",null,[]);var k=b(64),l=b(45),n=b(203),f=b(95),v=b(21),r=b(354),y=b(1460);b.d(E,"RangeVersionHistoryHighlightView",function(){return a});a.prototype.GLb=
function(m){m?this.qb.qn(this.PE):this.qb.eh(this.PE)};a.prototype.AHd=function(){this.GLb(!1);this.qb.ncb(new r.a(null,k.d(this.$.pa)),this.PE)};a.prototype.ilj=function(m){if(this.zRa){var w=new r.a(l.D(m),k.d(this.$.va.getItemByName(m.SheetName))),B=y.a.gwc(w);if(B in this.zRa)if(B in this.ARa){w=n.a.Oo(this.zRa[B]);B=this.ARa[B];for(var A in B)B[A].style.backgroundColor=String.format("rgba({0},{1},{2},{3})",w.r,w.g,w.b,e.a.pVj);v.g(this.$).ha.Oa.NG(null);v.g(this.$).w3e(m,60,!0,f.a.a4i)}else d.ULS.sendTraceTag(537150426,
0,10,"RangeVersionHistoryHighlightView.SelectView sheetRangeToDivMap doesn't contain entry for "+B);else d.ULS.sendTraceTag(537150427,0,10,"RangeVersionHistoryHighlightView.SelectView sheetRangeToColorMap doesn't contain entry for "+B)}else d.ULS.sendTraceTag(537150428,0,10,"RangeVersionHistoryHighlightView.SelectView sheetRangeToColorMap is null")};a.prototype.jdh=function(m){m=new r.a(l.D(m),k.d(this.$.va.getItemByName(m.SheetName)));var w=y.a.gwc(m);if(w in this.ARa)if(w in this.zRa){m=n.a.Oo(this.zRa[w]);
w=this.ARa[w];for(var B in w)w[B].style.backgroundColor=String.format("rgba({0},{1},{2},{3})",m.r,m.g,m.b,this.wob)}else d.ULS.sendTraceTag(537150424,0,10,"RangeVersionHistoryHighlightView.DeselectView sheetRangeToColorMap doesn't contain entry for "+w);else d.ULS.sendTraceTag(537150425,0,10,"RangeVersionHistoryHighlightView.DeSelectView sheetRangeToDivMap doesn't contain entry for "+w)};a.prototype.sai=function(){var m=this;this.qb.Fw(this.rvg,[a.w4],!1,function(w,B){if(w&&w.range&&w.sheetId&&B){var A=
new r.a(w.range,w.sheetId);A=y.a.gwc(A);A in m.ARa||(m.ARa[A]={});m.ARa[A][w.paneType.toString()]=B;A in m.zRa?(w=m.zRa[A],A=n.a.Oo(w),B.style.borderColor=w,B.style.backgroundColor=String.format("rgba({0},{1},{2},{3})",A.r,A.g,A.b,m.wob),w=document.createElement("div"),w.className=c.Lrh,B.appendChild(w)):d.ULS.sendTraceTag(537150419,0,10,"RangeVersionHistoryHighlightView.InitializeSheetRangeList sheetRangeToColorMap doesn't contain entry for "+A)}else d.ULS.shipAssertTag(537150423,0,!!w,"RangeVersionHistoryHighlightView.AddSheetRangeList: state is null"),
d.ULS.shipAssertTag(537150422,0,!w||!!w.range,"RangeVersionHistoryHighlightView.AddSheetRangeList: state.Range is null"),d.ULS.shipAssertTag(537150421,0,!w||!!w.sheetId,"RangeVersionHistoryHighlightView.AddSheetRangeList: state.SheetId is null"),d.ULS.shipAssertTag(537150420,0,!!B,"RangeVersionHistoryHighlightView.AddSheetRangeList: div is null")})};Mf.Object.defineProperties(a.prototype,{PE:{configurable:!0,enumerable:!0,get:function(){return[a.w4]}},qb:{configurable:!0,enumerable:!0,get:function(){return this.uib||
(this.uib=v.g(this.$).qb)}}});a.w4=23;Object(u.a)(a,"RangeVersionHistoryHighlightView",null,[818])},1630:function(u,E,b){function a(dc){var Ec=Cd.call(this)||this;Ec.$=dc;Ec.Eb();return Ec}function c(dc,Ec,gb,Bb){var qc=this;gb=void 0===gb?null:gb;Bb=void 0===Bb?null:Bb;this.GGa=null;this.t5e=!1;this.zDf=function(Nc){nb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.BlueDot",!1)&&!lb.a.fh(Nc.wywaActivities)&&2!==Nc.wywaActivities[0].type&&(qc.i_a.Enj(qc.FZc.Ndg),qc.i_a.ixc(!0),qc.i_a.g6h(Nc.wywaActivities[0]))};
this.$=dc;this.i_a=new F(this.$);this.Y1d=new M(Ua.AFrameworkApplication.ub,nb.EwaSettings.ma(453));dc=Ub.a.yJj(Wd.a.instance.Tb("Common.App.CatchUpActivity.ICatchUpRequestHandler"));this.ujf=Bb;this.FZc=new v(this.$,dc,this.d6a());this.bwe=new I(this.$,Ua.AFrameworkApplication.ub);this.emptyCatchUpBehaviorManager=new f(this.$);this.bsi(function(Nc){qc.xGi(Nc)},Ec);this.aui();Ec=null;gb||(Ec=Wd.a.instance.resolve("Common.App.CatchUpActivity.FloodgateEventLogger"));this.flyoutRibbonButton=gb||new k(Ec);
this.flyoutFocus=new l(this.$,this.flyoutRibbonButton)}function d(){this.emptyCatchUpBehaviorManager=this.ulsLogger=this.uiCulture=this.flyoutRibbonButton=this.flyoutFocus=this.dataCulture=this.changeSummariesDataProvider=this.appColorUpdateIsEnabled=this.activityRequestManager=this.activityNavigationManager=this.activityContentManager=null}function e(){this.flyoutAnchorTarget=this.useCompactSummaryString=this.disableDismissOnClick=this.customDynamicEntryPointEnabled=this.dynamicEntryPointEnabled=
this.activityFeedDataEnabled=this.includeRelevantAuthorsInSummaryString=this.summaryStringEnabled=this.flyoutEnabled=this.featuredActivityGroupsEnabled=null}function k(dc){this.buttonClickedCallback=null;this.Rib=this.Tyb=!1;this.SBh=new Date;this.bTe=dc}function l(dc,Ec){this.$=dc;this.flyoutRibbonButton=void 0===Ec?null:Ec;Gc.a(this.$).Lh(this);this.hasFocus=!1}function n(dc){window.performance&&"function"===typeof window.performance.mark&&window.performance.mark("CatchUpInit."+dc)}function f(dc){this.$=
dc}function v(dc,Ec,gb){gb=void 0===gb?!1:gb;this.Ndg=null;this.$=dc;this.z1b=Ec;this.PFb=Wd.a.instance.resolve("Common.App.People.IPeopleColorUtils");this.kqc=Wd.a.instance.resolve("Common.App.People.IUserProfilePictureUtils");this.d6a=gb}function r(dc,Ec,gb,Bb,qc,Nc,nd){nd=dc.Na(1,void 0===nd?null:nd);nd.getRelevantActivitiesDataRequest=Ec;return Fa.g(dc,"GetRelevantActivitiesData",nd,gb,Bb,qc,Nc,0)}function y(dc,Ec,gb,Bb,qc,Nc){Nc=dc.Na(1,void 0===Nc?null:Nc);return Fa.g(dc,"GetLineageWywaAuthors",
Nc,Ec,gb,Bb,qc,4)}function m(){var dc=x.call(this)||this;dc.relationship=0;return dc}function w(){this.color=this.imageUrl=this.email=this.givenName=this.displayName=this.provider=this.id=null}function B(){this.lowWaterline=this.highWaterline=this.wywaWaterline=this.actors=this.activities=null;this.hasMore=!1;this.isFirstDocumentOpen=null}function A(){this.activityFeedItems=null}function z(){this.collectionId=this.type=this.id=null;this.activityState=0;this.timestamp=this.activityFeedItemPayload=
null}function x(){this.activityFeedItemId=this.activityId=null;this.type=0;this.collectionId=this.state=this.navigationId=this.relevancy=this.displayTimestamp=this.location=this.actors=null}function D(){}function I(dc,Ec){this.$=dc;this.oi=Ec}function F(dc){var Ec=this;this.KQa=this.I3b=this.Iea=null;this.v4={};this.bDa=null;this.Wid=!1;this.qEb=function(gb,Bb){switch(Bb.state){case 0:case 1:3===Bb.eEd&&(Ec.w5h(),Ec.KQa=null);break;case 2:break;case 3:Ec.j5c();Ec.KQa=Bb.activityId;Ec.Byj();break;
default:Qa.ULS.shipAssertTag(537168030,0,!1,"CatchUpActivityHighlightManager.OnHighlightStateChanged - Invalid CatchUpActivityHighlightState:"+Bb.state)}};this.Il=function(){Ec.Wrb()};this.Rc=function(){Ec.Wrb()};this.ap=function(){Ec.Wrb()};this.Dh=function(){Ec.Wrb()};this.P1f=function(gb,Bb){Ec.Iea&&Bb.oH!==Ec.Mja&&(Bb.isSticky&&Ec.s6b(!0),(gb=Ec.xMj(Bb.oH))?(Ec.Iea.createActivityIndicatorTooltip(Object(tb.a)(new O,{target:Bb.oH,container:gb,activityIds:[Bb.activityId],isSticky:Bb.isSticky,dirHint:Ec.gridView.rtl?
12:9})),Bb.isSticky?(Ec.Mja=Bb.oH,Qa.ULS.sendTraceTag(51172352,0,50,"CatchUpActivityHighlightManager::ShowActivityFlyoutHandler: Activity Indicator Raising Selected/Unselected Event.")):(Ec.Idc=Bb.oH,Qa.ULS.sendTraceTag(51172353,0,50,"CatchUpActivityHighlightManager::ShowActivityFlyoutHandler: Activity Indicator Raising Hover/Unhover Event.")),Ec.bgc||(Ec.gridView.view.Es(Ec.HAc),Ec.gridView.yu(Ec.HAc),Ec.bgc=!0)):Qa.ULS.shipAssertTag(537168027,0,!1,"CatchUpActivityHighlightManager::ShowActivityFlyoutHandler FlyoutContainer is null."))};
this.iHe=function(gb,Bb){Ec.s6b(Bb.pfh)};this.HAc=function(){Ec.Iea?(Ec.Mja&&Ec.Iea.updateActivityIndicatorTooltip(Object(tb.a)(new G,{target:Ec.Mja,isSticky:!0})),Ec.Idc&&Ec.Iea.updateActivityIndicatorTooltip(Object(tb.a)(new G,{target:Ec.Mja,isSticky:!1}))):Qa.ULS.shipAssertTag(537168024,0,!1,"CatchUpActivityHighlightManager::UpdateActivityFlyouts ActivityIndicatorTooltipManager is null.")};this.$=dc;this.gridView=td.g(this.$);this.ha=this.gridView.ha;this.Ya=this.gridView.Wb;this.ha.$Yb(this.Il);
this.ha.vG(this.Rc);this.gridView.QD(this.ap);this.Ya.Ak(this.Dh);this.Mja=this.Idc=null;this.bgc=!1;this.fad={}}function G(){this.target=null;this.isSticky=!1}function T(){this.clearSticky=!1}function O(){this.activityIds=this.container=this.target=null;this.isSticky=!1;this.dirHint=0}function U(){this.f1c=[];this.ZKb={};this.wje={}}function J(dc,Ec,gb,Bb,qc){dc=H.call(this,dc,Ec,gb,Bb)||this;dc.ranges=qc;dc.O6a=!1;return dc}function H(dc,Ec,gb,Bb){var qc=Ja.call(this)||this;qc.$=dc;qc.q0d=Ec;qc.yjg=
gb;qc.UB=Bb;qc.state=0;return qc}function K(dc,Ec,gb){gb=Ne.call(this,dc,Ec,gb)||this;gb.gridView=td.g(dc);gb.vma=Ec;return gb}function N(dc){var Ec=this;this.qEb=function(){switch(Ec.Qu.model.state){case 1:Ec.Q2f(!0);break;case 0:Ec.GLb(!1);break;case 2:case 3:Ec.GLb(!0);break;default:Qa.ULS.shipAssertTag(537167968,0,!1,"RangeCatchUpActivityView.OnHighlightStateChanged - Invalid CatchUpActivityHighlightState:"+Ec.Qu.model.state)}};this.rpg=dc;this.Qu.Sle(this.qEb);this.ez=[]}function M(dc){this.oi=
dc}function C(dc){return h.call(this,dc)||this}function Q(dc,Ec){this.$=dc;this.catchUpActivityManager=Ec}function P(){this.fb=null}function ka(dc){this.vu=dc}function R(dc){this.jtg=dc}function fa(dc){this.Zfa=dc;this.w$d=new $e.a}function ca(dc,Ec,gb){this.Jae=dc;this.nCa=Ec;this.ECa=gb}function ea(dc,Ec,gb,Bb,qc,Nc){dc=nf.call(this,dc,Ec)||this;dc.ItemIds=null;dc.ActivityStatesToSet=0;dc.ActivityStatesToReset=0;dc.ResetUnseenCount=!1;dc.ItemIds=gb;dc.ActivityStatesToSet=Bb;dc.ActivityStatesToReset=
qc;dc.ResetUnseenCount=Nc;return dc}function wa(dc,Ec){return lf.call(this,dc,Ec)||this}function X(dc,Ec){this.Og=dc;this.vu=Ec}function ja(dc){var Ec=dd.call(this)||this;Ec.$=dc;Ec.Eb();return Ec}function va(dc){var Ec=le.call(this)||this;Ec.$=dc;Ec.Eb();return Ec}function ua(dc,Ec){var gb=this;this.$od=!1;this.Qf=function(){gb.T9f()};this.$=dc;nb.EwaSettings.ma(611)&&this.$.ea.H7a&&!ua.Mwb&&(Ec&&!Ec.idb||this.fVj(),ua.v5e?Qa.ULS.sendTraceTag(537155461,0,50,"LineageTeachingCalloutTriggerManager will not trigger WYWA waterline check as it was already checked in session"):
Ec&&!Ec.idb||this.lVj());Qa.ULS.sendTraceTag(537155460,0,50,"LineageTeachingCalloutTriggerManager is initialized.")}function Xa(dc){var Ec=Od.call(this)||this;Ec.gi=null;Ec.Wg=null;Ec.$=dc;Ec.Eb();return Ec}function aa(dc,Ec,gb){var Bb=bd.call(this,dc)||this;Bb.de=null;Bb.xye=null;Bb.uEb=null;Bb.xod=!0;Bb.ju=0;Bb.lp=!1;Bb.Fc=function(qc,Nc){Nc.jg||Bb.i0c()};Bb.Qj=function(){Bb.i0c();return!0};Bb.$=Ec;Bb.taskPaneManager=gb;Bb.$.Bk(Bb.Fc);Gc.a(Bb.$).Lh(Bb);Yd.a.ud(Bb.$)&&(Bb.isVisible=!1);return Bb}
function ba(dc){var Ec=bc.call(this)||this;Ec.lineageTaskPane=null;Ec.r7=null;Ec.$=dc;Ec.Eb();return Ec}function oa(dc,Ec,gb,Bb){var qc=this;this.ztb=this.fF=null;this.ND=this.usd=0;this.uEb=function(){qc.r7&&(qc.r7.stop(),qc.r7=null);qc.wLb.start();qc.fF.createLineagePane(qc.psd,qc.ztb)};this.lineageOpenPaneOrChangeFilterRequest=function(Nc,nd){function Vd(re,Ze,mf){var Pa=qc.$.oa.xa,Wb=ee;re=fd.b(re,qc.ded("LineageOpenPaneOrChangeFilter"));Ze=fd.a(Ze,oe);var Lc=Pa.Na(1,null);Lc.clientParams=qe;
Lc.lineageFilter=Wb;return Fa.g(Pa,"LineageOpenPaneOrChangeFilter",Lc,re,Ze,mf,null,0)}function oe(re){re=Xb.a.Mf(re.data);Qa.ULS.sendTraceTag(537155481,0,50,"LineageManager::LineageOpenPaneOrChangeFilter service call failed. Errors: [{0}]",sc.a.Ec(re))}qc.wLb.stop();Tb.b(qc.$).yd(nc.a.wNi,{});qc.OAj();var qe=Object(tb.a)(new V,{ClientViewCapacity:Nc.clientViewCapacity}),ee=null;nd&&(ee=Object(tb.a)(new sa,{FilterSheetMultiRange:qc.hLj(nd.filterSheetMultiRange)}));nb.EwaSettings.Zb()?qc.$.userOperationManager.Sb(new hb.a(1010,
0,Vd,80),null):qc.$.userOperationManager.Sb(new Sb.a(1010,0,Vd,16),null)};this.lineageLoadMoreRequest=function(Nc){function nd(oe,qe,ee){var re=qc.$.oa.xa;oe=fd.b(oe,qc.ded("LineageLoadMore"));qe=fd.a(qe,Vd);var Ze=re.Na(1,null);Ze.fetchFromBelow=Nc;return Fa.g(re,"LineageLoadMore",Ze,oe,qe,ee,null,0)}function Vd(oe){oe=Xb.a.Mf(oe.data);Qa.ULS.sendTraceTag(537155480,0,50,"LineageManager::LineageLoadMore service call failed. Errors: [{0}]",sc.a.Ec(oe))}Tb.b(qc.$).yd(nc.a.vNi,{});nb.EwaSettings.Zb()?
qc.$.userOperationManager.Sb(new hb.a(1011,0,nd,80),null):qc.$.userOperationManager.Sb(new Sb.a(1011,0,nd,16),null)};this.lineageRefreshViewRequest=function(){function Nc(Vd,oe,qe){var ee=qc.$.oa.xa;Vd=fd.b(Vd,qc.ded("LineageRefreshView"));oe=fd.a(oe,nd);var re=ee.Na(1,null);return Fa.g(ee,"LineageRefreshView",re,Vd,oe,qe,null,0)}function nd(Vd){Vd=Xb.a.Mf(Vd.data);Qa.ULS.sendTraceTag(537155479,0,50,"LineageManager::LineageRefreshView service call failed. Errors: [{0}]",sc.a.Ec(Vd))}Tb.b(qc.$).yd(nc.a.xNi,
{});nb.EwaSettings.Zb()?qc.$.userOperationManager.Sb(new hb.a(1012,0,Nc,80),null):qc.$.userOperationManager.Sb(new Sb.a(1012,0,Nc,16),null)};this.lineageUpdateViewRequest=function(){za(qc.$.oa.xa,function(Nc){if(Nc=Wc.a(Nc)?null:Nc.Result){var nd={};nd=(nd.CountOfUpdatedActivities=Nc.LineageActivitiesResponse.ActivityList.length,nd);Tb.b(qc.$).yd(nc.a.yNi,nd);Nc=Object(tb.a)(new na,{activityList:qc.hqc(Nc.LineageActivitiesResponse.ActivityList),latestActivityId:Nc.LineageActivitiesResponse.LastSearchedActivityId,
oldestActivityId:Nc.LineageActivitiesResponse.FirstSearchedActivityId,serverMessageCode:Nc.LineageActivitiesResponse.LineageResponseCode,lastSearchedActivityTimestamp:new Date(Nc.LineageActivitiesResponse.EcmaLastSearchedDate),hasNewActivities:Nc.HasNewActivities,filterSheetMultiRange:qc.YKj(Nc.LineageActivitiesResponse.FilterSheetMultiRange),serverFirstActivityId:Nc.LineageActivitiesResponse.ServerFirstActivityId,serverLastActivityId:Nc.LineageActivitiesResponse.ServerLastActivityId,showLoadPrevious:Nc.LineageActivitiesResponse.ShowLoadPrevious,
eolCorrelationId:Nc.LineageActivitiesResponse.EolCorrelationId,eolDateHideHistory:new Date(Nc.LineageActivitiesResponse.EolDateHideHistory),eolPersonHideHistory:qc.Fvb(Nc.LineageActivitiesResponse.EolPersonHideHistory)});qc.fF.onLineageActivitiesUpdateResponse(Nc)}else Qa.ULS.shipAssertTag(537155475,0,!!Nc,"LineageManager.LineageUpdateView returned null response.")},function(Nc){Nc=Xb.a.Mf(Nc.data);Qa.ULS.sendTraceTag(537155474,0,50,"LineageManager::LineageUpdateView service call failed. Errors: [{0}]",
sc.a.Ec(Nc))},null,null)};this.onCardSelected=function(Nc,nd){if(Nc=Nc.rangeHighlightLocation){if(nd){var Vd=Da.Z(nd,null);var oe=Vd.range;if(Vd.returnValue){qc.d7e(Nc.sheetName,qc.Nvb([Da.j(oe)]));return}Qa.ULS.shipAssertTag(537155472,0,!1,"The produced subCellLocation string "+nd+" is not valid.")}Nc.rangeList.length?qc.d7e(Nc.sheetName,Nc.rangeList):qc.h6h(Nc.sheetName)}};this.onLearnMoreLinkClicked=function(){if(nb.EwaSettings.isChangeGateEnabled("OfficeVSO:4597686_LineageLearnMoreLinkEnabled")){var Nc=
new Pb.a(-859308420,Pe.a.Cb,qc.$.Jc,12,null),nd={};nd=(nd[Pe.a.Uf]="HelpID=XLO_LineageTS",nd.InputMethod=Pe.a.Cb,nd[Pe.a.Nc]=Le.a.CQ,nd.ShouldCanvasTakeFocus=!0,nd);qc.$.Ka.Kb(Nc,nd)}};this.onVersionHistoryButtonClicked=function(Nc){qc.$.Ka.Kb(new Pb.a(-1112508866,Nc,qc.$.Jc,12,null))};this.isFeatureEnabled=function(){return!1};this.Qf=function(){var Nc=qc.$.ea.ho.LineageVersion;Nc!==qc.usd&&(Qa.ULS.sendTraceTag(537155470,0,50,"LineageManager.OnWorkbookMetadataChanged: lineageVersion: {0}, this.lineageVersion: {1}",
Nc,qc.usd),qc.usd=Nc,qc.I6i())};this.Uc=function(Nc,nd){qc.fF&&!qc.lineageTaskPane.wgc&&nd.sH&&(Qa.ULS.sendTraceTag(587220563,0,15,"LineageManager::SessionIdChanged detected."),qc.onStaleActivitiesDetected())};this.qo=function(){qc.fF&&!qc.lineageTaskPane.wgc&&(Qa.ULS.sendTraceTag(587220562,0,15,"LineageManager::LoadOnDemandOccurred detected."),qc.onStaleActivitiesDetected())};this.TC=function(){var Nc=qc.a4a();qc.fF.onFilterableSheetListChange(Nc)};this.xya=function(){var Nc=qc.a4a();qc.fF.onFilterableSheetListChange(Nc)};
this.Wnc=function(){var Nc=qc.a4a();qc.fF.onFilterableSheetListChange(Nc)};this.onPaneClosed=function(){qc.fF.onPaneClosed();ta(qc.$.oa.xa,null,function(Nc){Nc=Xb.a.Mf(Nc.data);Qa.ULS.sendTraceTag(537155469,0,50,"LineageManager::OnLineageClosePaneFailed service call failed. Errors: [{0}]",sc.a.Ec(Nc))},null,null)};this.onRangeFilterInputEnabled=function(Nc){Nc?qc.gridView.ha.lP(qc.Rc):qc.gridView.ha.sW(qc.Rc)};this.Rc=function(){var Nc=Da.q(qc.gridView.ha.sa.activeRange,qc.$);Nc=Object(tb.a)(new Ka,
{rangeList:qc.Nvb(Nc.Ranges),sheetName:Nc.SheetName});qc.fF.onSelectedRangeUpdated(Nc)};this.tryParseRangeInfo=function(Nc){var nd=Da.Z(Nc,qc.$.va);var Vd=nd.sheetName;Nc=nd.range;return nd.returnValue?(Vd||(Vd=qc.$.va.pa.sheetName),nd=[],nd.push(Nc),Nc=Da.u(Vd,null,nd),Object(tb.a)(new Ka,{rangeList:qc.Nvb(Nc.Ranges),sheetName:Nc.SheetName})):null};this.uz=function(){var Nc=qc.ND!==qc.$.ea.Ue;qc.fF&&qc.lineageTaskPane.isVisible&&Nc&&(qc.ND=qc.$.ea.Ue,qc.fF.onRefreshRequired())};this.$=dc;Ec.Ga(366,
this);Ec.Ga(501,this);this.gridView=td.g(this.$);this.lineageTaskPane=gb;this.psd=this.lineageTaskPane.iM();this.batchSize=50;this.r7=Bb;this.wLb=this.$.Fb.Kg("UserAction","LineagePaneLoadingShimmerStopWatch");this.kqc=Wd.a.instance.resolve("Common.App.People.IUserProfilePictureUtils");this.O$h();this.yAg()}function ra(){this.hasOldValue=this.hasNewValue=!1;this.cellLocation=this.oldValue=this.newValue=null}function db(){this.activityId=0;this.displayTimestamp=this.author=this.activityGuid=null;this.activityType=
0;this.rangeHighlightLocation=this.isBulkEditOverflow=this.valueChanges=this.gridLocation=this.sheetName=this.nestedActivityList=null;this.degradedCardTypeBits=0}function Ka(){this.sheetName=this.rangeList=null}function Ga(){this.lastCol=this.firstCol=this.lastRow=this.firstRow=0}function xa(){this.logger=this.uiCulture=this.dataCulture=null;this.clientBatchSize=0;this.lineageAppCallbacks=this.filterableSheetList=null}function da(){this.imageUrl=this.email=this.displayName=this.provider=this.id=null}
function qa(){this.onLearnMoreLinkClicked=this.isFeatureEnabled=this.onRangeFilterInputEnabled=this.tryParseRangeInfo=this.onVersionHistoryButtonClicked=this.onCardSelected=this.lineageUpdateViewRequest=this.lineageRefreshViewRequest=this.lineageLoadMoreRequest=this.lineageOpenPaneOrChangeFilterRequest=null}function na(){var dc=ia.call(this)||this;dc.hasNewActivities=!1;dc.filterSheetMultiRange=null;return dc}function ia(){this.activityList=null;this.oldestActivityId=this.latestActivityId=0;this.lastSearchedActivityTimestamp=
null;this.serverLastActivityId=this.serverFirstActivityId=this.serverMessageCode=0;this.docId=null;this.showLoadPrevious=!1;this.eolPersonHideHistory=this.eolDateHideHistory=this.eolCorrelationId=null}function ta(dc,Ec,gb,Bb,qc,Nc){Nc=dc.Na(1,void 0===Nc?null:Nc);return Fa.g(dc,"LineageClosePane",Nc,Ec,gb,Bb,qc,0)}function za(dc,Ec,gb,Bb,qc,Nc){Nc=dc.Na(1,void 0===Nc?null:Nc);return Fa.g(dc,"LineageUpdateView",Nc,Ec,gb,Bb,qc,0)}function sa(){}function V(){}function Ia(dc){var Ec=Jd.call(this)||this;
Ec.$=dc;Ec.Eb();return Ec}function Ha(dc){this.idb=!0;Ha.Eaf()?Ha.Maf()?(Qa.ULS.sendTraceTag(526434368,0,50,"LineageCatchUpExperimentManager is running in hybrid mode. TUI exhausted: {0}",!dc),this.idb=dc):this.idb=!1:this.idb=!0}function ob(dc){return qd.call(this,dc)||this}function ib(dc,Ec){this.$=dc;this.lineageManager=Ec;dc=[new Td.a(Mb.a.rsd,1038647878,0,0,2210),new Td.a(Mb.a.idle,1038647878,0,1)];Fd.a(this.$).LGd(new Bc.a(Mb.a.qsd,Mb.a.idle,dc),new La(Mb.a.rsd,Mb.a.idle,Ec))}function La(dc,
Ec,gb){dc=xe.call(this,dc,Ec)||this;dc.lineageManager=gb;return dc}function zb(dc){var Ec=se.call(this)||this;Ec.$=dc;Ec.Eb();return Ec}function Fb(dc){return ve.call(this,dc)||this}function Yb(dc){var Ec=this;this.baseVersionInfo=this.k3=this.Eoa=this.im=this.ewaAccessibilityManager=this.FNb=null;this.hHd=this.Qqf=!1;this.FEe=!0;this.dialog=this.FB=this.SSe=this.kD=this.ZYd=this.XYd=this.YYd=null;this.wAf=function(gb){Qa.ULS.sendTraceTag(42553885,0,50,"VersionHistoryPaneActor:OnRestoreVersionSelected - Restore is triggered");
if(Ec.Kxj()){var Bb=function(Nc){Kb.c(2138207060,!1);Ec.im.setRestoreFailedAtServer(Nc)};Ec.kD&&Ec.kD.startTimer(Yb.A8f);var qc=function(){Ec.kD.endTimer(Yb.A8f);Ec.Wve(Ec.kD)};Ec.im.setRestoreInProgress();pc.a(Ec.$).Zs(new Dc.a(Mb.a.Zy,5,function(){var Nc=Fd.a(Ec.$).fd.activityState;Nc[kd.a.Oq]=Mb.a.Hye;Nc[Cc.a.aY]=!0;Nc[Cc.a.pT]=0;Nc[Na.Meg]=gb;Nc[Na.rqc]=Ua.AFrameworkApplication.Yi;Nc[Na.Htd]=qc;Nc[ha.h3f]=Bb}))}else Kb.c(2138207060,!1)};this.gDf=function(gb){Ec.FNb.then(function(Bb){Bb.enterFocusTrapZone();
return null});Qa.ULS.sendTraceTag(537150349,0,50,"VersionHistoryPaneActor: OnVersionsReady called");Ec.kD.endTimer(Yb.EUd);Ec.kD.incrementCounter(Yb.t3g);Qa.ULS.sendTraceTag(537150348,0,50,"VersionHistoryPaneActor: OnVersionsReady TimeTakenGetVersionsToOnVersionsReady Ms:{0}",Ec.kD.getTimerDuration(Yb.EUd));Ec.Xej(gb.containerDiv);gb.versions&&0<gb.versions.length&&(Ec.SSe=Yb.KE(gb.versions[gb.versions.length-1]));Ec.k3&&Ec.Eoa&&Ec.nMd(Ec.k3);Qa.ULS.sendTraceTag(537150346,0,50,"VersionHistoryPaneActor:OnVersionsReady Exit")};
this.onVersionSelected=function(gb){Qa.ULS.sendTraceTag(537150345,0,50,"VersionHistoryPaneActor:OnVersionSelected called. for Version:{0}, LastSelected:{1}",Yb.KE(gb.currentVersion),Yb.KE(Ec.k3));Ec.kD.incrementCounter(Yb.s3g);Ec.k3=gb.currentVersion;Ec.baseVersionInfo=gb.baseVersion;Ec.Qqf=gb.noBaseToCompareTo;Ec.Eoa&&Ec.MUj()&&(Ec.nMd(gb.currentVersion),Qa.ULS.sendTraceTag(537150344,0,50,"VersionHistoryPaneActor:OnVersionSelected Exit"))};this.evf=function(gb){Qa.ULS.sendTraceTag(537150337,0,50,
"VersionHistoryPaneActor:OnDownloadTokenReady called. for Version:{0} UpdatedVersionsCount{1}, LastSelected:{2}",(null===gb||void 0===gb?0:gb.versionSelected)?Yb.KE(gb.versionSelected.currentVersion):null,(null===gb||void 0===gb?0:gb.updatedVersions)?gb.updatedVersions.length:0,Yb.KE(Ec.k3));Ec.kD.incrementCounter(Yb.r3g);if(Ec.baseVersionInfo){if((null===gb||void 0===gb?0:gb.updatedVersions)&&2<=gb.updatedVersions.length){var Bb=null,qc=null,Nc=Yb.KE(Ec.k3),nd=Yb.KE(Ec.baseVersionInfo);gb=bk(gb.updatedVersions);
for(var Vd=gb.next();!Vd.done;Vd=gb.next()){Vd=Vd.value;var oe=Yb.KE(Vd);Nc===oe?Bb=Vd:nd===oe&&(qc=Vd);if(Bb&&qc)break}Bb&&qc?(Ec.k3=Bb,Ec.baseVersionInfo=qc,Qa.ULS.sendTraceTag(537150307,0,50,"VersionHistoryPaneActor:OnDownloadTokenReady -Calling versionsViewController:OnVersionSelected RevisionID[N]: {0}, RevisionID[N-1]: {1}.",Yb.KE(Ec.k3),Yb.KE(Ec.baseVersionInfo)),Ec.nMd(Ec.k3)):Qa.ULS.sendTraceTag(537150306,0,50,"VersionHistoryPaneActor:OnDownloadTokenReady - does not find currentVersion or baseVersion from UpdatedVersions. RevisionID[N]: {0}, RevisionID[N-1]: {1}.",
Nc,nd)}else Qa.ULS.sendTraceTag(537150305,0,50,"VersionHistoryPaneActor:OnDownloadTokenReady - no diff call due to downloadTokenReadyObject or downloadTokenReadyObject.UpdatedVersions objects are null or not enough.");Qa.ULS.sendTraceTag(537150304,0,50,"VersionHistoryPaneActor:OnDownloadTokenReady")}else Qa.ULS.sendTraceTag(537150336,0,50,"VersionHistoryPaneActor:OnDownloadTokenReady baseVersionInfo is null in OnDownloadTokenReady callback.")};this.fuf=function(){Qa.ULS.sendTraceTag(537150303,0,50,
"VersionHistoryPaneActor:OnCloseVersionHistoryDialog Called");Ec.aZg();var gb=new Pb.a(1470556788,0,Ec.$.Jc,0,null);Ec.$.Ka.Kb(gb)};this.OAf=function(gb){Qa.ULS.sendTraceTag(41739662,0,50,"VersionHistoryPaneActor:OnSaveACopy Called");var Bb=new Pb.a(-1244760097,0,Ec.$.Jc,0,null);Ec.$.Jf.get(51)&&(Qa.ULS.sendTraceTag(537150301,0,50,"VersionHistoryPaneActor:OnSaveACopy for ODConsumer Called"),Bb=new Pb.a(-309686558,0,Ec.$.Jc,0,null));Kb.c(1604651619,!0);var qc={};Ec.$.Ka.Kb(Bb,(qc.FileDownloadUrl=gb,
qc))};this.fvf=function(gb){Qa.ULS.sendTraceTag(537150300,0,50,"VersionHistoryPaneActor:OnDownloadVersion Called");gb=new fb.QueryStringBuilder(gb);gb.Ei("fn",Ua.AFrameworkApplication.fileName);Qa.ULS.sendTraceTag(537150299,0,50,"VersionHistoryPaneActor:OnDownloadVersion URL Length is "+gb.toString().length);8===Ec.$.frame.B8a(gb.toString(),!0)?(Qa.ULS.sendTraceTag(587830283,0,10,"VersionHistoryPaneActor:OnDownloadVersion failed"),Kb.c(1316171850,!1)):Kb.c(1316171850,!0)};this.Lsf=function(gb){Ec.im.setFullAppErrorCode(gb)};
this.nwf=function(gb){switch(gb){case 101:gb="VHFailedToGetDownloadToken";break;case 100:gb="VHFailedToLoadVersionList";break;case 104:gb="VHVersioningNotEnabled";break;case 105:gb="VHFileNotFound";break;case 106:gb="VHVersionTooOld";break;default:gb="None"}Ec.kD.addEvent("OnFullAppError",gb);Qa.ULS.sendTraceTag(537150291,0,10,"FullApp Error Event: {0}",gb)};this.LAd=function(gb){Ec.FEe=gb;Qa.ULS.sendTraceTag(537150290,0,50,"VersionHistoryPaneActor:Show Changes toggled to:{0}",gb.toString());var Bb=
{};Ec.JMd(oc.a.jNb,(Bb.ToggleValue=gb,Bb))};this.Hxf=function(gb){Qa.ULS.sendTraceTag(50405840,0,50,"VersionHistoryPaneActor:OnIteratorSelected next: {0}",gb);Kb.c(1488635506,!0);var Bb={};gb?Ec.JMd(oc.a.iterateNext,Bb):Ec.JMd(oc.a.axa,Bb)};this.bHb=function(gb){switch(gb.MessageId){case ac.a.KTa:Qa.ULS.sendTraceTag(537150289,0,50,"VersionHistoryPaneActor.ReceivePostMessageFromVHSession WacAppCompleted ");nb.EwaSettings.ma(422)&&Ec.im.setVersionLoadComplete();break;case ac.a.LTa:Qa.ULS.sendTraceTag(51128035,
0,10,"VersionHistoryPaneActor.ReceivePostMessageFromVHSession WacAppFailed");break;case oc.a.setCurrentChangeCount:gb=gb.Values.count;Qa.ULS.sendTraceTag(537150288,0,50,"VersionHistoryPaneActor.ReceivePostMessageFromVHSession SetCurrentChangeCount : {0}",gb);Ec.im.setCurrentChangeCount(gb);break;case oc.a.setTotalChangesCount:gb=gb.Values.count;Qa.ULS.sendTraceTag(537150287,0,50,"VersionHistoryPaneActor.ReceivePostMessageFromVHSession SetTotalChangesCount : {0}",gb);Ec.im.setTotalChangesCount(gb);
break;case oc.a.AOa:Ec.LAd(Ec.FEe);break;default:Qa.ULS.sendTraceTag(537150286,0,15,"VersionHistoryPaneActor.ReceivePostMessageFromVHSession MessageID:{0}",gb.MessageId)}};this.$=dc;this.E8b=this.$.yb+Yb.mwh;this.gHd=!1;nb.EwaSettings.ma(388)&&this.A$g();this.fBb="";this.Jrd=0;this.perfTelemetryInfos=[]}function kb(){this.perfTelemetryInfos=this.appSettings=this.docId=this.latestStreamServiceBase=this.serviceBase=this.ulsLogger=null}function vb(){this.appName=0;this.wdEnableDownloadTokens=!1;this.retryCount=
0;this.wdEnableIterator=this.wdEnableRestore=this.wdEnableSaveACopy=!1;this.uiLocale=this.wacCluster=this.userSessionId=null;this.disableSaveACopy=this.wdEnableShowVersionChanges=this.wdEnableHiddenButtonsUntilVersionLoadComplete=this.viewerRootPositionRelative=this.useXhr=this.isRtl=!1;this.disabledChangeGates=null;this.wdEnableDeleteVersions=this.wdEnableSaveACopyOverFlowMenu=!1;this.wdExperimentWithIteratorLocation=this.wdEnableAppColorUpdate=null}function Wa(){this.telemetryCollector=this.baseVersionInfo=
this.selectedVersionInfo=null}function qb(){this.rootDiv=this.appBootSettings=null}function yb(){this.actionUrl=this.ulsLogger=null;this.useFetch=this.hideEmbedFooter=!1}function ec(dc){this.sw=dc}function Ob(dc){this.sw=dc}function Cb(dc){this.sw=dc}function ab(){}function ya(dc,Ec){this.$=dc;this.sVj=Ec}function ma(dc,Ec){var gb=Zb.call(this)||this;gb.activityName=dc;gb.kM=Ec;gb.Eb();return gb}function ha(dc,Ec){return Za.call(this,dc,Ec)||this}function Z(dc,Ec,gb){var Bb=Aa.call(this)||this;Bb.activityName=
dc;Bb.kM=Ec;Bb.FJ=gb;Bb.Eb();return Bb}function Na(dc,Ec,gb,Bb,qc){var Nc=ub.call(this,dc,Ec)||this;Nc.ki=null;Nc.retryCount=0;Nc.cQi=function(nd){var Vd=Nc.zMj(nd);nd=Vd.AKd;Vd.returnValue?nd.Success?(Kb.c(2138207060,!0),Qa.ULS.sendTraceTag(42287318,0,15,"RestoreVersionActivity:onRestoreSuccessCallback Restore version is successful")):(Kb.c(2138207060,!1),Qa.ULS.sendTraceTag(42287317,0,10,"RestoreVersionActivity:onRestoreSuccessCallback Restore version failed with message {0}",nd.Output),Nc.kh(Nc.FJ)):
(Kb.c(2138207060,!1),Nc.kh(Nc.FJ));(nd=Nc.ki.activityState[Na.Htd])&&nd();Nc.$o();Nc.ki.eM()};Nc.bQi=function(){if(0<Nc.retryCount)Qa.ULS.sendTraceTag(537150418,0,15,"RestoreVersionActivity:onRestoreFailureCallback Retrying version restore, retry count : {0}",Nc.retryCount),Nc.retryCount--,Nc.MSf();else{Qa.ULS.sendTraceTag(42287320,0,10,"RestoreVersionActivity:onRestoreFailureCallback Restore version failed");Kb.c(2138207060,!1);Nc.kh(Nc.FJ);var nd=Nc.ki.activityState[Na.Htd];nd&&nd();Nc.$o();Nc.ki.eM()}};
Nc.FJ=gb;Nc.S2=Bb;Nc.baseUrl=qc;return Nc}b.r(E);var eb=b(10),cb=b(0),Ua=b(4),pa=b(232),Qa=b(14),Db=b(115),Kb=b(187),Ab=b(41),ub=Db.a;Rk(Na,ub);Na.prototype.execute=function(dc){this.ki=dc;this.retryCount=3;this.MSf();return 1};Na.prototype.MSf=function(){var dc=this.ki.activityState[Na.rqc],Ec=this.ki.activityState[Na.Meg],gb=String.format("{0}{1}",this.baseUrl,"restoreversion.ashx");dc=Ab.c({VersionId:Ec,QuerySignature:dc});this.S2.Yl(gb,2,dc,{"Content-Type":"application/json; charset=utf-8"},!1,
2,this.cQi,this.bQi,null)};Na.prototype.zMj=function(dc){var Ec=null;dc=dc?dc.data?dc.data.Td:null:null;if(!dc||!dc.length)return Qa.ULS.sendTraceTag(537150417,0,10,"RestoreVersionActivity:TryGetRestoreResult data returned from restoreversion call is null or empty"),{returnValue:!1,AKd:Ec};dc=Ab.d(dc);Ec=dc.Lt;return dc.returnValue?{returnValue:!0,AKd:Ec}:(Qa.ULS.sendTraceTag(537150416,0,10,"RestoreVersionActivity:TryGetRestoreResult Failed in deserialization of returned data from restore version"),
{returnValue:!1,AKd:Ec})};Na.Meg="RVAvi";Na.rqc="RVAqs";Na.Htd="RVlvrt";Object(cb.a)(Na,"RestoreVersionActivity",Db.a,[]);var Mb=b(6),Aa=pa.a;Rk(Z,Aa);Z.prototype.create=function(){this.pb(new Na(this.activityName,this.kM,this.FJ,Ua.AFrameworkApplication.qd,Ua.AFrameworkApplication.ta.Qa.IV))};Z.ka=function(dc){dc.da.Ga(320,new Z(Mb.a.DKd,Mb.a.gj,Mb.a.EKd))};Object(cb.a)(Z,"RestoreVersionActivityFactory",pa.a,[]);var Za=Db.a;Rk(ha,Za);ha.prototype.execute=function(dc){var Ec=this;(0,dc.activityState[ha.h3f])(function(){Ec.$o();
dc.eM()});return 1};ha.h3f="RVEAssea";Object(cb.a)(ha,"RestoreVersionErrorActivity",Db.a,[]);var Zb=pa.a;Rk(ma,Zb);ma.prototype.create=function(){this.pb(new ha(this.activityName,this.kM))};ma.ka=function(dc){dc.da.Ga(321,new ma(Mb.a.EKd,Mb.a.gj))};Object(cb.a)(ma,"RestoreVersionErrorActivityFactory",pa.a,[]);var jb=b(81),Vb=b(905),Ic=b(51),Rb=b(37),kc=b(186),xb=b(390),Va=b(58);ya.prototype.Lc=function(){return Ua.AFrameworkApplication.fa.qa("IsAnonymousUser")?(Qa.ULS.sendTraceTag(537150415,0,15,
"Verison History Command Handler: Anonymous user."),!0):!1};ya.prototype.executeCommand=function(dc,Ec){Qa.ULS.sendTraceTag(537150414,0,50,"VersionHistoryCommandHandler:ExecuteCommand called.");dc=!1;switch(Ec.command){case -1112508866:xb.a(this.$)&&this.$.da.za(423).jxc(!1),dc=this.sVj.ZAj()}Qa.ULS.sendTraceTag(537150413,0,50,"VersionHistoryCommandHandler:ExecuteCommand response{0}.",dc);return dc?Va.Task.Ua(dc):kc.a(Ec.command)};ya.prototype.zc=function(dc,Ec){return-1112508866===Ec.command&&this.$.isVersionHistoryEnabled()};
ya.prototype.Qc=function(){return!1};Object(cb.a)(ya,"VersionHistoryCommandHandler",null,[429]);var tb=b(7),fb=b(260),ac=b(170),Ac=b(410);ab.addAppPLTEventToLog=function(dc){try{Microsoft.VersionHistory.VersionHistoryLogHelper.addAppPLTEventToLog(dc)}catch(Ec){}};ab.setIsPageLoadForFirstTime=function(dc){try{Microsoft.VersionHistory.VersionHistoryLogHelper.setIsPageLoadForFirstTime(dc)}catch(Ec){}};Object(cb.a)(ab,"VersionHistoryLogConnector",null,[]);var Rc=b(27),Fc=b(1030),wb=b(1442),uc=b(160),
Pb=b(91),sc=b(31),nb=b(1),pc=b(42),Dc=b(258),oc=b(1188),Gc=b(272),ld=b(253),gd=b(12);Cb.prototype.Lh=function(){Gc.a(this.sw.$).DM(this.Yd)||Gc.a(this.sw.$).Lh(this)};Cb.prototype.R7=function(){Gc.a(this.sw.$).DM(this.Yd)&&Gc.a(this.sw.$).Az(this)};Cb.prototype.$g=function(dc){return gd.DOMElementExtensions.nf(this.ic,dc)};Cb.prototype.ej=function(){this.sw.$.frame.xe.Gj(this.sw.$.frame.xe.uE)};Cb.prototype.Aj=function(){};Cb.prototype.Sf=function(dc,Ec){Ec||this.sw.FNb.then(function(gb){gb.enterHeaderFocusTrapZone();
return null});return!Ec};Mf.Object.defineProperties(Cb.prototype,{Yd:{configurable:!0,enumerable:!0,get:function(){return ld.a.Jeg}},ic:{configurable:!0,enumerable:!0,get:function(){return document.querySelector('[id="vhHeader"]')}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return!0}}});Object(cb.a)(Cb,"VersionHistoryHeader",null,[448]);Ob.prototype.Lh=function(){Gc.a(this.sw.$).DM(this.Yd)||Gc.a(this.sw.$).Lh(this)};Ob.prototype.R7=function(){Gc.a(this.sw.$).DM(this.Yd)&&Gc.a(this.sw.$).Az(this)};
Ob.prototype.$g=function(dc){return gd.DOMElementExtensions.nf(this.ic,dc)};Ob.prototype.ej=function(){this.sw.$.frame.xe.Gj(this.sw.$.frame.xe.uE)};Ob.prototype.Aj=function(){};Ob.prototype.Sf=function(dc,Ec){Ec||this.sw.FNb.then(function(gb){gb.enterFocusTrapZone();return null});return!Ec};Mf.Object.defineProperties(Ob.prototype,{Yd:{configurable:!0,enumerable:!0,get:function(){return ld.a.Keg}},ic:{configurable:!0,enumerable:!0,get:function(){return document.querySelector('[aria-describedby="versionHistoryPane"]')}},
canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return!0}}});Object(cb.a)(Ob,"VersionHistoryPane",null,[448]);ec.prototype.Lh=function(){Gc.a(this.sw.$).DM(this.Yd)||Gc.a(this.sw.$).Lh(this)};ec.prototype.R7=function(){Gc.a(this.sw.$).DM(this.Yd)&&Gc.a(this.sw.$).Az(this)};ec.prototype.$g=function(dc){return gd.DOMElementExtensions.nf(this.ic,dc)};ec.prototype.ej=function(){this.sw.$.frame.xe.Gj(this.sw.$.frame.xe.uE)};ec.prototype.Aj=function(){};ec.prototype.Sf=function(dc,Ec){Ec||
this.sw.FNb.then(function(gb){gb.enterViewerFocusTrapZone();return null});return!Ec};Mf.Object.defineProperties(ec.prototype,{Yd:{configurable:!0,enumerable:!0,get:function(){return ld.a.Leg}},ic:{configurable:!0,enumerable:!0,get:function(){return document.querySelector('[id="vhViewer"]')}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return!0}}});Object(cb.a)(ec,"VersionHistoryViewer",null,[448]);var Cc=b(147),kd=b(261),Fd=b(67),rb=b(446),Kd=b(973);Object(cb.a)(yb,"AppBootSettings",
null,[]);Object(cb.a)(qb,"AppVersionControllerFactoryParameters",null,[]);Object(cb.a)(Wa,"OnVersionSelectedParams",null,[]);Object(cb.a)(vb,"AppSettings",null,[]);Object(cb.a)(kb,"ControllerFactoryParameters",null,[]);Yb.prototype.dispose=function(){this.uxe()};Yb.prototype.VYi=function(){var dc=this;this.$.da.Za(15,function(Ec){dc.ewaAccessibilityManager=Ec;dc.ewaAccessibilityManager.mode=2})};Yb.prototype.A$g=function(){this.YYd=new Ob(this);this.XYd=new Cb(this);this.ZYd=new ec(this)};Yb.prototype.ZAj=
function(){var dc=this;Qa.ULS.sendTraceTag(41739649,0,15,"VersionHistoryPaneActor:ShowVersionHistoryDialogAction called");Ua.AFrameworkApplication.$M("Microsoft.Office.Excel.Server.Flighting.IDenyListExcelVersionHistoryEnableODCSaveACopy");Ua.AFrameworkApplication.$M("Microsoft.Office.Excel.Server.Flighting.IDenyListVersionHistorySaveACopyOverFlowMenu");Ua.AFrameworkApplication.$M("Microsoft.Office.Excel.Server.Flighting.IDenyListExcelVersionHistoryRestoreSkipCoauthCheck");this.kD=excelVersionHistory.FactoryGlobal.getTelemetryCollector();
this.perfTelemetryInfos=[];this.kD.startTimer(Yb.z8f);if(!this.im&&(rb.a(function(){dc.im=versionHistory.FactoryGlobal.getVersionHistoryControllerInstance(Object(tb.a)(new kb,{ulsLogger:new Ac.a,docId:Ua.AFrameworkApplication.Yi,appSettings:Object(tb.a)(new vb,{appName:120,userSessionId:Ua.AFrameworkApplication.userSessionId,wdEnableSaveACopy:nb.EwaSettings.ma(356),wdEnableDownloadTokens:nb.EwaSettings.ma(351),wacCluster:Ua.AFrameworkApplication.qd.qS,uiLocale:Ua.AFrameworkApplication.uiCulture||
"en-us",wdEnableRestore:nb.EwaSettings.ma(322)&&dc.$.isEditMode,wdEnableIterator:nb.EwaSettings.ma(319)&&nb.EwaSettings.ma(320),useXhr:!1,wdEnableHiddenButtonsUntilVersionLoadComplete:nb.EwaSettings.ma(422),disableSaveACopy:dc.K0f(),wdEnableShowVersionChanges:nb.EwaSettings.ma(319)&&nb.EwaSettings.ma(321),disabledChangeGates:dc.$.ya.VHSDisabledChangeGates,wdEnableSaveACopyOverFlowMenu:nb.EwaSettings.ma(543),isRtl:Ua.AFrameworkApplication.isRtl}),perfTelemetryInfos:dc.perfTelemetryInfos}))}),!this.im))return Qa.ULS.sendTraceTag(537150352,
0,10,"VersionHistoryPaneActor:ShowVersionHistoryDialogAction - VersionHistoryController should not be null"),Kb.c(429638140,!1),!1;this.$Aj();this.kD.endTimer(Yb.z8f);this.kD.startTimer(Yb.C8f);Qa.ULS.sendTraceTag(537150351,0,50,"VersionHistoryPaneActor:ShowVersionHistoryDialogAction Returned Success");Kb.c(429638140,!0);return!0};Yb.prototype.$Aj=function(){this.Pi();if(!document.getElementById(this.E8b)){var dc=document.createElement("div");dc.id=this.E8b;dc.style.width="100%";dc.style.zIndex="998";
dc.style.display="block";dc.style.position="absolute";Ua.AFrameworkApplication.ta.Qa.Of?(dc.style.top=document.getElementById("HeaderRegion").offsetHeight+"px",dc.style.bottom="0px"):dc.style.height="100%";this.$.Tq.insertBefore(dc,this.$.Tq.firstChild);this.FNb=this.im.createVersionHistoryDialog(dc)}document.getElementById(this.E8b).style.display="block";this.XGd();this.kD.startTimer(Yb.EUd);this.im.getVersions("")};Yb.prototype.XGd=function(){nb.EwaSettings.ma(388)&&(this.YYd.Lh(),this.XYd.Lh(),
this.ZYd.Lh(),this.VYi())};Yb.prototype.WWd=function(){nb.EwaSettings.ma(388)&&(this.YYd.R7(),this.XYd.R7(),this.ZYd.R7(),this.ewaAccessibilityManager&&(this.ewaAccessibilityManager.mode=0))};Yb.prototype.Pi=function(){this.im.getVersionsReadyEvent().addListener(this.gDf);this.im.getVersionSelectedEvent().addListener(this.onVersionSelected);this.im.getCloseSelectedEvent().addListener(this.fuf);this.im.getFullAppErrorEvent().addListener(this.nwf);this.im.getIteratorSelectedEvent().addListener(this.Hxf);
this.im.getShowVersionChangesToggledEvent().addListener(this.LAd);nb.EwaSettings.ma(351)&&(this.im.getDownloadTokenReadyEvent().addListener(this.evf),this.gHd=!0);nb.EwaSettings.ma(356)&&(this.im.getSaveACopySelectedEvent().addListener(this.OAf),this.im.getDownloadVersionSelectedEvent().addListener(this.fvf));nb.EwaSettings.ma(322)&&this.$.isEditMode&&(this.im.getRestoreVersionSelectedEvent().addListener(this.wAf),this.hHd=!0);this.Eoa&&this.Eoa.getAppErrorEvent().addListener(this.Lsf)};Yb.prototype.Tj=
function(){this.im.getVersionsReadyEvent().removeListener(this.gDf);this.im.getVersionSelectedEvent().removeListener(this.onVersionSelected);this.im.getCloseSelectedEvent().removeListener(this.fuf);this.im.getFullAppErrorEvent().removeListener(this.nwf);this.im.getIteratorSelectedEvent().removeListener(this.Hxf);this.im.getShowVersionChangesToggledEvent().removeListener(this.LAd);nb.EwaSettings.ma(356)&&(this.im.getSaveACopySelectedEvent().removeListener(this.OAf),this.im.getDownloadVersionSelectedEvent().removeListener(this.fvf));
this.gHd&&(this.im.getDownloadTokenReadyEvent().removeListener(this.evf),this.gHd=!1);this.hHd&&(this.im.getRestoreVersionSelectedEvent().removeListener(this.wAf),this.hHd=!1);this.Eoa&&this.Eoa.getAppErrorEvent().removeListener(this.Lsf)};Yb.prototype.Kxj=function(){var dc=!0;if(nb.EwaSettings.ma(605)&&!this.$.IQ)return Qa.ULS.sendTraceTag(537150350,0,15,"VersionHistoryPaneActor:ShouldTriggerRestore - Skipping coauth check with status "+this.$.ea.amIAlone.toString()),!0;if(!this.$.ea.amIAlone&&!nb.EwaSettings.ma(318)){this.xti();
this.im.setCoauthRestoreError();dc=!1;var Ec=new Pb.a(-729359593,0,this.$.Jc,0,null);this.$.Ka.Kb(Ec)}this.$.IQ&&(Qa.ULS.sendTraceTag(42522439,0,10,"VersionHistoryPaneActor:ShouldTriggerRestore - Restore failed, Unsaved changes present"),dc&&(dc=!1,this.YAj()));return dc};Yb.prototype.YAj=function(){var dc=sc.a.Xc(1,0,1878,1877,0,-1603358883,"RestoreVersionUnsavedChangesError");dc=this.dialog||new uc.ErrorDialog(this.$,dc);dc.initialize();dc.gf()};Yb.prototype.MUj=function(){Qa.ULS.sendTraceTag(537150343,
0,50,"VersionHistoryPaneActor:ValidateDiffDiffParameters called for BaseVersion{0}",this.baseVersionInfo?Yb.KE(this.baseVersionInfo):"");if(Yb.KE(this.k3)===this.SSe)return Qa.ULS.sendTraceTag(537150342,0,15,"VersionHistoryPaneActor:ValidateDiffDiffParameters for last version"),!0;if(nb.EwaSettings.isChangeGateEnabled("OfficeVSO:4381797_XLVHSkipBaseVersionValidateForGroupingUI")&&!this.baseVersionInfo&&this.Qqf)return Qa.ULS.sendTraceTag(537150341,0,50,"VersionHistoryPaneActor:ValidateDiffDiffParameters skipping diff last version"),
!0;if(!this.baseVersionInfo)return Qa.ULS.sendTraceTag(537150340,0,10,"VersionHistoryPaneActor:ValidateDiffDiffParameters for null BaseVersion"),!1;var dc=Yb.CMh(this.baseVersionInfo);Qa.ULS.sendTraceTag(537150339,0,50,"downloadURL length {0}",dc?dc.length:0);return dc?!0:(Qa.ULS.sendTraceTag(537150338,0,50,"VersionHistoryPaneActor:ValidateDiffDiffParameters downloadURL is null"),!1)};Yb.prototype.K0f=function(){return!this.$.ika};Yb.prototype.aZg=function(){document.getElementById(this.E8b).style.display=
"none";var dc=new Pb.a(-1423792966,0,this.$.Jc,0,null);this.$.Ka.Kb(dc);this.uxe()};Yb.prototype.uxe=function(){this.kD&&(this.kD.endTimer(Yb.C8f),this.Wve(this.kD),this.kD=null);this.Tj();this.WWd();this.perfTelemetryInfos&&(Qa.ULS.sendTraceTag(537150302,0,15,this.perfTelemetryInfos.toString()),this.perfTelemetryInfos=null);this.FB&&(this.FB.qoa(ac.a.KTa),this.FB.qoa(ac.a.LTa),this.FB.qoa(oc.a.setCurrentChangeCount),this.FB.qoa(oc.a.setTotalChangesCount),nb.EwaSettings.isChangeGateEnabled("OfficeVSO:4844740_ExcelVersionHistoryHighlightChangesFix")&&
this.FB.qoa(oc.a.AOa),this.FB.dispose(),this.FB=null)};Yb.prototype.Xej=function(dc){var Ec=this;try{this.Eoa?ab.setIsPageLoadForFirstTime(!1):(ab.setIsPageLoadForFirstTime(!0),rb.a(function(){var gb=new yb;gb.ulsLogger=new Ac.a;gb.actionUrl=Ec.$.ya.VersionHistoryActionUrl;gb.hideEmbedFooter=!0;gb.useFetch=nb.EwaSettings.ma(417)&&!Rc.a.Uu;Ec.Eoa=excelVersionHistory.FactoryGlobal.getAppVersionControllerInstance(Object(tb.a)(new qb,{appBootSettings:gb,rootDiv:dc}))}))}catch(gb){Qa.ULS.sendTraceTag(41239239,
0,10,"VersionHistoryPaneActor: ResetAppVersionController failed due to exception. {0}",gb)}};Yb.prototype.nMd=function(dc){Qa.ULS.sendTraceTag(537150298,0,50,"VersionHistoryPaneActor:SelectVersion called. for Version:{0}, LastSelected:{1}",Yb.KE(dc),this.fBb);if(dc)if(Yb.KE(dc).length){var Ec=(new Date).getTime();if(Yb.KE(dc)===this.fBb&&1E3>Ec-this.Jrd)Qa.ULS.sendTraceTag(537150295,0,50,"VersionHistoryPaneActor:SelectVersion reattempt within 1 sec");else{Yb.KE(dc)!==this.fBb&&(Qa.ULS.sendTraceTag(537150294,
0,50,"VersionHistoryPaneActor:Reset Iterator states if user clicks on different version"),this.im.setTotalChangesCount(-1),this.im.setCurrentChangeCount(-1));var gb=excelVersionHistory.FactoryGlobal.getTelemetryCollector();gb.addEvent("SelectVersion",Yb.KE(dc));try{this.qXj(gb);this.Jrd=Ec;this.fBb=Yb.KE(dc);var Bb=new Wa;Bb.selectedVersionInfo=this.k3;Bb.baseVersionInfo=this.baseVersionInfo;Bb.telemetryCollector=gb;this.Eoa.onVersionSelectedWithParams(Bb);this.im&&nb.EwaSettings.ma(356)&&this.im.setDisableSaveACopy(this.K0f());
var qc=document.getElementById(Yb.lwh);qc&&!this.FB&&(Qa.ULS.sendTraceTag(537150293,0,50,"VersionHistoryPaneActor: SelectVersion Lazy instantiate VersionHistoryMessenger"),this.FB=new oc.a(qc.contentWindow,jb.a.Oaa(this.$.ya.VersionHistoryActionUrl)||Kd.a.P9),this.FB.Ml(ac.a.KTa,this.bHb),this.FB.Ml(ac.a.LTa,this.bHb),this.FB.Tn(oc.a.setCurrentChangeCount),this.FB.Tn(oc.a.setTotalChangesCount),nb.EwaSettings.isChangeGateEnabled("OfficeVSO:4844740_ExcelVersionHistoryHighlightChangesFix")&&this.FB.Tn(oc.a.AOa),
this.FB.Ml(oc.a.setCurrentChangeCount,this.bHb),this.FB.Ml(oc.a.setTotalChangesCount,this.bHb),nb.EwaSettings.isChangeGateEnabled("OfficeVSO:4844740_ExcelVersionHistoryHighlightChangesFix")&&this.FB.Ml(oc.a.AOa,this.bHb))}catch(Nc){this.Jrd=0,this.fBb="",gb.addEvent("Exception",Nc.toString()),Qa.ULS.sendTraceTag(42016832,0,10,"VersionHistoryPaneActor: OnVersionSelected failed due to exception. {0}",Nc)}finally{Qa.ULS.sendTraceTag(537150292,0,50,gb?gb.getJsonForLogging():"")}}}else Qa.ULS.sendTraceTag(537150296,
0,50,"VersionHistoryPaneActor:SelectVersion selectedVersion RevisionId is null");else Qa.ULS.sendTraceTag(537150297,0,50,"VersionHistoryPaneActor:SelectVersion selectedVersion is null")};Yb.prototype.qXj=function(dc){for(var Ec=bk(this.perfTelemetryInfos),gb=Ec.next();!gb.done;gb=Ec.next()){var Bb=gb.value;gb=Bb.TelemetryEventKey?Bb.TelemetryEventKey:Bb.telemetryEventKey?Bb.telemetryEventKey:"";Bb=Bb.TelemetryEventData?Bb.TelemetryEventData:Bb.telemetryEventData?Bb.telemetryEventData:"";gb&&Bb&&dc.addEvent(gb,
Bb)}Array.clear(this.perfTelemetryInfos)};Yb.prototype.Wve=function(dc){Qa.ULS.sendTraceTag(42553886,0,15,"VersionHistoryPaneActor:CaptureSessionTelemetry - {0} ",dc?dc.getJsonForLogging():"")};Yb.prototype.xti=function(){for(var dc=this.$.ea.Bm,Ec={},gb=null,Bb=bk(dc),qc=Bb.next();!qc.done;qc=Bb.next())qc=qc.value,qc.UserEmail&&(Ec[qc.UserEmail]=qc.UserEmail in Ec?Ec[qc.UserEmail]+1:1),qc.User.UserID===this.$.ea.clientId&&(gb=qc.UserEmail);Qa.ULS.sendTraceTag(42522438,0,10,"VersionHistoryPaneActor:LogCoauthorsTelemetry Restore failed, TotalAuthors: {0}, TotalAuthorsAsYourself {1}",
dc.length,gb?Ec[gb]:-1)};Yb.prototype.JMd=function(dc,Ec){Qa.ULS.sendTraceTag(537150285,0,50,"VersionHistoryPaneActor.SendPostMessageToTheVHSession called with MessageID:{0}",dc);if(this.FB){dc=new Fc.a(dc);dc.Values[wb.a.U3c]=this.$.ya.UserSessionId;if(Ec)for(var gb in Ec)dc.Values[gb]=Ec[gb];this.FB.send(dc)}else Qa.ULS.sendTraceTag(537150284,0,10,"VersionHistoryPaneActor.SendPostMessageToTheVHSession versionHistoryMessenger is null")};Yb.KE=function(dc){return dc?dc.RevisionID?dc.RevisionID:dc.revisionID?
dc.revisionID:"":""};Yb.CMh=function(dc){return dc?dc.DownloadUrl?dc.DownloadUrl:dc.downloadUrl?dc.downloadUrl:"":""};Yb.mwh="_excelVersionHistoryOverlay";Yb.lwh="vhs_frame";Yb.z8f="TimeTakenShowVersionHistoryDialogAction";Yb.C8f="TimeTillVersionHistoryDialogWasOpenMs";Yb.EUd="TimeTakenGetVersionsToOnVersionsReady";Yb.s3g="CountOnVersionSelectedCalledinOneVHSession";Yb.t3g="CountOnVersionsReadyCalledinOneVHSession";Yb.r3g="CountOnDownloadTokenReadyCalledinOneVHSession";Yb.A8f="TimeTakenVersionRestore";
Object(cb.a)(Yb,"VersionHistoryPaneActor",null,[3]);var Qd=b(256),ve=Vb.a;Rk(Fb,ve);Fb.prototype.Ad=function(){var dc=this,Ec=this.Hsi(),gb=Ic.GetServiceTaskFactory.Ra(this.$.da,21,137,this.hb);Rb.TaskExtensions.Aa(Rb.TaskExtensions.Vd([Ec,gb],this.la,3),function(){var Bb=gb.result,qc=jb.a.Oaa(dc.$.ya.VersionHistoryActionUrl);qc!==Kd.a.P9&&Bb.rFa(qc);Bb=new Yb(dc.$);dc.jd([new ya(dc.$,Bb)])},this.la,3)};Fb.prototype.Hsi=function(){var dc=Ic.GetServiceTaskFactory.M3a(this.$.da,283,284,this.hb).then(function(Ec){return Ec.tn.loadScript("excelVersionHistory")},
function(Ec){Qa.ULS.sendTraceTag(537150412,0,10,"versionHistoryManagerFactory: Dynamic Script Loading failed due to exception. {0}",Ec);return Promise.reject(Ec)});return Qd.c(dc)};Fb.ka=function(dc){Vb.a.Qd(304,new Fb(dc))};Object(cb.a)(Fb,"VersionHistoryCommandHandlerFactory",Vb.a,[]);var Be=b(1460),Ie=b(911),se=pa.a;Rk(zb,se);zb.prototype.create=function(){var dc=this,Ec=Ic.GetServiceTaskFactory.Ra(this.$.da,211,212,this.hb),gb=Ic.GetServiceTaskFactory.Ra(this.$.da,21,137,this.hb);Rb.TaskExtensions.Aa(Rb.TaskExtensions.Vd([Ec,
gb],this.$.la),function(){var Bb=Object(Ie.a)(dc.$.da,305,function(){return new Be.a(dc.$,!0,gb.result,Ec.result)});dc.pb(Bb)},this.$.la,3)};zb.ka=function(dc){dc.da.Ga(306,new zb(dc))};Object(cb.a)(zb,"VersionHistoryHighlightManagerFactory",pa.a,[]);var Se=b(559),Le=b(5),rf=b(168),af=b(15),xe=Db.a;Rk(La,xe);La.prototype.execute=function(dc){this.lineageManager.lineageHidePreviousHistory();return xe.prototype.execute.call(this,dc)};Object(cb.a)(La,"LineageClearHistoryConfirmedActivity",Db.a,[]);var Td=
b(16),Bc=b(145);ib.prototype.Lc=function(){return!1};ib.prototype.executeCommand=function(dc,Ec,gb){dc=!1;switch(Ec.command){case 1834994092:9===Ec.Le&&this.pGj();this.yyj(Ec,gb);dc=!0;break;case -409942531:this.Ayj(),dc=!0}return dc?Va.Task.Ua(!0):kc.a(Ec.command)};ib.prototype.zc=function(dc,Ec){return 1834994092===Ec.command||-409942531===Ec.command};ib.prototype.Qc=function(){return!1};ib.prototype.yyj=function(dc,Ec){Qa.ULS.sendTraceTag(537155483,0,50,"LineageActivityCommandHandler::ShowChangesCore command location: {0}",
Ec.MenuItemId||dc.Le);this.lineageManager.F2f(19===dc.Le&&!!Ec.MenuItemId,Ec.MenuItemId,dc.Le)};ib.prototype.pGj=function(){var dc=Le.a.Iqc;dc!==rf.a(this.$).Ql.wB&&rf.a(this.$).Ql.activateRibbonTab(dc)};ib.prototype.Ayj=function(){var dc=this;pc.a(this.$).Zs(new Dc.a(Mb.a.qsd,5,function(){var Ec=Fd.a(dc.$).fd,gb=sc.a.Xc(3,1,2207,2208,2209,1038647878,"LineageConfirmClearHistory");gb.HelpTopicId="a1493bf9-25c3-470a-b970-60eceb0136e5";gb.HelpDescription=af.a.instance.ga(1300);Ec.yt([gb])}))};Object(cb.a)(ib,
"LineageActivityCommandHandler",null,[429]);var qd=Vb.a;Rk(ob,qd);ob.prototype.Ad=function(){var dc=this;Rb.TaskExtensions.Aa(Ic.GetServiceTaskFactory.Ra(this.$.da,366,367,this.hb),function(Ec){dc.jd([new ib(dc.$,Ec.result)])},this.la,3)};ob.ka=function(dc){Vb.a.Qd(363,new ob(dc))};Object(cb.a)(ob,"LineageActivityCommandHandlerFactory",Vb.a,[]);Ha.prototype.d6a=function(){return!this.idb};Ha.Maf=function(){return Ha.Eaf()&&nb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LineageCatchUpIntegrationTeachingUXTreatmentToControl",
!1)};Ha.Eaf=function(){return nb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LineageCatchUpIntegrationSummaryStringTreatment",!1)};Object(cb.a)(Ha,"LineageCatchUpExperimentManager",null,[890]);var Jd=pa.a;Rk(Ia,Jd);Ia.prototype.create=function(){var dc=this;Ha.Maf()?Rb.TaskExtensions.Aa(Ic.GetServiceTaskFactory.Ra(this.$.da,456,457,this.hb),function(Ec){Rb.TaskExtensions.Aa(Ec.result.Zwj(),function(gb){dc.xCe(gb.result)},dc.$.la,3)},this.$.la,3):this.xCe(!0)};Ia.prototype.xCe=function(dc){this.pb(this.$.da.za(458)||
this.$.da.Ga(458,new Ha(dc)))};Ia.ka=function(dc){dc.da.Ga(459,new Ia(dc))};Object(cb.a)(Ia,"LineageCatchUpExperimentManagerFactory",pa.a,[]);var ad=b(441),Yd=b(36),pe=b(275),Wd=b(83),bf=b(153),ke=b(124);Object(cb.a)(V,"LineageClientParams",null,[]);Object(cb.a)(sa,"LineageFilter",null,[]);var cf=b(64),Pe=b(76),nc=b(133),Da=b(45),Sb=b(564),hb=b(177),Xb=b(121),jc=b(110),Wc=b(295),fd=b(294),Tc=b(95),td=b(21),Tb=b(134),Fa=b(62),Qb=b(50),cc=b(355);Object(cb.a)(ia,"LineageActivitiesResponseDTO",null,[]);
Rk(na,ia);Object(cb.a)(na,"LineageActivitiesUpdateResponseDTO",ia,[]);Object(cb.a)(qa,"LineageAppCallbacks",null,[]);Object(cb.a)(da,"LineageAuthorDTO",null,[]);Object(cb.a)(xa,"LineageControllerFactoryParams",null,[]);Object(cb.a)(Ga,"LineageSharedRangeDTO",null,[]);Object(cb.a)(Ka,"LineageSheetMultiRangeDTO",null,[]);Object(cb.a)(db,"LineageUserActivityDTO",null,[]);Object(cb.a)(ra,"LineageValueChangeDTO",null,[]);oa.prototype.dispose=function(){this.D9i();this.$=null;this.lineageTaskPane&&(this.lineageTaskPane.QN(this.onPaneClosed),
this.lineageTaskPane.BF(this.uz),this.lineageTaskPane=null);this.wLb=this.kqc=this.ztb=this.psd=this.fF=null};oa.prototype.wzj=function(){return Object(pe.a)(this,void 0,void 0,function Ec(){var gb=this,Bb;return Km(Ec,function(qc){Bb=gb;return qc.return(new Promise(function(Nc){function nd(qe,ee,re){var Ze=Bb.$.oa.xa;qe=fd.b(qe,Vd);ee=fd.a(ee,oe);var mf=Ze.Na(1,null);return Fa.g(Ze,"LineageLoadInGridBlueDots",mf,qe,ee,re,null,0)}function Vd(qe){if(qe=Wc.a(qe)?null:qe.Result){var ee={};ee=(ee.CountOfActivities=
qe.ActivityList.length,ee);Tb.b(Bb.$).yd(nc.a.Iri,ee);qe=Bb.hqc(qe.ActivityList);Nc(qe)}else Qa.ULS.shipAssertTag(520717854,0,!!qe,"LineageManager LineageLoadInGridBlueDots returned null response.")}function oe(qe){qe=Xb.a.Mf(qe.data);Qa.ULS.sendTraceTag(520717856,0,50,"LineageManager::LineageLoadInGridBlueDots service call failed. Errors: [{0}]",sc.a.Ec(qe))}Qa.ULS.sendTraceTag(520717857,0,50,"LineageManager::showInGridBlueDots");Tb.b(Bb.$).yd(nc.a.lineageLoadInGridBlueDots,{});nb.EwaSettings.Zb()?
Bb.$.userOperationManager.Sb(new hb.a(1024,0,nd,80),null):Bb.$.userOperationManager.Sb(new Sb.a(1024,0,nd,16),null)}))})})};oa.prototype.F2f=function(dc,Ec,gb){if(this.lineageTaskPane.isVisible){if(9===gb){Qa.ULS.sendTraceTag(560989858,0,50,"LineageManager::ShowLineageTaskPane open from callout was invoked with an opened pane");return}if(!dc&&16!==gb&&18!==gb){this.lineageTaskPane.i0c();return}}Yd.a.ud(this.$)||(this.wLb.start(),this.r7&&(Qb.b().rA(this.wLb.id,this.r7.id,"actions","actions"),this.r7.stop(),
this.r7=null));this.lineageTaskPane.wgc||Qa.ULS.sendTraceTag(537155482,0,50,"LineageManager::ShowLineageTaskPane pane reopened by user via {0}",dc?Ec:gb);this.ND=this.$.ea.Ue;this.ztb=null;dc&&(dc=Da.r(this.gridView.ha.sa.selectedRanges,this.$),this.ztb=Object(tb.a)(new Ka,{rangeList:Ec.toString()===Le.a.Y1f?this.Nvb(dc.Ranges):null,sheetName:dc.SheetName}));Yd.a.ud(this.$)&&this.lineageTaskPane.wgc?this.lineageTaskPane.yqj(this.uEb):this.fF.createLineagePane(this.psd,this.ztb);this.lineageTaskPane.Zf(!0);
this.$.Fd(-71295319,-1,0,null)};oa.prototype.lineageHidePreviousHistory=function(){function dc(Bb,qc,Nc){var nd=Ec.$.oa.xa,Vd=nd.Na(1,null);return Fa.g(nd,"LineageHidePreviousHistory",Vd,Bb,qc,Nc,null,0)}var Ec=this,gb={};gb=(gb.paneVisible=this.lineageTaskPane.isVisible,gb);bf.a.sendTelemetryEvent(Object(tb.a)(new cc.a,{name:"Office.Excel.Online.Lineage.ClearHistoryConfirmed",dataFields:ke.a.Uk(gb)}));nb.EwaSettings.Zb()?this.$.userOperationManager.Sb(new hb.a(1018,0,dc,64),null):this.$.userOperationManager.Sb(new Sb.a(1018,
0,dc,0),null);this.lineageTaskPane.isVisible||this.F2f(!1,null,4)};oa.prototype.O$h=function(){var dc=this,Ec=Object(tb.a)(new qa,{tryParseRangeInfo:this.tryParseRangeInfo,isFeatureEnabled:this.isFeatureEnabled,onCardSelected:this.onCardSelected,onVersionHistoryButtonClicked:this.onVersionHistoryButtonClicked,onRangeFilterInputEnabled:this.onRangeFilterInputEnabled,onLearnMoreLinkClicked:this.onLearnMoreLinkClicked,lineageOpenPaneOrChangeFilterRequest:this.lineageOpenPaneOrChangeFilterRequest,lineageLoadMoreRequest:this.lineageLoadMoreRequest,
lineageRefreshViewRequest:this.lineageRefreshViewRequest,lineageUpdateViewRequest:this.lineageUpdateViewRequest});rb.a(function(){dc.fF=cellLineage.LineageActivityControllerFactoryGlobal.createLineageActivityController(Object(tb.a)(new xa,{clientBatchSize:dc.batchSize,filterableSheetList:dc.a4a(),uiCulture:dc.$.ya.UICultureTag,dataCulture:dc.$.ya.DataCultureTag,logger:new Ac.a,lineageAppCallbacks:Ec}))})};oa.prototype.ded=function(dc){var Ec=this;return function(gb){if(gb=Wc.a(gb)?null:gb.Result){var Bb=
{};Bb=(Bb.CountOfActivities=gb.ActivityList.length,Bb);Bb.WebRequestName=dc;Tb.b(Ec.$).yd(nc.a.WKi,Bb);gb=Object(tb.a)(new ia,{activityList:Ec.hqc(gb.ActivityList),latestActivityId:gb.LastSearchedActivityId,oldestActivityId:gb.FirstSearchedActivityId,serverMessageCode:gb.LineageResponseCode,lastSearchedActivityTimestamp:new Date(gb.EcmaLastSearchedDate),serverFirstActivityId:gb.ServerFirstActivityId,serverLastActivityId:gb.ServerLastActivityId,showLoadPrevious:gb.ShowLoadPrevious,eolCorrelationId:gb.EolCorrelationId,
eolDateHideHistory:new Date(gb.EolDateHideHistory),eolPersonHideHistory:Ec.Fvb(gb.EolPersonHideHistory)});Ec.fF.onLineageActivitiesResponse(gb)}else Qa.ULS.shipAssertTag(537155477,0,!!gb,"LineageManager."+dc+" returned null response.")}};oa.prototype.YKj=function(dc){return jc.e(dc.Ranges)&&!dc.SheetName?null:Object(tb.a)(new Ka,{rangeList:this.Nvb(dc.Ranges),sheetName:dc.SheetName})};oa.prototype.Nvb=function(dc){var Ec=[];dc=bk(dc);for(var gb=dc.next();!gb.done;gb=dc.next())gb=gb.value,gb=Object(tb.a)(new Ga,
{firstCol:gb.FirstColumn,firstRow:gb.FirstRow,lastRow:gb.LastRow,lastCol:gb.LastColumn}),Ec.push(gb);return Ec};oa.prototype.hLj=function(dc){if(!dc)return null;var Ec={};Ec.Ranges=this.dfd(dc.rangeList);Ec.SheetName=dc.sheetName;return Ec};oa.prototype.dfd=function(dc){var Ec=[];if(jc.e(dc))return Ec;dc=bk(dc);for(var gb=dc.next();!gb.done;gb=dc.next()){gb=gb.value;var Bb={};Bb.FirstColumn=gb.firstCol;Bb.FirstRow=gb.firstRow;Bb.LastRow=gb.lastRow;Bb.LastColumn=gb.lastCol;Ec.push(Bb)}return Ec};oa.prototype.h6h=
function(dc){(dc=this.$.va.getItemByName(dc))&&dc.visible&&dc.activate(!0)};oa.prototype.d7e=function(dc,Ec){var gb=[];Ec=bk(Ec);for(var Bb=Ec.next();!Bb.done;Bb=Ec.next()){Bb=Bb.value;var qc={};qc.FirstColumn=Bb.firstCol;qc.FirstRow=Bb.firstRow;qc.LastRow=Bb.lastRow;qc.LastColumn=Bb.lastCol;gb.push(Da.D(qc))}Ec=gb.length-1;Bb=gb[Ec].topLeft;td.g(this.$).aV(gb,Ec,dc,null,Bb,null,null,3,Tc.a.Jri,void 0,void 0,void 0,!0)};oa.prototype.I6i=function(){this.fF&&this.lineageTaskPane.isVisible&&(this.ND=
this.$.ea.Ue,this.fF.onRefreshRequired())};oa.prototype.yAg=function(){this.lineageTaskPane.RL(this.onPaneClosed);this.lineageTaskPane.VD(this.uz);this.$.ea.zu(this.Qf);this.$.ea.Vj(this.Uc);this.$.ea.QL(this.qo);var dc=this.$.va;dc.fY(this.TC);dc.Ega(this.Wnc);dc.yFa(this.xya);dc.qYa(this.Wnc)};oa.prototype.D9i=function(){this.$.ea.Bw(this.Qf);this.gridView.ha.sW(this.Rc);this.$.ea.wk(this.Uc);this.$.ea.yR(this.qo);var dc=this.$.va;dc.R6(this.TC);dc.Ima(this.Wnc);dc.TPa(this.xya);dc.ZHb(this.Wnc)};
oa.prototype.onStaleActivitiesDetected=function(){this.fF.onStaleActivitiesDetected()};oa.prototype.a4a=function(){for(var dc=[],Ec=bk(this.$.va.items),gb=Ec.next();!gb.done;gb=Ec.next())gb=gb.value,gb.visible&&!cf.e(gb)&&dc.push(gb.sheetName);return dc};oa.prototype.OAj=function(){if(nb.EwaSettings.ma(611)){var dc=this.$.da.za(403);dc&&dc.disable();dc=new Pb.a(-847286761,Pe.a.Cb,this.$.Jc,0,Le.a.lW);var Ec={};Ec=(Ec.InputMethod=Pe.a.Cb,Ec);Ec.CalloutName=5;this.$.Ka.Kb(dc,Ec)}};oa.prototype.hqc=
function(dc){var Ec=[];dc=bk(dc);for(var gb=dc.next();!gb.done;gb=dc.next())gb=gb.value,gb=Object(tb.a)(new db,{activityId:Number.parseLocale(gb.UserActivity.Id),activityGuid:gb.Uid,activityType:gb.UserActivity.Type,author:this.Fvb(gb.UserActivity.Person),sheetName:gb.SheetName,displayTimestamp:new Date(gb.UserActivity.DisplayTimestamp),gridLocation:gb.DisplayLocation,valueChanges:this.b1i(gb.LineageValueChangeList),isBulkEditOverflow:gb.IsBulkEditOverFlow,rangeHighlightLocation:this.R0i(gb.UserActivity.LocationList,
gb.UserActivity.Type),nestedActivityList:this.K0i(gb.NestedActivityList),degradedCardTypeBits:gb.DegradedCardTypeBits}),Ec.push(gb);return Ec};oa.prototype.R0i=function(dc,Ec){if(!dc)return Qa.ULS.sendTraceTag(537155468,0,15,"LineageManager:: RangeHighlightLocation.ActivityLocationList is null"),null;if(!dc.length)return Qa.ULS.sendTraceTag(537155467,0,50,"LineageManager:: RangeHighlightLocation.ActivityLocationList is empty"),null;var gb=[],Bb=[],qc="";21===Ec?Bb.push(dc[0]):Bb=dc;dc=bk(Bb);for(Bb=
dc.next();!Bb.done;Bb=dc.next())switch(Bb=Bb.value,Bb.Type){case 1:break;case 2:qc=Bb.SheetName;break;case 0:if(!Bb.RangeList){Qa.ULS.sendTraceTag(537155465,0,50,"LineageManager:: RangeHighlightLocation.RangeActivityLocation is null");break}qc=Bb.RangeList[0].SheetName;var Nc=[];21===Ec?Nc.push(Bb.RangeList[0]):Nc=Bb.RangeList;Bb=bk(Nc);for(Nc=Bb.next();!Nc.done;Nc=Bb.next())Nc=Nc.value,Nc=Object(tb.a)(new Ga,{firstCol:Nc.FirstColumn,firstRow:Nc.FirstRow,lastRow:Nc.LastRow,lastCol:Nc.LastColumn}),
gb.push(Nc);break;default:Qa.ULS.sendTraceTag(537155464,0,50,"LineageManager:: RangeHighlightLocation.ActivityLocationList is of type: ",Bb.Type)}return Object(tb.a)(new Ka,{sheetName:qc,rangeList:gb})};oa.prototype.b1i=function(dc){var Ec=[];dc=bk(dc);for(var gb=dc.next();!gb.done;gb=dc.next())gb=gb.value,gb=Object(tb.a)(new ra,{hasNewValue:gb.HasNewValue,hasOldValue:gb.HasOldValue,newValue:gb.HasNewValue?gb.NewValue:null,oldValue:gb.HasOldValue?gb.OldValue:null,cellLocation:gb.CellLocation}),Ec.push(gb);
return Ec};oa.prototype.K0i=function(dc){return dc?this.hqc(dc):null};oa.prototype.Fvb=function(dc){if(!dc)return null;var Ec=null;nb.EwaSettings.isChangeGateEnabled("OfficeVSO:4947893_ShowChangesUserProfilePictureSupportEnabled")&&Ua.AFrameworkApplication.fa.qa("IsUserProfilePictureResolutionEnabled")&&(Ec=this.kqc.CHa(dc.Email,dc.Provider,Ua.AFrameworkApplication.Yi,0));return Object(tb.a)(new da,{id:dc.Id,provider:dc.Provider,displayName:dc.DisplayName,email:dc.Email,imageUrl:Ec})};Object(cb.a)(oa,
"LineageManager",null,[878,879,3]);var bc=pa.a;Rk(ba,bc);ba.prototype.osi=function(dc){var Ec=this;Rb.TaskExtensions.Aa(dc,function(){Ec.pb(Ec.$.da.za(366)||new oa(Ec.$,Ec.$.da,Ec.lineageTaskPane,Ec.r7))},this.$.la,3)};ba.prototype.create=function(){var dc=this;this.r7=this.$.Fb.sc("UserAction","LineagePaneSeenStopwatch");this.r7.start();var Ec=Ic.GetServiceTaskFactory.Ra(this.$.da,365,364,this.hb),gb=ad.a(this.$),Bb=Ic.GetServiceTaskFactory.Ra(this.$.da,283,284,this.hb);Rb.TaskExtensions.Aa(Rb.TaskExtensions.Vd([Ec,
gb,Bb],this.$.la),function(){dc.lineageTaskPane=Ec.result;Yd.a.ud(dc.$)||gb.result.GQ(dc.lineageTaskPane);dc.osi(Qd.c(Bb.result.tn.loadScript("cellLineage")))},this.$.la,3)};ba.ka=function(dc){dc.da.Ga(367,new ba(dc))};Object(cb.a)(ba,"LineageManagerFactory",pa.a,[]);var Mc=b(1001),rd=b(233),Hd=b(13),ic=b(109),Jc=b(273),zd=b(86),sd=b(244),Pd=b(19),De=b(914),lc=b(70),Pc=Le.a.$yc+"LineageActivityPaneTitle",md=Le.a.Odb+"LineageActivityCloseButton",bd=sd.a;Rk(aa,bd);aa.prototype.kP=function(dc){this.get_events().addHandler("LineageTaskPaneRemove",
dc)};aa.prototype.zR=function(dc){this.get_events().removeHandler("LineageTaskPaneRemove",dc)};aa.prototype.VD=function(dc){this.addHandler("LineageTaskPaneVisibilityChanged",dc)};aa.prototype.BF=function(dc){this.removeHandler("LineageTaskPaneVisibilityChanged",dc)};aa.prototype.RL=function(dc){this.get_events().addHandler("LineageTaskPaneClose",dc)};aa.prototype.QN=function(dc){this.get_events().removeHandler("LineageTaskPaneClose",dc)};aa.prototype.qH=function(){};aa.prototype.Vo=function(){return this.lp};
aa.prototype.Nr=function(){return this.lp};aa.prototype.mR=function(){};aa.prototype.AQ=function(){return!1};aa.prototype.ej=function(){};aa.prototype.Aj=function(){};aa.prototype.dispose=function(){this.$&&(this.$.Ol(this.Fc),Gc.a(this.$).Az(this));this.de&&(rd.a.instance.Ba(Hd.a.click,this.de,this.Qj),ic.KeyInputManager.instance.pv(this.de,this.xye));this.de=this.taskPaneManager=this.$=null;bd.prototype.dispose.call(this)};aa.prototype.Sf=function(dc,Ec){if(!Ec){dc=gd.DOMElementExtensions.getElementById(this.domElement,
"LineagePaneFilterButton");if(!dc)return!1;gd.DOMElementExtensions.setFocus(dc)}return!Ec};aa.prototype.$g=function(dc){return gd.DOMElementExtensions.nf(this.ic,dc)};aa.prototype.Zf=function(dc){this.lp=dc;var Ec=this.taskPaneManager;if(this.isVisible=dc)this.$.frame.xe.Fj("LineagePane"),this.xod=!1;if(Yd.a.ud(this.$))dc?Ec.u6("LineageTaskPane",this.SF):Ec.hideTaskPane("LineageTaskPane");else{this.taskPaneManager.Kw();var gb=!!this.taskPaneManager.xg&&15===this.taskPaneManager.xg.taskPane.Ng;dc&&
0<Ec.Mz.length&&(!gb||Ec.isCollapsed)&&Ec.GF(this,!0)}this.$.hf()};aa.prototype.iM=function(){var dc=this.$.yb;dc=Yd.a.ud(this.$)?this.domElement:document.getElementById(dc+Le.a.tsd);var Ec=this.HG();dc.appendChild(Ec);Ec=De.b("div","LineagePaneBodyId","LineageActivityBody");dc.appendChild(Ec);this.zqj();return Ec};aa.prototype.i0c=function(){this.$.frame.xe.Fj(this.$.frame.xe.uE||Jc.AFrame.zT);this.xod=!0;this.Zf(!1);this.raiseEvent("LineageTaskPaneClose")};aa.prototype.yqj=function(dc){this.uEb=
dc};aa.prototype.zqj=function(){this.$.frame.xe.Gj("LineagePane");var dc=this.$.frame.xe.li("LineagePane");dc.parent=Jc.AFrame.zT;dc.YM=!0};aa.prototype.HG=function(){var dc=De.b("div","LineagePaneHeaderId","LineageActivityPaneHeader"),Ec=De.b("h1","LineagePaneTitleId",Pc);Ec.innerText=this.titleText;this.de=Mc.a.nb("LineagePaneCloseButtonId",md,af.a.instance.ga(10),"ClosePaneGlyph_16x16x32",!1);this.de.classList.add(Ua.AFrameworkApplication.isRtl?Le.a.vaa:Le.a.waa);rd.a.instance.ra(Hd.a.click,this.de,
this.Qj);this.xye=ic.KeyInputManager.instance.Xr(this.de,this.Qj,zd.a.Oh);dc.appendChild(Ec);dc.appendChild(this.de);return dc};aa.ka=function(dc,Ec){var gb=dc.yb,Bb=document.getElementById(gb+Le.a.tsd);Bb||(Bb=document.createElement("div"),Bb.id=dc.yb+Le.a.tsd,Bb.classList.add("LineageActivityPane"),Yd.a.ud(dc)||document.getElementById(gb+Le.a.gR).appendChild(Bb));return dc.da.za(365)||dc.da.Ga(365,new aa(Bb,dc,Ec))};Mf.Object.defineProperties(aa.prototype,{isVisible:{configurable:!0,enumerable:!0,
get:function(){return Object(lc.a)(aa.prototype,this,"isVisible")},set:function(dc){Object(lc.a)(aa.prototype,this,"isVisible")!==dc&&(Object(lc.b)(aa.prototype,this,"isVisible",dc),this.raiseEvent("LineageTaskPaneVisibilityChanged"))}},wgc:{configurable:!0,enumerable:!0,get:function(){return this.xod}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return this.isVisible}},Ng:{configurable:!0,enumerable:!0,get:function(){return 15}},Yd:{configurable:!0,enumerable:!0,get:function(){return ld.a.Kri}},
Jk:{configurable:!0,enumerable:!0,get:function(){return Pd.a.pth}},MM:{configurable:!0,enumerable:!0,get:function(){return af.a.instance.ga(1054)}},ko:{configurable:!0,enumerable:!0,get:function(){return 300}},isResizable:{configurable:!0,enumerable:!0,get:function(){return!1}},ic:{configurable:!0,enumerable:!0,get:function(){return this.domElement}},height:{configurable:!0,enumerable:!0,get:function(){return this.taskPaneManager.oO.offsetHeight}},titleText:{configurable:!0,enumerable:!0,get:function(){return af.a.instance.ga(1275)}},
SF:{configurable:!0,enumerable:!0,get:function(){var dc=this;return this.taskPaneManager.Cua(this.ic,this.titleText,this.ko,this.isResizable,function(){dc.isVisible=!0;dc.uEb?dc.uEb():Qa.ULS.shipAssertTag(537155462,0,!1,"OnLineagePaneOpened callback not set.")},function(){dc.isVisible=!1},function(){dc.isVisible=!0},function(){dc.isVisible=!1},this.ko)}}});Object(cb.a)(aa,"LineageTaskPane",sd.a,[811,3,494,448]);var Od=pa.a;Rk(Xa,Od);Xa.prototype.create=function(){var dc=this,Ec=Ic.GetServiceTaskFactory.create(this.$.da,
203,this.la,this.hb),gb=Ic.GetServiceTaskFactory.create(this.$.da,155,this.la,this.hb);Rb.TaskExtensions.Aa(Rb.TaskExtensions.ts(Rb.TaskExtensions.Vd([Ec,gb],this.la),function(){return dc.WC},this.la),function(){dc.pb(dc.Wg)},this.la,3)};Xa.prototype.dispose=function(){this.Wg=this.gi=this.$=null;Od.prototype.dispose.call(this)};Xa.ka=function(dc){dc.da.Ga(364,new Xa(dc))};Mf.Object.defineProperties(Xa.prototype,{WC:{configurable:!0,enumerable:!0,get:function(){var dc=this;this.gi||(this.gi=Rb.TaskExtensions.Aa(ad.a(this.$),
function(Ec){dc.Wg=aa.ka(dc.$,Ec.result)},this.la,3));return this.gi}}});Object(cb.a)(Xa,"LineageTaskPaneFactory",pa.a,[]);ua.prototype.dispose=function(){this.HHd();this.$=null;Qa.ULS.sendTraceTag(537155459,0,50,"LineageTeachingCalloutTriggerManager is disposed.")};ua.prototype.disable=function(){ua.Mwb||(ua.Mwb=!0,Qa.ULS.sendTraceTag(578557781,0,50,"LineageTeachingCalloutTriggerManager.Disable as the pane was opened."));this.HHd()};ua.prototype.lVj=function(){var dc=this;nb.EwaSettings.ma(607)&&
!this.$.isAnonymousUser()&&Fa.i(this.$.oa.xa,function(Ec){dc.$?(Ec=Ec.Result,Qa.ULS.sendTraceTag(578557780,0,50,"CheckLineageWywaChanges service call succeeded, hasnewchanges = {0}.",Ec),ua.v5e=!0,Ec&&dc.J9f(0)):Qa.ULS.sendTraceTag(537155458,0,50,"LineageTeachingCalloutTriggerManager.VerifyWaterlineTrigger ignoring server response as class is disposed.")},function(){Qa.ULS.sendTraceTag(537155457,0,10,"CheckLineageWywaChanges service call failed.")},null,null)};ua.prototype.fVj=function(){nb.EwaSettings.ma(606)&&
!this.T9f()&&(this.$.ea.zu(this.Qf),this.$od=!0)};ua.prototype.T9f=function(){return this.$.ea&&this.$.ea.ho&&this.$.ea.ho.ShouldTriggerLineageCalloutOnMerge?(Qa.ULS.sendTraceTag(578557778,0,50,"LineageTeachingCalloutTriggerManager.TriggerLineageCalloutOnMerge"),this.J9f(1),!0):!1};ua.prototype.J9f=function(dc){if(ua.Mwb)Qa.ULS.sendTraceTag(537155456,0,50,"LineageTeachingCalloutTriggerManager.TriggerCallout Will not trigger dialog as it was already shown in session");else if(ua.Mwb=!0,Qa.ULS.sendTraceTag(578557776,
0,50,"LineageTeachingCalloutTriggerManager.TriggerCallout triggering callout due to reason {0}.",dc),this.HHd(),nb.EwaSettings.ma(482)){dc=new Pb.a(-847286761,Pe.a.Cb,this.$.Jc,0,Le.a.lW);var Ec={};Ec=(Ec.CalloutName=4,Ec);this.$.Ka.Kb(dc,Ec)}};ua.prototype.HHd=function(){this.$od&&(this.$od=!1,this.$.ea.Bw(this.Qf))};ua.Mwb=!1;ua.v5e=!1;Object(cb.a)(ua,"LineageTeachingCalloutTriggerManager",null,[812,3]);var le=pa.a;Rk(va,le);va.prototype.create=function(){var dc=this;Rb.TaskExtensions.Aa(Ic.GetServiceTaskFactory.Ra(this.$.da,
458,459,this.hb),function(Ec){var gb=Ec.result;Ec=Object(Ie.b)(dc.$.da,458,function(){return new ua(dc.$,gb)});dc.pb(Ec)},this.$.la,3)};va.ka=function(dc){dc.da.Ga(402,new va(dc))};Object(cb.a)(va,"LineageTeachingCalloutTriggerManagerFactory",pa.a,[]);var dd=pa.a;Rk(ja,dd);ja.prototype.create=function(){var dc=this;Rb.TaskExtensions.Aa(Ic.GetServiceTaskFactory.Ra(this.$.da,366,367,0),function(Ec){dc.pb(Ec.result)},this.$.la,3)};ja.ka=function(dc){dc.da.Ga(500,new ja(dc))};Object(cb.a)(ja,"LineageBlueDotManagerFactory",
pa.a,[]);var Zd=b(1084),je=b(77);X.prototype.OW=function(dc,Ec,gb,Bb){var qc=this;return this.Hgh(dc,void 0===Bb?null:Bb,function(Nc){return qc.Og.SYb(Nc,2,gb,Ec,void 0,void 0,void 0,void 0,void 0,"2")})};X.prototype.Hgh=function(dc,Ec,gb){var Bb=this,qc=!!Ec&&""!==Ec,Nc=dc;qc&&(Nc=jb.a.sT(dc,"perfTag",Ec));var nd=new Date;return Zd.a.then(gb(Nc),function(Vd){var oe=+new Date-+nd;if(!Vd||!Vd.Rg||!Vd.Rg.data)return Vd;qc&&Vd.Rg.data.request&&Bb.rmj(Vd.Rg.data.request.getResolvedUrl(),Ec,oe);return Vd})};
X.prototype.rmj=function(dc,Ec,gb){dc=this.vu.qVh(dc);if(dc.count&&(dc=je.last(dc))){var Bb={Message:"Request durations for activities calls."};Bb.PerfTag=Ec;Bb.CustomDuration=gb;Bb.PerformanceDuration=dc.duration;Qa.ULS.sendTraceTag(592189641,3012,50,JSON.stringify(Bb))}};Object(cb.a)(X,"CatchUpNetworkingWrapper",null,[356]);var Ke=b(250),lf=Ke.a;Rk(wa,lf);wa.prototype.Eaa=function(){return 6};Object(cb.a)(wa,"GetActivityFeedRequest",Ke.a,[]);var nf=Ke.a;Rk(ea,nf);ea.prototype.Eaa=function(){return 7};
Object(cb.a)(ea,"UpdateActivityFeedStateRequest",Ke.a,[]);var me=b(411);ca.prototype.getActivityFeed=function(dc){var Ec=this;return Zd.a.then(this.ECa.execute(new wa(this.nCa(),null),function(gb,Bb,qc){return Ec.Jae.OW(gb,Bb,qc,"ActivityFeed")},dc),function(gb){if(!gb)return Qa.ULS.sendTraceTag(572846937,3012,10,"GetActivityFeed: Response is null"),null;if(!gb.Rg)return Qa.ULS.sendTraceTag(572846938,3012,10,"GetActivityFeed: Response.Args is null"),null;if(!gb.Rg.data)return Qa.ULS.sendTraceTag(572846939,
3012,10,"GetActivityFeed: Response.Args.Data is null"),null;if(!gb.Rg.data.Td)return Qa.ULS.sendTraceTag(572846940,3012,10,"GetActivityFeed: Response.Args.Data.ResponseData is null"),null;gb=me.a.$Ha(gb.Rg.data.Td);return gb?gb:(Qa.ULS.sendTraceTag(572846941,3012,10,"GetActivityFeed: Deserialized response is null"),null)})};ca.prototype.oPj=function(dc,Ec,gb,Bb){var qc=this;return Zd.a.then(this.ECa.execute(new ea(this.nCa(),null,dc,Ec,gb,Bb),function(Nc,nd,Vd){return qc.Jae.OW(Nc,nd,Vd,"UpdateActivityFeedState")},
null),function(Nc){try{return Nc.succeeded}catch(nd){return Qa.ULS.sendTraceTag(523121054,3012,10,"UpdateActivityFeed: Exception: "+nd.message),!1}})};Object(cb.a)(ca,"CatchUpRequestHandler",null,[370]);var $e=b(519);fa.prototype.vti=function(){this.hui()};fa.prototype.hui=function(){var dc=this;this.Zfa?this.Zfa.execute(function(Ec){window.setTimeout(function(){dc.w$d.contains("CatchUpChangesFeedback")||(dc.w$d.add("CatchUpChangesFeedback"),Ec.logActivity("CatchUpChangesFeedback",null))},2E4)}):
Qa.ULS.sendTraceTag(571586199,383,15,"FloodgateEventLogger: IFuture<ISystemInitiatedFeedback> was null")};Object(cb.a)(fa,"FloodgateEventLogger",null,[]);var we=b(202);Mf.Object.defineProperties(R.prototype,{duration:{configurable:!0,enumerable:!0,get:function(){return this.jtg.duration}}});Object(cb.a)(R,"PerformanceResourceTimingWrapper",null,[]);ka.prototype.qVh=function(dc){var Ec=new we.a;if(!this.vu)return Ec;dc=this.vu.getEntriesByName(dc,"resource");if(!dc)return Ec;dc=bk(dc);for(var gb=dc.next();!gb.done;gb=
dc.next())Ec.add(new R(gb.value));return Ec};Object(cb.a)(ka,"PerformanceWrapper",null,[]);var Ya=b(254);P.prototype.Ph=function(dc){var Ec=this;this.fb=dc;this.fb.register(X,"Common.App.CatchUpActivity.CatchUpNetworkingWrapper").as("Common.App.CatchUpActivity.ICatchUpNetworkingWrapper").tc().Cc(function(){return new X(Ua.AFrameworkApplication.qd,new ka(window.performance))});this.fb.register(ca,"Common.App.CatchUpActivity.CatchUpRequestHandler").as("Common.App.CatchUpActivity.ICatchUpRequestHandler").tc().Cc(function(){return new ca(Ec.fb.resolve("Common.App.CatchUpActivity.ICatchUpNetworkingWrapper"),
function(){return Ua.AFrameworkApplication.Yi},new me.a)});this.fb.register(fa,"Common.App.CatchUpActivity.FloodgateEventLogger").tc().Cc(function(){return new fa(Ec.fb.Tb("Common.ISystemInitiatedFeedback"))})};P.prototype.init=function(){this.fb.resolve("Common.App.CatchUpActivity.ICatchUpNetworkingWrapper");this.fb.resolve("Common.App.CatchUpActivity.ICatchUpRequestHandler")};P.prototype.dispose=function(){};P.main=function(){Ya.a.instance.Qi(new P)};Mf.Object.defineProperties(P.prototype,{name:{configurable:!0,
enumerable:!0,get:function(){return"Common.App.CatchUpActivity"}}});Object(cb.a)(P,"CatchUpActivityPackage",null,[10,11]);Q.prototype.Lc=function(dc,Ec){return this.catchUpActivityManager?-876699925===Ec?!this.catchUpActivityManager.Daf:!1:!0};Q.prototype.executeCommand=function(dc,Ec){dc=!1;switch(Ec.command){case -876699925:dc=this.catchUpActivityManager.MSi()}return dc?Va.Task.Ua(!0):kc.a(Ec.command)};Q.prototype.zc=function(dc,Ec){return nb.EwaSettings.ma(437)&&-876699925===Ec.command?!0:!1};
Q.prototype.Qc=function(){return!1};Object(cb.a)(Q,"CatchUpActivityCommandHandler",null,[429]);var h=Vb.a;Rk(C,h);C.prototype.Ad=function(){var dc=this;this.$.da.Za(286,function(Ec){dc.jd([new Q(dc.$,Ec)])})};C.ka=function(dc){Vb.a.Qd(285,new C(dc))};Object(cb.a)(C,"CatchUpActivityCommandHandlerFactory",Vb.a,[]);var lb=b(276),Ub=b(567),zc=b(89),vc=b(85),ud=b(25);M.prototype.doesContentExist=function(dc){if(!dc)return Qa.ULS.sendTraceTag(537168066,3012,10,"Null activity: DoesContentExist. Default to false."),
!1;switch(dc.type){case 2:case 3:case 4:case 6:case 8:case 9:case 7:case 10:if(!dc.navigationId)return Qa.ULS.sendTraceTag(537168065,3012,10,"Null activity.NavigationId: DoesContentExist. Default to false."),!1;var Ec={};Ec.NavigationId=atob(dc.navigationId);return 32===this.oi.$d(ud.a.nIa,2,Ec);default:return!1}};Object(cb.a)(M,"CatchUpActivityContentManager",null,[882]);var Gd=b(1031),od=b(1439);N.prototype.dispose=function(){this.Qu.UOf(this.qEb);this.ez=null};N.prototype.Ypj=function(dc){this.ez.push(dc)};
N.prototype.$Xg=function(){Array.clear(this.ez)};N.prototype.Q2f=function(dc){for(var Ec=bk(this.ez),gb=Ec.next();!gb.done;gb=Ec.next())gb=gb.value,gb.className=Gd.a.PUg,gb=document.getElementById(String.format("{0}-{1}",gb.id,Le.a.awe)),gd.DOMElementExtensions.setVisible(gb,dc)};N.prototype.GLb=function(dc){for(var Ec=bk(this.ez),gb=Ec.next();!gb.done;gb=Ec.next())if(gb=gb.value)dc?gb.className=2===this.Qu.model.state?Gd.a.R3i:Gd.a.S3i:this.Q2f(!1)};Mf.Object.defineProperties(N.prototype,{Qu:{configurable:!0,
enumerable:!0,get:function(){return this.rpg}}});Object(cb.a)(N,"RangeCatchUpActivityView",null,[919,3]);var Ae=b(22),Ne=od.a;Rk(K,Ne);K.prototype.dispose=function(){this.gridView=null;Ne.prototype.dispose.call(this)};K.prototype.YCg=function(dc){var Ec=this.ofb[0];Ec?Ec.Ypj(dc):Qa.ULS.shipAssertTag(537168004,0,!1,"RangeCatchUpActivityHighlightController.AddViewElement - RangeCatchUpActivityView is null for activityId"+this.vma.activityId)};K.prototype.Jfj=function(){var dc=this.ofb[0];dc&&dc.$Xg()};
K.prototype.jBg=function(dc){this.vma.addRange(dc)};K.prototype.vKh=function(){if(3!==this.vma.activityType)return null;Qa.ULS.shipAssertTag(537168003,0,1===this.vma.dMb.length,"RangeCatchUpActivityHighlightController::GetCommentActivityRange Range Information Length should be 1.");return Da.D(this.vma.dMb[0])};K.prototype.IJb=function(dc){if(dc){if(!this.vma)return;this.rwd(this.Rgj())}Ne.prototype.IJb.call(this,dc)};K.prototype.G3c=function(){var dc=this.m3c();this.ofb.push(dc)};K.prototype.m3c=
function(){return new N(this)};K.prototype.rwd=function(dc){dc?dc.SheetName?(this.gridView.ha.Oa.NG(null),this.gridView.focus(),this.gridView.w3e(dc,3,!1,Tc.a.Q3i)):Qa.ULS.shipAssertTag(537168E3,0,!1,"RangeCatchUpActivityHighlightController.NavigateToRange: SheetName in the range is null."):Qa.ULS.shipAssertTag(537168001,0,!1,"RangeCatchUpActivityHighlightController.NavigateToRange: Range is null. Either the location list is empty or sheet is hidden.")};K.prototype.Rgj=function(){if(jc.e(this.vma.dMb))return Qa.ULS.shipAssertTag(537167971,
0,!1,"RangeCatchUpActivityHighlightController.RetrieveRangeInformationForNavigation : SortedRanges is either null or empty."),null;var dc=this.$.va.pa;Qa.ULS.shipAssertTag(537167970,0,!!dc,"RangeCatchUpActivityHighlightController.RetrieveRangeInformationForNavigation : currentSheet is null.");dc=this.iMj(dc.sheetName,this.vma.dMb);if(!dc&&(dc=this.b_h(this.vma.dMb),!dc))return null;var Ec={};Ec.SheetName=dc.SheetName;Ec.FirstColumn=dc.FirstColumn;Ec.FirstRow=dc.FirstRow;Ec.LastColumn=dc.FirstColumn;
Ec.LastRow=dc.FirstRow;return Ec};K.prototype.b_h=function(dc){if(jc.e(dc))return null;for(var Ec=null,gb=0;gb<dc.length;gb++){var Bb=dc[gb].SheetName;if(!Ae.a.equals(Bb,Ec,!1)&&(Ec=Bb,Bb=this.$.va.getItemByName(Bb),null===Bb||void 0===Bb?0:Bb.visible))return dc[gb]}return null};K.prototype.iMj=function(dc,Ec){if(Ec){Ec=bk(Ec);for(var gb=Ec.next();!gb.done;gb=Ec.next())if(gb=gb.value,Ae.a.equals(gb.SheetName,dc,!1))return gb}return null};Object(cb.a)(K,"RangeCatchUpActivityHighlightController",od.a,
[]);var gf=b(79),Ja=gf.a;Rk(H,Ja);H.prototype.dispose=function(){this.q0d=null;Ja.prototype.dispose.call(this)};Mf.Object.defineProperties(H.prototype,{type:{configurable:!0,enumerable:!0,get:function(){return this.UB}},activityId:{configurable:!0,enumerable:!0,get:function(){return this.q0d}},activityType:{configurable:!0,enumerable:!0,get:function(){return this.yjg}}});Object(cb.a)(H,"CatchUpActivityHighlightModelBase",gf.a,[]);Rk(J,H);J.prototype.addRange=function(dc){dc=bk(dc);for(var Ec=dc.next();!Ec.done;Ec=
dc.next())this.ranges.push(Ec.value)};J.prototype.dispose=function(){this.ranges=null;H.prototype.dispose.call(this)};J.X2b=function(dc,Ec){if(!dc.SheetName||!Ec.SheetName)return Qa.ULS.shipAssertTag(537167969,0,!1,"RangeCatchUpActivityHighlightModel.CompareSharedSheetRange : SheetName is null."),0;var gb=dc.SheetName.localeCompare(Ec.SheetName);return gb?gb:dc.FirstColumn<Ec.FirstColumn||dc.FirstColumn===Ec.FirstColumn&&dc.FirstRow<Ec.FirstRow?-1:dc.FirstColumn===Ec.FirstColumn&&dc.FirstRow===Ec.FirstRow?
0:1};Mf.Object.defineProperties(J.prototype,{dMb:{configurable:!0,enumerable:!0,get:function(){this.O6a||(this.ranges.sort(J.X2b),this.O6a=!0);return this.ranges}}});Object(cb.a)(J,"RangeCatchUpActivityHighlightModel",H,[]);var Lb=b(354);U.prototype.dispose=function(){this.wje=this.ZKb=this.f1c=null};U.prototype.Lcj=function(dc){td.g(dc).qb.qn([24])};U.prototype.c5g=function(dc,Ec,gb){var Bb={};Ec=bk(Ec);for(var qc=Ec.next();!qc.done;qc=Ec.next())if((qc=qc.value)&&!jc.e(qc.LocationList)){for(var Nc=
[],nd={},Vd=[],oe=bk(qc.LocationList),qe=oe.next();!qe.done;qe=oe.next()){qe=qe.value;if(!qe){Qa.ULS.shipAssertTag(537168013,0,!1,"CatchUpActivityHighlightManagerHelper.CreateControllersAndHighlights - Location is Null for activityId : "+qc.Id);break}switch(qe.Type){case 0:var ee=qe;"0"in nd?(qe=nd["0"],qe.jBg(ee.RangeList)):(qe=new K(dc,new J(dc,qc.Id,qc.Type,0,ee.RangeList),gb),Nc.push(qe),nd["0"]=qe);ee=bk(ee.RangeList);for(var re=ee.next();!re.done;re=ee.next()){re=re.value;re=new Lb.a(Da.D(re),
cf.d(dc.va.getItemByName(re.SheetName)));if(this.fwc(re)in this.ZKb)this.ZKb[this.fwc(re)].push(qe);else{var Ze=[];Ze.push(qe);this.ZKb[this.fwc(re)]=Ze}Vd.push(re);this.f1c.push(re)}break;default:Qa.ULS.sendTraceTag(537168012,0,10,"CatchUpHighlightControllersCreator.CreateControllersAndHighlights(): Failed.Invalid ActivityLocationType")}}Qa.ULS.shipAssertTag(537168011,0,!(qc.Id in Bb),"CatchUpHighlightControllersCreator.CreateAndUpdateControllers - highlightControllers already has activity: "+qc.Id);
this.wje[qc.Id]=Vd;Bb[qc.Id]=Nc}this.x6g(dc,this.f1c,this.ZKb);return Bb};U.prototype.SXg=function(dc){for(var Ec in dc)for(var gb=bk(dc[Ec]),Bb=gb.next();!Bb.done;Bb=gb.next())Bb.value.Jfj()};U.prototype.fwc=function(dc){return String.format("{0}-{1}",dc.range,dc.sheetId)};U.prototype.x6g=function(dc,Ec,gb){var Bb=this;this.SXg(gb);td.g(dc).qb.Fw(Ec,[24],!0,function(qc,Nc){var nd=new Lb.a(qc.range,qc.sheetId);nd=Bb.fwc(nd);var Vd=gb[nd];if(Vd)for(nd=bk(Vd),Vd=nd.next();!Vd.done;Vd=nd.next())Vd=Vd.value,
Vd.YCg(Nc),qc.metadata=Vd;else Qa.ULS.shipAssertTag(537168010,0,!1,"CatchUpHighlightControllersCreator.CreateHighlightsAndUpdateControllers(), Missing Controller for SheetRangeKey "+nd)})};Object(cb.a)(U,"CatchUpHighlightControllersCreator",null,[]);Object(cb.a)(O,"CreateIndicatorTooltipParameters",null,[]);Object(cb.a)(T,"DismissIndicatorTooltipParameters",null,[]);Object(cb.a)(G,"UpdateIndicatorTooltipParameters",null,[]);F.prototype.dispose=function(){this.ha.Yrc(this.Il);this.ha.zF(this.Rc);this.gridView.yF(this.ap);
this.Ya.vk(this.Dh);this.qGe();this.fad=this.Mja=this.Idc=this.KQa=this.Ya=this.ha=this.gridView=null};F.prototype.Enj=function(dc){this.qGe();if(!jc.e(dc)){Qa.ULS.sendTraceTag(537168035,0,50,"In CatchUpActivityHighlightManager:ProcessActivityPayloadHighlights().");if(this.v4=this.H3b.c5g(this.$,dc,this)){dc=this.v4;for(var Ec in dc)for(var gb=bk(dc[Ec]),Bb=gb.next();!Bb.done;Bb=gb.next())this.vLg(Bb.value)}this.H3b.Lcj(this.$)}};F.prototype.ixc=function(dc){if(dc&&this.Wid)Qa.ULS.shipAssertTag(537168034,
0,!1,"CatchUpActivityHighlightManager.ShowOrHideAllHighlights - Trying to show all highlights when marked as read");else if(dc||this.Wrb(),this.v4){var Ec=this.v4,gb;for(gb in Ec)for(var Bb=bk(Ec[gb]),qc=Bb.next();!qc.done;qc=Bb.next())qc.value.Wzj(dc)}};F.prototype.g6h=function(dc){this.Mja&&this.s6b(!0);this.j5c();if(dc=this.v4[dc.activityId]){dc=bk(dc);for(var Ec=dc.next();!Ec.done;Ec=dc.next())Ec.value.IJb(!0)}else Qa.ULS.sendTraceTag(537168032,0,50,"CatchUpActivityHighlightManager.OnSelectHighlight - Controllers not found during select")};
F.prototype.qGe=function(){if(this.v4){var dc=this.v4,Ec;for(Ec in dc)for(var gb=bk(dc[Ec]),Bb=gb.next();!Bb.done;Bb=gb.next())Bb=Bb.value,this.E9i(Bb),Bb.dispose()}this.v4={};this.H3b.dispose();this.H3b=null};F.prototype.Byj=function(){if(this.excelCommentManager){var dc=this.v4[this.KQa];dc&&0<dc.length&&3===dc[0].model.activityType&&((dc=dc[0])?this.excelCommentManager.czj(dc.vKh()):Qa.ULS.shipAssertTag(537168029,0,!1,"RangeCatchUpActivityHighlightController::ShowCommentFlyoutOnSelectedActivity RangeController is Null."))}};
F.prototype.w5h=function(){this.excelCommentManager&&this.excelCommentManager.Rsb()};F.prototype.j5c=function(){if(this.KQa){var dc=this.v4[this.KQa];if(dc){dc=bk(dc);for(var Ec=dc.next();!Ec.done;Ec=dc.next())Ec.value.IJb(!1);this.KQa=null}else Qa.ULS.sendTraceTag(537168028,0,50,"CatchUpActivityHighlightManager.DeselectCurrentlySelected - Controllers not found for deselection")}};F.prototype.Wrb=function(){this.j5c();this.s6b(!0)};F.prototype.xMj=function(dc){if(!dc)return Qa.ULS.shipAssertTag(537168026,
0,!1,"CatchUpActivityHighlightManager::TryGetFlyoutContainer HighlightDot is null."),null;dc=String.format("{0}-{1}",dc.id,Le.a.NUg);var Ec=this.fad[dc];if(!Ec){if(!this.gridView.domElement)return Qa.ULS.shipAssertTag(537168025,0,!1,"CatchUpActivityHighlightManager::TryGetFlyoutContainer gridView.DOMElement is null."),null;Ec=document.createElement("Div");Ec.className=Gd.a.OUg;Ec.id=dc;this.gridView.domElement.appendChild(Ec);this.fad[dc]=Ec}return Ec};F.prototype.s6b=function(dc){this.Iea&&(this.Iea.dismissActivityIndicatorTooltips(Object(tb.a)(new T,
{clearSticky:dc})),this.Idc=null,dc&&(this.Mja=null),this.bgc&&!this.Mja&&(this.gridView.view.Fq(this.HAc),this.gridView.jy(this.HAc),this.bgc=!1))};F.prototype.vLg=function(dc){dc.Sle(this.qEb);dc.ADg(this.P1f);dc.zDg(this.iHe)};F.prototype.E9i=function(dc){dc.UOf(this.qEb);dc.K$i(this.P1f);dc.J$i(this.iHe)};Mf.Object.defineProperties(F.prototype,{szg:{configurable:!0,enumerable:!0,get:function(){return this.Iea},set:function(dc){this.Iea=dc}},excelCommentManager:{configurable:!0,enumerable:!0,get:function(){this.bDa||
(this.bDa=this.$.da.za(65));return this.bDa}},H3b:{configurable:!0,enumerable:!0,get:function(){this.I3b||(this.I3b=new U);return this.I3b},set:function(dc){this.I3b=dc}}});Object(cb.a)(F,"CatchUpActivityHighlightManager",null,[904,3]);I.prototype.navigateToActivity=function(dc){if(dc.fromSummaryString){var Ec=new Pb.a(1834994092,Pe.a.Cb,this.$.Jc,18,null);this.$.Ka.Kb(Ec);return this.STa(1)}dc=dc.activity;if(!this.Bdi(dc))return this.STa(4);if(!this.Fmi(dc))return this.STa(7);var gb={};try{Ec=window.self.atob(dc.navigationId);
if(!Ec)return this.STa(5);gb.NavigationId=Ec}catch(Bb){return Qa.ULS.sendTraceTag(537168023,3012,10,"Exception thrown when trying to decode activity NavigationID: {0}",Bb),this.STa(5)}if(8===this.oi.$d(ud.a.nIa,2,gb))return this.oi.processAction(ud.a.L8a,2),this.STa(2);Ec=32===this.oi.$d(ud.a.S_a,2,gb)?1:6;return this.STa(Ec)};I.prototype.Bdi=function(dc){return dc&&dc.navigationId?!0:!1};I.prototype.Fmi=function(dc){switch(dc.type){case 3:case 4:case 6:case 7:case 9:case 8:return!0;default:return!1}};
I.prototype.STa=function(dc){return Promise.resolve(dc)};Object(cb.a)(I,"CatchUpActivityNavigationManager",null,[883]);var mc=b(477);Object(cb.a)(D,"GetRelevantActivitiesDataRequest",null,[]);Object(cb.a)(x,"Activity",null,[]);Object(cb.a)(z,"ActivityFeedItem",null,[]);Object(cb.a)(A,"ActivityFeedPayload",null,[]);Object(cb.a)(B,"ActivityRequestPayload",null,[]);Object(cb.a)(w,"Person",null,[]);Rk(m,x);Object(cb.a)(m,"TaskActivity",x,[]);v.prototype.requestWYWAActivities=function(){var dc=this;return this.d6a?
new Promise(function(Ec,gb){y(dc.$.oa.xa,function(Bb){var qc,Nc=Wc.a(Bb)?null:Bb.Result;nb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.BlueDot",!1)?(Bb=null===(qc=null===Nc||void 0===Nc?void 0:Nc.WywaAuthors)||void 0===qc?void 0:qc.length,null!=Bb&&0<Bb&&Rb.TaskExtensions.Aa(Ic.GetServiceTaskFactory.Ra(dc.$.da,501,500,0),function(nd){nd.result.wzj().then(function(Vd){var oe=Vd.map(function(qe){return{activityId:qe.activityGuid,activityFeedItemId:null,type:1,actors:[{id:qe.author.id,
provider:qe.author.provider,displayName:qe.author.displayName,givenName:null,email:qe.author.email,imageUrl:qe.author.imageUrl,color:null}],location:null,displayTimestamp:qe.displayTimestamp,relevancy:null,navigationId:null,state:0,collectionId:null}});Vd=Vd.map(function(qe){var ee=qe.rangeHighlightLocation.rangeList.map(function(re){return{Type:0,RangeList:[{SheetName:qe.sheetName,FirstRow:re.firstRow,LastRow:re.lastRow,FirstColumn:re.firstCol,LastColumn:re.lastCol}]}});return{Id:qe.activityGuid,
Type:null,Person:null,DisplayTimestamp:null,LocationList:ee}});dc.Ndg=Vd;oe={activities:oe,actors:Nc?dc.Abc(Nc.WywaAuthors):null,hasMore:!1,highWaterline:v.Zha,lowWaterline:v.Zha,wywaWaterline:v.Zha};Ec(oe)},function(){})},dc.$.la,3)):(qc=Object(tb.a)(new B,{activities:[],actors:Nc?dc.Abc(Nc.WywaAuthors):null,hasMore:!1,highWaterline:v.Zha,lowWaterline:v.Zha,wywaWaterline:v.Zha}),Ec(qc))},function(){Qa.ULS.sendTraceTag(537168022,0,10,"CatchUpActivityRequestManager::GetLineageWywaAuthors service call failed.");
gb(null)},null,null)}):Promise.resolve(v.L5b)};v.prototype.requestActivities=function(){return Promise.resolve(v.L5b)};v.prototype.requestRelevantActivities=function(){var dc=this;if(!this.$.ea.dc||this.$.ea.G4a)return Qa.ULS.sendTraceTag(537168021,3012,15,"CatchUpActivityRequestManager.RequestRelevantActivities: RequestRelevantActivities skipped [IsSessionActive: {0}, HasRaisedSessionEnded: {1}]",this.$.ea.dc,this.$.ea.G4a),Promise.resolve(v.L5b);var Ec=Object(tb.a)(new D,{SetDaysBack:Ua.AFrameworkApplication.fa.kd("AppWaterlineOverrideDaysValue",
0),SetTimestamp:Ua.AFrameworkApplication.fa.kd("AppWaterlineOverrideTimestampValue",0)});return new Promise(function(gb,Bb){r(dc.$.oa.xa,Ec,function(qc){var Nc=v.L5b;qc?Wc.a(qc)?Qa.ULS.sendTraceTag(578353159,3012,10,"CatchUpActivityRequestManager::GetRelevantActivitiesData call returned errors codes: {0}",sc.a.Ec(qc.Errors)):Nc=dc.WUh(qc.Result):Qa.ULS.sendTraceTag(537168020,3012,10,"CatchUpActivityRequestManager::GetRelevantActivitiesData call returned Null result.");gb(Nc)},function(qc){qc=Xb.a.Mf(qc.data);
Qa.ULS.sendTraceTag(537168019,3012,10,"CatchUpActivityRequestManager::GetRelevantActivitiesData call has failed - Errors: [{0}]",sc.a.Ec(qc));Bb(null)},null,null)})};v.prototype.requestActivityFeed=function(){var dc=this;return Qd.b(this.getActivityFeed()).then(function(Ec){return Object(tb.a)(new A,{activityFeedItems:dc.WKj(Ec)})})};v.prototype.updateActivityState=function(dc){return nb.EwaSettings.ma(453)?Promise.resolve(!0):this.z1b?Qd.b(this.z1b).then(function(Ec){var gb,Bb;return Qd.b(Ec.oPj(dc.itemIds,
null!==(gb=dc.activityStatesToSet)&&void 0!==gb?gb:0,null!==(Bb=dc.activityStatesToReset)&&void 0!==Bb?Bb:0,dc.resetUnseenCount))}):Promise.resolve(!1)};v.prototype.getActivityFeed=function(){return this.z1b?Zd.a.zUd(this.z1b,function(dc){return dc.getActivityFeed(null)}):Va.Task.Ua([])};v.prototype.WUh=function(dc){if(!dc)return Qa.ULS.sendTraceTag(537168018,3012,10,"CatchUpActivityRequestManager::GetRelevantActivityRequestPayload response is null."),Object(tb.a)(new B,{activities:[]});var Ec=this.D9f(dc.NewActivities,
2);dc=this.D9f(dc.OutstandingActivities,3);dc=bk(dc);for(var gb=dc.next();!gb.done;gb=dc.next())Ec.push(gb.value);return Object(tb.a)(new B,{activities:Ec})};v.prototype.D9f=function(dc,Ec){Ec=void 0===Ec?1:Ec;var gb=[];if(!dc||!dc.length)return gb;dc=bk(dc);for(var Bb=dc.next();!Bb.done;Bb=dc.next())if(Bb=Bb.value){var qc=v.cLj(Bb.Type);6===qc||7===qc||9===qc||8===qc?gb.push(Object(tb.a)(new m,{activityId:Bb.Id,type:qc,displayTimestamp:new Date(Bb.DisplayTimestamp),navigationId:Bb.NavigationId,actors:this.Abc(Bb.People),
relevancy:Ec,relationship:this.bLj(Bb.Relationship)})):gb.push(Object(tb.a)(new x,{activityId:Bb.Id,type:qc,displayTimestamp:new Date(Bb.DisplayTimestamp),navigationId:Bb.NavigationId,actors:this.Abc(Bb.People),relevancy:Ec}))}else Qa.ULS.shipAssertTag(537168017,3012,!1,"CatchUpActivityRequestManager.TranslateRelevantActivitiesToActivities: relevantActivity is null");return gb};v.prototype.bLj=function(dc){switch(dc){case 1:return 1;case 2:return 2;case 3:return 3}Qa.ULS.sendTraceTag(537168016,0,
10,"Unexpected Relationship.");return 1};v.prototype.WKj=function(dc){var Ec=[];dc=bk(dc);for(var gb=dc.next();!gb.done;gb=dc.next())gb=gb.value,gb=Object(tb.a)(new z,{id:gb.id,type:gb.type,collectionId:gb.collectionId,activityState:gb.activityState,activityFeedItemPayload:gb.activityFeedItemPayload,timestamp:gb.timestamp}),Ec.push(gb);return Ec};v.prototype.Abc=function(dc){var Ec=[];if(!dc||!dc.length)return Ec;dc=bk(dc);for(var gb=dc.next();!gb.done;gb=dc.next())(gb=gb.value)&&Ec.push(this.Fvb(gb));
return Ec};v.prototype.Fvb=function(dc){return Object(tb.a)(new w,{id:dc.Id,provider:dc.Provider,displayName:dc.DisplayName,email:dc.Email,imageUrl:this.kqc.CHa(dc.Email,dc.Provider,Ua.AFrameworkApplication.Yi,0),color:this.PFb.jgd(new mc.a(null,void 0,dc.DisplayName),6)})};v.cLj=function(dc){switch(dc){case 1:return 3;case 2:return 4;case 3:return 6;case 4:return 7;case 6:return 8;case 5:return 9;case 7:return 10;default:return Qa.ULS.shipAssertTag(537168015,3012,!1,"CatchUpActivityRequestManager.TranslateRelevantActivityTypeToActivityType: unknown RelevantActivityType"),
1}};v.Zha="<WywaWaterline>DefaultWaterline</WywaWaterline>";v.L5b=Object(tb.a)(new B,{activities:[],actors:[],hasMore:!1,highWaterline:v.Zha,lowWaterline:v.Zha,wywaWaterline:v.Zha});Object(cb.a)(v,"CatchUpActivityRequestManager",null,[884]);f.prototype.shouldShowEmptyExperienceButton=function(){if(!this.$.ea.H7a)return!1;if(!nb.EwaSettings.isChangeGateEnabled("OfficeVSO:5892442_CatchupEmptyExperienceNewContract")){var dc=this.$.da.za(365);return!dc||!dc.isVisible}return!0};f.prototype.onButtonClick=
function(){var dc={};dc=(dc.InputMethod=Pe.a.Cb,dc);this.$.Ka.Kb(new Pb.a(1834994092,Pe.a.Cb,this.$.Jc,16,null),dc)};f.prototype.getExplanationText=function(){var dc=this.$.da.za(365);return af.a.instance.Xa(dc&&dc.isVisible?646:645)};f.prototype.getCommandName=function(){return af.a.instance.ga(446)};Object(cb.a)(f,"CatchUpEmptyExperienceBehaviorManager",null,[885]);l.prototype.dispose=function(){Gc.a(this.$).Az(this)};l.prototype.Sf=function(dc,Ec){if(Ec)return!1;dc=document.getElementById("flyoutItem0");
if(!dc)return Qa.ULS.sendTraceTag(537168009,3012,10,"Could not find firstItem in flyout when setting up focus"),!1;dc.focus();this.vfh(dc);return!0};l.prototype.$g=function(dc){return this.ic?gd.DOMElementExtensions.nf(this.ic,dc):!1};l.prototype.ej=function(){this.hasFocus=!0};l.prototype.Aj=function(){this.hasFocus=!1};l.prototype.vfh=function(dc){if(Sys.Browser.agent===Sys.Browser.Firefox){var Ec=document.createEvent("KeyboardEvent");Ec.initKeyEvent(Hd.a.Lb,!0,!0,window.self,!1,!1,!1,!1,zd.a.YBc,
0);dc.dispatchEvent(Ec)}else Ec=document.createEvent("Events"),Ec.initEvent(Hd.a.Lb,!0,!0),Ec.keyCode=zd.a.YBc,Ec.which=zd.a.YBc,dc.dispatchEvent(Ec)};Mf.Object.defineProperties(l.prototype,{ic:{configurable:!0,enumerable:!0,get:function(){return document.getElementById("catchUpFlyoutContainer")}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return this.flyoutRibbonButton.ocf&&!this.hasFocus}},Yd:{configurable:!0,enumerable:!0,get:function(){return ld.a.GZc}}});Object(cb.a)(l,"FlyoutFocus",
null,[448,3]);var xc=b(394);k.prototype.dispose=function(){this.Rib=this.Tyb=!1};k.prototype.registerButtonClickedEvent=function(dc){this.buttonClickedCallback&&Qa.ULS.sendTraceTag(537168008,3012,15,"RegisterButtonClickedEvent: Button clicked callback should only be registered once.");this.buttonClickedCallback=dc.buttonClickedCallback};k.prototype.onFlyoutInitialized=function(){this.Tyb&&Qa.ULS.sendTraceTag(537168007,3012,15,"OnFlyoutInitialized: Flyout should only be initialized once.");var dc=
(new Date).getTime()-this.SBh.getTime();Qa.ULS.sendTraceTag(593601546,3012,50,"Time from retrieve activities to initialize Flyout: {0}",dc);Kb.c(ud.a.RUg,!0,Kb.e,0,0,dc);this.Tyb=!0;xc.a.qA&&xc.a.qA.updateCommandUI(!0)};k.prototype.logFlightTriggers=function(){};k.prototype.toggleCatchUpFlyout=function(){this.Tyb?this.buttonClickedCallback?this.buttonClickedCallback():Qa.ULS.sendTraceTag(537168005,3012,10,"ToggleCatchUpFlyout: User clicked the button before the buttonClickedCallback was registered."):
Qa.ULS.sendTraceTag(537168006,3012,10,"ToggleCatchUpFlyout: User clicked the button before the flyout was initialized.")};k.prototype.onFlyoutVisibilityChanged=function(dc){this.Rib!==dc.flyoutIsVisible&&(this.Rib=dc.flyoutIsVisible,xc.a.qA&&xc.a.qA.updateCommandUI(!0),this.Rib||this.bTe&&this.bTe.vti())};Mf.Object.defineProperties(k.prototype,{ocf:{configurable:!0,enumerable:!0,get:function(){return this.Rib}}});Object(cb.a)(k,"FlyoutRibbonButton",null,[903]);var hd=b(571);Object(cb.a)(e,"CatchUpConfiguration",
null,[]);Object(cb.a)(d,"SharedControllerFactoryParameters",null,[]);c.prototype.dispose=function(){this.GGa&&this.GGa.getWywaEvent().removeListener(this.zDf);this.GGa=this.$=null;zc.a.Ia(this.i_a);this.flyoutRibbonButton=this.flyoutFocus=this.Y1d=this.bwe=this.FZc=this.i_a=null};c.prototype.MSi=function(){this.flyoutRibbonButton.toggleCatchUpFlyout();return!0};c.prototype.aui=function(){Qa.ULS.sendTraceTag(589608192,3012,50,"Catch Up script is loaded and Flyout is enabled.");this.$$e()&&Qa.ULS.sendTraceTag(526718752,
3012,50,"ActivityFeedData is enabled")};c.prototype.bsi=function(dc,Ec){n("ScriptDownload");Rb.TaskExtensions.Aa(Ic.GetServiceTaskFactory.Ra(this.$.da,283,284,Ec),function(gb){dc(Qd.c(gb.result.tn.loadScript("catchUpActivity")))},this.$.da.la,3)};c.prototype.d6a=function(){return!!this.ujf&&this.ujf.d6a()&&this.$.ea.H7a};c.prototype.$$e=function(){return nb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ActivityFeedIsEnabled",!1)};c.prototype.xGi=function(dc){var Ec=this;Rb.TaskExtensions.Aa(dc,
function(){rb.a(function(){Ec.GGa=catchUpActivity.FactoryGlobal.getExcelCatchUpAppInstance(Object(tb.a)(new d,{activityContentManager:Object(vc.a)(882,Ec.Y1d),activityNavigationManager:Object(vc.a)(883,Ec.bwe),activityRequestManager:Object(vc.a)(884,Ec.FZc),dataCulture:Ec.$.ya.DataCultureTag,flyoutFocus:null,flyoutRibbonButton:Object(vc.a)(k,Ec.flyoutRibbonButton),uiCulture:Ec.$.ya.UICultureTag,ulsLogger:new Ac.a,emptyCatchUpBehaviorManager:Object(vc.a)(885,Ec.emptyCatchUpBehaviorManager)}))});Ec.i_a.szg=
Ec.GGa.getActivityIndicatorTooltipManager();hd.a(Ec.$);Ec.GGa.getWywaEvent().addListener(Ec.zDf);n("InitializeCatchUpApp");Ec.GGa.initialize(Object(tb.a)(new e,{featuredActivityGroupsEnabled:!1,summaryStringEnabled:Ec.d6a(),includeRelevantAuthorsInSummaryString:!1,useCompactSummaryString:nb.EwaSettings.isChangeGateEnabled("OfficeVSO:5788078_useCompactStringOnExcel"),activityFeedDataEnabled:Ec.$$e()}))},this.$.la,3)};Mf.Object.defineProperties(c.prototype,{Daf:{configurable:!0,enumerable:!0,get:function(){var dc=
this.flyoutRibbonButton.Tyb;dc&&!this.t5e&&(Qa.ULS.sendTraceTag(588129368,3012,50,"Catch Up Flyout is ready and button is enabled."),this.t5e=!0);return dc}},Kei:{configurable:!0,enumerable:!0,get:function(){return this.flyoutRibbonButton.ocf}}});Object(cb.a)(c,"CatchUpActivityManager",null,[886,3]);var Cd=pa.a;Rk(a,Cd);a.prototype.create=function(){var dc=this;Rb.TaskExtensions.Aa(Ic.GetServiceTaskFactory.Ra(this.$.da,458,459,this.hb),function(Ec){var gb=Ec.result;Ec=Object(Ie.a)(dc.$.da,286,function(){return new c(dc.$,
dc.hb,null,gb)});dc.pb(Ec)},this.$.la,3)};a.ka=function(dc){dc.da.Ga(287,new a(dc))};Object(cb.a)(a,"CatchUpActivityManagerFactory",pa.a,[]);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Lineage");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.VersionHistory");Type.registerNamespace("_Ewa");eb.a.Fa(Fb.ka);eb.a.Fa(zb.ka);eb.a.Fa(ma.ka);eb.a.Fa(Z.ka);Se.a.ti('.LineageActivityPane{height:100%;display:flex;flex-direction:column;overflow:hidden;background-color:#edebe9}.LineageActivityPaneHeader{display:flex;flex-direction:row;position:relative;overflow:hidden;padding-right:16px;padding-left:16px;padding-top:16px;padding-bottom:11px;height:auto;background-color:#edebe9}.LineageActivityPaneTitle{max-width:240px;display:inline-flex;font-weight:bold;font-family:"Segoe UI Semi Bold","Segoe UI Web",Arial,Verdana,sans-serif;font-size:16px;line-height:16px;flex-grow:1;align-content:center;height:auto;text-overflow:ellipsis;overflow:hidden;background-color:#edebe9;margin:0}.LineageActivityCloseButton{display:inline-flex;align-self:center}.LineageActivityBody{height:100%;padding-left:16px;overflow:hidden;background-color:#edebe9}');
(function(){eb.a.Fa(function(dc){Xa.ka(dc);ba.ka(dc);Ia.ka(dc);va.ka(dc);nb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.BlueDot",!1)&&ja.ka(dc);ob.ka(dc)})})();Type.registerNamespace("Common.App.CatchUpActivity");P.main();(function(){eb.a.Fa(function(dc){n("Begin");a.ka(dc);C.ka(dc)})})()}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.catchup.js.map/6d5ecfc35b1e075674d3b2f625603332/EwaDS.catchup.js.map