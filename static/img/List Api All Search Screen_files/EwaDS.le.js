(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[13],{1438:function(u,E,b){function a(wa,X,ja,va){var ua=ea.call(this)||this;ua.isMac=n.a.isMac;ua.SXa=-1;ua.S4b=null;ua.bta=-1;ua.Vre=!1;ua.d_=!1;ua.ARd=!1;ua.sic=!1;ua.ZM=!1;ua.HT=null;ua.ug=function(){ua.ewa&&ua.gridView&&ua.VW()};ua.Fc=function(){ua.Jx()};ua.$c=function(){ua.nHa();H.g(ua.$).Sf(!0,!1)};ua.g6=function(aa,ba){ba?(ua.obg(ua.S4b),ua.hdb()):(aa=[29],ua.gridView.qb.eh(aa),ua.gridView.qb.Ti(null,aa),ua.HT&&ua.HT.H6e())};
ua.Oi=function(){ua.j6a()&&ua.Jh.hide();1===ua.gridView.ha.Pe&&ua.VW()};ua.iR=function(){var aa=ua.gridView.ha.Pe;ua.gridView.ha.sa.activeCell&&1===aa&&ua.VW()};ua.onKeyUp=function(aa){return ua.oBb?ua.d_?!1:17===aa.Ca.keyCode&&ua.ARd?(ua.ZM?(ua.hdb(),ua.nda()):ua.AKb(),!0):!1:ua.d_=!1};ua.onKeyDown=function(aa){if(!ua.oBb)return ua.d_=!1;ua.ARd=!1;ua.d_=aa.ctrlKey;switch(aa.Ca.keyCode){case 27:return ua.ZM?(ua.g6(null,!1),ua.nda()):ua.HT&&(ua.HT.H6e(),ua.AKb()),!0;case 13:if(ua.ZM)return ua.ZM=!1,
ua.nHa(),!0;break;case 17:return ua.ARd=!0}return!1};var Xa=b(1547).AutoDetectActionButton;ua.$=wa;ua.qob=O.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.AutoDetectRichTooltip",!1);X||l.ULS.sendTraceTag(537166983,0,15,"AutoDetectManager: SVG icons are enabled, but svgIconProvider is null");ua.convertToLinkedEntityManager=va;va.z$a();ua.Jh=new Xa(wa,X,ua.$c,ja,"");ua.pMg=new c(ua.$,va);ua.gridView=H.g(ua.$);ua.gridView.ha.lP(ua.ug);ua.gridView.Wb.jYa(ua.ug);ua.gridView.yu(ua.iR);
wa.Bk(ua.Fc);wa.sA(ua.Oi);ua.gridBlockManager=Object(r.a)(407,ua.gridView.Ea);ua.ir=wa.frame.mt;ua.VW();return ua}function c(wa,X){var ja=N.call(this)||this;ja.$=wa;ja.gridView=H.g(wa);ja.convertToLinkedEntityManager=X;ja.F0c=new K.a;return ja}function d(wa,X){var ja=T.call(this)||this;ja.$c=function(va){if(va.zb.id===ja.oIa.firstChild.id){va=ja.Ure;var ua={};ua.Id=va.pob;ja.convertToLinkedEntityManager.Q1c(ua,!0,va);ja.oIa.removeChild(ja.oIa.firstChild);return!0}return!1};ja.Ure=wa;ja.convertToLinkedEntityManager=
X;ja.oIa=document.createElement("div");ja.oIa.className="clip16x16";ja.Vva=String.format('<input type="image" id="{0}" class="{1}" src="{2}" alt="Convert To Linked Entities Column Header Button">',D.a.zg("autodetectid"+ja.Ure.left),F.a.N8c,G.a.Se(11));ja.oIa.innerHTML=ja.Vva;wa=document.getElementById("m_excelWebRenderer_ewaCtl_columnHeadersDiv");I.a.instance.ra(v.a.click,wa,ja.$c);return ja}function e(wa,X){this.helpId=this.helpText=this.imageAltText=this.urlValue=this.longDescription=this.convertToDomainName=
this.cardViewManager=null;this.$=X;this.parentElement=wa}u=b(0);var k=b(7),l=b(14),n=b(27),f=b(89),v=b(13),r=b(85),y=b(440),m=b(79),w=b(8),B=b(66),A=b(493);e.prototype.p4g=function(){var wa=this,X=this.q4g();A.a(this.$,243,242,0,function(ja){wa.cardViewManager=ja;ja.h2f(wa.parentElement,2,X)})};e.prototype.H6e=function(){this.cardViewManager&&this.cardViewManager.OKa(-1,-1,this.parentElement)};e.prototype.q4g=function(){var wa={layoutId:"AutoDetectTooltip"};wa.description=this.longDescription;wa.convertToDomainName=
this.convertToDomainName;wa.longDescription=this.longDescription;wa.urlValue=this.urlValue;wa.imageAltText=this.imageAltText;wa.helpText=this.helpText;wa.helpId=this.helpId;return wa};Object(u.a)(e,"AutoDetectCardManager",null,[]);var z=b(30),x=b(219),D=b(29),I=b(233),F=b(19),G=b(53),T=m.a;Rk(d,T);d.prototype.dispose=function(){if(this.oIa){var wa=document.getElementById("m_excelWebRenderer_ewaCtl_columnHeadersDiv");I.a.instance.Ba(v.a.click,wa,this.$c)}T.prototype.dispose.call(this)};Mf.Object.defineProperties(d.prototype,
{domElement:{configurable:!0,enumerable:!0,get:function(){return this.oIa}}});Mf.Object.defineProperties(d,{QRg:{configurable:!0,enumerable:!0,get:function(){return"clip16x16"}}});Object(u.a)(d,"AutoDetectColumnHeaderButton",m.a,[]);var O=b(1),U=b(1290),J=b(11),H=b(21),K=b(171),N=m.a;Rk(c,N);c.prototype.dispose=function(){N.prototype.dispose.call(this)};c.prototype.zfh=function(wa){for(var X=bk(this.gridView.U2),ja=X.next();!ja.done;ja=X.next()){ja=bk(ja.value);for(var va=ja.next();!va.done;va=ja.next()){va=
va.value;var ua=va.Fn,Xa=U.a(va.r4);this.gAg(wa,Xa,ua);va.NNd(Xa)}}};c.prototype.gAg=function(wa,X,ja){if(X.length){var va=ja.length;ja[va-1]<wa.left||(ja=J.HelperMethods.jx(new x.a(ja),0,va,wa.left,J.HelperMethods.NC),0>ja||!(X=X[ja]))||(this.gridView.rtl?X.classList.add(z.a.Fth):X.classList.add(z.a.Eth),this.F0c.kb(wa.left)||this.F0c.add(wa.left,new d(wa,this.convertToLinkedEntityManager)),wa=this.F0c.na(wa.left).domElement,!X.getElementsByClassName(d.QRg).length&&this.MCj(X)&&X.appendChild(wa))}};
c.prototype.MCj=function(wa){var X=parseInt(wa.style.width,10),ja=document.querySelector(".ewrch-col-cellsel")?"bold":"normal";ja=c.$5g(ja);wa=gridRenderer.CanvasRendererGlobals.measureTextWidth(wa.firstChild.innerHTML,ja,!0,O.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextWidthClientPhase1",!1));return 18.4<X-(X/2+wa/2)?!0:!1};c.$5g=function(wa){return String.format("{0} {1} {2} {3}/{4} {5}","normal","normal",wa,"10pt","normal",'"Segoe UI",Tahoma,Thonburi,Arial,Verdana,sans-serif')};
Object(u.a)(c,"AutoDetectColumnHeaderManager",m.a,[]);var M=b(460),C=b(24),Q=b(64),P=b(151),ka=b(12),R=b(15),fa=b(187),ca=b(80);b.d(E,"a",function(){return a});var ea=m.a;Rk(a,ea);a.prototype.dispose=function(){this.gridView&&this.gridView.ha.sW(this.ug);if(this.$){var wa=this.$;wa.Ol(this.Fc);wa.gD(this.Oi);H.g(wa).jy(this.iR)}f.a.Ia(this.Jh);this.ir=this.$=this.gridView=this.Jh=null;ea.prototype.dispose.call(this)};a.prototype.Jx=function(){this.g6(null,!1);this.SXa=-1;this.Jh.hide();this.UNj();
this.ZM=!1};a.prototype.nda=function(){this.Jh.getButton(a.nea).obb();this.ZM=!1};a.prototype.AKb=function(){this.Jh.getButton(a.nea).XFb();this.obg(this.S4b);this.ZM=!0;this.$.da.Za(211,function(wa){wa.vPa(R.a.instance.ga(1726))})};a.prototype.onAutoDetectUIShown=function(){if(this.ewa&&-1!==this.SXa)this.convertToLinkedEntityManager.onAutoDetectUIShown()};a.prototype.qMg=function(wa){var X=new C.Range(1===wa.top?1:wa.top-1,wa.left,wa.bottom,wa.right,!0,!1);X=this.gridView.getRangeInformation(X);
X=bk(X);for(var ja=X.next();!ja.done;ja=X.next())if(ja=ja.value,Object(y.a)(M.AutoDetectRange,ja)&&this.qfc(wa,!1,ja))return!0;return!1};a.prototype.nHa=function(){if(this.ewa&&-1!==this.SXa){this.Jh.getButton(a.nea).XFb();var wa={};wa.Id=this.bta;wa.StringId=null;this.convertToLinkedEntityManager.Q1c(wa,!0,this.S4b);l.ULS.sendTraceTag(594612633,0,50,"AutoDetectManager.Convert (AssistedAutoConvertMenuConvertClicked)");wa=[Object(k.a)(new ca.a,{name:"Domain",int64:this.bta})];fa.a("AssistedAutoConvertMenuConvertClicked",
void 0,void 0,wa);this.bta=-1}};a.prototype.SIh=function(){var wa=R.a.instance.ga(1722);if(-1!==this.bta){wa+=" ";try{wa+=this.convertToLinkedEntityManager.HAb(this.bta.toString())}catch(X){l.ULS.sendTraceTag(537166982,0,10,"AutoDetectManager.GetButtonAccessibilityString: Could not obtain name from domain {0}",this.bta)}}wa+=" ";return wa=this.qob?wa+R.a.instance.ga(1725):wa+R.a.instance.ga(this.isMac?1724:1723)};a.prototype.hdb=function(){this.qob&&(this.HT||(this.HT=new e(this.ic,this.$),this.HT.convertToDomainName=
R.a.instance.ga(1727),this.HT.urlValue="https://support.content.office.net/en-us/media/758743e7-a2ca-42db-9f43-a45b05b1b077.png",this.HT.imageAltText=R.a.instance.ga(1729),this.HT.helpId="HID_DataTypes_Wolfram",this.HT.helpText=R.a.instance.ga(1728)),this.HT.longDescription=this.convertToLinkedEntityManager.pVd(this.SXa.toString()),this.HT.p4g())};a.prototype.qfc=function(wa,X,ja){if((new C.Range(ja.top,ja.left,ja.bottom===w.a.sh?ja.bottom:ja.bottom+1,ja.right,!0,!1)).xd(wa)){if(X){if(ja&&ja.pob!==
this.SXa){this.SXa=ja.pob;wa=ja.pob.toString();X=this.qob?"":this.convertToLinkedEntityManager.pVd(wa);var va=this.convertToLinkedEntityManager.X6h(wa);this.Jh.Zeb(this.convertToLinkedEntityManager.HAb(wa),X,va,a.nea)}this.bta=ja.pob;this.S4b=ja}return!0}return!1};a.prototype.VW=function(){if(this.convertToLinkedEntityManager){var wa=this.gridView.ha.Pe;if(this.gridBlockManager&&this.gridBlockManager.Hhd){var X=this.gridView.ha.sa.activeCell,ja=!this.gridBlockManager.Jr(X),va=this.gridView.getRangeInformation(this.gridView.Ug);
va=bk(va);for(var ua=va.next();!ua.done;ua=va.next())if(ua=ua.value,Object(y.a)(M.AutoDetectRange,ua))switch(ua.aXg){case 3:if(this.qfc(X,!0,ua)){if(1!==wa||ja){this.Jx();return}l.ULS.sendTraceTag(537166981,0,50,"AutoDetectManager.ShowOrHideButtonOnGrid (AssistedAutoConvertTriggered)");this.WGd();this.Jh.xAa(X,this.g6);this.Vre||(this.Vre=!0,this.onAutoDetectUIShown());return}break;case 2:case 1:(O.EwaSettings.ma(473)||O.EwaSettings.ma(474))&&this.pMg.zfh(ua);break;default:l.ULS.sendTraceTag(537166980,
0,50,"AutoDetectManager.ShowOrHideButtonOnGrid (Invalid LinkedEntityClassifierTrigger used)")}}this.Jx()}};a.prototype.obg=function(wa){var X=[29];this.gridView.qb.Ti(wa,X);this.gridView.qb.qn(X)};a.prototype.j6a=function(){return this.$.ea.isNamedObjectViewMode&&Q.f(this.$.pa)};a.prototype.WGd=function(){this.qob&&!this.sic&&this.ir&&(this.ir.ft(v.a.Lb,this.$.domElement,this.onKeyDown,!0),this.ir.ft(v.a.Gd,this.$.domElement,this.onKeyUp,!0),this.sic=!0)};a.prototype.UNj=function(){this.qob&&this.sic&&
this.ir&&(this.ir.pt(v.a.Lb,this.$.domElement,this.onKeyDown,!0),this.ir.pt(v.a.Gd,this.$.domElement,this.onKeyUp,!0),this.sic=!1)};a.XKh=function(wa){return R.a.instance.ga(1783)+B.a.space+wa};Mf.Object.defineProperties(a.prototype,{ic:{configurable:!0,enumerable:!0,get:function(){return this.Jh.domElement(1)}},oBb:{configurable:!0,enumerable:!0,get:function(){var wa=this.Jh.domElement(a.nea);return wa?ka.DOMElementExtensions.isVisible(wa):!1}},ewa:{configurable:!0,enumerable:!0,get:function(){return this.$.isEditMode&&
O.EwaSettings.ma(136)&&O.EwaSettings.ma(139)&&(new P.a(this.$.va)).fj?!1:-1!==this.bta}}});Mf.Object.defineProperties(a,{nea:{configurable:!0,enumerable:!0,get:function(){return 1}}});Object(u.a)(a,"AutoDetectManager",m.a,[])},1547:function(u,E,b){function a(n,f,v,r,y){var m=l.call(this)||this;m.$=n;m.zp=r.x4b(n,f,v,"",d.a.Se(11),y,"AutoDetectPointerDown",e.a.instance.ga(1783)+"...");return m}b.r(E);b.d(E,"AutoDetectActionButton",function(){return a});u=b(0);E=b(79);var c=b(1438),d=b(53),e=b(15),
k=b(21),l=E.a;Rk(a,l);a.prototype.dispose=function(){this.zp.dispose();this.$=null;l.prototype.dispose.call(this)};a.prototype.domElement=function(n){return this.zp.domElement(n)};a.prototype.getButton=function(n){return this.zp.getButton(n,!1)};a.prototype.Zeb=function(n,f,v,r){this.zp.qTa(c.a.XKh(n),f,r);this.zp.icg(v,f,r)};a.prototype.xAa=function(n,f){var v=k.g(this.$),r=v.eb.dj(n);n=v.fg(n,r);var y=v.Cf(r).fn;if(n&&0<=n.x&&0<=n.y&&y.width>n.width+160){var m=n.bottomRight.x+this.dz,w=n.topLeft.y+
this.dz,B=!1;m+160>y.bottomRight.x&&(m=n.topLeft.x-this.dz,B=!0);if(w<y.topLeft.y+this.dz){if(v.eb.RSa){this.hide();return}w=y.topLeft.y+this.dz}this.zp.w7b(f,r);this.hp(m,w,v.rtl,r,B)}else this.hide()};a.prototype.hp=function(n,f,v,r,y){this.zp.hp(n,f,v,r,!1,y)};a.prototype.hide=function(){this.zp.hide()};Mf.Object.defineProperties(a.prototype,{dz:{configurable:!0,enumerable:!0,get:function(){return this.zp.dz}}});Object(u.a)(a,"AutoDetectActionButton",E.a,[])},1652:function(u,E,b){function a(R){var fa=
P.call(this)||this;fa.gi=null;fa.Wg=null;fa.$=R;fa.Eb();return fa}function c(R,fa,ca){var ea=Q.call(this,R)||this;ea.ju=0;ea.lp=!1;ea.Fc=function(){ea.Zf(!1)};ea.$=fa;ea.taskPaneManager=ca;O.a(fa).Lh(ea);ea.$.Bk(ea.Fc);U.a.ud(ea.$)&&(ea.isVisible=!1);return ea}function d(R){var fa=G.call(this)||this;fa.$=R;fa.Eb();return fa}function e(R){return z.call(this,R)||this}function k(R,fa){this.$=fa;this.convertToLinkedEntityManager=R}b.r(E);u=b(0);var l=b(905),n=b(14),f=b(5),v=b(76),r=b(37),y=b(1),m=b(186),
w=b(21),B=b(187);k.prototype.Lc=function(R,fa){switch(fa){case -1203788282:case 48568533:case -1662108744:return R=w.g(this.$),fa=this.convertToLinkedEntityManager.kzi||7E3,(null===R||void 0===R?0:R.ha)&&R.ha.sa.Vc.EG>fa?!0:!1;default:return!1}};k.prototype.executeCommand=function(R,fa,ca){R=r.TaskExtensions.jk();fa=fa.command;switch(fa){case -1203788282:this.convertToLinkedEntityManager.M2g(ca[v.a.Nc].toString());break;case 311599363:this.convertToLinkedEntityManager.convertLinkedEntityToText();
break;case 439914789:this.convertToLinkedEntityManager.refreshLinkedEntitiesInRange();break;case 2127195269:this.convertToLinkedEntityManager.launchDisambiguationPaneForSearch();break;case -1662108744:this.convertToLinkedEntityManager.launchLinkedEntityDataTypeSelectorPane(ca[v.a.Nc].toString());break;case 1266950951:this.convertToLinkedEntityManager.uqi();break;case 49813714:this.convertToLinkedEntityManager.convertToLinkedEntityFromAutoDetect();break;case -1081442996:y.EwaSettings.ma(655)&&this.convertToLinkedEntityManager.XJe();
break;case 1702917262:y.EwaSettings.ma(655)&&this.convertToLinkedEntityManager.showHelpArticle(f.a.lPj);break;case -90814711:y.EwaSettings.ma(655)&&this.convertToLinkedEntityManager.showUntrustedImageBusinessBarIfNecessary();break;case 48568533:case -1027730316:if(48568533===fa||ca[v.a.ejf]&&"ConvertToLinkedEntityGallery"===ca[v.a.ejf].toString())n.ULS.sendTraceTag(559982275,0,50,"ConvertToLinkedEntityCommandHandler.ExecuteCommand() - Expanding data types preview gallery"),B.a("ExpandDataTypeGallery");
break;default:R=m.a(fa)}return R};k.prototype.zc=function(R,fa){switch(fa.command){case -1203788282:case 439914789:case 2127195269:case 49813714:return y.EwaSettings.ma(131);case -1081442996:case 1702917262:case -90814711:return y.EwaSettings.ma(655);case 48568533:case -1027730316:case -1662108744:case 311599363:case 1266950951:return!0;default:return!1}};k.prototype.Qc=function(R,fa,ca){return"PopulateConvertToLinkedEntityMenu"===fa&&y.EwaSettings.ma(131)?this.convertToLinkedEntityManager.Qc(R,fa,
ca):!1};Object(u.a)(k,"ConvertToLinkedEntityCommandHandler",null,[429]);var A=b(493),z=l.a;Rk(e,z);e.prototype.Ad=function(){var R=this;A.a(this.$,271,272,this.hb,function(fa){R.jd([new k(fa,R.$)])})};e.ka=function(R){l.a.Qd(273,new e(R))};Object(u.a)(e,"ConvertToLinkedEntityCommandHandlerFactory",l.a,[]);E=b(232);var x=b(971),D=b(51),I=b(441),F=b(911),G=E.a;Rk(d,G);d.prototype.create=function(){var R=this,fa=D.GetServiceTaskFactory.create(this.$.da,102,this.$.la,this.hb),ca=D.GetServiceTaskFactory.Ra(this.$.da,
5,4,this.hb),ea=D.GetServiceTaskFactory.Ra(this.$.da,388,387,this.hb);if(this.$.El)r.TaskExtensions.Aa(r.TaskExtensions.Vd([fa,ca,ea],this.la),function(){var ja=Object(F.a)(R.$.da,271,function(){return new x.ConvertToLinkedEntityManager(R.$,fa.result,ea.result,null,null,ca.result)});R.pb(ja)},this.$.la,3);else{var wa=D.GetServiceTaskFactory.Ra(this.$.da,257,258,this.hb),X=I.a(this.$);r.TaskExtensions.Aa(r.TaskExtensions.Vd([fa,wa,X,ca,ea],this.la),function(){R.pb(R.$.da.za(271)||new x.ConvertToLinkedEntityManager(R.$,
fa.result,ea.result,wa.result,X.result,ca.result))},this.$.la,3)}};d.ka=function(R){R.da.Ga(272,new d(R))};Object(u.a)(d,"ConvertToLinkedEntityManagerFactory",E.a,[]);var T=b(244),O=b(272),U=b(36),J=b(253),H=b(12),K=b(914),N=b(19),M=b(70),C=N.a.mth,Q=T.a;Rk(c,Q);c.prototype.kP=function(R){this.get_events().addHandler("EnrichmentTaskPaneRemoved",R)};c.prototype.zR=function(R){this.get_events().removeHandler("EnrichmentTaskPaneRemoved",R)};c.prototype.VD=function(R){this.addHandler("EnrichmentTaskPaneVilibilityChanged",
R)};c.prototype.BF=function(R){this.removeHandler("EnrichmentTaskPaneVilibilityChanged",R)};c.prototype.xFg=function(R){this.addHandler("EnrichmentTaskPaneOnFocus",R)};c.prototype.qbj=function(R){this.removeHandler("EnrichmentTaskPaneOnFocus",R)};c.prototype.qH=function(){};c.prototype.Vo=function(){return this.lp};c.prototype.Nr=function(){return this.lp};c.prototype.mR=function(){};c.prototype.dispose=function(){this.$&&this.$.Ol(this.Fc);this.taskPaneManager=this.$=null;Q.prototype.dispose.call(this)};
c.prototype.Sf=function(R,fa){fa||this.raiseEvent("EnrichmentTaskPaneOnFocus");return!fa};c.prototype.$g=function(R){return H.DOMElementExtensions.nf(this.ic,R)};c.prototype.ej=function(){};c.prototype.Aj=function(){};c.prototype.Zf=function(R){this.lp=R;var fa=this.taskPaneManager;this.isVisible=R;U.a.ud(this.$)?R?this.taskPaneManager.u6("EnrichmentTaskPane",this.SF):this.taskPaneManager.hideTaskPane("EnrichmentTaskPane"):(R&&0<fa.Mz.length&&(!fa.xg||10!==fa.xg.taskPane.Ng||fa.isCollapsed)&&fa.GF(this,
!0),fa.Kw());R||(w.g(this.$).Sf(!0,!1),this.$.hf())};c.prototype.AQ=function(){return!1};c.ka=function(R,fa){var ca=R.yb,ea=document.getElementById(ca+f.a.tKe);ea||(ea=K.a("div",R.yb+f.a.tKe,"cui-taskpane"),U.a.ud(R)||(ca=document.getElementById(ca+f.a.gR),void 0!==ca&&null!==ca?ca.appendChild(ea):n.ULS.sendTraceTag(537166720,0,10,"EnrichmentTaskPane.Attach: couldn't find novTaskPaneBodyDiv. IsAppUnloading: {0}",R.YE)));ca=R.da;return ca.za(257)||ca.Ga(257,new c(ea,R,fa))};Mf.Object.defineProperties(c.prototype,
{isVisible:{configurable:!0,enumerable:!0,get:function(){return Object(M.a)(c.prototype,this,"isVisible")},set:function(R){Object(M.b)(c.prototype,this,"isVisible",R);this.raiseEvent("EnrichmentTaskPaneVilibilityChanged")}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return this.isVisible}},Yd:{configurable:!0,enumerable:!0,get:function(){return J.a.tkh}},Ng:{configurable:!0,enumerable:!0,get:function(){return 10}},Jk:{configurable:!0,enumerable:!0,get:function(){return C}},MM:{configurable:!0,
enumerable:!0,get:function(){return this.titleText}},titleText:{configurable:!0,enumerable:!0,get:function(){return"Enrichment"}},ko:{configurable:!0,enumerable:!0,get:function(){return 300}},isResizable:{configurable:!0,enumerable:!0,get:function(){return!1}},ic:{configurable:!0,enumerable:!0,get:function(){return this.domElement}},height:{configurable:!0,enumerable:!0,get:function(){return this.taskPaneManager.oO.offsetHeight}},SF:{configurable:!0,enumerable:!0,get:function(){var R=this;return this.taskPaneManager.Cua(this.ic,
this.titleText,this.ko,this.isResizable,function(){R.isVisible=!0},function(){R.isVisible=!1},function(){R.isVisible=!0},function(){R.isVisible=!1},this.ko)}}});Object(u.a)(c,"EnrichmentTaskPane",T.a,[933,3,494,448]);var P=E.a;Rk(a,P);a.prototype.create=function(){var R=this,fa=D.GetServiceTaskFactory.create(this.$.da,203,this.la,this.hb),ca=D.GetServiceTaskFactory.create(this.$.da,155,this.la,this.hb);r.TaskExtensions.Aa(r.TaskExtensions.ts(r.TaskExtensions.Vd([fa,ca],this.la),function(){return R.WC},
this.la),function(){R.pb(R.Wg)},this.la,3)};a.prototype.dispose=function(){this.Wg=this.gi=this.$=null;P.prototype.dispose.call(this)};a.ka=function(R){R.da.Ga(258,new a(R))};Mf.Object.defineProperties(a.prototype,{WC:{configurable:!0,enumerable:!0,get:function(){var R=this;this.gi||(this.gi=r.TaskExtensions.Aa(I.a(this.$),function(fa){R.Wg=c.ka(R.$,fa.result)},this.la,3));return this.gi}}});Object(u.a)(a,"EnrichmentTaskPaneFactory",E.a,[]);var ka=b(10);Type.registerNamespace("_Ewa");Type.registerNamespace("Common.App.Enrichment");
(function(){ka.a.Fa(function(R){a.ka(R);d.ka(R);e.ka(R)})})()},971:function(u,E,b){function a(Ua,pa,Qa,Db,Kb,Ab){var ub=cb.call(this)||this;ub.Fld=null;ub.t6a=null;ub.Hod=null;ub.Iod=null;ub.Jqd=null;ub.Tpd=null;ub.fgf=null;ub.w4a=0;ub.pDb=0;ub.wwb=0;ub.Tba=null;ub.Pld=!1;ub.$Kd=null;ub.Bn=null;ub.abd=null;ub.Sr=0;ub.sY=null;ub.sZj=null;ub.zKa=8;ub.LOa=!1;ub.dcf=!1;ub.yjf=!1;ub.XYc=!1;ub.VRe=null;ub.dVe=null;ub.Nya=null;ub.UWc=0;ub.EMg=5;ub.f0b=3E4;ub.F9f=!1;ub.Y9=null;ub.fia=Array(5);ub.fXd=!1;ub.ebg=
!1;ub.wsd=0;ub.hTf=0;ub.V$d=null;ub.v3f=!0;ub.Uc=function(Mb,Aa){Aa.dc&&!Aa.Jhc&&ub.showUntrustedImageBusinessBarIfNecessary()};ub.wLi=function(Mb){if(Mb.Result){var Aa=Mb.Result;if(Aa&&Aa.length){z.ULS.sendTraceTag(537166922,0,50,"OnGetRichDataClassificationLabelsSuccess: Received {0} labels",Aa.length);var Za=Cb.GetServiceTaskFactory.Ra(ub.$.da,274,275,0);ya.TaskExtensions.Aa(Za,function(){Za.result.LWc(Aa,2)||z.ULS.sendTraceTag(537166921,0,10,"OnGetRichDataClassificationLabelsSuccess - Failed to apply the policy label.")},
ub.$.la,3)}}else z.ULS.sendTraceTag(537166923,0,50,"OnGetRichDataClassificationLabelsSuccess: Received no result")};ub.Qf=function(){ub.jzb&&(ub.nMj(),ub.n2h(ub.$.ea.ho.LinkedEntityAsyncRefreshStateId));ub.A6a?ub.p3h(ub.$.ea.ho.RichDataClassificationLabelStateId):ub.M5a&&ub.tWd(!0)};ub.bJi=function(){ub.fXd=!0;ub.Bn&&ub.Bn.y6i()};ub.QKi=function(Mb){if(Mb&&!Z.a(Mb))try{Mb.Result.HasUntrustedImageUrl&&(ub.businessBar.Tf(58,null),ub.ebg=!0)}catch(Aa){z.ULS.sendTraceTag(574718945,0,10,"ConvertToLinkedEntityManager.OnGetHasUntrustedImageUrlsFromServerSuccess: GetHasUntrustedImageUrls encountered exception {0}.",
Aa)}};ub.$if=function(){if(!ub.yjf&&ub.Ayb()&&!ub.Emd())if(qb.a("DataTabActive"),Ob.a.qg.RQ)if(document.querySelector("#ConvertToLinkedEntityGallery-previewExpandButton")){var Mb=ub.g4b();if(Mb){var Aa={};Aa.InputMethod=da.a.Cb;Aa.CalloutName=8;Aa.Target="[data-unique-id=Ribbon-ConvertToLinkedEntityGallery-previewExpandButton]";ub.$.Ka.Kb(Mb,Aa);ub.yjf=!0}else z.ULS.sendTraceTag(537166880,0,10,"RibbonCommandInfo is null for LinkedEntityGalleryCallout")}else z.ULS.sendTraceTag(537166881,0,10,"Could not locate anchor for the LinkedEntityGalleryCallout");
else z.ULS.sendTraceTag(537166882,0,50,"ConvertToLinkedEntityManager:LaunchLinkedEntityGalleryCallout() - Attempted to launch linked entity gallery callout but callout not enabled")};ub.YHi=function(Mb){V.a.Qg(Mb.Errors)||(ub.A6a||ub.tWd(!1),ub.raiseEvent("LinkedEntityConverted"))};ub.YRi=function(){ub.$.da.Za(211,function(Mb){Mb.readText(Ga.a.instance.ga(1788))})};ub.Yc=function(Mb,Aa){z.ULS.sendTraceTag(537166867,0,50,"ConvertToLinkedEntityManager.OnWorkbookOpened called");Aa.tV?z.ULS.sendTraceTag(537166865,
0,15,"ConvertToLinkedEntityManager.OnWorkbookOpened called while rendering cached content"):(ub.$.isEditMode?ub.Uwe():ub.mfj(),Ia.EwaSettings.ma(655)&&ub.fXd&&ub.XJe())};ub.YKi=function(Mb){ub.h2b();if(Mb.Result){Mb=Mb.Result;var Aa=Mb.DomainDataArray;ub.Tba=Mb.Ribbon;if(ub.Twa&&ub.Tba){var Za={};Za.Name=Ga.a.instance.ga(1778);Za.DomainIds=ub.eK;Array.insert(ub.Tba.Categories,a.I7a,Za)}0<Mb.MaximumCellsToConvert&&(ub.V$d=Mb.MaximumCellsToConvert);ub.Sr=2;Mb=!1;if(Aa){z.ULS.sendTraceTag(39949271,0,
50,"OnGetLinkedEntityServiceDomainsSuccess: Received {0} domains",Aa.length);ub.dNa||(ub.dNa=[]);Za=Ga.a.instance.ga(1775);var Zb=Ga.a.instance.ga(1777);Aa=bk(Aa);for(var jb=Aa.next();!jb.done;jb=Aa.next())if(jb=jb.value,jb.DomainId)if(ub.dNa.push(jb),jb.DomainBlocked){var Vb=!!jb.DomainId.StringId;z.ULS.sendTraceTag(537166861,0,50,"Domain: {0} is telemetry only, do not show in menu (Has String ID: {1})",Vb?jb.DomainId.Id.toString():jb.Name,Vb)}else ub.wU.ia(a.m1a(jb.DomainId),jb),jb.Name===Za||268435456===
jb.DomainId.Id?ub.VRe=jb.DomainId.Id.toString():jb.Name===Zb||536870912===jb.DomainId.Id?ub.dVe=jb.DomainId.Id.toString():268435712===jb.DomainId.Id&&jb.ShowInRibbon&&(ub.XYc=!0),Mb=!0;else z.ULS.sendTraceTag(537166862,0,10,"OnGetLinkedEntityServiceDomainsSuccess: DomainId is null.")}Mb||(ub.dNa=null);ub.Qbg();ub.Xod&&ub.$Kd.NUh();ub.F9f||(ub.jMj(),ub.F9f=!0)}else ub.dNa=null,ub.Sr=3,-1<ub.zKa&&window.setTimeout(function(){ub.z$a()},100*(8-ub.zKa)),z.ULS.sendTraceTag(537166863,0,50,"OnGetLinkedEntityServiceDomainsSuccess: Received no result");
ub.frc();ub.TCe();ub.XYc&&ub.vdf&&ab.b(ub.$if,ub.$.la,500);ub.M5a&&!ub.A6a&&ub.tWd(!0)};ub.XKi=function(Mb){Mb=Wa.a.Mf(Mb.data);z.ULS.sendTraceTag(34415007,0,15,"OnGetLinkedEntityServiceDomainsFailure [Errors: {0}].",V.a.Ec(Mb));ub.dNa=null;ub.Sr=3;ub.LOa=!0;ub.frc()};ub.onContentReady=function(){ub.P$f()&&ub.gridView.jy(ub.onContentReady);ub.v3f&&ub.$.workbookContext.Options&1048576&&(ub.businessBar.cBj(),ub.v3f=!1)};ub.Oi=function(){ub.h2b()};ub.ANi=function(Mb){if(Z.a(Mb)){var Aa=Cb.GetServiceTaskFactory.Ra(ub.$.da,
5,4,0);ya.TaskExtensions.Aa(Aa,function(){var Zb=null;if(null===Mb||void 0===Mb?0:Mb.Errors)Zb=Mb.Errors[0];Aa.result.c3f(Zb,null)},ub.$.la,3);z.ULS.sendTraceTag(537166800,0,15,"ConvertToLinkedEntityManager.OnLinkedEntityTryAutoRefreshSuccessCore. LinkedEntityTryAutoRefresh returned with errors [Errors: {0}].",V.a.Ec(Mb.Errors));var Za=V.a.xF(Mb.Errors,[-1100324317,-2133389873],"ConvertToLinkedEntityManager:OnLinkedEntityTryAutoRefreshSuccessCore");ub.$.ea.fp(Za)}};ub.OYc=function(){z.ULS.sendTraceTag(537166796,
0,50,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck. Checking after a {0} millisecond interval",ub.f0b);ub.L$e("Periodic auto-refresh check",ub.pGi,ub.oGi)};ub.pGi=function(Mb){Z.a(Mb)?(z.ULS.sendTraceTag(537166795,0,15,"ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. LinkedEntityTryAutoRefresh returned with errors [Errors: {0}].",V.a.Ec(Mb.Errors)),++ub.UWc):ub.UWc=0;x.a.Ia(ub.Nya);ub.UWc>=ub.EMg?(z.ULS.sendTraceTag(537166794,0,10,"ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. Failed too many consecutive times. Will stop trying to auto-refresh"),
ub.Nya=null):(z.ULS.sendTraceTag(537166793,0,50,"ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. Re-creating periodicAutoRefreshCheckContext"),ub.Nya=ma.a.instance.create(ub.OYc,ub.f0b,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck"))};ub.oGi=function(Mb){Mb=Wa.a.Mf(Mb.data);D.a.fh(Mb)?z.ULS.sendTraceTag(537166791,0,15,"OnCallPeriodicAutoRefreshCheckFailure. LinkedEntityTryAutoRefresh failed with an HTTP error"):z.ULS.sendTraceTag(537166792,0,15,"OnCallPeriodicAutoRefreshCheckFailure. LinkedEntityTryAutoRefresh failed [Errors: {0}].",
V.a.Ec(Mb));x.a.Ia(ub.Nya);ub.Nya=ma.a.instance.create(ub.OYc,ub.f0b,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck")};ub.COi=function(Mb){Mb=!!Mb.Result&&Mb.Result;z.ULS.sendTraceTag(537166790,0,50,"OnNotifyFeatureLicensingStatusSuccess- operationSucceeded? = {0}",Mb.toString());Mb?(z.ULS.sendTraceTag(537166789,0,50,"OnNotifyFeatureLicensingStatusSuccess- successful handshake duration = {0} ms, retry count = {1}",ha.a.Ta.Wd.m-ub.w4a,ub.pDb),ub.z$a()):ub.Zxc()};ub.BOi=function(){z.ULS.sendTraceTag(537166788,
0,15,"OnNotifyFeatureLicensingStatusFailed");ub.Zxc()};ub.NPi=function(Mb){Mb=!!Mb.Result&&Mb.Result;z.ULS.sendTraceTag(537166731,0,50,"OnRefreshHandshakeSuccess- operationSucceeded? = {0}",Mb.toString());Mb?(z.ULS.sendTraceTag(537166730,0,50,"OnRefreshHandshakeSuccess- successful handshake duration = {0} ms, retry count = {1}",ha.a.Ta.Wd.m-ub.w4a,ub.wwb),ub.z$a()):ub.zMf()};ub.MPi=function(){z.ULS.sendTraceTag(570769947,0,15,"OnRefreshHandshakeFailed");ub.zMf()};ub.AKi=function(Mb){Mb.Result?(Mb=
Mb.Result)?(ub.QHd(),ub.businessBar.c3f(null,Mb)):z.ULS.sendTraceTag(537166725,0,50,"OnGetErrorMessageForLinkedDataTypeRefreshSuccess: Received no result"):z.ULS.sendTraceTag(537166726,0,50,"OnGetErrorMessageForLinkedDataTypeRefreshSuccess: Received no result")};ub.$=Ua;ub.businessBar=Ab;ub.svgIconProvider=Qa;ub.dNa=[];ub.eK=[];ub.gridView=ob.g(ub.$);ub.Zcc=-1;ub.Rii=Ia.EwaSettings.isChangeGateEnabled("OfficeVSO:4294127_LongButtonVisibleWhenAnyDomainOverrideShowsInRibbon");ub.M5a=ub.$.ma(442)&&ub.$.ma(292);
ub.A6a=ub.$.ma(677);ub.jzb=Ia.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LinkedEntityAutoRefresh",!1);ub.Twa=ub.$.ma(676);ub.Xod=ub.Twa&&Ia.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReadAndWriteRecentlyUsedListToTheRoamingService",!1);ub.vdf=Ia.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LinkedEntityGalleryTeachUIEnabled",!1);ub.wU=new eb.a;ub.p8a=new d(Ua,pa,ub);Db&&(ub.Bn=new e(Ua,Db,Kb,ub,ub));ub.$.Tk(ub.Yc);N.a(ub.$)&&N.a(ub.$).zoj(ub);ub.Uwe();(ub.jzb||
ub.M5a||ub.A6a)&&ub.$.ea.zu(ub.Qf);Ia.EwaSettings.ma(131)&&Ia.EwaSettings.ma(139)&&(ub.P$f()||ub.gridView.yu(ub.onContentReady));ub.$.sA(ub.Oi);Ia.EwaSettings.ma(655)&&(ub.$.ea.Vj(ub.Uc),ub.showUntrustedImageBusinessBarIfNecessary());ub.Xod&&(ub.$Kd=new c(ub.$,ub));return ub}function c(Ua,pa){var Qa=this;this.Yhd=this.aid=!1;this.EPi=function(Db){z.ULS.sendTraceTag(537166680,0,50,"OnReadRoamingStringSuccess called.");Qa.aid=!0;if(V.a.Qg(Db.Errors))z.ULS.sendTraceTag(537166679,0,10,"OnReadRoamingStringSuccess encountered an error. Errors: {0}",
V.a.Ec(Db.Errors));else{var Kb=0,Ab=[],ub=!1;try{if(!Db.Result)return;var Mb=Db.Result;if(!Mb){z.ULS.sendTraceTag(537166678,0,50,"OnReadRoamingStringSuccess - Received an empty roamingXml.");return}Ab=Qa.oWi(Mb);if(!Ab||!Ab.length)return;Kb=Ab.length;Qa.Dzi(Ab);Qa.Nza.WRf();z.ULS.sendTraceTag(537166677,0,50,"OnReadRoamingStringSuccess MruCount:{0}",Qa.Nza.dHb.length);if(Ia.EwaSettings.isChangeGateEnabled("OfficeVSO:5199912_LinkedEntityMruWolfram")){for(var Aa=bk(Qa.Nza.dHb),Za=Aa.next();!Za.done;Za=
Aa.next())if(1===(Za.value.Id&1048320)>>8){ub=!0;break}z.ULS.sendTraceTag(537166676,0,50,"OnReadRoamingStringSuccess MruWolframAvailable:{0}",ub)}}finally{z.ULS.sendTraceTag(537166675,0,50,"ParseRecentlyUsedLinkedDataTypes returned {0} data types.",Kb),Db=[],Db.push(Object(ib.a)(new yb.a,{name:"MruCount",int64:Kb})),Db.push(Object(ib.a)(new yb.a,{name:"MruWolframAvailable",bool:ub})),qb.a("ReadRecentlyUsedLinkedDataTypes",void 0,void 0,Db)}Qa.Yhd&&(Qa.bgg(Qa.Nza.dHb),Qa.Yhd=!1)}};this.VTi=function(Db){z.ULS.sendTraceTag(537166674,
0,50,"OnWriteRoamingStringSuccess called.");V.a.Qg(Db.Errors)?z.ULS.sendTraceTag(537166673,0,10,"OnWriteRoamingStringSuccess encountered an error. Errors: {0}",V.a.Ec(Db.Errors)):Db.Result&&(Db.Result||z.ULS.sendTraceTag(537166672,0,15,"OnWriteRoamingStringSuccess - Failed to write to the roaming service."))};this.MAf=function(Db,Kb,Ab){Db=Wa.a.Mf(Db.data);z.ULS.sendTraceTag(537166671,0,10,"OnRoamingOperationFailure: Encountered errors for {0}. Errors: {1}.",Ab,V.a.Ec(Db))};this.$=Ua;this.Nza=pa}
function d(Ua,pa,Qa){this.Ajf=2;this.zjf="Size64by48";this.$=Ua;this.Va=pa;this.convertToLinkedEntityManager=Qa;this.Twa=Ia.EwaSettings.ma(676)}function e(Ua,pa,Qa,Db,Kb){var Ab=this;this.zta=this.fHe=!1;this.Vbb=this.uwa=!0;this.kFb=this.oLb=!1;this.ndb=null;this.Poc=0;this.iR=function(){(Ab.Vbb||Ab.zta)&&2!==Ab.Poc&&(Ab.kFb||Ab.Zrd(!1))};this.Uc=function(){z.ULS.sendTraceTag(537166944,0,15,"Session ID changed while ambiguous linked entities are present")};this.XHi=function(ub){V.a.Qg(ub.Errors)?
(ub=V.a.Ec(ub.Errors),ub.includes("OperationSucceededWithAlert")?z.ULS.sendTraceTag(537166942,0,50,"Convert to Linked Entity failed with an alert"):z.ULS.sendTraceTag(36975687,0,10,"Failed to Convert to Linked Entity. errors: {0}",ub)):ub.Result&&(Ab.$.ea.wk(Ab.Uc),Ab.$.ea.Vj(Ab.Uc),ub=ub.Result,Ab.ndb=ub.SkydanceFeatureBitmask,Ab.Vvd(ub),Ab.oLb=!0)};this.ug=function(){(Ab.Vbb||Ab.zta)&&Ab.Zrd(!1)};this.Nmc=function(ub,Mb){V.a.Qg(ub.Errors)?z.ULS.sendTraceTag(36975688,0,10,"Failed to retrieve disambiguation data for Ambiguous Linked Entity. errors: {0}",
V.a.Ec(ub.Errors)):ub.Result&&(ub=ub.Result,ub.DisambiguationJson?(Ab.oLb=!1,Ab.uZf(Mb),Ab.ndb=ub.SkydanceFeatureBitmask,Mb=ub.DisambiguationJson,z.ULS.sendTraceTag(537166940,0,50,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataSucceeded: Calling LaunchOrUpdateDisambiguationPane"),Ab.kFb=!1,Ab.cjf(Mb)):z.ULS.sendTraceTag(537166941,0,10,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataSucceeded: Json is null"))};this.wKi=function(ub,Mb){V.a.Qg(ub.Errors)?z.ULS.sendTraceTag(36975689,
0,10,"Failed to retrieve disambiguation data for search. errors: {0}",V.a.Ec(ub.Errors)):ub.Result&&(ub=ub.Result,ub.DisambiguationJson?(Ab.uZf(Mb),Ab.ndb=ub.SkydanceFeatureBitmask,Mb=ub.DisambiguationJson,z.ULS.sendTraceTag(537166938,0,50,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataForSearchSucceeded: Calling LaunchOrUpdateDisambiguationPane"),Ab.kFb=!0,Ab.cjf(Mb)):z.ULS.sendTraceTag(537166939,0,10,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataForSearchSucceeded: Json is null"))};
this.bOi=function(ub){V.a.Qg(ub.Errors)?(z.ULS.sendTraceTag(36975690,0,10,"Failed to move to the next ambiguous Linked Entity. errors: {0}",V.a.Ec(ub.Errors)),Ab.Vbb=!0):ub.Result&&(ub=ub.Result,Ab.ndb=ub.SkydanceFeatureBitmask,Ab.Vvd(ub),Ab.oLb=!0)};this.TQi=function(ub){V.a.Qg(ub.Errors)&&z.ULS.sendTraceTag(36975691,0,10,"Failed to select Linked Entity for Disambiguation.. errors: {0}",V.a.Ec(ub.Errors));ub.Result?(Ab.Vvd(ub.Result),Ab.oLb=!0):Ab.Bsa()};this.hBf=function(ub){V.a.Qg(ub.Errors)?z.ULS.sendTraceTag(36975692,
0,15,"Failed to retrieve data for searching in Disambiguation Pane.  Error id names: {0}",V.a.Ec(ub.Errors)):ub.Result?Ab.F7b.bBc(ub.Result,null):(z.ULS.sendTraceTag(537166927,0,50,"ConvertToLinkedEntityDisambiguationPane:OnSearchLinkedEntitySucceeded: Calling CloseDisambiguationPane"),Ab.Bsa())};this.KMi=function(ub){V.a.Qg(ub.Errors)?z.ULS.sendTraceTag(537166926,0,15,"Failed to insert starter data table. Error id names: {0}",V.a.Ec(ub.Errors)):Ab.Bsa()};this.$=Ua;this.gridView=ob.g(this.$);this.gridView.ha.lP(this.ug);
this.gridView.yu(this.iR);this.VKe=Db;this.convertToLinkedEntityManager=Kb;za.a.ud(this.$)||Qa.GQ(pa);Ua=new v(pa);this.F7b=new n(Ua);O.a.instance.Tb("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(ub){ub.isFeatureEnabled("mso_sendASmile",!0).then(function(Mb){Ab.uwa=Mb;return null})})}function k(){this.market=this.appCorrelationId=this.sessionId=this.anid=this.applicationVersion=this.applicationName=null;this.featuresBitMask=this.themeId=0;this.disambiguationJson=
this.uiLanguage=null}function l(Ua){this.campaignId=this.commentQuestion=null;this.isZeroBased=!1;this.ratingValuesAscending=this.ratingQuestion=this.aditionalDataRequested=null;this.showPrompt=this.showEmailRequest=!1;this.surveyType=0;this.title=null;this.campaignId=Ua;this.commentQuestion=Ga.a.instance.mb(194);this.isZeroBased=!1;this.aditionalDataRequested=["EmailAddress"];this.ratingQuestion=Ga.a.instance.mb(190);this.ratingValuesAscending=[Ga.a.instance.mb(191),Ga.a.instance.mb(192),Ga.a.instance.mb(193)];
this.showPrompt=!1;this.showEmailRequest=!0;this.surveyType=4;this.title=Ga.a.instance.mb(189)}function n(Ua){return f.call(this,Ua)||this}function f(Ua){this.Ay=null;this.cfa=Ua}function v(Ua){var pa=r.call(this,I.AFrameworkApplication.ta.sy,I.AFrameworkApplication.ta.mt,I.AFrameworkApplication.ta.$da,I.AFrameworkApplication.ta.xe,I.AFrameworkApplication.ub)||this;pa.taskPane=Ua;pa.taskPane.xFg(pa.wYf);return pa}function r(Ua,pa,Qa,Db,Kb){this.Kq=this.Uj=this.g7d=this.f7d=this.zv=this.su=null;this.Sw=
!1;this.ni=Ua;this.Xd=pa;this.WO=Qa;this.Vb=Db;this.La=Kb;this.Hpa=Xa.KeyInputManager.nl(ua.a.HBa,0)}function y(Ua,pa,Qa){Ua=m.call(this,Ua,pa)||this;Ua.telemetryJson=null;Ua.telemetryJson=Qa;return Ua}function m(Ua,pa){Ua=w.call(this,Ua)||this;Ua.messageContent=null;Ua.messageContent=pa;return Ua}function w(Ua){this.messageType=0;this.messageType=Ua}function B(){}function A(Ua,pa,Qa,Db,Kb,Ab,ub,Mb,Aa,Za,Zb){Zb=Ua.Na(1,void 0===Zb?null:Zb);Zb.selectedRanges=pa;Zb.isChangeObject=Qa;Zb.isFloodgateEnabled=
Db;Zb.isStarterData=Kb;Zb.starterDataDomainId=Ab;return R.g(Ua,"GetDataSelectorPaneData",Zb,ub,Mb,Aa,Za,4)}b.r(E);u=b(0);var z=b(14),x=b(89),D=b(276),I=b(4),F=b(29),G=b(1025),T=b(142),O=b(83),U=b(85),J=b(38),H=b(19),K=b(5),N=b(168),M=b(1438),C=b(1441),Q=b(178),P=b(619),ka=b(357),R=b(62),fa=b(84),ca=b(914),ea=b(1001);B.R6h="EnrichmentContentFrame";B.width=320;Object(u.a)(B,"EnrichmentConstants",null,[]);Object(u.a)(w,"EnrichmentResponseMessage",null,[]);Rk(m,w);Object(u.a)(m,"EnrichmentResponseMessageWithContent",
w,[]);Rk(y,m);Object(u.a)(y,"EnrichmentResponseMessageWithContentAndTelemetryData",m,[]);var wa=b(273),X=b(13),ja=b(96),va=b(43),ua=b(86),Xa=b(109),aa=b(41),ba=b(81),oa=b(27),ra=b(107),db=b(906),Ka=b(25);r.prototype.dispose=function(){this.gLb&&this.Kq&&(this.ni.Ba(X.a.click,this.Kq,Object(fa.a)(this,this.Qj,"onClosePaneClick")),this.Xd.Ba(X.a.Gd,this.Kq,Object(fa.a)(this,this.Lxf,"onKeyHide")));this.Kq=null;this.zv&&(this.BOj(),this.zv.parentNode.removeChild(this.zv),this.zv=null);this.Vb.li("EnrichmentPaneId").hk(this.Hpa)};
r.prototype.show=function(Ua,pa,Qa){this.su=Ua;this.Sw||(this.Uj=this.k0a(),this.tQa.appendChild(this.Uj),this.K7i(),this.La.Mb(Ka.a.tye,ra.a.frame,Object(fa.a)(this,this.E1h,"handleEscapeKeyAction")),this.uRa(),this.Sw=!0);this.zv.src=this.Osb&&this.Osb.length?this.Osb+"?culture="+pa.market+"&appName="+pa.applicationName+"&themeId="+pa.themeId+"&featuresBitMask="+pa.featuresBitMask:r.zrf;this.f7d=pa;this.g7d=Qa;this.cdb()};r.prototype.bBc=function(Ua,pa){Ua=new y(2,Ua,pa);this.Dpc(Ua)};r.prototype.uRa=
function(){var Ua=this.Vb.li("EnrichmentPaneId");Ua.parent=wa.AFrame.BNa;this.ni.Jmb("EnrichmentPaneId",this.Uj);Ua.bindAction(this.Hpa,Ka.a.tye)};r.prototype.wYf=function(){if(this.zv){ja.FocusManager.loa(this.zv.contentWindow);var Ua=new y(4,null,null);this.Dpc(Ua)}};r.prototype.Qj=function(){this.A2b();return!0};r.prototype.Lxf=function(Ua){Ua=Ua.Ca.keyCode;return Ua===Sys.UI.Key.enter||Ua===Sys.UI.Key.space?(this.A2b(),!0):!1};r.prototype.A2b=function(){this.hide();if(this.su)this.su.onPaneClosed()};
r.prototype.k0a=function(){var Ua=ca.a("div","EnrichmentPaneId","EnrichmentPane");this.gLb&&Ua.appendChild(this.O2c());this.D$h(Ua);return Ua};r.prototype.O2c=function(){var Ua=ca.b("div","EnrichmentPaneHeaderId","EnrichmentPaneHeader"),pa=ca.b("div","EnrichmentPaneTitleId","cui-taskPaneTitle EnrichmentPaneTitle");pa.innerText=CommonUIStrings.l_EnrichmentPaneTitle;pa.title=CommonUIStrings.l_EnrichmentPaneTitle;var Qa=ea.a.nb("CloseEnrichmentPane","EnrichmentPaneCloseButton",CommonUIStrings.l_Close,
"ClosePaneGlyph_16x16x32",!1);this.ni.ra(X.a.click,Qa,Object(fa.a)(this,this.Qj,"onClosePaneClick"));this.Xd.ra(X.a.Gd,Qa,Object(fa.a)(this,this.Lxf,"onKeyHide"));Ua.appendChild(pa);Ua.appendChild(Qa);this.Kq=Qa;return Ua};r.prototype.D$h=function(Ua){this.zv=ca.b("iframe","","EnrichmentFrame");Ua.appendChild(this.zv);this.zv.id=B.R6h;this.zv.setAttribute("role","presentation")};r.prototype.K7i=function(){va.a.addHandler(this.zv,"load",Object(fa.a)(this,this.mxf,"onIFrameLoad"));va.a.addHandler(this.zv,
"error",Object(fa.a)(this,this.Tmc,"onIFrameError"));$addHandler(window,"message",Object(fa.a)(this,this.nxf,"onIFrameMessage"))};r.prototype.BOj=function(){va.a.removeHandler(this.zv,"load",Object(fa.a)(this,this.mxf,"onIFrameLoad"));va.a.removeHandler(this.zv,"error",Object(fa.a)(this,this.Tmc,"onIFrameError"));$removeHandler(window,"message",Object(fa.a)(this,this.nxf,"onIFrameMessage"))};r.prototype.wbh=function(){this.zv.src=r.zrf};r.prototype.hide=function(){this.Bdc();this.wbh()};r.prototype.E1h=
function(Ua,pa,Qa){if(1!==Qa&&(this.hide(),this.su))this.su.onPaneClosed();return 32};r.prototype.mxf=function(){};r.prototype.Tmc=function(){};r.prototype.nxf=function(Ua){Ua=Ua.rawEvent;if(!this.zv||-1!==this.zv.src.indexOf(Ua.origin)){try{var pa=aa.a(Ua.data)}catch(Qa){return}if(!db.c(pa.messageType)){Ua=window.g_badCastCallback;window.g_badCastCallback=null;switch(pa.messageType){case 2:this.Dpc(new y(1,aa.c(this.f7d),this.g7d));break;case 1:this.Dpc(new m(0,this.qHh()));break;case 3:this.su&&
this.su.selectEntity(pa.messageContent);break;case 5:this.su&&this.su.LCb(pa.messageContent);break;case 8:this.su&&(pa=aa.a(pa.messageContent),0<pa.DomainId?this.su.YLd(pa.Query,pa.TelemetryJson,pa.DomainId,pa.DomainIdString):this.su.searchEntity(pa.Query,pa.TelemetryJson));break;case 6:this.su&&this.su.cancelSearch();break;case 11:pa=aa.a(pa.messageContent);pa=r.s4b("keydown","f6",ua.a.rDc,!0,!1,pa,!0,!1);this.zv&&this.zv.dispatchEvent(pa);break;case 12:if(aa.a(pa.messageContent).keyCode===ua.a.jL&&
(pa=r.s4b("keydown","esc",ua.a.jL,!0,!1,!1,!1,!1),this.zv&&(this.zv.dispatchEvent(pa),this.hide(),this.su)))this.su.onPaneClosed();break;case 13:this.su&&this.su.selectDataType(pa.messageContent);break;case 14:this.su&&this.su.showHelpArticle(pa.messageContent);break;case 15:this.su&&this.su.showSurveyDialog(pa.messageContent);break;case 16:this.su&&(pa=aa.a(pa.messageContent),this.su.insertTable(pa.DomainId,pa.DomainIdString))}window.g_badCastCallback=Ua}}};r.prototype.qHh=function(){return aa.c([2,
1,3,5,8,6])};r.prototype.Dpc=function(Ua){Ua=aa.c(Ua);this.zv.contentWindow.postMessage(Ua,ba.a.Oaa(this.Osb))};r.s4b=function(Ua,pa,Qa,Db,Kb,Ab,ub,Mb){oa.a.Uu?(Ab=String.format("{0} {1} {2}",Ab?"Shift":"",ub?"Control":"",Mb?"Alt":""),Ab.trim(),Qa=document.createEvent("KeyboardEvent"),Qa.initKeyboardEvent(Ua,Db,Kb,window.self,pa,0,Ab,!1,"en-US")):(pa={},pa.keyCode=Qa,pa.ctrlKey=ub,pa.shiftKey=Ab,pa.altKey=Mb,pa.bubbles=Db,pa.cancelable=Kb,Qa=new KeyboardEvent(Ua,pa));return Qa};Mf.Object.defineProperties(r.prototype,
{gLb:{configurable:!0,enumerable:!0,get:function(){return!0}},Osb:{configurable:!0,enumerable:!0,get:function(){return I.AFrameworkApplication.fa.Wa("EnrichmentPaneUrl")}}});r.zrf="about:blank";Object(u.a)(r,"EnrichmentPane",null,[1027,3]);Rk(v,r);v.prototype.cdb=function(){this.taskPane.isVisible||this.taskPane.Zf(!0)};v.prototype.Bdc=function(){this.taskPane.Zf(!1)};v.prototype.dispose=function(){this.taskPane&&(this.taskPane.qbj(this.wYf),this.taskPane=null);r.prototype.dispose.call(this)};Mf.Object.defineProperties(v.prototype,
{tQa:{configurable:!0,enumerable:!0,get:function(){return this.taskPane.ic},set:function(Ua){this.taskPane.ic.innerHTML=Ua.innerHTML}}});Object(u.a)(v,"EnrichmentTaskPaneWrapper",r,[]);f.prototype.xqi=function(Ua,pa){this.Ay=Ua;this.cfa&&this.cfa.show(this,pa,null)};f.prototype.bBc=function(Ua,pa){this.cfa&&this.cfa.bBc(Ua,pa)};f.prototype.fxb=function(){this.cfa&&this.cfa.hide()};f.prototype.dispose=function(){this.cfa&&(this.cfa.dispose(),this.cfa=null)};f.prototype.selectEntity=function(Ua){return this.Ay?
this.Ay.selectEntity(Ua):!1};f.prototype.searchEntity=function(Ua,pa){this.Ay&&this.Ay.searchEntity(Ua,pa)};f.prototype.YLd=function(Ua,pa,Qa,Db){this.Ay&&this.Ay.YLd(Ua,pa,Qa,Db)};f.prototype.LCb=function(Ua){return this.Ay?this.Ay.LCb(Ua):!1};f.prototype.onPaneClosed=function(){if(this.Ay)this.Ay.onPaneClosed()};f.prototype.cancelSearch=function(){this.Ay&&this.Ay.cancelSearch()};f.prototype.selectDataType=function(Ua){this.Ay&&this.Ay.selectDataType(Ua)};f.prototype.showHelpArticle=function(Ua){this.Ay&&
this.Ay.showHelpArticle(Ua)};f.prototype.showSurveyDialog=function(Ua){this.Ay&&this.Ay.showSurveyDialog(Ua)};f.prototype.insertTable=function(Ua,pa){this.Ay&&this.Ay.insertTable(Ua,pa)};Object(u.a)(f,"EnrichmentManager",null,[1026,3]);Rk(n,f);n.prototype.dispose=function(){f.prototype.dispose.call(this)};Object(u.a)(n,"ExcelEnrichmentManager",f,[]);var Ga=b(15);Object(u.a)(l,"FloodgateSurvey",null,[]);var xa=b(24),da=b(76),qa=b(443),na=b(45),ia=b(388),ta=b(177),za=b(36),sa=b(91),V=b(31),Ia=b(1),
Ha=b(294),ob=b(21);Object(u.a)(k,"EnrichmentMessageContentAppProperties",null,[]);e.prototype.dispose=function(){this.$&&(this.gridView.ha.sW(this.ug),this.gridView.jy(this.iR))};e.prototype.selectEntity=function(Ua){function pa(){return new qa.a}var Qa=this,Db=na.o(this.gridView.ha.sa.activeCell,this.$);ia.a(this.$.userOperationManager,function(Kb,Ab,ub){var Mb=Qa.$.oa.xa;Kb=Ha.b(Kb,Qa.TQi);var Aa=Mb.Na(9,null);Aa.activeCell=Db;Aa.selectionIndex=Ua;return R.g(Mb,"SelectLinkedEntityForDisambiguation",
Aa,Kb,Ab,ub,null,4)},function(Kb){return new ta.a(109,0,Kb,void 0,pa)},null);return!0};e.prototype.searchEntity=function(Ua,pa,Qa,Db,Kb){var Ab=this;Qa=void 0===Qa?!1:Qa;Db=void 0===Db?0:Db;Kb=void 0===Kb?null:Kb;z.ULS.sendTraceTag(38846755,0,50,"ConvertToLinkedEntityManager:SearchEntity() - Search attempted with TelemetryJSON: {0}",pa);var ub=na.o(this.gridView.ha.sa.activeCell,this.$);ia.a(this.$.userOperationManager,function(Mb,Aa,Za){var Zb=Ab.$.oa.xa,jb=Ab.uwa,Vb=Qa,Ic=Db,Rb=Kb;Mb=Ha.b(Mb,Ab.hBf);
var kc=Zb.Na(1,null);kc.searchCell=ub;kc.searchQuery=Ua;kc.isFloodgateEnabled=jb;kc.isStarterData=Vb;kc.starterDataDomainId=Ic;kc.starterDataDomainIdString=Rb;return R.g(Zb,"LinkedEntitySearch",kc,Mb,Aa,Za,null,4)},function(Mb){return new ta.a(110,0,Mb,16)},null)};e.prototype.LCb=function(Ua){var pa=this,Qa=na.o(this.gridView.ha.sa.activeCell,this.$);this.Vbb=!1;ia.a(this.$.userOperationManager,function(Db,Kb,Ab){var ub=pa.$.oa.xa;Db=Ha.b(Db,pa.bOi);var Mb=ub.Na(1,null);Mb.activeCell=Qa;Mb.isBackward=
Ua;return R.g(ub,"MoveToNextAmbiguousLinkedEntity",Mb,Db,Kb,Ab,null,4)},function(Db){return new ta.a(111,0,Db,16)},null);return!0};e.prototype.onPaneClosed=function(){this.zta=!1;this.fHe=!0;this.Poc=0;this.kFb=!1};e.prototype.cancelSearch=function(){var Ua=this,pa=this.qMd();pa&&ia.a(this.$.userOperationManager,function(Qa,Db,Kb){var Ab=Ua.$.oa.xa;Qa=Ha.b(Qa,Ua.hBf);var ub=Ab.Na(9,null);ub.activeCell=pa;return R.g(Ab,"CancelSearchLinkedEntity",ub,Qa,Db,Kb,null,4)},function(Qa){return new ta.a(112,
0,Qa,16)},null)};e.prototype.selectDataType=function(Ua){z.ULS.sendTraceTag(537166977,0,50,"ConvertToLinkedEntityDisambiguationPane:SelectDataType: Calling CloseDisambiguationPane");this.Bsa();if(Ua&&Ua.length)if(Ua=JSON.parse(Ua))if(null==Ua.domainId)z.ULS.sendTraceTag(537166946,0,10,"Data Selector Pane invoked SelectDataType without passing a DomainId");else{var pa={};pa.Id=Ua.domainId;pa.StringId=Ua.stringId;this.convertToLinkedEntityManager.convertToLinkedEntity(pa)}else z.ULS.sendTraceTag(537166947,
0,10,"Failed to parse the dataTypeJson from the Data Type Selector Pane");else z.ULS.sendTraceTag(537166976,0,10,"Recevied an empty dataTypeJson payload from the Data Type Selector Pane")};e.prototype.showHelpArticle=function(Ua){var pa=new sa.a(-859308420,da.a.Cb,this.$.Jc,9,null),Qa={};Ua=(Qa[da.a.Uf]="HelpID="+Ua,Qa.InputMethod=da.a.Cb,Qa.ShouldCanvasTakeFocus=!0,Qa[da.a.Nc]=K.a.CQ,Qa);this.$.Ka.Kb(pa,Ua)};e.prototype.showSurveyDialog=function(Ua){C.a.OLb(new l(Ua))};e.prototype.insertTable=function(Ua,
pa){var Qa=this,Db=this.qMd();Db&&ia.a(this.$.userOperationManager,function(Kb,Ab,ub){var Mb=Qa.$.oa.xa;Kb=Ha.b(Kb,Qa.KMi);var Aa=Mb.Na(1,null);Aa.cell=Db;Aa.starterDataDomainId=Ua;Aa.starterDataDomainIdString=pa;return R.g(Mb,"InsertStarterDataTable",Aa,Kb,Ab,ub,null,4)},function(Kb){return new ta.a(259,0,Kb,1)},null)};e.prototype.Zrd=function(Ua){this.launchOrCloseDisambiguationPane(Ua)};e.prototype.launchDisambiguationPaneForSearch=function(){var Ua=this;z.ULS.sendTraceTag(36975685,0,50,"ConvertToLinkedEntityManager:LaunchDisambiguationPaneForSearch() - Launch Disambiguation Pane For Search attempted");
var pa=this.mlj();pa&&ia.a(this.$.userOperationManager,function(Qa,Db,Kb){return A(Ua.$.oa.xa,pa,!0,Ua.uwa,!1,null,Ha.b(Qa,Ua.wKi),Db,Kb,1)},function(Qa){return new ta.a(114,0,Qa,16)},null)};e.prototype.launchLinkedEntityDataTypeSelectorPane=function(Ua,pa){var Qa=this;ia.a(this.$.userOperationManager,function(Db,Kb,Ab){var ub=Qa.$.oa.xa;Db=Ha.b(Db,Qa.Nmc);var Mb=ub.Na(1,null);Mb.selectedRanges=Ua;Mb.letyDomainId=pa;return R.g(ub,"GetDataTypeSelectorData",Mb,Db,Kb,Ab,2,4)},function(Db){return new ta.a(233,
0,Db,16)},null)};e.prototype.rqi=function(Ua,pa){var Qa=this;Ua&&ia.a(this.$.userOperationManager,function(Db,Kb,Ab){return A(Qa.$.oa.xa,Ua,!1,!1,!0,pa,Ha.b(Db,Qa.Nmc),Kb,Ab,2)},function(Db){return new ta.a(257,0,Db,16)},null)};e.prototype.uZf=function(Ua){Ua&&(this.Poc=Ua)};e.prototype.cjf=function(Ua){if(Ia.EwaSettings.ma(655)){var pa=new sa.a(-90814711,da.a.Cb,0,10,null);this.$.Ka.Kb(pa,null)}this.zta?this.F7b.bBc(Ua,null):(pa=3,null!=this.ndb?pa=this.ndb:z.ULS.shipAssertTag(537166937,0,!1,"SkydanceFeatureBitmask was not set"),
(Ua=this.aNh(Ua,pa))||z.ULS.sendTraceTag(537166936,0,15,"LaunchOrUpdateDisambiguationPane: null appProperties"),this.VKe||z.ULS.sendTraceTag(537166935,0,15,"LaunchOrUpdateDisambiguationPane: null entitymanager"),this.F7b.xqi(this.VKe,Ua),this.zta=!0)};e.prototype.Bsa=function(){this.zta&&(z.ULS.sendTraceTag(537166934,0,100,"ConvertToLinkedEntityDisambiguationPane:CloseDisambiguationPane"),this.F7b.fxb(),this.zta=!1,this.Poc=0,this.kFb=!1)};e.prototype.Vvd=function(Ua){var pa=Ua.Row+1;Ua=Ua.Column+
1;0>pa||0>Ua?(z.ULS.sendTraceTag(537166933,0,50,"ConvertToLinkedEntityDisambiguationPane:MoveToAmbiguousLinkedEntity: Calling CloseDisambiguationPane"),this.Bsa(),this.$.ea.wk(this.Uc)):(pa=new xa.Range(pa,Ua,pa,Ua,!0,!1),this.gridView.ha.updateSelection(pa,pa,60),this.Vbb=!0)};e.prototype.aNh=function(Ua,pa){var Qa=new k;Qa.applicationVersion=I.AFrameworkApplication.buildVersion;Qa.applicationName="ExcelWac";Qa.anid="00000000-0000-0000-0000-000000000000";Qa.sessionId=I.AFrameworkApplication.userSessionId;
Qa.appCorrelationId=Q.a.create().toString();var Db=P.a.aH(I.AFrameworkApplication.lcid);Db=Db?Db.name:null;Qa.uiLanguage=Db;Qa.market=this.rac(Db);Qa.themeId=0;Qa.disambiguationJson=Ua;pa<=ka.a.tS?Qa.featuresBitMask=pa:z.ULS.sendTraceTag(537166932,0,10,"SkydanceFeaturesBitmask is too large for EnrichmentMessageContentAppProperties");return Qa};e.prototype.rac=function(Ua){Ua=Ua.split("-");return Ua[Ua.length-1]};e.prototype.launchOrCloseDisambiguationPane=function(Ua){var pa=this,Qa=this.gridView.ha.sa.activeCell;
if(this.qMd()&&Qa)if(this.gridView.Ab.bfc(Qa)){if((!this.fHe||Ua||this.oLb)&&!this.gridView.isEditing){Ua&&(this.Vbb=!0);var Db=na.q(Qa,this.$);ia.a(this.$.userOperationManager,function(Kb,Ab,ub){return A(pa.$.oa.xa,Db,!1,pa.uwa,!1,null,Ha.b(Kb,pa.Nmc),Ab,ub,1)},function(Kb){return new ta.a(114,0,Kb,16)},null)}}else this.Bsa();else this.Bsa()};e.prototype.y6i=function(){var Ua=this;if(this.zta){var pa=this.gridView.ha.sa.activeCell;if(pa){var Qa=na.q(pa,this.$);ia.a(this.$.userOperationManager,function(Db,
Kb,Ab){return A(Ua.$.oa.xa,Qa,!1,Ua.uwa,!1,null,Ha.b(Db,Ua.Nmc),Kb,Ab,1)},function(Db){return new ta.a(114,0,Db,16)},null)}else this.Bsa()}};e.prototype.qMd=function(){var Ua=this.gridView.ha.sa;return Ua.Eba()?na.o(Ua.activeCell,this.$):null};e.prototype.mlj=function(){var Ua=this.gridView.ha.sa;return Ua.Eba()?na.q(Ua.activeCell,this.$):null};Object(u.a)(e,"ConvertToLinkedEntityDisambiguationPane",null,[3]);var ib=b(7),La=b(393),zb=b(1594),Fb=b(53),Yb=b(921);d.prototype.jFh=function(Ua,pa){var Qa=
b(971).ConvertToLinkedEntityManager;this.YQj();pa=this.Va.jq(pa).$D();for(var Db=0,Kb=0,Ab=!1,ub=bk(Ua.Categories),Mb=ub.next();!Mb.done;Mb=ub.next()){if(Mb=this.QFh(Mb.value,Db))this.Twa&&Kb===Qa.I7a&&(Ab=!0),pa.MenuSectionList.push(Mb),++Db;++Kb}this.Twa&&Ab&&Db<=Qa.Bjf&&Array.removeAt(pa.MenuSectionList,Qa.I7a);Qa=this.Va.Bc().N0b();Db=Fb.a.Se(11);Ua=bk(Ua.LongButtons);for(Kb=Ua.next();!Kb.done;Kb=Ua.next())Kb=Kb.value,this.convertToLinkedEntityManager.oxj(Kb)&&this.aCg(Qa,Kb,Db);0<Qa.ControlList.length&&
pa.MenuSectionList.push(Qa);return pa};d.prototype.aCg=function(Ua,pa,Qa){if(pa){var Db="Data.ConvertToLinkedEntityMenuItem_"+pa.Name,Kb=this.convertToLinkedEntityManager.$P(pa.DomainId);Kb&&(pa=Object(ib.a)(new La.a,{Id:Db,ExternalId:Db,Command:"-1662108744",LabelText:pa.Name,Alt:pa.SuperTip,Visible:!0,MenuItemId:b(971).ConvertToLinkedEntityManager.m1a(pa.DomainId),Image16by16:Qa,Image16by16Class:this.z7h(Kb.FontLocator)}),Ua.ControlList.push(pa))}};d.prototype.KFh=function(Ua,pa){var Qa={};Qa=(Qa.width=
24,Qa["min-width"]=24,Qa.height=24,Qa);var Db={};return Object(ib.a)(new zb.a,{Id:b(971).ConvertToLinkedEntityManager.QIe+Ua.toString(),ExternalId:b(971).ConvertToLinkedEntityManager.QIe+Ua.toString(),MenuItemId:b(971).ConvertToLinkedEntityManager.w6c+Ua.toString(),Command:"-1203788282",QueryCommand:"QueryLinkedEntityGalleryButtons",Icon:this.$7e(pa.FontLocator),LabelText:pa.Name,PreviewIconStyle:(Db.root=Qa,Db),Alt:this.Kcd(pa)})};d.prototype.rMg=function(Ua){switch(Ua){case "Animal":return Yb.a.MIg;
case "Apple":return Yb.a.OJg;case "Atom":return Yb.a.lLg;case "Beaker":return Yb.a.kNg;case "Bridge":return Yb.a.LOg;case "Cat":return Yb.a.MUg;case "City":return Yb.a.YWg;case "Constellation":return Yb.a.Y0g;case "Dog":return Yb.a.ahh;case "Finance":return Yb.a.cNg;case "GradCap":return Yb.a.l0h;case "HumanAnatomy":return Yb.a.N6h;case "LocationPointer":return Yb.a.Ysi;case "Map":return Yb.a.vUi;case "MedicineNeedle":return Yb.a.ozi;case "Mountain":return Yb.a.JAi;case "Movie":return Yb.a.dBi;case "Music":return Yb.a.qBi;
case "OuterSpace":return Yb.a.$Ui;case "Planet":return Yb.a.WXi;case "Satellite":return Yb.a.Lij;case "WolframGeneric":return Yb.a.Dhj;default:return Yb.a.L2g}};d.prototype.z7h=function(Ua){if("PowerBIRibbon"!==Ua)return H.a.N8c;switch(Ua){case "AnimalRibbon":return H.a.Bsh;case "AppleRibbon":return H.a.Csh;case "AtomRibbon":return H.a.Dsh;case "BeakerRibbon":return H.a.Esh;case "BridgeRibbon":return H.a.Fsh;case "CenterMapRibbon":return H.a.Gsh;case "CityRibbon":return H.a.Hsh;case "CurrencyRibbon":return H.a.Ish;
case "ExerciseRibbon":return H.a.Jsh;case "FinanceRibbon":return H.a.TOe;case "FirstAidRibbon":return H.a.Ksh;case "GlobeLightningRibbon":return H.a.Lsh;case "GradCapRibbon":return H.a.Msh;case "HumanAnatomyRibbon":return H.a.Nsh;case "LeafRibbon":return H.a.Osh;case "LocationPointerRibbon":return H.a.Qsh;case "MapRibbon":return H.a.ROe;case "MountainRibbon":return H.a.Rsh;case "MovieRibbon":return H.a.Ssh;case "MusicRibbon":return H.a.Tsh;case "NotablePeopleRibbon":return H.a.Ush;case "OuterSpaceRibbon":return H.a.Vsh;
case "PartlySunnyWeatherRibbon":return H.a.Wsh;case "PowerBIRibbon":return H.a.SOe;case "SatelliteRibbon":return H.a.Xsh;case "WolframGenericRibbon":return H.a.Psh;case "YogaRibbon":return H.a.Zsh;default:return H.a.QOe}};d.prototype.$7e=function(Ua){switch(Ua){case "AnimalRibbon":return"AnimalExcelDataTypes_24";case "AppleRibbon":return"AppleExcelDataTypes_24";case "AtomRibbon":return"AtomExcelDataTypes_24";case "BeakerRibbon":return"BeakerExcelDataTypes_24";case "BridgeRibbon":return"BridgeExcelDataTypes_24";
case "CenterMapRibbon":return"CenterMapExcelDataTypes_24";case "CityRibbon":return"CityExcelDataTypes_24";case "CurrencyRibbon":return"CurrencyExcelDataTypes_24";case "ExerciseRibbon":return"ExerciseExcelDataTypes_24";case "FinanceRibbon":return"Bank_32";case "FirstAidRibbon":return"FirstAidExcelDataTypes_24";case "GlobeLightningRibbon":return"GlobeLightning_24";case "GradCapRibbon":return"GradCapExcelDataTypes_24";case "HumanAnatomyRibbon":return"HumanAnatomyExcelDataTypes_24";case "LeafRibbon":return"LeafExcelDataTypes_24";
case "LocationPointerRibbon":return"LocationPointerExcelDataTypes_24";case "MapRibbon":return"OpenMap_24";case "MountainRibbon":return"MountainExcelDataTypes_24";case "MovieRibbon":return"MovieExcelDataTypes_24";case "MusicRibbon":return"MusicExcelDataTypes_24";case "NotablePeopleRibbon":return"NotablePeopleExcelDataTypes_24";case "OuterSpaceRibbon":return"OuterSpaceExcelDataTypes_24";case "PartlySunnyWeatherRibbon":return"PartlySunnyWeatherExcelDataTypes_24";case "PowerBIRibbon":return"DataProtectionExcelDataTypes_24";
case "SatelliteRibbon":return"SatelliteExcelDataTypes_24";case "WolframGenericRibbon":return"Lightning_24";case "YogaRibbon":return"YogaExcelDataTypes_24";default:return"ConvertToEntity_20"}};d.prototype.QFh=function(Ua,pa){pa=this.Va.lC("ConvertToLinkedEntitySection_"+pa,this.Ajf,this.zjf);for(var Qa=!1,Db=bk(Ua.DomainIds),Kb=Db.next();!Kb.done;Kb=Db.next()){var Ab=Kb.value;(Kb=this.convertToLinkedEntityManager.$P(Ab))&&!Kb.DomainBlocked&&Kb.ShowInRibbon&&(Qa=Kb.Name,Ab=b(971).ConvertToLinkedEntityManager.m1a(Ab),
pa.zt("Data.ConvertToLinkedEntityMenuItem_"+Ab,-1203788282,"QueryLinkedEntityGalleryIcon",void 0,Ab,this.$7e(Kb.FontLocator),void 0,void 0,this.Kcd(Kb),Qa),Qa=!0)}if(!Qa)return null;pa=pa.K0b(!0);Db=this.Va.Bc();Db.title=Ua.Name;Ua=Db.N0b();Ua.ControlList.push(pa);return Ua};d.prototype.YQj=function(){this.Ajf=5;this.zjf="Size112by64"};d.prototype.Kcd=function(Ua){return Ua.RibbonTooltipHeader?Ua.RibbonTooltipHeader+"\n\n"+Ua.RibbonTooltip:Ua.RibbonTooltip};Object(u.a)(d,"ConvertToLinkedEntityMenuRenderer",
null,[994]);var kb=b(54),vb=b(255),Wa=b(121),qb=b(187),yb=b(80);c.prototype.NUh=function(){this.aid||Ia.EwaSettings.isChangeGateEnabled("OfficeVSO:6422438_RoamingHandlerNoSessionIdPresent")&&!this.$.ea.dc||(z.ULS.sendTraceTag(537166691,0,50,"GetRecentlyUsedLinkedDataTypesFromRoamingService - Invoking the GetRecentlyUsedDataTypes operation."),vb.v(this.$.oa.xa,0,this.EPi,this.MAf,null,null))};c.prototype.bgg=function(Ua){Ua&&Ua.length?this.aid?(Ua=this.Zmj(Ua))?(z.ULS.sendTraceTag(537166688,0,50,"WriteRecentlyUsedLinkedDataTypesToRoamingService - Invoking the WriteRecentlyUsedDataTypes operation."),
vb.B(this.$.oa.xa,0,Ua,this.VTi,this.MAf,null,null)):z.ULS.sendTraceTag(537166689,0,15,"WriteRecentlyUsedLinkedDataTypesToRoamingService - Created an empty serialized string."):this.Yhd=!0:z.ULS.sendTraceTag(537166690,0,50,"WriteRecentlyUsedLinkedDataTypesToRoamingService - Tried writing an empty list of data types.")};c.prototype.Zmj=function(Ua){if(!Ua||!Ua.length)return z.ULS.sendTraceTag(537166687,0,15,"SerializeRecentlyUsedLinkedDataTypes - Received an empty list of data types."),null;var pa=
[];Ua=bk(Ua);for(var Qa=Ua.next();!Qa.done;Qa=Ua.next()){Qa=Qa.value;var Db={};Db.Id=Qa.Id;Qa.StringId&&(Db.StringId=Qa.StringId);pa.push(Db)}pa="<DataTypes>"+kb.a.xc(pa)+"</DataTypes>";return 1906<pa.length?(z.ULS.sendTraceTag(537166686,0,15,"SerializeRecentlyUsedLinkedDataTypes - Exceeded the MaxSize for ridExcelRecentlyUsedLinkedDataTypes."),null):pa};c.prototype.oWi=function(Ua){if(!Ua)return z.ULS.sendTraceTag(537166685,0,15,"ParseRecentlyUsedLinkedDataTypes - Received an empty roamingXml."),
null;if(!Ua.startsWith("<DataTypes>")||!Ua.endsWith("</DataTypes>"))return z.ULS.sendTraceTag(537166684,0,15,"ParseRecentlyUsedLinkedDataTypes - Received a string without a prefix/postfix."),null;Ua=Ua.substring(11,Ua.length-12);if(!Ua)return z.ULS.sendTraceTag(537166683,0,15,"ParseRecentlyUsedLinkedDataTypes - Created an empty substring."),null;var pa=[];try{pa=kb.a.Th(Ua)}catch(Qa){return z.ULS.sendTraceTag(537166682,0,10,"ParseRecentlyUsedLinkedDataTypes - Encountered an exception. Message: {0}",
Qa.message),null}z.ULS.sendTraceTag(537166681,0,50,"ParseRecentlyUsedLinkedDataTypes returned {0} data types.",pa.length);return pa};c.prototype.Dzi=function(Ua){var pa=this.Nza.dHb,Qa=this.Nza.B5i;if(pa.length!==Qa){for(var Db=0;Db<Ua.length&&pa.length<Qa;++Db){var Kb=Ua[Db];this.Nza.$P(Kb)&&!Array.contains(pa,Kb)&&pa.push(Kb)}this.Nza.dHb=pa}};Object(u.a)(c,"LinkedDataTypeRoamingHandler",null,[]);var ec=b(564),Ob=b(59),Cb=b(51),ab=b(264),ya=b(37),ma=b(47),ha=b(28),Z=b(295),Na=b(22),eb=b(100);b.d(E,
"ConvertToLinkedEntityManager",function(){return a});var cb=J.a;Rk(a,cb);a.prototype.dispose=function(){(this.jzb||this.M5a||this.A6a)&&this.$.ea.Bw(this.Qf);Ia.EwaSettings.ma(655)&&this.$.ea.wk(this.Uc);!this.Y9&&Ia.EwaSettings.ma(131)&&Ia.EwaSettings.ma(139)&&this.gridView.jy(this.onContentReady);this.Bn&&this.Bn.dispose();this.$.gD(this.Oi);this.$.rl(this.Yc);this.M5a&&(this.Fld=null);x.a.Ia(this.Nya)};a.prototype.bFg=function(Ua){this.addHandler("LinkedEntityConverted",Ua)};a.prototype.Zaj=function(Ua){this.removeHandler("LinkedEntityConverted",
Ua)};a.prototype.selectEntity=function(Ua){return this.Bn?this.Bn.selectEntity(Ua):!1};a.prototype.searchEntity=function(Ua,pa){this.Bn&&this.Bn.searchEntity(Ua,pa)};a.prototype.YLd=function(Ua,pa,Qa,Db){this.Bn&&this.Bn.searchEntity(Ua,pa,!0,Qa,Db)};a.prototype.LCb=function(Ua){return this.Bn?this.Bn.LCb(Ua):!1};a.prototype.onPaneClosed=function(){if(this.Bn)this.Bn.onPaneClosed()};a.prototype.cancelSearch=function(){this.Bn&&this.Bn.cancelSearch()};a.prototype.selectDataType=function(Ua){this.Bn&&
this.Bn.selectDataType(Ua)};a.prototype.showHelpArticle=function(Ua){this.Bn&&this.Bn.showHelpArticle(Ua)};a.prototype.showSurveyDialog=function(Ua){this.Bn&&this.Bn.showSurveyDialog(Ua)};a.prototype.insertTable=function(Ua,pa){this.Bn&&this.Bn.insertTable(Ua,pa)};a.prototype.p3h=function(Ua){if(this.$.isEditMode&&this.hTf!==Ua&&I.AFrameworkApplication.fa.qa("SupportsPolicies")){this.hTf=Ua;z.ULS.sendTraceTag(537166925,0,50,"HandleRichDataClassificationLabelStateIdChanged - Getting rich data classification labels");
Ua=this.$.oa.xa;var pa=this.wLi,Qa=Ua.Na(1,null);R.g(Ua,"GetRichDataClassificationLabels",Qa,pa,null,null,null,4)}};a.prototype.XJe=function(){function Ua(Qa,Db,Kb){var Ab=pa.$.oa.xa;Qa=Ha.b(Qa,pa.bJi);var ub=Ab.Na(1,null);return R.g(Ab,"LinkedEntitiesEnableUntrustedImages",ub,Qa,Db,Kb,null,0)}var pa=this;Ia.EwaSettings.Zb()?this.$.userOperationManager.Sb(new ta.a(589,0,Ua,80),null):this.$.userOperationManager.Sb(new ec.a(589,0,Ua,16),null)};a.prototype.showUntrustedImageBusinessBarIfNecessary=function(){this.fXd||
this.ebg||!this.$.ea.dc||this.dmj()};a.prototype.dmj=function(){function Ua(Qa,Db,Kb){var Ab=pa.$.oa.xa;Qa=Ha.b(Qa,pa.QKi);var ub=Ab.Na(1,null);return R.g(Ab,"GetHasUntrustedImageUrls",ub,Qa,Db,Kb,null,4)}var pa=this;Ia.EwaSettings.Zb()?this.$.userOperationManager.Sb(new ta.a(588,0,Ua,80),null):this.$.userOperationManager.Sb(new ec.a(588,0,Ua,16),null)};a.prototype.tWd=function(Ua){var pa=this;if(this.M5a&&null==this.Fld&&!this.A6a&&I.AFrameworkApplication.fa.qa("SupportsPolicies")&&null!=this.t6a&&
this.t6a&&(!Ua||this.$.workbookContext.Options&262144)){var Qa=Cb.GetServiceTaskFactory.Ra(this.$.da,274,275,0);ya.TaskExtensions.Aa(Qa,function(){pa.Fld=Qa.result.SMf(2)},this.$.la,3)}};a.prototype.M2g=function(Ua){(Ua=this.ehh(Ua))?this.convertToLinkedEntity(Ua):z.ULS.sendTraceTag(537166920,0,10,"Could not convert key into domain ID")};a.prototype.convertToLinkedEntity=function(Ua){z.ULS.sendTraceTag(34415004,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - conversion attempted  [ServiceEndpoint: {0}].",
Ua.Id);if(this.gridView){var pa=this.gridView.ha.sa.Vc,Qa=pa.ze(this.gridView.YG);this.Twa&&this.Pld&&this.NCg(Ua);if(Qa){Qa=this.gridView.Ab.Lwa(Qa);if(!this.A5e(Ua)&&this.Aef(Ua.Id)){z.ULS.sendTraceTag(537166918,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - tried to convert to organization data type without curated data");if(Ob.a.qg.RQ){pa=this.ccd();if(!pa){z.ULS.sendTraceTag(537166917,0,50,"CalloutAnchorElement is null for blankCellConvert");return}Qa=this.g4b();if(!Qa){z.ULS.sendTraceTag(537166916,
0,50,"RibbonCommandInfo is null for blankCellConvert");return}var Db={};Db=(Db.InputMethod=da.a.Cb,Db);Db.CalloutName=3;Db.Target=pa;Db.RibbonButtonLabel=Ia.EwaSettings.isChangeGateEnabled("OfficeVSO:4244626_BlankCellCalloutRibbonButtonLabel")?this.XSf(Ua):this.HAb(Ua.Id.toString());Db.ExampleEntities=this.UPe(Ua);this.$.Ka.Kb(Qa,Db);return}z.ULS.sendTraceTag(537166915,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - Attempted to convert to organization data without curated data, teaching callout not enabled")}if(this.Aef(Ua.Id)&&
!Ua.StringId)this.launchLinkedEntityDataTypeSelectorPane(a.m1a(Ua));else{if(Qa){z.ULS.sendTraceTag(537166914,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - tried to convert an empty range");if(Ia.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LaunchStarterDataForBlankCell",!1)&&this.ZFj(Ua)){pa=na.r(this.gridView.ha.sa.selectedRanges,this.$);this.Bn.rqi(pa,Ua);return}if(Ob.a.qg.RQ){pa=this.ccd();if(!pa){z.ULS.sendTraceTag(537166913,0,50,"CalloutAnchorElement is null for blankCellConvert");
return}Qa=this.g4b();if(!Qa){z.ULS.sendTraceTag(537166912,0,50,"RibbonCommandInfo is null for blankCellConvert");return}Db={};Db=(Db.InputMethod=da.a.Cb,Db);Db.CalloutName=2;Db.Target=pa;Db.RibbonButtonLabel=this.XSf(Ua);Db.ExampleEntities=this.UPe(Ua);Db.BlankCellResourceId=this.MNg(Ua);Db.HasBlankCellWalkthrough=this.a4h(Ua);Db.ServiceDomain=Ua.Id;this.$.Ka.Kb(Qa,Db);return}z.ULS.sendTraceTag(537166883,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - Attempted to convert a blank range, teaching callout not enabled")}this.Q1c(Ua,
!1,pa)}}}else z.ULS.shipAssertTag(537166919,0,!1,"grid view should not be null")};a.prototype.convertToLinkedEntityFromAutoDetect=function(){this.Y9&&this.Y9.nHa()};a.prototype.onAutoDetectUIShown=function(){function Ua(Qa,Db,Kb){var Ab=pa.$.oa.xa,ub=Ab.Na(1,null);return R.g(Ab,"OnAutoDetectUIShown",ub,Qa,Db,Kb,null,4)}var pa=this;Ia.EwaSettings.Zb()?ia.a(this.$.userOperationManager,Ua,function(Qa){return new ta.a(230,0,Qa,80)},null):ia.a(this.$.userOperationManager,Ua,function(Qa){return new ec.a(230,
0,Qa,16)},null)};a.prototype.Q1c=function(Ua,pa,Qa){function Db(){return new qa.a}var Kb=this,Ab=na.q(Qa,this.$);ia.a(this.$.userOperationManager,function(ub,Mb,Aa){var Za=Kb.$.oa.xa;ub=Ha.b(ub,Kb.YHi,Kb.YRi,Kb.Bn.XHi);var Zb=Za.Na(1,null);Zb.selectedRanges=Ab;Zb.domainId=Ua;Zb.autodetect=pa;return R.g(Za,"ConvertToLinkedEntity",Zb,ub,Mb,Aa,null,4)},function(ub){return new ta.a(115,0,ub,void 0,Db)},null)};a.prototype.NCg=function(Ua){if(this.Twa&&this.Pld){var pa={};pa.Id=Ua.Id;Ua.StringId&&(pa.StringId=
Ua.StringId);if(!(0<this.eK.length&&this.eK[0].Id===pa.Id&&this.eK[0].StringId===pa.StringId)){Ua=!1;Array.insert(this.eK,0,pa);for(var Qa=1;Qa<this.eK.length;++Qa)if(this.eK[Qa].Id===pa.Id&&this.eK[Qa].StringId===pa.StringId){Array.removeAt(this.eK,Qa);Ua=!0;break}for(;5<this.eK.length;)Array.removeAt(this.eK,this.eK.length-1);this.Tba.Categories[a.I7a].DomainIds=this.eK;this.WRf();this.Xod&&!Ua&&this.$Kd.bgg(this.eK)}}};a.prototype.convertLinkedEntityToText=function(){var Ua=this;z.ULS.sendTraceTag(34719501,
0,50,"ConvertToLinkedEntityManager:ConvertLinkedEntityToText() - conversion attempted");if(this.gridView){var pa=na.q(this.gridView.ha.sa.Vc,this.$);ia.a(this.$.userOperationManager,function(Qa,Db,Kb){var Ab=Ua.$.oa.xa,ub=Ab.Na(1,null);ub.selectedRanges=pa;return R.g(Ab,"ConvertLinkedEntityToText",ub,Qa,Db,Kb,null,4)},function(Qa){return new ta.a(116,0,Qa)},null)}else z.ULS.shipAssertTag(537166879,0,!1,"grid view should not be null")};a.prototype.refreshLinkedEntitiesInRange=function(){var Ua=this;
z.ULS.sendTraceTag(537166878,0,50,"ConvertToLinkedEntityManager:RefreshLinkedEntitiesInRange() - refresh attempted");if(ob.g(this.$)){this.$.isEditMode||z.ULS.sendTraceTag(537166876,0,50,"ConvertToLinkedEntityManager:RefreshLinkedEntitiesInRange(): Refreshing selection during view mode");this.QHd();var pa=na.r(this.gridView.ha.sa.selectedRanges,this.$);ia.a(this.$.userOperationManager,function(Qa,Db,Kb){var Ab=Ua.$.oa.xa,ub=Ab.Na(1,null);ub.selectedRanges=pa;return R.g(Ab,"RefreshLinkedEntitiesInRange",
ub,Qa,Db,Kb,null,4)},function(Qa){return new ta.a(248,0,Qa)},null)}else z.ULS.shipAssertTag(537166877,0,!1,"grid view should not be null")};a.prototype.oxj=function(Ua){Ua=this.$P(Ua.DomainId);if(!Ua||Ua.DomainBlocked||Ia.EwaSettings.isChangeGateEnabled("OfficeVSO:4465309_NoCuratedDataNoLongButton")&&!Ua.HasCuratedData)return!1;if(this.Rii){for(var pa=bk(this.wU),Qa=pa.next();!Qa.done;Qa=pa.next())if(Qa=Qa.value,Qa.value.DomainId.Id===Ua.DomainId.Id&&Qa.value.ShowInRibbon)return!0;return!1}return Ua.ShowInRibbon};
a.prototype.fwj=function(Ua){return 2!==this.Sr||!this.fia[Ua]};a.prototype.launchDisambiguationPaneForSearch=function(){this.Bn&&this.Bn.launchDisambiguationPaneForSearch()};a.prototype.Qc=function(Ua,pa,Qa){if("PopulateConvertToLinkedEntityMenu"!==pa)return!1;this.abd=Qa.MenuId;if(0===this.Sr||3===this.Sr)return this.xYi(),!0;if(!this.Tba)return z.ULS.sendTraceTag(537166873,0,10,"PopulateMenu: Encountered null ribbon section info"),!1;if(!this.wU)return z.ULS.sendTraceTag(537166872,0,10,"PopulateMenu: Encountered null domain collection"),
!1;this.sY=this.sY||this.p8a.jFh(this.Tba,Qa.MenuId);Qa.MenuItems=this.sY;return this.Pld=!0};a.prototype.xYi=function(){var Ua=this;-1===this.Zcc&&(this.z$a(),this.Zcc=window.setInterval(function(){Ua.z$a()},2E3))};a.prototype.z$a=function(){if(this.$.ea.dc&&2!==this.Sr){this.zKa--;z.ULS.sendTraceTag(537166870,0,50,"ConvertToLinkedEntityManager:PopulateDomainData() - populating domains attempted.");this.Sr=1;var Ua=this.$.oa.xa,pa=this.YKi,Qa=this.XKi,Db=Ua.Na(1,null);R.g(Ua,"GetLinkedEntityMetadata",
Db,pa,Qa,null,null,4)}};a.prototype.Emd=function(){return this.$.isEditMode&&2!==this.Sr&&(0<=this.zKa||!this.LOa)};a.prototype.PXd=function(Ua){I.AFrameworkApplication.Ag?z.ULS.sendTraceTag(537166869,0,50,"UpdatePreviewGalleryVisibility bailed out on shutting down."):N.a(this.$)?(this.vRj(),Ua&&this.$.hf()):z.ULS.sendTraceTag(537166868,0,50,"UpdatePreviewGalleryVisibility bailed out on null RibbonManager.")};a.prototype.mfj=function(){this.wwb=this.pDb=0;this.zKa=8;this.LOa=!1;this.Sr=this.Zcc=0;
this.dNa=this.Tba=null;this.h2b();for(var Ua=0;Ua<this.DNa;++Ua)this.fia[Ua]=null;this.Ayb()&&this.PXd(!0)};a.prototype.h2b=function(){this.sY=null};a.prototype.Ayb=function(){var Ua=K.a.XGb,pa=N.a(this.$);return!!pa&&pa.Ql.wB===Ua};a.prototype.Qbg=function(){if(this.Tba){var Ua=0;if(this.Twa){var pa=-1,Qa=-1,Db=0,Kb=0,Ab=0,ub=0,Mb=[null,null,null,null,null],Aa=bk(this.Tba.Categories);for(jb=Aa.next();!jb.done;jb=Aa.next()){var Za=!1;jb=bk(jb.value.DomainIds);for(Vb=jb.next();!Vb.done;Vb=jb.next()){Vb=
Vb.value;var Zb=this.$P(Vb);Zb&&!Zb.DomainBlocked&&Zb.ShowInRibbon&&(Ua<this.DNa?(this.fia[Ua]=Vb,Kb===a.I7a&&(-1===pa&&(pa=Ua),Qa=Ua,ub=Qa-pa+1),++Ua):Ua===this.DNa&&Db<ub&&Kb!==a.I7a&&(Mb[Db]=Vb,++Db),Za=!0)}Za&&++Ab;++Kb}if(-1<pa&&Ab<=a.Bjf){for(;Qa>=pa;--Qa)Array.removeAt(this.fia,Qa);for(pa=0;pa<ub;++pa)Array.insert(this.fia,Ua+pa,Mb[pa])}}else{ub=bk(this.Tba.Categories);for(var jb=ub.next();!jb.done;jb=ub.next()){Mb=bk(jb.value.DomainIds);for(var Vb=Mb.next();!Vb.done&&!(pa=Vb.value,(Qa=this.$P(pa))&&
!Qa.DomainBlocked&&Qa.ShowInRibbon&&(this.fia[Ua]=pa,++Ua,Ua>=this.DNa));Vb=Mb.next());if(Ua>=this.DNa)break}}for(;Ua<this.DNa;)this.fia[Ua]=null,++Ua}};a.prototype.P$f=function(){var Ua=Object(U.a)(407,ob.g(this.$).Ea),pa=this.gridView.ha.Pe;return Ua&&Ua.Hhd&&1===pa&&this.gridView.ha.sa.activeCell?(Ua=Cb.GetServiceTaskFactory.Ra(this.$.da,12,477,1),this.Y9=new M.a(this.$,this.svgIconProvider,Ua.result,this),!0):!1};a.prototype.uqi=function(){this.Bn&&this.Bn.Zrd(!0)};a.prototype.launchLinkedEntityDataTypeSelectorPane=
function(Ua){if(this.Bn)if(Ua=this.c6c(Ua))if(Ua.DomainId.StringId)z.ULS.sendTraceTag(537166855,0,10,"Domain with a string ID used when launching Data Type Selector pane");else{var pa=na.r(this.gridView.ha.sa.selectedRanges,this.$);this.Bn.launchLinkedEntityDataTypeSelectorPane(pa,Ua.DomainId.Id)}else z.ULS.sendTraceTag(537166856,0,10,"Unknown domain used when launching Data Type Selector pane")};a.prototype.b1g=function(Ua){var pa=this.y7h(Ua),Qa=F.a.zg(this.HAb(Ua));Ua=F.a.zg(this.pVd(Ua));return a.NEh(pa,
Fb.a.Se(11),Qa,Ua)};a.prototype.pVd=function(Ua){try{return this.cIe(parseInt(Ua,10)).Description}catch(pa){}return Ga.a.instance.ga(1772)};a.prototype.HAb=function(Ua){try{return this.cIe(parseInt(Ua,10)).Name}catch(pa){}return Ga.a.instance.ga(1758)};a.prototype.XSf=function(Ua){try{return this.$P(Ua).Name}catch(pa){}return this.HAb(Ua.Id.toString())};a.prototype.MNg=function(Ua){try{return this.$P(Ua).BlankCellResourceId}catch(pa){}return null};a.prototype.a4h=function(Ua){try{return this.$P(Ua).HasBlankCellWalkthrough}catch(pa){}return!1};
a.prototype.A5e=function(Ua){try{var pa=a.m1a(Ua);if(this.wU.kb(pa))return this.wU.na(pa).HasCuratedData}catch(Qa){}return!1};a.prototype.ZFj=function(Ua){try{return this.$P(Ua).SupportsStarterData}catch(pa){}return!1};a.prototype.Aef=function(Ua){return 268435968===Ua};a.prototype.ccd=function(){return 2===N.a(this.$).FW?"[data-unique-id=LinkedEntity_MLR]":"[data-unique-id=LinkedEntity]"};a.prototype.g4b=function(){return new sa.a(-847286761,da.a.Cb,this.$.Jc,0,K.a.lW)};a.prototype.TCe=function(){if(this.Ayb()&&
!this.Emd()&&!this.dcf&&Ia.EwaSettings.ma(442)&&this.A5e({Id:268435968,StringId:null}))if(z.ULS.sendTraceTag(537166819,0,50,"ConvertToLinkedEntityManager:CreateLinkedEntityFirstOrganizationDataCallout() - tried to launch first org data teaching callout"),Ob.a.qg.RQ){var Ua=this.ccd();if(Ua){var pa=this.g4b();if(pa){var Qa={};Qa=(Qa.InputMethod=da.a.Cb,Qa);Qa.CalloutName=6;Qa.Target=Ua;Qa.ShouldCanvasTakeFocus=!0;this.$.Ka.Kb(pa,Qa);this.dcf=!0}else z.ULS.sendTraceTag(537166817,0,10,"RibbonCommandInfo is null for firstOrgData")}else z.ULS.sendTraceTag(537166818,
0,10,"CalloutAnchorElement is null for firstOrgData")}else z.ULS.sendTraceTag(537166816,0,50,"ConvertToLinkedEntityManager:CreateLinkedEntityFirstOrganizationDataCallout() - Attempted to launch firstOrgData callout, teaching callout not enabled")};a.prototype.X6h=function(Ua){Ua=this.c6c(Ua);return Ua?this.p8a.rMg(Ua.SubdomainFontLocator):(z.ULS.sendTraceTag(537166815,0,10,"ConvertToLinkedEntityManager.IconFromDomainFontLocator: Requested domain that doesn't exist in collection"),null)};a.prototype.qfc=
function(Ua){return this.Y9?this.Y9.qMg(Ua):!1};a.prototype.ZHh=function(){return this.Y9?this.Y9.SIh():""};a.prototype.eei=function(){return this.Y9?this.Y9.oBb:!1};a.prototype.KMh=function(Ua,pa){var Qa=this.L8e(Ua);if(0>Qa)z.ULS.sendTraceTag(537166813,0,10,"Unexpected menuItemKey for dynamic preview gallery button: {0}",Ua);else if(Ua=(Ua=this.dIe(Ua))?this.$P(Ua):null)pa[G.a.GalleryButtonProps]=this.p8a.KFh(Qa,Ua),pa[G.a.Alt]=this.p8a.Kcd(Ua)};a.prototype.WRf=function(){this.Qbg();this.Ayb()&&
this.PXd(!0);this.h2b()};a.prototype.y7h=function(Ua){return Ua===this.VRe?H.a.TOe:Ua===this.dVe?H.a.ROe:H.a.QOe};a.prototype.UPe=function(Ua){try{return this.$P(Ua).ExampleEntities}catch(pa){}return Ga.a.instance.ga(1780)};a.prototype.frc=function(){(0>this.zKa||this.LOa)&&z.ULS.sendTraceTag(537166811,0,15,"RefreshFullGalleryIfOpened: Out of GetLinkedEntityServiceDomain retries");(2===this.Sr||0>this.zKa||this.LOa)&&window.clearInterval(this.Zcc);this.Emd()?this.abd&&this.$.frame.Lw(this.abd):this.PXd(this.Ayb())};
a.prototype.Bb=function(Ua){return this.$.yb+Ua};a.prototype.vRj=function(){var Ua=!0,pa=Array(this.DNa),Qa=N.a(this.$)?N.a(this.$).Ql:null;if(Qa){for(var Db=0;Db<pa.length;++Db)this.fwj(Db)?pa[Db]=!0:Ua=pa[Db]=!1;Qa.mOd(["ConvertToLinkedEntityGallery"],Ua);if(!Ua)for(Ua=0;Ua<pa.length;++Ua)pa[Ua]&&Qa.mOd([this.JMh(Ua)],!0)}else z.ULS.sendTraceTag(537166809,0,15,"UpdateLinkedEntityGalleryButtonsVisibility: ribbonUser should not be null")};a.prototype.$P=function(Ua){var pa=a.m1a(Ua);if(this.wU.kb(pa))return this.wU.na(pa);
z.ULS.sendTraceTag(592729218,0,15,"No domain data for domain ID {0} (Has String ID: {1})",Ua.Id,!!Ua.StringId);return null};a.prototype.JMh=function(Ua){return"ConvertToLinkedEntityPreview"+Ua.toString()};a.prototype.GXd=function(){var Ua=this;T.a.get_instance().ak(10,function(){Ua.TCe();Ua.XYc&&Ua.vdf&&ab.b(Ua.$if,Ua.$.la,500)})};a.prototype.Occ=function(Ua,pa){switch(Ua){case "QueryLinkedEntityGalleryButtons":if(!pa[G.a.InnerHTML]){Ua=pa[da.a.Nc].toString();var Qa=Na.a.equals(Ua,Ga.a.instance.ga(1775),
!0)||Na.a.equals(Ua,Ga.a.instance.ga(1776),!0),Db=Na.a.equals(Ua,Ga.a.instance.ga(1777),!0);Qa||Db||this.KMh(Ua,pa)}break;case "QueryLinkedEntityMenuGalleryButtons":pa[G.a.InnerHTML]||(pa[G.a.InnerHTML]=this.b1g(pa[da.a.Nc]))}return pa};a.prototype.ehh=function(Ua){var pa=this.dIe(Ua);if(pa)return pa;if(pa=this.c6c(Ua))return pa.DomainId;z.ULS.sendTraceTag(537166805,0,10,"Could not convert key into domain: {0}",Ua);return null};a.prototype.cIe=function(Ua){var pa={};pa.Id=Ua;return this.$P(pa)};a.prototype.c6c=
function(Ua){return this.wU.kb(Ua)?this.wU.na(Ua):null};a.prototype.L8e=function(Ua){if(!Ua.startsWith(a.w6c))return-1;var pa=parseInt(Ua.substr(a.w6c.length),10);return isNaN(pa)?(z.ULS.sendTraceTag(537166802,0,10,"Unexpected index in preview gallery button key: {0}",Ua),-1):pa};a.prototype.dIe=function(Ua){Ua=this.L8e(Ua);return 0>Ua?null:this.fia[Ua]};a.prototype.L$e=function(Ua,pa,Qa){if(this.jzb&&this.wU&&this.wU.count){z.ULS.sendTraceTag(537166801,0,50,"ConvertToLinkedEntityManager.InvokeLinkedEntityTryAutoRefresh. ({0})",
Ua);var Db=this.$.oa.xa.Pb();this.$.ea.dc&&(Ua=this.$.oa.xa,pa=Ha.b(this.ANi,pa),Db=Ua.Na(1,void 0===Db?null:Db),R.g(Ua,"LinkedEntityTryAutoRefresh",Db,pa,Qa,null,null,0))}};a.prototype.jMj=function(){this.L$e("Auto-refresh on load",null,null)};a.prototype.nMj=function(){this.jzb&&this.wU&&this.wU.count&&(this.Nya?z.ULS.sendTraceTag(537166799,0,50,"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. A periodic auto-refresh check context already exists. No need to create another one"):
this.$.ea.ho.HasAutoRefreshableLinkedEntityDomainsEver?(z.ULS.sendTraceTag(537166797,0,50,"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. Book has auto-refreshable domains. Creating periodic auto refresh check context"),this.Nya=ma.a.instance.create(this.OYc,this.f0b,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck")):z.ULS.sendTraceTag(537166798,0,50,"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. Book doesn't have any auto-refreshable domains. Periodic auto refresh check context will NOT be created"))};
a.prototype.Zxc=function(){if(this.$.ea.dc&&null!=this.t6a&&null!=this.Hod&&null!=this.Iod&&null!=this.Jqd&&null!=this.Tpd)if(++this.pDb,12>=this.pDb){1===this.pDb&&(this.w4a=ha.a.Ta.Wd.m,z.ULS.sendTraceTag(537166752,0,50,"StartLinkedEntityDelayedHandshake - starting handshake."));var Ua=this.$.oa.xa.Pb();vb.t(this.$.oa.xa,this.mjf,this.njf(),this.COi,this.BOi,null,Ua)}else z.ULS.sendTraceTag(537166751,0,15,"StartLinkedEntityDelayedHandshake - Retry count expired - failed handshake duration {0} ms",
ha.a.Ta.Wd.m-this.w4a),this.LOa=!0,this.frc()};a.prototype.Uwe=function(){var Ua=this;if(this.$.isEditMode)if(null!=this.t6a)this.Zxc();else{var pa=ha.a.Ta.Wd.m,Qa=[];O.a.instance.Tb("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(Db){Db.isFeatureEnabled("ExcelPowerBiPro",!1).then(function(Kb){z.ULS.sendTraceTag(537166747,0,50,"CheckE5LicensingAndStartDelayedHandshake for {0} takes {1} Millisecond.","ExcelPowerBiPro",ha.a.Ta.Wd.m-pa);z.ULS.sendTraceTag(537166746,
0,50,"CheckE5LicensingAndStartDelayedHandshake: featureName=[{0}] isEnabled=[{1}]","ExcelPowerBiPro",Kb);return Ua.t6a=Kb}).then(function(){Qa.push(Db.isFeatureEnabled("ExcelWolframAlpha",!1).then(function(Kb){z.ULS.sendTraceTag(590960588,0,50,"CheckE5LicensingAndStartDelayedHandshake for {0} takes {1} Millisecond.","ExcelWolframAlpha",ha.a.Ta.Wd.m-pa);z.ULS.sendTraceTag(537166743,0,50,"CheckE5LicensingAndStartDelayedHandshake: featureName=[{0}] isEnabled=[{1}]","ExcelWolframAlpha",Kb);return Ua.Jqd=
Kb}))}).then(function(){Qa.push(Db.isFeatureEnabled("ExcelDisableStockGeographyDataTypes",!1).then(function(Kb){z.ULS.sendTraceTag(537166741,0,50,"CheckE5LicensingAndStartDelayedHandshake for {0} takes {1} Millisecond.","ExcelDisableStockGeographyDataTypes",ha.a.Ta.Wd.m-pa);z.ULS.sendTraceTag(537166740,0,50,"CheckE5LicensingAndStartDelayedHandshake: featureName=[{0}] isEnabled=[{1}]","ExcelDisableStockGeographyDataTypes",Kb);var Ab,ub=[(Ab=new yb.a,Ab.name="IsRestrictedByLicense",Ab.bool=Kb,Ab)];
qb.a("SatoriStockGeographyLicensingRestrictions",void 0,void 0,ub);Ua.fgf=Kb&&Ia.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.StockGeographyLicensingCheck",!1);return Kb}))}).then(function(){Qa.push(Db.isFeatureEnabled("StockHistory",!1).then(function(Kb){z.ULS.sendTraceTag(537166739,0,50,"CheckE5LicensingAndStartDelayedHandshake for {0} takes {1} Millisecond.","StockHistory",ha.a.Ta.Wd.m-pa);z.ULS.sendTraceTag(537166738,0,50,"CheckE5LicensingAndStartDelayedHandshake: featureName=[{0}] isEnabled=[{1}]",
"StockHistory",Kb);return Ua.Tpd=Kb}))}).then(function(){Qa.push(Db.isFeatureEnabled("ExcelPowerBiFree",!1).then(function(Kb){z.ULS.sendTraceTag(537166736,0,50,"CheckE5LicensingAndStartDelayedHandshake for {0} takes {1} Millisecond.","ExcelPowerBiFree",ha.a.Ta.Wd.m-pa);z.ULS.sendTraceTag(537166735,0,50,"CheckE5LicensingAndStartDelayedHandshake: featureName=[{0}] isEnabled=[{1}]","ExcelPowerBiFree",Kb);return Ua.Hod=Kb}))}).then(function(){Qa.push(Db.isFeatureEnabled("ExcelPowerBiPremiumPerUser",!1).then(function(Kb){z.ULS.sendTraceTag(537166734,
0,50,"CheckE5LicensingAndStartDelayedHandshake for {0} takes {1} Millisecond.","ExcelPowerBiPremiumPerUser",ha.a.Ta.Wd.m-pa);z.ULS.sendTraceTag(537166733,0,50,"CheckE5LicensingAndStartDelayedHandshake: featureName=[{0}] isEnabled=[{1}]","ExcelPowerBiPremiumPerUser",Kb);return Ua.Iod=Kb}))}).then(function(){Promise.all(Qa).then(function(){Ua.Zxc()})})})}};a.prototype.zMf=function(){++this.wwb;if(12>=this.wwb){1===this.wwb&&(this.w4a=ha.a.Ta.Wd.m,z.ULS.sendTraceTag(570769946,0,50,"ConvertToLinkedEntityManager.RefreshHandshake - starting handshake refresh."));
var Ua=this.$.oa.xa,pa=this.mjf,Qa=this.njf(),Db=this.NPi,Kb=this.MPi,Ab=Ua.Na(1,null);Ab.featureNames=pa;Ab.isEnabledValues=Qa;R.g(Ua,"RefreshLinkedEntityWebServiceHandshake",Ab,Db,Kb,null,null,4)}else z.ULS.sendTraceTag(570769945,0,15,"ConvertToLinkedEntityManager.RefreshHandshake - Retry count expired - failed handshake duration {0} ms",ha.a.Ta.Wd.m-this.w4a),this.LOa=!0,this.frc()};a.prototype.njf=function(){return[this.t6a,this.Jqd,this.Tpd,this.Hod,this.Iod,this.fgf]};a.prototype.QHd=function(){this.businessBar&&
this.businessBar.QLa(57)&&this.businessBar.removeEntry(57)};a.prototype.n2h=function(Ua){if(this.wsd!==Ua&&this.businessBar)if(this.wsd=Ua){Ua=this.$.oa.xa;var pa=this.AKi,Qa=Ua.Na(1,null);R.g(Ua,"GetErrorMessageForLinkedDataTypeRefresh",Qa,pa,null,null,null,4)}else this.QHd()};a.NEh=function(Ua,pa,Qa,Db){Ua=String.format('<span class="cui-img-32by32 cui-img-cont-float"><IMG class="{0}" src="{1}" alt="{2}" align="middle"></span>',Ua,pa,Db);Qa=String.format('<div class="cui-row-onerow"><p class="cui-ctl-mediumlabel leg-gallerybuttonlabel" align="middle">{0}</p></div>',
Qa);return String.format('<div mscui:controltype="GalleryButton" class="leg-gallerybutton">{0}{1}</div>',Ua,Qa)};a.m1a=function(Ua){return Ua.StringId?Ua.Id.toString()+"."+Ua.StringId:Ua.Id.toString()};Mf.Object.defineProperties(a.prototype,{B5i:{configurable:!0,enumerable:!0,get:function(){return 5}},dHb:{configurable:!0,enumerable:!0,get:function(){return this.eK},set:function(Ua){this.eK=Ua}},DNa:{configurable:!0,enumerable:!0,get:function(){return this.fia.length}},kzi:{configurable:!0,enumerable:!0,
get:function(){return this.V$d}},mjf:{configurable:!0,enumerable:!0,get:function(){return"ExcelPowerBiPro ExcelWolframAlpha StockHistory ExcelPowerBiFree ExcelPowerBiPremiumPerUser ExcelDisableStockGeographyDataTypes".split(" ")}}});a.QIe="ConvertToLinkedEntityPreview";a.w6c="PreviewGalleryButtonIndex.";a.I7a=0;a.Bjf=2;Object(u.a)(a,"ConvertToLinkedEntityManager",J.a,[934,935,3,936])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.le.js.map/ab6432b02b177afc20fb25034ce14d77/EwaDS.le.js.map